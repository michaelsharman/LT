/*! For license information please see index.js.LICENSE.txt */
var t={2201:(t,e,n)=>{n.d(e,{r:()=>i});var i="2.19.0"},8097:(t,e,n)=>{n.d(e,{LT:()=>g});var i=n(4113),r=n(173),s=n(3674),a=n(7518),o=n(77),l=n(3963),c=n(7028);function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){p(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function p(t,e,n){return(e=function(t){var e=function(t){if("object"!=d(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==d(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f={utils:{logger:n(5059).A}},g=u(u(u(u(u(u(u(u({},i),a),r),o),l),c),s),f)},173:(t,e,n)=>{n.r(e),n.d(e,{activity:()=>a,activityId:()=>o,activitySubTitle:()=>d,activityTags:()=>h,activityTemplateId:()=>l,activityTitle:()=>c,adaptiveType:()=>u,annotationsConfig:()=>p,autoSaveConfig:()=>f,elapsedTime:()=>g,hasActivityTemplate:()=>m,hasAnnotations:()=>v,hasAnswerMasking:()=>b,hasAutoSave:()=>y,hasEvents:()=>w,hasItemPool:()=>A,hasLineReader:()=>x,hasResourceItems:()=>E,hasSections:()=>S,hasShuffledItems:()=>_,hasTryAgain:()=>T,isAdaptive:()=>C,isResuming:()=>k,itemBank:()=>M,itemPool:()=>I,maxTime:()=>L,region:()=>P,resourceItems:()=>R,sessionId:()=>D,state:()=>F,timeRemaining:()=>O,totalItems:()=>N,userId:()=>B});var i=n(4113),r=n(7028),s=n(5059);function a(){return i.appInstance().getActivity()}function o(){return a().activity_id}function l(){return a().activity_template_id}function c(){return a().config.title}function d(){return a().config.subtitle}function h(){return i.appInstance().getTags()}function u(){return C()&&a().adaptive.hasOwnProperty("type")?a().adaptive.type:""}function p(){var t;return v()&&null!==(t=a())&&void 0!==t&&null!==(t=t.config)&&void 0!==t&&t.annotations_api_init_options?a().config.annotations_api_init_options:{}}function f(){var t,e=a();return null!=e&&null!==(t=e.config)&&void 0!==t&&null!==(t=t.navigation)&&void 0!==t&&t.auto_save?e.config.navigation.auto_save:{}}function g(){return i.appInstance().getTime()}function m(){return a().hasOwnProperty("activity_template_id")}function v(){var t,e,n=a();return Boolean(!0===(null==n||null===(t=n.config)||void 0===t?void 0:t.annotations)||(null==n||null===(e=n.config)||void 0===e?void 0:e.annotations_api_init_options))}function b(){return!!document.querySelector(".test-answer-masking")}function y(){var t=a();return t.hasOwnProperty("config")&&t.config.hasOwnProperty("navigation")&&t.config.navigation.hasOwnProperty("auto_save")&&!1!==t.config.navigation.auto_save}function _(){var t;return Boolean(null===(t=a())||void 0===t||null===(t=t.config)||void 0===t||null===(t=t.configuration)||void 0===t?void 0:t.shuffle_items)}function w(){var t=a();return t.hasOwnProperty("events")&&!1!==t.events}function A(){return a().hasOwnProperty("item_pool_id")}function x(){return!!document.querySelector(".lrn_linereader-toggle")}function E(){var t;return Boolean(null===(t=a())||void 0===t||null===(t=t.config)||void 0===t||null===(t=t.navigation)||void 0===t?void 0:t.resource_items)}function S(){return a().hasOwnProperty("sections")}function T(){var t;return null===(t=a())||void 0===t?void 0:t.dynamic_items.hasOwnProperty("try_again")}function C(){return a().hasOwnProperty("adaptive")}function k(){return a().existing_session}function M(){var t;return null===(t=a())||void 0===t?void 0:t.organisation_id}function I(){var t;return null===(t=a())||void 0===t?void 0:t.item_pool_id}function L(){var t;return null!==(t=a())&&void 0!==t&&null!==(t=t.config)&&void 0!==t&&null!==(t=t.time)&&void 0!==t&&t.max_time?a().config.time.max_time:0}function P(){var t;return null===(t=a())||void 0===t||null===(t=t.config)||void 0===t?void 0:t.regions}function R(){var t;return null===(t=a())||void 0===t||null===(t=t.config)||void 0===t||null===(t=t.navigation)||void 0===t?void 0:t.resource_items}function D(){var t;return null===(t=a())||void 0===t?void 0:t.session_id}function F(){var t;return void 0===(null===(t=a())||void 0===t?void 0:t.state)?"initial":a().state}function O(){return 0===L()?null:L()-g()}function N(){if(S()){for(var t=0,e=r.sections(),n=0;n<e.length;n++)t+=e[n].items.length;return t}return C()?a().hasOwnProperty("items")?a().items.length:(s.A.info("This is an adaptive session, no items array found"),0):a().items.length}function B(){var t;return null===(t=a())||void 0===t?void 0:t.user_id}},4113:(t,e,n)=>{n.r(e),n.d(e,{annotationsApp:()=>l,appInstance:()=>o,assessApp:()=>c,eventsApp:()=>d,init:()=>a,questionsApp:()=>h});var i=n(3674),r=n(3963),s={};function a(t){s.app=t,s.app.on("all",(function(t){(0,i.handleEvent)(t)})),s.app.on("item:load",(function(t){(0,r.questionResponseIds)().forEach((function(t){s.app.question(t).on("changed",(function(t){(0,i.handleEvent)("changed")})),s.app.question(t).on("beforeValidate",(function(t){(0,i.handleEvent)("beforeValidate")})),s.app.question(t).on("rendered",(function(t){(0,i.handleEvent)("rendered")})),s.app.question(t).on("validated",(function(t){(0,i.handleEvent)("validated")}))}))}))}function o(){return s.app}function l(){return void 0!==o().annotationsApp()?o().annotationsApp():null}function c(){return o().assessApp()}function d(){return o().eventsApp()}function h(){return o().questionsApp()}},3674:(t,e,n)=>{n.r(e),n.d(e,{diagnostics:()=>l,filterEvent:()=>c,handleEvent:()=>d,listen:()=>h});var i=n(4113),r=n(173),s=n(5059),a=n(2201),o={events:{broadcast:!1,listenFor:"item"}};function l(){var t=window.LearnosityApp?LearnosityApp.versions:{};return{apps:{annotations:{app:i.annotationsApp(),config:r.annotationsConfig(),enabled:r.hasAnnotations()},assess:{app:i.assessApp()},events:{app:i.eventsApp(),enabled:r.hasEvents()},items:{app:i.appInstance(),metadata:r.activity().config.metadata},questions:{app:i.questionsApp()}},activity:{activity:r.activityId(),activityTemplate:r.activityTemplateId(),autoSave:{config:r.autoSaveConfig(),enabled:r.hasAutoSave()},itemBank:r.itemBank(),itemPool:r.itemPool(),session:r.sessionId(),state:r.state(),type:r.activity().type,user:r.userId()},LT:{version:a.r},versions:t}}function c(t){/^[a-zA-Z:*]*$/.test(t)?o.events.listenFor=t:s.A.warn("Invalid event type")}function d(t){if(o.events.broadcast){var e=o.events.listenFor,n=e.replaceAll("*","");1===e.length&&"*"===e||"all"===e?s.A.info(t):e.startsWith("*")&&!e.endsWith("*")?t.endsWith(n)&&s.A.info(t):e.endsWith("*")&&!e.startsWith("*")?t.startsWith(n)&&s.A.info(t):e.startsWith("*")&&e.endsWith("*")?t.includes(n)&&s.A.info(t):t.startsWith(n)&&s.A.info(t)}}function h(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];o.events.broadcast=Boolean(t),Boolean(t)?s.A.info("👂 listening for '".concat(o.events.listenFor,"'")):s.A.info("🚫👂 not listening")}},7518:(t,e,n)=>{n.r(e),n.d(e,{dynamic:()=>l,flag:()=>c,isDynamicItem:()=>d,isFirstItem:()=>h,isFlagged:()=>p,isItemFullyAttempted:()=>f,isLastItem:()=>u,isMaskingEnabled:()=>g,item:()=>m,itemAttemptStatus:()=>v,itemByResponseId:()=>b,itemElement:()=>y,itemPosition:()=>_,itemReference:()=>w,itemTags:()=>A});var i=n(4113),r=n(173),s=n(3963),a=n(7028);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function l(){var t=w();return i.assessApp().item(t).dynamic||{}}function c(){var t=w();i.assessApp().item(t).flag()}function d(){var t;return null===(t=m())||void 0===t?void 0:t.source.hasOwnProperty("data_table_seed")}function h(){return r.hasSections()?("object"===o(a.sections()[0].items[0])?a.sections()[0].items[0].reference:a.sections()[0].items[0])===m().reference:("object"===o(r.activity().items[0])?r.activity().items[0].reference:r.activity().items[0])===m().reference}function u(){return m().is_last_item}function p(){return m().user_flagged}function f(t){var e,n,r;if(e=t?i.appInstance().getItems()[t].questions:s.questions(),Array.isArray(e)&&e.length)for(var a=0;a<e.length;a++){var o=e[a];if(!(r=s.questionResponse(o.response_id)))return!1;if(o.hasOwnProperty("metadata")&&o.metadata.hasOwnProperty("valid_response_count")&&Array.isArray(r.value)){if(r.value.filter((function(t){return void 0===t})).length)return!1;if(r.value.filter((function(t){return null===t})).length)return!1}n=!0}else n=!0;return n}function g(){return Boolean(document.querySelector(".lrn-masking"))}function m(t){return t?i.appInstance().getItems()[t]:i.appInstance().getCurrentItem()}function v(){return i.appInstance().getCurrentItem().attempt_status}function b(t){var e,n=i.appInstance().getItems();for(var r in n)if(n[r].response_ids.includes(t)){e=n[r];break}return e}function y(){return document.querySelector("div[data-reference='".concat(w(),"']"))}function _(){return i.appInstance().assessApp().getItemPosition(w())+1}function w(){return i.appInstance().getCurrentItem().reference}function A(t){return i.appInstance().getTags()[t||w()]||[]}},77:(t,e,n)=>{n.r(e),n.d(e,{answerMasking:()=>o,dialog:()=>l,hideDialog:()=>c,isResponsiveMode:()=>d,isReviewScreen:()=>h,lineReader:()=>u,navigate:()=>p,next:()=>f,previous:()=>g,review:()=>m,submit:()=>v}),n(173);var i=n(4113),r=n(7518),s=n(5059),a={answerMasking:{enabled:null},lineReader:{enabled:null,id:null}};function o(t){if(null===a.answerMasking.enabled){var e=document.querySelector(".test-answer-masking");a.answerMasking.enabled=!!e}a.answerMasking.enabled?void 0!==t&&i.appInstance().questionsApp().masking(t):s.A.warn("Answer masking is not enabled in the Items API configuration.")}function l(t){i.assessApp().dialogs().custom.show(t)}function c(){i.assessApp().dialogs().custom.hide()}function d(){return Boolean(document.querySelector(".has-menu-region"))}function h(){var t=!1;setTimeout((function(){return null===document.getElementsByClassName("review-screen")[0].getAttribute("aria-hidden")&&(t=!0),t}),500)}function u(t){if(null===a.lineReader.enabled){var e=document.querySelector(".lrn_linereader-toggle");if(e){a.lineReader.enabled=!0;var n=e.querySelector("[data-lrn-widget-container]").getAttribute("data-lrn-widget-container").match(/\d+$/);n?a.lineReader.id=n[0]:s.A.warn("Could not find the line reader unique id.")}else a.lineReader.enabled=!1}if(a.lineReader.enabled&&null!==a.lineReader.id){var r=i.appInstance().features()["lrn-assessapp-feature_".concat(a.lineReader.id)];switch(t){case"show":r.show();break;case"hide":r.hide();break;default:r.toggle()}}else s.A.warn("Line reader is not enabled in the Items API configuration.")}function p(t){switch(t){case"previous":i.appInstance().items().previous();break;case"next":r.isLastItem()||i.appInstance().items().next();break;case"review":null===document.getElementsByClassName("review-screen")[0].getAttribute("aria-hidden")?i.appInstance().dialogs().reviewScreen.hide():i.appInstance().dialogs().reviewScreen.show();break;case"submit":var e={show_submit_confirmation:!0,show_submit_ui:!0,success:function(t){alert("Test saved!")},error:function(t){alert("Test submit failed...check browser log"),console.log("Submission failed: ",t)}};i.appInstance().submit(e);break;default:"number"==typeof Number(t)&&Number(t)>=0?i.appInstance().items().goto(Number(t)):s.A.warn("Invalid target (".concat(t,")"))}}function f(){p("next")}function g(){p("previous")}function m(){p("review")}function v(){p("submit")}},3963:(t,e,n)=>{n.r(e),n.d(e,{hasCheckAnswer:()=>o,isAutoScorable:()=>l,question:()=>c,questionInstance:()=>d,questionResponse:()=>u,questionResponseIds:()=>p,questionScore:()=>f,questions:()=>h});var i=n(4113),r=n(7518),s=n(173),a=n(5059);function o(t){var e;if(!l(t))return!1;var n=(null===(e=(0,s.activity)())||void 0===e||null===(e=e.config)||void 0===e||null===(e=e.questions_api_init_options)||void 0===e?void 0:e.attribute_overrides)&&(0,s.activity)().config.questions_api_init_options.attribute_overrides.hasOwnProperty("instant_feedback")&&"boolean"==typeof(0,s.activity)().config.questions_api_init_options.attribute_overrides.instant_feedback,i=c(t);return n?(0,s.activity)().config.questions_api_init_options.attribute_overrides.instant_feedback:!(!i.hasOwnProperty("instant_feedback")||"boolean"!=typeof i.instant_feedback)&&i.instant_feedback}function l(t){return c(t),d(t).checkValidation().has_validation}function c(t){var e=t||p()[0];return e?i.appInstance().question(e).getQuestion():(a.A.error("Question not found (index ".concat(e,")")),{})}function d(t){var e=t||p()[0];return e?i.appInstance().question(e):{}}function h(){return r.item().questions}function u(t){var e=t||p()[0];return e?function(t){return i.appInstance().question(t)?i.appInstance().question(t).getResponse():void a.A.error("Response not found ".concat(t))}(e):{}}function p(){return h().map((function(t){return t.response_id}))}function f(t){var e=t||p()[0];return e&&i.appInstance().getScores()[e]||{}}},7028:(t,e,n)=>{n.r(e),n.d(e,{isFirstItemInSection:()=>s,isLastItemInSection:()=>a,section:()=>o,sectionHasShuffledItems:()=>l,sectionIndex:()=>c,sectionItemPosition:()=>d,sections:()=>h,totalItemsInSection:()=>u});var i=n(173),r=n(7518);function s(){return 1===d()}function a(){return d()===u()}function o(){if(i.hasSections()){for(var t=r.itemReference(),e=h(),n=-1,s=!1,a=0;a<e.length&&!s;a++){++n;for(var o=0;o<e[a].items.length;o++)if(t===e[a].items[o].reference){s=!0;break}}return h()[n]}return{}}function l(){var t;return Boolean(null===(t=o())||void 0===t||null===(t=t.config)||void 0===t||null===(t=t.configuration)||void 0===t?void 0:t.shuffle_items)}function c(){if(i.hasSections()){for(var t=r.itemReference(),e=e(),n=0,s=!1,a=0;a<e.length&&!s;a++){++n;for(var o=0;o<e[a].items.length;o++)if(t===e[a].items[o].reference){s=!0;break}}return n}return 0}function d(){var t=r.itemReference(),e=o(),n=0;if(!Object.keys(e).length)return null;for(var i=0;i<e.items.length&&(++n,t!==e.items[i].reference);i++);return n}function h(){return i.hasSections()?i.activity().sections:[]}function u(){var t;return(null===(t=o())||void 0===t||null===(t=t.items)||void 0===t?void 0:t.length)||null}},5059:(t,e,n)=>{n.d(e,{A:()=>i});const i={debug:function(t,e){"DEBUG"===e&&console.log(t)},error:function(t){console.error("%cError:%c "+t,"display:inline-block;background-color:#e0005a;color:#fff;font-weight:bold;padding:3px 7px;border-radius:3px","")},info:function(t){console.info("%cInfo:%c "+t,"display:inline-block;background-color:#46C0FF;color:#000;font-weight:bold;padding:3px 7px;border-radius:3px","")},log:function(t){console.log(t)},warn:function(t){console.warn("%cWarning:%c "+t,"display:inline-block;background-color:gold;color:#000;font-weight:bold;padding:3px 7px;border-radius:3px","")}}},4196:(t,e,n)=>{var i;!function(){var r=function(){this.init()};r.prototype={init:function(){var t=this||s;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(t){var e=this||s;if(t=parseFloat(t),e.ctx||p(),void 0!==t&&t>=0&&t<=1){if(e._volume=t,e._muted)return e;e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t,s.ctx.currentTime);for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var i=e._howls[n]._getSoundIds(),r=0;r<i.length;r++){var a=e._howls[n]._soundById(i[r]);a&&a._node&&(a._node.volume=a._volume*t)}return e}return e._volume},mute:function(t){var e=this||s;e.ctx||p(),e._muted=t,e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t?0:e._volume,s.ctx.currentTime);for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var i=e._howls[n]._getSoundIds(),r=0;r<i.length;r++){var a=e._howls[n]._soundById(i[r]);a&&a._node&&(a._node.muted=!!t||a._muted)}return e},stop:function(){for(var t=this||s,e=0;e<t._howls.length;e++)t._howls[e].stop();return t},unload:function(){for(var t=this||s,e=t._howls.length-1;e>=0;e--)t._howls[e].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,p()),t},codecs:function(t){return(this||s)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||s;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{(new Audio).muted&&(t.noAudio=!0)}catch(t){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||s,e=null;try{e="undefined"!=typeof Audio?new Audio:null}catch(e){return t}if(!e||"function"!=typeof e.canPlayType)return t;var n=e.canPlayType("audio/mpeg;").replace(/^no$/,""),i=t._navigator?t._navigator.userAgent:"",r=i.match(/OPR\/(\d+)/g),a=r&&parseInt(r[0].split("/")[1],10)<33,o=-1!==i.indexOf("Safari")&&-1===i.indexOf("Chrome"),l=i.match(/Version\/(.*?) /),c=o&&l&&parseInt(l[1],10)<15;return t._codecs={mp3:!(a||!n&&!e.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(e.canPlayType('audio/wav; codecs="1"')||e.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!e.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!e.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(e.canPlayType("audio/x-m4b;")||e.canPlayType("audio/m4b;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(e.canPlayType("audio/x-mp4;")||e.canPlayType("audio/mp4;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(c||!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(c||!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!e.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(e.canPlayType("audio/x-flac;")||e.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_unlockAudio:function(){var t=this||s;if(!t._audioUnlocked&&t.ctx){t._audioUnlocked=!1,t.autoUnlock=!1,t._mobileUnloaded||44100===t.ctx.sampleRate||(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var e=function(n){for(;t._html5AudioPool.length<t.html5PoolSize;)try{var i=new Audio;i._unlocked=!0,t._releaseHtml5Audio(i)}catch(n){t.noAudio=!0;break}for(var r=0;r<t._howls.length;r++)if(!t._howls[r]._webAudio)for(var s=t._howls[r]._getSoundIds(),a=0;a<s.length;a++){var o=t._howls[r]._soundById(s[a]);o&&o._node&&!o._node._unlocked&&(o._node._unlocked=!0,o._node.load())}t._autoResume();var l=t.ctx.createBufferSource();l.buffer=t._scratchBuffer,l.connect(t.ctx.destination),void 0===l.start?l.noteOn(0):l.start(0),"function"==typeof t.ctx.resume&&t.ctx.resume(),l.onended=function(){l.disconnect(0),t._audioUnlocked=!0,document.removeEventListener("touchstart",e,!0),document.removeEventListener("touchend",e,!0),document.removeEventListener("click",e,!0),document.removeEventListener("keydown",e,!0);for(var n=0;n<t._howls.length;n++)t._howls[n]._emit("unlock")}};return document.addEventListener("touchstart",e,!0),document.addEventListener("touchend",e,!0),document.addEventListener("click",e,!0),document.addEventListener("keydown",e,!0),t}},_obtainHtml5Audio:function(){var t=this||s;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var e=(new Audio).play();return e&&"undefined"!=typeof Promise&&(e instanceof Promise||"function"==typeof e.then)&&e.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(t){var e=this||s;return t._unlocked&&e._html5AudioPool.push(t),e},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&s.usingWebAudio){for(var e=0;e<t._howls.length;e++)if(t._howls[e]._webAudio)for(var n=0;n<t._howls[e]._sounds.length;n++)if(!t._howls[e]._sounds[n]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout((function(){if(t.autoSuspend){t._suspendTimer=null,t.state="suspending";var e=function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())};t.ctx.suspend().then(e,e)}}),3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&void 0!==t.ctx.resume&&s.usingWebAudio)return"running"===t.state&&"interrupted"!==t.ctx.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state||"running"===t.state&&"interrupted"===t.ctx.state?(t.ctx.resume().then((function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")})),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var s=new r,a=function(t){t.src&&0!==t.src.length?this.init(t):console.error("An array of source files must be passed with any new Howl.")};a.prototype={init:function(t){var e=this;return s.ctx||p(),e._autoplay=t.autoplay||!1,e._format="string"!=typeof t.format?t.format:[t.format],e._html5=t.html5||!1,e._muted=t.mute||!1,e._loop=t.loop||!1,e._pool=t.pool||5,e._preload="boolean"!=typeof t.preload&&"metadata"!==t.preload||t.preload,e._rate=t.rate||1,e._sprite=t.sprite||{},e._src="string"!=typeof t.src?t.src:[t.src],e._volume=void 0!==t.volume?t.volume:1,e._xhr={method:t.xhr&&t.xhr.method?t.xhr.method:"GET",headers:t.xhr&&t.xhr.headers?t.xhr.headers:null,withCredentials:!(!t.xhr||!t.xhr.withCredentials)&&t.xhr.withCredentials},e._duration=0,e._state="unloaded",e._sounds=[],e._endTimers={},e._queue=[],e._playLock=!1,e._onend=t.onend?[{fn:t.onend}]:[],e._onfade=t.onfade?[{fn:t.onfade}]:[],e._onload=t.onload?[{fn:t.onload}]:[],e._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],e._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],e._onpause=t.onpause?[{fn:t.onpause}]:[],e._onplay=t.onplay?[{fn:t.onplay}]:[],e._onstop=t.onstop?[{fn:t.onstop}]:[],e._onmute=t.onmute?[{fn:t.onmute}]:[],e._onvolume=t.onvolume?[{fn:t.onvolume}]:[],e._onrate=t.onrate?[{fn:t.onrate}]:[],e._onseek=t.onseek?[{fn:t.onseek}]:[],e._onunlock=t.onunlock?[{fn:t.onunlock}]:[],e._onresume=[],e._webAudio=s.usingWebAudio&&!e._html5,void 0!==s.ctx&&s.ctx&&s.autoUnlock&&s._unlockAudio(),s._howls.push(e),e._autoplay&&e._queue.push({event:"play",action:function(){e.play()}}),e._preload&&"none"!==e._preload&&e.load(),e},load:function(){var t=this,e=null;if(s.noAudio)t._emit("loaderror",null,"No audio support.");else{"string"==typeof t._src&&(t._src=[t._src]);for(var n=0;n<t._src.length;n++){var i,r;if(t._format&&t._format[n])i=t._format[n];else{if("string"!=typeof(r=t._src[n])){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(i=/^data:audio\/([^;,]+);/i.exec(r))||(i=/\.([^.]+)$/.exec(r.split("?",1)[0])),i&&(i=i[1].toLowerCase())}if(i||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),i&&s.codecs(i)){e=t._src[n];break}}if(e)return t._src=e,t._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(t._html5=!0,t._webAudio=!1),new o(t),t._webAudio&&c(t),t;t._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(t,e){var n=this,i=null;if("number"==typeof t)i=t,t=null;else{if("string"==typeof t&&"loaded"===n._state&&!n._sprite[t])return null;if(void 0===t&&(t="__default",!n._playLock)){for(var r=0,a=0;a<n._sounds.length;a++)n._sounds[a]._paused&&!n._sounds[a]._ended&&(r++,i=n._sounds[a]._id);1===r?t=null:i=null}}var o=i?n._soundById(i):n._inactiveSound();if(!o)return null;if(i&&!t&&(t=o._sprite||"__default"),"loaded"!==n._state){o._sprite=t,o._ended=!1;var l=o._id;return n._queue.push({event:"play",action:function(){n.play(l)}}),l}if(i&&!o._paused)return e||n._loadQueue("play"),o._id;n._webAudio&&s._autoResume();var c=Math.max(0,o._seek>0?o._seek:n._sprite[t][0]/1e3),d=Math.max(0,(n._sprite[t][0]+n._sprite[t][1])/1e3-c),h=1e3*d/Math.abs(o._rate),u=n._sprite[t][0]/1e3,p=(n._sprite[t][0]+n._sprite[t][1])/1e3;o._sprite=t,o._ended=!1;var f=function(){o._paused=!1,o._seek=c,o._start=u,o._stop=p,o._loop=!(!o._loop&&!n._sprite[t][2])};if(!(c>=p)){var g=o._node;if(n._webAudio){var m=function(){n._playLock=!1,f(),n._refreshBuffer(o);var t=o._muted||n._muted?0:o._volume;g.gain.setValueAtTime(t,s.ctx.currentTime),o._playStart=s.ctx.currentTime,void 0===g.bufferSource.start?o._loop?g.bufferSource.noteGrainOn(0,c,86400):g.bufferSource.noteGrainOn(0,c,d):o._loop?g.bufferSource.start(0,c,86400):g.bufferSource.start(0,c,d),h!==1/0&&(n._endTimers[o._id]=setTimeout(n._ended.bind(n,o),h)),e||setTimeout((function(){n._emit("play",o._id),n._loadQueue()}),0)};"running"===s.state&&"interrupted"!==s.ctx.state?m():(n._playLock=!0,n.once("resume",m),n._clearTimer(o._id))}else{var v=function(){g.currentTime=c,g.muted=o._muted||n._muted||s._muted||g.muted,g.volume=o._volume*s.volume(),g.playbackRate=o._rate;try{var i=g.play();if(i&&"undefined"!=typeof Promise&&(i instanceof Promise||"function"==typeof i.then)?(n._playLock=!0,f(),i.then((function(){n._playLock=!1,g._unlocked=!0,e?n._loadQueue():n._emit("play",o._id)})).catch((function(){n._playLock=!1,n._emit("playerror",o._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),o._ended=!0,o._paused=!0}))):e||(n._playLock=!1,f(),n._emit("play",o._id)),g.playbackRate=o._rate,g.paused)return void n._emit("playerror",o._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==t||o._loop?n._endTimers[o._id]=setTimeout(n._ended.bind(n,o),h):(n._endTimers[o._id]=function(){n._ended(o),g.removeEventListener("ended",n._endTimers[o._id],!1)},g.addEventListener("ended",n._endTimers[o._id],!1))}catch(t){n._emit("playerror",o._id,t)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===g.src&&(g.src=n._src,g.load());var b=window&&window.ejecta||!g.readyState&&s._navigator.isCocoonJS;if(g.readyState>=3||b)v();else{n._playLock=!0,n._state="loading";var y=function(){n._state="loaded",v(),g.removeEventListener(s._canPlayEvent,y,!1)};g.addEventListener(s._canPlayEvent,y,!1),n._clearTimer(o._id)}}return o._id}n._ended(o)},pause:function(t){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var n=e._getSoundIds(t),i=0;i<n.length;i++){e._clearTimer(n[i]);var r=e._soundById(n[i]);if(r&&!r._paused&&(r._seek=e.seek(n[i]),r._rateSeek=0,r._paused=!0,e._stopFade(n[i]),r._node))if(e._webAudio){if(!r._node.bufferSource)continue;void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),e._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||e._emit("pause",r?r._id:null)}return e},stop:function(t,e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(t)}}),n;for(var i=n._getSoundIds(t),r=0;r<i.length;r++){n._clearTimer(i[r]);var s=n._soundById(i[r]);s&&(s._seek=s._start||0,s._rateSeek=0,s._paused=!0,s._ended=!0,n._stopFade(i[r]),s._node&&(n._webAudio?s._node.bufferSource&&(void 0===s._node.bufferSource.stop?s._node.bufferSource.noteOff(0):s._node.bufferSource.stop(0),n._cleanBuffer(s._node)):isNaN(s._node.duration)&&s._node.duration!==1/0||(s._node.currentTime=s._start||0,s._node.pause(),s._node.duration===1/0&&n._clearSound(s._node))),e||n._emit("stop",s._id))}return n},mute:function(t,e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(t,e)}}),n;if(void 0===e){if("boolean"!=typeof t)return n._muted;n._muted=t}for(var i=n._getSoundIds(e),r=0;r<i.length;r++){var a=n._soundById(i[r]);a&&(a._muted=t,a._interval&&n._stopFade(a._id),n._webAudio&&a._node?a._node.gain.setValueAtTime(t?0:a._volume,s.ctx.currentTime):a._node&&(a._node.muted=!!s._muted||t),n._emit("mute",a._id))}return n},volume:function(){var t,e,n,i=this,r=arguments;if(0===r.length)return i._volume;if(1===r.length||2===r.length&&void 0===r[1]?i._getSoundIds().indexOf(r[0])>=0?e=parseInt(r[0],10):t=parseFloat(r[0]):r.length>=2&&(t=parseFloat(r[0]),e=parseInt(r[1],10)),!(void 0!==t&&t>=0&&t<=1))return(n=e?i._soundById(e):i._sounds[0])?n._volume:0;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,r)}}),i;void 0===e&&(i._volume=t),e=i._getSoundIds(e);for(var a=0;a<e.length;a++)(n=i._soundById(e[a]))&&(n._volume=t,r[2]||i._stopFade(e[a]),i._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(t,s.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=t*s.volume()),i._emit("volume",n._id));return i},fade:function(t,e,n,i){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"fade",action:function(){r.fade(t,e,n,i)}}),r;t=Math.min(Math.max(0,parseFloat(t)),1),e=Math.min(Math.max(0,parseFloat(e)),1),n=parseFloat(n),r.volume(t,i);for(var a=r._getSoundIds(i),o=0;o<a.length;o++){var l=r._soundById(a[o]);if(l){if(i||r._stopFade(a[o]),r._webAudio&&!l._muted){var c=s.ctx.currentTime,d=c+n/1e3;l._volume=t,l._node.gain.setValueAtTime(t,c),l._node.gain.linearRampToValueAtTime(e,d)}r._startFadeInterval(l,t,e,n,a[o],void 0===i)}}return r},_startFadeInterval:function(t,e,n,i,r,s){var a=this,o=e,l=n-e,c=Math.abs(l/.01),d=Math.max(4,c>0?i/c:i),h=Date.now();t._fadeTo=n,t._interval=setInterval((function(){var r=(Date.now()-h)/i;h=Date.now(),o+=l*r,o=Math.round(100*o)/100,o=l<0?Math.max(n,o):Math.min(n,o),a._webAudio?t._volume=o:a.volume(o,t._id,!0),s&&(a._volume=o),(n<e&&o<=n||n>e&&o>=n)&&(clearInterval(t._interval),t._interval=null,t._fadeTo=null,a.volume(n,t._id),a._emit("fade",t._id))}),d)},_stopFade:function(t){var e=this,n=e._soundById(t);return n&&n._interval&&(e._webAudio&&n._node.gain.cancelScheduledValues(s.ctx.currentTime),clearInterval(n._interval),n._interval=null,e.volume(n._fadeTo,t),n._fadeTo=null,e._emit("fade",t)),e},loop:function(){var t,e,n,i=this,r=arguments;if(0===r.length)return i._loop;if(1===r.length){if("boolean"!=typeof r[0])return!!(n=i._soundById(parseInt(r[0],10)))&&n._loop;t=r[0],i._loop=t}else 2===r.length&&(t=r[0],e=parseInt(r[1],10));for(var s=i._getSoundIds(e),a=0;a<s.length;a++)(n=i._soundById(s[a]))&&(n._loop=t,i._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=t,t&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop,i.playing(s[a])&&(i.pause(s[a],!0),i.play(s[a],!0)))));return i},rate:function(){var t,e,n,i=this,r=arguments;if(0===r.length?e=i._sounds[0]._id:1===r.length?i._getSoundIds().indexOf(r[0])>=0?e=parseInt(r[0],10):t=parseFloat(r[0]):2===r.length&&(t=parseFloat(r[0]),e=parseInt(r[1],10)),"number"!=typeof t)return(n=i._soundById(e))?n._rate:i._rate;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,r)}}),i;void 0===e&&(i._rate=t),e=i._getSoundIds(e);for(var a=0;a<e.length;a++)if(n=i._soundById(e[a])){i.playing(e[a])&&(n._rateSeek=i.seek(e[a]),n._playStart=i._webAudio?s.ctx.currentTime:n._playStart),n._rate=t,i._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(t,s.ctx.currentTime):n._node&&(n._node.playbackRate=t);var o=i.seek(e[a]),l=1e3*((i._sprite[n._sprite][0]+i._sprite[n._sprite][1])/1e3-o)/Math.abs(n._rate);!i._endTimers[e[a]]&&n._paused||(i._clearTimer(e[a]),i._endTimers[e[a]]=setTimeout(i._ended.bind(i,n),l)),i._emit("rate",n._id)}return i},seek:function(){var t,e,n=this,i=arguments;if(0===i.length?n._sounds.length&&(e=n._sounds[0]._id):1===i.length?n._getSoundIds().indexOf(i[0])>=0?e=parseInt(i[0],10):n._sounds.length&&(e=n._sounds[0]._id,t=parseFloat(i[0])):2===i.length&&(t=parseFloat(i[0]),e=parseInt(i[1],10)),void 0===e)return 0;if("number"==typeof t&&("loaded"!==n._state||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,i)}}),n;var r=n._soundById(e);if(r){if(!("number"==typeof t&&t>=0)){if(n._webAudio){var a=n.playing(e)?s.ctx.currentTime-r._playStart:0,o=r._rateSeek?r._rateSeek-r._seek:0;return r._seek+(o+a*Math.abs(r._rate))}return r._node.currentTime}var l=n.playing(e);l&&n.pause(e,!0),r._seek=t,r._ended=!1,n._clearTimer(e),n._webAudio||!r._node||isNaN(r._node.duration)||(r._node.currentTime=t);var c=function(){l&&n.play(e,!0),n._emit("seek",e)};if(l&&!n._webAudio){var d=function(){n._playLock?setTimeout(d,0):c()};setTimeout(d,0)}else c()}return n},playing:function(t){var e=this;if("number"==typeof t){var n=e._soundById(t);return!!n&&!n._paused}for(var i=0;i<e._sounds.length;i++)if(!e._sounds[i]._paused)return!0;return!1},duration:function(t){var e=this,n=e._duration,i=e._soundById(t);return i&&(n=e._sprite[i._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var t=this,e=t._sounds,n=0;n<e.length;n++)e[n]._paused||t.stop(e[n]._id),t._webAudio||(t._clearSound(e[n]._node),e[n]._node.removeEventListener("error",e[n]._errorFn,!1),e[n]._node.removeEventListener(s._canPlayEvent,e[n]._loadFn,!1),e[n]._node.removeEventListener("ended",e[n]._endFn,!1),s._releaseHtml5Audio(e[n]._node)),delete e[n]._node,t._clearTimer(e[n]._id);var i=s._howls.indexOf(t);i>=0&&s._howls.splice(i,1);var r=!0;for(n=0;n<s._howls.length;n++)if(s._howls[n]._src===t._src||t._src.indexOf(s._howls[n]._src)>=0){r=!1;break}return l&&r&&delete l[t._src],s.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(t,e,n,i){var r=this["_on"+t];return"function"==typeof e&&r.push(i?{id:n,fn:e,once:i}:{id:n,fn:e}),this},off:function(t,e,n){var i=this,r=i["_on"+t],s=0;if("number"==typeof e&&(n=e,e=null),e||n)for(s=0;s<r.length;s++){var a=n===r[s].id;if(e===r[s].fn&&a||!e&&a){r.splice(s,1);break}}else if(t)i["_on"+t]=[];else{var o=Object.keys(i);for(s=0;s<o.length;s++)0===o[s].indexOf("_on")&&Array.isArray(i[o[s]])&&(i[o[s]]=[])}return i},once:function(t,e,n){return this.on(t,e,n,1),this},_emit:function(t,e,n){for(var i=this,r=i["_on"+t],s=r.length-1;s>=0;s--)r[s].id&&r[s].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,n)}.bind(i,r[s].fn),0),r[s].once&&i.off(t,r[s].fn,r[s].id));return i._loadQueue(t),i},_loadQueue:function(t){var e=this;if(e._queue.length>0){var n=e._queue[0];n.event===t&&(e._queue.shift(),e._loadQueue()),t||n.action()}return e},_ended:function(t){var e=this,n=t._sprite;if(!e._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(e._ended.bind(e,t),100),e;var i=!(!t._loop&&!e._sprite[n][2]);if(e._emit("end",t._id),!e._webAudio&&i&&e.stop(t._id,!0).play(t._id),e._webAudio&&i){e._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=s.ctx.currentTime;var r=1e3*(t._stop-t._start)/Math.abs(t._rate);e._endTimers[t._id]=setTimeout(e._ended.bind(e,t),r)}return e._webAudio&&!i&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,e._clearTimer(t._id),e._cleanBuffer(t._node),s._autoSuspend()),e._webAudio||i||e.stop(t._id,!0),e},_clearTimer:function(t){var e=this;if(e._endTimers[t]){if("function"!=typeof e._endTimers[t])clearTimeout(e._endTimers[t]);else{var n=e._soundById(t);n&&n._node&&n._node.removeEventListener("ended",e._endTimers[t],!1)}delete e._endTimers[t]}return e},_soundById:function(t){for(var e=this,n=0;n<e._sounds.length;n++)if(t===e._sounds[n]._id)return e._sounds[n];return null},_inactiveSound:function(){var t=this;t._drain();for(var e=0;e<t._sounds.length;e++)if(t._sounds[e]._ended)return t._sounds[e].reset();return new o(t)},_drain:function(){var t=this,e=t._pool,n=0,i=0;if(!(t._sounds.length<e)){for(i=0;i<t._sounds.length;i++)t._sounds[i]._ended&&n++;for(i=t._sounds.length-1;i>=0;i--){if(n<=e)return;t._sounds[i]._ended&&(t._webAudio&&t._sounds[i]._node&&t._sounds[i]._node.disconnect(0),t._sounds.splice(i,1),n--)}}},_getSoundIds:function(t){if(void 0===t){for(var e=[],n=0;n<this._sounds.length;n++)e.push(this._sounds[n]._id);return e}return[t]},_refreshBuffer:function(t){return t._node.bufferSource=s.ctx.createBufferSource(),t._node.bufferSource.buffer=l[this._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,s.ctx.currentTime),this},_cleanBuffer:function(t){var e=s._navigator&&s._navigator.vendor.indexOf("Apple")>=0;if(!t.bufferSource)return this;if(s._scratchBuffer&&t.bufferSource&&(t.bufferSource.onended=null,t.bufferSource.disconnect(0),e))try{t.bufferSource.buffer=s._scratchBuffer}catch(t){}return t.bufferSource=null,this},_clearSound:function(t){/MSIE |Trident\//.test(s._navigator&&s._navigator.userAgent)||(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var o=function(t){this._parent=t,this.init()};o.prototype={init:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++s._counter,e._sounds.push(t),t.create(),t},create:function(){var t=this,e=t._parent,n=s._muted||t._muted||t._parent._muted?0:t._volume;return e._webAudio?(t._node=void 0===s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),t._node.gain.setValueAtTime(n,s.ctx.currentTime),t._node.paused=!0,t._node.connect(s.masterGain)):s.noAudio||(t._node=s._obtainHtml5Audio(),t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(s._canPlayEvent,t._loadFn,!1),t._endFn=t._endListener.bind(t),t._node.addEventListener("ended",t._endFn,!1),t._node.src=e._src,t._node.preload=!0===e._preload?"auto":e._preload,t._node.volume=n*s.volume(),t._node.load()),t},reset:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++s._counter,t},_errorListener:function(){var t=this;t._parent._emit("loaderror",t._id,t._node.error?t._node.error.code:0),t._node.removeEventListener("error",t._errorFn,!1)},_loadListener:function(){var t=this,e=t._parent;e._duration=Math.ceil(10*t._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),t._node.removeEventListener(s._canPlayEvent,t._loadFn,!1)},_endListener:function(){var t=this,e=t._parent;e._duration===1/0&&(e._duration=Math.ceil(10*t._node.duration)/10,e._sprite.__default[1]===1/0&&(e._sprite.__default[1]=1e3*e._duration),e._ended(t)),t._node.removeEventListener("ended",t._endFn,!1)}};var l={},c=function(t){var e=t._src;if(l[e])return t._duration=l[e].duration,void u(t);if(/^data:[^;]+;base64,/.test(e)){for(var n=atob(e.split(",")[1]),i=new Uint8Array(n.length),r=0;r<n.length;++r)i[r]=n.charCodeAt(r);h(i.buffer,t)}else{var s=new XMLHttpRequest;s.open(t._xhr.method,e,!0),s.withCredentials=t._xhr.withCredentials,s.responseType="arraybuffer",t._xhr.headers&&Object.keys(t._xhr.headers).forEach((function(e){s.setRequestHeader(e,t._xhr.headers[e])})),s.onload=function(){var e=(s.status+"")[0];"0"===e||"2"===e||"3"===e?h(s.response,t):t._emit("loaderror",null,"Failed loading audio file with status: "+s.status+".")},s.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete l[e],t.load())},d(s)}},d=function(t){try{t.send()}catch(e){t.onerror()}},h=function(t,e){var n=function(){e._emit("loaderror",null,"Decoding audio data failed.")},i=function(t){t&&e._sounds.length>0?(l[e._src]=t,u(e,t)):n()};"undefined"!=typeof Promise&&1===s.ctx.decodeAudioData.length?s.ctx.decodeAudioData(t).then(i).catch(n):s.ctx.decodeAudioData(t,i,n)},u=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},p=function(){if(s.usingWebAudio){try{"undefined"!=typeof AudioContext?s.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?s.ctx=new webkitAudioContext:s.usingWebAudio=!1}catch(t){s.usingWebAudio=!1}s.ctx||(s.usingWebAudio=!1);var t=/iP(hone|od|ad)/.test(s._navigator&&s._navigator.platform),e=s._navigator&&s._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=e?parseInt(e[1],10):null;if(t&&n&&n<9){var i=/safari/.test(s._navigator&&s._navigator.userAgent.toLowerCase());s._navigator&&!i&&(s.usingWebAudio=!1)}s.usingWebAudio&&(s.masterGain=void 0===s.ctx.createGain?s.ctx.createGainNode():s.ctx.createGain(),s.masterGain.gain.setValueAtTime(s._muted?0:s._volume,s.ctx.currentTime),s.masterGain.connect(s.ctx.destination)),s._setup()}};void 0===(i=function(){return{Howler:s,Howl:a}}.apply(e,[]))||(t.exports=i),e.Howler=s,e.Howl=a,void 0!==n.g?(n.g.HowlerGlobal=r,n.g.Howler=s,n.g.Howl=a,n.g.Sound=o):"undefined"!=typeof window&&(window.HowlerGlobal=r,window.Howler=s,window.Howl=a,window.Sound=o)}(),function(){var t;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var e=this;if(!e.ctx||!e.ctx.listener)return e;for(var n=e._howls.length-1;n>=0;n--)e._howls[n].stereo(t);return e},HowlerGlobal.prototype.pos=function(t,e,n){var i=this;return i.ctx&&i.ctx.listener?(e="number"!=typeof e?i._pos[1]:e,n="number"!=typeof n?i._pos[2]:n,"number"!=typeof t?i._pos:(i._pos=[t,e,n],void 0!==i.ctx.listener.positionX?(i.ctx.listener.positionX.setTargetAtTime(i._pos[0],Howler.ctx.currentTime,.1),i.ctx.listener.positionY.setTargetAtTime(i._pos[1],Howler.ctx.currentTime,.1),i.ctx.listener.positionZ.setTargetAtTime(i._pos[2],Howler.ctx.currentTime,.1)):i.ctx.listener.setPosition(i._pos[0],i._pos[1],i._pos[2]),i)):i},HowlerGlobal.prototype.orientation=function(t,e,n,i,r,s){var a=this;if(!a.ctx||!a.ctx.listener)return a;var o=a._orientation;return e="number"!=typeof e?o[1]:e,n="number"!=typeof n?o[2]:n,i="number"!=typeof i?o[3]:i,r="number"!=typeof r?o[4]:r,s="number"!=typeof s?o[5]:s,"number"!=typeof t?o:(a._orientation=[t,e,n,i,r,s],void 0!==a.ctx.listener.forwardX?(a.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),a.ctx.listener.forwardY.setTargetAtTime(e,Howler.ctx.currentTime,.1),a.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),a.ctx.listener.upX.setTargetAtTime(i,Howler.ctx.currentTime,.1),a.ctx.listener.upY.setTargetAtTime(r,Howler.ctx.currentTime,.1),a.ctx.listener.upZ.setTargetAtTime(s,Howler.ctx.currentTime,.1)):a.ctx.listener.setOrientation(t,e,n,i,r,s),a)},Howl.prototype.init=(t=Howl.prototype.init,function(e){var n=this;return n._orientation=e.orientation||[1,0,0],n._stereo=e.stereo||null,n._pos=e.pos||null,n._pannerAttr={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:360,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:360,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:0,distanceModel:void 0!==e.distanceModel?e.distanceModel:"inverse",maxDistance:void 0!==e.maxDistance?e.maxDistance:1e4,panningModel:void 0!==e.panningModel?e.panningModel:"HRTF",refDistance:void 0!==e.refDistance?e.refDistance:1,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:1},n._onstereo=e.onstereo?[{fn:e.onstereo}]:[],n._onpos=e.onpos?[{fn:e.onpos}]:[],n._onorientation=e.onorientation?[{fn:e.onorientation}]:[],t.call(this,e)}),Howl.prototype.stereo=function(t,n){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"stereo",action:function(){i.stereo(t,n)}}),i;var r=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof t)return i._stereo;i._stereo=t,i._pos=[t,0,0]}for(var s=i._getSoundIds(n),a=0;a<s.length;a++){var o=i._soundById(s[a]);if(o){if("number"!=typeof t)return o._stereo;o._stereo=t,o._pos=[t,0,0],o._node&&(o._pannerAttr.panningModel="equalpower",o._panner&&o._panner.pan||e(o,r),"spatial"===r?void 0!==o._panner.positionX?(o._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),o._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),o._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):o._panner.setPosition(t,0,0):o._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),i._emit("stereo",o._id)}}return i},Howl.prototype.pos=function(t,n,i,r){var s=this;if(!s._webAudio)return s;if("loaded"!==s._state)return s._queue.push({event:"pos",action:function(){s.pos(t,n,i,r)}}),s;if(n="number"!=typeof n?0:n,i="number"!=typeof i?-.5:i,void 0===r){if("number"!=typeof t)return s._pos;s._pos=[t,n,i]}for(var a=s._getSoundIds(r),o=0;o<a.length;o++){var l=s._soundById(a[o]);if(l){if("number"!=typeof t)return l._pos;l._pos=[t,n,i],l._node&&(l._panner&&!l._panner.pan||e(l,"spatial"),void 0!==l._panner.positionX?(l._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):l._panner.setPosition(t,n,i)),s._emit("pos",l._id)}}return s},Howl.prototype.orientation=function(t,n,i,r){var s=this;if(!s._webAudio)return s;if("loaded"!==s._state)return s._queue.push({event:"orientation",action:function(){s.orientation(t,n,i,r)}}),s;if(n="number"!=typeof n?s._orientation[1]:n,i="number"!=typeof i?s._orientation[2]:i,void 0===r){if("number"!=typeof t)return s._orientation;s._orientation=[t,n,i]}for(var a=s._getSoundIds(r),o=0;o<a.length;o++){var l=s._soundById(a[o]);if(l){if("number"!=typeof t)return l._orientation;l._orientation=[t,n,i],l._node&&(l._panner||(l._pos||(l._pos=s._pos||[0,0,-.5]),e(l,"spatial")),void 0!==l._panner.orientationX?(l._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):l._panner.setOrientation(t,n,i)),s._emit("orientation",l._id)}}return s},Howl.prototype.pannerAttr=function(){var t,n,i,r=this,s=arguments;if(!r._webAudio)return r;if(0===s.length)return r._pannerAttr;if(1===s.length){if("object"!=typeof s[0])return(i=r._soundById(parseInt(s[0],10)))?i._pannerAttr:r._pannerAttr;t=s[0],void 0===n&&(t.pannerAttr||(t.pannerAttr={coneInnerAngle:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle,coneOuterGain:t.coneOuterGain,distanceModel:t.distanceModel,maxDistance:t.maxDistance,refDistance:t.refDistance,rolloffFactor:t.rolloffFactor,panningModel:t.panningModel}),r._pannerAttr={coneInnerAngle:void 0!==t.pannerAttr.coneInnerAngle?t.pannerAttr.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:void 0!==t.pannerAttr.coneOuterAngle?t.pannerAttr.coneOuterAngle:r._coneOuterAngle,coneOuterGain:void 0!==t.pannerAttr.coneOuterGain?t.pannerAttr.coneOuterGain:r._coneOuterGain,distanceModel:void 0!==t.pannerAttr.distanceModel?t.pannerAttr.distanceModel:r._distanceModel,maxDistance:void 0!==t.pannerAttr.maxDistance?t.pannerAttr.maxDistance:r._maxDistance,refDistance:void 0!==t.pannerAttr.refDistance?t.pannerAttr.refDistance:r._refDistance,rolloffFactor:void 0!==t.pannerAttr.rolloffFactor?t.pannerAttr.rolloffFactor:r._rolloffFactor,panningModel:void 0!==t.pannerAttr.panningModel?t.pannerAttr.panningModel:r._panningModel})}else 2===s.length&&(t=s[0],n=parseInt(s[1],10));for(var a=r._getSoundIds(n),o=0;o<a.length;o++)if(i=r._soundById(a[o])){var l=i._pannerAttr;l={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:l.coneOuterAngle,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:l.coneOuterGain,distanceModel:void 0!==t.distanceModel?t.distanceModel:l.distanceModel,maxDistance:void 0!==t.maxDistance?t.maxDistance:l.maxDistance,refDistance:void 0!==t.refDistance?t.refDistance:l.refDistance,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:l.rolloffFactor,panningModel:void 0!==t.panningModel?t.panningModel:l.panningModel};var c=i._panner;c||(i._pos||(i._pos=r._pos||[0,0,-.5]),e(i,"spatial"),c=i._panner),c.coneInnerAngle=l.coneInnerAngle,c.coneOuterAngle=l.coneOuterAngle,c.coneOuterGain=l.coneOuterGain,c.distanceModel=l.distanceModel,c.maxDistance=l.maxDistance,c.refDistance=l.refDistance,c.rolloffFactor=l.rolloffFactor,c.panningModel=l.panningModel}return r},Sound.prototype.init=function(t){return function(){var e=this,n=e._parent;e._orientation=n._orientation,e._stereo=n._stereo,e._pos=n._pos,e._pannerAttr=n._pannerAttr,t.call(this),e._stereo?n.stereo(e._stereo):e._pos&&n.pos(e._pos[0],e._pos[1],e._pos[2],e._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var e=this,n=e._parent;return e._orientation=n._orientation,e._stereo=n._stereo,e._pos=n._pos,e._pannerAttr=n._pannerAttr,e._stereo?n.stereo(e._stereo):e._pos?n.pos(e._pos[0],e._pos[1],e._pos[2],e._id):e._panner&&(e._panner.disconnect(0),e._panner=void 0,n._refreshBuffer(e)),t.call(this)}}(Sound.prototype.reset);var e=function(t,e){"spatial"===(e=e||"spatial")?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,void 0!==t._panner.positionX?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),void 0!==t._panner.orientationX?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}}()},6411:(t,e,n)=>{var i;!function(r,s){if(r){for(var a,o={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},l={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},c={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},d={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},h=1;h<20;++h)o[111+h]="f"+h;for(h=0;h<=9;++h)o[h+96]=h.toString();b.prototype.bind=function(t,e,n){var i=this;return t=t instanceof Array?t:[t],i._bindMultiple.call(i,t,e,n),i},b.prototype.unbind=function(t,e){return this.bind.call(this,t,(function(){}),e)},b.prototype.trigger=function(t,e){var n=this;return n._directMap[t+":"+e]&&n._directMap[t+":"+e]({},t),n},b.prototype.reset=function(){var t=this;return t._callbacks={},t._directMap={},t},b.prototype.stopCallback=function(t,e){if((" "+e.className+" ").indexOf(" mousetrap ")>-1)return!1;if(v(e,this.target))return!1;if("composedPath"in t&&"function"==typeof t.composedPath){var n=t.composedPath()[0];n!==t.target&&(e=n)}return"INPUT"==e.tagName||"SELECT"==e.tagName||"TEXTAREA"==e.tagName||e.isContentEditable},b.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},b.addKeycodes=function(t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e]);a=null},b.init=function(){var t=b(s);for(var e in t)"_"!==e.charAt(0)&&(b[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e))},b.init(),r.Mousetrap=b,t.exports&&(t.exports=b),void 0===(i=function(){return b}.call(e,n,e,t))||(t.exports=i)}function u(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)}function p(t){if("keypress"==t.type){var e=String.fromCharCode(t.which);return t.shiftKey||(e=e.toLowerCase()),e}return o[t.which]?o[t.which]:l[t.which]?l[t.which]:String.fromCharCode(t.which).toLowerCase()}function f(t){return"shift"==t||"ctrl"==t||"alt"==t||"meta"==t}function g(t,e,n){return n||(n=function(){if(!a)for(var t in a={},o)t>95&&t<112||o.hasOwnProperty(t)&&(a[o[t]]=t);return a}()[t]?"keydown":"keypress"),"keypress"==n&&e.length&&(n="keydown"),n}function m(t,e){var n,i,r,s=[];for(n=function(t){return"+"===t?["+"]:(t=t.replace(/\+{2}/g,"+plus")).split("+")}(t),r=0;r<n.length;++r)i=n[r],d[i]&&(i=d[i]),e&&"keypress"!=e&&c[i]&&(i=c[i],s.push("shift")),f(i)&&s.push(i);return{key:i,modifiers:s,action:e=g(i,s,e)}}function v(t,e){return null!==t&&t!==s&&(t===e||v(t.parentNode,e))}function b(t){var e=this;if(t=t||s,!(e instanceof b))return new b(t);e.target=t,e._callbacks={},e._directMap={};var n,i={},r=!1,a=!1,o=!1;function l(t){t=t||{};var e,n=!1;for(e in i)t[e]?n=!0:i[e]=0;n||(o=!1)}function c(t,n,r,s,a,o){var l,c,d,h,u=[],p=r.type;if(!e._callbacks[t])return[];for("keyup"==p&&f(t)&&(n=[t]),l=0;l<e._callbacks[t].length;++l)if(c=e._callbacks[t][l],(s||!c.seq||i[c.seq]==c.level)&&p==c.action&&("keypress"==p&&!r.metaKey&&!r.ctrlKey||(d=n,h=c.modifiers,d.sort().join(",")===h.sort().join(",")))){var g=!s&&c.combo==a,m=s&&c.seq==s&&c.level==o;(g||m)&&e._callbacks[t].splice(l,1),u.push(c)}return u}function d(t,n,i,r){e.stopCallback(n,n.target||n.srcElement,i,r)||!1===t(n,i)&&(function(t){t.preventDefault?t.preventDefault():t.returnValue=!1}(n),function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}(n))}function h(t){"number"!=typeof t.which&&(t.which=t.keyCode);var n=p(t);n&&("keyup"!=t.type||r!==n?e.handleKey(n,function(t){var e=[];return t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),t.ctrlKey&&e.push("ctrl"),t.metaKey&&e.push("meta"),e}(t),t):r=!1)}function g(t,s,a,h,u){e._directMap[t+":"+a]=s;var f,v=(t=t.replace(/\s+/g," ")).split(" ");v.length>1?function(t,e,s,a){function c(e){return function(){o=e,++i[t],clearTimeout(n),n=setTimeout(l,1e3)}}function h(e){d(s,e,t),"keyup"!==a&&(r=p(e)),setTimeout(l,10)}i[t]=0;for(var u=0;u<e.length;++u){var f=u+1===e.length?h:c(a||m(e[u+1]).action);g(e[u],f,a,t,u)}}(t,v,s,a):(f=m(t,a),e._callbacks[f.key]=e._callbacks[f.key]||[],c(f.key,f.modifiers,{type:f.action},h,t,u),e._callbacks[f.key][h?"unshift":"push"]({callback:s,modifiers:f.modifiers,action:f.action,seq:h,level:u,combo:t}))}e._handleKey=function(t,e,n){var i,r=c(t,e,n),s={},h=0,u=!1;for(i=0;i<r.length;++i)r[i].seq&&(h=Math.max(h,r[i].level));for(i=0;i<r.length;++i)if(r[i].seq){if(r[i].level!=h)continue;u=!0,s[r[i].seq]=1,d(r[i].callback,n,r[i].combo,r[i].seq)}else u||d(r[i].callback,n,r[i].combo);var p="keypress"==n.type&&a;n.type!=o||f(t)||p||l(s),a=u&&"keydown"==n.type},e._bindMultiple=function(t,e,n){for(var i=0;i<t.length;++i)g(t[i],e,n)},u(t,"keypress",h),u(t,"keydown",h),u(t,"keyup",h)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},6254:function(t){t.exports=function(){function t(t,e){var n=window.matchMedia(t);e(n.matches);var i=function(){return e(n.matches)};return n.addListener(i),function(){return n.removeListener(i)}}function e(t,e){return s[t]!==e&&(s[t]=e,o(t,e),!0)}var n="undefined"!=typeof navigator&&"undefined"!=typeof window;if(n&&"undefined"!=typeof nw)try{nw.Window.get()}catch(t){n=!1}var i=!n,r=n?navigator.userAgent:void 0,s={gui:n,terminal:i,registerQuery:t};s.node="undefined"!=typeof process&&!!process.versions&&!!process.versions.node,s.pwa=s.gui&&window.matchMedia("(display-mode: standalone)").matches&&null!==document.head.querySelector('[rel="manifest"]'),s.uwp="undefined"!=typeof Windows&&"undefined"!=typeof MSApp,s.nwjs=!(!s.node||!process.versions.nw),s.electron=!(!s.node||!process.versions.electron),s.cordova=!(!s.gui||!window.cordova),s.packaged=s.uwp||s.nwjs||s.electron||s.cordova,s.web=!s.node&&!s.packaged,s.browser=s.web,s.website=s.web&&!s.pwa,s.worker=!s.gui&&"undefined"!=typeof self&&void 0!==self.importScripts,s.serviceWorker=s.worker&&!!navigator.serviceWorker.controller||!1,s.android=!!s.gui&&r.includes("Android"),s.chromeos=!!s.gui&&r.includes("CrOS"),s.tizen=!!s.gui&&r.includes("Tizen"),s.ios=s.gui&&/iPad|iPhone|iPod/.test(r)&&!window.MSStream||!1,s.linuxBased=s.android||s.tizen,s.windows=s.node?"win32"===process.platform:r.includes("Windows"),s.macos=s.node?"darwin"===process.platform:r.includes("Macintosh"),s.linux=s.node?"linux"===process.platform:r.includes("Linux")&&!s.linuxBased&&!s.macos,s.edgeHtml=s.gui&&r.includes("Edge/"),s.edgeChromium=s.gui&&r.includes("Edg/"),s.edgeAndroid=s.gui&&r.includes("EdgA/"),s.edgeIos=s.gui&&r.includes("EdgiOS/"),s.chromeIos=s.gui&&r.includes("CriOS/"),s.firefoxIos=s.gui&&r.includes("FxiOS/"),s.edge=s.edgeHtml||s.edgeChromium||s.edgeAndroid||s.edgeIos,s.samsungBrowser=s.gui&&r.includes("SamsungBrowser/"),s.opera=s.gui&&(r.includes("Opera")||r.includes("OPR/")),s.firefox=s.gui&&(r.includes("Firefox")||s.firefoxIos),s.chrome=s.gui&&(r.includes("Chrome")||s.chromeIos)&&!s.edge&&!s.opera&&!s.samsungBrowser,s.safari=s.gui&&r.includes("Safari")&&!s.chrome&&!s.edge&&!s.firefox&&!s.opera&&!s.samsungBrowser||s.edgeIos||s.chromeIos||s.firefoxIos,s.ie=s.trident=s.gui&&r.includes("Trident"),s.blink=s.chrome&&!s.chromeIos||s.edgeChromium||s.edgeAndroid||s.samsungBrowser,s.webkit=s.blink||s.safari,s.gecko=s.firefox&&!s.firefoxIos&&!s.webkit&&!s.safari;var a={};s.on=function(t,e){a[t]=a[t]||new Set,a[t].add(e)},s.off=s.removeListener=function(t,e){a[t]&&a[t].delete(e)};var o=s.emit=function(t,e){a[t]&&a[t].forEach((function(t){return t(e)}))};if(s.gui){s.pixelRatio=parseFloat(window.devicePixelRatio.toFixed(2)),s.gameconsole=r.includes("Xbox")||r.includes("PlayStation");var l=0;if(window.addEventListener("gamepadconnected",(function(t){return l++})),window.addEventListener("gamepaddisconnected",(function(t){return l--})),s.gameconsole)s.gamepad=!0,s.mouse=!0,s.touch=!1,s.tv=!0,s.battery=!1,s.phone=s.tablet=s.hybrid=s.laptop=s.desktop=!1,s.formfactor="gameconsole";else{var c=function(){e("tv","tv"===s.formfactor),e("phone","phone"===s.formfactor),e("tablet","tablet"===s.formfactor),e("hybrid","hybrid"===s.formfactor),e("laptop","laptop"===s.formfactor),e("desktop","desktop"===s.formfactor)},d=function(){var t=Math.min(window.screen.width,window.screen.height);return s.tv?"tv":s.touch&&t<600?"phone":s.touch&&!s.mouse?"tablet":s.touch&&s.mouse?"hybrid":s.battery?"laptop":"desktop"};s.touch=navigator.maxTouchPoints>0,s.tv=r.includes("TV"),l=navigator.getGamepads?Array.from(navigator.getGamepads()).filter((function(t){return null!=t})).length:0,s.gamepad=l>0,t("(orientation: portrait)",(function(t){s.portrait=t,s.landscape=!t,s.orientation=t?"portrait":"landscape",o("portrait",s.portrait),o("landscape",s.landscape),o("orientation",s.orientation)})),t("(any-pointer: coarse)",(function(t){e("touch",t),e("formfactor",d())&&c()})),t("(hover: hover)",(function(t){e("mouse",t),e("input",t?"mouse":"touch"),e("formfactor",d())&&c()}))}}return s.csp=s.uwp||!1,s.nwjs?s.dev="sdk"===process.versions["nw-flavor"]:s.electron?s.dev=process.execPath.replace(/\\/g,"/").includes("node_modules/electron/"):s.uwp?s.dev=Windows.ApplicationModel.Package.current.isDevelopmentMode:s.node?s.dev=!1:s.dev=void 0,s}()},7391:(t,e,n)=>{var i=n(7180),r=n(3181),s=n(3031),a=n(9067),o=n(6833),l=n(3717),c=n(4801);c.alea=i,c.xor128=r,c.xorwow=s,c.xorshift7=a,c.xor4096=o,c.tychei=l,t.exports=c},7180:function(t,e,n){var i;!function(t,r){function s(t){var e,n=this,i=(e=4022871197,function(t){t=String(t);for(var n=0;n<t.length;n++){var i=.02519603282416938*(e+=t.charCodeAt(n));i-=e=i>>>0,e=(i*=e)>>>0,e+=4294967296*(i-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=i(" "),n.s1=i(" "),n.s2=i(" "),n.s0-=i(t),n.s0<0&&(n.s0+=1),n.s1-=i(t),n.s1<0&&(n.s1+=1),n.s2-=i(t),n.s2<0&&(n.s2+=1),i=null}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function o(t,e){var n=new s(t),i=e&&e.state,r=n.next;return r.int32=function(){return 4294967296*n.next()|0},r.double=function(){return r()+11102230246251565e-32*(2097152*r()|0)},r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=o:n.amdD&&n.amdO?void 0===(i=function(){return o}.call(e,n,e,r))||(r.exports=i):this.alea=o}(0,t=n.nmd(t),n.amdD)},3717:function(t,e,n){var i;!function(t,r){function s(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,i=e.d,r=e.a;return t=t<<25^t>>>7^n,n=n-i|0,i=i<<24^i>>>8^r,r=r-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-i|0,e.d=i<<16^n>>>16^r,e.a=r-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var i=0;i<n.length+20;i++)e.b^=0|n.charCodeAt(i),e.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function o(t,e){var n=new s(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=o:n.amdD&&n.amdO?void 0===(i=function(){return o}.call(e,n,e,r))||(r.exports=i):this.tychei=o}(0,t=n.nmd(t),n.amdD)},3181:function(t,e,n){var i;!function(t,r){function s(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function o(t,e){var n=new s(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=o:n.amdD&&n.amdO?void 0===(i=function(){return o}.call(e,n,e,r))||(r.exports=i):this.xor128=o}(0,t=n.nmd(t),n.amdD)},6833:function(t,e,n){var i;!function(t,r){function s(t){var e=this;e.next=function(){var t,n,i=e.w,r=e.X,s=e.i;return e.w=i=i+1640531527|0,n=r[s+34&127],t=r[s=s+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=r[s]=n^t,e.i=s,n+(i^i>>>16)|0},function(t,e){var n,i,r,s,a,o=[],l=128;for(e===(0|e)?(i=e,e=null):(e+="\0",i=0,l=Math.max(l,e.length)),r=0,s=-32;s<l;++s)e&&(i^=e.charCodeAt((s+32)%e.length)),0===s&&(a=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,s>=0&&(a=a+1640531527|0,r=0==(n=o[127&s]^=i+a)?r+1:0);for(r>=128&&(o[127&(e&&e.length||0)]=-1),r=127,s=512;s>0;--s)i=o[r+34&127],n=o[r=r+1&127],i^=i<<13,n^=n<<17,i^=i>>>15,n^=n>>>12,o[r]=i^n;t.w=a,t.X=o,t.i=r}(e,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function o(t,e){null==t&&(t=+new Date);var n=new s(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.X&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=o:n.amdD&&n.amdO?void 0===(i=function(){return o}.call(e,n,e,r))||(r.exports=i):this.xor4096=o}(0,t=n.nmd(t),n.amdD)},9067:function(t,e,n){var i;!function(t,r){function s(t){var e=this;e.next=function(){var t,n,i=e.x,r=e.i;return t=i[r],n=(t^=t>>>7)^t<<24,n^=(t=i[r+1&7])^t>>>10,n^=(t=i[r+3&7])^t>>>3,n^=(t=i[r+4&7])^t<<7,t=i[r+7&7],n^=(t^=t<<13)^t<<9,i[r]=n,e.i=r+1&7,n},function(t,e){var n,i=[];if(e===(0|e))i[0]=e;else for(e=""+e,n=0;n<e.length;++n)i[7&n]=i[7&n]<<15^e.charCodeAt(n)+i[n+1&7]<<13;for(;i.length<8;)i.push(0);for(n=0;n<8&&0===i[n];++n);for(8==n?i[7]=-1:i[n],t.x=i,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function o(t,e){null==t&&(t=+new Date);var n=new s(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.x&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=o:n.amdD&&n.amdO?void 0===(i=function(){return o}.call(e,n,e,r))||(r.exports=i):this.xorshift7=o}(0,t=n.nmd(t),n.amdD)},3031:function(t,e,n){var i;!function(t,r){function s(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),i==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function o(t,e){var n=new s(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=o:n.amdD&&n.amdO?void 0===(i=function(){return o}.call(e,n,e,r))||(r.exports=i):this.xorwow=o}(0,t=n.nmd(t),n.amdD)},4801:function(t,e,n){var i;!function(r,s,a){var o,l=256,c=a.pow(l,6),d=a.pow(2,52),h=2*d,u=255;function p(t,e,n){var i=[],u=v(m((e=1==e?{entropy:!0}:e||{}).entropy?[t,b(s)]:null==t?function(){try{var t;return o&&(t=o.randomBytes)?t=t(l):(t=new Uint8Array(l),(r.crypto||r.msCrypto).getRandomValues(t)),b(t)}catch(t){var e=r.navigator,n=e&&e.plugins;return[+new Date,r,n,r.screen,b(s)]}}():t,3),i),p=new f(i),y=function(){for(var t=p.g(6),e=c,n=0;t<d;)t=(t+n)*l,e*=l,n=p.g(1);for(;t>=h;)t/=2,e/=2,n>>>=1;return(t+n)/e};return y.int32=function(){return 0|p.g(4)},y.quick=function(){return p.g(4)/4294967296},y.double=y,v(b(p.S),s),(e.pass||n||function(t,e,n,i){return i&&(i.S&&g(i,p),t.state=function(){return g(p,{})}),n?(a.random=t,e):t})(y,u,"global"in e?e.global:this==a,e.state)}function f(t){var e,n=t.length,i=this,r=0,s=i.i=i.j=0,a=i.S=[];for(n||(t=[n++]);r<l;)a[r]=r++;for(r=0;r<l;r++)a[r]=a[s=u&s+t[r%n]+(e=a[r])],a[s]=e;(i.g=function(t){for(var e,n=0,r=i.i,s=i.j,a=i.S;t--;)e=a[r=u&r+1],n=n*l+a[u&(a[r]=a[s=u&s+e])+(a[s]=e)];return i.i=r,i.j=s,n})(l)}function g(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){var n,i=[],r=typeof t;if(e&&"object"==r)for(n in t)try{i.push(m(t[n],e-1))}catch(t){}return i.length?i:"string"==r?t:t+"\0"}function v(t,e){for(var n,i=t+"",r=0;r<i.length;)e[u&r]=u&(n^=19*e[u&r])+i.charCodeAt(r++);return b(e)}function b(t){return String.fromCharCode.apply(0,t)}if(v(a.random(),s),t.exports){t.exports=p;try{o=n(1234)}catch(t){}}else void 0===(i=function(){return p}.call(e,n,e,t))||(t.exports=i)}("undefined"!=typeof self?self:this,[],Math)},1234:()=>{}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.m=t,n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.u=t=>t+".js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t;if("string"==typeof import.meta.url&&(t=import.meta.url),!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t+"../"})(),n.b=new URL("../",import.meta.url);var i={};n.d(i,{LT:()=>qa});var r={};n.r(r),n.d(r,{run:()=>E});var s={};n.r(s),n.d(s,{run:()=>S});var a={};n.r(a),n.d(a,{run:()=>F});var o={};n.r(o),n.d(o,{run:()=>B});var l={};n.r(l),n.d(l,{escapeHTML:()=>$,getTabsTheme:()=>K,run:()=>W,validateOptions:()=>X});var c={};n.r(c),n.d(c,{run:()=>Q});var d={};n.r(d),n.d(d,{run:()=>_t});var h={};n.r(h),n.d(h,{run:()=>xe});var u={};n.r(u),n.d(u,{run:()=>ke});var p={};n.r(p),n.d(p,{run:()=>Le,setupButtons:()=>Pe,toggle:()=>Re});var f={};n.r(f),n.d(f,{run:()=>Be});var g={};n.r(g),n.d(g,{run:()=>$e});var m={};n.r(m),n.d(m,{halt:()=>en,run:()=>tn});var v={};n.r(v),n.d(v,{run:()=>va});var b={};n.r(b),n.d(b,{run:()=>wa});var y={};n.r(y),n.d(y,{run:()=>Sa,toggle:()=>Ta});var _={};n.r(_),n.d(_,{launchPlayer:()=>Ia,run:()=>Ma});var w=n(8097),A=n(4113),x=n(173);function E(){A.appInstance().on("item:load",(function(){for(var t=x.totalItems(),e=Array.from(document.getElementsByClassName("item-prev")),n=Array.from(document.getElementsByClassName("item-next")),i=e.concat(n),r=0;r<i.length;r++){var s=i[r].getAttribute("aria-label");i[r].setAttribute("aria-live",s+" of "+t)}}))}function S(){A.appInstance().on("item:load",(function(t){T()})),A.annotationsApp().on("notepad:toggleVisibility",(function(t){T()})),A.annotationsApp().on("stickynote:add",(function(t){T()}))}function T(){for(var t,e=[],n=["lrn_texteditor_editable"],i=document.getElementById("learnosity_assess"),r=0;r<n.length;r++)if((e=i.getElementsByClassName(n[r])).length)for(var s=0;s<e.length;s++)C(e[s]);t=i.getElementsByTagName("textarea");for(var a=0;a<t.length;a++)C(t[a])}function C(t){t.setAttribute("data-gramm","false"),t.setAttribute("data-gramm_editor","false"),t.setAttribute("data-enable-grammarly","false"),t.setAttribute("spellcheck","false"),t.setAttribute("autocorrect","false"),t.setAttribute("autocomplete","false"),t.setAttribute("autocapitalize","false")}var k=n(3963),M=n(5059),I=n(77);function L(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return P(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){o=!0,s=t},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw s}}}}function P(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var R="ERROR",D={message:{header:"Please check your answers",body:'<p>Before moving on, attempt all questions and click the "Check Answer" button.</p>\n            <p>Note: the "Check Answer" button may not appear on every question.</p>'}};function F(t){var e,n;t&&null!=t&&t.message&&(null!==(e=D.message)&&void 0!==e&&e.header.length&&(D.message.header=t.message.header),null!==(n=D.message)&&void 0!==n&&n.body.length&&(D.message.body=t.message.body)),A.appInstance().on("item:beforeunload",(function(t){!function(t){(function(){var t,e=!1,n=L(k.questions());try{for(n.s();!(t=n.n()).done;){var i=t.value.response_id;if(k.hasCheckAnswer(i)){e=!0;break}}}catch(t){n.e(t)}finally{n.f()}return e})()&&(function(){var t,e=L(k.questions());try{for(e.s();!(t=e.n()).done;){var n=t.value.response_id;if(k.hasCheckAnswer(n)&&(!k.questionResponse(n)||!k.questionResponse(n).hasOwnProperty("feedbackAttemptsCount")))return!1}}catch(t){e.e(t)}finally{e.f()}return!0}()||(M.A.debug("Disabling navigation.",R),t.preventDefault(),(0,I.dialog)({header:D.message.header,body:D.message.body,buttons:[{button_id:"lt__check_answer_validation",label:"Close",is_primary:!1}]}),A.assessApp().on("button:lt__check_answer_validation:clicked",(function(){(0,I.hideDialog)()}))))}(t)}))}var O=n(7518),N={renderedCss:!1,resize:{triggered:!1}};function B(){var t;N.renderedCss||((t=document.createElement("style")).textContent="\n/* Learnosity column resizer styles */\n.lrn-resizer {\n    background-color: #e8e8e8;\n    cursor: grab;\n    width: 3px;\n    padding: 0;\n    position: relative;\n}\n.lrn-resizer span {\n    position: relative;\n    width: 45px;\n    height: 30px;\n    border: 1px solid #e4e4e4;\n    left: -22px;\n    border-radius: 3px;\n    cursor: grab;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 1.5em;\n    z-index: 2;\n    padding-bottom: 3px;\n    color: #444;\n\n    -webkit-user-select: none;\n    user-select: none;\n\n    background: rgb(233,233,233);\n    background: linear-gradient(0deg, rgba(233,233,233,1) 0%, rgba(250,250,250,1) 51%, rgba(238,238,238,1) 100%);\n}\n.row {\n    display: flex;\n}\n.col-xs-6.lrn-column-left {\n    display: flex;\n    min-width: 5em;\n    overflow: hidden;\n}\n.col-xs-6.lrn-column-right {\n    display: flex;\n\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    min-width: 5em;\n    overflow: hidden;\n}\n.lrn-column-left .lrn_widget,\n.lrn-column-right .lrn_widget {\n    padding: 1.5em;\n}\n@media (max-width: 650px) {\n    .lrn-resizer {\n        display: none;\n    }\n}\n",document.head.append(t),N.renderedCss=!0),A.appInstance().on("item:load",(function(){q()})),window.addEventListener("resize",function(t){var e,n=this;return N.resize.triggered||(N.resize.triggered=!0,t.apply(this)),function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];clearTimeout(e),e=setTimeout((function(){N.resize.triggered=!1,t.apply(n,r)}),250)}}(q))}function q(){var t=O.itemElement(),e=t.querySelectorAll('[class^="col-"]'),n=Boolean(t.querySelector(".lrn-resizer")),i=Boolean(document.querySelector(".lrn-layout-single-column"));if(2===e.length){if(i||n)i&&n&&function(t,e){var n=t.querySelector(".lrn-resizer");n&&n.remove(),e[0].removeAttribute("style"),window.dispatchEvent(new Event("resize"))}(t,e);else{var r=document.createElement("div");r.setAttribute("tooltip","Click and hold to drag column width");var s=document.createElement("span");s.innerHTML="↤ ↦",r.classList.add("lrn-resizer"),e[0].classList.add("lrn-column-left"),e[1].classList.add("lrn-column-right"),r.append(s),e[0].after(r)}!function(t){var e=t.querySelector(".lrn-resizer");e&&function(t){var e=t.previousElementSibling,n=0,i=0,r=function(t){n=t instanceof MouseEvent?t.clientX:t.targetTouches[0].clientX;var r=e.getBoundingClientRect();i=r.width,document.addEventListener("mousemove",s),document.addEventListener("mouseup",a),document.addEventListener("touchmove",s),document.addEventListener("touchend",a)},s=function(r){var s;s=r instanceof MouseEvent?r.clientX-n:r.targetTouches[0].clientX-n;var a=100*(i+s)/t.parentNode.getBoundingClientRect().width;a>=10&&a<=90&&(e.style.width=a+"%")},a=function(){document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",a),document.removeEventListener("touchmove",s),document.removeEventListener("touchend",a)};t.addEventListener("mousedown",r),t.addEventListener("touchstart",r)}(e)}(t)}}function H(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function j(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?H(Object(n),!0).forEach((function(e){z(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function z(t,e,n){return(e=function(t){var e=function(t){if("object"!=U(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=U(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==U(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function V(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var G={options:{theme:"default"},renderedCss:!1};function W(t){var e,n;X(t),G.renderedCss||(e=document.createElement("style"),n="/* Learnosity content tab styles */",n+=K(),e.textContent=n,document.head.append(e),G.renderedCss=!0),A.appInstance().on("item:load",(function(t){var e=O.itemReference(),n=document.querySelector('div[data-reference="'.concat(e,'"]')).querySelectorAll("ul.lt__nav-tabs");if(n){var i,r=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return V(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?V(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){o=!0,s=t},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw s}}}}(n);try{for(r.s();!(i=r.n()).done;){var s=i.value,a=s.getAttribute("style");if(!a||!a.includes("--tab-count")){var o=s.querySelectorAll("li");s.style.setProperty("--tab-count",o.length),s.querySelectorAll("a[data-tab-target]").forEach((function(t){if(!t.hasAttribute("title")){var e=$(t.textContent.trim());t.setAttribute("title",e)}}))}}}catch(t){r.e(t)}finally{r.f()}}}))}function $(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function X(t){t&&"object"===U(t)&&(G.options=j(j({},G.options),t))}function K(){var t="";switch(G.options.theme){case"default":t="\n            /* Default theme */\n            .lrn.lrn-assess .lt__tabs,\n            .lrn-author-item-content-wrapper .lt__tabs {\n                .lt__nav-tabs {\n                    container-type: inline-size;\n                    display: block;\n\n                    li {\n                        min-width: 0;\n\n                        a {\n                            text-decoration: none;\n                            color: #333;\n                            overflow: hidden;\n                            max-width: 100px;\n                            text-overflow: ellipsis;\n                            display: inline-block;\n                            white-space: nowrap;\n                        }\n\n                        @container (min-width: 200px) {\n                            a {\n                                max-width: calc(200px / var(--tab-count));\n                            }\n                        }\n                        @container (min-width: 250px) {\n                            a {\n                                max-width: calc(240px / var(--tab-count));\n                            }\n                        }\n                        @container (min-width: 300px) {\n                            a {\n                                max-width: calc(290px / var(--tab-count));\n                            }\n                        }\n                        @container (min-width: 330px) {\n                            a {\n                                max-width: calc(320px / var(--tab-count));\n                            }\n                        }\n                        @container (min-width: 400px) {\n                            a {\n                                max-width: calc(400px / var(--tab-count));\n                            }\n                        }\n                        @container (min-width: 500px) {\n                            a {\n                                max-width: calc(550px / var(--tab-count));\n                            }\n                        }\n                        @container (min-width: 600px) {\n                            a {\n                                max-width: calc(700px / var(--tab-count));\n                            }\n                        }\n                        @container (min-width: 700px) {\n                            a {\n                                max-width: calc(1000px / var(--tab-count));\n                            }\n                        }\n                        @container (min-width: 800px) {\n                            a {\n                                max-width: calc(1200px / var(--tab-count));\n                            }\n                        }\n                    }\n                }\n            }\n\n            .lrn-author-item-content-wrapper .lt__tabs .lt__tab-pane {\n                padding-top: 10px;\n            }";break;case"rounded":t="\n            /* Rounded theme */\n            :root {\n                --color-active: #333333;\n                --customer-bg-blue: #e6f1ff;\n                --bg-grey: #f0f0f0;\n                --tab-bg-active: #ffffff;\n                --tab-border: #d9d9d9;\n                --tab-border-bottom: #eeeeee;\n                --input-border: #898989;\n            }\n\n            .lrn.lrn-assess .lt__tabs,\n            .lrn-author-item-content-wrapper .lt__tabs {\n                container-type: inline-size;\n\n                .lt__nav-tabs {\n                    display: flex;\n                    flex-wrap: wrap;\n                    box-shadow: none;\n\n                    li {\n                        border: 1px solid var(--tab-border);\n                        border-top-left-radius: 10px;\n                        border-top-right-radius: 10px;\n                        margin-right: 6px;\n                        background-color: var(--bg-grey);\n                        border-bottom: 1px solid var(--tab-border-bottom);\n                        box-shadow: none;\n                        min-width: 0;\n\n                        .active {\n                            border-bottom: none;\n                            background: var(--tab-bg-active);\n                            color: var(--color-active);\n                        }\n\n                        a {\n                            text-decoration: none;\n                            font-weight: bold;\n                            color: inherit;\n\n                            overflow: hidden;\n                            max-width: 100px;\n                            text-overflow: ellipsis;\n                            display: inline-block;\n                            white-space: nowrap;\n                        }\n\n                        @container (min-width: 200px) {\n                            a {\n                                max-width: calc(180px / var(--tab-count));\n                            }\n                        }\n                        @container (min-width: 250px) {\n                            a {\n                                max-width: calc(210px / var(--tab-count));\n                            }\n                        }\n                        @container (min-width: 300px) {\n                            a {\n                                max-width: calc(260px / var(--tab-count));\n                            }\n                        }\n                        @container (min-width: 330px) {\n                            a {\n                                max-width: calc(290px / var(--tab-count));\n                            }\n                        }\n                        @container (min-width: 400px) {\n                            a {\n                                max-width: calc(370px / var(--tab-count));\n                            }\n                        }\n                        @container (min-width: 500px) {\n                            a {\n                                max-width: calc(550px / var(--tab-count));\n                            }\n                        }\n                        @container (min-width: 600px) {\n                            a {\n                                max-width: calc(650px / var(--tab-count));\n                            }\n                        }\n                        @container (min-width: 700px) {\n                            a {\n                                max-width: calc(900px / var(--tab-count));\n                            }\n                        }\n                        @container (min-width: 800px) {\n                            a {\n                                max-width: calc(1000px / var(--tab-count));\n                            }\n                        }\n                    }\n\n                    li.active {\n                        border-bottom: none;\n                        background: var(--tab-bg-active);\n                    }\n\n                    > li:after,\n                    .nav-tabs:after {\n                        background: none;\n                    }\n                }\n\n                .lt__tab-content {\n                    border: 1px solid var(--tab-border);\n                    padding: 15px;\n                }\n            }\n\n            .lrn-author-item-content-wrapper .lt__tabs .lt__tab-pane {\n                padding-top: 10px;\n            }"}return t}function Y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function Q(){A.appInstance().on("item:load",(function(t){!function(){var t,e=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Y(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Y(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){o=!0,s=t},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw s}}}}((0,k.questionResponseIds)());try{var n=function(){var e=t.value;(0,k.hasCheckAnswer)(e)&&A.appInstance().question(e).on("validated",(function(t){(0,k.questionInstance)(e).disable()}))};for(e.s();!(t=e.n()).done;)n()}catch(t){e.e(t)}finally{e.f()}}()}))}const J=new Uint16Array('ᵁ<Õıʊҝջאٵ۞ޢߖࠏ੊ઑඡ๭༉༦჊ረዡᐕᒝᓃᓟᔥ\0\0\0\0\0\0ᕫᛍᦍᰒᷝ὾⁠↰⊍⏀⏻⑂⠤⤒ⴈ⹈⿎〖㊺㘹㞬㣾㨨㩱㫠㬮ࠀEMabcfglmnoprstu\\bfms¦³¹ÈÏlig耻Æ䃆P耻&䀦cute耻Á䃁reve;䄂Āiyx}rc耻Â䃂;䐐r;쀀𝔄rave耻À䃀pha;䎑acr;䄀d;橓Āgp¡on;䄄f;쀀𝔸plyFunction;恡ing耻Å䃅Ācs¾Ãr;쀀𝒜ign;扔ilde耻Ã䃃ml耻Ä䃄ЀaceforsuåûþėĜĢħĪĀcrêòkslash;或Ŷöø;櫧ed;挆y;䐑ƀcrtąċĔause;戵noullis;愬a;䎒r;쀀𝔅pf;쀀𝔹eve;䋘còēmpeq;扎܀HOacdefhilorsuōőŖƀƞƢƵƷƺǜȕɳɸɾcy;䐧PY耻©䂩ƀcpyŝŢźute;䄆Ā;iŧŨ拒talDifferentialD;慅leys;愭ȀaeioƉƎƔƘron;䄌dil耻Ç䃇rc;䄈nint;戰ot;䄊ĀdnƧƭilla;䂸terDot;䂷òſi;䎧rcleȀDMPTǇǋǑǖot;抙inus;抖lus;投imes;抗oĀcsǢǸkwiseContourIntegral;戲eCurlyĀDQȃȏoubleQuote;思uote;怙ȀlnpuȞȨɇɕonĀ;eȥȦ户;橴ƀgitȯȶȺruent;扡nt;戯ourIntegral;戮ĀfrɌɎ;愂oduct;成nterClockwiseContourIntegral;戳oss;樯cr;쀀𝒞pĀ;Cʄʅ拓ap;才րDJSZacefiosʠʬʰʴʸˋ˗ˡ˦̳ҍĀ;oŹʥtrahd;椑cy;䐂cy;䐅cy;䐏ƀgrsʿ˄ˇger;怡r;憡hv;櫤Āayː˕ron;䄎;䐔lĀ;t˝˞戇a;䎔r;쀀𝔇Āaf˫̧Ācm˰̢riticalȀADGT̖̜̀̆cute;䂴oŴ̋̍;䋙bleAcute;䋝rave;䁠ilde;䋜ond;拄ferentialD;慆Ѱ̽\0\0\0͔͂\0Ѕf;쀀𝔻ƀ;DE͈͉͍䂨ot;惜qual;扐blèCDLRUVͣͲ΂ϏϢϸontourIntegraìȹoɴ͹\0\0ͻ»͉nArrow;懓Āeo·ΤftƀARTΐΖΡrrow;懐ightArrow;懔eåˊngĀLRΫτeftĀARγιrrow;柸ightArrow;柺ightArrow;柹ightĀATϘϞrrow;懒ee;抨pɁϩ\0\0ϯrrow;懑ownArrow;懕erticalBar;戥ǹABLRTaВЪаўѿͼrrowƀ;BUНОТ憓ar;椓pArrow;懵reve;䌑eft˒к\0ц\0ѐightVector;楐eeVector;楞ectorĀ;Bљњ憽ar;楖ightǔѧ\0ѱeeVector;楟ectorĀ;BѺѻ懁ar;楗eeĀ;A҆҇护rrow;憧ĀctҒҗr;쀀𝒟rok;䄐ࠀNTacdfglmopqstuxҽӀӄӋӞӢӧӮӵԡԯԶՒ՝ՠեG;䅊H耻Ð䃐cute耻É䃉ƀaiyӒӗӜron;䄚rc耻Ê䃊;䐭ot;䄖r;쀀𝔈rave耻È䃈ement;戈ĀapӺӾcr;䄒tyɓԆ\0\0ԒmallSquare;旻erySmallSquare;斫ĀgpԦԪon;䄘f;쀀𝔼silon;䎕uĀaiԼՉlĀ;TՂՃ橵ilde;扂librium;懌Āci՗՚r;愰m;橳a;䎗ml耻Ë䃋Āipժկsts;戃onentialE;慇ʀcfiosօֈ֍ֲ׌y;䐤r;쀀𝔉lledɓ֗\0\0֣mallSquare;旼erySmallSquare;斪Ͱֺ\0ֿ\0\0ׄf;쀀𝔽All;戀riertrf;愱cò׋؀JTabcdfgorstר׬ׯ׺؀ؒؖ؛؝أ٬ٲcy;䐃耻>䀾mmaĀ;d׷׸䎓;䏜reve;䄞ƀeiy؇،ؐdil;䄢rc;䄜;䐓ot;䄠r;쀀𝔊;拙pf;쀀𝔾eater̀EFGLSTصلَٖٛ٦qualĀ;Lؾؿ扥ess;招ullEqual;执reater;檢ess;扷lantEqual;橾ilde;扳cr;쀀𝒢;扫ЀAacfiosuڅڋږڛڞڪھۊRDcy;䐪Āctڐڔek;䋇;䁞irc;䄤r;愌lbertSpace;愋ǰگ\0ڲf;愍izontalLine;攀Āctۃۅòکrok;䄦mpńېۘownHumðįqual;扏܀EJOacdfgmnostuۺ۾܃܇܎ܚܞܡܨ݄ݸދޏޕcy;䐕lig;䄲cy;䐁cute耻Í䃍Āiyܓܘrc耻Î䃎;䐘ot;䄰r;愑rave耻Ì䃌ƀ;apܠܯܿĀcgܴܷr;䄪inaryI;慈lieóϝǴ݉\0ݢĀ;eݍݎ戬Āgrݓݘral;戫section;拂isibleĀCTݬݲomma;恣imes;恢ƀgptݿރވon;䄮f;쀀𝕀a;䎙cr;愐ilde;䄨ǫޚ\0ޞcy;䐆l耻Ï䃏ʀcfosuެ޷޼߂ߐĀiyޱ޵rc;䄴;䐙r;쀀𝔍pf;쀀𝕁ǣ߇\0ߌr;쀀𝒥rcy;䐈kcy;䐄΀HJacfosߤߨ߽߬߱ࠂࠈcy;䐥cy;䐌ppa;䎚Āey߶߻dil;䄶;䐚r;쀀𝔎pf;쀀𝕂cr;쀀𝒦րJTaceflmostࠥࠩࠬࡐࡣ঳সে্਷ੇcy;䐉耻<䀼ʀcmnpr࠷࠼ࡁࡄࡍute;䄹bda;䎛g;柪lacetrf;愒r;憞ƀaeyࡗ࡜ࡡron;䄽dil;䄻;䐛Āfsࡨ॰tԀACDFRTUVarࡾࢩࢱࣦ࣠ࣼयज़ΐ४Ānrࢃ࢏gleBracket;柨rowƀ;BR࢙࢚࢞憐ar;懤ightArrow;懆eiling;挈oǵࢷ\0ࣃbleBracket;柦nǔࣈ\0࣒eeVector;楡ectorĀ;Bࣛࣜ懃ar;楙loor;挊ightĀAV࣯ࣵrrow;憔ector;楎Āerँगeƀ;AVउऊऐ抣rrow;憤ector;楚iangleƀ;BEतथऩ抲ar;槏qual;抴pƀDTVषूौownVector;楑eeVector;楠ectorĀ;Bॖॗ憿ar;楘ectorĀ;B॥०憼ar;楒ightáΜs̀EFGLSTॾঋকঝঢভqualGreater;拚ullEqual;扦reater;扶ess;檡lantEqual;橽ilde;扲r;쀀𝔏Ā;eঽা拘ftarrow;懚idot;䄿ƀnpw৔ਖਛgȀLRlr৞৷ਂਐeftĀAR০৬rrow;柵ightArrow;柷ightArrow;柶eftĀarγਊightáοightáϊf;쀀𝕃erĀLRਢਬeftArrow;憙ightArrow;憘ƀchtਾੀੂòࡌ;憰rok;䅁;扪Ѐacefiosuਗ਼੝੠੷੼અઋ઎p;椅y;䐜Ādl੥੯iumSpace;恟lintrf;愳r;쀀𝔐nusPlus;戓pf;쀀𝕄cò੶;䎜ҀJacefostuણધભીଔଙඑ඗ඞcy;䐊cute;䅃ƀaey઴હાron;䅇dil;䅅;䐝ƀgswે૰଎ativeƀMTV૓૟૨ediumSpace;怋hiĀcn૦૘ë૙eryThiî૙tedĀGL૸ଆreaterGreateòٳessLesóੈLine;䀊r;쀀𝔑ȀBnptଢନଷ଺reak;恠BreakingSpace;䂠f;愕ڀ;CDEGHLNPRSTV୕ୖ୪୼஡௫ఄ౞಄ದ೘ൡඅ櫬Āou୛୤ngruent;扢pCap;扭oubleVerticalBar;戦ƀlqxஃஊ஛ement;戉ualĀ;Tஒஓ扠ilde;쀀≂̸ists;戄reater΀;EFGLSTஶஷ஽௉௓௘௥扯qual;扱ullEqual;쀀≧̸reater;쀀≫̸ess;批lantEqual;쀀⩾̸ilde;扵umpń௲௽ownHump;쀀≎̸qual;쀀≏̸eĀfsఊధtTriangleƀ;BEచఛడ拪ar;쀀⧏̸qual;括s̀;EGLSTవశ఼ౄోౘ扮qual;扰reater;扸ess;쀀≪̸lantEqual;쀀⩽̸ilde;扴estedĀGL౨౹reaterGreater;쀀⪢̸essLess;쀀⪡̸recedesƀ;ESಒಓಛ技qual;쀀⪯̸lantEqual;拠ĀeiಫಹverseElement;戌ghtTriangleƀ;BEೋೌ೒拫ar;쀀⧐̸qual;拭ĀquೝഌuareSuĀbp೨೹setĀ;E೰ೳ쀀⊏̸qual;拢ersetĀ;Eഃആ쀀⊐̸qual;拣ƀbcpഓതൎsetĀ;Eഛഞ쀀⊂⃒qual;抈ceedsȀ;ESTലള഻െ抁qual;쀀⪰̸lantEqual;拡ilde;쀀≿̸ersetĀ;E൘൛쀀⊃⃒qual;抉ildeȀ;EFT൮൯൵ൿ扁qual;扄ullEqual;扇ilde;扉erticalBar;戤cr;쀀𝒩ilde耻Ñ䃑;䎝܀Eacdfgmoprstuvලෂ෉෕ෛ෠෧෼ขภยา฿ไlig;䅒cute耻Ó䃓Āiy෎ීrc耻Ô䃔;䐞blac;䅐r;쀀𝔒rave耻Ò䃒ƀaei෮ෲ෶cr;䅌ga;䎩cron;䎟pf;쀀𝕆enCurlyĀDQฎบoubleQuote;怜uote;怘;橔Āclวฬr;쀀𝒪ash耻Ø䃘iŬื฼de耻Õ䃕es;樷ml耻Ö䃖erĀBP๋๠Āar๐๓r;怾acĀek๚๜;揞et;掴arenthesis;揜Ҁacfhilors๿ງຊຏຒດຝະ໼rtialD;戂y;䐟r;쀀𝔓i;䎦;䎠usMinus;䂱Āipຢອncareplanåڝf;愙Ȁ;eio຺ູ໠໤檻cedesȀ;EST່້໏໚扺qual;檯lantEqual;扼ilde;找me;怳Ādp໩໮uct;戏ortionĀ;aȥ໹l;戝Āci༁༆r;쀀𝒫;䎨ȀUfos༑༖༛༟OT耻"䀢r;쀀𝔔pf;愚cr;쀀𝒬؀BEacefhiorsu༾གྷཇའཱིྦྷྪྭ႖ႩႴႾarr;椐G耻®䂮ƀcnrཎནབute;䅔g;柫rĀ;tཛྷཝ憠l;椖ƀaeyཧཬཱron;䅘dil;䅖;䐠Ā;vླྀཹ愜erseĀEUྂྙĀlq྇ྎement;戋uilibrium;懋pEquilibrium;楯r»ཹo;䎡ghtЀACDFTUVa࿁࿫࿳ဢဨၛႇϘĀnr࿆࿒gleBracket;柩rowƀ;BL࿜࿝࿡憒ar;懥eftArrow;懄eiling;按oǵ࿹\0စbleBracket;柧nǔည\0နeeVector;楝ectorĀ;Bဝသ懂ar;楕loor;挋Āerိ၃eƀ;AVဵံြ抢rrow;憦ector;楛iangleƀ;BEၐၑၕ抳ar;槐qual;抵pƀDTVၣၮၸownVector;楏eeVector;楜ectorĀ;Bႂႃ憾ar;楔ectorĀ;B႑႒懀ar;楓Āpuႛ႞f;愝ndImplies;楰ightarrow;懛ĀchႹႼr;愛;憱leDelayed;槴ڀHOacfhimoqstuფჱჷჽᄙᄞᅑᅖᅡᅧᆵᆻᆿĀCcჩხHcy;䐩y;䐨FTcy;䐬cute;䅚ʀ;aeiyᄈᄉᄎᄓᄗ檼ron;䅠dil;䅞rc;䅜;䐡r;쀀𝔖ortȀDLRUᄪᄴᄾᅉownArrow»ОeftArrow»࢚ightArrow»࿝pArrow;憑gma;䎣allCircle;战pf;쀀𝕊ɲᅭ\0\0ᅰt;戚areȀ;ISUᅻᅼᆉᆯ斡ntersection;抓uĀbpᆏᆞsetĀ;Eᆗᆘ抏qual;抑ersetĀ;Eᆨᆩ抐qual;抒nion;抔cr;쀀𝒮ar;拆ȀbcmpᇈᇛሉላĀ;sᇍᇎ拐etĀ;Eᇍᇕqual;抆ĀchᇠህeedsȀ;ESTᇭᇮᇴᇿ扻qual;檰lantEqual;扽ilde;承Tháྌ;我ƀ;esሒሓሣ拑rsetĀ;Eሜም抃qual;抇et»ሓրHRSacfhiorsሾቄ቉ቕ቞ቱቶኟዂወዑORN耻Þ䃞ADE;愢ĀHc቎ቒcy;䐋y;䐦Ābuቚቜ;䀉;䎤ƀaeyብቪቯron;䅤dil;䅢;䐢r;쀀𝔗Āeiቻ኉ǲኀ\0ኇefore;戴a;䎘Ācn኎ኘkSpace;쀀  Space;怉ldeȀ;EFTካኬኲኼ戼qual;扃ullEqual;扅ilde;扈pf;쀀𝕋ipleDot;惛Āctዖዛr;쀀𝒯rok;䅦ૡዷጎጚጦ\0ጬጱ\0\0\0\0\0ጸጽ፷ᎅ\0᏿ᐄᐊᐐĀcrዻጁute耻Ú䃚rĀ;oጇገ憟cir;楉rǣጓ\0጖y;䐎ve;䅬Āiyጞጣrc耻Û䃛;䐣blac;䅰r;쀀𝔘rave耻Ù䃙acr;䅪Ādiፁ፩erĀBPፈ፝Āarፍፐr;䁟acĀekፗፙ;揟et;掵arenthesis;揝onĀ;P፰፱拃lus;抎Āgp፻፿on;䅲f;쀀𝕌ЀADETadps᎕ᎮᎸᏄϨᏒᏗᏳrrowƀ;BDᅐᎠᎤar;椒ownArrow;懅ownArrow;憕quilibrium;楮eeĀ;AᏋᏌ报rrow;憥ownáϳerĀLRᏞᏨeftArrow;憖ightArrow;憗iĀ;lᏹᏺ䏒on;䎥ing;䅮cr;쀀𝒰ilde;䅨ml耻Ü䃜ҀDbcdefosvᐧᐬᐰᐳᐾᒅᒊᒐᒖash;披ar;櫫y;䐒ashĀ;lᐻᐼ抩;櫦Āerᑃᑅ;拁ƀbtyᑌᑐᑺar;怖Ā;iᑏᑕcalȀBLSTᑡᑥᑪᑴar;戣ine;䁼eparator;杘ilde;所ThinSpace;怊r;쀀𝔙pf;쀀𝕍cr;쀀𝒱dash;抪ʀcefosᒧᒬᒱᒶᒼirc;䅴dge;拀r;쀀𝔚pf;쀀𝕎cr;쀀𝒲Ȁfiosᓋᓐᓒᓘr;쀀𝔛;䎞pf;쀀𝕏cr;쀀𝒳ҀAIUacfosuᓱᓵᓹᓽᔄᔏᔔᔚᔠcy;䐯cy;䐇cy;䐮cute耻Ý䃝Āiyᔉᔍrc;䅶;䐫r;쀀𝔜pf;쀀𝕐cr;쀀𝒴ml;䅸ЀHacdefosᔵᔹᔿᕋᕏᕝᕠᕤcy;䐖cute;䅹Āayᕄᕉron;䅽;䐗ot;䅻ǲᕔ\0ᕛoWidtè૙a;䎖r;愨pf;愤cr;쀀𝒵௡ᖃᖊᖐ\0ᖰᖶᖿ\0\0\0\0ᗆᗛᗫᙟ᙭\0ᚕ᚛ᚲᚹ\0ᚾcute耻á䃡reve;䄃̀;Ediuyᖜᖝᖡᖣᖨᖭ戾;쀀∾̳;房rc耻â䃢te肻´̆;䐰lig耻æ䃦Ā;r²ᖺ;쀀𝔞rave耻à䃠ĀepᗊᗖĀfpᗏᗔsym;愵èᗓha;䎱ĀapᗟcĀclᗤᗧr;䄁g;樿ɤᗰ\0\0ᘊʀ;adsvᗺᗻᗿᘁᘇ戧nd;橕;橜lope;橘;橚΀;elmrszᘘᘙᘛᘞᘿᙏᙙ戠;榤e»ᘙsdĀ;aᘥᘦ戡ѡᘰᘲᘴᘶᘸᘺᘼᘾ;榨;榩;榪;榫;榬;榭;榮;榯tĀ;vᙅᙆ戟bĀ;dᙌᙍ抾;榝Āptᙔᙗh;戢»¹arr;捼Āgpᙣᙧon;䄅f;쀀𝕒΀;Eaeiop዁ᙻᙽᚂᚄᚇᚊ;橰cir;橯;扊d;手s;䀧roxĀ;e዁ᚒñᚃing耻å䃥ƀctyᚡᚦᚨr;쀀𝒶;䀪mpĀ;e዁ᚯñʈilde耻ã䃣ml耻ä䃤Āciᛂᛈoninôɲnt;樑ࠀNabcdefiklnoprsu᛭ᛱᜰ᜼ᝃᝈ᝸᝽០៦ᠹᡐᜍ᤽᥈ᥰot;櫭Ācrᛶ᜞kȀcepsᜀᜅᜍᜓong;扌psilon;䏶rime;怵imĀ;e᜚᜛戽q;拍Ŷᜢᜦee;抽edĀ;gᜬᜭ挅e»ᜭrkĀ;t፜᜷brk;掶Āoyᜁᝁ;䐱quo;怞ʀcmprtᝓ᝛ᝡᝤᝨausĀ;eĊĉptyv;榰séᜌnoõēƀahwᝯ᝱ᝳ;䎲;愶een;扬r;쀀𝔟g΀costuvwឍឝឳេ៕៛៞ƀaiuបពរðݠrc;旯p»፱ƀdptឤឨឭot;樀lus;樁imes;樂ɱឹ\0\0ើcup;樆ar;昅riangleĀdu៍្own;施p;斳plus;樄eåᑄåᒭarow;植ƀako៭ᠦᠵĀcn៲ᠣkƀlst៺֫᠂ozenge;槫riangleȀ;dlr᠒᠓᠘᠝斴own;斾eft;旂ight;斸k;搣Ʊᠫ\0ᠳƲᠯ\0ᠱ;斒;斑4;斓ck;斈ĀeoᠾᡍĀ;qᡃᡆ쀀=⃥uiv;쀀≡⃥t;挐Ȁptwxᡙᡞᡧᡬf;쀀𝕓Ā;tᏋᡣom»Ꮜtie;拈؀DHUVbdhmptuvᢅᢖᢪᢻᣗᣛᣬ᣿ᤅᤊᤐᤡȀLRlrᢎᢐᢒᢔ;敗;敔;敖;敓ʀ;DUduᢡᢢᢤᢦᢨ敐;敦;敩;敤;敧ȀLRlrᢳᢵᢷᢹ;敝;敚;敜;教΀;HLRhlrᣊᣋᣍᣏᣑᣓᣕ救;敬;散;敠;敫;敢;敟ox;槉ȀLRlrᣤᣦᣨᣪ;敕;敒;攐;攌ʀ;DUduڽ᣷᣹᣻᣽;敥;敨;攬;攴inus;抟lus;択imes;抠ȀLRlrᤙᤛᤝ᤟;敛;敘;攘;攔΀;HLRhlrᤰᤱᤳᤵᤷ᤻᤹攂;敪;敡;敞;攼;攤;攜Āevģ᥂bar耻¦䂦Ȁceioᥑᥖᥚᥠr;쀀𝒷mi;恏mĀ;e᜚᜜lƀ;bhᥨᥩᥫ䁜;槅sub;柈Ŭᥴ᥾lĀ;e᥹᥺怢t»᥺pƀ;Eeįᦅᦇ;檮Ā;qۜۛೡᦧ\0᧨ᨑᨕᨲ\0ᨷᩐ\0\0᪴\0\0᫁\0\0ᬡᬮ᭍᭒\0᯽\0ᰌƀcpr᦭ᦲ᧝ute;䄇̀;abcdsᦿᧀᧄ᧊᧕᧙戩nd;橄rcup;橉Āau᧏᧒p;橋p;橇ot;橀;쀀∩︀Āeo᧢᧥t;恁îړȀaeiu᧰᧻ᨁᨅǰ᧵\0᧸s;橍on;䄍dil耻ç䃧rc;䄉psĀ;sᨌᨍ橌m;橐ot;䄋ƀdmnᨛᨠᨦil肻¸ƭptyv;榲t脀¢;eᨭᨮ䂢räƲr;쀀𝔠ƀceiᨽᩀᩍy;䑇ckĀ;mᩇᩈ朓ark»ᩈ;䏇r΀;Ecefms᩟᩠ᩢᩫ᪤᪪᪮旋;槃ƀ;elᩩᩪᩭ䋆q;扗eɡᩴ\0\0᪈rrowĀlr᩼᪁eft;憺ight;憻ʀRSacd᪒᪔᪖᪚᪟»ཇ;擈st;抛irc;抚ash;抝nint;樐id;櫯cir;槂ubsĀ;u᪻᪼晣it»᪼ˬ᫇᫔᫺\0ᬊonĀ;eᫍᫎ䀺Ā;qÇÆɭ᫙\0\0᫢aĀ;t᫞᫟䀬;䁀ƀ;fl᫨᫩᫫戁îᅠeĀmx᫱᫶ent»᫩eóɍǧ᫾\0ᬇĀ;dኻᬂot;橭nôɆƀfryᬐᬔᬗ;쀀𝕔oäɔ脀©;sŕᬝr;愗Āaoᬥᬩrr;憵ss;朗Ācuᬲᬷr;쀀𝒸Ābpᬼ᭄Ā;eᭁᭂ櫏;櫑Ā;eᭉᭊ櫐;櫒dot;拯΀delprvw᭠᭬᭷ᮂᮬᯔ᯹arrĀlr᭨᭪;椸;椵ɰ᭲\0\0᭵r;拞c;拟arrĀ;p᭿ᮀ憶;椽̀;bcdosᮏᮐᮖᮡᮥᮨ截rcap;橈Āauᮛᮞp;橆p;橊ot;抍r;橅;쀀∪︀Ȁalrv᮵ᮿᯞᯣrrĀ;mᮼᮽ憷;椼yƀevwᯇᯔᯘqɰᯎ\0\0ᯒreã᭳uã᭵ee;拎edge;拏en耻¤䂤earrowĀlrᯮ᯳eft»ᮀight»ᮽeäᯝĀciᰁᰇoninôǷnt;戱lcty;挭ঀAHabcdefhijlorstuwz᰸᰻᰿ᱝᱩᱵᲊᲞᲬᲷ᳻᳿ᴍᵻᶑᶫᶻ᷆᷍rò΁ar;楥Ȁglrs᱈ᱍ᱒᱔ger;怠eth;愸òᄳhĀ;vᱚᱛ怐»ऊūᱡᱧarow;椏aã̕Āayᱮᱳron;䄏;䐴ƀ;ao̲ᱼᲄĀgrʿᲁr;懊tseq;橷ƀglmᲑᲔᲘ耻°䂰ta;䎴ptyv;榱ĀirᲣᲨsht;楿;쀀𝔡arĀlrᲳᲵ»ࣜ»သʀaegsv᳂͸᳖᳜᳠mƀ;oș᳊᳔ndĀ;ș᳑uit;晦amma;䏝in;拲ƀ;io᳧᳨᳸䃷de脀÷;o᳧ᳰntimes;拇nø᳷cy;䑒cɯᴆ\0\0ᴊrn;挞op;挍ʀlptuwᴘᴝᴢᵉᵕlar;䀤f;쀀𝕕ʀ;emps̋ᴭᴷᴽᵂqĀ;d͒ᴳot;扑inus;戸lus;戔quare;抡blebarwedgåúnƀadhᄮᵝᵧownarrowóᲃarpoonĀlrᵲᵶefôᲴighôᲶŢᵿᶅkaro÷གɯᶊ\0\0ᶎrn;挟op;挌ƀcotᶘᶣᶦĀryᶝᶡ;쀀𝒹;䑕l;槶rok;䄑Ādrᶰᶴot;拱iĀ;fᶺ᠖斿Āah᷀᷃ròЩaòྦangle;榦Āci᷒ᷕy;䑟grarr;柿ऀDacdefglmnopqrstuxḁḉḙḸոḼṉṡṾấắẽỡἪἷὄ὎὚ĀDoḆᴴoôᲉĀcsḎḔute耻é䃩ter;橮ȀaioyḢḧḱḶron;䄛rĀ;cḭḮ扖耻ê䃪lon;払;䑍ot;䄗ĀDrṁṅot;扒;쀀𝔢ƀ;rsṐṑṗ檚ave耻è䃨Ā;dṜṝ檖ot;檘Ȁ;ilsṪṫṲṴ檙nters;揧;愓Ā;dṹṺ檕ot;檗ƀapsẅẉẗcr;䄓tyƀ;svẒẓẕ戅et»ẓpĀ1;ẝẤĳạả;怄;怅怃ĀgsẪẬ;䅋p;怂ĀgpẴẸon;䄙f;쀀𝕖ƀalsỄỎỒrĀ;sỊị拕l;槣us;橱iƀ;lvỚớở䎵on»ớ;䏵ȀcsuvỪỳἋἣĀioữḱrc»Ḯɩỹ\0\0ỻíՈantĀglἂἆtr»ṝess»Ṻƀaeiἒ἖Ἒls;䀽st;扟vĀ;DȵἠD;橸parsl;槥ĀDaἯἳot;打rr;楱ƀcdiἾὁỸr;愯oô͒ĀahὉὋ;䎷耻ð䃰Āmrὓὗl耻ë䃫o;悬ƀcipὡὤὧl;䀡sôծĀeoὬὴctatioîՙnentialåչৡᾒ\0ᾞ\0ᾡᾧ\0\0ῆῌ\0ΐ\0ῦῪ \0 ⁚llingdotseñṄy;䑄male;晀ƀilrᾭᾳ῁lig;耀ﬃɩᾹ\0\0᾽g;耀ﬀig;耀ﬄ;쀀𝔣lig;耀ﬁlig;쀀fjƀaltῙ῜ῡt;晭ig;耀ﬂns;斱of;䆒ǰ΅\0ῳf;쀀𝕗ĀakֿῷĀ;vῼ´拔;櫙artint;樍Āao‌⁕Ācs‑⁒α‚‰‸⁅⁈\0⁐β•‥‧‪‬\0‮耻½䂽;慓耻¼䂼;慕;慙;慛Ƴ‴\0‶;慔;慖ʴ‾⁁\0\0⁃耻¾䂾;慗;慜5;慘ƶ⁌\0⁎;慚;慝8;慞l;恄wn;挢cr;쀀𝒻ࢀEabcdefgijlnorstv₂₉₟₥₰₴⃰⃵⃺⃿℃ℒℸ̗ℾ⅒↞Ā;lٍ₇;檌ƀcmpₐₕ₝ute;䇵maĀ;dₜ᳚䎳;檆reve;䄟Āiy₪₮rc;䄝;䐳ot;䄡Ȁ;lqsؾق₽⃉ƀ;qsؾٌ⃄lanô٥Ȁ;cdl٥⃒⃥⃕c;檩otĀ;o⃜⃝檀Ā;l⃢⃣檂;檄Ā;e⃪⃭쀀⋛︀s;檔r;쀀𝔤Ā;gٳ؛mel;愷cy;䑓Ȁ;Eajٚℌℎℐ;檒;檥;檤ȀEaesℛℝ℩ℴ;扩pĀ;p℣ℤ檊rox»ℤĀ;q℮ℯ檈Ā;q℮ℛim;拧pf;쀀𝕘Āci⅃ⅆr;愊mƀ;el٫ⅎ⅐;檎;檐茀>;cdlqr׮ⅠⅪⅮⅳⅹĀciⅥⅧ;檧r;橺ot;拗Par;榕uest;橼ʀadelsↄⅪ←ٖ↛ǰ↉\0↎proø₞r;楸qĀlqؿ↖lesó₈ií٫Āen↣↭rtneqq;쀀≩︀Å↪ԀAabcefkosy⇄⇇⇱⇵⇺∘∝∯≨≽ròΠȀilmr⇐⇔⇗⇛rsðᒄf»․ilôکĀdr⇠⇤cy;䑊ƀ;cwࣴ⇫⇯ir;楈;憭ar;意irc;䄥ƀalr∁∎∓rtsĀ;u∉∊晥it»∊lip;怦con;抹r;쀀𝔥sĀew∣∩arow;椥arow;椦ʀamopr∺∾≃≞≣rr;懿tht;戻kĀlr≉≓eftarrow;憩ightarrow;憪f;쀀𝕙bar;怕ƀclt≯≴≸r;쀀𝒽asè⇴rok;䄧Ābp⊂⊇ull;恃hen»ᱛૡ⊣\0⊪\0⊸⋅⋎\0⋕⋳\0\0⋸⌢⍧⍢⍿\0⎆⎪⎴cute耻í䃭ƀ;iyݱ⊰⊵rc耻î䃮;䐸Ācx⊼⊿y;䐵cl耻¡䂡ĀfrΟ⋉;쀀𝔦rave耻ì䃬Ȁ;inoܾ⋝⋩⋮Āin⋢⋦nt;樌t;戭fin;槜ta;愩lig;䄳ƀaop⋾⌚⌝ƀcgt⌅⌈⌗r;䄫ƀelpܟ⌏⌓inåގarôܠh;䄱f;抷ed;䆵ʀ;cfotӴ⌬⌱⌽⍁are;愅inĀ;t⌸⌹戞ie;槝doô⌙ʀ;celpݗ⍌⍐⍛⍡al;抺Āgr⍕⍙eróᕣã⍍arhk;樗rod;樼Ȁcgpt⍯⍲⍶⍻y;䑑on;䄯f;쀀𝕚a;䎹uest耻¿䂿Āci⎊⎏r;쀀𝒾nʀ;EdsvӴ⎛⎝⎡ӳ;拹ot;拵Ā;v⎦⎧拴;拳Ā;iݷ⎮lde;䄩ǫ⎸\0⎼cy;䑖l耻ï䃯̀cfmosu⏌⏗⏜⏡⏧⏵Āiy⏑⏕rc;䄵;䐹r;쀀𝔧ath;䈷pf;쀀𝕛ǣ⏬\0⏱r;쀀𝒿rcy;䑘kcy;䑔Ѐacfghjos␋␖␢␧␭␱␵␻ppaĀ;v␓␔䎺;䏰Āey␛␠dil;䄷;䐺r;쀀𝔨reen;䄸cy;䑅cy;䑜pf;쀀𝕜cr;쀀𝓀஀ABEHabcdefghjlmnoprstuv⑰⒁⒆⒍⒑┎┽╚▀♎♞♥♹♽⚚⚲⛘❝❨➋⟀⠁⠒ƀart⑷⑺⑼rò৆òΕail;椛arr;椎Ā;gঔ⒋;檋ar;楢ॣ⒥\0⒪\0⒱\0\0\0\0\0⒵Ⓔ\0ⓆⓈⓍ\0⓹ute;䄺mptyv;榴raîࡌbda;䎻gƀ;dlࢎⓁⓃ;榑åࢎ;檅uo耻«䂫rЀ;bfhlpst࢙ⓞⓦⓩ⓫⓮⓱⓵Ā;f࢝ⓣs;椟s;椝ë≒p;憫l;椹im;楳l;憢ƀ;ae⓿─┄檫il;椙Ā;s┉┊檭;쀀⪭︀ƀabr┕┙┝rr;椌rk;杲Āak┢┬cĀek┨┪;䁻;䁛Āes┱┳;榋lĀdu┹┻;榏;榍Ȁaeuy╆╋╖╘ron;䄾Ādi═╔il;䄼ìࢰâ┩;䐻Ȁcqrs╣╦╭╽a;椶uoĀ;rนᝆĀdu╲╷har;楧shar;楋h;憲ʀ;fgqs▋▌উ◳◿扤tʀahlrt▘▤▷◂◨rrowĀ;t࢙□aé⓶arpoonĀdu▯▴own»њp»०eftarrows;懇ightƀahs◍◖◞rrowĀ;sࣴࢧarpoonó྘quigarro÷⇰hreetimes;拋ƀ;qs▋ও◺lanôবʀ;cdgsব☊☍☝☨c;檨otĀ;o☔☕橿Ā;r☚☛檁;檃Ā;e☢☥쀀⋚︀s;檓ʀadegs☳☹☽♉♋pproøⓆot;拖qĀgq♃♅ôউgtò⒌ôছiíলƀilr♕࣡♚sht;楼;쀀𝔩Ā;Eজ♣;檑š♩♶rĀdu▲♮Ā;l॥♳;楪lk;斄cy;䑙ʀ;achtੈ⚈⚋⚑⚖rò◁orneòᴈard;楫ri;旺Āio⚟⚤dot;䅀ustĀ;a⚬⚭掰che»⚭ȀEaes⚻⚽⛉⛔;扨pĀ;p⛃⛄檉rox»⛄Ā;q⛎⛏檇Ā;q⛎⚻im;拦Ѐabnoptwz⛩⛴⛷✚✯❁❇❐Ānr⛮⛱g;柬r;懽rëࣁgƀlmr⛿✍✔eftĀar০✇ightá৲apsto;柼ightá৽parrowĀlr✥✩efô⓭ight;憬ƀafl✶✹✽r;榅;쀀𝕝us;樭imes;樴š❋❏st;戗áፎƀ;ef❗❘᠀旊nge»❘arĀ;l❤❥䀨t;榓ʀachmt❳❶❼➅➇ròࢨorneòᶌarĀ;d྘➃;業;怎ri;抿̀achiqt➘➝ੀ➢➮➻quo;怹r;쀀𝓁mƀ;egল➪➬;檍;檏Ābu┪➳oĀ;rฟ➹;怚rok;䅂萀<;cdhilqrࠫ⟒☹⟜⟠⟥⟪⟰Āci⟗⟙;檦r;橹reå◲mes;拉arr;楶uest;橻ĀPi⟵⟹ar;榖ƀ;ef⠀भ᠛旃rĀdu⠇⠍shar;楊har;楦Āen⠗⠡rtneqq;쀀≨︀Å⠞܀Dacdefhilnopsu⡀⡅⢂⢎⢓⢠⢥⢨⣚⣢⣤ઃ⣳⤂Dot;戺Ȁclpr⡎⡒⡣⡽r耻¯䂯Āet⡗⡙;時Ā;e⡞⡟朠se»⡟Ā;sျ⡨toȀ;dluျ⡳⡷⡻owîҌefôएðᏑker;斮Āoy⢇⢌mma;権;䐼ash;怔asuredangle»ᘦr;쀀𝔪o;愧ƀcdn⢯⢴⣉ro耻µ䂵Ȁ;acdᑤ⢽⣀⣄sôᚧir;櫰ot肻·Ƶusƀ;bd⣒ᤃ⣓戒Ā;uᴼ⣘;横ţ⣞⣡p;櫛ò−ðઁĀdp⣩⣮els;抧f;쀀𝕞Āct⣸⣽r;쀀𝓂pos»ᖝƀ;lm⤉⤊⤍䎼timap;抸ఀGLRVabcdefghijlmoprstuvw⥂⥓⥾⦉⦘⧚⧩⨕⨚⩘⩝⪃⪕⪤⪨⬄⬇⭄⭿⮮ⰴⱧⱼ⳩Āgt⥇⥋;쀀⋙̸Ā;v⥐௏쀀≫⃒ƀelt⥚⥲⥶ftĀar⥡⥧rrow;懍ightarrow;懎;쀀⋘̸Ā;v⥻ే쀀≪⃒ightarrow;懏ĀDd⦎⦓ash;抯ash;抮ʀbcnpt⦣⦧⦬⦱⧌la»˞ute;䅄g;쀀∠⃒ʀ;Eiop඄⦼⧀⧅⧈;쀀⩰̸d;쀀≋̸s;䅉roø඄urĀ;a⧓⧔普lĀ;s⧓ସǳ⧟\0⧣p肻 ଷmpĀ;e௹ఀʀaeouy⧴⧾⨃⨐⨓ǰ⧹\0⧻;橃on;䅈dil;䅆ngĀ;dൾ⨊ot;쀀⩭̸p;橂;䐽ash;怓΀;Aadqsxஒ⨩⨭⨻⩁⩅⩐rr;懗rĀhr⨳⨶k;椤Ā;oᏲᏰot;쀀≐̸uiöୣĀei⩊⩎ar;椨í஘istĀ;s஠டr;쀀𝔫ȀEest௅⩦⩹⩼ƀ;qs஼⩭௡ƀ;qs஼௅⩴lanô௢ií௪Ā;rஶ⪁»ஷƀAap⪊⪍⪑rò⥱rr;憮ar;櫲ƀ;svྍ⪜ྌĀ;d⪡⪢拼;拺cy;䑚΀AEadest⪷⪺⪾⫂⫅⫶⫹rò⥦;쀀≦̸rr;憚r;急Ȁ;fqs఻⫎⫣⫯tĀar⫔⫙rro÷⫁ightarro÷⪐ƀ;qs఻⪺⫪lanôౕĀ;sౕ⫴»శiíౝĀ;rవ⫾iĀ;eచథiäඐĀpt⬌⬑f;쀀𝕟膀¬;in⬙⬚⬶䂬nȀ;Edvஉ⬤⬨⬮;쀀⋹̸ot;쀀⋵̸ǡஉ⬳⬵;拷;拶iĀ;vಸ⬼ǡಸ⭁⭃;拾;拽ƀaor⭋⭣⭩rȀ;ast୻⭕⭚⭟lleì୻l;쀀⫽⃥;쀀∂̸lint;樔ƀ;ceಒ⭰⭳uåಥĀ;cಘ⭸Ā;eಒ⭽ñಘȀAait⮈⮋⮝⮧rò⦈rrƀ;cw⮔⮕⮙憛;쀀⤳̸;쀀↝̸ghtarrow»⮕riĀ;eೋೖ΀chimpqu⮽⯍⯙⬄୸⯤⯯Ȁ;cerല⯆ഷ⯉uå൅;쀀𝓃ortɭ⬅\0\0⯖ará⭖mĀ;e൮⯟Ā;q൴൳suĀbp⯫⯭å೸åഋƀbcp⯶ⰑⰙȀ;Ees⯿ⰀഢⰄ抄;쀀⫅̸etĀ;eഛⰋqĀ;qണⰀcĀ;eലⰗñസȀ;EesⰢⰣൟⰧ抅;쀀⫆̸etĀ;e൘ⰮqĀ;qൠⰣȀgilrⰽⰿⱅⱇìௗlde耻ñ䃱çృiangleĀlrⱒⱜeftĀ;eచⱚñదightĀ;eೋⱥñ೗Ā;mⱬⱭ䎽ƀ;esⱴⱵⱹ䀣ro;愖p;怇ҀDHadgilrsⲏⲔⲙⲞⲣⲰⲶⳓⳣash;抭arr;椄p;쀀≍⃒ash;抬ĀetⲨⲬ;쀀≥⃒;쀀>⃒nfin;槞ƀAetⲽⳁⳅrr;椂;쀀≤⃒Ā;rⳊⳍ쀀<⃒ie;쀀⊴⃒ĀAtⳘⳜrr;椃rie;쀀⊵⃒im;쀀∼⃒ƀAan⳰⳴ⴂrr;懖rĀhr⳺⳽k;椣Ā;oᏧᏥear;椧ቓ᪕\0\0\0\0\0\0\0\0\0\0\0\0\0ⴭ\0ⴸⵈⵠⵥ⵲ⶄᬇ\0\0ⶍⶫ\0ⷈⷎ\0ⷜ⸙⸫⸾⹃Ācsⴱ᪗ute耻ó䃳ĀiyⴼⵅrĀ;c᪞ⵂ耻ô䃴;䐾ʀabios᪠ⵒⵗǈⵚlac;䅑v;樸old;榼lig;䅓Ācr⵩⵭ir;榿;쀀𝔬ͯ⵹\0\0⵼\0ⶂn;䋛ave耻ò䃲;槁Ābmⶈ෴ar;榵Ȁacitⶕ⶘ⶥⶨrò᪀Āir⶝ⶠr;榾oss;榻nå๒;槀ƀaeiⶱⶵⶹcr;䅍ga;䏉ƀcdnⷀⷅǍron;䎿;榶pf;쀀𝕠ƀaelⷔ⷗ǒr;榷rp;榹΀;adiosvⷪⷫⷮ⸈⸍⸐⸖戨rò᪆Ȁ;efmⷷⷸ⸂⸅橝rĀ;oⷾⷿ愴f»ⷿ耻ª䂪耻º䂺gof;抶r;橖lope;橗;橛ƀclo⸟⸡⸧ò⸁ash耻ø䃸l;折iŬⸯ⸴de耻õ䃵esĀ;aǛ⸺s;樶ml耻ö䃶bar;挽ૡ⹞\0⹽\0⺀⺝\0⺢⺹\0\0⻋ຜ\0⼓\0\0⼫⾼\0⿈rȀ;astЃ⹧⹲຅脀¶;l⹭⹮䂶leìЃɩ⹸\0\0⹻m;櫳;櫽y;䐿rʀcimpt⺋⺏⺓ᡥ⺗nt;䀥od;䀮il;怰enk;怱r;쀀𝔭ƀimo⺨⺰⺴Ā;v⺭⺮䏆;䏕maô੶ne;明ƀ;tv⺿⻀⻈䏀chfork»´;䏖Āau⻏⻟nĀck⻕⻝kĀ;h⇴⻛;愎ö⇴sҀ;abcdemst⻳⻴ᤈ⻹⻽⼄⼆⼊⼎䀫cir;樣ir;樢Āouᵀ⼂;樥;橲n肻±ຝim;樦wo;樧ƀipu⼙⼠⼥ntint;樕f;쀀𝕡nd耻£䂣Ԁ;Eaceinosu່⼿⽁⽄⽇⾁⾉⾒⽾⾶;檳p;檷uå໙Ā;c໎⽌̀;acens່⽙⽟⽦⽨⽾pproø⽃urlyeñ໙ñ໎ƀaes⽯⽶⽺pprox;檹qq;檵im;拨iíໟmeĀ;s⾈ຮ怲ƀEas⽸⾐⽺ð⽵ƀdfp໬⾙⾯ƀals⾠⾥⾪lar;挮ine;挒urf;挓Ā;t໻⾴ï໻rel;抰Āci⿀⿅r;쀀𝓅;䏈ncsp;怈̀fiopsu⿚⋢⿟⿥⿫⿱r;쀀𝔮pf;쀀𝕢rime;恗cr;쀀𝓆ƀaeo⿸〉〓tĀei⿾々rnionóڰnt;樖stĀ;e【】䀿ñἙô༔઀ABHabcdefhilmnoprstux぀けさすムㄎㄫㅇㅢㅲㆎ㈆㈕㈤㈩㉘㉮㉲㊐㊰㊷ƀartぇおがròႳòϝail;検aròᱥar;楤΀cdenqrtとふへみわゔヌĀeuねぱ;쀀∽̱te;䅕iãᅮmptyv;榳gȀ;del࿑らるろ;榒;榥å࿑uo耻»䂻rր;abcfhlpstw࿜ガクシスゼゾダッデナp;極Ā;f࿠ゴs;椠;椳s;椞ë≝ð✮l;楅im;楴l;憣;憝Āaiパフil;椚oĀ;nホボ戶aló༞ƀabrョリヮrò៥rk;杳ĀakンヽcĀekヹ・;䁽;䁝Āes㄂㄄;榌lĀduㄊㄌ;榎;榐Ȁaeuyㄗㄜㄧㄩron;䅙Ādiㄡㄥil;䅗ì࿲âヺ;䑀Ȁclqsㄴㄷㄽㅄa;椷dhar;楩uoĀ;rȎȍh;憳ƀacgㅎㅟངlȀ;ipsླྀㅘㅛႜnåႻarôྩt;断ƀilrㅩဣㅮsht;楽;쀀𝔯ĀaoㅷㆆrĀduㅽㅿ»ѻĀ;l႑ㆄ;楬Ā;vㆋㆌ䏁;䏱ƀgns㆕ㇹㇼht̀ahlrstㆤㆰ㇂㇘㇤㇮rrowĀ;t࿜ㆭaéトarpoonĀduㆻㆿowîㅾp»႒eftĀah㇊㇐rrowó࿪arpoonóՑightarrows;應quigarro÷ニhreetimes;拌g;䋚ingdotseñἲƀahm㈍㈐㈓rò࿪aòՑ;怏oustĀ;a㈞㈟掱che»㈟mid;櫮Ȁabpt㈲㈽㉀㉒Ānr㈷㈺g;柭r;懾rëဃƀafl㉇㉊㉎r;榆;쀀𝕣us;樮imes;樵Āap㉝㉧rĀ;g㉣㉤䀩t;榔olint;樒arò㇣Ȁachq㉻㊀Ⴜ㊅quo;怺r;쀀𝓇Ābu・㊊oĀ;rȔȓƀhir㊗㊛㊠reåㇸmes;拊iȀ;efl㊪ၙᠡ㊫方tri;槎luhar;楨;愞ൡ㋕㋛㋟㌬㌸㍱\0㍺㎤\0\0㏬㏰\0㐨㑈㑚㒭㒱㓊㓱\0㘖\0\0㘳cute;䅛quï➺Ԁ;Eaceinpsyᇭ㋳㋵㋿㌂㌋㌏㌟㌦㌩;檴ǰ㋺\0㋼;檸on;䅡uåᇾĀ;dᇳ㌇il;䅟rc;䅝ƀEas㌖㌘㌛;檶p;檺im;择olint;樓iíሄ;䑁otƀ;be㌴ᵇ㌵担;橦΀Aacmstx㍆㍊㍗㍛㍞㍣㍭rr;懘rĀhr㍐㍒ë∨Ā;oਸ਼਴t耻§䂧i;䀻war;椩mĀin㍩ðnuóñt;朶rĀ;o㍶⁕쀀𝔰Ȁacoy㎂㎆㎑㎠rp;景Āhy㎋㎏cy;䑉;䑈rtɭ㎙\0\0㎜iäᑤaraì⹯耻­䂭Āgm㎨㎴maƀ;fv㎱㎲㎲䏃;䏂Ѐ;deglnprካ㏅㏉㏎㏖㏞㏡㏦ot;橪Ā;q኱ኰĀ;E㏓㏔檞;檠Ā;E㏛㏜檝;檟e;扆lus;樤arr;楲aròᄽȀaeit㏸㐈㐏㐗Āls㏽㐄lsetmé㍪hp;樳parsl;槤Ādlᑣ㐔e;挣Ā;e㐜㐝檪Ā;s㐢㐣檬;쀀⪬︀ƀflp㐮㐳㑂tcy;䑌Ā;b㐸㐹䀯Ā;a㐾㐿槄r;挿f;쀀𝕤aĀdr㑍ЂesĀ;u㑔㑕晠it»㑕ƀcsu㑠㑹㒟Āau㑥㑯pĀ;sᆈ㑫;쀀⊓︀pĀ;sᆴ㑵;쀀⊔︀uĀbp㑿㒏ƀ;esᆗᆜ㒆etĀ;eᆗ㒍ñᆝƀ;esᆨᆭ㒖etĀ;eᆨ㒝ñᆮƀ;afᅻ㒦ְrť㒫ֱ»ᅼaròᅈȀcemt㒹㒾㓂㓅r;쀀𝓈tmîñiì㐕aræᆾĀar㓎㓕rĀ;f㓔ឿ昆Āan㓚㓭ightĀep㓣㓪psiloîỠhé⺯s»⡒ʀbcmnp㓻㕞ሉ㖋㖎Ҁ;Edemnprs㔎㔏㔑㔕㔞㔣㔬㔱㔶抂;櫅ot;檽Ā;dᇚ㔚ot;櫃ult;櫁ĀEe㔨㔪;櫋;把lus;檿arr;楹ƀeiu㔽㕒㕕tƀ;en㔎㕅㕋qĀ;qᇚ㔏eqĀ;q㔫㔨m;櫇Ābp㕚㕜;櫕;櫓c̀;acensᇭ㕬㕲㕹㕻㌦pproø㋺urlyeñᇾñᇳƀaes㖂㖈㌛pproø㌚qñ㌗g;晪ڀ123;Edehlmnps㖩㖬㖯ሜ㖲㖴㗀㗉㗕㗚㗟㗨㗭耻¹䂹耻²䂲耻³䂳;櫆Āos㖹㖼t;檾ub;櫘Ā;dሢ㗅ot;櫄sĀou㗏㗒l;柉b;櫗arr;楻ult;櫂ĀEe㗤㗦;櫌;抋lus;櫀ƀeiu㗴㘉㘌tƀ;enሜ㗼㘂qĀ;qሢ㖲eqĀ;q㗧㗤m;櫈Ābp㘑㘓;櫔;櫖ƀAan㘜㘠㘭rr;懙rĀhr㘦㘨ë∮Ā;oਫ਩war;椪lig耻ß䃟௡㙑㙝㙠ዎ㙳㙹\0㙾㛂\0\0\0\0\0㛛㜃\0㜉㝬\0\0\0㞇ɲ㙖\0\0㙛get;挖;䏄rë๟ƀaey㙦㙫㙰ron;䅥dil;䅣;䑂lrec;挕r;쀀𝔱Ȁeiko㚆㚝㚵㚼ǲ㚋\0㚑eĀ4fኄኁaƀ;sv㚘㚙㚛䎸ym;䏑Ācn㚢㚲kĀas㚨㚮pproø዁im»ኬsðኞĀas㚺㚮ð዁rn耻þ䃾Ǭ̟㛆⋧es膀×;bd㛏㛐㛘䃗Ā;aᤏ㛕r;樱;樰ƀeps㛡㛣㜀á⩍Ȁ;bcf҆㛬㛰㛴ot;挶ir;櫱Ā;o㛹㛼쀀𝕥rk;櫚á㍢rime;怴ƀaip㜏㜒㝤dåቈ΀adempst㜡㝍㝀㝑㝗㝜㝟ngleʀ;dlqr㜰㜱㜶㝀㝂斵own»ᶻeftĀ;e⠀㜾ñम;扜ightĀ;e㊪㝋ñၚot;旬inus;樺lus;樹b;槍ime;樻ezium;揢ƀcht㝲㝽㞁Āry㝷㝻;쀀𝓉;䑆cy;䑛rok;䅧Āio㞋㞎xô᝷headĀlr㞗㞠eftarro÷ࡏightarrow»ཝऀAHabcdfghlmoprstuw㟐㟓㟗㟤㟰㟼㠎㠜㠣㠴㡑㡝㡫㢩㣌㣒㣪㣶ròϭar;楣Ācr㟜㟢ute耻ú䃺òᅐrǣ㟪\0㟭y;䑞ve;䅭Āiy㟵㟺rc耻û䃻;䑃ƀabh㠃㠆㠋ròᎭlac;䅱aòᏃĀir㠓㠘sht;楾;쀀𝔲rave耻ù䃹š㠧㠱rĀlr㠬㠮»ॗ»ႃlk;斀Āct㠹㡍ɯ㠿\0\0㡊rnĀ;e㡅㡆挜r»㡆op;挏ri;旸Āal㡖㡚cr;䅫肻¨͉Āgp㡢㡦on;䅳f;쀀𝕦̀adhlsuᅋ㡸㡽፲㢑㢠ownáᎳarpoonĀlr㢈㢌efô㠭ighô㠯iƀ;hl㢙㢚㢜䏅»ᏺon»㢚parrows;懈ƀcit㢰㣄㣈ɯ㢶\0\0㣁rnĀ;e㢼㢽挝r»㢽op;挎ng;䅯ri;旹cr;쀀𝓊ƀdir㣙㣝㣢ot;拰lde;䅩iĀ;f㜰㣨»᠓Āam㣯㣲rò㢨l耻ü䃼angle;榧ހABDacdeflnoprsz㤜㤟㤩㤭㦵㦸㦽㧟㧤㧨㧳㧹㧽㨁㨠ròϷarĀ;v㤦㤧櫨;櫩asèϡĀnr㤲㤷grt;榜΀eknprst㓣㥆㥋㥒㥝㥤㦖appá␕othinçẖƀhir㓫⻈㥙opô⾵Ā;hᎷ㥢ïㆍĀiu㥩㥭gmá㎳Ābp㥲㦄setneqĀ;q㥽㦀쀀⊊︀;쀀⫋︀setneqĀ;q㦏㦒쀀⊋︀;쀀⫌︀Āhr㦛㦟etá㚜iangleĀlr㦪㦯eft»थight»ၑy;䐲ash»ံƀelr㧄㧒㧗ƀ;beⷪ㧋㧏ar;抻q;扚lip;拮Ābt㧜ᑨaòᑩr;쀀𝔳tré㦮suĀbp㧯㧱»ജ»൙pf;쀀𝕧roð໻tré㦴Ācu㨆㨋r;쀀𝓋Ābp㨐㨘nĀEe㦀㨖»㥾nĀEe㦒㨞»㦐igzag;榚΀cefoprs㨶㨻㩖㩛㩔㩡㩪irc;䅵Ādi㩀㩑Ābg㩅㩉ar;機eĀ;qᗺ㩏;扙erp;愘r;쀀𝔴pf;쀀𝕨Ā;eᑹ㩦atèᑹcr;쀀𝓌ૣណ㪇\0㪋\0㪐㪛\0\0㪝㪨㪫㪯\0\0㫃㫎\0㫘ៜ៟tré៑r;쀀𝔵ĀAa㪔㪗ròσrò৶;䎾ĀAa㪡㪤ròθrò৫að✓is;拻ƀdptឤ㪵㪾Āfl㪺ឩ;쀀𝕩imåឲĀAa㫇㫊ròώròਁĀcq㫒ីr;쀀𝓍Āpt៖㫜ré។Ѐacefiosu㫰㫽㬈㬌㬑㬕㬛㬡cĀuy㫶㫻te耻ý䃽;䑏Āiy㬂㬆rc;䅷;䑋n耻¥䂥r;쀀𝔶cy;䑗pf;쀀𝕪cr;쀀𝓎Ācm㬦㬩y;䑎l耻ÿ䃿Ԁacdefhiosw㭂㭈㭔㭘㭤㭩㭭㭴㭺㮀cute;䅺Āay㭍㭒ron;䅾;䐷ot;䅼Āet㭝㭡træᕟa;䎶r;쀀𝔷cy;䐶grarr;懝pf;쀀𝕫cr;쀀𝓏Ājn㮅㮇;怍j;怌'.split("").map((t=>t.charCodeAt(0)))),Z=new Uint16Array("Ȁaglq\tɭ\0\0p;䀦os;䀧t;䀾t;䀼uot;䀢".split("").map((t=>t.charCodeAt(0))));var tt;const et=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),nt=null!==(tt=String.fromCodePoint)&&void 0!==tt?tt:function(t){let e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|1023&t),e+=String.fromCharCode(t),e};var it,rt,st,at,ot;function lt(t){return t>=it.ZERO&&t<=it.NINE}!function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"}(it||(it={})),function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"}(rt||(rt={})),function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"}(st||(st={})),(ot=at||(at={}))[ot.Legacy=0]="Legacy",ot[ot.Strict=1]="Strict",ot[ot.Attribute=2]="Attribute";class ct{constructor(t,e,n){this.decodeTree=t,this.emitCodePoint=e,this.errors=n,this.state=st.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=at.Strict}startEntity(t){this.decodeMode=t,this.state=st.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,e){switch(this.state){case st.EntityStart:return t.charCodeAt(e)===it.NUM?(this.state=st.NumericStart,this.consumed+=1,this.stateNumericStart(t,e+1)):(this.state=st.NamedEntity,this.stateNamedEntity(t,e));case st.NumericStart:return this.stateNumericStart(t,e);case st.NumericDecimal:return this.stateNumericDecimal(t,e);case st.NumericHex:return this.stateNumericHex(t,e);case st.NamedEntity:return this.stateNamedEntity(t,e)}}stateNumericStart(t,e){return e>=t.length?-1:(32|t.charCodeAt(e))===it.LOWER_X?(this.state=st.NumericHex,this.consumed+=1,this.stateNumericHex(t,e+1)):(this.state=st.NumericDecimal,this.stateNumericDecimal(t,e))}addToNumericResult(t,e,n,i){if(e!==n){const r=n-e;this.result=this.result*Math.pow(i,r)+Number.parseInt(t.substr(e,r),i),this.consumed+=r}}stateNumericHex(t,e){const n=e;for(;e<t.length;){const r=t.charCodeAt(e);if(!(lt(r)||(i=r,i>=it.UPPER_A&&i<=it.UPPER_F||i>=it.LOWER_A&&i<=it.LOWER_F)))return this.addToNumericResult(t,n,e,16),this.emitNumericEntity(r,3);e+=1}var i;return this.addToNumericResult(t,n,e,16),-1}stateNumericDecimal(t,e){const n=e;for(;e<t.length;){const i=t.charCodeAt(e);if(!lt(i))return this.addToNumericResult(t,n,e,10),this.emitNumericEntity(i,2);e+=1}return this.addToNumericResult(t,n,e,10),-1}emitNumericEntity(t,e){var n;if(this.consumed<=e)return null===(n=this.errors)||void 0===n||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===it.SEMI)this.consumed+=1;else if(this.decodeMode===at.Strict)return 0;return this.emitCodePoint(function(t){var e;return t>=55296&&t<=57343||t>1114111?65533:null!==(e=et.get(t))&&void 0!==e?e:t}(this.result),this.consumed),this.errors&&(t!==it.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,e){const{decodeTree:n}=this;let i=n[this.treeIndex],r=(i&rt.VALUE_LENGTH)>>14;for(;e<t.length;e++,this.excess++){const a=t.charCodeAt(e);if(this.treeIndex=ht(n,i,this.treeIndex+Math.max(1,r),a),this.treeIndex<0)return 0===this.result||this.decodeMode===at.Attribute&&(0===r||((s=a)===it.EQUALS||function(t){return t>=it.UPPER_A&&t<=it.UPPER_Z||t>=it.LOWER_A&&t<=it.LOWER_Z||lt(t)}(s)))?0:this.emitNotTerminatedNamedEntity();if(i=n[this.treeIndex],r=(i&rt.VALUE_LENGTH)>>14,0!==r){if(a===it.SEMI)return this.emitNamedEntityData(this.treeIndex,r,this.consumed+this.excess);this.decodeMode!==at.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}var s;return-1}emitNotTerminatedNamedEntity(){var t;const{result:e,decodeTree:n}=this,i=(n[e]&rt.VALUE_LENGTH)>>14;return this.emitNamedEntityData(e,i,this.consumed),null===(t=this.errors)||void 0===t||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,e,n){const{decodeTree:i}=this;return this.emitCodePoint(1===e?i[t]&~rt.VALUE_LENGTH:i[t+1],n),3===e&&this.emitCodePoint(i[t+2],n),n}end(){var t;switch(this.state){case st.NamedEntity:return 0===this.result||this.decodeMode===at.Attribute&&this.result!==this.treeIndex?0:this.emitNotTerminatedNamedEntity();case st.NumericDecimal:return this.emitNumericEntity(0,2);case st.NumericHex:return this.emitNumericEntity(0,3);case st.NumericStart:return null===(t=this.errors)||void 0===t||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case st.EntityStart:return 0}}}function dt(t){let e="";const n=new ct(t,(t=>e+=nt(t)));return function(t,i){let r=0,s=0;for(;(s=t.indexOf("&",s))>=0;){e+=t.slice(r,s),n.startEntity(i);const a=n.write(t,s+1);if(a<0){r=s+n.end();break}r=s+a,s=0===a?r+1:r}const a=e+t.slice(r);return e="",a}}function ht(t,e,n,i){const r=(e&rt.BRANCH_LENGTH)>>7,s=e&rt.JUMP_TABLE;if(0===r)return 0!==s&&i===s?n:-1;if(s){const e=i-s;return e<0||e>=r?-1:t[n+e]-1}let a=n,o=a+r-1;for(;a<=o;){const e=a+o>>>1,n=t[e];if(n<i)a=e+1;else{if(!(n>i))return t[e+r];o=e-1}}return-1}const ut=dt(J);function pt(t){for(let e=1;e<t.length;e++)t[e][0]+=t[e-1][0]+1;return t}dt(Z),new Map(pt([[9,"&Tab;"],[0,"&NewLine;"],[22,"&excl;"],[0,"&quot;"],[0,"&num;"],[0,"&dollar;"],[0,"&percnt;"],[0,"&amp;"],[0,"&apos;"],[0,"&lpar;"],[0,"&rpar;"],[0,"&ast;"],[0,"&plus;"],[0,"&comma;"],[1,"&period;"],[0,"&sol;"],[10,"&colon;"],[0,"&semi;"],[0,{v:"&lt;",n:8402,o:"&nvlt;"}],[0,{v:"&equals;",n:8421,o:"&bne;"}],[0,{v:"&gt;",n:8402,o:"&nvgt;"}],[0,"&quest;"],[0,"&commat;"],[26,"&lbrack;"],[0,"&bsol;"],[0,"&rbrack;"],[0,"&Hat;"],[0,"&lowbar;"],[0,"&DiacriticalGrave;"],[5,{n:106,o:"&fjlig;"}],[20,"&lbrace;"],[0,"&verbar;"],[0,"&rbrace;"],[34,"&nbsp;"],[0,"&iexcl;"],[0,"&cent;"],[0,"&pound;"],[0,"&curren;"],[0,"&yen;"],[0,"&brvbar;"],[0,"&sect;"],[0,"&die;"],[0,"&copy;"],[0,"&ordf;"],[0,"&laquo;"],[0,"&not;"],[0,"&shy;"],[0,"&circledR;"],[0,"&macr;"],[0,"&deg;"],[0,"&PlusMinus;"],[0,"&sup2;"],[0,"&sup3;"],[0,"&acute;"],[0,"&micro;"],[0,"&para;"],[0,"&centerdot;"],[0,"&cedil;"],[0,"&sup1;"],[0,"&ordm;"],[0,"&raquo;"],[0,"&frac14;"],[0,"&frac12;"],[0,"&frac34;"],[0,"&iquest;"],[0,"&Agrave;"],[0,"&Aacute;"],[0,"&Acirc;"],[0,"&Atilde;"],[0,"&Auml;"],[0,"&angst;"],[0,"&AElig;"],[0,"&Ccedil;"],[0,"&Egrave;"],[0,"&Eacute;"],[0,"&Ecirc;"],[0,"&Euml;"],[0,"&Igrave;"],[0,"&Iacute;"],[0,"&Icirc;"],[0,"&Iuml;"],[0,"&ETH;"],[0,"&Ntilde;"],[0,"&Ograve;"],[0,"&Oacute;"],[0,"&Ocirc;"],[0,"&Otilde;"],[0,"&Ouml;"],[0,"&times;"],[0,"&Oslash;"],[0,"&Ugrave;"],[0,"&Uacute;"],[0,"&Ucirc;"],[0,"&Uuml;"],[0,"&Yacute;"],[0,"&THORN;"],[0,"&szlig;"],[0,"&agrave;"],[0,"&aacute;"],[0,"&acirc;"],[0,"&atilde;"],[0,"&auml;"],[0,"&aring;"],[0,"&aelig;"],[0,"&ccedil;"],[0,"&egrave;"],[0,"&eacute;"],[0,"&ecirc;"],[0,"&euml;"],[0,"&igrave;"],[0,"&iacute;"],[0,"&icirc;"],[0,"&iuml;"],[0,"&eth;"],[0,"&ntilde;"],[0,"&ograve;"],[0,"&oacute;"],[0,"&ocirc;"],[0,"&otilde;"],[0,"&ouml;"],[0,"&div;"],[0,"&oslash;"],[0,"&ugrave;"],[0,"&uacute;"],[0,"&ucirc;"],[0,"&uuml;"],[0,"&yacute;"],[0,"&thorn;"],[0,"&yuml;"],[0,"&Amacr;"],[0,"&amacr;"],[0,"&Abreve;"],[0,"&abreve;"],[0,"&Aogon;"],[0,"&aogon;"],[0,"&Cacute;"],[0,"&cacute;"],[0,"&Ccirc;"],[0,"&ccirc;"],[0,"&Cdot;"],[0,"&cdot;"],[0,"&Ccaron;"],[0,"&ccaron;"],[0,"&Dcaron;"],[0,"&dcaron;"],[0,"&Dstrok;"],[0,"&dstrok;"],[0,"&Emacr;"],[0,"&emacr;"],[2,"&Edot;"],[0,"&edot;"],[0,"&Eogon;"],[0,"&eogon;"],[0,"&Ecaron;"],[0,"&ecaron;"],[0,"&Gcirc;"],[0,"&gcirc;"],[0,"&Gbreve;"],[0,"&gbreve;"],[0,"&Gdot;"],[0,"&gdot;"],[0,"&Gcedil;"],[1,"&Hcirc;"],[0,"&hcirc;"],[0,"&Hstrok;"],[0,"&hstrok;"],[0,"&Itilde;"],[0,"&itilde;"],[0,"&Imacr;"],[0,"&imacr;"],[2,"&Iogon;"],[0,"&iogon;"],[0,"&Idot;"],[0,"&imath;"],[0,"&IJlig;"],[0,"&ijlig;"],[0,"&Jcirc;"],[0,"&jcirc;"],[0,"&Kcedil;"],[0,"&kcedil;"],[0,"&kgreen;"],[0,"&Lacute;"],[0,"&lacute;"],[0,"&Lcedil;"],[0,"&lcedil;"],[0,"&Lcaron;"],[0,"&lcaron;"],[0,"&Lmidot;"],[0,"&lmidot;"],[0,"&Lstrok;"],[0,"&lstrok;"],[0,"&Nacute;"],[0,"&nacute;"],[0,"&Ncedil;"],[0,"&ncedil;"],[0,"&Ncaron;"],[0,"&ncaron;"],[0,"&napos;"],[0,"&ENG;"],[0,"&eng;"],[0,"&Omacr;"],[0,"&omacr;"],[2,"&Odblac;"],[0,"&odblac;"],[0,"&OElig;"],[0,"&oelig;"],[0,"&Racute;"],[0,"&racute;"],[0,"&Rcedil;"],[0,"&rcedil;"],[0,"&Rcaron;"],[0,"&rcaron;"],[0,"&Sacute;"],[0,"&sacute;"],[0,"&Scirc;"],[0,"&scirc;"],[0,"&Scedil;"],[0,"&scedil;"],[0,"&Scaron;"],[0,"&scaron;"],[0,"&Tcedil;"],[0,"&tcedil;"],[0,"&Tcaron;"],[0,"&tcaron;"],[0,"&Tstrok;"],[0,"&tstrok;"],[0,"&Utilde;"],[0,"&utilde;"],[0,"&Umacr;"],[0,"&umacr;"],[0,"&Ubreve;"],[0,"&ubreve;"],[0,"&Uring;"],[0,"&uring;"],[0,"&Udblac;"],[0,"&udblac;"],[0,"&Uogon;"],[0,"&uogon;"],[0,"&Wcirc;"],[0,"&wcirc;"],[0,"&Ycirc;"],[0,"&ycirc;"],[0,"&Yuml;"],[0,"&Zacute;"],[0,"&zacute;"],[0,"&Zdot;"],[0,"&zdot;"],[0,"&Zcaron;"],[0,"&zcaron;"],[19,"&fnof;"],[34,"&imped;"],[63,"&gacute;"],[65,"&jmath;"],[142,"&circ;"],[0,"&caron;"],[16,"&breve;"],[0,"&DiacriticalDot;"],[0,"&ring;"],[0,"&ogon;"],[0,"&DiacriticalTilde;"],[0,"&dblac;"],[51,"&DownBreve;"],[127,"&Alpha;"],[0,"&Beta;"],[0,"&Gamma;"],[0,"&Delta;"],[0,"&Epsilon;"],[0,"&Zeta;"],[0,"&Eta;"],[0,"&Theta;"],[0,"&Iota;"],[0,"&Kappa;"],[0,"&Lambda;"],[0,"&Mu;"],[0,"&Nu;"],[0,"&Xi;"],[0,"&Omicron;"],[0,"&Pi;"],[0,"&Rho;"],[1,"&Sigma;"],[0,"&Tau;"],[0,"&Upsilon;"],[0,"&Phi;"],[0,"&Chi;"],[0,"&Psi;"],[0,"&ohm;"],[7,"&alpha;"],[0,"&beta;"],[0,"&gamma;"],[0,"&delta;"],[0,"&epsi;"],[0,"&zeta;"],[0,"&eta;"],[0,"&theta;"],[0,"&iota;"],[0,"&kappa;"],[0,"&lambda;"],[0,"&mu;"],[0,"&nu;"],[0,"&xi;"],[0,"&omicron;"],[0,"&pi;"],[0,"&rho;"],[0,"&sigmaf;"],[0,"&sigma;"],[0,"&tau;"],[0,"&upsi;"],[0,"&phi;"],[0,"&chi;"],[0,"&psi;"],[0,"&omega;"],[7,"&thetasym;"],[0,"&Upsi;"],[2,"&phiv;"],[0,"&piv;"],[5,"&Gammad;"],[0,"&digamma;"],[18,"&kappav;"],[0,"&rhov;"],[3,"&epsiv;"],[0,"&backepsilon;"],[10,"&IOcy;"],[0,"&DJcy;"],[0,"&GJcy;"],[0,"&Jukcy;"],[0,"&DScy;"],[0,"&Iukcy;"],[0,"&YIcy;"],[0,"&Jsercy;"],[0,"&LJcy;"],[0,"&NJcy;"],[0,"&TSHcy;"],[0,"&KJcy;"],[1,"&Ubrcy;"],[0,"&DZcy;"],[0,"&Acy;"],[0,"&Bcy;"],[0,"&Vcy;"],[0,"&Gcy;"],[0,"&Dcy;"],[0,"&IEcy;"],[0,"&ZHcy;"],[0,"&Zcy;"],[0,"&Icy;"],[0,"&Jcy;"],[0,"&Kcy;"],[0,"&Lcy;"],[0,"&Mcy;"],[0,"&Ncy;"],[0,"&Ocy;"],[0,"&Pcy;"],[0,"&Rcy;"],[0,"&Scy;"],[0,"&Tcy;"],[0,"&Ucy;"],[0,"&Fcy;"],[0,"&KHcy;"],[0,"&TScy;"],[0,"&CHcy;"],[0,"&SHcy;"],[0,"&SHCHcy;"],[0,"&HARDcy;"],[0,"&Ycy;"],[0,"&SOFTcy;"],[0,"&Ecy;"],[0,"&YUcy;"],[0,"&YAcy;"],[0,"&acy;"],[0,"&bcy;"],[0,"&vcy;"],[0,"&gcy;"],[0,"&dcy;"],[0,"&iecy;"],[0,"&zhcy;"],[0,"&zcy;"],[0,"&icy;"],[0,"&jcy;"],[0,"&kcy;"],[0,"&lcy;"],[0,"&mcy;"],[0,"&ncy;"],[0,"&ocy;"],[0,"&pcy;"],[0,"&rcy;"],[0,"&scy;"],[0,"&tcy;"],[0,"&ucy;"],[0,"&fcy;"],[0,"&khcy;"],[0,"&tscy;"],[0,"&chcy;"],[0,"&shcy;"],[0,"&shchcy;"],[0,"&hardcy;"],[0,"&ycy;"],[0,"&softcy;"],[0,"&ecy;"],[0,"&yucy;"],[0,"&yacy;"],[1,"&iocy;"],[0,"&djcy;"],[0,"&gjcy;"],[0,"&jukcy;"],[0,"&dscy;"],[0,"&iukcy;"],[0,"&yicy;"],[0,"&jsercy;"],[0,"&ljcy;"],[0,"&njcy;"],[0,"&tshcy;"],[0,"&kjcy;"],[1,"&ubrcy;"],[0,"&dzcy;"],[7074,"&ensp;"],[0,"&emsp;"],[0,"&emsp13;"],[0,"&emsp14;"],[1,"&numsp;"],[0,"&puncsp;"],[0,"&ThinSpace;"],[0,"&hairsp;"],[0,"&NegativeMediumSpace;"],[0,"&zwnj;"],[0,"&zwj;"],[0,"&lrm;"],[0,"&rlm;"],[0,"&dash;"],[2,"&ndash;"],[0,"&mdash;"],[0,"&horbar;"],[0,"&Verbar;"],[1,"&lsquo;"],[0,"&CloseCurlyQuote;"],[0,"&lsquor;"],[1,"&ldquo;"],[0,"&CloseCurlyDoubleQuote;"],[0,"&bdquo;"],[1,"&dagger;"],[0,"&Dagger;"],[0,"&bull;"],[2,"&nldr;"],[0,"&hellip;"],[9,"&permil;"],[0,"&pertenk;"],[0,"&prime;"],[0,"&Prime;"],[0,"&tprime;"],[0,"&backprime;"],[3,"&lsaquo;"],[0,"&rsaquo;"],[3,"&oline;"],[2,"&caret;"],[1,"&hybull;"],[0,"&frasl;"],[10,"&bsemi;"],[7,"&qprime;"],[7,{v:"&MediumSpace;",n:8202,o:"&ThickSpace;"}],[0,"&NoBreak;"],[0,"&af;"],[0,"&InvisibleTimes;"],[0,"&ic;"],[72,"&euro;"],[46,"&tdot;"],[0,"&DotDot;"],[37,"&complexes;"],[2,"&incare;"],[4,"&gscr;"],[0,"&hamilt;"],[0,"&Hfr;"],[0,"&Hopf;"],[0,"&planckh;"],[0,"&hbar;"],[0,"&imagline;"],[0,"&Ifr;"],[0,"&lagran;"],[0,"&ell;"],[1,"&naturals;"],[0,"&numero;"],[0,"&copysr;"],[0,"&weierp;"],[0,"&Popf;"],[0,"&Qopf;"],[0,"&realine;"],[0,"&real;"],[0,"&reals;"],[0,"&rx;"],[3,"&trade;"],[1,"&integers;"],[2,"&mho;"],[0,"&zeetrf;"],[0,"&iiota;"],[2,"&bernou;"],[0,"&Cayleys;"],[1,"&escr;"],[0,"&Escr;"],[0,"&Fouriertrf;"],[1,"&Mellintrf;"],[0,"&order;"],[0,"&alefsym;"],[0,"&beth;"],[0,"&gimel;"],[0,"&daleth;"],[12,"&CapitalDifferentialD;"],[0,"&dd;"],[0,"&ee;"],[0,"&ii;"],[10,"&frac13;"],[0,"&frac23;"],[0,"&frac15;"],[0,"&frac25;"],[0,"&frac35;"],[0,"&frac45;"],[0,"&frac16;"],[0,"&frac56;"],[0,"&frac18;"],[0,"&frac38;"],[0,"&frac58;"],[0,"&frac78;"],[49,"&larr;"],[0,"&ShortUpArrow;"],[0,"&rarr;"],[0,"&darr;"],[0,"&harr;"],[0,"&updownarrow;"],[0,"&nwarr;"],[0,"&nearr;"],[0,"&LowerRightArrow;"],[0,"&LowerLeftArrow;"],[0,"&nlarr;"],[0,"&nrarr;"],[1,{v:"&rarrw;",n:824,o:"&nrarrw;"}],[0,"&Larr;"],[0,"&Uarr;"],[0,"&Rarr;"],[0,"&Darr;"],[0,"&larrtl;"],[0,"&rarrtl;"],[0,"&LeftTeeArrow;"],[0,"&mapstoup;"],[0,"&map;"],[0,"&DownTeeArrow;"],[1,"&hookleftarrow;"],[0,"&hookrightarrow;"],[0,"&larrlp;"],[0,"&looparrowright;"],[0,"&harrw;"],[0,"&nharr;"],[1,"&lsh;"],[0,"&rsh;"],[0,"&ldsh;"],[0,"&rdsh;"],[1,"&crarr;"],[0,"&cularr;"],[0,"&curarr;"],[2,"&circlearrowleft;"],[0,"&circlearrowright;"],[0,"&leftharpoonup;"],[0,"&DownLeftVector;"],[0,"&RightUpVector;"],[0,"&LeftUpVector;"],[0,"&rharu;"],[0,"&DownRightVector;"],[0,"&dharr;"],[0,"&dharl;"],[0,"&RightArrowLeftArrow;"],[0,"&udarr;"],[0,"&LeftArrowRightArrow;"],[0,"&leftleftarrows;"],[0,"&upuparrows;"],[0,"&rightrightarrows;"],[0,"&ddarr;"],[0,"&leftrightharpoons;"],[0,"&Equilibrium;"],[0,"&nlArr;"],[0,"&nhArr;"],[0,"&nrArr;"],[0,"&DoubleLeftArrow;"],[0,"&DoubleUpArrow;"],[0,"&DoubleRightArrow;"],[0,"&dArr;"],[0,"&DoubleLeftRightArrow;"],[0,"&DoubleUpDownArrow;"],[0,"&nwArr;"],[0,"&neArr;"],[0,"&seArr;"],[0,"&swArr;"],[0,"&lAarr;"],[0,"&rAarr;"],[1,"&zigrarr;"],[6,"&larrb;"],[0,"&rarrb;"],[15,"&DownArrowUpArrow;"],[7,"&loarr;"],[0,"&roarr;"],[0,"&hoarr;"],[0,"&forall;"],[0,"&comp;"],[0,{v:"&part;",n:824,o:"&npart;"}],[0,"&exist;"],[0,"&nexist;"],[0,"&empty;"],[1,"&Del;"],[0,"&Element;"],[0,"&NotElement;"],[1,"&ni;"],[0,"&notni;"],[2,"&prod;"],[0,"&coprod;"],[0,"&sum;"],[0,"&minus;"],[0,"&MinusPlus;"],[0,"&dotplus;"],[1,"&Backslash;"],[0,"&lowast;"],[0,"&compfn;"],[1,"&radic;"],[2,"&prop;"],[0,"&infin;"],[0,"&angrt;"],[0,{v:"&ang;",n:8402,o:"&nang;"}],[0,"&angmsd;"],[0,"&angsph;"],[0,"&mid;"],[0,"&nmid;"],[0,"&DoubleVerticalBar;"],[0,"&NotDoubleVerticalBar;"],[0,"&and;"],[0,"&or;"],[0,{v:"&cap;",n:65024,o:"&caps;"}],[0,{v:"&cup;",n:65024,o:"&cups;"}],[0,"&int;"],[0,"&Int;"],[0,"&iiint;"],[0,"&conint;"],[0,"&Conint;"],[0,"&Cconint;"],[0,"&cwint;"],[0,"&ClockwiseContourIntegral;"],[0,"&awconint;"],[0,"&there4;"],[0,"&becaus;"],[0,"&ratio;"],[0,"&Colon;"],[0,"&dotminus;"],[1,"&mDDot;"],[0,"&homtht;"],[0,{v:"&sim;",n:8402,o:"&nvsim;"}],[0,{v:"&backsim;",n:817,o:"&race;"}],[0,{v:"&ac;",n:819,o:"&acE;"}],[0,"&acd;"],[0,"&VerticalTilde;"],[0,"&NotTilde;"],[0,{v:"&eqsim;",n:824,o:"&nesim;"}],[0,"&sime;"],[0,"&NotTildeEqual;"],[0,"&cong;"],[0,"&simne;"],[0,"&ncong;"],[0,"&ap;"],[0,"&nap;"],[0,"&ape;"],[0,{v:"&apid;",n:824,o:"&napid;"}],[0,"&backcong;"],[0,{v:"&asympeq;",n:8402,o:"&nvap;"}],[0,{v:"&bump;",n:824,o:"&nbump;"}],[0,{v:"&bumpe;",n:824,o:"&nbumpe;"}],[0,{v:"&doteq;",n:824,o:"&nedot;"}],[0,"&doteqdot;"],[0,"&efDot;"],[0,"&erDot;"],[0,"&Assign;"],[0,"&ecolon;"],[0,"&ecir;"],[0,"&circeq;"],[1,"&wedgeq;"],[0,"&veeeq;"],[1,"&triangleq;"],[2,"&equest;"],[0,"&ne;"],[0,{v:"&Congruent;",n:8421,o:"&bnequiv;"}],[0,"&nequiv;"],[1,{v:"&le;",n:8402,o:"&nvle;"}],[0,{v:"&ge;",n:8402,o:"&nvge;"}],[0,{v:"&lE;",n:824,o:"&nlE;"}],[0,{v:"&gE;",n:824,o:"&ngE;"}],[0,{v:"&lnE;",n:65024,o:"&lvertneqq;"}],[0,{v:"&gnE;",n:65024,o:"&gvertneqq;"}],[0,{v:"&ll;",n:new Map(pt([[824,"&nLtv;"],[7577,"&nLt;"]]))}],[0,{v:"&gg;",n:new Map(pt([[824,"&nGtv;"],[7577,"&nGt;"]]))}],[0,"&between;"],[0,"&NotCupCap;"],[0,"&nless;"],[0,"&ngt;"],[0,"&nle;"],[0,"&nge;"],[0,"&lesssim;"],[0,"&GreaterTilde;"],[0,"&nlsim;"],[0,"&ngsim;"],[0,"&LessGreater;"],[0,"&gl;"],[0,"&NotLessGreater;"],[0,"&NotGreaterLess;"],[0,"&pr;"],[0,"&sc;"],[0,"&prcue;"],[0,"&sccue;"],[0,"&PrecedesTilde;"],[0,{v:"&scsim;",n:824,o:"&NotSucceedsTilde;"}],[0,"&NotPrecedes;"],[0,"&NotSucceeds;"],[0,{v:"&sub;",n:8402,o:"&NotSubset;"}],[0,{v:"&sup;",n:8402,o:"&NotSuperset;"}],[0,"&nsub;"],[0,"&nsup;"],[0,"&sube;"],[0,"&supe;"],[0,"&NotSubsetEqual;"],[0,"&NotSupersetEqual;"],[0,{v:"&subne;",n:65024,o:"&varsubsetneq;"}],[0,{v:"&supne;",n:65024,o:"&varsupsetneq;"}],[1,"&cupdot;"],[0,"&UnionPlus;"],[0,{v:"&sqsub;",n:824,o:"&NotSquareSubset;"}],[0,{v:"&sqsup;",n:824,o:"&NotSquareSuperset;"}],[0,"&sqsube;"],[0,"&sqsupe;"],[0,{v:"&sqcap;",n:65024,o:"&sqcaps;"}],[0,{v:"&sqcup;",n:65024,o:"&sqcups;"}],[0,"&CirclePlus;"],[0,"&CircleMinus;"],[0,"&CircleTimes;"],[0,"&osol;"],[0,"&CircleDot;"],[0,"&circledcirc;"],[0,"&circledast;"],[1,"&circleddash;"],[0,"&boxplus;"],[0,"&boxminus;"],[0,"&boxtimes;"],[0,"&dotsquare;"],[0,"&RightTee;"],[0,"&dashv;"],[0,"&DownTee;"],[0,"&bot;"],[1,"&models;"],[0,"&DoubleRightTee;"],[0,"&Vdash;"],[0,"&Vvdash;"],[0,"&VDash;"],[0,"&nvdash;"],[0,"&nvDash;"],[0,"&nVdash;"],[0,"&nVDash;"],[0,"&prurel;"],[1,"&LeftTriangle;"],[0,"&RightTriangle;"],[0,{v:"&LeftTriangleEqual;",n:8402,o:"&nvltrie;"}],[0,{v:"&RightTriangleEqual;",n:8402,o:"&nvrtrie;"}],[0,"&origof;"],[0,"&imof;"],[0,"&multimap;"],[0,"&hercon;"],[0,"&intcal;"],[0,"&veebar;"],[1,"&barvee;"],[0,"&angrtvb;"],[0,"&lrtri;"],[0,"&bigwedge;"],[0,"&bigvee;"],[0,"&bigcap;"],[0,"&bigcup;"],[0,"&diam;"],[0,"&sdot;"],[0,"&sstarf;"],[0,"&divideontimes;"],[0,"&bowtie;"],[0,"&ltimes;"],[0,"&rtimes;"],[0,"&leftthreetimes;"],[0,"&rightthreetimes;"],[0,"&backsimeq;"],[0,"&curlyvee;"],[0,"&curlywedge;"],[0,"&Sub;"],[0,"&Sup;"],[0,"&Cap;"],[0,"&Cup;"],[0,"&fork;"],[0,"&epar;"],[0,"&lessdot;"],[0,"&gtdot;"],[0,{v:"&Ll;",n:824,o:"&nLl;"}],[0,{v:"&Gg;",n:824,o:"&nGg;"}],[0,{v:"&leg;",n:65024,o:"&lesg;"}],[0,{v:"&gel;",n:65024,o:"&gesl;"}],[2,"&cuepr;"],[0,"&cuesc;"],[0,"&NotPrecedesSlantEqual;"],[0,"&NotSucceedsSlantEqual;"],[0,"&NotSquareSubsetEqual;"],[0,"&NotSquareSupersetEqual;"],[2,"&lnsim;"],[0,"&gnsim;"],[0,"&precnsim;"],[0,"&scnsim;"],[0,"&nltri;"],[0,"&NotRightTriangle;"],[0,"&nltrie;"],[0,"&NotRightTriangleEqual;"],[0,"&vellip;"],[0,"&ctdot;"],[0,"&utdot;"],[0,"&dtdot;"],[0,"&disin;"],[0,"&isinsv;"],[0,"&isins;"],[0,{v:"&isindot;",n:824,o:"&notindot;"}],[0,"&notinvc;"],[0,"&notinvb;"],[1,{v:"&isinE;",n:824,o:"&notinE;"}],[0,"&nisd;"],[0,"&xnis;"],[0,"&nis;"],[0,"&notnivc;"],[0,"&notnivb;"],[6,"&barwed;"],[0,"&Barwed;"],[1,"&lceil;"],[0,"&rceil;"],[0,"&LeftFloor;"],[0,"&rfloor;"],[0,"&drcrop;"],[0,"&dlcrop;"],[0,"&urcrop;"],[0,"&ulcrop;"],[0,"&bnot;"],[1,"&profline;"],[0,"&profsurf;"],[1,"&telrec;"],[0,"&target;"],[5,"&ulcorn;"],[0,"&urcorn;"],[0,"&dlcorn;"],[0,"&drcorn;"],[2,"&frown;"],[0,"&smile;"],[9,"&cylcty;"],[0,"&profalar;"],[7,"&topbot;"],[6,"&ovbar;"],[1,"&solbar;"],[60,"&angzarr;"],[51,"&lmoustache;"],[0,"&rmoustache;"],[2,"&OverBracket;"],[0,"&bbrk;"],[0,"&bbrktbrk;"],[37,"&OverParenthesis;"],[0,"&UnderParenthesis;"],[0,"&OverBrace;"],[0,"&UnderBrace;"],[2,"&trpezium;"],[4,"&elinters;"],[59,"&blank;"],[164,"&circledS;"],[55,"&boxh;"],[1,"&boxv;"],[9,"&boxdr;"],[3,"&boxdl;"],[3,"&boxur;"],[3,"&boxul;"],[3,"&boxvr;"],[7,"&boxvl;"],[7,"&boxhd;"],[7,"&boxhu;"],[7,"&boxvh;"],[19,"&boxH;"],[0,"&boxV;"],[0,"&boxdR;"],[0,"&boxDr;"],[0,"&boxDR;"],[0,"&boxdL;"],[0,"&boxDl;"],[0,"&boxDL;"],[0,"&boxuR;"],[0,"&boxUr;"],[0,"&boxUR;"],[0,"&boxuL;"],[0,"&boxUl;"],[0,"&boxUL;"],[0,"&boxvR;"],[0,"&boxVr;"],[0,"&boxVR;"],[0,"&boxvL;"],[0,"&boxVl;"],[0,"&boxVL;"],[0,"&boxHd;"],[0,"&boxhD;"],[0,"&boxHD;"],[0,"&boxHu;"],[0,"&boxhU;"],[0,"&boxHU;"],[0,"&boxvH;"],[0,"&boxVh;"],[0,"&boxVH;"],[19,"&uhblk;"],[3,"&lhblk;"],[3,"&block;"],[8,"&blk14;"],[0,"&blk12;"],[0,"&blk34;"],[13,"&square;"],[8,"&blacksquare;"],[0,"&EmptyVerySmallSquare;"],[1,"&rect;"],[0,"&marker;"],[2,"&fltns;"],[1,"&bigtriangleup;"],[0,"&blacktriangle;"],[0,"&triangle;"],[2,"&blacktriangleright;"],[0,"&rtri;"],[3,"&bigtriangledown;"],[0,"&blacktriangledown;"],[0,"&dtri;"],[2,"&blacktriangleleft;"],[0,"&ltri;"],[6,"&loz;"],[0,"&cir;"],[32,"&tridot;"],[2,"&bigcirc;"],[8,"&ultri;"],[0,"&urtri;"],[0,"&lltri;"],[0,"&EmptySmallSquare;"],[0,"&FilledSmallSquare;"],[8,"&bigstar;"],[0,"&star;"],[7,"&phone;"],[49,"&female;"],[1,"&male;"],[29,"&spades;"],[2,"&clubs;"],[1,"&hearts;"],[0,"&diamondsuit;"],[3,"&sung;"],[2,"&flat;"],[0,"&natural;"],[0,"&sharp;"],[163,"&check;"],[3,"&cross;"],[8,"&malt;"],[21,"&sext;"],[33,"&VerticalSeparator;"],[25,"&lbbrk;"],[0,"&rbbrk;"],[84,"&bsolhsub;"],[0,"&suphsol;"],[28,"&LeftDoubleBracket;"],[0,"&RightDoubleBracket;"],[0,"&lang;"],[0,"&rang;"],[0,"&Lang;"],[0,"&Rang;"],[0,"&loang;"],[0,"&roang;"],[7,"&longleftarrow;"],[0,"&longrightarrow;"],[0,"&longleftrightarrow;"],[0,"&DoubleLongLeftArrow;"],[0,"&DoubleLongRightArrow;"],[0,"&DoubleLongLeftRightArrow;"],[1,"&longmapsto;"],[2,"&dzigrarr;"],[258,"&nvlArr;"],[0,"&nvrArr;"],[0,"&nvHarr;"],[0,"&Map;"],[6,"&lbarr;"],[0,"&bkarow;"],[0,"&lBarr;"],[0,"&dbkarow;"],[0,"&drbkarow;"],[0,"&DDotrahd;"],[0,"&UpArrowBar;"],[0,"&DownArrowBar;"],[2,"&Rarrtl;"],[2,"&latail;"],[0,"&ratail;"],[0,"&lAtail;"],[0,"&rAtail;"],[0,"&larrfs;"],[0,"&rarrfs;"],[0,"&larrbfs;"],[0,"&rarrbfs;"],[2,"&nwarhk;"],[0,"&nearhk;"],[0,"&hksearow;"],[0,"&hkswarow;"],[0,"&nwnear;"],[0,"&nesear;"],[0,"&seswar;"],[0,"&swnwar;"],[8,{v:"&rarrc;",n:824,o:"&nrarrc;"}],[1,"&cudarrr;"],[0,"&ldca;"],[0,"&rdca;"],[0,"&cudarrl;"],[0,"&larrpl;"],[2,"&curarrm;"],[0,"&cularrp;"],[7,"&rarrpl;"],[2,"&harrcir;"],[0,"&Uarrocir;"],[0,"&lurdshar;"],[0,"&ldrushar;"],[2,"&LeftRightVector;"],[0,"&RightUpDownVector;"],[0,"&DownLeftRightVector;"],[0,"&LeftUpDownVector;"],[0,"&LeftVectorBar;"],[0,"&RightVectorBar;"],[0,"&RightUpVectorBar;"],[0,"&RightDownVectorBar;"],[0,"&DownLeftVectorBar;"],[0,"&DownRightVectorBar;"],[0,"&LeftUpVectorBar;"],[0,"&LeftDownVectorBar;"],[0,"&LeftTeeVector;"],[0,"&RightTeeVector;"],[0,"&RightUpTeeVector;"],[0,"&RightDownTeeVector;"],[0,"&DownLeftTeeVector;"],[0,"&DownRightTeeVector;"],[0,"&LeftUpTeeVector;"],[0,"&LeftDownTeeVector;"],[0,"&lHar;"],[0,"&uHar;"],[0,"&rHar;"],[0,"&dHar;"],[0,"&luruhar;"],[0,"&ldrdhar;"],[0,"&ruluhar;"],[0,"&rdldhar;"],[0,"&lharul;"],[0,"&llhard;"],[0,"&rharul;"],[0,"&lrhard;"],[0,"&udhar;"],[0,"&duhar;"],[0,"&RoundImplies;"],[0,"&erarr;"],[0,"&simrarr;"],[0,"&larrsim;"],[0,"&rarrsim;"],[0,"&rarrap;"],[0,"&ltlarr;"],[1,"&gtrarr;"],[0,"&subrarr;"],[1,"&suplarr;"],[0,"&lfisht;"],[0,"&rfisht;"],[0,"&ufisht;"],[0,"&dfisht;"],[5,"&lopar;"],[0,"&ropar;"],[4,"&lbrke;"],[0,"&rbrke;"],[0,"&lbrkslu;"],[0,"&rbrksld;"],[0,"&lbrksld;"],[0,"&rbrkslu;"],[0,"&langd;"],[0,"&rangd;"],[0,"&lparlt;"],[0,"&rpargt;"],[0,"&gtlPar;"],[0,"&ltrPar;"],[3,"&vzigzag;"],[1,"&vangrt;"],[0,"&angrtvbd;"],[6,"&ange;"],[0,"&range;"],[0,"&dwangle;"],[0,"&uwangle;"],[0,"&angmsdaa;"],[0,"&angmsdab;"],[0,"&angmsdac;"],[0,"&angmsdad;"],[0,"&angmsdae;"],[0,"&angmsdaf;"],[0,"&angmsdag;"],[0,"&angmsdah;"],[0,"&bemptyv;"],[0,"&demptyv;"],[0,"&cemptyv;"],[0,"&raemptyv;"],[0,"&laemptyv;"],[0,"&ohbar;"],[0,"&omid;"],[0,"&opar;"],[1,"&operp;"],[1,"&olcross;"],[0,"&odsold;"],[1,"&olcir;"],[0,"&ofcir;"],[0,"&olt;"],[0,"&ogt;"],[0,"&cirscir;"],[0,"&cirE;"],[0,"&solb;"],[0,"&bsolb;"],[3,"&boxbox;"],[3,"&trisb;"],[0,"&rtriltri;"],[0,{v:"&LeftTriangleBar;",n:824,o:"&NotLeftTriangleBar;"}],[0,{v:"&RightTriangleBar;",n:824,o:"&NotRightTriangleBar;"}],[11,"&iinfin;"],[0,"&infintie;"],[0,"&nvinfin;"],[4,"&eparsl;"],[0,"&smeparsl;"],[0,"&eqvparsl;"],[5,"&blacklozenge;"],[8,"&RuleDelayed;"],[1,"&dsol;"],[9,"&bigodot;"],[0,"&bigoplus;"],[0,"&bigotimes;"],[1,"&biguplus;"],[1,"&bigsqcup;"],[5,"&iiiint;"],[0,"&fpartint;"],[2,"&cirfnint;"],[0,"&awint;"],[0,"&rppolint;"],[0,"&scpolint;"],[0,"&npolint;"],[0,"&pointint;"],[0,"&quatint;"],[0,"&intlarhk;"],[10,"&pluscir;"],[0,"&plusacir;"],[0,"&simplus;"],[0,"&plusdu;"],[0,"&plussim;"],[0,"&plustwo;"],[1,"&mcomma;"],[0,"&minusdu;"],[2,"&loplus;"],[0,"&roplus;"],[0,"&Cross;"],[0,"&timesd;"],[0,"&timesbar;"],[1,"&smashp;"],[0,"&lotimes;"],[0,"&rotimes;"],[0,"&otimesas;"],[0,"&Otimes;"],[0,"&odiv;"],[0,"&triplus;"],[0,"&triminus;"],[0,"&tritime;"],[0,"&intprod;"],[2,"&amalg;"],[0,"&capdot;"],[1,"&ncup;"],[0,"&ncap;"],[0,"&capand;"],[0,"&cupor;"],[0,"&cupcap;"],[0,"&capcup;"],[0,"&cupbrcap;"],[0,"&capbrcup;"],[0,"&cupcup;"],[0,"&capcap;"],[0,"&ccups;"],[0,"&ccaps;"],[2,"&ccupssm;"],[2,"&And;"],[0,"&Or;"],[0,"&andand;"],[0,"&oror;"],[0,"&orslope;"],[0,"&andslope;"],[1,"&andv;"],[0,"&orv;"],[0,"&andd;"],[0,"&ord;"],[1,"&wedbar;"],[6,"&sdote;"],[3,"&simdot;"],[2,{v:"&congdot;",n:824,o:"&ncongdot;"}],[0,"&easter;"],[0,"&apacir;"],[0,{v:"&apE;",n:824,o:"&napE;"}],[0,"&eplus;"],[0,"&pluse;"],[0,"&Esim;"],[0,"&Colone;"],[0,"&Equal;"],[1,"&ddotseq;"],[0,"&equivDD;"],[0,"&ltcir;"],[0,"&gtcir;"],[0,"&ltquest;"],[0,"&gtquest;"],[0,{v:"&leqslant;",n:824,o:"&nleqslant;"}],[0,{v:"&geqslant;",n:824,o:"&ngeqslant;"}],[0,"&lesdot;"],[0,"&gesdot;"],[0,"&lesdoto;"],[0,"&gesdoto;"],[0,"&lesdotor;"],[0,"&gesdotol;"],[0,"&lap;"],[0,"&gap;"],[0,"&lne;"],[0,"&gne;"],[0,"&lnap;"],[0,"&gnap;"],[0,"&lEg;"],[0,"&gEl;"],[0,"&lsime;"],[0,"&gsime;"],[0,"&lsimg;"],[0,"&gsiml;"],[0,"&lgE;"],[0,"&glE;"],[0,"&lesges;"],[0,"&gesles;"],[0,"&els;"],[0,"&egs;"],[0,"&elsdot;"],[0,"&egsdot;"],[0,"&el;"],[0,"&eg;"],[2,"&siml;"],[0,"&simg;"],[0,"&simlE;"],[0,"&simgE;"],[0,{v:"&LessLess;",n:824,o:"&NotNestedLessLess;"}],[0,{v:"&GreaterGreater;",n:824,o:"&NotNestedGreaterGreater;"}],[1,"&glj;"],[0,"&gla;"],[0,"&ltcc;"],[0,"&gtcc;"],[0,"&lescc;"],[0,"&gescc;"],[0,"&smt;"],[0,"&lat;"],[0,{v:"&smte;",n:65024,o:"&smtes;"}],[0,{v:"&late;",n:65024,o:"&lates;"}],[0,"&bumpE;"],[0,{v:"&PrecedesEqual;",n:824,o:"&NotPrecedesEqual;"}],[0,{v:"&sce;",n:824,o:"&NotSucceedsEqual;"}],[2,"&prE;"],[0,"&scE;"],[0,"&precneqq;"],[0,"&scnE;"],[0,"&prap;"],[0,"&scap;"],[0,"&precnapprox;"],[0,"&scnap;"],[0,"&Pr;"],[0,"&Sc;"],[0,"&subdot;"],[0,"&supdot;"],[0,"&subplus;"],[0,"&supplus;"],[0,"&submult;"],[0,"&supmult;"],[0,"&subedot;"],[0,"&supedot;"],[0,{v:"&subE;",n:824,o:"&nsubE;"}],[0,{v:"&supE;",n:824,o:"&nsupE;"}],[0,"&subsim;"],[0,"&supsim;"],[2,{v:"&subnE;",n:65024,o:"&varsubsetneqq;"}],[0,{v:"&supnE;",n:65024,o:"&varsupsetneqq;"}],[2,"&csub;"],[0,"&csup;"],[0,"&csube;"],[0,"&csupe;"],[0,"&subsup;"],[0,"&supsub;"],[0,"&subsub;"],[0,"&supsup;"],[0,"&suphsub;"],[0,"&supdsub;"],[0,"&forkv;"],[0,"&topfork;"],[0,"&mlcp;"],[8,"&Dashv;"],[1,"&Vdashl;"],[0,"&Barv;"],[0,"&vBar;"],[0,"&vBarv;"],[1,"&Vbar;"],[0,"&Not;"],[0,"&bNot;"],[0,"&rnmid;"],[0,"&cirmid;"],[0,"&midcir;"],[0,"&topcir;"],[0,"&nhpar;"],[0,"&parsim;"],[9,{v:"&parsl;",n:8421,o:"&nparsl;"}],[44343,{n:new Map(pt([[56476,"&Ascr;"],[1,"&Cscr;"],[0,"&Dscr;"],[2,"&Gscr;"],[2,"&Jscr;"],[0,"&Kscr;"],[2,"&Nscr;"],[0,"&Oscr;"],[0,"&Pscr;"],[0,"&Qscr;"],[1,"&Sscr;"],[0,"&Tscr;"],[0,"&Uscr;"],[0,"&Vscr;"],[0,"&Wscr;"],[0,"&Xscr;"],[0,"&Yscr;"],[0,"&Zscr;"],[0,"&ascr;"],[0,"&bscr;"],[0,"&cscr;"],[0,"&dscr;"],[1,"&fscr;"],[1,"&hscr;"],[0,"&iscr;"],[0,"&jscr;"],[0,"&kscr;"],[0,"&lscr;"],[0,"&mscr;"],[0,"&nscr;"],[1,"&pscr;"],[0,"&qscr;"],[0,"&rscr;"],[0,"&sscr;"],[0,"&tscr;"],[0,"&uscr;"],[0,"&vscr;"],[0,"&wscr;"],[0,"&xscr;"],[0,"&yscr;"],[0,"&zscr;"],[52,"&Afr;"],[0,"&Bfr;"],[1,"&Dfr;"],[0,"&Efr;"],[0,"&Ffr;"],[0,"&Gfr;"],[2,"&Jfr;"],[0,"&Kfr;"],[0,"&Lfr;"],[0,"&Mfr;"],[0,"&Nfr;"],[0,"&Ofr;"],[0,"&Pfr;"],[0,"&Qfr;"],[1,"&Sfr;"],[0,"&Tfr;"],[0,"&Ufr;"],[0,"&Vfr;"],[0,"&Wfr;"],[0,"&Xfr;"],[0,"&Yfr;"],[1,"&afr;"],[0,"&bfr;"],[0,"&cfr;"],[0,"&dfr;"],[0,"&efr;"],[0,"&ffr;"],[0,"&gfr;"],[0,"&hfr;"],[0,"&ifr;"],[0,"&jfr;"],[0,"&kfr;"],[0,"&lfr;"],[0,"&mfr;"],[0,"&nfr;"],[0,"&ofr;"],[0,"&pfr;"],[0,"&qfr;"],[0,"&rfr;"],[0,"&sfr;"],[0,"&tfr;"],[0,"&ufr;"],[0,"&vfr;"],[0,"&wfr;"],[0,"&xfr;"],[0,"&yfr;"],[0,"&zfr;"],[0,"&Aopf;"],[0,"&Bopf;"],[1,"&Dopf;"],[0,"&Eopf;"],[0,"&Fopf;"],[0,"&Gopf;"],[1,"&Iopf;"],[0,"&Jopf;"],[0,"&Kopf;"],[0,"&Lopf;"],[0,"&Mopf;"],[1,"&Oopf;"],[3,"&Sopf;"],[0,"&Topf;"],[0,"&Uopf;"],[0,"&Vopf;"],[0,"&Wopf;"],[0,"&Xopf;"],[0,"&Yopf;"],[1,"&aopf;"],[0,"&bopf;"],[0,"&copf;"],[0,"&dopf;"],[0,"&eopf;"],[0,"&fopf;"],[0,"&gopf;"],[0,"&hopf;"],[0,"&iopf;"],[0,"&jopf;"],[0,"&kopf;"],[0,"&lopf;"],[0,"&mopf;"],[0,"&nopf;"],[0,"&oopf;"],[0,"&popf;"],[0,"&qopf;"],[0,"&ropf;"],[0,"&sopf;"],[0,"&topf;"],[0,"&uopf;"],[0,"&vopf;"],[0,"&wopf;"],[0,"&xopf;"],[0,"&yopf;"],[0,"&zopf;"]]))}],[8906,"&fflig;"],[0,"&filig;"],[0,"&fllig;"],[0,"&ffilig;"],[0,"&ffllig;"]]));const ft=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]);function gt(t,e){return function(n){let i,r=0,s="";for(;i=t.exec(n);)r!==i.index&&(s+=n.substring(r,i.index)),s+=e.get(i[0].charCodeAt(0)),r=i.index+1;return s+n.substring(r)}}var mt,vt;function bt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}String.prototype.codePointAt,gt(/["&'<>]/g,ft),gt(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),gt(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]])),function(t){t[t.XML=0]="XML",t[t.HTML=1]="HTML"}(mt||(mt={})),function(t){t[t.UTF8=0]="UTF8",t[t.ASCII=1]="ASCII",t[t.Extensive=2]="Extensive",t[t.Attribute=3]="Attribute",t[t.Text=4]="Text"}(vt||(vt={}));var yt={includeSpaces:!1,renderedCss:!1,validTypes:["longtextV2","plaintext"]};function _t(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];yt.includeSpaces=Boolean(e),yt.renderedCss||((t=document.createElement("style")).textContent="\n/* Learnosity essay limit by character styles */\n.lrn_widget .lrn_word_count,\n.lrn_widget .lrn_character_count {\n    margin-right: 0px;\n}\n",document.head.append(t),yt.renderedCss=!0),function(){for(var t=A.appInstance().getQuestions(),e=function(){var t,e,r=(t=i[n],e=2,function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=s.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return bt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=(r[0],r[1]);if(yt.validTypes.indexOf(s.type)>=0){var a=A.appInstance().question(s.response_id);A.appInstance().question(s.response_id).on("rendered",(function(){!function(t){var e;if(!(null===(e=x.activity())||void 0===e||null===(e=e.config)||void 0===e||null===(e=e.questions_api_init_options)||void 0===e||null===(e=e.labelBundle)||void 0===e?void 0:e.wordLength)){var n=t.getQuestion().response_id,i=document.getElementById(n).querySelector(".lrn_word_limit"),r=i.textContent.replace("Word","Character");i.textContent=r}}(a),x.isResuming()&&wt(a)})),a.on("changed",(function(){wt(a)}))}},n=0,i=Object.entries(t);n<i.length;n++)e()}(),A.appInstance().on("item:load",(function(t){!function(){var t,e,n,i=document.querySelector(".test-submit.item-next"),r=document.querySelector(".custom_btn.item-next");r&&!I.isResponsiveMode()&&(O.isLastItem()?(e=document.querySelector(".review-screen"),n=null===(t=x.activity())||void 0===t||null===(t=t.config)||void 0===t||null===(t=t.configuration)||void 0===t?void 0:t.decouple_submit_from_review,e&&!n&&x.region()?r.classList.add("hidden"):(i.classList.add("hidden"),r.classList.remove("hidden"))):r.classList.add("hidden"))}()}));var n=document.querySelector(".custom_btn.item-next");n?(n.classList.add("lrn_btn_blue"),function(){var t=document.querySelector(".custom_btn.item-next");t&&(t.addEventListener("click",At),A.appInstance().on("test:panel:shown",(function(t){var e=document.querySelector(".panel-footer .test-submit");e&&e.addEventListener("click",At)})))}()):M.A.error("No custom submit button found. Character length validation will occur, but no submission prevention.")}function wt(t){var e,n,i,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=t.getQuestion().type,a=t.getQuestion().max_length,o=null!==(e=t.getResponse())&&void 0!==e&&e.value?null===(n=t.getResponse())||void 0===n?void 0:n.value:"",l=!0;return i="plaintext"===s?(yt.includeSpaces?o:Et(o)).length:function(t,e=at.Legacy){return ut(t,e)}(yt.includeSpaces?xt(o):Et(xt(o))).length,a&&i>a&&(l=!1),r&&function(t,e,n){var i=t.getQuestion().response_id,r=document.getElementById(i),s=r.querySelector(".lrn_texteditor_editable"),a=r.querySelector(".lrn_word_count"),o=r.querySelector(".lrn_length_indicator"),l="lrn_wordcount_warning_label",c="lrn_wordcount_warning",d=n;function h(){a.textContent=d,e?(s.classList.remove(c),o.classList.remove(l)):(s.classList.add(c),o.classList.add(l))}"plaintext"===t.getQuestion().type?(d=n+" /",setTimeout((function(){h()}),10)):h()}(t,l,i),l}function At(t){var e=A.appInstance().getQuestions(),n=[];for(var i in e){var r;yt.validTypes.includes(e[i].type)&&(null!==(r=e[i])&&void 0!==r&&r.submit_over_limit||wt(k.questionInstance(i),!1)||n.push(i))}if(n.length){M.A.warn("Invalid essay response length found."),t.preventDefault(),t.stopPropagation();for(var s=[],a=0;a<n.length;a++){var o=O.itemByResponseId(n[a]);o&&s.push(o.source.reference)}!function(t){for(var e,n,i,r,s={question:(null===(e=x.activity())||void 0===e||null===(e=e.config)||void 0===e||null===(e=e.labelBundle)||void 0===e?void 0:e.question)||"Question",submitTest:(null===(n=x.activity())||void 0===n||null===(n=n.config)||void 0===n||null===(n=n.labelBundle)||void 0===n?void 0:n.submitTest)||"Submit activity",decline:(null===(i=x.activity())||void 0===i||null===(i=i.config)||void 0===i||null===(i=i.labelBundle)||void 0===i?void 0:i.decline)||"Cancel",invalidQuestionsMessage:(null===(r=x.activity())||void 0===r||null===(r=r.config)||void 0===r||null===(r=r.labelBundle)||void 0===r?void 0:r.invalidQuestionsMessage)||"The following questions are not currently valid. Please follow the links to review"},a="\n        <p>".concat(s.invalidQuestionsMessage,"</p>\n        <ul>\n    "),o=0;o<t.length;o++)a+='<li class="link essay-limit-character-item" data-item-reference="'.concat(t[o],'">').concat(s.question,"</li>");a+="</ul>",A.assessApp().on("button:btn_essay_character_limit_cancel:clicked",(function(){I.hideDialog()})),A.appInstance().on("test:panel:show",(function(){setTimeout((function(){var t=document.querySelectorAll(".essay-limit-character-item");t&&t.forEach((function(t){var e=t.getAttribute("data-item-reference");t.addEventListener("click",(function(){A.appInstance().items().goto(e),I.hideDialog()}))}))}),500)})),I.dialog({header:s.submitTest,body:a,buttons:[{button_id:"btn_essay_character_limit_cancel",label:s.decline,is_primary:!0}]})}(s)}else!function(){var t=document.getElementById("lrn_assess_next_btn");if(t)t.click();else{var e={show_submit_confirmation:!0,show_submit_ui:!0,success:function(t){M.A.info("Submit was successful",t)},error:function(t){M.A.error("Submit has failed",t)}};A.appInstance().submit(e)}}()}function xt(t){return t.replace(/<[^>]*>/g,"").trim()}function Et(t){return t.replace(/\s+/g,"")}var St=n(7391),Tt=n.n(St);var Ct=Math.floor,kt=Math.random;const Mt=function(t,e){var n,i,r=-1,s=t.length,a=s-1;for(e=void 0===e?s:e;++r<e;){var o=(i=a,(n=r)+Ct(kt()*(i-n+1))),l=t[o];t[o]=t[r],t[r]=l}return t.length=e,t},It=function(t){return Mt(function(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}(t))},Lt=function(t,e){return function(t,e){for(var n=-1,i=null==t?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}(e,(function(e){return t[e]}))},Pt="object"==typeof global&&global&&global.Object===Object&&global;var Rt="object"==typeof self&&self&&self.Object===Object&&self;const Dt=Pt||Rt||Function("return this")(),Ft=Dt.Symbol;var Ot=Object.prototype,Nt=Ot.hasOwnProperty,Bt=Ot.toString,qt=Ft?Ft.toStringTag:void 0;var Ht=Object.prototype.toString;var jt=Ft?Ft.toStringTag:void 0;const zt=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":jt&&jt in Object(t)?function(t){var e=Nt.call(t,qt),n=t[qt];try{t[qt]=void 0;var i=!0}catch(t){}var r=Bt.call(t);return i&&(e?t[qt]=n:delete t[qt]),r}(t):function(t){return Ht.call(t)}(t)},Ut=function(t){return null!=t&&"object"==typeof t},Vt=function(t){return Ut(t)&&"[object Arguments]"==zt(t)};var Gt=Object.prototype,Wt=Gt.hasOwnProperty,$t=Gt.propertyIsEnumerable;const Xt=Vt(function(){return arguments}())?Vt:function(t){return Ut(t)&&Wt.call(t,"callee")&&!$t.call(t,"callee")},Kt=Array.isArray;var Yt="object"==typeof exports&&exports&&!exports.nodeType&&exports,Qt=Yt&&"object"==typeof module&&module&&!module.nodeType&&module,Jt=Qt&&Qt.exports===Yt?Dt.Buffer:void 0;const Zt=(Jt?Jt.isBuffer:void 0)||function(){return!1};var te=/^(?:0|[1-9]\d*)$/;const ee=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&te.test(t))&&t>-1&&t%1==0&&t<e},ne=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var ie={};ie["[object Float32Array]"]=ie["[object Float64Array]"]=ie["[object Int8Array]"]=ie["[object Int16Array]"]=ie["[object Int32Array]"]=ie["[object Uint8Array]"]=ie["[object Uint8ClampedArray]"]=ie["[object Uint16Array]"]=ie["[object Uint32Array]"]=!0,ie["[object Arguments]"]=ie["[object Array]"]=ie["[object ArrayBuffer]"]=ie["[object Boolean]"]=ie["[object DataView]"]=ie["[object Date]"]=ie["[object Error]"]=ie["[object Function]"]=ie["[object Map]"]=ie["[object Number]"]=ie["[object Object]"]=ie["[object RegExp]"]=ie["[object Set]"]=ie["[object String]"]=ie["[object WeakMap]"]=!1;var re="object"==typeof exports&&exports&&!exports.nodeType&&exports,se=re&&"object"==typeof module&&module&&!module.nodeType&&module,ae=se&&se.exports===re&&Pt.process,oe=function(){try{return se&&se.require&&se.require("util").types||ae&&ae.binding&&ae.binding("util")}catch(t){}}(),le=oe&&oe.isTypedArray;const ce=le?(de=le,function(t){return de(t)}):function(t){return Ut(t)&&ne(t.length)&&!!ie[zt(t)]};var de,he=Object.prototype.hasOwnProperty;const ue=function(t,e){var n=Kt(t),i=!n&&Xt(t),r=!n&&!i&&Zt(t),s=!n&&!i&&!r&&ce(t),a=n||i||r||s,o=a?function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}(t.length,String):[],l=o.length;for(var c in t)!e&&!he.call(t,c)||a&&("length"==c||r&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ee(c,l))||o.push(c);return o};var pe=Object.prototype;const fe=function(t,e){return function(n){return t(e(n))}}(Object.keys,Object);var ge=Object.prototype.hasOwnProperty;const me=function(t){if(n=(e=t)&&e.constructor,e!==("function"==typeof n&&n.prototype||pe))return fe(t);var e,n,i=[];for(var r in Object(t))ge.call(t,r)&&"constructor"!=r&&i.push(r);return i},ve=function(t){return null!=t&&ne(t.length)&&!function(t){if(!function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}(t))return!1;var e=zt(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}(t)},be=function(t){return null==t?[]:Lt(t,function(t){return ve(t)?ue(t):me(t)}(t))},ye=function(t){return Mt(be(t))},_e=function(t){return(Kt(t)?It:ye)(t)};function we(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ae(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ae(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){o=!0,s=t},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw s}}}}function Ae(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function xe(t){var e=t||1,n="LRN Hide Alternatives:";A.appInstance().on("item:load",(function(){var t=k.questions();Object.values(t).forEach((function(t){if("mcq"===t.type)if(function(t){return!t.multiple_responses||!1===t.multiple_responses}(t))if(function(t,e){return t.options.length-e>1}(t,e))if(function(t){return"validation"in t&&t.validation}(t))if(p=t.validation,Boolean(p.valid_response.value&&p.valid_response.value.length)){var i=[],r=function(t){return t.valid_response.value}(t.validation);Object.values(r).forEach((function(e){Object.values(t.options).forEach((function(t){e!==t.value&&i.push(t.value)}))}));for(var s=[],a=0;a<e;a++)s.push(Ee(i,t.response_id)[a]);for(var o=document.getElementById(t.response_id).getElementsByClassName("lrn_mcqgroup"),l=0;l<o[0].children.length;l++){var c,d=o[0].children[l].getElementsByClassName("lrn-input"),h=we(s);try{for(h.s();!(c=h.n()).done;){var u=c.value;d[0].getAttribute("value")===u&&(o[0].children[l].style.display="none")}}catch(t){h.e(t)}finally{h.f()}}}else console.info(n,"No correct answer found in validation object");else console.info(n," No validation object found");else console.info(n,"Invalid number of options to hide:",e);else console.info(n,"Only supports single response mode");var p}))}))}function Ee(t,e){var n=Tt()(e);return _e(t.map((function(t){return{value:t,sort:n()}}))).sort((function(t,e){return t.sort-e.sort})).map((function(t){return t.value}))}var Se=n(6254),Te=n(6411),Ce={supportedPlatforms:["chromeos","macos","windows"]};function ke(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{global:[{bindings:{chromeos:["ctrl+shift+v"],macos:["command+shift+v"],windows:["ctrl+shift+v"]},type:"item.flag"},{bindings:{chromeos:["ctrl+alt+0"],macos:["command+option+0"],windows:["ctrl+alt+0"]},type:"masking.enable"}],item:[{bindings:{chromeos:["ctrl+shift+1","ctrl+shift+2","ctrl+shift+3","ctrl+shift+4","ctrl+shift+5","ctrl+shift+6"],macos:["command+ctrl+1","command+ctrl+2","command+ctrl+3","command+ctrl+4","command+ctrl+5","command+ctrl+6"],windows:["ctrl+shift+1","ctrl+shift+2","ctrl+shift+3","ctrl+shift+4","ctrl+shift+5","ctrl+shift+6"]},restrictTo:["mcq"],type:"response.set"},{bindings:{chromeos:["ctrl+alt+1","ctrl+alt+2","ctrl+alt+3","ctrl+alt+4","ctrl+alt+5","ctrl+alt+6"],macos:["command+option+1","command+option+2","command+option+3","command+option+4","command+option+5","command+option+6"],windows:["ctrl+alt+1","ctrl+alt+2","ctrl+alt+3","ctrl+alt+4","ctrl+alt+5","ctrl+alt+6"]},type:"response.mask"}]},e=function(){var t;return Ce.supportedPlatforms.forEach((function(e){Se[e]&&(t=e)})),t}();Ce.bindings=t,e&&(Te.prototype.stopCallback=function(t,e,n){var i=document.activeElement;return"radio"!==i.getAttribute("type")&&"checkbox"!==i.getAttribute("type")&&!((" "+e.className+" ").indexOf(" mousetrap ")>-1)&&("INPUT"==e.tagName||"SELECT"==e.tagName||"TEXTAREA"==e.tagName||e.contentEditable&&"true"==e.contentEditable)},Ce.bindings.hasOwnProperty("global")&&Array.isArray(Ce.bindings.global)&&Ce.bindings.global.forEach((function(t){if(t.hasOwnProperty("type"))switch(t.type){case"item.flag":n=t.bindings[e],Te.bind(n,(function(t,e){O.flag()}));break;case"masking.enable":!function(t){k.questionInstance().isMaskable()&&Te.bind(t,(function(t){A.appInstance().questionsApp().masking(!O.isMaskingEnabled())}))}(t.bindings[e])}var n})),Ce.bindings.hasOwnProperty("item")&&Array.isArray(Ce.bindings.item)&&A.appInstance().on("item:load",(function(){Ce.bindings.item.forEach((function(t){if(t.hasOwnProperty("type"))switch(t.type){case"response.mask":n=t.bindings[e],i=k.questions(),r=0,i.forEach((function(t){"mcq"===t.type&&r++})),1===r&&Object.values(i).forEach((function(t){"mcq"===t.type&&Te.bind(n,(function(e,n){if(O.isMaskingEnabled()){var i,r=Number(n.at(-1));if((null===(i=t.options)||void 0===i?void 0:i.length)>=r){var s=O.itemElement().querySelectorAll(".lrn-mcq-option")[r-1].querySelector(".lrn-mask");s&&s.click()}}}))}));break;case"response.set":!function(t){var e=k.questions(),n=0;e.forEach((function(t){"mcq"===t.type&&n++})),1===n&&Object.values(e).forEach((function(e){"mcq"===e.type&&Te.bind(t,(function(t){var n;(null===(n=e.options)||void 0===n?void 0:n.length)>=t.key&&document.getElementById("".concat(e.response_id)).querySelectorAll(".lrn-input")[t.key-1].click()}))}))}(t.bindings[e])}var n,i,r}))})))}var Me="ERROR",Ie={_initialised:!1,magnifier:null};function Le(t){Ie._initialised?M.A.debug("Magnifier already initialised, ignoring run();",Me):(t||(t={zoom:4,shape:"square",width:350,height:350}),Ie.magnifier=new De(t),Ie._initialised=!0)}function Pe(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"lrn__magnifier";document.querySelectorAll(".".concat(e)).forEach((function(t){t.addEventListener("click",(function(){Ie.magnifier.toggle()}))})),A.appInstance().on("item:load",void((t=O.itemElement().querySelectorAll("img"))&&t.forEach((function(t){t.addEventListener("click",(function(t){Ie.magnifier.isVisible()||Ie.magnifier.show(t)}))}))))}function Re(){Ie.magnifier.toggle()}function De(t){var e=this;e.options=Object.assign({zoom:2,shape:"square",width:200,height:200},t),window.MutationObserver||window.WebKitMutationObserver;var n,i,r,s,a,o,l=!1,c={};function d(t,e,n){t.style.left="".concat(e,"px"),t.style.top="".concat(n,"px")}function h(t,e,n){t.style.width="".concat(e,"px"),t.style.height="".concat(n,"px")}function u(){switch(e.options.shape){case"square":h(n,e.options.width,e.options.height);break;case"circle":h(n,e.options.width,e.options.height),n.style.borderRadius="50%"}i.style.WebkitTransform=i.style.MozTransform=i.style.OTransform=i.style.MsTransform=i.style.transform="scale(".concat(e.options.zoom,")")}function p(t,e){for(var n=e;null!=n;){if(n==t)return!0;n=n.parentNode}return!1}function f(){l&&(_(),b(),A())}function g(){l&&(window.clearTimeout(s),s=window.setTimeout(f,100))}function m(){l&&g()}function v(t,n){var i=c[t];if(i)for(var r=0;r<i.length;r++)i[r].call(e,n)}function b(){var t=n.offsetLeft,r=n.offsetTop,s=document.body.scrollLeft,o=document.body.scrollTop,l=-t*e.options.zoom-s*e.options.zoom,c=-r*e.options.zoom-o*e.options.zoom;d(i,l,c),v("viewPortChanged",a)}function y(t,e){var n=t.querySelectorAll(e);if(n.length>0)for(var i=0;i<n.length;i++)n[i].parentNode.removeChild(n[i])}function _(){i.innerHTML="";var t=document.body,e=t.cloneNode(!0),r=t.style.backgroundColor;r&&n.css("background-color",r),e.style.cursor="auto",e.style.paddingTop="0px",e.setAttribute("unselectable","on");var s=t.querySelectorAll("canvas"),o=e.querySelectorAll("canvas");if(s.length>0&&s.length===o.length)for(var l=0;l<s.length;l++)o[l].getContext("2d").drawImage(s[l],0,0);y(e,"script"),y(e,"audio"),y(e,"video"),y(e,".magnifier"),v("prepareContent",e),i.appendChild(e);var c=document.body.clientWidth,d=document.body.clientHeight;h(i,c,d),v("contentUpdated",a=i.querySelector("body"))}function w(t){var e=[];if(t.getAttribute){t.getAttribute("id")&&e.push("#"+t.getAttribute("id")),t.className&&e.push("."+t.className.split(" ").join("."));for(var n=0;n<e.length;n++){var i=a.querySelectorAll(e[n]);if(1==i.length)return i[0].scrollTop=t.scrollTop,i[0].scrollLeft=t.scrollLeft,!0}}else t==document&&b();return!1}function A(t){if(l){if(t&&t.target)w(t.target);else{for(var e=[],i=document.querySelectorAll("div"),r=0;r<i.length;r++)i[r].scrollTop>0&&e.push(i[r]);for(var s=0;s<e.length;s++)p(n,e[s])||w(e[s])}v("syncScrollBars",a)}}return document.addEventListener("keydown",(function(t){"Escape"===t.key&&e.isVisible()&&e.hide()})),e.setZoom=function(t){e.options.zoom=t,u()},e.setShape=function(t,n,i){e.options.shape=t,n&&(e.options.width=n),i&&(e.options.height=i),u()},e.setWidth=function(t){e.options.width=t,u()},e.setHeight=function(t){e.options.height=t,u()},e.getZoom=function(){return e.options.zoom},e.getShape=function(){return e.options.shape},e.getWidth=function(){return e.options.width},e.getHeight=function(){return e.options.height},e.isVisible=function(){return l},e.on=function(t,e){c[t]=c[t]||[],c[t].push(e)},e.syncScrollBars=function(t){A()},e.syncContent=function(t){g()},e.hide=function(t){r&&(r.disconnect(),r=null),document.removeEventListener&&(document.removeEventListener("DOMNodeInserted",m,!1),document.removeEventListener("DOMNodeRemoved",m,!1)),i.innerHTML="",n.style.display="none",l=!1},e.show=function(t){var e,i;t?(e=t.pageX-175,i=t.pageY-175):(e=200,i=200),u(),_(),d(n,e,i),n.style.display="",b(),A(),v("initScrollBars",a),l=!0},e.toggle=function(t){e.isVisible()?e.hide():e.show()},(o=document.createElement("div")).innerHTML='<div class="magnifier" style="display: none;position: fixed;overflow: hidden;background-color: white;border: 1px solid #555;border-radius: 4px;z-index:10000;">\n                                <div class="magnifier-content" style="top: 0px;left: 0px;margin-left: 0px;margin-top: 0px;overflow: visible;position: absolute;display: block;transform-origin: left top;-moz-transform-origin: left top;-ms-transform-origin: left top;-webkit-transform-origin: left top;-o-transform-origin: left top;user-select: none;-moz-user-select: none;-webkit-user-select: none;padding-top: 0px"></div>\n                                <div class="magnifier-glass" style="position: absolute;top: 0px;left: 0px;width: 100%;height: 100%;opacity: 0.0;-ms-filter: alpha(opacity=0);background-color: white;cursor: move;"></div>\n                            </div>',n=o.querySelector(".magnifier"),document.body.appendChild(n),i=n.querySelector(".magnifier-content"),window.addEventListener&&(window.addEventListener("resize",f,!1),window.addEventListener("scroll",A,!0)),function(t,e){var n,i,r,s,a=null,o=null;function l(o){var l=o.target||o.srcElement,c=l.parentNode;if(l&&-1==e.exclude.indexOf(l.tagName.toUpperCase())&&(!c||-1==e.exclude.indexOf(c.tagName.toUpperCase()))){a=t;var d=o.pageX||o.touches[0].pageX,h=o.pageY||o.touches[0].pageY;r=a.getBoundingClientRect().left-a.offsetLeft,s=a.getBoundingClientRect().top-a.offsetTop,i=d-(a.getBoundingClientRect().left+document.body.scrollLeft),n=h-(a.getBoundingClientRect().top+document.body.scrollTop),o.preventDefault()}}function c(t){if(null!==a){var o=t.pageX||t.touches[0].pageX,l=t.pageY||t.touches[0].pageY,c=o-i-r-document.body.scrollLeft,d=l-n-s-document.body.scrollTop;!function(t,e,n){t.style.left="".concat(e,"px"),t.style.top="".concat(n,"px")}(a,c,d),e.ondrag&&e.ondrag.call(t)}}function d(t){null!==a&&(a=null)}(e=e||{}).exclude=["INPUT","TEXTAREA","SELECT","A","BUTTON"],o=e.handler?t.querySelector(e.handler):t,t.style.cursor="move",o.addEventListener("mousedown",(function(t){l(t)})),window.addEventListener("mousemove",(function(t){c(t)})),window.addEventListener("mouseup",(function(t){d()})),o.addEventListener("touchstart",(function(t){l(t)})),window.addEventListener("touchmove",(function(t){c(t)})),window.addEventListener("touchend",(function(t){d()}))}(n,{ondrag:b}),e}function Fe(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Oe(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Oe(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){o=!0,s=t},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw s}}}}function Oe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var Ne={chosenMask:"upperAlpha",prefixMask:{lowerAlpha:97,upperAlpha:65,numeric:49},explicitPrefixes:[],renderedCss:!1,suffix:"."};function Be(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"upperAlpha",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".",i=arguments.length>2?arguments[2]:void 0;Ne.prefixMask.hasOwnProperty(e)&&(Ne.chosenMask=e),n&&"string"==typeof n&&(Ne.suffix=n),i&&Array.isArray(i)&&(Ne.explicitPrefixes=i),Ne.renderedCss||((t=document.createElement("style")).textContent="\n/* Learnosity MCQ label prefix styles */\n.lrn-prefix-label {\n    padding-right: 15px;\n    font-weight: 500;\n}\n@media (max-width: 750px) {\n    .lrn-prefix-label {\n        padding-right: 10px;\n    }\n}\n@media (max-width: 650px) {\n    .lrn-prefix-label {\n        padding-right: 5px;\n    }\n}\n",document.head.append(t),Ne.renderedCss=!0),A.appInstance().on("item:load",(function(){!function(t){var e=Ne.prefixMask[Ne.chosenMask],n=Ne.suffix;try{var i,r=Fe(t);try{for(r.s();!(i=r.n()).done;){var s,a,o=i.value;if("mcq"===o.type&&"block"!==(null==o||null===(s=o.ui_style)||void 0===s?void 0:s.type)&&"horizontal-input-bottom"!==(null==o||null===(a=o.ui_style)||void 0===a?void 0:a.type)){var l,c=o.response_id,d=document.getElementById(c).querySelectorAll(".lrn-mcq-option"),h=0,u=Fe(d);try{for(u.s();!(l=u.n()).done;){var p=l.value,f=p.querySelector(".lrn-possible-answer").children;if(!p.querySelector(".lrn-prefix-label")){var g;g=Array.isArray(Ne.explicitPrefixes)&&Ne.explicitPrefixes.length&&"string"==typeof Ne.explicitPrefixes[h]?Ne.explicitPrefixes[h]:String.fromCharCode(e+h);for(var m=0;m<f.length;m++){var v=document.createElement("span");v.classList.add("lrn-prefix-label"),v.append("".concat(g).concat(n)),f[m].prepend(v)}h++}}}catch(t){u.e(t)}finally{u.f()}}}}catch(t){r.e(t)}finally{r.f()}}catch(t){M.A.error(t)}}(k.questions())}))}function qe(){qe=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var s=e&&e.prototype instanceof v?e:v,a=Object.create(s.prototype),o=new I(i||[]);return r(a,"_invoke",{value:T(t,n,o)}),a}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var u="suspendedStart",p="suspendedYield",f="executing",g="completed",m={};function v(){}function b(){}function y(){}var _={};c(_,a,(function(){return this}));var w=Object.getPrototypeOf,A=w&&w(w(L([])));A&&A!==n&&i.call(A,a)&&(_=A);var x=y.prototype=v.prototype=Object.create(_);function E(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(r,s,a,o){var l=h(t[r],t,s);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==Ue(d)&&i.call(d,"__await")?e.resolve(d.__await).then((function(t){n("next",t,a,o)}),(function(t){n("throw",t,a,o)})):e.resolve(d).then((function(t){c.value=t,a(c)}),(function(t){return n("throw",t,a,o)}))}o(l.arg)}var s;r(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return s=s?s.then(r,r):r()}})}function T(e,n,i){var r=u;return function(s,a){if(r===f)throw Error("Generator is already running");if(r===g){if("throw"===s)throw a;return{value:t,done:!0}}for(i.method=s,i.arg=a;;){var o=i.delegate;if(o){var l=C(o,i);if(l){if(l===m)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===u)throw r=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=f;var c=h(e,n,i);if("normal"===c.type){if(r=i.done?g:p,c.arg===m)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=g,i.method="throw",i.arg=c.arg)}}}function C(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,C(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var s=h(r,e.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,m;var a=s.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function L(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}throw new TypeError(Ue(e)+" is not iterable")}return b.prototype=y,r(x,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:b,configurable:!0}),b.displayName=c(y,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,l,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),c(S.prototype,o,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,i,r,s){void 0===s&&(s=Promise);var a=new S(d(t,n,i,r),s);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),c(x,l,"Generator"),c(x,a,(function(){return this})),c(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=L,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(M),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return o.type="throw",o.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var s=this.tryEntries.length-1;s>=0;--s){var a=this.tryEntries[s],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=t,a.arg=e,s?(this.method="next",this.next=s.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;M(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:L(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),m}},e}function He(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function je(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?He(Object(n),!0).forEach((function(e){ze(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):He(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ze(t,e,n){return(e=function(t){var e=function(t){if("object"!=Ue(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ue(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ue(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ue(t){return Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ue(t)}function Ve(t,e,n,i,r,s,a){try{var o=t[s](a),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}function Ge(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var s=t.apply(e,n);function a(t){Ve(s,i,r,a,o,"next",t)}function o(t){Ve(s,i,r,a,o,"throw",t)}a(void 0)}))}}var We={options:{iconWrapper:"top-right-wrapper",interval:3e4,message:"Internet connection is currently down.",render:!0,uri:"https://questions.learnosity.com?latest-lts"},renderedCss:!1};function $e(t){var e;We.renderedCss||((e=document.createElement("style")).textContent="\n/* Learnosity render network status */\n.lt__networkStatus-indicator {\n    width: 24px;\n    text-align: center;\n    position: relative;\n    top: 9px;\n}\n",document.head.append(e),We.renderedCss=!0),function(t){t&&"object"===Ue(t)&&(We.options=je(je({},We.options),t))}(t),setInterval(Xe,We.options.interval)}function Xe(){return Ke.apply(this,arguments)}function Ke(){return(Ke=Ge(qe().mark((function t(){var e,n,i,r;return qe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ye();case 2:e=t.sent,n=document.querySelector(".lt__networkStatus-indicator"),Je(e),We.options.render&&(e?n&&n.remove():(i=document.querySelector(".".concat(We.options.iconWrapper)),r='<div class="lt__networkStatus-indicator pos-left" role="status" aria-live="polite" aria-atomic="true" aria-relevant="all">\n                <span title="'.concat(We.options.message,'" aria-hidden="true">\n                    <svg xmlns="http://www.w3.org/2000/svg" height="16px" viewBox="0 -960 960 960" width="16px" fill="#333333">\n                        <path d="M790-56 414-434q-47 11-87.5 33T254-346l-84-86q32-32 69-56t79-42l-90-90q-41 21-76.5 46.5T84-516L0-602q32-32 66.5-57.5T140-708l-84-84 56-56 736 736-58 56Zm-310-64q-42 0-71-29.5T380-220q0-42 29-71t71-29q42 0 71 29t29 71q0 41-29 70.5T480-120Zm236-238-29-29-29-29-144-144q81 8 151.5 41T790-432l-74 74Zm160-158q-77-77-178.5-120.5T480-680q-21 0-40.5 1.5T400-674L298-776q44-12 89.5-18t92.5-6q142 0 265 53t215 145l-84 86Z"/>\n                    </svg>\n                </span>\n                <span class="sr-only">').concat(We.options.message,"</span>\n            </div>"),i&&!n&&i.insertAdjacentHTML("afterbegin",r)));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ye(){return Qe.apply(this,arguments)}function Qe(){return(Qe=Ge(qe().mark((function t(){return qe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(We.options.uri,{method:"HEAD",mode:"no-cors",cache:"no-store"});case 3:return t.sent,t.abrupt("return",!0);case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}function Je(t){var e=new CustomEvent(t?"LTNetworkOnline":"LTNetworkOffline");document.dispatchEvent(e)}var Ze={color:"rgba(250, 170, 140, 0.5)",renderedCss:!1,zindex:99999};function tn(t,e){var n,i;if(t&&"string"==typeof t&&(Ze.color=t),e&&"number"==typeof e&&(Ze.zindex=e),!document.querySelector(".lrn__overlay")){var r=document.createElement("div");r.classList.add("lrn__overlay"),document.querySelector("body").append(r)}Ze.renderedCss||(n=document.createElement("style"),i="\n/* Learnosity page overlay styles */\n.lrn__overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: ".concat(Ze.color,";\n    z-index: ").concat(Ze.zindex,";\n    pointer-events: none;\n}\n"),n.textContent=i,document.head.append(n),Ze.renderedCss=!0)}function en(){var t=document.querySelector(".lrn__overlay");t&&t.remove()}var nn={d:(t,e)=>{for(var n in e)nn.o(e,n)&&!nn.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},rn=globalThis.pdfjsLib={};nn.d(rn,{AbortException:()=>Rn,AnnotationEditorLayer:()=>ha,AnnotationEditorParamsType:()=>hn,AnnotationEditorType:()=>dn,AnnotationEditorUIManager:()=>bi,AnnotationLayer:()=>Qs,AnnotationMode:()=>cn,ColorPicker:()=>oa,DOMSVGFactory:()=>ys,DrawLayer:()=>ua,FeatureTest:()=>Nn,GlobalWorkerOptions:()=>pr,ImageKind:()=>pn,InvalidPDFException:()=>Mn,MissingPDFException:()=>In,OPS:()=>gn,OutputScale:()=>ci,PDFDataRangeTransport:()=>is,PDFDateString:()=>ii,PDFWorker:()=>os,PasswordResponses:()=>mn,PermissionFlag:()=>un,PixelsPerInch:()=>Gn,RenderingCancelledException:()=>Xn,TextLayer:()=>$r,UnexpectedResponseException:()=>Ln,Util:()=>qn,VerbosityLevel:()=>fn,XfaLayer:()=>_s,build:()=>fs,createValidAbsoluteUrl:()=>En,fetchData:()=>Wn,getDocument:()=>ts,getFilenameFromUrl:()=>Qn,getPdfFilenameFromUrl:()=>Jn,getXfaPageViewport:()=>ri,isDataScheme:()=>Kn,isPdfFile:()=>Yn,noContextMenu:()=>ei,normalizeUnicode:()=>zn,setLayerDimensions:()=>li,shadow:()=>Sn,version:()=>ps});const sn=!("object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type),an=[1,0,0,1,0,0],on=[.001,0,0,.001,0,0],ln=1.35,cn={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},dn={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},hn={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},un={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},pn={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},fn={ERRORS:0,WARNINGS:1,INFOS:5},gn={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},mn={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let vn=fn.WARNINGS;function bn(t){Number.isInteger(t)&&(vn=t)}function yn(){return vn}function _n(t){vn>=fn.INFOS&&console.log(`Info: ${t}`)}function wn(t){vn>=fn.WARNINGS&&console.log(`Warning: ${t}`)}function An(t){throw new Error(t)}function xn(t,e){t||An(e)}function En(t,e=null,n=null){if(!t)return null;try{if(n&&"string"==typeof t){if(n.addDefaultProtocol&&t.startsWith("www.")){const e=t.match(/\./g);e?.length>=2&&(t=`http://${t}`)}if(n.tryConvertEncoding)try{t=decodeURIComponent(escape(t))}catch{}}const i=e?new URL(t,e):new URL(t);if(function(t){switch(t?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(i))return i}catch{}return null}function Sn(t,e,n,i=!1){return Object.defineProperty(t,e,{value:n,enumerable:!i,configurable:!0,writable:!1}),n}const Tn=function(){function t(t,e){this.message=t,this.name=e}return t.prototype=new Error,t.constructor=t,t}();class Cn extends Tn{constructor(t,e){super(t,"PasswordException"),this.code=e}}class kn extends Tn{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Mn extends Tn{constructor(t){super(t,"InvalidPDFException")}}class In extends Tn{constructor(t){super(t,"MissingPDFException")}}class Ln extends Tn{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class Pn extends Tn{constructor(t){super(t,"FormatError")}}class Rn extends Tn{constructor(t){super(t,"AbortException")}}function Dn(t){"object"==typeof t&&void 0!==t?.length||An("Invalid argument for bytesToString");const e=t.length,n=8192;if(e<n)return String.fromCharCode.apply(null,t);const i=[];for(let r=0;r<e;r+=n){const s=Math.min(r+n,e),a=t.subarray(r,s);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function Fn(t){"string"!=typeof t&&An("Invalid argument for stringToBytes");const e=t.length,n=new Uint8Array(e);for(let i=0;i<e;++i)n[i]=255&t.charCodeAt(i);return n}function On(t){const e=Object.create(null);for(const[n,i]of t)e[n]=i;return e}class Nn{static get isLittleEndian(){return Sn(this,"isLittleEndian",function(){const t=new Uint8Array(4);return t[0]=1,1===new Uint32Array(t.buffer,0,1)[0]}())}static get isEvalSupported(){return Sn(this,"isEvalSupported",function(){try{return new Function(""),!0}catch{return!1}}())}static get isOffscreenCanvasSupported(){return Sn(this,"isOffscreenCanvasSupported","undefined"!=typeof OffscreenCanvas)}static get platform(){return"undefined"!=typeof navigator&&"string"==typeof navigator?.platform?Sn(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:"string"==typeof navigator?.userAgent&&navigator.userAgent.includes("Firefox")}):Sn(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return Sn(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Bn=Array.from(Array(256).keys(),(t=>t.toString(16).padStart(2,"0")));class qn{static makeHexColor(t,e,n){return`#${Bn[t]}${Bn[e]}${Bn[n]}`}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){return[t[0]*e[0]+t[1]*e[2]+e[4],t[0]*e[1]+t[1]*e[3]+e[5]]}static applyInverseTransform(t,e){const n=e[0]*e[3]-e[1]*e[2];return[(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/n,(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/n]}static getAxialAlignedBoundingBox(t,e){const n=this.applyTransform(t,e),i=this.applyTransform(t.slice(2,4),e),r=this.applyTransform([t[0],t[3]],e),s=this.applyTransform([t[2],t[1]],e);return[Math.min(n[0],i[0],r[0],s[0]),Math.min(n[1],i[1],r[1],s[1]),Math.max(n[0],i[0],r[0],s[0]),Math.max(n[1],i[1],r[1],s[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],n=t[0]*e[0]+t[1]*e[2],i=t[0]*e[1]+t[1]*e[3],r=t[2]*e[0]+t[3]*e[2],s=t[2]*e[1]+t[3]*e[3],a=(n+s)/2,o=Math.sqrt((n+s)**2-4*(n*s-r*i))/2,l=a+o||1,c=a-o||1;return[Math.sqrt(l),Math.sqrt(c)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),i=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>i)return null;const r=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),s=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return r>s?null:[n,r,i,s]}static#t(t,e,n,i,r,s,a,o,l,c){if(l<=0||l>=1)return;const d=1-l,h=l*l,u=h*l,p=d*(d*(d*t+3*l*e)+3*h*n)+u*i,f=d*(d*(d*r+3*l*s)+3*h*a)+u*o;c[0]=Math.min(c[0],p),c[1]=Math.min(c[1],f),c[2]=Math.max(c[2],p),c[3]=Math.max(c[3],f)}static#e(t,e,n,i,r,s,a,o,l,c,d,h){if(Math.abs(l)<1e-12)return void(Math.abs(c)>=1e-12&&this.#t(t,e,n,i,r,s,a,o,-d/c,h));const u=c**2-4*d*l;if(u<0)return;const p=Math.sqrt(u),f=2*l;this.#t(t,e,n,i,r,s,a,o,(-c+p)/f,h),this.#t(t,e,n,i,r,s,a,o,(-c-p)/f,h)}static bezierBoundingBox(t,e,n,i,r,s,a,o,l){return l?(l[0]=Math.min(l[0],t,a),l[1]=Math.min(l[1],e,o),l[2]=Math.max(l[2],t,a),l[3]=Math.max(l[3],e,o)):l=[Math.min(t,a),Math.min(e,o),Math.max(t,a),Math.max(e,o)],this.#e(t,n,r,a,e,i,s,o,3*(3*(n-r)-t+a),6*(t-2*n+r),3*(n-t),l),this.#e(t,n,r,a,e,i,s,o,3*(3*(i-s)-e+o),6*(e-2*i+s),3*(i-e),l),l}}let Hn=null,jn=null;function zn(t){return Hn||(Hn=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,jn=new Map([["ﬅ","ſt"]])),t.replaceAll(Hn,((t,e,n)=>e?e.normalize("NFKC"):jn.get(n)))}const Un="pdfjs_internal_id_",Vn="http://www.w3.org/2000/svg";class Gn{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Wn(t,e="text"){if(ti(t,document.baseURI)){const n=await fetch(t);if(!n.ok)throw new Error(n.statusText);switch(e){case"arraybuffer":return n.arrayBuffer();case"blob":return n.blob();case"json":return n.json()}return n.text()}return new Promise(((n,i)=>{const r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE)if(200!==r.status&&0!==r.status)i(new Error(r.statusText));else{switch(e){case"arraybuffer":case"blob":case"json":return void n(r.response)}n(r.responseText)}},r.send(null)}))}class $n{constructor({viewBox:t,scale:e,rotation:n,offsetX:i=0,offsetY:r=0,dontFlip:s=!1}){this.viewBox=t,this.scale=e,this.rotation=n,this.offsetX=i,this.offsetY=r;const a=(t[2]+t[0])/2,o=(t[3]+t[1])/2;let l,c,d,h,u,p,f,g;switch((n%=360)<0&&(n+=360),n){case 180:l=-1,c=0,d=0,h=1;break;case 90:l=0,c=1,d=1,h=0;break;case 270:l=0,c=-1,d=-1,h=0;break;case 0:l=1,c=0,d=0,h=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}s&&(d=-d,h=-h),0===l?(u=Math.abs(o-t[1])*e+i,p=Math.abs(a-t[0])*e+r,f=(t[3]-t[1])*e,g=(t[2]-t[0])*e):(u=Math.abs(a-t[0])*e+i,p=Math.abs(o-t[1])*e+r,f=(t[2]-t[0])*e,g=(t[3]-t[1])*e),this.transform=[l*e,c*e,d*e,h*e,u-l*e*a-d*e*o,p-c*e*a-h*e*o],this.width=f,this.height=g}get rawDims(){const{viewBox:t}=this;return Sn(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new $n({viewBox:this.viewBox.slice(),scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:r})}convertToViewportPoint(t,e){return qn.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=qn.applyTransform([t[0],t[1]],this.transform),n=qn.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){return qn.applyInverseTransform([t,e],this.transform)}}class Xn extends Tn{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function Kn(t){const e=t.length;let n=0;for(;n<e&&""===t[n].trim();)n++;return"data:"===t.substring(n,n+5).toLowerCase()}function Yn(t){return"string"==typeof t&&/\.pdf$/i.test(t)}function Qn(t){return[t]=t.split(/[#?]/,1),t.substring(t.lastIndexOf("/")+1)}function Jn(t,e="document.pdf"){if("string"!=typeof t)return e;if(Kn(t))return wn('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(t);let r=n.exec(i[1])||n.exec(i[2])||n.exec(i[3]);if(r&&(r=r[0],r.includes("%")))try{r=n.exec(decodeURIComponent(r))[0]}catch{}return r||e}class Zn{started=Object.create(null);times=[];time(t){t in this.started&&wn(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||wn(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:t}of this.times)e=Math.max(t.length,e);for(const{name:n,start:i,end:r}of this.times)t.push(`${n.padEnd(e)} ${r-i}ms\n`);return t.join("")}}function ti(t,e){try{const{protocol:n}=e?new URL(t,e):new URL(t);return"http:"===n||"https:"===n}catch{return!1}}function ei(t){t.preventDefault()}function ni(t){console.log("Deprecated API usage: "+t)}class ii{static#n;static toDateObject(t){if(!t||"string"!=typeof t)return null;this.#n||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#n.exec(t);if(!e)return null;const n=parseInt(e[1],10);let i=parseInt(e[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(e[3],10);r=r>=1&&r<=31?r:1;let s=parseInt(e[4],10);s=s>=0&&s<=23?s:0;let a=parseInt(e[5],10);a=a>=0&&a<=59?a:0;let o=parseInt(e[6],10);o=o>=0&&o<=59?o:0;const l=e[7]||"Z";let c=parseInt(e[8],10);c=c>=0&&c<=23?c:0;let d=parseInt(e[9],10)||0;return d=d>=0&&d<=59?d:0,"-"===l?(s+=c,a+=d):"+"===l&&(s-=c,a-=d),new Date(Date.UTC(n,i,r,s,a,o))}}function ri(t,{scale:e=1,rotation:n=0}){const{width:i,height:r}=t.attributes.style,s=[0,0,parseInt(i),parseInt(r)];return new $n({viewBox:s,scale:e,rotation:n})}function si(t){if(t.startsWith("#")){const e=parseInt(t.slice(1),16);return[(16711680&e)>>16,(65280&e)>>8,255&e]}return t.startsWith("rgb(")?t.slice(4,-1).split(",").map((t=>parseInt(t))):t.startsWith("rgba(")?t.slice(5,-1).split(",").map((t=>parseInt(t))).slice(0,3):(wn(`Not a valid color format: "${t}"`),[0,0,0])}function ai(t){const{a:e,b:n,c:i,d:r,e:s,f:a}=t.getTransform();return[e,n,i,r,s,a]}function oi(t){const{a:e,b:n,c:i,d:r,e:s,f:a}=t.getTransform().invertSelf();return[e,n,i,r,s,a]}function li(t,e,n=!1,i=!0){if(e instanceof $n){const{pageWidth:i,pageHeight:r}=e.rawDims,{style:s}=t,a=Nn.isCSSRoundSupported,o=`var(--scale-factor) * ${i}px`,l=`var(--scale-factor) * ${r}px`,c=a?`round(down, ${o}, var(--scale-round-x, 1px))`:`calc(${o})`,d=a?`round(down, ${l}, var(--scale-round-y, 1px))`:`calc(${l})`;n&&e.rotation%180!=0?(s.width=d,s.height=c):(s.width=c,s.height=d)}i&&t.setAttribute("data-main-rotation",e.rotation)}class ci{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return 1!==this.sx||1!==this.sy}get symmetric(){return this.sx===this.sy}}class di{#i=null;#r=null;#s;#a=null;#o=null;static#l=null;constructor(t){this.#s=t,di.#l||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){const t=this.#i=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#s._uiManager._signal;t.addEventListener("contextmenu",ei,{signal:e}),t.addEventListener("pointerdown",di.#c,{signal:e});const n=this.#a=document.createElement("div");n.className="buttons",t.append(n);const i=this.#s.toolbarPosition;if(i){const{style:e}=t,n="ltr"===this.#s._uiManager.direction?1-i[0]:i[0];e.insetInlineEnd=100*n+"%",e.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return this.#d(),t}get div(){return this.#i}static#c(t){t.stopPropagation()}#h(t){this.#s._focusEventsAllowed=!1,t.preventDefault(),t.stopPropagation()}#u(t){this.#s._focusEventsAllowed=!0,t.preventDefault(),t.stopPropagation()}#p(t){const e=this.#s._uiManager._signal;t.addEventListener("focusin",this.#h.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",ei,{signal:e})}hide(){this.#i.classList.add("hidden"),this.#r?.hideDropdown()}show(){this.#i.classList.remove("hidden"),this.#o?.shown()}#d(){const{editorType:t,_uiManager:e}=this.#s,n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",di.#l[t]),this.#p(n),n.addEventListener("click",(t=>{e.delete()}),{signal:e._signal}),this.#a.append(n)}get#f(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#p(e),this.#a.prepend(e,this.#f),this.#o=t}addColorPicker(t){this.#r=t;const e=t.renderButton();this.#p(e),this.#a.prepend(e,this.#f)}remove(){this.#i.remove(),this.#r?.destroy(),this.#r=null}}class hi{#a=null;#i=null;#g;constructor(t){this.#g=t}#m(){const t=this.#i=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",ei,{signal:this.#g._signal});const e=this.#a=document.createElement("div");return e.className="buttons",t.append(e),this.#v(),t}#b(t,e){let n=0,i=0;for(const r of t){const t=r.y+r.height;if(t<n)continue;const s=r.x+(e?r.width:0);t>n?(i=s,n=t):e?s>i&&(i=s):s<i&&(i=s)}return[e?1-i:i,n]}show(t,e,n){const[i,r]=this.#b(e,n),{style:s}=this.#i||=this.#m();t.append(this.#i),s.insetInlineEnd=100*i+"%",s.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){this.#i.remove()}#v(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=this.#g._signal;t.addEventListener("contextmenu",ei,{signal:n}),t.addEventListener("click",(()=>{this.#g.highlightSelection("floating_button")}),{signal:n}),this.#a.append(t)}}function ui(t,e,n){for(const i of n)e.addEventListener(i,t[i].bind(t))}class pi{#y=0;get id(){return"pdfjs_internal_editor_"+this.#y++}}class fi{#_=function(){if("undefined"!=typeof crypto&&"function"==typeof crypto?.randomUUID)return crypto.randomUUID();const t=new Uint8Array(32);if("undefined"!=typeof crypto&&"function"==typeof crypto?.getRandomValues)crypto.getRandomValues(t);else for(let e=0;e<32;e++)t[e]=Math.floor(255*Math.random());return Dn(t)}();#y=0;#w=null;static get _isSVGFittingCanvas(){const t=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),e=new Image;return e.src='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Sn(this,"_isSVGFittingCanvas",e.decode().then((()=>(t.drawImage(e,0,0,1,1,0,0,1,3),0===new Uint32Array(t.getImageData(0,0,1,1).data.buffer)[0]))))}async#A(t,e){this.#w||=new Map;let n=this.#w.get(t);if(null===n)return null;if(n?.bitmap)return n.refCounter+=1,n;try{let t;if(n||={bitmap:null,id:`image_${this.#_}_${this.#y++}`,refCounter:0,isSvg:!1},"string"==typeof e?(n.url=e,t=await Wn(e,"blob")):e instanceof File?t=n.file=e:e instanceof Blob&&(t=e),"image/svg+xml"===t.type){const e=fi._isSVGFittingCanvas,i=new FileReader,r=new Image,s=new Promise(((t,s)=>{r.onload=()=>{n.bitmap=r,n.isSvg=!0,t()},i.onload=async()=>{const t=n.svgUrl=i.result;r.src=await e?`${t}#svgView(preserveAspectRatio(none))`:t},r.onerror=i.onerror=s}));i.readAsDataURL(t),await s}else n.bitmap=await createImageBitmap(t);n.refCounter=1}catch(t){console.error(t),n=null}return this.#w.set(t,n),n&&this.#w.set(n.id,n),n}async getFromFile(t){const{lastModified:e,name:n,size:i,type:r}=t;return this.#A(`${e}_${n}_${i}_${r}`,t)}async getFromUrl(t){return this.#A(t,t)}async getFromBlob(t,e){const n=await e;return this.#A(t,n)}async getFromId(t){this.#w||=new Map;const e=this.#w.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:t}=e;return delete e.blobPromise,this.getFromBlob(e.id,t)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#w||=new Map;let n=this.#w.get(t);if(n?.bitmap)return n.refCounter+=1,n;const i=new OffscreenCanvas(e.width,e.height);return i.getContext("2d").drawImage(e,0,0),n={bitmap:i.transferToImageBitmap(),id:`image_${this.#_}_${this.#y++}`,refCounter:1,isSvg:!1},this.#w.set(t,n),this.#w.set(n.id,n),n}getSvgUrl(t){const e=this.#w.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#w||=new Map;const e=this.#w.get(t);if(!e)return;if(e.refCounter-=1,0!==e.refCounter)return;const{bitmap:n}=e;if(!e.url&&!e.file){const t=new OffscreenCanvas(n.width,n.height);t.getContext("bitmaprenderer").transferFromImageBitmap(n),e.blobPromise=t.convertToBlob()}n.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#_}_`)}}class gi{#x=[];#E=!1;#S;#T=-1;constructor(t=128){this.#S=t}add({cmd:t,undo:e,post:n,mustExec:i,type:r=NaN,overwriteIfSameType:s=!1,keepUndo:a=!1}){if(i&&t(),this.#E)return;const o={cmd:t,undo:e,post:n,type:r};if(-1===this.#T)return this.#x.length>0&&(this.#x.length=0),this.#T=0,void this.#x.push(o);if(s&&this.#x[this.#T].type===r)return a&&(o.undo=this.#x[this.#T].undo),void(this.#x[this.#T]=o);const l=this.#T+1;l===this.#S?this.#x.splice(0,1):(this.#T=l,l<this.#x.length&&this.#x.splice(l)),this.#x.push(o)}undo(){if(-1===this.#T)return;this.#E=!0;const{undo:t,post:e}=this.#x[this.#T];t(),e?.(),this.#E=!1,this.#T-=1}redo(){if(this.#T<this.#x.length-1){this.#T+=1,this.#E=!0;const{cmd:t,post:e}=this.#x[this.#T];t(),e?.(),this.#E=!1}}hasSomethingToUndo(){return-1!==this.#T}hasSomethingToRedo(){return this.#T<this.#x.length-1}destroy(){this.#x=null}}class mi{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Nn.platform;for(const[n,i,r={}]of t)for(const t of n){const n=t.startsWith("mac+");e&&n?(this.callbacks.set(t.slice(4),{callback:i,options:r}),this.allKeys.add(t.split("+").at(-1))):e||n||(this.callbacks.set(t,{callback:i,options:r}),this.allKeys.add(t.split("+").at(-1)))}}#C(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(this.#C(e));if(!n)return;const{callback:i,options:{bubbles:r=!1,args:s=[],checker:a=null}}=n;a&&!a(t,e)||(i.bind(t,...s,e)(),r||(e.stopPropagation(),e.preventDefault()))}}class vi{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return function(t){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const n of t.keys()){e.style.color=n;const i=window.getComputedStyle(e).color;t.set(n,si(i))}e.remove()}(t),Sn(this,"_colors",t)}convert(t){const e=si(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[t,n]of this._colors)if(n.every(((t,n)=>t===e[n])))return vi._colorsMapping.get(t);return e}getHexCode(t){const e=this._colors.get(t);return e?qn.makeHexColor(...e):t}}class bi{#k=new AbortController;#M=null;#I=new Map;#L=new Map;#P=null;#R=null;#D=null;#F=new gi;#O=null;#N=0;#B=new Set;#q=null;#H=null;#j=new Set;#z=!1;#U=!1;#V=!1;#G=null;#W=null;#$=null;#X=null;#K=!1;#Y=null;#Q=new pi;#J=!1;#Z=!1;#tt=null;#et=null;#nt=null;#it=null;#rt=dn.NONE;#st=new Set;#at=null;#ot=null;#lt=null;#ct={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#dt=[0,0];#ht=null;#ut=null;#pt=null;#ft=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=bi.prototype,e=t=>t.#ut.contains(document.activeElement)&&"BUTTON"!==document.activeElement.tagName&&t.hasSomethingToControl(),n=(t,{target:e})=>{if(e instanceof HTMLInputElement){const{type:t}=e;return"text"!==t&&"number"!==t}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return Sn(this,"_keyboardManager",new mi([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(t,{target:e})=>!(e instanceof HTMLButtonElement)&&t.#ut.contains(e)&&!t.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(t,{target:e})=>!(e instanceof HTMLButtonElement)&&t.#ut.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}]]))}constructor(t,e,n,i,r,s,a,o,l,c,d){const h=this._signal=this.#k.signal;this.#ut=t,this.#pt=e,this.#P=n,this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:h}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:h}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:h}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:h}),i._on("setpreference",this.onSetPreference.bind(this),{signal:h}),i._on("switchannotationeditorparams",(t=>this.updateParams(t.type,t.value)),{signal:h}),this.#gt(),this.#mt(),this.#vt(),this.#R=r.annotationStorage,this.#G=r.filterFactory,this.#ot=s,this.#X=a||null,this.#z=o,this.#U=l,this.#V=c,this.#it=d||null,this.viewParameters={realScale:Gn.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}destroy(){this.#ft?.resolve(),this.#ft=null,this.#k?.abort(),this.#k=null,this._signal=null;for(const t of this.#L.values())t.destroy();this.#L.clear(),this.#I.clear(),this.#j.clear(),this.#M=null,this.#st.clear(),this.#F.destroy(),this.#P?.destroy(),this.#Y?.hide(),this.#Y=null,this.#W&&(clearTimeout(this.#W),this.#W=null),this.#ht&&(clearTimeout(this.#ht),this.#ht=null)}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#it}get useNewAltTextFlow(){return this.#U}get useNewAltTextWhenAddingImage(){return this.#V}get hcmFilter(){return Sn(this,"hcmFilter",this.#ot?this.#G.addHCMFilter(this.#ot.foreground,this.#ot.background):"none")}get direction(){return Sn(this,"direction",getComputedStyle(this.#ut).direction)}get highlightColors(){return Sn(this,"highlightColors",this.#X?new Map(this.#X.split(",").map((t=>t.split("=").map((t=>t.trim()))))):null)}get highlightColorNames(){return Sn(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,(t=>t.reverse()))):null)}setMainHighlightColorPicker(t){this.#nt=t}editAltText(t,e=!1){this.#P?.editAltText(this,t,e)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){"enableNewAltTextWhenAddingImage"===t&&(this.#V=e)}onPageChanging({pageNumber:t}){this.#N=t-1}focusMainContainer(){this.#ut.focus()}findParent(t,e){for(const n of this.#L.values()){const{x:i,y:r,width:s,height:a}=n.div.getBoundingClientRect();if(t>=i&&t<=i+s&&e>=r&&e<=r+a)return n}return null}disableUserSelect(t=!1){this.#pt.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#j.add(t)}removeShouldRescale(t){this.#j.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Gn.PDF_TO_CSS_UNITS;for(const t of this.#j)t.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#bt({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#yt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const e of this.#L.values())if(e.hasTextLayer(t))return e;return null}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:s}=e,a=e.toString(),o=this.#bt(e).closest(".textLayer"),l=this.getSelectionBoxes(o);if(!l)return;e.empty();const c=this.#yt(o),d=this.#rt===dn.NONE,h=()=>{c?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:l,anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:s,text:a}),d&&this.showAllEditors("highlight",!0,!0)};d?this.switchToMode(dn.HIGHLIGHT,h):h()}#_t(){const t=document.getSelection();if(!t||t.isCollapsed)return;const e=this.#bt(t).closest(".textLayer"),n=this.getSelectionBoxes(e);n&&(this.#Y||=new hi(this),this.#Y.show(e,n,"ltr"===this.direction))}addToAnnotationStorage(t){t.isEmpty()||!this.#R||this.#R.has(t.id)||this.#R.setValue(t.id,t)}#wt(){const t=document.getSelection();if(!t||t.isCollapsed)return void(this.#at&&(this.#Y?.hide(),this.#at=null,this.#At({hasSelectedText:!1})));const{anchorNode:e}=t;if(e===this.#at)return;const n=this.#bt(t).closest(".textLayer");if(n){if(this.#Y?.hide(),this.#at=e,this.#At({hasSelectedText:!0}),(this.#rt===dn.HIGHLIGHT||this.#rt===dn.NONE)&&(this.#rt===dn.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#K=this.isShiftKeyDown,!this.isShiftKeyDown)){const t=this.#rt===dn.HIGHLIGHT?this.#yt(n):null;t?.toggleDrawing();const e=new AbortController,i=this.combinedSignal(e),r=n=>{"pointerup"===n.type&&0!==n.button||(e.abort(),t?.toggleDrawing(!0),"pointerup"===n.type&&this.#xt("main_toolbar"))};window.addEventListener("pointerup",r,{signal:i}),window.addEventListener("blur",r,{signal:i})}}else this.#at&&(this.#Y?.hide(),this.#at=null,this.#At({hasSelectedText:!1}))}#xt(t=""){this.#rt===dn.HIGHLIGHT?this.highlightSelection(t):this.#z&&this.#_t()}#gt(){document.addEventListener("selectionchange",this.#wt.bind(this),{signal:this._signal})}#Et(){if(this.#$)return;this.#$=new AbortController;const t=this.combinedSignal(this.#$);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#St(){this.#$?.abort(),this.#$=null}blur(){if(this.isShiftKeyDown=!1,this.#K&&(this.#K=!1,this.#xt("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#st)if(e.div.contains(t)){this.#et=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#et)return;const[t,e]=this.#et;this.#et=null,e.addEventListener("focusin",(()=>{t._focusEventsAllowed=!0}),{once:!0,signal:this._signal}),e.focus()}#vt(){if(this.#tt)return;this.#tt=new AbortController;const t=this.combinedSignal(this.#tt);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#Tt(){this.#tt?.abort(),this.#tt=null}#Ct(){if(this.#O)return;this.#O=new AbortController;const t=this.combinedSignal(this.#O);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#kt(){this.#O?.abort(),this.#O=null}#mt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#vt(),this.#Ct()}removeEditListeners(){this.#Tt(),this.#kt()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of this.#H)if(n.isHandlingMimeForPasting(e))return t.dataTransfer.dropEffect="copy",void t.preventDefault()}drop(t){for(const e of t.dataTransfer.items)for(const n of this.#H)if(n.isHandlingMimeForPasting(e.type))return n.paste(e,this.currentLayer),void t.preventDefault()}copy(t){if(t.preventDefault(),this.#M?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const t of this.#st){const n=t.serialize(!0);n&&e.push(n)}0!==e.length&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const t of e.items)for(const e of this.#H)if(e.isHandlingMimeForPasting(t.type))return void e.paste(t,this.currentLayer);let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(t){return void wn(`paste: "${t.message}".`)}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const t=[];for(const e of n){const n=await i.deserialize(e);if(!n)return;t.push(n)}const e=()=>{for(const e of t)this.#Mt(e);this.#It(t)},r=()=>{for(const e of t)e.remove()};this.addCommands({cmd:e,undo:r,mustExec:!0})}catch(t){wn(`paste: "${t.message}".`)}}keydown(t){this.isShiftKeyDown||"Shift"!==t.key||(this.isShiftKeyDown=!0),this.#rt===dn.NONE||this.isEditorHandlingKeyboard||bi._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&"Shift"===t.key&&(this.isShiftKeyDown=!1,this.#K&&(this.#K=!1,this.#xt("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu")}}#At(t){Object.entries(t).some((([t,e])=>this.#ct[t]!==e))&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#ct,t)}),this.#rt===dn.HIGHLIGHT&&!1===t.hasSelectedEditor&&this.#Lt([[hn.HIGHLIGHT_FREE,!0]]))}#Lt(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#Et(),this.#Ct(),this.#At({isEditing:this.#rt!==dn.NONE,isEmpty:this.#Pt(),hasSomethingToUndo:this.#F.hasSomethingToUndo(),hasSomethingToRedo:this.#F.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#St(),this.#kt(),this.#At({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#H){this.#H=t;for(const t of this.#H)this.#Lt(t.defaultPropertiesToUpdate)}}getId(){return this.#Q.id}get currentLayer(){return this.#L.get(this.#N)}getLayer(t){return this.#L.get(t)}get currentPageIndex(){return this.#N}addLayer(t){this.#L.set(t.pageIndex,t),this.#J?t.enable():t.disable()}removeLayer(t){this.#L.delete(t.pageIndex)}async updateMode(t,e=null,n=!1){if(this.#rt!==t&&(!this.#ft||(await this.#ft.promise,this.#ft))){if(this.#ft=Promise.withResolvers(),this.#rt=t,t===dn.NONE)return this.setEditingState(!1),this.#Rt(),void this.#ft.resolve();this.setEditingState(!0),await this.#Dt(),this.unselectAll();for(const e of this.#L.values())e.updateMode(t);if(!e)return n&&this.addNewEditorFromKeyboard(),void this.#ft.resolve();for(const t of this.#I.values())t.annotationElementId===e?(this.setSelected(t),t.enterInEditMode()):t.unselect();this.#ft.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==this.#rt&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){if(this.#H){switch(t){case hn.CREATE:return void this.currentLayer.addNewEditor();case hn.HIGHLIGHT_DEFAULT_COLOR:this.#nt?.updateColor(e);break;case hn.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#lt||=new Map).set(t,e),this.showAllEditors("highlight",e)}for(const n of this.#st)n.updateParams(t,e);for(const n of this.#H)n.updateDefaultParams(t,e)}}showAllEditors(t,e,n=!1){for(const n of this.#I.values())n.editorType===t&&n.show(e);(this.#lt?.get(hn.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#Lt([[hn.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#Z!==t){this.#Z=t;for(const e of this.#L.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#Dt(){if(!this.#J){this.#J=!0;const t=[];for(const e of this.#L.values())t.push(e.enable());await Promise.all(t);for(const t of this.#I.values())t.enable()}}#Rt(){if(this.unselectAll(),this.#J){this.#J=!1;for(const t of this.#L.values())t.disable();for(const t of this.#I.values())t.disable()}}getEditors(t){const e=[];for(const n of this.#I.values())n.pageIndex===t&&e.push(n);return e}getEditor(t){return this.#I.get(t)}addEditor(t){this.#I.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#W&&clearTimeout(this.#W),this.#W=setTimeout((()=>{this.focusMainContainer(),this.#W=null}),0)),this.#I.delete(t.id),this.unselect(t),t.annotationElementId&&this.#B.has(t.annotationElementId)||this.#R?.remove(t.id)}addDeletedAnnotationElement(t){this.#B.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#B.has(t)}removeDeletedAnnotationElement(t){this.#B.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#Mt(t){const e=this.#L.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#M!==t&&(this.#M=t,t&&this.#Lt(t.propertiesToUpdate))}get#Ft(){let t=null;for(t of this.#st);return t}updateUI(t){this.#Ft===t&&this.#Lt(t.propertiesToUpdate)}toggleSelected(t){if(this.#st.has(t))return this.#st.delete(t),t.unselect(),void this.#At({hasSelectedEditor:this.hasSelection});this.#st.add(t),t.select(),this.#Lt(t.propertiesToUpdate),this.#At({hasSelectedEditor:!0})}setSelected(t){for(const e of this.#st)e!==t&&e.unselect();this.#st.clear(),this.#st.add(t),t.select(),this.#Lt(t.propertiesToUpdate),this.#At({hasSelectedEditor:!0})}isSelected(t){return this.#st.has(t)}get firstSelectedEditor(){return this.#st.values().next().value}unselect(t){t.unselect(),this.#st.delete(t),this.#At({hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==this.#st.size}get isEnterHandled(){return 1===this.#st.size&&this.firstSelectedEditor.isEnterHandled}undo(){this.#F.undo(),this.#At({hasSomethingToUndo:this.#F.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Pt()})}redo(){this.#F.redo(),this.#At({hasSomethingToUndo:!0,hasSomethingToRedo:this.#F.hasSomethingToRedo(),isEmpty:this.#Pt()})}addCommands(t){this.#F.add(t),this.#At({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Pt()})}#Pt(){if(0===this.#I.size)return!0;if(1===this.#I.size)for(const t of this.#I.values())return t.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const t=[...this.#st];this.addCommands({cmd:()=>{for(const e of t)e.remove()},undo:()=>{for(const e of t)this.#Mt(e)},mustExec:!0})}commitOrRemove(){this.#M?.commitOrRemove()}hasSomethingToControl(){return this.#M||this.hasSelection}#It(t){for(const t of this.#st)t.unselect();this.#st.clear();for(const e of t)e.isEmpty()||(this.#st.add(e),e.select());this.#At({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#st)t.commit();this.#It(this.#I.values())}unselectAll(){if((!this.#M||(this.#M.commitOrRemove(),this.#rt===dn.NONE))&&this.hasSelection){for(const t of this.#st)t.unselect();this.#st.clear(),this.#At({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#dt[0]+=t,this.#dt[1]+=e;const[i,r]=this.#dt,s=[...this.#st];this.#ht&&clearTimeout(this.#ht),this.#ht=setTimeout((()=>{this.#ht=null,this.#dt[0]=this.#dt[1]=0,this.addCommands({cmd:()=>{for(const t of s)this.#I.has(t.id)&&t.translateInPage(i,r)},undo:()=>{for(const t of s)this.#I.has(t.id)&&t.translateInPage(-i,-r)},mustExec:!1})}),1e3);for(const n of s)n.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#q=new Map;for(const t of this.#st)this.#q.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#q)return!1;this.disableUserSelect(!1);const t=this.#q;this.#q=null;let e=!1;for(const[{x:n,y:i,pageIndex:r},s]of t)s.newX=n,s.newY=i,s.newPageIndex=r,e||=n!==s.savedX||i!==s.savedY||r!==s.savedPageIndex;if(!e)return!1;const n=(t,e,n,i)=>{if(this.#I.has(t.id)){const r=this.#L.get(i);r?t._setParentAndPosition(r,e,n):(t.pageIndex=i,t.x=e,t.y=n)}};return this.addCommands({cmd:()=>{for(const[e,{newX:i,newY:r,newPageIndex:s}]of t)n(e,i,r,s)},undo:()=>{for(const[e,{savedX:i,savedY:r,savedPageIndex:s}]of t)n(e,i,r,s)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#q)for(const n of this.#q.keys())n.drag(t,e)}rebuild(t){if(null===t.parent){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||1===this.#st.size&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#M===t}getActive(){return this.#M}getMode(){return this.#rt}get imageManager(){return Sn(this,"imageManager",new fi)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let n=0,i=e.rangeCount;n<i;n++)if(!t.contains(e.getRangeAt(n).commonAncestorContainer))return null;const{x:n,y:i,width:r,height:s}=t.getBoundingClientRect();let a;switch(t.getAttribute("data-main-rotation")){case"90":a=(t,e,a,o)=>({x:(e-i)/s,y:1-(t+a-n)/r,width:o/s,height:a/r});break;case"180":a=(t,e,a,o)=>({x:1-(t+a-n)/r,y:1-(e+o-i)/s,width:a/r,height:o/s});break;case"270":a=(t,e,a,o)=>({x:1-(e+o-i)/s,y:(t-n)/r,width:o/s,height:a/r});break;default:a=(t,e,a,o)=>({x:(t-n)/r,y:(e-i)/s,width:a/r,height:o/s})}const o=[];for(let t=0,n=e.rangeCount;t<n;t++){const n=e.getRangeAt(t);if(!n.collapsed)for(const{x:t,y:e,width:i,height:r}of n.getClientRects())0!==i&&0!==r&&o.push(a(t,e,i,r))}return 0===o.length?null:o}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#D||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#D?.delete(t)}renderAnnotationElement(t){const e=this.#D?.get(t.data.id);if(!e)return;const n=this.#R.getRawValue(e);n&&(this.#rt!==dn.NONE||n.hasBeenModified)&&n.renderAnnotationElement(t)}}class yi{#o=null;#Ot=!1;#Nt=null;#Bt=null;#qt=null;#Ht=null;#jt=!1;#zt=null;#s=null;#Ut=null;#Vt=null;#Gt=!1;static#Wt=null;static _l10n=null;constructor(t){this.#s=t,this.#Gt=t._uiManager.useNewAltTextFlow,yi.#Wt||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){yi._l10n??=t}async render(){const t=this.#Nt=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#Bt=document.createElement("span");t.append(e),this.#Gt?(t.classList.add("new"),t.setAttribute("data-l10n-id",yi.#Wt.missing),e.setAttribute("data-l10n-id",yi.#Wt["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#s._uiManager._signal;t.addEventListener("contextmenu",ei,{signal:n}),t.addEventListener("pointerdown",(t=>t.stopPropagation()),{signal:n});const i=t=>{t.preventDefault(),this.#s._uiManager.editAltText(this.#s),this.#Gt&&this.#s._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#$t}})};return t.addEventListener("click",i,{capture:!0,signal:n}),t.addEventListener("keydown",(e=>{e.target===t&&"Enter"===e.key&&(this.#jt=!0,i(e))}),{signal:n}),await this.#Xt(),t}get#$t(){return(this.#o?"added":null===this.#o&&this.guessedText&&"review")||"missing"}finish(){this.#Nt&&(this.#Nt.focus({focusVisible:this.#jt}),this.#jt=!1)}isEmpty(){return this.#Gt?null===this.#o:!this.#o&&!this.#Ot}hasData(){return this.#Gt?null!==this.#o||!!this.#Ut:this.isEmpty()}get guessedText(){return this.#Ut}async setGuessedText(t){null===this.#o&&(this.#Ut=t,this.#Vt=await yi._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#Xt())}toggleAltTextBadge(t=!1){if(!this.#Gt||this.#o)return this.#zt?.remove(),void(this.#zt=null);if(!this.#zt){const t=this.#zt=document.createElement("div");t.className="noAltTextBadge",this.#s.div.append(t)}this.#zt.classList.toggle("hidden",!t)}serialize(t){let e=this.#o;return t||this.#Ut!==e||(e=this.#Vt),{altText:e,decorative:this.#Ot,guessedText:this.#Ut,textWithDisclaimer:this.#Vt}}get data(){return{altText:this.#o,decorative:this.#Ot}}set data({altText:t,decorative:e,guessedText:n,textWithDisclaimer:i,cancel:r=!1}){n&&(this.#Ut=n,this.#Vt=i),this.#o===t&&this.#Ot===e||(r||(this.#o=t,this.#Ot=e),this.#Xt())}toggle(t=!1){this.#Nt&&(!t&&this.#Ht&&(clearTimeout(this.#Ht),this.#Ht=null),this.#Nt.disabled=!t)}shown(){this.#s._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#$t}})}destroy(){this.#Nt?.remove(),this.#Nt=null,this.#Bt=null,this.#qt=null,this.#zt?.remove(),this.#zt=null}async#Xt(){const t=this.#Nt;if(!t)return;if(this.#Gt){if(t.classList.toggle("done",!!this.#o),t.setAttribute("data-l10n-id",yi.#Wt[this.#$t]),this.#Bt?.setAttribute("data-l10n-id",yi.#Wt[`${this.#$t}-label`]),!this.#o)return void this.#qt?.remove()}else{if(!this.#o&&!this.#Ot)return t.classList.remove("done"),void this.#qt?.remove();t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#qt;if(!e){this.#qt=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#s.id}`;const n=100,i=this.#s._uiManager._signal;i.addEventListener("abort",(()=>{clearTimeout(this.#Ht),this.#Ht=null}),{once:!0}),t.addEventListener("mouseenter",(()=>{this.#Ht=setTimeout((()=>{this.#Ht=null,this.#qt.classList.add("show"),this.#s._reportTelemetry({action:"alt_text_tooltip"})}),n)}),{signal:i}),t.addEventListener("mouseleave",(()=>{this.#Ht&&(clearTimeout(this.#Ht),this.#Ht=null),this.#qt?.classList.remove("show")}),{signal:i})}this.#Ot?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#o),e.parentNode||t.append(e);const n=this.#s.getImageForAltText();n?.setAttribute("aria-describedby",e.id)}}class _i{#Kt=null;#Yt=null;#o=null;#Qt=!1;#Jt=!1;#Zt=null;#te=null;#ee=null;#ne="";#ie=!1;#re=null;#se=!1;#ae=!1;#oe=!1;#le=null;#ce=0;#de=0;#he=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#ue=!1;#pe=_i._zIndex++;static _borderLineWidth=-1;static _colorManager=new vi;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=_i.prototype._resizeWithKeyboard,e=bi.TRANSLATE_SMALL,n=bi.TRANSLATE_BIG;return Sn(this,"_resizerKeyboardManager",new mi([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],_i.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:n,pageHeight:i,pageX:r,pageY:s}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[r,s];const[a,o]=this.parentDimensions;this.x=t.x/a,this.y=t.y/o,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return Sn(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new wi({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(_i._l10n??=t,_i._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),-1!==_i._borderLineWidth)return;const n=getComputedStyle(document.documentElement);_i._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){An("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#ue}set _isDraggable(t){this.#ue=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(2*t),this.y+=this.width*t/(2*e);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(2*t),this.y-=this.width*t/(2*e);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#pe}setParent(t){null!==t?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#fe(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#ie?this.#ie=!1:this.parent.setSelected(this))}focusout(t){if(!this._focusEventsAllowed)return;if(!this.isAttachedToDOM)return;const e=t.relatedTarget;e?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,i){const[r,s]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(t+n)/r,this.y=(e+i)/s,this.fixAndSetPosition()}#ge([t,e],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/t,this.y+=i/e,this.fixAndSetPosition()}translate(t,e){this.#ge(this.parentDimensions,t,e)}translateInPage(t,e){this.#re||=[this.x,this.y],this.#ge(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){this.#re||=[this.x,this.y];const[n,i]=this.parentDimensions;if(this.x+=t/n,this.y+=e/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:t,y:e}=this.div.getBoundingClientRect();this.parent.findNewParent(this,t,e)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:r,y:s}=this;const[a,o]=this.getBaseTranslation();r+=a,s+=o,this.div.style.left=`${(100*r).toFixed(2)}%`,this.div.style.top=`${(100*s).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!this.#re&&(this.#re[0]!==this.x||this.#re[1]!==this.y)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=_i,i=n/t,r=n/e;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const[e,n]=this.pageDimensions;let{x:i,y:r,width:s,height:a}=this;if(s*=e,a*=n,i*=e,r*=n,this._mustFixPosition)switch(t){case 0:i=Math.max(0,Math.min(e-s,i)),r=Math.max(0,Math.min(n-a,r));break;case 90:i=Math.max(0,Math.min(e-a,i)),r=Math.min(n,Math.max(s,r));break;case 180:i=Math.min(e,Math.max(s,i)),r=Math.min(n,Math.max(a,r));break;case 270:i=Math.min(e,Math.max(a,i)),r=Math.max(0,Math.min(n-s,r))}this.x=i/=e,this.y=r/=n;const[o,l]=this.getBaseTranslation();i+=o,r+=l;const{style:c}=this.div;c.left=`${(100*i).toFixed(2)}%`,c.top=`${(100*r).toFixed(2)}%`,this.moveInDOM()}static#me(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return _i.#me(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return _i.#me(t,e,360-this.parentRotation)}#ve(t){switch(t){case 90:{const[t,e]=this.pageDimensions;return[0,-t/e,e/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,e]=this.pageDimensions;return[0,t/e,-e/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(t,e){const[n,i]=this.parentDimensions;this.div.style.width=`${(100*t/n).toFixed(2)}%`,this.#Jt||(this.div.style.height=`${(100*e/i).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:n}=t,i=n.endsWith("%"),r=!this.#Jt&&e.endsWith("%");if(i&&r)return;const[s,a]=this.parentDimensions;i||(t.width=`${(100*parseFloat(n)/s).toFixed(2)}%`),this.#Jt||r||(t.height=`${(100*parseFloat(e)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#be(){if(this.#Zt)return;this.#Zt=document.createElement("div"),this.#Zt.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const t=document.createElement("div");this.#Zt.append(t),t.classList.add("resizer",n),t.setAttribute("data-resizer-name",n),t.addEventListener("pointerdown",this.#ye.bind(this,n),{signal:e}),t.addEventListener("contextmenu",ei,{signal:e}),t.tabIndex=-1}this.div.prepend(this.#Zt)}#ye(t,e){e.preventDefault();const{isMac:n}=Nn.platform;if(0!==e.button||e.ctrlKey&&n)return;this.#o?.toggle(!1);const i=this._isDraggable;this._isDraggable=!1;const r=new AbortController,s=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#_e.bind(this,t),{passive:!0,capture:!0,signal:s}),window.addEventListener("contextmenu",ei,{signal:s});const a=this.x,o=this.y,l=this.width,c=this.height,d=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const u=()=>{r.abort(),this.parent.togglePointerEvents(!0),this.#o?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=d,this.div.style.cursor=h,this.#we(a,o,l,c)};window.addEventListener("pointerup",u,{signal:s}),window.addEventListener("blur",u,{signal:s})}#we(t,e,n,i){const r=this.x,s=this.y,a=this.width,o=this.height;r===t&&s===e&&a===n&&o===i||this.addCommands({cmd:()=>{this.width=a,this.height=o,this.x=r,this.y=s;const[t,e]=this.parentDimensions;this.setDims(t*a,e*o),this.fixAndSetPosition()},undo:()=>{this.width=n,this.height=i,this.x=t,this.y=e;const[r,s]=this.parentDimensions;this.setDims(r*n,s*i),this.fixAndSetPosition()},mustExec:!0})}#_e(t,e){const[n,i]=this.parentDimensions,r=this.x,s=this.y,a=this.width,o=this.height,l=_i.MIN_SIZE/n,c=_i.MIN_SIZE/i,d=t=>Math.round(1e4*t)/1e4,h=this.#ve(this.rotation),u=(t,e)=>[h[0]*t+h[2]*e,h[1]*t+h[3]*e],p=this.#ve(360-this.rotation);let f,g,m=!1,v=!1;switch(t){case"topLeft":m=!0,f=(t,e)=>[0,0],g=(t,e)=>[t,e];break;case"topMiddle":f=(t,e)=>[t/2,0],g=(t,e)=>[t/2,e];break;case"topRight":m=!0,f=(t,e)=>[t,0],g=(t,e)=>[0,e];break;case"middleRight":v=!0,f=(t,e)=>[t,e/2],g=(t,e)=>[0,e/2];break;case"bottomRight":m=!0,f=(t,e)=>[t,e],g=(t,e)=>[0,0];break;case"bottomMiddle":f=(t,e)=>[t/2,e],g=(t,e)=>[t/2,0];break;case"bottomLeft":m=!0,f=(t,e)=>[0,e],g=(t,e)=>[t,0];break;case"middleLeft":v=!0,f=(t,e)=>[0,e/2],g=(t,e)=>[t,e/2]}const b=f(a,o),y=g(a,o);let _=u(...y);const w=d(r+_[0]),A=d(s+_[1]);let x=1,E=1,[S,T]=this.screenToPageTranslation(e.movementX,e.movementY);var C,k;if([S,T]=(C=S/n,k=T/i,[p[0]*C+p[2]*k,p[1]*C+p[3]*k]),m){const t=Math.hypot(a,o);x=E=Math.max(Math.min(Math.hypot(y[0]-b[0]-S,y[1]-b[1]-T)/t,1/a,1/o),l/a,c/o)}else v?x=Math.max(l,Math.min(1,Math.abs(y[0]-b[0]-S)))/a:E=Math.max(c,Math.min(1,Math.abs(y[1]-b[1]-T)))/o;const M=d(a*x),I=d(o*E);_=u(...g(M,I));const L=w-_[0],P=A-_[1];this.width=M,this.height=I,this.x=L,this.y=P,this.setDims(n*M,i*I),this.fixAndSetPosition()}altTextFinish(){this.#o?.finish()}async addEditToolbar(){return this._editToolbar||this.#ae||(this._editToolbar=new di(this),this.div.append(this._editToolbar.render()),this.#o&&await this._editToolbar.addAltText(this.#o)),this._editToolbar}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#o?.destroy())}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#o||(yi.initialize(_i._l10n),this.#o=new yi(this),this.#Kt&&(this.#o.data=this.#Kt,this.#Kt=null),await this.addEditToolbar())}get altTextData(){return this.#o?.data}set altTextData(t){this.#o&&(this.#o.data=t)}get guessedAltText(){return this.#o?.guessedText}async setGuessedAltText(t){await(this.#o?.setGuessedText(t))}serializeAltText(t){return this.#o?.serialize(t)}hasAltText(){return!!this.#o&&!this.#o.isEmpty()}hasAltTextData(){return this.#o?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#Qt?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#Ae();const[t,e]=this.parentDimensions;this.parentRotation%180!=0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[n,i]=this.getInitialTranslation();return this.translate(n,i),ui(this,this.div,["pointerdown"]),this.div}pointerdown(t){const{isMac:e}=Nn.platform;0!==t.button||t.ctrlKey&&e?t.preventDefault():(this.#ie=!0,this._isDraggable?this.#xe(t):this.#Ee(t))}get isSelected(){return this._uiManager.isSelected(this)}#Ee(t){const{isMac:e}=Nn.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#xe(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();const n=new AbortController,i=this._uiManager.combinedSignal(n);if(e){this.div.classList.add("moving"),this.#ce=t.clientX,this.#de=t.clientY;const e=t=>{const{clientX:e,clientY:n}=t,[i,r]=this.screenToPageTranslation(e-this.#ce,n-this.#de);this.#ce=e,this.#de=n,this._uiManager.dragSelectedEditors(i,r)};window.addEventListener("pointermove",e,{passive:!0,capture:!0,signal:i})}const r=()=>{n.abort(),e&&this.div.classList.remove("moving"),this.#ie=!1,this._uiManager.endDragSession()||this.#Ee(t)};window.addEventListener("pointerup",r,{signal:i}),window.addEventListener("blur",r,{signal:i})}moveInDOM(){this.#le&&clearTimeout(this.#le),this.#le=setTimeout((()=>{this.#le=null,this.parent?.moveEditorInDOM(this)}),0)}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition()}getRect(t,e,n=this.rotation){const i=this.parentScale,[r,s]=this.pageDimensions,[a,o]=this.pageTranslation,l=t/i,c=e/i,d=this.x*r,h=this.y*s,u=this.width*r,p=this.height*s;switch(n){case 0:return[d+l+a,s-h-c-p+o,d+l+u+a,s-h-c+o];case 90:return[d+c+a,s-h+l+o,d+c+p+a,s-h+l+u+o];case 180:return[d-l-u+a,s-h+c+o,d-l+a,s-h+c+p+o];case 270:return[d-c-p+a,s-h-l-u+o,d-c+a,s-h-l+o];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,i,r,s]=t,a=r-n,o=s-i;switch(this.rotation){case 0:return[n,e-s,a,o];case 90:return[n,e-i,o,a];case 180:return[r,e-i,a,o];case 270:return[r,e-s,o,a];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#ae=!0}disableEditMode(){this.#ae=!1}isInEditMode(){return this.#ae}shouldGetKeyboardEvents(){return this.#oe}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}#Ae(){if(this.#ee||!this.div)return;this.#ee=new AbortController;const t=this._uiManager.combinedSignal(this.#ee);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#Ae()}rotate(t){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){An("An editor must be serializable")}static async deserialize(t,e,n){const i=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n});i.rotation=t.rotation,i.#Kt=t.accessibilityData;const[r,s]=i.pageDimensions,[a,o,l,c]=i.getRectInCurrentCoords(t.rect,s);return i.x=a/r,i.y=o/s,i.width=l/r,i.height=c/s,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||null!==this.serialize())}remove(){if(this.#ee?.abort(),this.#ee=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#le&&(clearTimeout(this.#le),this.#le=null),this.#fe(),this.removeEditToolbar(),this.#he){for(const t of this.#he.values())clearTimeout(t);this.#he=null}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#be(),this.#Zt.classList.remove("hidden"),ui(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||"Enter"!==t.key)return;this._uiManager.setSelected(this),this.#te={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#Zt.children;if(!this.#Yt){this.#Yt=Array.from(e);const t=this.#Se.bind(this),n=this.#Te.bind(this),i=this._uiManager._signal;for(const e of this.#Yt){const r=e.getAttribute("data-resizer-name");e.setAttribute("role","spinbutton"),e.addEventListener("keydown",t,{signal:i}),e.addEventListener("blur",n,{signal:i}),e.addEventListener("focus",this.#Ce.bind(this,r),{signal:i}),e.setAttribute("data-l10n-id",_i._l10nResizer[r])}}const n=this.#Yt[0];let i=0;for(const t of e){if(t===n)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(this.#Yt.length/4);if(r!==i){if(r<i)for(let t=0;t<i-r;t++)this.#Zt.append(this.#Zt.firstChild);else if(r>i)for(let t=0;t<r-i;t++)this.#Zt.firstChild.before(this.#Zt.lastChild);let t=0;for(const n of e){const e=this.#Yt[t++].getAttribute("data-resizer-name");n.setAttribute("data-l10n-id",_i._l10nResizer[e])}}this.#ke(0),this.#oe=!0,this.#Zt.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#Se(t){_i._resizerKeyboardManager.exec(this,t)}#Te(t){this.#oe&&t.relatedTarget?.parentNode!==this.#Zt&&this.#fe()}#Ce(t){this.#ne=this.#oe?t:""}#ke(t){if(this.#Yt)for(const e of this.#Yt)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#oe&&this.#_e(this.#ne,{movementX:t,movementY:e})}#fe(){if(this.#oe=!1,this.#ke(-1),this.#te){const{savedX:t,savedY:e,savedWidth:n,savedHeight:i}=this.#te;this.#we(t,e,n,i),this.#te=null}}_stopResizingWithKeyboard(){this.#fe(),this.div.focus()}select(){this.makeResizable(),this.div?.classList.add("selectedEditor"),this._editToolbar?(this._editToolbar?.show(),this.#o?.toggleAltTextBadge(!1)):this.addEditToolbar().then((()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()}))}unselect(){this.#Zt?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#o?.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#se}set isEditing(t){this.#se=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){this.#Jt=!0;const n=t/e,{style:i}=this.div;i.aspectRatio=n,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#he||=new Map;const{action:e}=t;let n=this.#he.get(e);return n&&clearTimeout(n),n=setTimeout((()=>{this._reportTelemetry(t),this.#he.delete(e),0===this.#he.size&&(this.#he=null)}),_i._telemetryTimeout),void this.#he.set(e,n)}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#Qt=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#Qt=!0}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(e){if("CANVAS"===e.nodeName){const t=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.before(e)}}else e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);return e}resetAnnotationElement(t){const{firstChild:e}=t.container;"DIV"===e?.nodeName&&e.classList.contains("annotationContent")&&e.remove()}}class wi extends _i{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Ai=3285377520,xi=4294901760,Ei=65535;class Si{constructor(t){this.h1=t?4294967295&t:Ai,this.h2=t?4294967295&t:Ai}update(t){let e,n;if("string"==typeof t){e=new Uint8Array(2*t.length),n=0;for(let i=0,r=t.length;i<r;i++){const r=t.charCodeAt(i);r<=255?e[n++]=r:(e[n++]=r>>>8,e[n++]=255&r)}}else{if(!ArrayBuffer.isView(t))throw new Error("Invalid data format, must be a string or TypedArray.");e=t.slice(),n=e.byteLength}const i=n>>2,r=n-4*i,s=new Uint32Array(e.buffer,0,i);let a=0,o=0,l=this.h1,c=this.h2;const d=3432918353,h=461845907,u=11601,p=13715;for(let t=0;t<i;t++)1&t?(a=s[t],a=a*d&xi|a*u&Ei,a=a<<15|a>>>17,a=a*h&xi|a*p&Ei,l^=a,l=l<<13|l>>>19,l=5*l+3864292196):(o=s[t],o=o*d&xi|o*u&Ei,o=o<<15|o>>>17,o=o*h&xi|o*p&Ei,c^=o,c=c<<13|c>>>19,c=5*c+3864292196);switch(a=0,r){case 3:a^=e[4*i+2]<<16;case 2:a^=e[4*i+1]<<8;case 1:a^=e[4*i],a=a*d&xi|a*u&Ei,a=a<<15|a>>>17,a=a*h&xi|a*p&Ei,1&i?l^=a:c^=a}this.h1=l,this.h2=c}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=3981806797*t&xi|36045*t&Ei,e=4283543511*e&xi|(2950163797*(e<<16|t>>>16)&xi)>>>16,t^=e>>>1,t=444984403*t&xi|60499*t&Ei,e=3301882366*e&xi|(3120437893*(e<<16|t>>>16)&xi)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Ti=Object.freeze({map:null,hash:"",transfer:void 0});class Ci{#Me=!1;#Ie=null;#Le=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=this.#Le.get(t);return void 0===n?e:Object.assign(e,n)}getRawValue(t){return this.#Le.get(t)}remove(t){if(this.#Le.delete(t),0===this.#Le.size&&this.resetModified(),"function"==typeof this.onAnnotationEditor){for(const t of this.#Le.values())if(t instanceof _i)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=this.#Le.get(t);let i=!1;if(void 0!==n)for(const[t,r]of Object.entries(e))n[t]!==r&&(i=!0,n[t]=r);else i=!0,this.#Le.set(t,e);i&&this.#Pe(),e instanceof _i&&"function"==typeof this.onAnnotationEditor&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#Le.has(t)}getAll(){return this.#Le.size>0?On(this.#Le):null}setAll(t){for(const[e,n]of Object.entries(t))this.setValue(e,n)}get size(){return this.#Le.size}#Pe(){this.#Me||(this.#Me=!0,"function"==typeof this.onSetModified&&this.onSetModified())}resetModified(){this.#Me&&(this.#Me=!1,"function"==typeof this.onResetModified&&this.onResetModified())}get print(){return new ki(this)}get serializable(){if(0===this.#Le.size)return Ti;const t=new Map,e=new Si,n=[],i=Object.create(null);let r=!1;for(const[n,s]of this.#Le){const a=s instanceof _i?s.serialize(!1,i):s;a&&(t.set(n,a),e.update(`${n}:${JSON.stringify(a)}`),r||=!!a.bitmap)}if(r)for(const e of t.values())e.bitmap&&n.push(e.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:Ti}get editorStats(){let t=null;const e=new Map;for(const n of this.#Le.values()){if(!(n instanceof _i))continue;const i=n.telemetryFinalData;if(!i)continue;const{type:r}=i;e.has(r)||e.set(r,Object.getPrototypeOf(n).constructor),t||=Object.create(null);const s=t[r]||=new Map;for(const[t,e]of Object.entries(i)){if("type"===t)continue;let n=s.get(t);n||(n=new Map,s.set(t,n));const i=n.get(e)??0;n.set(e,i+1)}}for(const[n,i]of e)t[n]=i.computeTelemetryFinalData(t[n]);return t}resetModifiedIds(){this.#Ie=null}get modifiedIds(){if(this.#Ie)return this.#Ie;const t=[];for(const e of this.#Le.values())e instanceof _i&&e.annotationElementId&&e.serialize()&&t.push(e.annotationElementId);return this.#Ie={ids:new Set(t),hash:t.join(",")}}}class ki extends Ci{#Re;constructor(t){super();const{map:e,hash:n,transfer:i}=t.serializable,r=structuredClone(e,i?{transfer:i}:null);this.#Re={map:r,hash:n,transfer:i}}get print(){An("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#Re}get modifiedIds(){return Sn(this,"modifiedIds",{ids:new Set,hash:""})}}class Mi{#De=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#De.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(t&&!this.#De.has(t.loadedName))if(xn(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:i,style:r}=t,s=new FontFace(n,i,r);this.addNativeFontFace(s);try{await s.load(),this.#De.add(n),e?.(t)}catch{wn(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(s)}}else An("Not implemented: loadSystemFont without the Font Loading API.")}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo)return void await this.loadSystemFont(t);if(this.isFontLoadingAPISupported){const e=t.createNativeFontFace();if(e){this.addNativeFontFace(e);try{await e.loaded}catch(n){throw wn(`Failed to load font '${e.family}': '${n}'.`),t.disableFontFace=!0,n}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise((e=>{const n=this._queueLoadingCallback(e);this._prepareFontLoadEvent(t,n)}))}}get isFontLoadingAPISupported(){return Sn(this,"isFontLoadingAPISupported",!!this._document?.fonts)}get isSyncFontLoadingSupported(){let t=!1;return(sn||"undefined"!=typeof navigator&&"string"==typeof navigator?.userAgent&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),Sn(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){const{loadingRequests:e}=this,n={done:!1,complete:function(){for(xn(!n.done,"completeRequest() cannot be called twice."),n.done=!0;e.length>0&&e[0].done;){const t=e.shift();setTimeout(t.callback,0)}},callback:t};return e.push(n),n}get _loadTestFont(){return Sn(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(t,e){function n(t,e){return t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|255&t.charCodeAt(e+3)}function i(t,e,n,i){return t.substring(0,e)+i+t.substring(e+n)}let r,s;const a=this._document.createElement("canvas");a.width=1,a.height=1;const o=a.getContext("2d");let l=0;const c=`lt${Date.now()}${this.loadTestFontId++}`;let d=this._loadTestFont;d=i(d,976,c.length,c);const h=1482184792;let u=n(d,16);for(r=0,s=c.length-3;r<s;r+=4)u=u-h+n(c,r)|0;var p;r<c.length&&(u=u-h+n(c+"XXX",r)|0),d=i(d,16,4,(p=u,String.fromCharCode(p>>24&255,p>>16&255,p>>8&255,255&p)));const f=`@font-face {font-family:"${c}";src:url(data:font/opentype;base64,${btoa(d)});}`;this.insertRule(f);const g=this._document.createElement("div");g.style.visibility="hidden",g.style.width=g.style.height="10px",g.style.position="absolute",g.style.top=g.style.left="0px";for(const e of[t.loadedName,c]){const t=this._document.createElement("span");t.textContent="Hi",t.style.fontFamily=e,g.append(t)}this._document.body.append(g),function t(e,n){if(++l>30)return wn("Load test font never loaded."),void n();o.font="30px "+e,o.fillText(".",0,20),o.getImageData(0,0,1,1).data[3]>0?n():setTimeout(t.bind(null,e,n))}(c,(()=>{g.remove(),e.complete()}))}}class Ii{constructor(t,{disableFontFace:e=!1,inspectFont:n=null}){this.compiledGlyphs=Object.create(null);for(const e in t)this[e]=t[e];this.disableFontFace=!0===e,this._inspectFont=n}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(this.cssFontInfo){const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}else t=new FontFace(this.loadedName,this.data,{});return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${e=this.data,Uint8Array.prototype.toBase64?e.toBase64():btoa(Dn(e))});`;var e;let n;if(this.cssFontInfo){let e=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(e+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),n=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${e}src:${t}}`}else n=`@font-face {font-family:"${this.loadedName}";src:${t}}`;return this._inspectFont?.(this,t),n}getPathGenerator(t,e){if(void 0!==this.compiledGlyphs[e])return this.compiledGlyphs[e];let n;try{n=t.get(this.loadedName+"_path_"+e)}catch(t){wn(`getPathGenerator - ignoring character: "${t}".`)}if(!Array.isArray(n)||0===n.length)return this.compiledGlyphs[e]=function(t,e){};const i=[];for(let t=0,e=n.length;t<e;)switch(n[t++]){case 0:{const[e,r,s,a,o,l]=n.slice(t,t+6);i.push((t=>t.bezierCurveTo(e,r,s,a,o,l))),t+=6}break;case 1:{const[e,r]=n.slice(t,t+2);i.push((t=>t.moveTo(e,r))),t+=2}break;case 2:{const[e,r]=n.slice(t,t+2);i.push((t=>t.lineTo(e,r))),t+=2}break;case 3:{const[e,r,s,a]=n.slice(t,t+4);i.push((t=>t.quadraticCurveTo(e,r,s,a))),t+=4}break;case 4:i.push((t=>t.restore()));break;case 5:i.push((t=>t.save()));break;case 6:xn(2===i.length,"Scale command is only valid at the third position.");break;case 7:{const[e,r,s,a,o,l]=n.slice(t,t+6);i.push((t=>t.transform(e,r,s,a,o,l))),t+=6}break;case 8:{const[e,r]=n.slice(t,t+2);i.push((t=>t.translate(e,r))),t+=2}}return this.compiledGlyphs[e]=function(t,e){i[0](t),i[1](t),t.scale(e,-e);for(let e=2,n=i.length;e<n;e++)i[e](t)}}}class Li{#Fe=!1;constructor({enableHWA:t=!1}){this.#Fe=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#Fe})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){An("Abstract method `_createCanvas` called.")}}class Pi{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then((t=>({cMapData:t,isCompressed:this.isCompressed}))).catch((t=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)}))}async _fetch(t){An("Abstract method `_fetch` called.")}}class Ri extends Pi{async _fetch(t){const e=await Wn(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):Fn(e)}}class Di{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,i,r){return"none"}destroy(t=!1){}}class Fi{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch((t=>{throw new Error(`Unable to load font data at: ${e}`)}))}async _fetch(t){An("Abstract method `_fetch` called.")}}class Oi extends Fi{async _fetch(t){const e=await Wn(t,"arraybuffer");return new Uint8Array(e)}}if(sn){var Ni=Promise.withResolvers(),Bi=null;(async()=>{const t=await import("fs"),e=await import("http"),n=await import("https"),i=await import("url");return new Map(Object.entries({fs:t,http:e,https:n,url:i,canvas:void 0,path2d:void 0}))})().then((t=>{Bi=t,Ni.resolve()}),(t=>{wn(`loadPackages: ${t}`),Bi=new Map,Ni.resolve()}))}class qi{static get promise(){return Ni.promise}static get(t){return Bi?.get(t)}}async function Hi(t){const e=qi.get("fs"),n=await e.promises.readFile(t);return new Uint8Array(n)}const ji="Fill",zi="Stroke",Ui="Shading";function Vi(t,e){if(!e)return;const n=e[2]-e[0],i=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],n,i),t.clip(r)}class Gi{getPattern(){An("Abstract method `getPattern` called.")}}class Wi extends Gi{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;"axial"===this._type?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const t of this._colorStops)e.addColorStop(t[0],t[1]);return e}getPattern(t,e,n,i){let r;if(i===zi||i===ji){const s=e.current.getClippedPathBoundingBox(i,ai(t))||[0,0,0,0],a=Math.ceil(s[2]-s[0])||1,o=Math.ceil(s[3]-s[1])||1,l=e.cachedCanvases.getCanvas("pattern",a,o),c=l.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-s[0],-s[1]),n=qn.transform(n,[1,0,0,1,s[0],s[1]]),c.transform(...e.baseTransform),this.matrix&&c.transform(...this.matrix),Vi(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),r=t.createPattern(l.canvas,"no-repeat");const d=new DOMMatrix(n);r.setTransform(d)}else Vi(t,this._bbox),r=this._createGradient(t);return r}}function $i(t,e,n,i,r,s,a,o){const l=e.coords,c=e.colors,d=t.data,h=4*t.width;let u;l[n+1]>l[i+1]&&(u=n,n=i,i=u,u=s,s=a,a=u),l[i+1]>l[r+1]&&(u=i,i=r,r=u,u=a,a=o,o=u),l[n+1]>l[i+1]&&(u=n,n=i,i=u,u=s,s=a,a=u);const p=(l[n]+e.offsetX)*e.scaleX,f=(l[n+1]+e.offsetY)*e.scaleY,g=(l[i]+e.offsetX)*e.scaleX,m=(l[i+1]+e.offsetY)*e.scaleY,v=(l[r]+e.offsetX)*e.scaleX,b=(l[r+1]+e.offsetY)*e.scaleY;if(f>=b)return;const y=c[s],_=c[s+1],w=c[s+2],A=c[a],x=c[a+1],E=c[a+2],S=c[o],T=c[o+1],C=c[o+2],k=Math.round(f),M=Math.round(b);let I,L,P,R,D,F,O,N;for(let t=k;t<=M;t++){if(t<m){const e=t<f?0:(f-t)/(f-m);I=p-(p-g)*e,L=y-(y-A)*e,P=_-(_-x)*e,R=w-(w-E)*e}else{let e;e=t>b?1:m===b?0:(m-t)/(m-b),I=g-(g-v)*e,L=A-(A-S)*e,P=x-(x-T)*e,R=E-(E-C)*e}let e;e=t<f?0:t>b?1:(f-t)/(f-b),D=p-(p-v)*e,F=y-(y-S)*e,O=_-(_-T)*e,N=w-(w-C)*e;const n=Math.round(Math.min(I,D)),i=Math.round(Math.max(I,D));let r=h*t+4*n;for(let t=n;t<=i;t++)e=(I-t)/(I-D),e<0?e=0:e>1&&(e=1),d[r++]=L-(L-F)*e|0,d[r++]=P-(P-O)*e|0,d[r++]=R-(R-N)*e|0,d[r++]=255}}function Xi(t,e,n){const i=e.coords,r=e.colors;let s,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(i.length/o)-1,c=o-1;for(s=0;s<l;s++){let e=s*o;for(let s=0;s<c;s++,e++)$i(t,n,i[e],i[e+1],i[e+o],r[e],r[e+1],r[e+o]),$i(t,n,i[e+o+1],i[e+1],i[e+o],r[e+o+1],r[e+1],r[e+o])}break;case"triangles":for(s=0,a=i.length;s<a;s+=3)$i(t,n,i[s],i[s+1],i[s+2],r[s],r[s+1],r[s+2]);break;default:throw new Error("illegal figure")}}class Ki extends Gi{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,n){const i=Math.floor(this._bounds[0]),r=Math.floor(this._bounds[1]),s=Math.ceil(this._bounds[2])-i,a=Math.ceil(this._bounds[3])-r,o=Math.min(Math.ceil(Math.abs(s*t[0]*1.1)),3e3),l=Math.min(Math.ceil(Math.abs(a*t[1]*1.1)),3e3),c=s/o,d=a/l,h={coords:this._coords,colors:this._colors,offsetX:-i,offsetY:-r,scaleX:1/c,scaleY:1/d},u=o+4,p=l+4,f=n.getCanvas("mesh",u,p),g=f.context,m=g.createImageData(o,l);if(e){const t=m.data;for(let n=0,i=t.length;n<i;n+=4)t[n]=e[0],t[n+1]=e[1],t[n+2]=e[2],t[n+3]=255}for(const t of this._figures)Xi(m,t,h);return g.putImageData(m,2,2),{canvas:f.canvas,offsetX:i-2*c,offsetY:r-2*d,scaleX:c,scaleY:d}}getPattern(t,e,n,i){let r;if(Vi(t,this._bbox),i===Ui)r=qn.singularValueDecompose2dScale(ai(t));else if(r=qn.singularValueDecompose2dScale(e.baseTransform),this.matrix){const t=qn.singularValueDecompose2dScale(this.matrix);r=[r[0]*t[0],r[1]*t[1]]}const s=this._createMeshCanvas(r,i===Ui?null:this._background,e.cachedCanvases);return i!==Ui&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(s.offsetX,s.offsetY),t.scale(s.scaleX,s.scaleY),t.createPattern(s.canvas,"no-repeat")}}class Yi extends Gi{getPattern(){return"hotpink"}}class Qi{static MAX_PATTERN_SIZE=3e3;constructor(t,e,n,i,r){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=n,this.canvasGraphicsFactory=i,this.baseTransform=r}createPatternCanvas(t){const{bbox:e,operatorList:n,paintType:i,tilingType:r,color:s,canvasGraphicsFactory:a}=this;let{xstep:o,ystep:l}=this;o=Math.abs(o),l=Math.abs(l),_n("TilingType: "+r);const c=e[0],d=e[1],h=e[2],u=e[3],p=h-c,f=u-d,g=qn.singularValueDecompose2dScale(this.matrix),m=qn.singularValueDecompose2dScale(this.baseTransform),v=g[0]*m[0],b=g[1]*m[1];let y=p,_=f,w=!1,A=!1;const x=Math.ceil(o*v),E=Math.ceil(l*b);x>=Math.ceil(p*v)?y=o:w=!0,E>=Math.ceil(f*b)?_=l:A=!0;const S=this.getSizeAndScale(y,this.ctx.canvas.width,v),T=this.getSizeAndScale(_,this.ctx.canvas.height,b),C=t.cachedCanvases.getCanvas("pattern",S.size,T.size),k=C.context,M=a.createCanvasGraphics(k);if(M.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(M,i,s),k.translate(-S.scale*c,-T.scale*d),M.transform(S.scale,0,0,T.scale,0,0),k.save(),this.clipBbox(M,c,d,h,u),M.baseTransform=ai(M.ctx),M.executeOperatorList(n),M.endDrawing(),k.restore(),w||A){const e=C.canvas;w&&(y=o),A&&(_=l);const n=this.getSizeAndScale(y,this.ctx.canvas.width,v),i=this.getSizeAndScale(_,this.ctx.canvas.height,b),r=n.size,s=i.size,a=t.cachedCanvases.getCanvas("pattern-workaround",r,s),h=a.context,u=w?Math.floor(p/o):0,g=A?Math.floor(f/l):0;for(let t=0;t<=u;t++)for(let n=0;n<=g;n++)h.drawImage(e,r*t,s*n,r,s,0,0,r,s);return{canvas:a.canvas,scaleX:n.scale,scaleY:i.scale,offsetX:c,offsetY:d}}return{canvas:C.canvas,scaleX:S.scale,scaleY:T.scale,offsetX:c,offsetY:d}}getSizeAndScale(t,e,n){const i=Math.max(Qi.MAX_PATTERN_SIZE,e);let r=Math.ceil(t*n);return r>=i?r=i:n=r/t,{scale:n,size:r}}clipBbox(t,e,n,i,r){const s=i-e,a=r-n;t.ctx.rect(e,n,s,a),t.current.updateRectMinMax(ai(t.ctx),[e,n,i,r]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const i=t.ctx,r=t.current;switch(e){case 1:const t=this.ctx;i.fillStyle=t.fillStyle,i.strokeStyle=t.strokeStyle,r.fillColor=t.fillStyle,r.strokeColor=t.strokeStyle;break;case 2:const s=qn.makeHexColor(n[0],n[1],n[2]);i.fillStyle=s,i.strokeStyle=s,r.fillColor=s,r.strokeColor=s;break;default:throw new Pn(`Unsupported paint type: ${e}`)}}getPattern(t,e,n,i){let r=n;i!==Ui&&(r=qn.transform(r,e.baseTransform),this.matrix&&(r=qn.transform(r,this.matrix)));const s=this.createPatternCanvas(e);let a=new DOMMatrix(r);a=a.translate(s.offsetX,s.offsetY),a=a.scale(1/s.scaleX,1/s.scaleY);const o=t.createPattern(s.canvas,"repeat");return o.setTransform(a),o}}function Ji({src:t,srcPos:e=0,dest:n,width:i,height:r,nonBlackColor:s=4294967295,inverseDecode:a=!1}){const o=Nn.isLittleEndian?4278190080:255,[l,c]=a?[s,o]:[o,s],d=i>>3,h=7&i,u=t.length;n=new Uint32Array(n.buffer);let p=0;for(let i=0;i<r;i++){for(const i=e+d;e<i;e++){const i=e<u?t[e]:255;n[p++]=128&i?c:l,n[p++]=64&i?c:l,n[p++]=32&i?c:l,n[p++]=16&i?c:l,n[p++]=8&i?c:l,n[p++]=4&i?c:l,n[p++]=2&i?c:l,n[p++]=1&i?c:l}if(0===h)continue;const i=e<u?t[e++]:255;for(let t=0;t<h;t++)n[p++]=i&1<<7-t?c:l}return{srcPos:e,destPos:p}}const Zi=16;class tr{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let i;return void 0!==this.cache[t]?(i=this.cache[t],this.canvasFactory.reset(i,e,n)):(i=this.canvasFactory.create(e,n),this.cache[t]=i),i}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function er(t,e,n,i,r,s,a,o,l,c){const[d,h,u,p,f,g]=ai(t);if(0===h&&0===u){const m=a*d+f,v=Math.round(m),b=o*p+g,y=Math.round(b),_=(a+l)*d+f,w=Math.abs(Math.round(_)-v)||1,A=(o+c)*p+g,x=Math.abs(Math.round(A)-y)||1;return t.setTransform(Math.sign(d),0,0,Math.sign(p),v,y),t.drawImage(e,n,i,r,s,0,0,w,x),t.setTransform(d,h,u,p,f,g),[w,x]}if(0===d&&0===p){const m=o*u+f,v=Math.round(m),b=a*h+g,y=Math.round(b),_=(o+c)*u+f,w=Math.abs(Math.round(_)-v)||1,A=(a+l)*h+g,x=Math.abs(Math.round(A)-y)||1;return t.setTransform(0,Math.sign(h),Math.sign(u),0,v,y),t.drawImage(e,n,i,r,s,0,0,x,w),t.setTransform(d,h,u,p,f,g),[x,w]}return t.drawImage(e,n,i,r,s,a,o,l,c),[Math.hypot(d,h)*l,Math.hypot(u,p)*c]}class nr{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=an,this.textMatrixScale=1,this.fontMatrix=on,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=0,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,n){[e,n]=qn.applyTransform([e,n],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(t,e){const n=qn.applyTransform(e,t),i=qn.applyTransform(e.slice(2),t),r=qn.applyTransform([e[0],e[3]],t),s=qn.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,n[0],i[0],r[0],s[0]),this.minY=Math.min(this.minY,n[1],i[1],r[1],s[1]),this.maxX=Math.max(this.maxX,n[0],i[0],r[0],s[0]),this.maxY=Math.max(this.maxY,n[1],i[1],r[1],s[1])}updateScalingPathMinMax(t,e){qn.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,n,i,r,s,a,o,l,c){const d=qn.bezierBoundingBox(e,n,i,r,s,a,o,l,c);c||this.updateRectMinMax(t,d)}getPathBoundingBox(t=ji,e=null){const n=[this.minX,this.minY,this.maxX,this.maxY];if(t===zi){e||An("Stroke bounding box must include transform.");const t=qn.singularValueDecompose2dScale(e),i=t[0]*this.lineWidth/2,r=t[1]*this.lineWidth/2;n[0]-=i,n[1]-=r,n[2]+=i,n[3]+=r}return n}updateClipFromPath(){const t=qn.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=ji,e=null){return qn.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function ir(t,e){if("undefined"!=typeof ImageData&&e instanceof ImageData)return void t.putImageData(e,0,0);const n=e.height,i=e.width,r=n%Zi,s=(n-r)/Zi,a=0===r?s:s+1,o=t.createImageData(i,Zi);let l,c=0;const d=e.data,h=o.data;let u,p,f,g;if(e.kind===pn.GRAYSCALE_1BPP){const e=d.byteLength,n=new Uint32Array(h.buffer,0,h.byteLength>>2),g=n.length,m=i+7>>3,v=4294967295,b=Nn.isLittleEndian?4278190080:255;for(u=0;u<a;u++){for(f=u<s?Zi:r,l=0,p=0;p<f;p++){const t=e-c;let r=0;const s=t>m?i:8*t-7,a=-8&s;let o=0,h=0;for(;r<a;r+=8)h=d[c++],n[l++]=128&h?v:b,n[l++]=64&h?v:b,n[l++]=32&h?v:b,n[l++]=16&h?v:b,n[l++]=8&h?v:b,n[l++]=4&h?v:b,n[l++]=2&h?v:b,n[l++]=1&h?v:b;for(;r<s;r++)0===o&&(h=d[c++],o=128),n[l++]=h&o?v:b,o>>=1}for(;l<g;)n[l++]=0;t.putImageData(o,0,u*Zi)}}else if(e.kind===pn.RGBA_32BPP){for(p=0,g=i*Zi*4,u=0;u<s;u++)h.set(d.subarray(c,c+g)),c+=g,t.putImageData(o,0,p),p+=Zi;u<a&&(g=i*r*4,h.set(d.subarray(c,c+g)),t.putImageData(o,0,p))}else{if(e.kind!==pn.RGB_24BPP)throw new Error(`bad image kind: ${e.kind}`);for(f=Zi,g=i*f,u=0;u<a;u++){for(u>=s&&(f=r,g=i*f),l=0,p=g;p--;)h[l++]=d[c++],h[l++]=d[c++],h[l++]=d[c++],h[l++]=255;t.putImageData(o,0,u*Zi)}}}function rr(t,e){if(e.bitmap)return void t.drawImage(e.bitmap,0,0);const n=e.height,i=e.width,r=n%Zi,s=(n-r)/Zi,a=0===r?s:s+1,o=t.createImageData(i,Zi);let l=0;const c=e.data,d=o.data;for(let e=0;e<a;e++){const n=e<s?Zi:r;({srcPos:l}=Ji({src:c,srcPos:l,dest:d,width:i,height:n,nonBlackColor:0})),t.putImageData(o,0,e*Zi)}}function sr(t,e){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of n)void 0!==t[i]&&(e[i]=t[i]);void 0!==t.setLineDash&&(e.setLineDash(t.getLineDash()),e.lineDashOffset=t.lineDashOffset)}function ar(t){if(t.strokeStyle=t.fillStyle="#000000",t.fillRule="nonzero",t.globalAlpha=1,t.lineWidth=1,t.lineCap="butt",t.lineJoin="miter",t.miterLimit=10,t.globalCompositeOperation="source-over",t.font="10px sans-serif",void 0!==t.setLineDash&&(t.setLineDash([]),t.lineDashOffset=0),!sn){const{filter:e}=t;"none"!==e&&""!==e&&(t.filter="none")}}function or(t,e){if(e)return!0;const n=qn.singularValueDecompose2dScale(t);n[0]=Math.fround(n[0]),n[1]=Math.fround(n[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*Gn.PDF_TO_CSS_UNITS);return n[0]<=i&&n[1]<=i}const lr=["butt","round","square"],cr=["miter","round","bevel"],dr={},hr={};class ur{constructor(t,e,n,i,r,{optionalContentConfig:s,markedContentStack:a=null},o,l){this.ctx=t,this.current=new nr(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=s,this.cachedCanvases=new tr(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=o,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=l,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return"string"==typeof t?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:n=!1,background:i=null}){const r=this.ctx.canvas.width,s=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,s),this.ctx.fillStyle=a,n){const t=this.cachedCanvases.getCanvas("transparent",r,s);this.compositeCtx=this.ctx,this.transparentCanvas=t.canvas,this.ctx=t.context,this.ctx.save(),this.ctx.transform(...ai(this.compositeCtx))}this.ctx.save(),ar(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=ai(this.ctx)}executeOperatorList(t,e,n,i){const r=t.argsArray,s=t.fnArray;let a=e||0;const o=r.length;if(o===a)return a;const l=o-a>10&&"function"==typeof n,c=l?Date.now()+15:0;let d=0;const h=this.commonObjs,u=this.objs;let p;for(;;){if(void 0!==i&&a===i.nextBreakPoint)return i.breakIt(a,n),a;if(p=s[a],p!==gn.dependency)this[p].apply(this,r[a]);else for(const t of r[a]){const e=t.startsWith("g_")?h:u;if(!e.has(t))return e.get(t,n),a}if(a++,a===o)return a;if(l&&++d>10){if(Date.now()>c)return n(),a;d=0}}}#Oe(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#Oe(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#Ne()}#Ne(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==t){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const n=t.width??t.displayWidth,i=t.height??t.displayHeight;let r,s,a=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),l=n,c=i,d="prescale1";for(;a>2&&l>1||o>2&&c>1;){let e=l,n=c;a>2&&l>1&&(e=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),a/=l/e),o>2&&c>1&&(n=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,o/=c/n),r=this.cachedCanvases.getCanvas(d,e,n),s=r.context,s.clearRect(0,0,e,n),s.drawImage(t,0,0,l,c,0,0,e,n),t=r.canvas,l=e,c=n,d="prescale1"===d?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:c}}_createMaskCanvas(t){const e=this.ctx,{width:n,height:i}=t,r=this.current.fillColor,s=this.current.patternFill,a=ai(e);let o,l,c,d;if((t.bitmap||t.data)&&t.count>1){const e=t.bitmap||t.data.buffer;l=JSON.stringify(s?a:[a.slice(0,4),r]),o=this._cachedBitmapsMap.get(e),o||(o=new Map,this._cachedBitmapsMap.set(e,o));const n=o.get(l);if(n&&!s)return{canvas:n,offsetX:Math.round(Math.min(a[0],a[2])+a[4]),offsetY:Math.round(Math.min(a[1],a[3])+a[5])};c=n}c||(d=this.cachedCanvases.getCanvas("maskCanvas",n,i),rr(d.context,t));let h=qn.transform(a,[1/n,0,0,-1/i,0,0]);h=qn.transform(h,[1,0,0,1,0,-i]);const[u,p,f,g]=qn.getAxialAlignedBoundingBox([0,0,n,i],h),m=Math.round(f-u)||1,v=Math.round(g-p)||1,b=this.cachedCanvases.getCanvas("fillCanvas",m,v),y=b.context,_=u,w=p;y.translate(-_,-w),y.transform(...h),c||(c=this._scaleImage(d.canvas,oi(y)),c=c.img,o&&s&&o.set(l,c)),y.imageSmoothingEnabled=or(ai(y),t.interpolate),er(y,c,0,0,c.width,c.height,0,0,n,i),y.globalCompositeOperation="source-in";const A=qn.transform(oi(y),[1,0,0,1,-_,-w]);return y.fillStyle=s?r.getPattern(e,this,A,ji):r,y.fillRect(0,0,n,i),o&&!s&&(this.cachedCanvases.delete("fillCanvas"),o.set(l,b.canvas)),{canvas:b.canvas,offsetX:Math.round(_),offsetY:Math.round(w)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=lr[t]}setLineJoin(t){this.ctx.lineJoin=cr[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const n=this.ctx;void 0!==n.setLineDash&&(n.setLineDash(t),n.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,n]of t)switch(e){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(n,t,e);this.suspendedCtx=this.ctx,this.ctx=i.context;const r=this.ctx;r.setTransform(...ai(this.suspendedCtx)),sr(this.suspendedCtx,r),function(t,e){if(t._removeMirroring)throw new Error("Context is already forwarding operations.");t.__originalSave=t.save,t.__originalRestore=t.restore,t.__originalRotate=t.rotate,t.__originalScale=t.scale,t.__originalTranslate=t.translate,t.__originalTransform=t.transform,t.__originalSetTransform=t.setTransform,t.__originalResetTransform=t.resetTransform,t.__originalClip=t.clip,t.__originalMoveTo=t.moveTo,t.__originalLineTo=t.lineTo,t.__originalBezierCurveTo=t.bezierCurveTo,t.__originalRect=t.rect,t.__originalClosePath=t.closePath,t.__originalBeginPath=t.beginPath,t._removeMirroring=()=>{t.save=t.__originalSave,t.restore=t.__originalRestore,t.rotate=t.__originalRotate,t.scale=t.__originalScale,t.translate=t.__originalTranslate,t.transform=t.__originalTransform,t.setTransform=t.__originalSetTransform,t.resetTransform=t.__originalResetTransform,t.clip=t.__originalClip,t.moveTo=t.__originalMoveTo,t.lineTo=t.__originalLineTo,t.bezierCurveTo=t.__originalBezierCurveTo,t.rect=t.__originalRect,t.closePath=t.__originalClosePath,t.beginPath=t.__originalBeginPath,delete t._removeMirroring},t.save=function(){e.save(),this.__originalSave()},t.restore=function(){e.restore(),this.__originalRestore()},t.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},t.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},t.transform=function(t,n,i,r,s,a){e.transform(t,n,i,r,s,a),this.__originalTransform(t,n,i,r,s,a)},t.setTransform=function(t,n,i,r,s,a){e.setTransform(t,n,i,r,s,a),this.__originalSetTransform(t,n,i,r,s,a)},t.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},t.rotate=function(t){e.rotate(t),this.__originalRotate(t)},t.clip=function(t){e.clip(t),this.__originalClip(t)},t.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},t.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},t.bezierCurveTo=function(t,n,i,r,s,a){e.bezierCurveTo(t,n,i,r,s,a),this.__originalBezierCurveTo(t,n,i,r,s,a)},t.rect=function(t,n,i,r){e.rect(t,n,i,r),this.__originalRect(t,n,i,r)},t.closePath=function(){e.closePath(),this.__originalClosePath()},t.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),sr(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,i){const r=i[0],s=i[1],a=i[2]-r,o=i[3]-s;0!==a&&0!==o&&(this.genericComposeSMask(e.context,n,a,o,e.subtype,e.backdrop,e.transferMap,r,s,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,i,r,s,a,o,l,c,d){let h=t.canvas,u=o-c,p=l-d;if(s){const e=qn.makeHexColor(...s);if(u<0||p<0||u+n>h.width||p+i>h.height){const t=this.cachedCanvases.getCanvas("maskExtension",n,i),r=t.context;r.drawImage(h,-u,-p),r.globalCompositeOperation="destination-atop",r.fillStyle=e,r.fillRect(0,0,n,i),r.globalCompositeOperation="source-over",h=t.canvas,u=p=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const r=new Path2D;r.rect(u,p,n,i),t.clip(r),t.globalCompositeOperation="destination-atop",t.fillStyle=e,t.fillRect(u,p,n,i),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),"Alpha"===r&&a?e.filter=this.filterFactory.addAlphaFilter(a):"Luminosity"===r&&(e.filter=this.filterFactory.addLuminosityFilter(a));const f=new Path2D;f.rect(o,l,n,i),e.clip(f),e.globalCompositeOperation="destination-in",e.drawImage(h,u,p,n,i,o,l,n,i),e.restore()}save(){this.inSMaskMode?(sr(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),sr(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,n,i,r,s){this.ctx.transform(t,e,n,i,r,s),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n){const i=this.ctx,r=this.current;let s,a,o=r.x,l=r.y;const c=ai(i),d=0===c[0]&&0===c[3]||0===c[1]&&0===c[2],h=d?n.slice(0):null;for(let n=0,u=0,p=t.length;n<p;n++)switch(0|t[n]){case gn.rectangle:o=e[u++],l=e[u++];const t=e[u++],n=e[u++],p=o+t,f=l+n;i.moveTo(o,l),0===t||0===n?i.lineTo(p,f):(i.lineTo(p,l),i.lineTo(p,f),i.lineTo(o,f)),d||r.updateRectMinMax(c,[o,l,p,f]),i.closePath();break;case gn.moveTo:o=e[u++],l=e[u++],i.moveTo(o,l),d||r.updatePathMinMax(c,o,l);break;case gn.lineTo:o=e[u++],l=e[u++],i.lineTo(o,l),d||r.updatePathMinMax(c,o,l);break;case gn.curveTo:s=o,a=l,o=e[u+4],l=e[u+5],i.bezierCurveTo(e[u],e[u+1],e[u+2],e[u+3],o,l),r.updateCurvePathMinMax(c,s,a,e[u],e[u+1],e[u+2],e[u+3],o,l,h),u+=6;break;case gn.curveTo2:s=o,a=l,i.bezierCurveTo(o,l,e[u],e[u+1],e[u+2],e[u+3]),r.updateCurvePathMinMax(c,s,a,o,l,e[u],e[u+1],e[u+2],e[u+3],h),o=e[u+2],l=e[u+3],u+=4;break;case gn.curveTo3:s=o,a=l,o=e[u+2],l=e[u+3],i.bezierCurveTo(e[u],e[u+1],o,l,o,l),r.updateCurvePathMinMax(c,s,a,e[u],e[u+1],o,l,o,l,h),u+=4;break;case gn.closePath:i.closePath()}d&&r.updateScalingPathMinMax(c,h),r.setCurrentPoint(o,l)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,n=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"==typeof n&&n?.getPattern?(e.save(),e.strokeStyle=n.getPattern(e,this,oi(e),zi),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,n=this.current.fillColor;let i=!1;this.current.patternFill&&(e.save(),e.fillStyle=n.getPattern(e,this,oi(e),ji),i=!0);const r=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==r&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),i&&e.restore(),t&&this.consumePath(r)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=dr}eoClip(){this.pendingClip=hr}beginText(){this.current.textMatrix=an,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(void 0!==t){e.save(),e.beginPath();for(const n of t)e.setTransform(...n.transform),e.translate(n.x,n.y),n.addToPath(e,n.fontSize);e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}else e.beginPath()}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){const n=this.commonObjs.get(t),i=this.current;if(!n)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=n.fontMatrix||on,0!==i.fontMatrix[0]&&0!==i.fontMatrix[3]||wn("Invalid font matrix for font "+t),e<0?(e=-e,i.fontDirection=-1):i.fontDirection=1,this.current.font=n,this.current.fontSize=e,n.isType3Font)return;const r=n.loadedName||"sans-serif",s=n.systemFontInfo?.css||`"${r}", ${n.fallbackName}`;let a="normal";n.black?a="900":n.bold&&(a="bold");const o=n.italic?"italic":"normal";let l=e;e<16?l=16:e>100&&(l=100),this.current.fontSizeScale=e/l,this.ctx.font=`${o} ${a} ${l}px ${s}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,n,i,r,s){this.current.textMatrix=[t,e,n,i,r,s],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,n,i){const r=this.ctx,s=this.current,a=s.font,o=s.textRenderingMode,l=s.fontSize/s.fontSizeScale,c=3&o,d=!!(4&o),h=s.patternFill&&!a.missingFile;let u;(a.disableFontFace||d||h)&&(u=a.getPathGenerator(this.commonObjs,t)),a.disableFontFace||h?(r.save(),r.translate(e,n),r.beginPath(),u(r,l),i&&r.setTransform(...i),0!==c&&2!==c||r.fill(),1!==c&&2!==c||r.stroke(),r.restore()):(0!==c&&2!==c||r.fillText(t,e,n),1!==c&&2!==c||r.strokeText(t,e,n)),d&&(this.pendingTextPaths||=[]).push({transform:ai(r),x:e,y:n,fontSize:l,addToPath:u})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let t=3;t<e.length;t+=4)if(e[t]>0&&e[t]<255){n=!0;break}return Sn(this,"isFontSubpixelAAEnabled",n)}showText(t){const e=this.current,n=e.font;if(n.isType3Font)return this.showType3Text(t);const i=e.fontSize;if(0===i)return;const r=this.ctx,s=e.fontSizeScale,a=e.charSpacing,o=e.wordSpacing,l=e.fontDirection,c=e.textHScale*l,d=t.length,h=n.vertical,u=h?1:-1,p=n.defaultVMetrics,f=i*e.fontMatrix[0],g=0===e.textRenderingMode&&!n.disableFontFace&&!e.patternFill;let m;if(r.save(),r.transform(...e.textMatrix),r.translate(e.x,e.y+e.textRise),l>0?r.scale(c,-1):r.scale(c,1),e.patternFill){r.save();const t=e.fillColor.getPattern(r,this,oi(r),ji);m=ai(r),r.restore(),r.fillStyle=t}let v=e.lineWidth;const b=e.textMatrixScale;if(0===b||0===v){const t=3&e.textRenderingMode;1!==t&&2!==t||(v=this.getSinglePixelWidth())}else v/=b;if(1!==s&&(r.scale(s,s),v/=s),r.lineWidth=v,n.isInvalidPDFjsFont){const n=[];let i=0;for(const e of t)n.push(e.unicode),i+=e.width;return r.fillText(n.join(""),0,0),e.x+=i*f*c,r.restore(),void this.compose()}let y,_=0;for(y=0;y<d;++y){const e=t[y];if("number"==typeof e){_+=u*e*i/1e3;continue}let c=!1;const d=(e.isSpace?o:0)+a,v=e.fontChar,b=e.accent;let w,A,x=e.width;if(h){const t=e.vmetric||p,n=-(e.vmetric?t[1]:.5*x)*f,i=t[2]*f;x=t?-t[0]:x,w=n/s,A=(_+i)/s}else w=_/s,A=0;if(n.remeasure&&x>0){const t=1e3*r.measureText(v).width/i*s;if(x<t&&this.isFontSubpixelAAEnabled){const e=x/t;c=!0,r.save(),r.scale(e,1),w/=e}else x!==t&&(w+=(x-t)/2e3*i/s)}if(this.contentVisible&&(e.isInFont||n.missingFile))if(g&&!b)r.fillText(v,w,A);else if(this.paintChar(v,w,A,m),b){const t=w+i*b.offset.x/s,e=A-i*b.offset.y/s;this.paintChar(b.fontChar,t,e,m)}_+=h?x*f-d*l:x*f+d*l,c&&r.restore()}h?e.y-=_:e.x+=_*c,r.restore(),this.compose()}showType3Text(t){const e=this.ctx,n=this.current,i=n.font,r=n.fontSize,s=n.fontDirection,a=i.vertical?1:-1,o=n.charSpacing,l=n.wordSpacing,c=n.textHScale*s,d=n.fontMatrix||on,h=t.length;let u,p,f,g;if(3!==n.textRenderingMode&&0!==r){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...n.textMatrix),e.translate(n.x,n.y),e.scale(c,s),u=0;u<h;++u){if(p=t[u],"number"==typeof p){g=a*p*r/1e3,this.ctx.translate(g,0),n.x+=g*c;continue}const s=(p.isSpace?l:0)+o,h=i.charProcOperatorList[p.operatorListId];h?(this.contentVisible&&(this.processingType3=p,this.save(),e.scale(r,r),e.transform(...d),this.executeOperatorList(h),this.restore()),f=qn.applyTransform([p.width,0],d)[0]*r+s,e.translate(f,0),n.x+=f*c):wn(`Type3 character "${p.operatorListId}" is not available.`)}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,n,i,r,s){this.ctx.rect(n,i,r-n,s-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if("TilingPattern"===t[0]){const n=t[1],i=this.baseTransform||ai(this.ctx),r={createCanvasGraphics:t=>new ur(t,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new Qi(t,n,this.ctx,r,i)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,n){this.ctx.strokeStyle=this.current.strokeColor=qn.makeHexColor(t,e,n)}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent"}setFillRGBColor(t,e,n){this.ctx.fillStyle=this.current.fillColor=qn.makeHexColor(t,e,n),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let n;return this.cachedPatterns.has(t)?n=this.cachedPatterns.get(t):(n=function(t){switch(t[0]){case"RadialAxial":return new Wi(t);case"Mesh":return new Ki(t);case"Dummy":return new Yi}throw new Error(`Unknown IR type: ${t[0]}`)}(this.getObject(t)),this.cachedPatterns.set(t,n)),e&&(n.matrix=e),n}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const n=this._getPattern(t);e.fillStyle=n.getPattern(e,this,oi(e),Ui);const i=oi(e);if(i){const{width:t,height:n}=e.canvas,[r,s,a,o]=qn.getAxialAlignedBoundingBox([0,0,t,n],i);this.ctx.fillRect(r,s,a-r,o-s)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){An("Should not call beginInlineImage")}beginImageData(){An("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=ai(this.ctx),e)){const t=e[2]-e[0],n=e[3]-e[1];this.ctx.rect(e[0],e[1],t,n),this.current.updateRectMinMax(ai(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||_n("TODO: Support non-isolated groups."),t.knockout&&wn("Knockout groups not supported.");const n=ai(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=qn.getAxialAlignedBoundingBox(t.bbox,ai(e));const r=[0,0,e.canvas.width,e.canvas.height];i=qn.intersect(i,r)||[0,0,0,0];const s=Math.floor(i[0]),a=Math.floor(i[1]),o=Math.max(Math.ceil(i[2])-s,1),l=Math.max(Math.ceil(i[3])-a,1);this.current.startNewPathAndClipBox([0,0,o,l]);let c="groupAt"+this.groupLevel;t.smask&&(c+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(c,o,l),h=d.context;h.translate(-s,-a),h.transform(...n),t.smask?this.smaskStack.push({canvas:d.canvas,context:h,offsetX:s,offsetY:a,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(s,a),e.save()),sr(e,h),this.ctx=h,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const t=ai(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...t);const n=qn.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],t);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(t,e,n,i,r){if(this.#Oe(),ar(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const i=e[2]-e[0],s=e[3]-e[1];if(r&&this.annotationCanvasMap){(n=n.slice())[4]-=e[0],n[5]-=e[1],(e=e.slice())[0]=e[1]=0,e[2]=i,e[3]=s;const[r,a]=qn.singularValueDecompose2dScale(ai(this.ctx)),{viewportScale:o}=this,l=Math.ceil(i*this.outputScaleX*o),c=Math.ceil(s*this.outputScaleY*o);this.annotationCanvas=this.canvasFactory.create(l,c);const{canvas:d,context:h}=this.annotationCanvas;this.annotationCanvasMap.set(t,d),this.annotationCanvas.savedCtx=this.ctx,this.ctx=h,this.ctx.save(),this.ctx.setTransform(r,0,0,-a,0,s*a),ar(this.ctx)}else ar(this.ctx),this.endPath(),this.ctx.rect(e[0],e[1],i,s),this.ctx.clip(),this.ctx.beginPath()}this.current=new nr(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#Ne(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;(t=this.getObject(t.data,t)).count=e;const n=this.ctx,i=this.processingType3;if(i&&(void 0===i.compiled&&(i.compiled=function(t){const{width:e,height:n}=t;if(e>1e3||n>1e3)return null;const i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1;let s,a,o,l=new Uint8Array(r*(n+1));const c=e+7&-8;let d=new Uint8Array(c*n),h=0;for(const e of t.data){let t=128;for(;t>0;)d[h++]=e&t?0:255,t>>=1}let u=0;for(h=0,0!==d[h]&&(l[0]=1,++u),a=1;a<e;a++)d[h]!==d[h+1]&&(l[a]=d[h]?2:1,++u),h++;for(0!==d[h]&&(l[a]=2,++u),s=1;s<n;s++){h=s*c,o=s*r,d[h-c]!==d[h]&&(l[o]=d[h]?1:8,++u);let t=(d[h]?4:0)+(d[h-c]?8:0);for(a=1;a<e;a++)t=(t>>2)+(d[h+1]?4:0)+(d[h-c+1]?8:0),i[t]&&(l[o+a]=i[t],++u),h++;if(d[h-c]!==d[h]&&(l[o+a]=d[h]?2:4,++u),u>1e3)return null}for(h=c*(n-1),o=s*r,0!==d[h]&&(l[o]=8,++u),a=1;a<e;a++)d[h]!==d[h+1]&&(l[o+a]=d[h]?4:8,++u),h++;if(0!==d[h]&&(l[o+a]=4,++u),u>1e3)return null;const p=new Int32Array([0,r,-1,0,-r,0,0,0,1]),f=new Path2D;for(s=0;u&&s<=n;s++){let t=s*r;const n=t+e;for(;t<n&&!l[t];)t++;if(t===n)continue;f.moveTo(t%r,s);const i=t;let a=l[t];do{const e=p[a];do{t+=e}while(!l[t]);const n=l[t];5!==n&&10!==n?(a=n,l[t]=0):(a=n&51*a>>4,l[t]&=a>>2|a<<2),f.lineTo(t%r,t/r|0),l[t]||--u}while(i!==t);--s}return d=null,l=null,function(t){t.save(),t.scale(1/e,-1/n),t.translate(0,-n),t.fill(f),t.beginPath(),t.restore()}}(t)),i.compiled))return void i.compiled(n);const r=this._createMaskCanvas(t),s=r.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(s,r.offsetX,r.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,n=0,i=0,r,s){if(!this.contentVisible)return;t=this.getObject(t.data,t);const a=this.ctx;a.save();const o=ai(a);a.transform(e,n,i,r,0,0);const l=this._createMaskCanvas(t);a.setTransform(1,0,0,1,l.offsetX-o[4],l.offsetY-o[5]);for(let t=0,c=s.length;t<c;t+=2){const c=qn.transform(o,[e,n,i,r,s[t],s[t+1]]),[d,h]=qn.applyTransform([0,0],c);a.drawImage(l.canvas,d,h)}a.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,n=this.current.fillColor,i=this.current.patternFill;for(const r of t){const{data:t,width:s,height:a,transform:o}=r,l=this.cachedCanvases.getCanvas("maskCanvas",s,a),c=l.context;c.save(),rr(c,this.getObject(t,r)),c.globalCompositeOperation="source-in",c.fillStyle=i?n.getPattern(c,this,oi(e),ji):n,c.fillRect(0,0,s,a),c.restore(),e.save(),e.transform(...o),e.scale(1,-1),er(e,l.canvas,0,0,s,a,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);e?this.paintInlineImageXObject(e):wn("Dependent image isn't ready yet")}paintImageXObjectRepeat(t,e,n,i){if(!this.contentVisible)return;const r=this.getObject(t);if(!r)return void wn("Dependent image isn't ready yet");const s=r.width,a=r.height,o=[];for(let t=0,r=i.length;t<r;t+=2)o.push({transform:[e,0,0,n,i[t],i[t+1]],x:0,y:0,w:s,h:a});this.paintInlineImageXObjectGroup(r,o)}applyTransferMapsToCanvas(t){return"none"!==this.current.transferMaps&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if("none"===this.current.transferMaps)return t.bitmap;const{bitmap:e,width:n,height:i}=t,r=this.cachedCanvases.getCanvas("inlineImage",n,i),s=r.context;return s.filter=this.current.transferMaps,s.drawImage(e,0,0),s.filter="none",r.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,n=t.height,i=this.ctx;if(this.save(),!sn){const{filter:t}=i;"none"!==t&&""!==t&&(i.filter="none")}let r;if(i.scale(1/e,-1/n),t.bitmap)r=this.applyTransferMapsToBitmap(t);else if("function"==typeof HTMLElement&&t instanceof HTMLElement||!t.data)r=t;else{const i=this.cachedCanvases.getCanvas("inlineImage",e,n).context;ir(i,t),r=this.applyTransferMapsToCanvas(i)}const s=this._scaleImage(r,oi(i));i.imageSmoothingEnabled=or(ai(i),t.interpolate),er(i,s.img,0,0,s.paintWidth,s.paintHeight,0,-n,e,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const n=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const e=t.width,n=t.height,r=this.cachedCanvases.getCanvas("inlineImage",e,n).context;ir(r,t),i=this.applyTransferMapsToCanvas(r)}for(const t of e)n.save(),n.transform(...t.transform),n.scale(1,-1),er(n,i,t.x,t.y,t.w,t.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){"OC"===t?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const n=this.ctx;this.pendingClip&&(e||(this.pendingClip===hr?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ai(this.ctx);if(0===t[1]&&0===t[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),i=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:t}=this.current,{a:e,b:n,c:i,d:r}=this.ctx.getTransform();let s,a;if(0===n&&0===i){const n=Math.abs(e),i=Math.abs(r);if(n===i)if(0===t)s=a=1/n;else{const e=n*t;s=a=e<1?1/e:1}else if(0===t)s=1/n,a=1/i;else{const e=n*t,r=i*t;s=e<1?1/e:1,a=r<1?1/r:1}}else{const o=Math.abs(e*r-n*i),l=Math.hypot(e,n),c=Math.hypot(i,r);if(0===t)s=c/o,a=l/o;else{const e=t*o;s=c>e?c/e:1,a=l>e?l/e:1}}this._cachedScaleForStroking[0]=s,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:n}=this.current,[i,r]=this.getScaleForStroking();if(e.lineWidth=n||1,1===i&&1===r)return void e.stroke();const s=e.getLineDash();if(t&&e.save(),e.scale(i,r),s.length>0){const t=Math.max(i,r);e.setLineDash(s.map((e=>e/t))),e.lineDashOffset/=t}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const t in gn)void 0!==ur.prototype[t]&&(ur.prototype[gn[t]]=ur.prototype[t]);class pr{static#Be=null;static#qe="";static get workerPort(){return this.#Be}static set workerPort(t){if(!("undefined"!=typeof Worker&&t instanceof Worker)&&null!==t)throw new Error("Invalid `workerPort` type.");this.#Be=t}static get workerSrc(){return this.#qe}static set workerSrc(t){if("string"!=typeof t)throw new Error("Invalid `workerSrc` type.");this.#qe=t}}function fr(t){switch(t instanceof Error||"object"==typeof t&&null!==t||An('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),t.name){case"AbortException":return new Rn(t.message);case"MissingPDFException":return new In(t.message);case"PasswordException":return new Cn(t.message,t.code);case"UnexpectedResponseException":return new Ln(t.message,t.status);case"UnknownErrorException":return new kn(t.message,t.details);default:return new kn(t.message,t.toString())}}class gr{#He=new AbortController;constructor(t,e,n){this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#je.bind(this),{signal:this.#He.signal})}#je({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream)return void this.#ze(t);if(t.callback){const e=t.callbackId,n=this.callbackCapabilities[e];if(!n)throw new Error(`Cannot resolve callback ${e}`);if(delete this.callbackCapabilities[e],1===t.callback)n.resolve(t.data);else{if(2!==t.callback)throw new Error("Unexpected callback case");n.reject(fr(t.reason))}return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,i=t.sourceName,r=this.comObj;new Promise((function(n){n(e(t.data))})).then((function(e){r.postMessage({sourceName:n,targetName:i,callback:1,callbackId:t.callbackId,data:e})}),(function(e){r.postMessage({sourceName:n,targetName:i,callback:2,callbackId:t.callbackId,reason:fr(e)})}))}else t.streamId?this.#Ue(t):e(t.data)}on(t,e){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:i,data:e},n)}catch(t){r.reject(t)}return r.promise}sendWithStream(t,e,n,i){const r=this.streamId++,s=this.sourceName,a=this.targetName,o=this.comObj;return new ReadableStream({start:n=>{const l=Promise.withResolvers();return this.streamControllers[r]={controller:n,startCall:l,pullCall:null,cancelCall:null,isClosed:!1},o.postMessage({sourceName:s,targetName:a,action:t,streamId:r,data:e,desiredSize:n.desiredSize},i),l.promise},pull:t=>{const e=Promise.withResolvers();return this.streamControllers[r].pullCall=e,o.postMessage({sourceName:s,targetName:a,stream:6,streamId:r,desiredSize:t.desiredSize}),e.promise},cancel:t=>{xn(t instanceof Error,"cancel must have a valid reason");const e=Promise.withResolvers();return this.streamControllers[r].cancelCall=e,this.streamControllers[r].isClosed=!0,o.postMessage({sourceName:s,targetName:a,stream:1,streamId:r,reason:fr(t)}),e.promise}},n)}#Ue(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,r=this.comObj,s=this,a=this.actionHandler[t.action],o={enqueue(t,s=1,a){if(this.isCancelled)return;const o=this.desiredSize;this.desiredSize-=s,o>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:n,targetName:i,stream:4,streamId:e,chunk:t},a)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:n,targetName:i,stream:3,streamId:e}),delete s.streamSinks[e])},error(t){xn(t instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:n,targetName:i,stream:5,streamId:e,reason:fr(t)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};o.sinkCapability.resolve(),o.ready=o.sinkCapability.promise,this.streamSinks[e]=o,new Promise((function(e){e(a(t.data,o))})).then((function(){r.postMessage({sourceName:n,targetName:i,stream:8,streamId:e,success:!0})}),(function(t){r.postMessage({sourceName:n,targetName:i,stream:8,streamId:e,reason:fr(t)})}))}#ze(t){const e=t.streamId,n=this.sourceName,i=t.sourceName,r=this.comObj,s=this.streamControllers[e],a=this.streamSinks[e];switch(t.stream){case 8:t.success?s.startCall.resolve():s.startCall.reject(fr(t.reason));break;case 7:t.success?s.pullCall.resolve():s.pullCall.reject(fr(t.reason));break;case 6:if(!a){r.postMessage({sourceName:n,targetName:i,stream:7,streamId:e,success:!0});break}a.desiredSize<=0&&t.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=t.desiredSize,new Promise((function(t){t(a.onPull?.())})).then((function(){r.postMessage({sourceName:n,targetName:i,stream:7,streamId:e,success:!0})}),(function(t){r.postMessage({sourceName:n,targetName:i,stream:7,streamId:e,reason:fr(t)})}));break;case 4:if(xn(s,"enqueue should have stream controller"),s.isClosed)break;s.controller.enqueue(t.chunk);break;case 3:if(xn(s,"close should have stream controller"),s.isClosed)break;s.isClosed=!0,s.controller.close(),this.#Ve(s,e);break;case 5:xn(s,"error should have stream controller"),s.controller.error(fr(t.reason)),this.#Ve(s,e);break;case 2:t.success?s.cancelCall.resolve():s.cancelCall.reject(fr(t.reason)),this.#Ve(s,e);break;case 1:if(!a)break;new Promise((function(e){e(a.onCancel?.(fr(t.reason)))})).then((function(){r.postMessage({sourceName:n,targetName:i,stream:2,streamId:e,success:!0})}),(function(t){r.postMessage({sourceName:n,targetName:i,stream:2,streamId:e,reason:fr(t)})})),a.sinkCapability.reject(fr(t.reason)),a.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#Ve(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#He?.abort(),this.#He=null}}class mr{#Ge;#We;constructor({parsedData:t,rawData:e}){this.#Ge=t,this.#We=e}getRaw(){return this.#We}get(t){return this.#Ge.get(t)??null}getAll(){return On(this.#Ge)}has(t){return this.#Ge.has(t)}}const vr=Symbol("INTERNAL");class br{#$e=!1;#Xe=!1;#Ke=!1;#Ye=!0;constructor(t,{name:e,intent:n,usage:i,rbGroups:r}){this.#$e=!!(2&t),this.#Xe=!!(4&t),this.name=e,this.intent=n,this.usage=i,this.rbGroups=r}get visible(){if(this.#Ke)return this.#Ye;if(!this.#Ye)return!1;const{print:t,view:e}=this.usage;return this.#$e?"OFF"!==e?.viewState:!this.#Xe||"OFF"!==t?.printState}_setVisible(t,e,n=!1){t!==vr&&An("Internal method `_setVisible` called."),this.#Ke=n,this.#Ye=e}}class yr{#Qe=null;#Je=new Map;#Ze=null;#tn=null;constructor(t,e=2){if(this.renderingIntent=e,this.name=null,this.creator=null,null!==t){this.name=t.name,this.creator=t.creator,this.#tn=t.order;for(const n of t.groups)this.#Je.set(n.id,new br(e,n));if("OFF"===t.baseState)for(const t of this.#Je.values())t._setVisible(vr,!1);for(const e of t.on)this.#Je.get(e)._setVisible(vr,!0);for(const e of t.off)this.#Je.get(e)._setVisible(vr,!1);this.#Ze=this.getHash()}}#en(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let i=1;i<e;i++){const e=t[i];let r;if(Array.isArray(e))r=this.#en(e);else{if(!this.#Je.has(e))return wn(`Optional content group not found: ${e}`),!0;r=this.#Je.get(e).visible}switch(n){case"And":if(!r)return!1;break;case"Or":if(r)return!0;break;case"Not":return!r;default:return!0}}return"And"===n}isVisible(t){if(0===this.#Je.size)return!0;if(!t)return _n("Optional content group not defined."),!0;if("OCG"===t.type)return this.#Je.has(t.id)?this.#Je.get(t.id).visible:(wn(`Optional content group not found: ${t.id}`),!0);if("OCMD"===t.type){if(t.expression)return this.#en(t.expression);if(!t.policy||"AnyOn"===t.policy){for(const e of t.ids){if(!this.#Je.has(e))return wn(`Optional content group not found: ${e}`),!0;if(this.#Je.get(e).visible)return!0}return!1}if("AllOn"===t.policy){for(const e of t.ids){if(!this.#Je.has(e))return wn(`Optional content group not found: ${e}`),!0;if(!this.#Je.get(e).visible)return!1}return!0}if("AnyOff"===t.policy){for(const e of t.ids){if(!this.#Je.has(e))return wn(`Optional content group not found: ${e}`),!0;if(!this.#Je.get(e).visible)return!0}return!1}if("AllOff"===t.policy){for(const e of t.ids){if(!this.#Je.has(e))return wn(`Optional content group not found: ${e}`),!0;if(this.#Je.get(e).visible)return!1}return!0}return wn(`Unknown optional content policy ${t.policy}.`),!0}return wn(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,n=!0){const i=this.#Je.get(t);if(i){if(n&&e&&i.rbGroups.length)for(const e of i.rbGroups)for(const n of e)n!==t&&this.#Je.get(n)?._setVisible(vr,!1,!0);i._setVisible(vr,!!e,!0),this.#Qe=null}else wn(`Optional content group not found: ${t}`)}setOCGState({state:t,preserveRB:e}){let n;for(const i of t){switch(i){case"ON":case"OFF":case"Toggle":n=i;continue}const t=this.#Je.get(i);if(t)switch(n){case"ON":this.setVisibility(i,!0,e);break;case"OFF":this.setVisibility(i,!1,e);break;case"Toggle":this.setVisibility(i,!t.visible,e)}}this.#Qe=null}get hasInitialVisibility(){return null===this.#Ze||this.getHash()===this.#Ze}getOrder(){return this.#Je.size?this.#tn?this.#tn.slice():[...this.#Je.keys()]:null}getGroups(){return this.#Je.size>0?On(this.#Je):null}getGroup(t){return this.#Je.get(t)||null}getHash(){if(null!==this.#Qe)return this.#Qe;const t=new Si;for(const[e,n]of this.#Je)t.update(`${e}:${n.visible}`);return this.#Qe=t.hexdigest()}}class _r{constructor(t,{disableRange:e=!1,disableStream:n=!1}){xn(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:s,contentDispositionFilename:a}=t;if(this._queuedChunks=[],this._progressiveDone=s,this._contentDispositionFilename=a,r?.length>0){const t=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(t)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!e,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener(((t,e)=>{this._onReceiveData({begin:t,chunk:e})})),t.addProgressListener(((t,e)=>{this._onProgress({loaded:t,total:e})})),t.addProgressiveReadListener((t=>{this._onReceiveData({chunk:t})})),t.addProgressiveDoneListener((()=>{this._onProgressiveDone()})),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const n=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;void 0===t?this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n):xn(this._rangeReaders.some((function(e){return e._begin===t&&(e._enqueue(n),!0)})),"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){void 0===t.total?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){xn(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new wr(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new Ar(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class wr{constructor(t,e,n=!1,i=null){this._stream=t,this._done=n||!1,this._filename=Yn(i)?i:null,this._queuedChunks=e||[],this._loaded=0;for(const t of this._queuedChunks)this._loaded+=t.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Ar{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(0===this._requests.length)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function xr(t,e){const n=new Headers;if(!t||!e||"object"!=typeof e)return n;for(const t in e){const i=e[t];void 0!==i&&n.append(t,i)}return n}function Er({responseHeaders:t,isHttp:e,rangeChunkSize:n,disableRange:i}){const r={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(t.get("Content-Length"),10);return Number.isInteger(s)?(r.suggestedLength=s,s<=2*n||i||!e||"bytes"!==t.get("Accept-Ranges")||"identity"!==(t.get("Content-Encoding")||"identity")||(r.allowRangeRequests=!0),r):r}function Sr(t){const e=t.get("Content-Disposition");if(e){let t=function(t){let e=!0,n=i("filename\\*","i").exec(t);if(n){n=n[1];let t=a(n);return t=unescape(t),t=o(t),t=l(t),s(t)}if(n=function(t){const e=[];let n;const r=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(n=r.exec(t));){let[,t,i,r]=n;if(t=parseInt(t,10),t in e){if(0===t)break}else e[t]=[i,r]}const s=[];for(let t=0;t<e.length&&t in e;++t){let[n,i]=e[t];i=a(i),n&&(i=unescape(i),0===t&&(i=o(i))),s.push(i)}return s.join("")}(t),n)return s(l(n));if(n=i("filename","i").exec(t),n){n=n[1];let t=a(n);return t=l(t),s(t)}function i(t,e){return new RegExp("(?:^|;)\\s*"+t+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',e)}function r(t,n){if(t){if(!/^[\x00-\xFF]+$/.test(n))return n;try{const i=new TextDecoder(t,{fatal:!0}),r=Fn(n);n=i.decode(r),e=!1}catch{}}return n}function s(t){return e&&/[\x80-\xff]/.test(t)&&(t=r("utf-8",t),e&&(t=r("iso-8859-1",t))),t}function a(t){if(t.startsWith('"')){const e=t.slice(1).split('\\"');for(let t=0;t<e.length;++t){const n=e[t].indexOf('"');-1!==n&&(e[t]=e[t].slice(0,n),e.length=t+1),e[t]=e[t].replaceAll(/\\(.)/g,"$1")}t=e.join('"')}return t}function o(t){const e=t.indexOf("'");return-1===e?t:r(t.slice(0,e),t.slice(e+1).replace(/^[^']*'/,""))}function l(t){return!t.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,(function(t,e,n,i){if("q"===n||"Q"===n)return r(e,i=(i=i.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,(function(t,e){return String.fromCharCode(parseInt(e,16))})));try{i=atob(i)}catch{}return r(e,i)}))}return""}(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Yn(t))return t}return null}function Tr(t,e){return 404===t||0===t&&e.startsWith("file:")?new In('Missing PDF "'+e+'".'):new Ln(`Unexpected server response (${t}) while retrieving PDF "${e}".`,t)}function Cr(t){return 200===t||206===t}function kr(t,e,n){return{method:"GET",headers:t,signal:n.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function Mr(t){return t instanceof Uint8Array?t.buffer:t instanceof ArrayBuffer?t:(wn(`getArrayBuffer - unexpected data format: ${t}`),new Uint8Array(t).buffer)}class Ir{constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=xr(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return xn(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Lr(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new Pr(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class Lr{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),i=e.url;fetch(i,kr(n,this._withCredentials,this._abortController)).then((e=>{if(!Cr(e.status))throw Tr(e.status,i);this._reader=e.body.getReader(),this._headersCapability.resolve();const n=e.headers,{allowRangeRequests:r,suggestedLength:s}=Er({responseHeaders:n,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=r,this._contentLength=s||this._contentLength,this._filename=Sr(n),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Rn("Streaming is disabled."))})).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Mr(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class Pr{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const i=t.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const r=new Headers(t.headers);r.append("Range",`bytes=${e}-${n-1}`);const s=i.url;fetch(s,kr(r,this._withCredentials,this._abortController)).then((t=>{if(!Cr(t.status))throw Tr(t.status,s);this._readCapability.resolve(),this._reader=t.body.getReader()})).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Mr(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class Rr{constructor({url:t,httpHeaders:e,withCredentials:n}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=xr(this.isHttp,e),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(t,e,n){const i={begin:t,end:e};for(const t in n)i[t]=n[t];return this.request(i)}requestFull(t){return this.request(t)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[t,n]of this.headers)e.setRequestHeader(t,n);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.expectedStatus=206):i.expectedStatus=200,e.responseType="arraybuffer",t.onError&&(e.onerror=function(n){t.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=t.onHeadersReceived,i.onDone=t.onDone,i.onError=t.onError,i.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){const n=this.pendingRequests[t];n&&n.onProgress?.(e)}onStateChange(t,e){const n=this.pendingRequests[t];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),4!==i.readyState)return;if(!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],0===i.status&&this.isHttp)return void n.onError?.(i.status);const r=i.status||200;if((200!==r||206!==n.expectedStatus)&&r!==n.expectedStatus)return void n.onError?.(i.status);const s=function(t){const e=t.response;return"string"!=typeof e?e:Fn(e).buffer}(i);if(206===r){const t=i.getResponseHeader("Content-Range"),e=/bytes (\d+)-(\d+)\/(\d+)/.exec(t);n.onDone({begin:parseInt(e[1],10),chunk:s})}else s?n.onDone({begin:0,chunk:s}):n.onError?.(i.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class Dr{constructor(t){this._source=t,this._manager=new Rr(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return xn(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Fr(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new Or(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class Fr{constructor(t,e){this._manager=t;const n={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=t.requestFull(n),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t),n=new Headers(e.getAllResponseHeaders().trim().split(/[\r\n]+/).map((t=>{const[e,...n]=t.split(": ");return[e,n.join(": ")]}))),{allowRangeRequests:i,suggestedLength:r}=Er({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=r||this._contentLength,this._filename=Sr(n),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Tr(t,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Or{constructor(t,e,n){this._manager=t;const i={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._requestId=t.requestRange(e,n,i),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError=Tr(t,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Nr=/^[a-z][a-z0-9\-+.]+:/i;function Br(t,e,n){return"http:"===t.protocol?qi.get("http").request(t,{headers:e},n):qi.get("https").request(t,{headers:e},n)}class qr{constructor(t){this.source=t,this.url=function(t){if(Nr.test(t))return new URL(t);const e=qi.get("url");return new URL(e.pathToFileURL(t))}(t.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.headers=xr(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return xn(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new Vr(this):new zr(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=this.isFsUrl?new Gr(this,t,e):new Ur(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class Hr{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return null===t?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",(()=>{this._readCapability.resolve()})),t.on("end",(()=>{t.destroy(),this._done=!0,this._readCapability.resolve()})),t.on("error",(t=>{this._error(t)})),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Rn("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class jr{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const e=t.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return null===t?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",(()=>{this._readCapability.resolve()})),t.on("end",(()=>{t.destroy(),this._done=!0,this._readCapability.resolve()})),t.on("error",(t=>{this._error(t)})),this._storedError&&this._readableStream.destroy(this._storedError)}}class zr extends Hr{constructor(t){super(t);const e=Object.fromEntries(t.headers);this._request=Br(this._url,e,(e=>{if(404===e.statusCode){const t=new In(`Missing PDF "${this._url}".`);return this._storedError=t,void this._headersCapability.reject(t)}this._headersCapability.resolve(),this._setReadableStream(e);const n=new Headers(this._readableStream.headers),{allowRangeRequests:i,suggestedLength:r}=Er({responseHeaders:n,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=i,this._contentLength=r||this._contentLength,this._filename=Sr(n)})),this._request.on("error",(t=>{this._storedError=t,this._headersCapability.reject(t)})),this._request.end()}}class Ur extends jr{constructor(t,e,n){super(t);const i=Object.fromEntries(t.headers);i.Range=`bytes=${e}-${n-1}`,this._request=Br(this._url,i,(t=>{if(404!==t.statusCode)this._setReadableStream(t);else{const t=new In(`Missing PDF "${this._url}".`);this._storedError=t}})),this._request.on("error",(t=>{this._storedError=t})),this._request.end()}}class Vr extends Hr{constructor(t){super(t);const e=qi.get("fs");e.promises.lstat(this._url).then((t=>{this._contentLength=t.size,this._setReadableStream(e.createReadStream(this._url)),this._headersCapability.resolve()}),(t=>{"ENOENT"===t.code&&(t=new In(`Missing PDF "${this._url}".`)),this._storedError=t,this._headersCapability.reject(t)}))}}class Gr extends jr{constructor(t,e,n){super(t);const i=qi.get("fs");this._setReadableStream(i.createReadStream(this._url,{start:e,end:n-1}))}}const Wr=30;class $r{#nn=Promise.withResolvers();#ut=null;#in=!1;#rn=!!globalThis.FontInspector?.enabled;#sn=null;#an=null;#on=0;#ln=0;#cn=null;#dn=null;#hn=0;#un=0;#pn=Object.create(null);#fn=[];#gn=null;#mn=[];#vn=new WeakMap;#bn=null;static#yn=new Map;static#_n=new Map;static#wn=new WeakMap;static#An=null;static#xn=new Set;constructor({textContentSource:t,container:e,viewport:n}){if(t instanceof ReadableStream)this.#gn=t;else{if("object"!=typeof t)throw new Error('No "textContentSource" parameter specified.');this.#gn=new ReadableStream({start(e){e.enqueue(t),e.close()}})}this.#ut=this.#dn=e,this.#un=n.scale*(globalThis.devicePixelRatio||1),this.#hn=n.rotation,this.#an={div:null,properties:null,ctx:null};const{pageWidth:i,pageHeight:r,pageX:s,pageY:a}=n.rawDims;this.#bn=[1,0,0,-1,-s,a+r],this.#ln=i,this.#on=r,$r.#En(),li(e,n),this.#nn.promise.finally((()=>{$r.#xn.delete(this),this.#an=null,this.#pn=null})).catch((()=>{}))}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Nn.platform;return Sn(this,"fontFamilyMap",new Map([["sans-serif",(t&&e?"Calibri, ":"")+"sans-serif"],["monospace",(t&&e?"Lucida Console, ":"")+"monospace"]]))}render(){const t=()=>{this.#cn.read().then((({value:e,done:n})=>{n?this.#nn.resolve():(this.#sn??=e.lang,Object.assign(this.#pn,e.styles),this.#Sn(e.items),t())}),this.#nn.reject)};return this.#cn=this.#gn.getReader(),$r.#xn.add(this),t(),this.#nn.promise}update({viewport:t,onBefore:e=null}){const n=t.scale*(globalThis.devicePixelRatio||1),i=t.rotation;if(i!==this.#hn&&(e?.(),this.#hn=i,li(this.#dn,{rotation:i})),n!==this.#un){e?.(),this.#un=n;const t={div:null,properties:null,ctx:$r.#Tn(this.#sn)};for(const e of this.#mn)t.properties=this.#vn.get(e),t.div=e,this.#Cn(t)}}cancel(){const t=new Rn("TextLayer task cancelled.");this.#cn?.cancel(t).catch((()=>{})),this.#cn=null,this.#nn.reject(t)}get textDivs(){return this.#mn}get textContentItemsStr(){return this.#fn}#Sn(t){if(this.#in)return;this.#an.ctx??=$r.#Tn(this.#sn);const e=this.#mn,n=this.#fn;for(const i of t){if(e.length>1e5)return wn("Ignoring additional textDivs for performance reasons."),void(this.#in=!0);if(void 0!==i.str)n.push(i.str),this.#kn(i);else if("beginMarkedContentProps"===i.type||"beginMarkedContent"===i.type){const t=this.#ut;this.#ut=document.createElement("span"),this.#ut.classList.add("markedContent"),null!==i.id&&this.#ut.setAttribute("id",`${i.id}`),t.append(this.#ut)}else"endMarkedContent"===i.type&&(this.#ut=this.#ut.parentNode)}}#kn(t){const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:""!==t.str,hasEOL:t.hasEOL,fontSize:0};this.#mn.push(e);const i=qn.transform(this.#bn,t.transform);let r=Math.atan2(i[1],i[0]);const s=this.#pn[t.fontName];s.vertical&&(r+=Math.PI/2);let a=this.#rn&&s.fontSubstitution||s.fontFamily;a=$r.fontFamilyMap.get(a)||a;const o=Math.hypot(i[2],i[3]),l=o*$r.#Mn(a,this.#sn);let c,d;0===r?(c=i[4],d=i[5]-l):(c=i[4]+l*Math.sin(r),d=i[5]-l*Math.cos(r));const h="calc(var(--scale-factor)*",u=e.style;this.#ut===this.#dn?(u.left=`${(100*c/this.#ln).toFixed(2)}%`,u.top=`${(100*d/this.#on).toFixed(2)}%`):(u.left=`${h}${c.toFixed(2)}px)`,u.top=`${h}${d.toFixed(2)}px)`),u.fontSize=`${h}${($r.#An*o).toFixed(2)}px)`,u.fontFamily=a,n.fontSize=o,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#rn&&(e.dataset.fontName=s.fontSubstitutionLoadedName||t.fontName),0!==r&&(n.angle=r*(180/Math.PI));let p=!1;if(t.str.length>1)p=!0;else if(" "!==t.str&&t.transform[0]!==t.transform[3]){const e=Math.abs(t.transform[0]),n=Math.abs(t.transform[3]);e!==n&&Math.max(e,n)/Math.min(e,n)>1.5&&(p=!0)}if(p&&(n.canvasWidth=s.vertical?t.height:t.width),this.#vn.set(e,n),this.#an.div=e,this.#an.properties=n,this.#Cn(this.#an),n.hasText&&this.#ut.append(e),n.hasEOL){const t=document.createElement("br");t.setAttribute("role","presentation"),this.#ut.append(t)}}#Cn(t){const{div:e,properties:n,ctx:i}=t,{style:r}=e;let s="";if($r.#An>1&&(s=`scale(${1/$r.#An})`),0!==n.canvasWidth&&n.hasText){const{fontFamily:t}=r,{canvasWidth:a,fontSize:o}=n;$r.#In(i,o*this.#un,t);const{width:l}=i.measureText(e.textContent);l>0&&(s=`scaleX(${a*this.#un/l}) ${s}`)}0!==n.angle&&(s=`rotate(${n.angle}deg) ${s}`),s.length>0&&(r.transform=s)}static cleanup(){if(!(this.#xn.size>0)){this.#yn.clear();for(const{canvas:t}of this.#_n.values())t.remove();this.#_n.clear()}}static#Tn(t=null){let e=this.#_n.get(t||="");if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#_n.set(t,e),this.#wn.set(e,{size:0,family:""})}return e}static#In(t,e,n){const i=this.#wn.get(t);e===i.size&&n===i.family||(t.font=`${e}px ${n}`,i.size=e,i.family=n)}static#En(){if(null!==this.#An)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#An=t.getBoundingClientRect().height,t.remove()}static#Mn(t,e){const n=this.#yn.get(t);if(n)return n;const i=this.#Tn(e);i.canvas.width=i.canvas.height=Wr,this.#In(i,Wr,t);const r=i.measureText("");let s=r.fontBoundingBoxAscent,a=Math.abs(r.fontBoundingBoxDescent);if(s){const e=s/(s+a);return this.#yn.set(t,e),i.canvas.width=i.canvas.height=0,e}i.strokeStyle="red",i.clearRect(0,0,Wr,Wr),i.strokeText("g",0,0);let o=i.getImageData(0,0,Wr,Wr).data;a=0;for(let t=o.length-1-3;t>=0;t-=4)if(o[t]>0){a=Math.ceil(t/4/Wr);break}i.clearRect(0,0,Wr,Wr),i.strokeText("A",0,Wr),o=i.getImageData(0,0,Wr,Wr).data,s=0;for(let t=0,e=o.length;t<e;t+=4)if(o[t]>0){s=Wr-Math.floor(t/4/Wr);break}i.canvas.width=i.canvas.height=0;const l=s?s/(s+a):.8;return this.#yn.set(t,l),l}}class Xr{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};return function t(n){if(!n)return;let i=null;const r=n.name;if("#text"===r)i=n.value;else{if(!Xr.shouldBuildText(r))return;n?.attributes?.textContent?i=n.attributes.textContent:n.value&&(i=n.value)}if(null!==i&&e.push({str:i}),n.children)for(const e of n.children)t(e)}(t),n}static shouldBuildText(t){return!("textarea"===t||"input"===t||"option"===t||"select"===t)}}const Kr=65536,Yr=sn?class extends Li{_createCanvas(t,e){return qi.get("canvas").createCanvas(t,e)}}:class extends Li{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}},Qr=sn?class extends Pi{async _fetch(t){return Hi(t)}}:Ri,Jr=sn?class extends Di{}:class extends Di{#Ln;#Pn;#Rn;#Dn;#Fn;#On;#y=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#Dn=t,this.#Fn=e}get#w(){return this.#Pn||=new Map}get#Nn(){return this.#On||=new Map}get#Bn(){if(!this.#Rn){const t=this.#Fn.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const n=this.#Fn.createElementNS(Vn,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#Rn=this.#Fn.createElementNS(Vn,"defs"),t.append(n),n.append(this.#Rn),this.#Fn.body.append(t)}return this.#Rn}#qn(t){if(1===t.length){const e=t[0],n=new Array(256);for(let t=0;t<256;t++)n[t]=e[t]/255;const i=n.join(",");return[i,i,i]}const[e,n,i]=t,r=new Array(256),s=new Array(256),a=new Array(256);for(let t=0;t<256;t++)r[t]=e[t]/255,s[t]=n[t]/255,a[t]=i[t]/255;return[r.join(","),s.join(","),a.join(",")]}#Hn(t){if(void 0===this.#Ln){this.#Ln="";const t=this.#Fn.URL;t!==this.#Fn.baseURI&&(Kn(t)?wn('#createUrl: ignore "data:"-URL for performance reasons.'):this.#Ln=t.split("#",1)[0])}return`url(${this.#Ln}#${t})`}addFilter(t){if(!t)return"none";let e=this.#w.get(t);if(e)return e;const[n,i,r]=this.#qn(t),s=1===t.length?n:`${n}${i}${r}`;if(e=this.#w.get(s),e)return this.#w.set(t,e),e;const a=`g_${this.#Dn}_transfer_map_${this.#y++}`,o=this.#Hn(a);this.#w.set(t,o),this.#w.set(s,o);const l=this.#jn(a);return this.#zn(n,i,r,l),o}addHCMFilter(t,e){const n=`${t}-${e}`,i="base";let r=this.#Nn.get(i);if(r?.key===n)return r.url;if(r?(r.filter?.remove(),r.key=n,r.url="none",r.filter=null):(r={key:n,url:"none",filter:null},this.#Nn.set(i,r)),!t||!e)return r.url;const s=this.#Un(t);t=qn.makeHexColor(...s);const a=this.#Un(e);if(e=qn.makeHexColor(...a),this.#Bn.style.color="","#000000"===t&&"#ffffff"===e||t===e)return r.url;const o=new Array(256);for(let t=0;t<=255;t++){const e=t/255;o[t]=e<=.03928?e/12.92:((e+.055)/1.055)**2.4}const l=o.join(","),c=`g_${this.#Dn}_hcm_filter`,d=r.filter=this.#jn(c);this.#zn(l,l,l,d),this.#Vn(d);const h=(t,e)=>{const n=s[t]/255,i=a[t]/255,r=new Array(e+1);for(let t=0;t<=e;t++)r[t]=n+t/e*(i-n);return r.join(",")};return this.#zn(h(0,5),h(1,5),h(2,5),d),r.url=this.#Hn(c),r.url}addAlphaFilter(t){let e=this.#w.get(t);if(e)return e;const[n]=this.#qn([t]),i=`alpha_${n}`;if(e=this.#w.get(i),e)return this.#w.set(t,e),e;const r=`g_${this.#Dn}_alpha_map_${this.#y++}`,s=this.#Hn(r);this.#w.set(t,s),this.#w.set(i,s);const a=this.#jn(r);return this.#Gn(n,a),s}addLuminosityFilter(t){let e,n,i=this.#w.get(t||"luminosity");if(i)return i;if(t?([e]=this.#qn([t]),n=`luminosity_${e}`):n="luminosity",i=this.#w.get(n),i)return this.#w.set(t,i),i;const r=`g_${this.#Dn}_luminosity_map_${this.#y++}`,s=this.#Hn(r);this.#w.set(t,s),this.#w.set(n,s);const a=this.#jn(r);return this.#Wn(a),t&&this.#Gn(e,a),s}addHighlightHCMFilter(t,e,n,i,r){const s=`${e}-${n}-${i}-${r}`;let a=this.#Nn.get(t);if(a?.key===s)return a.url;if(a?(a.filter?.remove(),a.key=s,a.url="none",a.filter=null):(a={key:s,url:"none",filter:null},this.#Nn.set(t,a)),!e||!n)return a.url;const[o,l]=[e,n].map(this.#Un.bind(this));let c=Math.round(.2126*o[0]+.7152*o[1]+.0722*o[2]),d=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),[h,u]=[i,r].map(this.#Un.bind(this));d<c&&([c,d,h,u]=[d,c,u,h]),this.#Bn.style.color="";const p=(t,e,n)=>{const i=new Array(256),r=(d-c)/n,s=t/255,a=(e-t)/(255*n);let o=0;for(let t=0;t<=n;t++){const e=Math.round(c+t*r),n=s+t*a;for(let t=o;t<=e;t++)i[t]=n;o=e+1}for(let t=o;t<256;t++)i[t]=i[o-1];return i.join(",")},f=`g_${this.#Dn}_hcm_${t}_filter`,g=a.filter=this.#jn(f);return this.#Vn(g),this.#zn(p(h[0],u[0],5),p(h[1],u[1],5),p(h[2],u[2],5),g),a.url=this.#Hn(f),a.url}destroy(t=!1){t&&0!==this.#Nn.size||(this.#Rn&&(this.#Rn.parentNode.parentNode.remove(),this.#Rn=null),this.#Pn&&(this.#Pn.clear(),this.#Pn=null),this.#y=0)}#Wn(t){const e=this.#Fn.createElementNS(Vn,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#Vn(t){const e=this.#Fn.createElementNS(Vn,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#jn(t){const e=this.#Fn.createElementNS(Vn,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#Bn.append(e),e}#$n(t,e,n){const i=this.#Fn.createElementNS(Vn,e);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),t.append(i)}#zn(t,e,n,i){const r=this.#Fn.createElementNS(Vn,"feComponentTransfer");i.append(r),this.#$n(r,"feFuncR",t),this.#$n(r,"feFuncG",e),this.#$n(r,"feFuncB",n)}#Gn(t,e){const n=this.#Fn.createElementNS(Vn,"feComponentTransfer");e.append(n),this.#$n(n,"feFuncA",t)}#Un(t){return this.#Bn.style.color=t,si(getComputedStyle(this.#Bn).getPropertyValue("color"))}},Zr=sn?class extends Fi{async _fetch(t){return Hi(t)}}:Oi;function ts(t={}){"string"==typeof t||t instanceof URL?t={url:t}:(t instanceof ArrayBuffer||ArrayBuffer.isView(t))&&(t={data:t});const e=new ns,{docId:n}=e,i=t.url?function(t){if(t instanceof URL)return t.href;try{return new URL(t,window.location).href}catch{if(sn&&"string"==typeof t)return t}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}(t.url):null,r=t.data?function(t){if(sn&&"undefined"!=typeof Buffer&&t instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength)return t;if("string"==typeof t)return Fn(t);if(t instanceof ArrayBuffer||ArrayBuffer.isView(t)||"object"==typeof t&&!isNaN(t?.length))return new Uint8Array(t);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}(t.data):null,s=t.httpHeaders||null,a=!0===t.withCredentials,o=t.password??null,l=t.range instanceof is?t.range:null,c=Number.isInteger(t.rangeChunkSize)&&t.rangeChunkSize>0?t.rangeChunkSize:Kr;let d=t.worker instanceof os?t.worker:null;const h=t.verbosity,u="string"!=typeof t.docBaseUrl||Kn(t.docBaseUrl)?null:t.docBaseUrl,p="string"==typeof t.cMapUrl?t.cMapUrl:null,f=!1!==t.cMapPacked,g=t.CMapReaderFactory||Qr,m="string"==typeof t.standardFontDataUrl?t.standardFontDataUrl:null,v=t.StandardFontDataFactory||Zr,b=!0!==t.stopAtErrors,y=Number.isInteger(t.maxImageSize)&&t.maxImageSize>-1?t.maxImageSize:-1,_=!1!==t.isEvalSupported,w="boolean"==typeof t.isOffscreenCanvasSupported?t.isOffscreenCanvasSupported:!sn,A="boolean"==typeof t.isChrome?t.isChrome:!Nn.platform.isFirefox&&"undefined"!=typeof window&&!!window?.chrome,x=Number.isInteger(t.canvasMaxAreaInBytes)?t.canvasMaxAreaInBytes:-1,E="boolean"==typeof t.disableFontFace?t.disableFontFace:sn,S=!0===t.fontExtraProperties,T=!0===t.enableXfa,C=t.ownerDocument||globalThis.document,k=!0===t.disableRange,M=!0===t.disableStream,I=!0===t.disableAutoFetch,L=!0===t.pdfBug,P=t.CanvasFactory||Yr,R=t.FilterFactory||Jr,D=!0===t.enableHWA,F=l?l.length:t.length??NaN,O="boolean"==typeof t.useSystemFonts?t.useSystemFonts:!sn&&!E,N="boolean"==typeof t.useWorkerFetch?t.useWorkerFetch:g===Ri&&v===Oi&&p&&m&&ti(p,document.baseURI)&&ti(m,document.baseURI);t.canvasFactory&&ni("`canvasFactory`-instance option, please use `CanvasFactory` instead."),t.filterFactory&&ni("`filterFactory`-instance option, please use `FilterFactory` instead."),bn(h);const B={canvasFactory:new P({ownerDocument:C,enableHWA:D}),filterFactory:new R({docId:n,ownerDocument:C}),cMapReaderFactory:N?null:new g({baseUrl:p,isCompressed:f}),standardFontDataFactory:N?null:new v({baseUrl:m})};if(!d){const t={verbosity:h,port:pr.workerPort};d=t.port?os.fromPort(t):new os(t),e._worker=d}const q={docId:n,apiVersion:"4.8.69",data:r,password:o,disableAutoFetch:I,rangeChunkSize:c,length:F,docBaseUrl:u,enableXfa:T,evaluatorOptions:{maxImageSize:y,disableFontFace:E,ignoreErrors:b,isEvalSupported:_,isOffscreenCanvasSupported:w,isChrome:A,canvasMaxAreaInBytes:x,fontExtraProperties:S,useSystemFonts:O,cMapUrl:N?p:null,standardFontDataUrl:N?m:null}},H={disableFontFace:E,fontExtraProperties:S,ownerDocument:C,pdfBug:L,styleElement:null,loadingParams:{disableAutoFetch:I,enableXfa:T}};return d.promise.then((function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const t=d.messageHandler.sendWithPromise("GetDocRequest",q,r?[r.buffer]:null);let o;if(l)o=new _r(l,{disableRange:k,disableStream:M});else if(!r){if(!i)throw new Error("getDocument - no `url` parameter provided.");let t;t=sn?"undefined"!=typeof fetch&&"undefined"!=typeof Response&&"body"in Response.prototype&&ti(i)?Ir:qr:ti(i)?Ir:Dr,o=new t({url:i,length:F,httpHeaders:s,withCredentials:a,rangeChunkSize:c,disableRange:k,disableStream:M})}return t.then((t=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const i=new gr(n,t,d.port),r=new ls(i,e,o,H,B);e._transport=r,i.send("Ready",null)}))})).catch(e._capability.reject),e}function es(t){return"object"==typeof t&&Number.isInteger(t?.num)&&t.num>=0&&Number.isInteger(t?.gen)&&t.gen>=0}class ns{static#Dn=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId="d"+ns.#Dn++,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await(this._transport?.destroy())}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}class is{constructor(t,e,n=!1,i=null){this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const n of this._rangeListeners)n(t,e)}onDataProgress(t,e){this._readyCapability.promise.then((()=>{for(const n of this._progressListeners)n(t,e)}))}onDataProgressiveRead(t){this._readyCapability.promise.then((()=>{for(const e of this._progressiveReadListeners)e(t)}))}onDataProgressiveDone(){this._readyCapability.promise.then((()=>{for(const t of this._progressiveDoneListeners)t()}))}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){An("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class rs{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Sn(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class ss{#Xn=null;#Kn=!1;constructor(t,e,n,i=!1){this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=i?new Zn:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new ds,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:r=!1}={}){return new $n({viewBox:this.view,scale:t,rotation:e,offsetX:n,offsetY:i,dontFlip:r})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Sn(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:e,intent:n="display",annotationMode:i=cn.ENABLE,transform:r=null,background:s=null,optionalContentConfigPromise:a=null,annotationCanvasMap:o=null,pageColors:l=null,printAnnotationStorage:c=null,isEditing:d=!1}){this._stats?.time("Overall");const h=this._transport.getRenderingIntent(n,i,c,d),{renderingIntent:u,cacheKey:p}=h;this.#Kn=!1,this.#Yn(),a||=this._transport.getOptionalContentConfig(u);let f=this._intentStates.get(p);f||(f=Object.create(null),this._intentStates.set(p,f)),f.streamReaderCancelTimeout&&(clearTimeout(f.streamReaderCancelTimeout),f.streamReaderCancelTimeout=null);const g=!!(4&u);f.displayReadyCapability||(f.displayReadyCapability=Promise.withResolvers(),f.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(h));const m=t=>{f.renderTasks.delete(v),(this._maybeCleanupAfterRender||g)&&(this.#Kn=!0),this.#Qn(!g),t?(v.capability.reject(t),this._abortOperatorList({intentState:f,reason:t instanceof Error?t:new Error(t)})):v.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},v=new us({callback:m,params:{canvasContext:t,viewport:e,transform:r,background:s},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:o,operatorList:f.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!g,pdfBug:this._pdfBug,pageColors:l});(f.renderTasks||=new Set).add(v);const b=v.task;return Promise.all([f.displayReadyCapability.promise,a]).then((([t,e])=>{if(this.destroyed)m();else{if(this._stats?.time("Rendering"),!(e.renderingIntent&u))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");v.initializeGraphics({transparency:t,optionalContentConfig:e}),v.operatorListChanged()}})).catch(m),b}getOperatorList({intent:t="display",annotationMode:e=cn.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}={}){const r=this._transport.getRenderingIntent(t,e,n,i,!0);let s,a=this._intentStates.get(r.cacheKey);return a||(a=Object.create(null),this._intentStates.set(r.cacheKey,a)),a.opListReadCapability||(s=Object.create(null),s.operatorListChanged=function(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(s))},a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||=new Set).add(s),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(r)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===t,disableNormalization:!0===e},{highWaterMark:100,size:t=>t.items.length})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then((t=>Xr.textContent(t)));const e=this.streamTextContent(t);return new Promise((function(t,n){const i=e.getReader(),r={items:[],styles:Object.create(null),lang:null};!function e(){i.read().then((function({value:n,done:i}){i?t(r):(r.lang??=n.lang,Object.assign(r.styles,n.styles),r.items.push(...n.items),e())}),n)}()}))}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),this.#Kn=!1,this.#Yn(),Promise.all(t)}cleanup(t=!1){this.#Kn=!0;const e=this.#Qn(!1);return t&&e&&(this._stats&&=new Zn),e}#Qn(t=!1){if(this.#Yn(),!this.#Kn||this.destroyed)return!1;if(t)return this.#Xn=setTimeout((()=>{this.#Xn=null,this.#Qn(!1)}),5e3),!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#Kn=!1,!0}#Yn(){this.#Xn&&(clearTimeout(this.#Xn),this.#Xn=null)}_startRenderPage(t,e){const n=this._intentStates.get(e);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let n=0,i=t.length;n<i;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const t of e.renderTasks)t.operatorListChanged();t.lastChunk&&this.#Qn(!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:n,modifiedIds:i}){const{map:r,transfer:s}=n,a=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:r,modifiedIds:i},s).getReader(),o=this._intentStates.get(e);o.streamReader=a;const l=()=>{a.read().then((({value:t,done:e})=>{e?o.streamReader=null:this._transport.destroyed||(this._renderPageChunk(t,o),l())}),(t=>{if(o.streamReader=null,!this._transport.destroyed){if(o.operatorList){o.operatorList.lastChunk=!0;for(const t of o.renderTasks)t.operatorListChanged();this.#Qn(!0)}if(o.displayReadyCapability)o.displayReadyCapability.reject(t);else{if(!o.opListReadCapability)throw t;o.opListReadCapability.reject(t)}}}))};l()}_abortOperatorList({intentState:t,reason:e,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(e instanceof Xn){let n=100;return e.extraDelay>0&&e.extraDelay<1e3&&(n+=e.extraDelay),void(t.streamReaderCancelTimeout=setTimeout((()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})}),n))}}if(t.streamReader.cancel(new Rn(e.message)).catch((()=>{})),t.streamReader=null,!this._transport.destroyed){for(const[e,n]of this._intentStates)if(n===t){this._intentStates.delete(e);break}this.cleanup()}}}get stats(){return this._stats}}class as{#Jn=new Map;#Zn=Promise.resolve();postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};this.#Zn.then((()=>{for(const[t]of this.#Jn)t.call(this,n)}))}addEventListener(t,e,n=null){let i=null;if(n?.signal instanceof AbortSignal){const{signal:r}=n;if(r.aborted)return void wn("LoopbackPort - cannot use an `aborted` signal.");const s=()=>this.removeEventListener(t,e);i=()=>r.removeEventListener("abort",s),r.addEventListener("abort",s)}this.#Jn.set(e,i)}removeEventListener(t,e){const n=this.#Jn.get(e);n?.(),this.#Jn.delete(e)}terminate(){for(const[,t]of this.#Jn)t?.();this.#Jn.clear()}}class os{static#ti=0;static#ei=!1;static#ni;static{sn&&(this.#ei=!0,pr.workerSrc||="./pdf.worker.mjs"),this._isSameOrigin=(t,e)=>{let n;try{if(n=new URL(t),!n.origin||"null"===n.origin)return!1}catch{return!1}const i=new URL(e,n);return n.origin===i.origin},this._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}}constructor({name:t=null,port:e=null,verbosity:n=yn()}={}){if(this.name=t,this.destroyed=!1,this.verbosity=n,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if(os.#ni?.has(e))throw new Error("Cannot use more than one PDFWorker per port.");return(os.#ni||=new WeakMap).set(e,this),void this._initializeFromPort(e)}this._initialize()}get promise(){return sn?Promise.all([qi.promise,this._readyCapability.promise]):this._readyCapability.promise}#ii(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new gr("main","worker",t),this._messageHandler.on("ready",(function(){})),this.#ii()}_initialize(){if(os.#ei||os.#ri)return void this._setupFakeWorker();let{workerSrc:t}=os;try{os._isSameOrigin(window.location.href,t)||(t=os._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new gr("main","worker",e),i=()=>{r.abort(),n.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;e.addEventListener("error",(()=>{this._webWorker||i()}),{signal:r.signal}),n.on("test",(t=>{r.abort(),!this.destroyed&&t?(this._messageHandler=n,this._port=e,this._webWorker=e,this.#ii()):i()})),n.on("ready",(t=>{if(r.abort(),this.destroyed)i();else try{s()}catch{this._setupFakeWorker()}}));const s=()=>{const t=new Uint8Array;n.send("test",t,[t.buffer])};return void s()}catch{_n("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){os.#ei||(wn("Setting up fake worker."),os.#ei=!0),os._setupFakeWorkerGlobal.then((t=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const e=new as;this._port=e;const n="fake"+os.#ti++,i=new gr(n+"_worker",n,e);t.setup(i,e),this._messageHandler=new gr(n,n+"_worker",e),this.#ii()})).catch((t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))}))}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),os.#ni?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){if(!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const e=this.#ni?.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new os(t)}static get workerSrc(){if(pr.workerSrc)return pr.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#ri(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return Sn(this,"_setupFakeWorkerGlobal",(async()=>this.#ri?this.#ri:(await import(this.workerSrc)).WorkerMessageHandler)())}}class ls{#si=new Map;#ai=new Map;#oi=new Map;#li=new Map;#ci=null;constructor(t,e,n,i,r){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new ds,this.fontLoader=new Mi({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#di(t,e=null){const n=this.#si.get(t);if(n)return n;const i=this.messageHandler.sendWithPromise(t,e);return this.#si.set(t,i),i}get annotationStorage(){return Sn(this,"annotationStorage",new Ci)}getRenderingIntent(t,e=cn.ENABLE,n=null,i=!1,r=!1){let s=2,a=Ti;switch(t){case"any":s=1;break;case"display":break;case"print":s=4;break;default:wn(`getRenderingIntent - invalid intent: ${t}`)}const o=4&s&&n instanceof ki?n:this.annotationStorage;switch(e){case cn.DISABLE:s+=64;break;case cn.ENABLE:break;case cn.ENABLE_FORMS:s+=16;break;case cn.ENABLE_STORAGE:s+=32,a=o.serializable;break;default:wn(`getRenderingIntent - invalid annotationMode: ${e}`)}i&&(s+=128),r&&(s+=256);const{ids:l,hash:c}=o.modifiedIds;return{renderingIntent:s,cacheKey:[s,a.hash,c].join("_"),annotationStorageSerializable:a,modifiedIds:l}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#ci?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const e of this.#ai.values())t.push(e._destroy());this.#ai.clear(),this.#oi.clear(),this.#li.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then((()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#si.clear(),this.filterFactory.destroy(),$r.cleanup(),this._networkStream?.cancelAllRequests(new Rn("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()}),this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",((t,e)=>{xn(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=t=>{this._lastProgress={loaded:t.loaded,total:t.total}},e.onPull=()=>{this._fullReader.read().then((function({value:t,done:n}){n?e.close():(xn(t instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),e.enqueue(new Uint8Array(t),1,[t]))})).catch((t=>{e.error(t)}))},e.onCancel=t=>{this._fullReader.cancel(t),e.ready.catch((t=>{if(!this.destroyed)throw t}))}})),t.on("ReaderHeadersReady",(async t=>{await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:i,contentLength:r}=this._fullReader;return n&&i||(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=t=>{e.onProgress?.({loaded:t.loaded,total:t.total})}),{isStreamingSupported:n,isRangeSupported:i,contentLength:r}})),t.on("GetRangeReader",((t,e)=>{xn(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(t.begin,t.end);n?(e.onPull=()=>{n.read().then((function({value:t,done:n}){n?e.close():(xn(t instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),e.enqueue(new Uint8Array(t),1,[t]))})).catch((t=>{e.error(t)}))},e.onCancel=t=>{n.cancel(t),e.ready.catch((t=>{if(!this.destroyed)throw t}))}):e.close()})),t.on("GetDoc",(({pdfInfo:t})=>{this._numPages=t.numPages,this._htmlForXfa=t.htmlForXfa,delete t.htmlForXfa,e._capability.resolve(new rs(t,this))})),t.on("DocException",(function(t){let n;switch(t.name){case"PasswordException":n=new Cn(t.message,t.code);break;case"InvalidPDFException":n=new Mn(t.message);break;case"MissingPDFException":n=new In(t.message);break;case"UnexpectedResponseException":n=new Ln(t.message,t.status);break;case"UnknownErrorException":n=new kn(t.message,t.details);break;default:An("DocException - expected a valid Error.")}e._capability.reject(n)})),t.on("PasswordRequest",(t=>{if(this.#ci=Promise.withResolvers(),e.onPassword){const n=t=>{t instanceof Error?this.#ci.reject(t):this.#ci.resolve({password:t})};try{e.onPassword(n,t.code)}catch(t){this.#ci.reject(t)}}else this.#ci.reject(new Cn(t.message,t.code));return this.#ci.promise})),t.on("DataLoaded",(t=>{e.onProgress?.({loaded:t.length,total:t.length}),this.downloadInfoCapability.resolve(t)})),t.on("StartRenderPage",(t=>{this.destroyed||this.#ai.get(t.pageIndex)._startRenderPage(t.transparency,t.cacheKey)})),t.on("commonobj",(([e,n,i])=>{if(this.destroyed)return null;if(this.commonObjs.has(e))return null;switch(n){case"Font":const{disableFontFace:r,fontExtraProperties:s,pdfBug:a}=this._params;if("error"in i){const t=i.error;wn(`Error during font loading: ${t}`),this.commonObjs.resolve(e,t);break}const o=a&&globalThis.FontInspector?.enabled?(t,e)=>globalThis.FontInspector.fontAdded(t,e):null,l=new Ii(i,{disableFontFace:r,inspectFont:o});this.fontLoader.bind(l).catch((()=>t.sendWithPromise("FontFallback",{id:e}))).finally((()=>{!s&&l.data&&(l.data=null),this.commonObjs.resolve(e,l)}));break;case"CopyLocalImage":const{imageRef:c}=i;xn(c,"The imageRef must be defined.");for(const t of this.#ai.values())for(const[,n]of t.objs)if(n?.ref===c)return n.dataLen?(this.commonObjs.resolve(e,structuredClone(n)),n.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(e,i);break;default:throw new Error(`Got unknown common object type ${n}`)}return null})),t.on("obj",(([t,e,n,i])=>{if(this.destroyed)return;const r=this.#ai.get(e);if(!r.objs.has(t))if(0!==r._intentStates.size)switch(n){case"Image":r.objs.resolve(t,i),i?.dataLen>1e7&&(r._maybeCleanupAfterRender=!0);break;case"Pattern":r.objs.resolve(t,i);break;default:throw new Error(`Got unknown object type ${n}`)}else i?.bitmap?.close()})),t.on("DocProgress",(t=>{this.destroyed||e.onProgress?.({loaded:t.loaded,total:t.total})})),t.on("FetchBuiltInCMap",(async t=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(t)})),t.on("FetchStandardFontData",(async t=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(t)}))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&wn("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally((()=>{this.annotationStorage.resetModified()}))}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=this.#oi.get(e);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then((n=>{if(this.destroyed)throw new Error("Transport destroyed");n.refStr&&this.#li.set(n.refStr,t);const i=new ss(e,n,this,this._params.pdfBug);return this.#ai.set(e,i),i}));return this.#oi.set(e,i),i}getPageIndex(t){return es(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#di("GetFieldObjects")}hasJSActions(){return this.#di("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return"string"!=typeof t?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#di("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#di("GetOptionalContentConfig").then((e=>new yr(e,t)))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#si.get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then((t=>({info:t[0],metadata:t[1]?new mr(t[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null})));return this.#si.set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#ai.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#si.clear(),this.filterFactory.destroy(!0),$r.cleanup()}}cachedPageNumber(t){if(!es(t))return null;const e=0===t.gen?`${t.num}R`:`${t.num}R${t.gen}`;return this.#li.get(e)??null}}const cs=Symbol("INITIAL_DATA");class ds{#hi=Object.create(null);#ui(t){return this.#hi[t]||={...Promise.withResolvers(),data:cs}}get(t,e=null){if(e){const n=this.#ui(t);return n.promise.then((()=>e(n.data))),null}const n=this.#hi[t];if(!n||n.data===cs)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const e=this.#hi[t];return!!e&&e.data!==cs}resolve(t,e=null){const n=this.#ui(t);n.data=e,n.resolve()}clear(){for(const t in this.#hi){const{data:e}=this.#hi[t];e?.bitmap?.close()}this.#hi=Object.create(null)}*[Symbol.iterator](){for(const t in this.#hi){const{data:e}=this.#hi[t];e!==cs&&(yield[t,e])}}}class hs{#pi=null;constructor(t){this.#pi=t,this.onContinue=null}get promise(){return this.#pi.capability.promise}cancel(t=0){this.#pi.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#pi.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#pi;return t.form||t.canvas&&e?.size>0}}class us{#fi=null;static#gi=new WeakSet;constructor({callback:t,params:e,objs:n,commonObjs:i,annotationCanvasMap:r,operatorList:s,pageIndex:a,canvasFactory:o,filterFactory:l,useRequestAnimationFrame:c=!1,pdfBug:d=!1,pageColors:h=null}){this.callback=t,this.params=e,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=s,this._pageIndex=a,this.canvasFactory=o,this.filterFactory=l,this._pdfBug=d,this.pageColors=h,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===c&&"undefined"!=typeof window,this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new hs(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch((function(){}))}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(us.#gi.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");us.#gi.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:i,transform:r,background:s}=this.params;this.gfx=new ur(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:i,transparency:t,background:s}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#fi&&(window.cancelAnimationFrame(this.#fi),this.#fi=null),us.#gi.delete(this._canvas),this.callback(t||new Xn(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){this.graphicsReady?(this.stepper?.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||=this._continueBound}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#fi=window.requestAnimationFrame((()=>{this.#fi=null,this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),us.#gi.delete(this._canvas),this.callback())))}}const ps="4.8.69",fs="3634dab10";function gs(t){return Math.floor(255*Math.max(0,Math.min(1,t))).toString(16).padStart(2,"0")}function ms(t){return Math.max(0,Math.min(255,255*t))}class vs{static CMYK_G([t,e,n,i]){return["G",1-Math.min(1,.3*t+.59*n+.11*e+i)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return[t=ms(t),t,t]}static G_HTML([t]){const e=gs(t);return`#${e}${e}${e}`}static RGB_G([t,e,n]){return["G",.3*t+.59*e+.11*n]}static RGB_rgb(t){return t.map(ms)}static RGB_HTML(t){return`#${t.map(gs).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,n,i]){return["RGB",1-Math.min(1,t+i),1-Math.min(1,n+i),1-Math.min(1,e+i)]}static CMYK_rgb([t,e,n,i]){return[ms(1-Math.min(1,t+i)),ms(1-Math.min(1,n+i)),ms(1-Math.min(1,e+i))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,n]){const i=1-t,r=1-e,s=1-n;return["CMYK",i,r,s,Math.min(i,r,s)]}}class bs{create(t,e,n=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${t}px`),i.setAttribute("height",`${e}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${t} ${e}`),i}createElement(t){if("string"!=typeof t)throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){An("Abstract method `_createSVG` called.")}}class ys extends bs{_createSVG(t){return document.createElementNS(Vn,t)}}class _s{static setupStorage(t,e,n,i,r){const s=i.getValue(e,{value:null});switch(n.name){case"textarea":if(null!==s.value&&(t.textContent=s.value),"print"===r)break;t.addEventListener("input",(t=>{i.setValue(e,{value:t.target.value})}));break;case"input":if("radio"===n.attributes.type||"checkbox"===n.attributes.type){if(s.value===n.attributes.xfaOn?t.setAttribute("checked",!0):s.value===n.attributes.xfaOff&&t.removeAttribute("checked"),"print"===r)break;t.addEventListener("change",(t=>{i.setValue(e,{value:t.target.checked?t.target.getAttribute("xfaOn"):t.target.getAttribute("xfaOff")})}))}else{if(null!==s.value&&t.setAttribute("value",s.value),"print"===r)break;t.addEventListener("input",(t=>{i.setValue(e,{value:t.target.value})}))}break;case"select":if(null!==s.value){t.setAttribute("value",s.value);for(const t of n.children)t.attributes.value===s.value?t.attributes.selected=!0:t.attributes.hasOwnProperty("selected")&&delete t.attributes.selected}t.addEventListener("input",(t=>{const n=t.target.options,r=-1===n.selectedIndex?"":n[n.selectedIndex].value;i.setValue(e,{value:r})}))}}static setAttributes({html:t,element:e,storage:n=null,intent:i,linkService:r}){const{attributes:s}=e,a=t instanceof HTMLAnchorElement;"radio"===s.type&&(s.name=`${s.name}-${i}`);for(const[e,n]of Object.entries(s))if(null!=n)switch(e){case"class":n.length&&t.setAttribute(e,n.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",n);break;case"style":Object.assign(t.style,n);break;case"textContent":t.textContent=n;break;default:(!a||"href"!==e&&"newWindow"!==e)&&t.setAttribute(e,n)}a&&r.addLinkAttributes(t,s.href,s.newWindow),n&&s.dataId&&this.setupStorage(t,s.dataId,e,n)}static render(t){const e=t.annotationStorage,n=t.linkService,i=t.xfaHtml,r=t.intent||"display",s=document.createElement(i.name);i.attributes&&this.setAttributes({html:s,element:i,intent:r,linkService:n});const a="richText"!==r,o=t.div;if(o.append(s),t.viewport){const e=`matrix(${t.viewport.transform.join(",")})`;o.style.transform=e}a&&o.setAttribute("class","xfaLayer xfaFont");const l=[];if(0===i.children.length){if(i.value){const t=document.createTextNode(i.value);s.append(t),a&&Xr.shouldBuildText(i.name)&&l.push(t)}return{textDivs:l}}const c=[[i,-1,s]];for(;c.length>0;){const[t,i,s]=c.at(-1);if(i+1===t.children.length){c.pop();continue}const o=t.children[++c.at(-1)[1]];if(null===o)continue;const{name:d}=o;if("#text"===d){const t=document.createTextNode(o.value);l.push(t),s.append(t);continue}const h=o?.attributes?.xmlns?document.createElementNS(o.attributes.xmlns,d):document.createElement(d);if(s.append(h),o.attributes&&this.setAttributes({html:h,element:o,storage:e,intent:r,linkService:n}),o.children?.length>0)c.push([o,-1,h]);else if(o.value){const t=document.createTextNode(o.value);a&&Xr.shouldBuildText(d)&&l.push(t),h.append(t)}}for(const t of o.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))t.setAttribute("readOnly",!0);return{textDivs:l}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const ws=1e3,As=new WeakSet;function xs(t){return{width:t[2]-t[0],height:t[3]-t[1]}}class Es{static create(t){switch(t.data.annotationType){case 2:return new Ts(t);case 1:return new Cs(t);case 20:switch(t.data.fieldType){case"Tx":return new Ms(t);case"Btn":return t.data.radioButton?new Ps(t):t.data.checkBox?new Ls(t):new Rs(t);case"Ch":return new Ds(t);case"Sig":return new Is(t)}return new ks(t);case 16:return new Fs(t);case 3:return new Ns(t);case 4:return new Bs(t);case 5:return new qs(t);case 6:return new Hs(t);case 8:return new js(t);case 14:return new Us(t);case 15:return new Vs(t);case 7:return new zs(t);case 9:return new Gs(t);case 10:return new Ws(t);case 11:return new $s(t);case 12:return new Xs(t);case 13:return new Ks(t);case 17:return new Ys(t);default:return new Ss(t)}}}class Ss{#mi=null;#vi=!1;#bi=null;constructor(t,{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:n}){return!!(t?.str||e?.str||n?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Ss._hasPopupData(this.data)}updateEdited(t){if(!this.container)return;this.#mi||={rect:this.data.rect.slice(0)};const{rect:e}=t;e&&this.#yi(e),this.#bi?.popup.updateEdited(t)}resetEdited(){this.#mi&&(this.#yi(this.#mi.rect),this.#bi?.popup.resetEdited(),this.#mi=null)}#yi(t){const{container:{style:e},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:s,pageX:a,pageY:o}}}}=this;n?.splice(0,4,...t);const{width:l,height:c}=xs(t);e.left=100*(t[0]-a)/r+"%",e.top=100*(s-t[3]+o)/s+"%",0===i?(e.width=100*l/r+"%",e.height=100*c/s+"%"):this.setRotation(i)}_createContainer(t){const{data:e,parent:{page:n,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",e.id),this instanceof ks||(r.tabIndex=ws);const{style:s}=r;if(s.zIndex=this.parent.zIndex++,e.alternativeText&&(r.title=e.alternativeText),e.noRotate&&r.classList.add("norotate"),!e.rect||this instanceof Fs){const{rotation:t}=e;return e.hasOwnCanvas||0===t||this.setRotation(t,r),r}const{width:a,height:o}=xs(e.rect);if(!t&&e.borderStyle.width>0){s.borderWidth=`${e.borderStyle.width}px`;const t=e.borderStyle.horizontalCornerRadius,n=e.borderStyle.verticalCornerRadius;if(t>0||n>0){const e=`calc(${t}px * var(--scale-factor)) / calc(${n}px * var(--scale-factor))`;s.borderRadius=e}else if(this instanceof Ps){const t=`calc(${a}px * var(--scale-factor)) / calc(${o}px * var(--scale-factor))`;s.borderRadius=t}switch(e.borderStyle.style){case 1:s.borderStyle="solid";break;case 2:s.borderStyle="dashed";break;case 3:wn("Unimplemented border style: beveled");break;case 4:wn("Unimplemented border style: inset");break;case 5:s.borderBottomStyle="solid"}const i=e.borderColor||null;i?(this.#vi=!0,s.borderColor=qn.makeHexColor(0|i[0],0|i[1],0|i[2])):s.borderWidth=0}const l=qn.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:c,pageHeight:d,pageX:h,pageY:u}=i.rawDims;s.left=100*(l[0]-h)/c+"%",s.top=100*(l[1]-u)/d+"%";const{rotation:p}=e;return e.hasOwnCanvas||0===p?(s.width=100*a/c+"%",s.height=100*o/d+"%"):this.setRotation(p,r),r}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims,{width:r,height:s}=xs(this.data.rect);let a,o;t%180==0?(a=100*r/n,o=100*s/i):(a=100*s/n,o=100*r/i),e.style.width=`${a}%`,e.style.height=`${o}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(t,e,n)=>{const i=n.detail[t],r=i[0],s=i.slice(1);n.target.style[e]=vs[`${r}_HTML`](s),this.annotationStorage.setValue(this.data.id,{[e]:vs[`${r}_rgb`](s)})};return Sn(this,"_commonActions",{display:t=>{const{display:e}=t.detail,n=e%2==1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:1===e||2===e})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:e}=t.detail;this.container.style.visibility=e?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:e,noView:e})},focus:t=>{setTimeout((()=>t.target.focus({preventScroll:!1})),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:t=>{const e=t.detail.rotation;this.setRotation(e),this.annotationStorage.setValue(this.data.id,{rotation:e})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const i of Object.keys(e.detail)){const r=t[i]||n[i];r?.(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[i,r]of Object.entries(e)){const s=n[i];s&&(s({detail:{[i]:r},target:t}),delete e[i])}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,i,r]=this.data.rect.map((t=>Math.fround(t)));if(8===t.length){const[s,a,o,l]=t.subarray(2,6);if(i===s&&r===a&&e===o&&n===l)return}const{style:s}=this.container;let a;if(this.#vi){const{borderColor:t,borderWidth:e}=s;s.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${t}" stroke-width="${e}">`],this.container.classList.add("hasBorder")}const o=i-e,l=r-n,{svgFactory:c}=this,d=c.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const h=c.createElement("defs");d.append(h);const u=c.createElement("clipPath"),p=`clippath_${this.data.id}`;u.setAttribute("id",p),u.setAttribute("clipPathUnits","objectBoundingBox"),h.append(u);for(let n=2,i=t.length;n<i;n+=8){const i=t[n],s=t[n+1],d=t[n+2],h=t[n+3],p=c.createElement("rect"),f=(d-e)/o,g=(r-s)/l,m=(i-d)/o,v=(s-h)/l;p.setAttribute("x",f),p.setAttribute("y",g),p.setAttribute("width",m),p.setAttribute("height",v),u.append(p),a?.push(`<rect vector-effect="non-scaling-stroke" x="${f}" y="${g}" width="${m}" height="${v}"/>`)}this.#vi&&(a.push("</g></svg>')"),s.backgroundImage=a.join("")),this.container.append(d),this.container.style.clipPath=`url(#${p})`}_createPopup(){const{data:t}=this,e=this.#bi=new Fs({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]});this.parent.div.append(e.render())}render(){An("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const n=[];if(this._fieldObjects){const i=this._fieldObjects[t];if(i)for(const{page:t,id:r,exportValues:s}of i){if(-1===t)continue;if(r===e)continue;const i="string"==typeof s?s:null,a=document.querySelector(`[data-element-id="${r}"]`);!a||As.has(a)?n.push({id:r,exportValue:i,domElement:a}):wn(`_getElementsByName - element not allowed: ${r}`)}return n}for(const i of document.getElementsByName(t)){const{exportValue:t}=i,r=i.getAttribute("data-element-id");r!==e&&As.has(i)&&n.push({id:r,exportValue:t,domElement:i})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",(()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})}))}}class Ts extends Ss{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,n=document.createElement("a");n.setAttribute("data-element-id",t.id);let i=!1;return t.url?(e.addLinkAttributes(n,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(n,t.action),i=!0):t.attachment?(this.#_i(n,t.attachment,t.attachmentDest),i=!0):t.setOCGState?(this.#wi(n,t.setOCGState),i=!0):t.dest?(this._bindLink(n,t.dest),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,t),i=!0),t.resetForm?(this._bindResetFormAction(n,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(n),this.container}#Ai(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||""===e)&&this.#Ai()}_bindNamedAction(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),this.#Ai()}#_i(t,e,n=null){t.href=this.linkService.getAnchorUrl(""),e.description&&(t.title=e.description),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,n),!1),this.#Ai()}#wi(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),this.#Ai()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(e.actions)){const r=n.get(i);r&&(t[r]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:i}}),!1))}t.onclick||(t.onclick=()=>!1),this.#Ai()}_bindResetFormAction(t,e){const n=t.onclick;if(n||(t.href=this.linkService.getAnchorUrl("")),this.#Ai(),!this._fieldObjects)return wn('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(n||(t.onclick=()=>!1));t.onclick=()=>{n?.();const{fields:t,refs:i,include:r}=e,s=[];if(0!==t.length||0!==i.length){const e=new Set(i);for(const n of t){const t=this._fieldObjects[n]||[];for(const{id:n}of t)e.add(n)}for(const t of Object.values(this._fieldObjects))for(const n of t)e.has(n.id)===r&&s.push(n)}else for(const t of Object.values(this._fieldObjects))s.push(...t);const a=this.annotationStorage,o=[];for(const t of s){const{id:e}=t;switch(o.push(e),t.type){case"text":{const n=t.defaultValue||"";a.setValue(e,{value:n});break}case"checkbox":case"radiobutton":{const n=t.defaultValue===t.exportValues;a.setValue(e,{value:n});break}case"combobox":case"listbox":{const n=t.defaultValue||"";a.setValue(e,{value:n});break}default:continue}const n=document.querySelector(`[data-element-id="${e}"]`);n&&(As.has(n)?n.dispatchEvent(new Event("resetform")):wn(`_bindResetFormAction - element not allowed: ${e}`))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:o,name:"ResetForm"}}),!1}}}class Cs extends Ss{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class ks extends Ss{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&("CANVAS"===t.previousSibling?.nodeName&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Nn.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,i,r){n.includes("mouse")?t.addEventListener(n,(t=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(t),shift:t.shiftKey,modifier:this._getKeyModifier(t)}})})):t.addEventListener(n,(t=>{if("blur"===n){if(!e.focused||!t.relatedTarget)return;e.focused=!1}else if("focus"===n){if(e.focused)return;e.focused=!0}r&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(t)}})}))}_setEventListeners(t,e,n,i){for(const[r,s]of n)("Action"===s||this.data.actions?.[s])&&("Focus"!==s&&"Blur"!==s||(e||={focused:!1}),this._setEventListener(t,e,r,s,i),"Focus"!==s||this.data.actions?.Blur?"Blur"!==s||this.data.actions?.Focus||this._setEventListener(t,e,"focus","Focus",null):this._setEventListener(t,e,"blur","Blur",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=null===e?"transparent":qn.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const{fontColor:e}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||9,i=t.style;let r;const s=t=>Math.round(10*t)/10;if(this.data.multiLine){const t=Math.abs(this.data.rect[3]-this.data.rect[1]-2),e=t/(Math.round(t/(ln*n))||1);r=Math.min(n,s(e/ln))}else{const t=Math.abs(this.data.rect[3]-this.data.rect[1]-2);r=Math.min(n,s(t/ln))}i.fontSize=`calc(${r}px * var(--scale-factor))`,i.color=qn.makeHexColor(e[0],e[1],e[2]),null!==this.data.textAlignment&&(i.textAlign=["left","center","right"][this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class Ms extends ks{constructor(t){super(t,{isRenderable:t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue})}setPropertyOnSiblings(t,e,n,i){const r=this.annotationStorage;for(const s of this._getElementsByName(t.name,t.id))s.domElement&&(s.domElement[e]=n),r.setValue(s.id,{[i]:n})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const i=t.getValue(e,{value:this.data.fieldValue});let r=i.value||"";const s=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;s&&r.length>s&&(r=r.slice(0,s));let a=i.formattedValue||this.data.textContent?.join("\n")||null;a&&this.data.comb&&(a=a.replaceAll(/\s+/g,""));const o={userValue:r,formattedValue:a,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=a??r,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",a??r),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),As.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=ws,this._setRequired(n,this.data.required),s&&(n.maxLength=s),n.addEventListener("input",(i=>{t.setValue(e,{value:i.target.value}),this.setPropertyOnSiblings(n,"value",i.target.value,"value"),o.formattedValue=null})),n.addEventListener("resetform",(t=>{const e=this.data.defaultFieldValue??"";n.value=o.userValue=e,o.formattedValue=null}));let l=t=>{const{formattedValue:e}=o;null!=e&&(t.target.value=e),t.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",(t=>{if(o.focused)return;const{target:e}=t;o.userValue&&(e.value=o.userValue),o.lastCommittedValue=e.value,o.commitKey=1,this.data.actions?.Focus||(o.focused=!0)})),n.addEventListener("updatefromsandbox",(n=>{this.showElementAndHideCanvas(n.target);const i={value(n){o.userValue=n.detail.value??"",t.setValue(e,{value:o.userValue.toString()}),n.target.value=o.userValue},formattedValue(n){const{formattedValue:i}=n.detail;o.formattedValue=i,null!=i&&n.target!==document.activeElement&&(n.target.value=i),t.setValue(e,{formattedValue:i})},selRange(t){t.target.setSelectionRange(...t.detail.selRange)},charLimit:n=>{const{charLimit:i}=n.detail,{target:r}=n;if(0===i)return void r.removeAttribute("maxLength");r.setAttribute("maxLength",i);let s=o.userValue;!s||s.length<=i||(s=s.slice(0,i),r.value=o.userValue=s,t.setValue(e,{value:s}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:s,willCommit:!0,commitKey:1,selStart:r.selectionStart,selEnd:r.selectionEnd}}))}};this._dispatchEventFromSandbox(i,n)})),n.addEventListener("keydown",(t=>{o.commitKey=1;let n=-1;if("Escape"===t.key?n=0:"Enter"!==t.key||this.data.multiLine?"Tab"===t.key&&(o.commitKey=3):n=2,-1===n)return;const{value:i}=t.target;o.lastCommittedValue!==i&&(o.lastCommittedValue=i,o.userValue=i,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:i,willCommit:!0,commitKey:n,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}}))}));const i=l;l=null,n.addEventListener("blur",(t=>{if(!o.focused||!t.relatedTarget)return;this.data.actions?.Blur||(o.focused=!1);const{value:n}=t.target;o.userValue=n,o.lastCommittedValue!==n&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:n,willCommit:!0,commitKey:o.commitKey,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}}),i(t)})),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",(t=>{o.lastCommittedValue=null;const{data:n,target:i}=t,{value:r,selectionStart:s,selectionEnd:a}=i;let l=s,c=a;switch(t.inputType){case"deleteWordBackward":{const t=r.substring(0,s).match(/\w*[^\w]*$/);t&&(l-=t[0].length);break}case"deleteWordForward":{const t=r.substring(s).match(/^[^\w]*\w*/);t&&(c+=t[0].length);break}case"deleteContentBackward":s===a&&(l-=1);break;case"deleteContentForward":s===a&&(c+=1)}t.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:r,change:n||"",willCommit:!1,selStart:l,selEnd:c}})})),this._setEventListeners(n,o,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.value))}if(l&&n.addEventListener("blur",l),this.data.comb){const t=(this.data.rect[2]-this.data.rect[0])/s;n.classList.add("comb"),n.style.letterSpacing=`calc(${t}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Is extends ks{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class Ls extends ks{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;"string"==typeof i&&(i="Off"!==i,t.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return As.add(r),r.setAttribute("data-element-id",n),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=e.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",e.exportValue),r.tabIndex=ws,r.addEventListener("change",(i=>{const{name:r,checked:s}=i.target;for(const i of this._getElementsByName(r,n)){const n=s&&i.exportValue===e.exportValue;i.domElement&&(i.domElement.checked=n),t.setValue(i.id,{value:n})}t.setValue(n,{value:s})})),r.addEventListener("resetform",(t=>{const n=e.defaultFieldValue||"Off";t.target.checked=n===e.exportValue})),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",(e=>{const i={value(e){e.target.checked="Off"!==e.detail.value,t.setValue(n,{value:e.target.checked})}};this._dispatchEventFromSandbox(i,e)})),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.checked))),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Ps extends ks{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let i=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if("string"==typeof i&&(i=i!==e.buttonValue,t.setValue(n,{value:i})),i)for(const i of this._getElementsByName(e.fieldName,n))t.setValue(i.id,{value:!1});const r=document.createElement("input");if(As.add(r),r.setAttribute("data-element-id",n),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=e.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=ws,r.addEventListener("change",(e=>{const{name:i,checked:r}=e.target;for(const e of this._getElementsByName(i,n))t.setValue(e.id,{value:!1});t.setValue(n,{value:r})})),r.addEventListener("resetform",(t=>{const n=e.defaultFieldValue;t.target.checked=null!=n&&n===e.buttonValue})),this.enableScripting&&this.hasJSActions){const i=e.buttonValue;r.addEventListener("updatefromsandbox",(e=>{const r={value:e=>{const r=i===e.detail.value;for(const i of this._getElementsByName(e.target.name)){const e=r&&i.id===n;i.domElement&&(i.domElement.checked=e),t.setValue(i.id,{value:e})}}};this._dispatchEventFromSandbox(r,e)})),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.checked))}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Rs extends Ts{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",(t=>{this._dispatchEventFromSandbox({},t)}))),t}}class Ds extends ks{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),i=document.createElement("select");As.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=ws;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",(t=>{const e=this.data.defaultFieldValue;for(const t of i.options)t.selected=t.value===e}));for(const t of this.data.options){const e=document.createElement("option");e.textContent=t.displayValue,e.value=t.exportValue,n.value.includes(t.exportValue)&&(e.setAttribute("selected",!0),r=!1),i.append(e)}let s=null;if(r){const t=document.createElement("option");t.value=" ",t.setAttribute("hidden",!0),t.setAttribute("selected",!0),i.prepend(t),s=()=>{t.remove(),i.removeEventListener("input",s),s=null},i.addEventListener("input",s)}const a=t=>{const e=t?"value":"textContent",{options:n,multiple:r}=i;return r?Array.prototype.filter.call(n,(t=>t.selected)).map((t=>t[e])):-1===n.selectedIndex?null:n[n.selectedIndex][e]};let o=a(!1);const l=t=>{const e=t.target.options;return Array.prototype.map.call(e,(t=>({displayValue:t.textContent,exportValue:t.value})))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",(n=>{const r={value(n){s?.();const r=n.detail.value,l=new Set(Array.isArray(r)?r:[r]);for(const t of i.options)t.selected=l.has(t.value);t.setValue(e,{value:a(!0)}),o=a(!1)},multipleSelection(t){i.multiple=!0},remove(n){const r=i.options,s=n.detail.remove;r[s].selected=!1,i.remove(s),r.length>0&&-1===Array.prototype.findIndex.call(r,(t=>t.selected))&&(r[0].selected=!0),t.setValue(e,{value:a(!0),items:l(n)}),o=a(!1)},clear(n){for(;0!==i.length;)i.remove(0);t.setValue(e,{value:null,items:[]}),o=a(!1)},insert(n){const{index:r,displayValue:s,exportValue:c}=n.detail.insert,d=i.children[r],h=document.createElement("option");h.textContent=s,h.value=c,d?d.before(h):i.append(h),t.setValue(e,{value:a(!0),items:l(n)}),o=a(!1)},items(n){const{items:r}=n.detail;for(;0!==i.length;)i.remove(0);for(const t of r){const{displayValue:e,exportValue:n}=t,r=document.createElement("option");r.textContent=e,r.value=n,i.append(r)}i.options.length>0&&(i.options[0].selected=!0),t.setValue(e,{value:a(!0),items:l(n)}),o=a(!1)},indices(n){const i=new Set(n.detail.indices);for(const t of n.target.options)t.selected=i.has(t.index);t.setValue(e,{value:a(!0)}),o=a(!1)},editable(t){t.target.disabled=!t.detail.editable}};this._dispatchEventFromSandbox(r,n)})),i.addEventListener("input",(n=>{const i=a(!0),r=a(!1);t.setValue(e,{value:i}),n.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:o,change:r,changeEx:i,willCommit:!1,commitKey:1,keyDown:!1}})})),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],(t=>t.target.value))):i.addEventListener("input",(function(n){t.setValue(e,{value:a(!0)})})),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Fs extends Ss{constructor(t){const{data:e,elements:n}=t;super(t,{isRenderable:Ss._hasPopupData(e)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new Os({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const n of this.elements)n.popup=t,n.container.ariaHasPopup="dialog",e.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",e.map((t=>`${Un}${t}`)).join(",")),this.container}}class Os{#xi=this.#Ei.bind(this);#Si=this.#Ti.bind(this);#Ci=this.#ki.bind(this);#Mi=this.#Ii.bind(this);#Li=null;#ut=null;#Pi=null;#Ri=null;#Di=null;#Fi=null;#Oi=null;#Ni=!1;#Bi=null;#T=null;#qi=null;#Hi=null;#ji=null;#mi=null;#zi=!1;constructor({container:t,color:e,elements:n,titleObj:i,modificationDate:r,contentsObj:s,richText:a,parent:o,rect:l,parentRect:c,open:d}){this.#ut=t,this.#ji=i,this.#Pi=s,this.#Hi=a,this.#Fi=o,this.#Li=e,this.#qi=l,this.#Oi=c,this.#Di=n,this.#Ri=ii.toDateObject(r),this.trigger=n.flatMap((t=>t.getElementsToTriggerPopup()));for(const t of this.trigger)t.addEventListener("click",this.#Mi),t.addEventListener("mouseenter",this.#Ci),t.addEventListener("mouseleave",this.#Si),t.classList.add("popupTriggerArea");for(const t of n)t.container?.addEventListener("keydown",this.#xi);this.#ut.hidden=!0,d&&this.#Ii()}render(){if(this.#Bi)return;const t=this.#Bi=document.createElement("div");if(t.className="popup",this.#Li){const e=t.style.outlineColor=qn.makeHexColor(...this.#Li);if(CSS.supports("background-color","color-mix(in srgb, red 30%, white)"))t.style.backgroundColor=`color-mix(in srgb, ${e} 30%, white)`;else{const e=.7;t.style.backgroundColor=qn.makeHexColor(...this.#Li.map((t=>Math.floor(e*(255-t)+t))))}}const e=document.createElement("span");e.className="header";const n=document.createElement("h1");if(e.append(n),({dir:n.dir,str:n.textContent}=this.#ji),t.append(e),this.#Ri){const t=document.createElement("span");t.classList.add("popupDate"),t.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),t.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#Ri.valueOf()})),e.append(t)}const i=this.#Ui;if(i)_s.render({xfaHtml:i,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const e=this._formatContents(this.#Pi);t.append(e)}this.#ut.append(t)}get#Ui(){const t=this.#Hi,e=this.#Pi;return!t?.str||e?.str&&e.str!==t.str?null:this.#Hi.html||null}get#Vi(){return this.#Ui?.attributes?.style?.fontSize||0}get#Gi(){return this.#Ui?.attributes?.style?.color||null}#Wi(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},i={style:{color:this.#Gi,fontSize:this.#Vi?`calc(${this.#Vi}px * var(--scale-factor))`:""}};for(const n of t.split("\n"))e.push({name:"span",value:n,attributes:i});return n}_formatContents({str:t,dir:e}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=e;const i=t.split(/(?:\r\n?|\n)/);for(let t=0,e=i.length;t<e;++t){const r=i[t];n.append(document.createTextNode(r)),t<e-1&&n.append(document.createElement("br"))}return n}#Ei(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||("Enter"===t.key||"Escape"===t.key&&this.#Ni)&&this.#Ii()}updateEdited({rect:t,popupContent:e}){this.#mi||={contentsObj:this.#Pi,richText:this.#Hi},t&&(this.#T=null),e&&(this.#Hi=this.#Wi(e),this.#Pi=null),this.#Bi?.remove(),this.#Bi=null}resetEdited(){this.#mi&&(({contentsObj:this.#Pi,richText:this.#Hi}=this.#mi),this.#mi=null,this.#Bi?.remove(),this.#Bi=null,this.#T=null)}#$i(){if(null!==this.#T)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:i,pageY:r}}}=this.#Fi;let s=!!this.#Oi,a=s?this.#Oi:this.#qi;for(const t of this.#Di)if(!a||null!==qn.intersect(t.data.rect,a)){a=t.data.rect,s=!0;break}const o=qn.normalizeRect([a[0],t[3]-a[1]+t[1],a[2],t[3]-a[3]+t[1]]),l=s?a[2]-a[0]+5:0,c=o[0]+l,d=o[1];this.#T=[100*(c-i)/e,100*(d-r)/n];const{style:h}=this.#ut;h.left=`${this.#T[0]}%`,h.top=`${this.#T[1]}%`}#Ii(){this.#Ni=!this.#Ni,this.#Ni?(this.#ki(),this.#ut.addEventListener("click",this.#Mi),this.#ut.addEventListener("keydown",this.#xi)):(this.#Ti(),this.#ut.removeEventListener("click",this.#Mi),this.#ut.removeEventListener("keydown",this.#xi))}#ki(){this.#Bi||this.render(),this.isVisible?this.#Ni&&this.#ut.classList.add("focused"):(this.#$i(),this.#ut.hidden=!1,this.#ut.style.zIndex=parseInt(this.#ut.style.zIndex)+1e3)}#Ti(){this.#ut.classList.remove("focused"),!this.#Ni&&this.isVisible&&(this.#ut.hidden=!0,this.#ut.style.zIndex=parseInt(this.#ut.style.zIndex)-1e3)}forceHide(){this.#zi=this.isVisible,this.#zi&&(this.#ut.hidden=!0)}maybeShow(){this.#zi&&(this.#Bi||this.#ki(),this.#zi=!1,this.#ut.hidden=!1)}get isVisible(){return!1===this.#ut.hidden}}class Ns extends Ss{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=dn.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Bs extends Ss{#Xi=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:e,height:n}=xs(t.rect),i=this.svgFactory.create(e,n,!0),r=this.#Xi=this.svgFactory.createElement("svg:line");return r.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),r.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),r.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),r.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),r.setAttribute("stroke-width",t.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#Xi}addHighlightArea(){this.container.classList.add("highlightArea")}}class qs extends Ss{#Ki=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:e,height:n}=xs(t.rect),i=this.svgFactory.create(e,n,!0),r=t.borderStyle.width,s=this.#Ki=this.svgFactory.createElement("svg:rect");return s.setAttribute("x",r/2),s.setAttribute("y",r/2),s.setAttribute("width",e-r),s.setAttribute("height",n-r),s.setAttribute("stroke-width",r||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#Ki}addHighlightArea(){this.container.classList.add("highlightArea")}}class Hs extends Ss{#Yi=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:e,height:n}=xs(t.rect),i=this.svgFactory.create(e,n,!0),r=t.borderStyle.width,s=this.#Yi=this.svgFactory.createElement("svg:ellipse");return s.setAttribute("cx",e/2),s.setAttribute("cy",n/2),s.setAttribute("rx",e/2-r/2),s.setAttribute("ry",n/2-r/2),s.setAttribute("stroke-width",r||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#Yi}addHighlightArea(){this.container.classList.add("highlightArea")}}class js extends Ss{#Qi=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:n,popupRef:i}}=this;if(!e)return this.container;const{width:r,height:s}=xs(t),a=this.svgFactory.create(r,s,!0);let o=[];for(let n=0,i=e.length;n<i;n+=2){const i=e[n]-t[0],r=t[3]-e[n+1];o.push(`${i},${r}`)}o=o.join(" ");const l=this.#Qi=this.svgFactory.createElement(this.svgElementName);return l.setAttribute("points",o),l.setAttribute("stroke-width",n.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#Qi}addHighlightArea(){this.container.classList.add("highlightArea")}}class zs extends js{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Us extends Ss{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Vs extends Ss{#Ji=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType="InkHighlight"===this.data.it?dn.HIGHLIGHT:dn.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,inkLists:e,borderStyle:n,popupRef:i}}=this,{width:r,height:s}=xs(t),a=this.svgFactory.create(r,s,!0);for(const i of e){let e=[];for(let n=0,r=i.length;n<r;n+=2){const r=i[n]-t[0],s=t[3]-i[n+1];e.push(`${r},${s}`)}e=e.join(" ");const r=this.svgFactory.createElement(this.svgElementName);this.#Ji.push(r),r.setAttribute("points",e),r.setAttribute("stroke-width",n.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),a.append(r)}return!i&&this.hasPopupData&&this._createPopup(),this.container.append(a),this._editOnDoubleClick(),this.container}getElementsToTriggerPopup(){return this.#Ji}addHighlightArea(){this.container.classList.add("highlightArea")}}class Gs extends Ss{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=dn.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class Ws extends Ss{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class $s extends Ss{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Xs extends Ss{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Ks extends Ss{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=dn.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Ys extends Ss{#Zi=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let n;e.hasAppearance||0===e.fillAlpha?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(100*e.fillAlpha)}%);`)),n.addEventListener("dblclick",this.#tr.bind(this)),this.#Zi=n;const{isMac:i}=Nn.platform;return t.addEventListener("keydown",(t=>{"Enter"===t.key&&(i?t.metaKey:t.ctrlKey)&&this.#tr()})),!e.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),t.append(n),t}getElementsToTriggerPopup(){return this.#Zi}addHighlightArea(){this.container.classList.add("highlightArea")}#tr(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Qs{#er=null;#nr=null;#ir=new Map;#rr=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,annotationEditorUIManager:i,page:r,viewport:s,structTreeLayer:a}){this.div=t,this.#er=e,this.#nr=n,this.#rr=a||null,this.page=r,this.viewport=s,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return this.#ir.size>0}async#sr(t,e){const n=t.firstChild||t,i=n.id=`${Un}${e}`,r=await(this.#rr?.getAriaAttributes(i));if(r)for(const[t,e]of r)n.setAttribute(t,e);this.div.append(t),this.#er?.moveElementInDOM(this.div,t,n,!1)}async render(t){const{annotations:e}=t,n=this.div;li(n,this.viewport);const i=new Map,r={data:null,layer:n,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:!1!==t.renderForms,svgFactory:new ys,annotationStorage:t.annotationStorage||new Ci,enableScripting:!0===t.enableScripting,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const t of e){if(t.noHTML)continue;const e=16===t.annotationType;if(e){const e=i.get(t.id);if(!e)continue;r.elements=e}else{const{width:e,height:n}=xs(t.rect);if(e<=0||n<=0)continue}r.data=t;const n=Es.create(r);if(!n.isRenderable)continue;if(!e&&t.popupRef){const e=i.get(t.popupRef);e?e.push(n):i.set(t.popupRef,[n])}const s=n.render();t.hidden&&(s.style.visibility="hidden"),await this.#sr(s,t.id),n._isEditable&&(this.#ir.set(n.data.id,n),this._annotationEditorUIManager?.renderAnnotationElement(n))}this.#ar()}update({viewport:t}){const e=this.div;this.viewport=t,li(e,{rotation:t.rotation}),this.#ar(),e.hidden=!1}#ar(){if(!this.#nr)return;const t=this.div;for(const[e,n]of this.#nr){const i=t.querySelector(`[data-annotation-id="${e}"]`);if(!i)continue;n.className="annotationContent";const{firstChild:r}=i;r?"CANVAS"===r.nodeName?r.replaceWith(n):r.classList.contains("annotationContent")?r.after(n):r.before(n):i.append(n)}this.#nr.clear()}getEditableAnnotations(){return Array.from(this.#ir.values())}getEditableAnnotation(t){return this.#ir.get(t)}}const Js=/\r\n?|\n/g;class Zs extends _i{#Li;#or="";#lr=`${this.id}-editor`;#cr=null;#Vi;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Zs.prototype,e=t=>t.isEmpty(),n=bi.TRANSLATE_SMALL,i=bi.TRANSLATE_BIG;return Sn(this,"_keyboardManager",new mi([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}]]))}static _type="freetext";static _editorType=dn.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#Li=t.color||Zs._defaultColor||_i._defaultLineColor,this.#Vi=t.fontSize||Zs._defaultFontSize}static initialize(t,e){_i.initialize(t,e);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case hn.FREETEXT_SIZE:Zs._defaultFontSize=e;break;case hn.FREETEXT_COLOR:Zs._defaultColor=e}}updateParams(t,e){switch(t){case hn.FREETEXT_SIZE:this.#dr(e);break;case hn.FREETEXT_COLOR:this.#hr(e)}}static get defaultPropertiesToUpdate(){return[[hn.FREETEXT_SIZE,Zs._defaultFontSize],[hn.FREETEXT_COLOR,Zs._defaultColor||_i._defaultLineColor]]}get propertiesToUpdate(){return[[hn.FREETEXT_SIZE,this.#Vi],[hn.FREETEXT_COLOR,this.#Li]]}#dr(t){const e=t=>{this.editorDiv.style.fontSize=`calc(${t}px * var(--scale-factor))`,this.translate(0,-(t-this.#Vi)*this.parentScale),this.#Vi=t,this.#ur()},n=this.#Vi;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:hn.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#hr(t){const e=t=>{this.#Li=this.editorDiv.style.color=t},n=this.#Li;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:hn.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-Zs._internalPadding*t,-(Zs._internalPadding+this.#Vi)*t]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(dn.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#cr=new AbortController;const t=this._uiManager.combinedSignal(this.#cr);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#lr),this._isDraggable=!0,this.#cr?.abort(),this.#cr=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#pr(){const t=[];this.editorDiv.normalize();let e=null;for(const n of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&"BR"===n.nodeName||(t.push(Zs.#fr(n)),e=n);return t.join("\n")}#ur(){const[t,e]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:t,div:e}=this,i=e.style.display,r=e.classList.contains("hidden");e.classList.remove("hidden"),e.style.display="hidden",t.div.append(this.div),n=e.getBoundingClientRect(),e.remove(),e.style.display=i,e.classList.toggle("hidden",r)}this.rotation%180==this.parentRotation%180?(this.width=n.width/t,this.height=n.height/e):(this.width=n.height/t,this.height=n.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#or,e=this.#or=this.#pr().trimEnd();if(t===e)return;const n=t=>{this.#or=t,t?(this.#gr(),this._uiManager.rebuild(this),this.#ur()):this.remove()};this.addCommands({cmd:()=>{n(e)},undo:()=>{n(t)},mustExec:!1}),this.#ur()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&"Enter"===t.key&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Zs._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,e;this.width&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#lr),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#Vi}px * var(--scale-factor))`,n.color=this.#Li,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),ui(this,this.div,["dblclick","keydown"]),this.width){const[n,i]=this.parentDimensions;if(this.annotationElementId){const{position:r}=this._initialData;let[s,a]=this.getInitialTranslation();[s,a]=this.pageTranslationToScreen(s,a);const[o,l]=this.pageDimensions,[c,d]=this.pageTranslation;let h,u;switch(this.rotation){case 0:h=t+(r[0]-c)/o,u=e+this.height-(r[1]-d)/l;break;case 90:h=t+(r[0]-c)/o,u=e-(r[1]-d)/l,[s,a]=[a,-s];break;case 180:h=t-this.width+(r[0]-c)/o,u=e-(r[1]-d)/l,[s,a]=[-s,-a];break;case 270:h=t+(r[0]-c-this.height*l)/o,u=e+(r[1]-d-this.width*o)/l,[s,a]=[-a,s]}this.setAt(h*n,u*i,s,a)}else this.setAt(t*n,e*i,this.width*n,this.height*i);this.#gr(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#fr(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Js,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:n}=e;if(1===n.length&&"text/plain"===n[0])return;t.preventDefault();const i=Zs.#mr(e.getData("text")||"").replaceAll(Js,"\n");if(!i)return;const r=window.getSelection();if(!r.rangeCount)return;this.editorDiv.normalize(),r.deleteFromDocument();const s=r.getRangeAt(0);if(!i.includes("\n"))return s.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),void r.collapseToStart();const{startContainer:a,startOffset:o}=s,l=[],c=[];if(a.nodeType===Node.TEXT_NODE){const t=a.parentElement;if(c.push(a.nodeValue.slice(o).replaceAll(Js,"")),t!==this.editorDiv){let e=l;for(const n of this.editorDiv.childNodes)n!==t?e.push(Zs.#fr(n)):e=c}l.push(a.nodeValue.slice(0,o).replaceAll(Js,""))}else if(a===this.editorDiv){let t=l,e=0;for(const n of this.editorDiv.childNodes)e++===o&&(t=c),t.push(Zs.#fr(n))}this.#or=`${l.join("\n")}${i}${c.join("\n")}`,this.#gr();const d=new Range;let h=l.reduce(((t,e)=>t+e.length),0);for(const{firstChild:t}of this.editorDiv.childNodes)if(t.nodeType===Node.TEXT_NODE){const e=t.nodeValue.length;if(h<=e){d.setStart(t,h),d.setEnd(t,h);break}h-=e}r.removeAllRanges(),r.addRange(d)}#gr(){if(this.editorDiv.replaceChildren(),this.#or)for(const t of this.#or.split("\n")){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#vr(){return this.#or.replaceAll(" "," ")}static#mr(t){return t.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}static async deserialize(t,e,n){let i=null;if(t instanceof Ns){const{data:{defaultAppearanceData:{fontSize:e,fontColor:n},rect:r,rotation:s,id:a,popupRef:o},textContent:l,textPosition:c,parent:{page:{pageNumber:d}}}=t;if(!l||0===l.length)return null;i=t={annotationType:dn.FREETEXT,color:Array.from(n),fontSize:e,value:l.join("\n"),position:c,pageIndex:d-1,rect:r.slice(0),rotation:s,id:a,deleted:!1,popupRef:o}}const r=await super.deserialize(t,e,n);return r.#Vi=t.fontSize,r.#Li=qn.makeHexColor(...t.color),r.#or=Zs.#mr(t.value),r.annotationElementId=t.id||null,r._initialData=i,r}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=Zs._internalPadding*this.parentScale,n=this.getRect(e,e),i=_i._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#Li),r={annotationType:dn.FREETEXT,color:i,fontSize:this.#Vi,value:this.#vr(),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?r:this.annotationElementId&&!this.#br(r)?null:(r.id=this.annotationElementId,r)}#br(t){const{value:e,fontSize:n,color:i,pageIndex:r}=this._initialData;return this._hasBeenMoved||t.value!==e||t.fontSize!==n||t.color.some(((t,e)=>t!==i[e]))||t.pageIndex!==r}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(this.deleted)return e;const{style:n}=e;n.fontSize=`calc(${this.#Vi}px * var(--scale-factor))`,n.color=this.#Li,e.replaceChildren();for(const t of this.#or.split("\n")){const n=document.createElement("div");n.append(t?document.createTextNode(t):document.createElement("br")),e.append(n)}const i=Zs._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(i,i),popupContent:this.#or}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class ta{toSVGPath(){An("Abstract method `toSVGPath` must be implemented.")}get box(){An("Abstract getter `box` must be implemented.")}serialize(t,e){An("Abstract method `serialize` must be implemented.")}get classNamesForDrawing(){An("Abstract getter `classNamesForDrawing` must be implemented.")}get classNamesForOutlining(){An("Abstract getter `classNamesForOutlining` must be implemented.")}get mustRemoveSelfIntersections(){return!1}}class ea{#yr;#_r=[];#wr;#Ar;#xr=[];#Er=new Float64Array(18);#Sr;#Tr;#Cr;#kr;#Mr;#Ir;#Lr=[];static#Pr=8;static#Rr=2;static#Dr=ea.#Pr+ea.#Rr;constructor({x:t,y:e},n,i,r,s,a=0){this.#yr=n,this.#Ir=r*i,this.#Ar=s,this.#Er.set([NaN,NaN,NaN,NaN,t,e],6),this.#wr=a,this.#kr=ea.#Pr*i,this.#Cr=ea.#Dr*i,this.#Mr=i,this.#Lr.push(t,e)}isEmpty(){return isNaN(this.#Er[8])}#Fr(){const t=this.#Er.subarray(4,6),e=this.#Er.subarray(16,18),[n,i,r,s]=this.#yr;return[(this.#Sr+(t[0]-e[0])/2-n)/r,(this.#Tr+(t[1]-e[1])/2-i)/s,(this.#Sr+(e[0]-t[0])/2-n)/r,(this.#Tr+(e[1]-t[1])/2-i)/s]}add({x:t,y:e}){this.#Sr=t,this.#Tr=e;const[n,i,r,s]=this.#yr;let[a,o,l,c]=this.#Er.subarray(8,12);const d=t-l,h=e-c,u=Math.hypot(d,h);if(u<this.#Cr)return!1;const p=u-this.#kr,f=p/u,g=f*d,m=f*h;let v=a,b=o;a=l,o=c,l+=g,c+=m,this.#Lr?.push(t,e);const y=g/p,_=-m/p*this.#Ir,w=y*this.#Ir;return this.#Er.set(this.#Er.subarray(2,8),0),this.#Er.set([l+_,c+w],4),this.#Er.set(this.#Er.subarray(14,18),12),this.#Er.set([l-_,c-w],16),isNaN(this.#Er[6])?(0===this.#xr.length&&(this.#Er.set([a+_,o+w],2),this.#xr.push(NaN,NaN,NaN,NaN,(a+_-n)/r,(o+w-i)/s),this.#Er.set([a-_,o-w],14),this.#_r.push(NaN,NaN,NaN,NaN,(a-_-n)/r,(o-w-i)/s)),this.#Er.set([v,b,a,o,l,c],6),!this.isEmpty()):(this.#Er.set([v,b,a,o,l,c],6),Math.abs(Math.atan2(b-o,v-a)-Math.atan2(m,g))<Math.PI/2?([a,o,l,c]=this.#Er.subarray(2,6),this.#xr.push(NaN,NaN,NaN,NaN,((a+l)/2-n)/r,((o+c)/2-i)/s),[a,o,v,b]=this.#Er.subarray(14,18),this.#_r.push(NaN,NaN,NaN,NaN,((v+a)/2-n)/r,((b+o)/2-i)/s),!0):([v,b,a,o,l,c]=this.#Er.subarray(0,6),this.#xr.push(((v+5*a)/6-n)/r,((b+5*o)/6-i)/s,((5*a+l)/6-n)/r,((5*o+c)/6-i)/s,((a+l)/2-n)/r,((o+c)/2-i)/s),[l,c,a,o,v,b]=this.#Er.subarray(12,18),this.#_r.push(((v+5*a)/6-n)/r,((b+5*o)/6-i)/s,((5*a+l)/6-n)/r,((5*o+c)/6-i)/s,((a+l)/2-n)/r,((o+c)/2-i)/s),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#xr,e=this.#_r;if(isNaN(this.#Er[6])&&!this.isEmpty())return this.#Or();const n=[];n.push(`M${t[4]} ${t[5]}`);for(let e=6;e<t.length;e+=6)isNaN(t[e])?n.push(`L${t[e+4]} ${t[e+5]}`):n.push(`C${t[e]} ${t[e+1]} ${t[e+2]} ${t[e+3]} ${t[e+4]} ${t[e+5]}`);this.#Nr(n);for(let t=e.length-6;t>=6;t-=6)isNaN(e[t])?n.push(`L${e[t+4]} ${e[t+5]}`):n.push(`C${e[t]} ${e[t+1]} ${e[t+2]} ${e[t+3]} ${e[t+4]} ${e[t+5]}`);return this.#Br(n),n.join(" ")}#Or(){const[t,e,n,i]=this.#yr,[r,s,a,o]=this.#Fr();return`M${(this.#Er[2]-t)/n} ${(this.#Er[3]-e)/i} L${(this.#Er[4]-t)/n} ${(this.#Er[5]-e)/i} L${r} ${s} L${a} ${o} L${(this.#Er[16]-t)/n} ${(this.#Er[17]-e)/i} L${(this.#Er[14]-t)/n} ${(this.#Er[15]-e)/i} Z`}#Br(t){const e=this.#_r;t.push(`L${e[4]} ${e[5]} Z`)}#Nr(t){const[e,n,i,r]=this.#yr,s=this.#Er.subarray(4,6),a=this.#Er.subarray(16,18),[o,l,c,d]=this.#Fr();t.push(`L${(s[0]-e)/i} ${(s[1]-n)/r} L${o} ${l} L${c} ${d} L${(a[0]-e)/i} ${(a[1]-n)/r}`)}newFreeDrawOutline(t,e,n,i,r,s){return new na(t,e,n,i,r,s)}getOutlines(){const t=this.#xr,e=this.#_r,n=this.#Er,[i,r,s,a]=this.#yr,o=new Float64Array((this.#Lr?.length??0)+2);for(let t=0,e=o.length-2;t<e;t+=2)o[t]=(this.#Lr[t]-i)/s,o[t+1]=(this.#Lr[t+1]-r)/a;if(o[o.length-2]=(this.#Sr-i)/s,o[o.length-1]=(this.#Tr-r)/a,isNaN(n[6])&&!this.isEmpty())return this.#qr(o);const l=new Float64Array(this.#xr.length+24+this.#_r.length);let c=t.length;for(let e=0;e<c;e+=2)isNaN(t[e])?l[e]=l[e+1]=NaN:(l[e]=t[e],l[e+1]=t[e+1]);c=this.#Hr(l,c);for(let t=e.length-6;t>=6;t-=6)for(let n=0;n<6;n+=2)isNaN(e[t+n])?(l[c]=l[c+1]=NaN,c+=2):(l[c]=e[t+n],l[c+1]=e[t+n+1],c+=2);return this.#jr(l,c),this.newFreeDrawOutline(l,o,this.#yr,this.#Mr,this.#wr,this.#Ar)}#qr(t){const e=this.#Er,[n,i,r,s]=this.#yr,[a,o,l,c]=this.#Fr(),d=new Float64Array(36);return d.set([NaN,NaN,NaN,NaN,(e[2]-n)/r,(e[3]-i)/s,NaN,NaN,NaN,NaN,(e[4]-n)/r,(e[5]-i)/s,NaN,NaN,NaN,NaN,a,o,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,(e[16]-n)/r,(e[17]-i)/s,NaN,NaN,NaN,NaN,(e[14]-n)/r,(e[15]-i)/s],0),this.newFreeDrawOutline(d,t,this.#yr,this.#Mr,this.#wr,this.#Ar)}#jr(t,e){const n=this.#_r;return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+6}#Hr(t,e){const n=this.#Er.subarray(4,6),i=this.#Er.subarray(16,18),[r,s,a,o]=this.#yr,[l,c,d,h]=this.#Fr();return t.set([NaN,NaN,NaN,NaN,(n[0]-r)/a,(n[1]-s)/o,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,d,h,NaN,NaN,NaN,NaN,(i[0]-r)/a,(i[1]-s)/o],e),e+24}}class na extends ta{#yr;#zr=null;#wr;#Ar;#Lr;#Mr;#Ur;constructor(t,e,n,i,r,s){super(),this.#Ur=t,this.#Lr=e,this.#yr=n,this.#Mr=i,this.#wr=r,this.#Ar=s,this.#Vr(s);const{x:a,y:o,width:l,height:c}=this.#zr;for(let e=0,n=t.length;e<n;e+=2)t[e]=(t[e]-a)/l,t[e+1]=(t[e+1]-o)/c;for(let t=0,n=e.length;t<n;t+=2)e[t]=(e[t]-a)/l,e[t+1]=(e[t+1]-o)/c}toSVGPath(){const t=[`M${this.#Ur[4]} ${this.#Ur[5]}`];for(let e=6,n=this.#Ur.length;e<n;e+=6)isNaN(this.#Ur[e])?t.push(`L${this.#Ur[e+4]} ${this.#Ur[e+5]}`):t.push(`C${this.#Ur[e]} ${this.#Ur[e+1]} ${this.#Ur[e+2]} ${this.#Ur[e+3]} ${this.#Ur[e+4]} ${this.#Ur[e+5]}`);return t.push("Z"),t.join(" ")}serialize([t,e,n,i],r){const s=n-t,a=i-e;let o,l;switch(r){case 0:o=this.#Gr(this.#Ur,t,i,s,-a),l=this.#Gr(this.#Lr,t,i,s,-a);break;case 90:o=this.#Wr(this.#Ur,t,e,s,a),l=this.#Wr(this.#Lr,t,e,s,a);break;case 180:o=this.#Gr(this.#Ur,n,e,-s,a),l=this.#Gr(this.#Lr,n,e,-s,a);break;case 270:o=this.#Wr(this.#Ur,n,i,-s,-a),l=this.#Wr(this.#Lr,n,i,-s,-a)}return{outline:Array.from(o),points:[Array.from(l)]}}#Gr(t,e,n,i,r){const s=new Float64Array(t.length);for(let a=0,o=t.length;a<o;a+=2)s[a]=e+t[a]*i,s[a+1]=n+t[a+1]*r;return s}#Wr(t,e,n,i,r){const s=new Float64Array(t.length);for(let a=0,o=t.length;a<o;a+=2)s[a]=e+t[a+1]*i,s[a+1]=n+t[a]*r;return s}#Vr(t){const e=this.#Ur;let n=e[4],i=e[5],r=n,s=i,a=n,o=i,l=n,c=i;const d=t?Math.max:Math.min;for(let t=6,h=e.length;t<h;t+=6){if(isNaN(e[t]))r=Math.min(r,e[t+4]),s=Math.min(s,e[t+5]),a=Math.max(a,e[t+4]),o=Math.max(o,e[t+5]),c<e[t+5]?(l=e[t+4],c=e[t+5]):c===e[t+5]&&(l=d(l,e[t+4]));else{const h=qn.bezierBoundingBox(n,i,...e.slice(t,t+6));r=Math.min(r,h[0]),s=Math.min(s,h[1]),a=Math.max(a,h[2]),o=Math.max(o,h[3]),c<h[3]?(l=h[2],c=h[3]):c===h[3]&&(l=d(l,h[2]))}n=e[t+4],i=e[t+5]}const h=r-this.#wr,u=s-this.#wr,p=a-r+2*this.#wr,f=o-s+2*this.#wr;this.#zr={x:h,y:u,width:p,height:f,lastPoint:[l,c]}}get box(){return this.#zr}newOutliner(t,e,n,i,r,s=0){return new ea(t,e,n,i,r,s)}getNewOutline(t,e){const{x:n,y:i,width:r,height:s}=this.#zr,[a,o,l,c]=this.#yr,d=r*l,h=s*c,u=n*l+a,p=i*c+o,f=this.newOutliner({x:this.#Lr[0]*d+u,y:this.#Lr[1]*h+p},this.#yr,this.#Mr,t,this.#Ar,e??this.#wr);for(let t=2;t<this.#Lr.length;t+=2)f.add({x:this.#Lr[t]*d+u,y:this.#Lr[t+1]*h+p});return f.getOutlines()}get mustRemoveSelfIntersections(){return!0}}class ia{#yr;#$r=[];#Xr=[];constructor(t,e=0,n=0,i=!0){let r=1/0,s=-1/0,a=1/0,o=-1/0;const l=10**-4;for(const{x:n,y:i,width:c,height:d}of t){const t=Math.floor((n-e)/l)*l,h=Math.ceil((n+c+e)/l)*l,u=Math.floor((i-e)/l)*l,p=Math.ceil((i+d+e)/l)*l,f=[t,u,p,!0],g=[h,u,p,!1];this.#$r.push(f,g),r=Math.min(r,t),s=Math.max(s,h),a=Math.min(a,u),o=Math.max(o,p)}const c=s-r+2*n,d=o-a+2*n,h=r-n,u=a-n,p=this.#$r.at(i?-1:-2),f=[p[0],p[2]];for(const t of this.#$r){const[e,n,i]=t;t[0]=(e-h)/c,t[1]=(n-u)/d,t[2]=(i-u)/d}this.#yr={x:h,y:u,width:c,height:d,lastPoint:f}}getOutlines(){this.#$r.sort(((t,e)=>t[0]-e[0]||t[1]-e[1]||t[2]-e[2]));const t=[];for(const e of this.#$r)e[3]?(t.push(...this.#Kr(e)),this.#Yr(e)):(this.#Qr(e),t.push(...this.#Kr(e)));return this.#Jr(t)}#Jr(t){const e=[],n=new Set;for(const n of t){const[t,i,r]=n;e.push([t,i,n],[t,r,n])}e.sort(((t,e)=>t[1]-e[1]||t[0]-e[0]));for(let t=0,i=e.length;t<i;t+=2){const i=e[t][2],r=e[t+1][2];i.push(r),r.push(i),n.add(i),n.add(r)}const i=[];let r;for(;n.size>0;){const t=n.values().next().value;let[e,s,a,o,l]=t;n.delete(t);let c=e,d=s;for(r=[e,a],i.push(r);;){let t;if(n.has(o))t=o;else{if(!n.has(l))break;t=l}n.delete(t),[e,s,a,o,l]=t,c!==e&&(r.push(c,d,e,d===s?s:a),c=e),d=d===s?a:s}r.push(c,d)}return new ra(i,this.#yr)}#Zr(t){const e=this.#Xr;let n=0,i=e.length-1;for(;n<=i;){const r=n+i>>1,s=e[r][0];if(s===t)return r;s<t?n=r+1:i=r-1}return i+1}#Yr([,t,e]){const n=this.#Zr(t);this.#Xr.splice(n,0,[t,e])}#Qr([,t,e]){const n=this.#Zr(t);for(let i=n;i<this.#Xr.length;i++){const[n,r]=this.#Xr[i];if(n!==t)break;if(n===t&&r===e)return void this.#Xr.splice(i,1)}for(let i=n-1;i>=0;i--){const[n,r]=this.#Xr[i];if(n!==t)break;if(n===t&&r===e)return void this.#Xr.splice(i,1)}}#Kr(t){const[e,n,i]=t,r=[[e,n,i]],s=this.#Zr(i);for(let t=0;t<s;t++){const[n,i]=this.#Xr[t];for(let t=0,s=r.length;t<s;t++){const[,a,o]=r[t];if(!(i<=a||o<=n))if(a>=n)if(o>i)r[t][1]=i;else{if(1===s)return[];r.splice(t,1),t--,s--}else r[t][2]=n,o>i&&r.push([e,i,o])}}return r}}class ra extends ta{#yr;#ts;constructor(t,e){super(),this.#ts=t,this.#yr=e}toSVGPath(){const t=[];for(const e of this.#ts){let[n,i]=e;t.push(`M${n} ${i}`);for(let r=2;r<e.length;r+=2){const s=e[r],a=e[r+1];s===n?(t.push(`V${a}`),i=a):a===i&&(t.push(`H${s}`),n=s)}t.push("Z")}return t.join(" ")}serialize([t,e,n,i],r){const s=[],a=n-t,o=i-e;for(const e of this.#ts){const n=new Array(e.length);for(let r=0;r<e.length;r+=2)n[r]=t+e[r]*a,n[r+1]=i-e[r+1]*o;s.push(n)}return s}get box(){return this.#yr}get classNamesForDrawing(){return["highlight"]}get classNamesForOutlining(){return["highlightOutline"]}}class sa extends ea{newFreeDrawOutline(t,e,n,i,r,s){return new aa(t,e,n,i,r,s)}get classNamesForDrawing(){return["highlight","free"]}}class aa extends na{get classNamesForDrawing(){return["highlight","free"]}get classNamesForOutlining(){return["highlightOutline","free"]}newOutliner(t,e,n,i,r,s=0){return new sa(t,e,n,i,r,s)}}class oa{#es=null;#ns=null;#is;#rs=null;#ss=!1;#as=!1;#s=null;#os;#ls=null;#g=null;#cs;static#ds=null;static get _keyboardManager(){return Sn(this,"_keyboardManager",new mi([[["Escape","mac+Escape"],oa.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],oa.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],oa.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],oa.prototype._moveToPrevious],[["Home","mac+Home"],oa.prototype._moveToBeginning],[["End","mac+End"],oa.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#as=!1,this.#cs=hn.HIGHLIGHT_COLOR,this.#s=t):(this.#as=!0,this.#cs=hn.HIGHLIGHT_DEFAULT_COLOR),this.#g=t?._uiManager||e,this.#os=this.#g._eventBus,this.#is=t?.color||this.#g?.highlightColors.values().next().value||"#FFFF98",oa.#ds||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#es=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=this.#g._signal;t.addEventListener("click",this.#hs.bind(this),{signal:e}),t.addEventListener("keydown",this.#Ei.bind(this),{signal:e});const n=this.#ns=document.createElement("span");return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=this.#is,t.append(n),t}renderMainDropdown(){const t=this.#rs=this.#us();return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}#us(){const t=document.createElement("div"),e=this.#g._signal;t.addEventListener("contextmenu",ei,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[n,i]of this.#g.highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=n,r.setAttribute("data-l10n-id",oa.#ds[n]);const s=document.createElement("span");r.append(s),s.className="swatch",s.style.backgroundColor=i,r.setAttribute("aria-selected",i===this.#is),r.addEventListener("click",this.#ps.bind(this,i),{signal:e}),t.append(r)}return t.addEventListener("keydown",this.#Ei.bind(this),{signal:e}),t}#ps(t,e){e.stopPropagation(),this.#os.dispatch("switchannotationeditorparams",{source:this,type:this.#cs,value:t})}_colorSelectFromKeyboard(t){if(t.target===this.#es)return void this.#hs(t);const e=t.target.getAttribute("data-color");e&&this.#ps(e,t)}_moveToNext(t){this.#fs?t.target!==this.#es?t.target.nextSibling?.focus():this.#rs.firstChild?.focus():this.#hs(t)}_moveToPrevious(t){t.target!==this.#rs?.firstChild&&t.target!==this.#es?(this.#fs||this.#hs(t),t.target.previousSibling?.focus()):this.#fs&&this._hideDropdownFromKeyboard()}_moveToBeginning(t){this.#fs?this.#rs.firstChild?.focus():this.#hs(t)}_moveToEnd(t){this.#fs?this.#rs.lastChild?.focus():this.#hs(t)}#Ei(t){oa._keyboardManager.exec(this,t)}#hs(t){if(this.#fs)return void this.hideDropdown();if(this.#ss=0===t.detail,this.#ls||(this.#ls=new AbortController,window.addEventListener("pointerdown",this.#c.bind(this),{signal:this.#g.combinedSignal(this.#ls)})),this.#rs)return void this.#rs.classList.remove("hidden");const e=this.#rs=this.#us();this.#es.append(e)}#c(t){this.#rs?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#rs?.classList.add("hidden"),this.#ls?.abort(),this.#ls=null}get#fs(){return this.#rs&&!this.#rs.classList.contains("hidden")}_hideDropdownFromKeyboard(){this.#as||(this.#fs?(this.hideDropdown(),this.#es.focus({preventScroll:!0,focusVisible:this.#ss})):this.#s?.unselect())}updateColor(t){if(this.#ns&&(this.#ns.style.backgroundColor=t),!this.#rs)return;const e=this.#g.highlightColors.values();for(const n of this.#rs.children)n.setAttribute("aria-selected",e.next().value===t)}destroy(){this.#es?.remove(),this.#es=null,this.#ns=null,this.#rs?.remove(),this.#rs=null}}class la extends _i{#gs=null;#ms=0;#vs;#bs=null;#r=null;#ys=null;#_s=null;#ws=0;#As=null;#xs=null;#y=null;#Es=!1;#Ss=null;#Ts;#Cs=null;#ks="";#Ir;#Ms="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=dn.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=la.prototype;return Sn(this,"_keyboardManager",new mi([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||la._defaultColor,this.#Ir=t.thickness||la._defaultThickness,this.#Ts=t.opacity||la._defaultOpacity,this.#vs=t.boxes||null,this.#Ms=t.methodOfCreation||"",this.#ks=t.text||"",this._isDraggable=!1,t.highlightId>-1?(this.#Es=!0,this.#Is(t),this.#Ls()):this.#vs&&(this.#gs=t.anchorNode,this.#ms=t.anchorOffset,this.#_s=t.focusNode,this.#ws=t.focusOffset,this.#Ps(),this.#Ls(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#Es?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#Ir,methodOfCreation:this.#Ms}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#Ps(){const t=new ia(this.#vs,.001);this.#xs=t.getOutlines(),({x:this.x,y:this.y,width:this.width,height:this.height}=this.#xs.box);const e=new ia(this.#vs,.0025,.001,"ltr"===this._uiManager.direction);this.#ys=e.getOutlines();const{lastPoint:n}=this.#ys.box;this.#Ss=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#Is({highlightOutlines:t,highlightId:e,clipPathId:n}){if(this.#xs=t,this.#ys=t.getNewOutline(this.#Ir/2+1.5,.0025),e>=0)this.#y=e,this.#bs=n,this.parent.drawLayer.finalizeLine(e,t),this.#Cs=this.parent.drawLayer.drawOutline(this.#ys);else if(this.parent){const e=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(this.#y,t),this.parent.drawLayer.updateBox(this.#y,la.#Rs(this.#xs.box,(e-this.rotation+360)%360)),this.parent.drawLayer.updateLine(this.#Cs,this.#ys),this.parent.drawLayer.updateBox(this.#Cs,la.#Rs(this.#ys.box,e))}const{x:i,y:r,width:s,height:a}=t.box;switch(this.rotation){case 0:this.x=i,this.y=r,this.width=s,this.height=a;break;case 90:{const[t,e]=this.parentDimensions;this.x=r,this.y=1-i,this.width=s*e/t,this.height=a*t/e;break}case 180:this.x=1-i,this.y=1-r,this.width=s,this.height=a;break;case 270:{const[t,e]=this.parentDimensions;this.x=1-r,this.y=i,this.width=s*e/t,this.height=a*t/e;break}}const{lastPoint:o}=this.#ys.box;this.#Ss=[(o[0]-i)/s,(o[1]-r)/a]}static initialize(t,e){_i.initialize(t,e),la._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case hn.HIGHLIGHT_DEFAULT_COLOR:la._defaultColor=e;break;case hn.HIGHLIGHT_THICKNESS:la._defaultThickness=e}}translateInPage(t,e){}get toolbarPosition(){return this.#Ss}updateParams(t,e){switch(t){case hn.HIGHLIGHT_COLOR:this.#hr(e);break;case hn.HIGHLIGHT_THICKNESS:this.#Ds(e)}}static get defaultPropertiesToUpdate(){return[[hn.HIGHLIGHT_DEFAULT_COLOR,la._defaultColor],[hn.HIGHLIGHT_THICKNESS,la._defaultThickness]]}get propertiesToUpdate(){return[[hn.HIGHLIGHT_COLOR,this.color||la._defaultColor],[hn.HIGHLIGHT_THICKNESS,this.#Ir||la._defaultThickness],[hn.HIGHLIGHT_FREE,this.#Es]]}#hr(t){const e=(t,e)=>{this.color=t,this.parent?.drawLayer.changeColor(this.#y,t),this.#r?.updateColor(t),this.#Ts=e,this.parent?.drawLayer.changeOpacity(this.#y,e)},n=this.color,i=this.#Ts;this.addCommands({cmd:e.bind(this,t,la._defaultOpacity),undo:e.bind(this,n,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:hn.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)}#Ds(t){const e=this.#Ir,n=t=>{this.#Ir=t,this.#Fs(t)};this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:hn.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(this.#r=new oa({editor:this}),t.addColorPicker(this.#r)),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#Os())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#Os())}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this.div.focus()}remove(){this.#Ns(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.#Ls(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#Ns():t&&(this.#Ls(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#Fs(t){if(!this.#Es)return;this.#Is({highlightOutlines:this.#xs.getNewOutline(t/2)}),this.fixAndSetPosition();const[e,n]=this.parentDimensions;this.setDims(this.width*e,this.height*n)}#Ns(){null!==this.#y&&this.parent&&(this.parent.drawLayer.remove(this.#y),this.#y=null,this.parent.drawLayer.remove(this.#Cs),this.#Cs=null)}#Ls(t=this.parent){null===this.#y&&(({id:this.#y,clipPathId:this.#bs}=t.drawLayer.draw(this.#xs,this.color,this.#Ts)),this.#Cs=t.drawLayer.drawOutline(this.#ys),this.#As&&(this.#As.style.clipPath=this.#bs))}static#Rs({x:t,y:e,width:n,height:i},r){switch(r){case 90:return{x:1-e-i,y:t,width:i,height:n};case 180:return{x:1-t-n,y:1-e-i,width:n,height:i};case 270:return{x:e,y:1-t-n,width:i,height:n}}return{x:t,y:e,width:n,height:i}}rotate(t){const{drawLayer:e}=this.parent;let n;this.#Es?(t=(t-this.rotation+360)%360,n=la.#Rs(this.#xs.box,t)):n=la.#Rs(this,t),e.rotate(this.#y,t),e.rotate(this.#Cs,t),e.updateBox(this.#y,n),e.updateBox(this.#Cs,la.#Rs(this.#ys.box,t))}render(){if(this.div)return this.div;const t=super.render();this.#ks&&(t.setAttribute("aria-label",this.#ks),t.setAttribute("role","mark")),this.#Es?t.classList.add("free"):this.div.addEventListener("keydown",this.#Bs.bind(this),{signal:this._uiManager._signal});const e=this.#As=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#bs;const[n,i]=this.parentDimensions;return this.setDims(this.width*n,this.height*i),ui(this,this.#As,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent.drawLayer.addClass(this.#Cs,"hovered")}pointerleave(){this.isSelected||this.parent.drawLayer.removeClass(this.#Cs,"hovered")}#Bs(t){la._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#qs(!0);break;case 1:case 3:this.#qs(!1)}}#qs(t){if(!this.#gs)return;const e=window.getSelection();t?e.setPosition(this.#gs,this.#ms):e.setPosition(this.#_s,this.#ws)}select(){super.select(),this.#Cs&&(this.parent?.drawLayer.removeClass(this.#Cs,"hovered"),this.parent?.drawLayer.addClass(this.#Cs,"selected"))}unselect(){super.unselect(),this.#Cs&&(this.parent?.drawLayer.removeClass(this.#Cs,"selected"),this.#Es||this.#qs(!1))}get _mustFixPosition(){return!this.#Es}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.show(this.#y,t),this.parent.drawLayer.show(this.#Cs,t))}#Os(){return this.#Es?this.rotation:0}#Hs(){if(this.#Es)return null;const[t,e]=this.pageDimensions,[n,i]=this.pageTranslation,r=this.#vs,s=new Float32Array(8*r.length);let a=0;for(const{x:o,y:l,width:c,height:d}of r){const r=o*t+n,h=(1-l-d)*e+i;s[a]=s[a+4]=r,s[a+1]=s[a+3]=h,s[a+2]=s[a+6]=r+c*t,s[a+5]=s[a+7]=h+d*e,a+=8}return s}#js(t){return this.#xs.serialize(t,this.#Os())}static startHighlighting(t,e,{target:n,x:i,y:r}){const{x:s,y:a,width:o,height:l}=n.getBoundingClientRect(),c=new AbortController,d=t.combinedSignal(c),h=e=>{c.abort(),this.#zs(t,e)};window.addEventListener("blur",h,{signal:d}),window.addEventListener("pointerup",h,{signal:d}),window.addEventListener("pointerdown",(t=>{t.preventDefault(),t.stopPropagation()}),{capture:!0,passive:!1,signal:d}),window.addEventListener("contextmenu",ei,{signal:d}),n.addEventListener("pointermove",this.#Us.bind(this,t),{signal:d}),this._freeHighlight=new sa({x:i,y:r},[s,a,o,l],t.scale,this._defaultThickness/2,e,.001),({id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0))}static#Us(t,e){this._freeHighlight.add(e)&&t.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)}static#zs(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,n){let i=null;if(t instanceof Gs){const{data:{quadPoints:e,rect:n,rotation:r,id:s,color:a,opacity:o,popupRef:l},parent:{page:{pageNumber:c}}}=t;i=t={annotationType:dn.HIGHLIGHT,color:Array.from(a),opacity:o,quadPoints:e,boxes:null,pageIndex:c-1,rect:n.slice(0),rotation:r,id:s,deleted:!1,popupRef:l}}else if(t instanceof Vs){const{data:{inkLists:e,rect:n,rotation:r,id:s,color:a,borderStyle:{rawWidth:o},popupRef:l},parent:{page:{pageNumber:c}}}=t;i=t={annotationType:dn.HIGHLIGHT,color:Array.from(a),thickness:o,inkLists:e,boxes:null,pageIndex:c-1,rect:n.slice(0),rotation:r,id:s,deleted:!1,popupRef:l}}const{color:r,quadPoints:s,inkLists:a,opacity:o}=t,l=await super.deserialize(t,e,n);l.color=qn.makeHexColor(...r),l.#Ts=o||1,a&&(l.#Ir=t.thickness),l.annotationElementId=t.id||null,l._initialData=i;const[c,d]=l.pageDimensions,[h,u]=l.pageTranslation;if(s){const t=l.#vs=[];for(let e=0;e<s.length;e+=8)t.push({x:(s[e]-h)/c,y:1-(s[e+1]-u)/d,width:(s[e+2]-s[e])/c,height:(s[e+1]-s[e+5])/d});l.#Ps(),l.#Ls(),l.rotate(l.rotation)}else if(a){l.#Es=!0;const t=a[0],n={x:t[0]-h,y:d-(t[1]-u)},i=new sa(n,[0,0,c,d],1,l.#Ir/2,!0,.001);for(let e=0,r=t.length;e<r;e+=2)n.x=t[e]-h,n.y=d-(t[e+1]-u),i.add(n);const{id:r,clipPathId:s}=e.drawLayer.draw(i,l.color,l._defaultOpacity,!0);l.#Is({highlightOutlines:i.getOutlines(),highlightId:r,clipPathId:s}),l.#Ls()}return l}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=this.getRect(0,0),n=_i._colorManager.convert(this.color),i={annotationType:dn.HIGHLIGHT,color:n,opacity:this.#Ts,thickness:this.#Ir,quadPoints:this.#Hs(),outlines:this.#js(e),pageIndex:this.pageIndex,rect:e,rotation:this.#Os(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#br(i)?null:(i.id=this.annotationElementId,i)}#br(t){const{color:e}=this._initialData;return t.color.some(((t,n)=>t!==e[n]))}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class ca extends _i{#Vs=0;#Gs=0;#Ws=null;#$s=new Path2D;#Xs=!1;#Ks=null;#Ys=!1;#Qs=!1;#Js=null;#Zs=null;#ta=0;#ea=0;#na=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";static _editorType=dn.INK;constructor(t){super({...t,name:"inkEditor"}),this.color=t.color||null,this.thickness=t.thickness||null,this.opacity=t.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(t,e){_i.initialize(t,e)}static updateDefaultParams(t,e){switch(t){case hn.INK_THICKNESS:ca._defaultThickness=e;break;case hn.INK_COLOR:ca._defaultColor=e;break;case hn.INK_OPACITY:ca._defaultOpacity=e/100}}updateParams(t,e){switch(t){case hn.INK_THICKNESS:this.#Ds(e);break;case hn.INK_COLOR:this.#hr(e);break;case hn.INK_OPACITY:this.#ia(e)}}static get defaultPropertiesToUpdate(){return[[hn.INK_THICKNESS,ca._defaultThickness],[hn.INK_COLOR,ca._defaultColor||_i._defaultLineColor],[hn.INK_OPACITY,Math.round(100*ca._defaultOpacity)]]}get propertiesToUpdate(){return[[hn.INK_THICKNESS,this.thickness||ca._defaultThickness],[hn.INK_COLOR,this.color||ca._defaultColor||_i._defaultLineColor],[hn.INK_OPACITY,Math.round(100*(this.opacity??ca._defaultOpacity))]]}#Ds(t){const e=t=>{this.thickness=t,this.#ra()},n=this.thickness;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:hn.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#hr(t){const e=t=>{this.color=t,this.#sa()},n=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:hn.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#ia(t){const e=t=>{this.opacity=t,this.#sa()};t/=100;const n=this.opacity;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:hn.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.canvas||(this.#aa(),this.#oa()),this.isAttachedToDOM||(this.parent.add(this),this.#la()),this.#ra()))}remove(){null!==this.canvas&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#Ws&&(clearTimeout(this.#Ws),this.#Ws=null),this.#Js?.disconnect(),this.#Js=null,super.remove())}setParent(t){!this.parent&&t?this._uiManager.removeShouldRescale(this):this.parent&&null===t&&this._uiManager.addShouldRescale(this),super.setParent(t)}onScaleChanging(){const[t,e]=this.parentDimensions,n=this.width*t,i=this.height*e;this.setDimensions(n,i)}enableEditMode(){this.#Xs||null===this.canvas||(super.enableEditMode(),this._isDraggable=!1,this.#ca())}disableEditMode(){this.isInEditMode()&&null!==this.canvas&&(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.#da())}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return 0===this.paths.length||1===this.paths.length&&0===this.paths[0].length}#ha(){const{parentRotation:t,parentDimensions:[e,n]}=this;switch(t){case 90:return[0,n,n,e];case 180:return[e,n,e,n];case 270:return[e,0,n,e];default:return[0,0,e,n]}}#ua(){const{ctx:t,color:e,opacity:n,thickness:i,parentScale:r,scaleFactor:s}=this;t.lineWidth=i*r/s,t.lineCap="round",t.lineJoin="round",t.miterLimit=10,t.strokeStyle=`${e}${function(t){return Math.round(Math.min(255,Math.max(1,255*t))).toString(16).padStart(2,"0")}(n)}`}#pa(t,e){this.canvas.addEventListener("contextmenu",ei,{signal:this._uiManager._signal}),this.#da(),this.#Ks=new AbortController;const n=this._uiManager.combinedSignal(this.#Ks);this.canvas.addEventListener("pointerleave",this.canvasPointerleave.bind(this),{signal:n}),this.canvas.addEventListener("pointermove",this.canvasPointermove.bind(this),{signal:n}),this.canvas.addEventListener("pointerup",this.canvasPointerup.bind(this),{signal:n}),this.isEditing=!0,this.#Qs||(this.#Qs=!0,this.#la(),this.thickness||=ca._defaultThickness,this.color||=ca._defaultColor||_i._defaultLineColor,this.opacity??=ca._defaultOpacity),this.currentPath.push([t,e]),this.#Ys=!1,this.#ua(),this.#na=()=>{this.#fa(),this.#na&&window.requestAnimationFrame(this.#na)},window.requestAnimationFrame(this.#na)}#ga(t,e){const[n,i]=this.currentPath.at(-1);if(this.currentPath.length>1&&t===n&&e===i)return;const r=this.currentPath;let s=this.#$s;if(r.push([t,e]),this.#Ys=!0,r.length<=2)return s.moveTo(...r[0]),void s.lineTo(t,e);3===r.length&&(this.#$s=s=new Path2D,s.moveTo(...r[0])),this.#ma(s,...r.at(-3),...r.at(-2),t,e)}#va(){if(0===this.currentPath.length)return;const t=this.currentPath.at(-1);this.#$s.lineTo(...t)}#ba(t,e){let n;if(this.#na=null,t=Math.min(Math.max(t,0),this.canvas.width),e=Math.min(Math.max(e,0),this.canvas.height),this.#ga(t,e),this.#va(),1!==this.currentPath.length)n=this.#ya();else{const i=[t,e];n=[[i,i.slice(),i.slice(),i]]}const i=this.#$s,r=this.currentPath;this.currentPath=[],this.#$s=new Path2D,this.addCommands({cmd:()=>{this.allRawPaths.push(r),this.paths.push(n),this.bezierPath2D.push(i),this._uiManager.rebuild(this)},undo:()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),0===this.paths.length?this.remove():(this.canvas||(this.#aa(),this.#oa()),this.#ra())},mustExec:!0})}#fa(){if(!this.#Ys)return;this.#Ys=!1;Math.ceil(this.thickness*this.parentScale);const t=this.currentPath.slice(-3),e=t.map((t=>t[0])),n=t.map((t=>t[1])),{ctx:i}=(Math.min(...e),Math.max(...e),Math.min(...n),Math.max(...n),this);i.save(),i.clearRect(0,0,this.canvas.width,this.canvas.height);for(const t of this.bezierPath2D)i.stroke(t);i.stroke(this.#$s),i.restore()}#ma(t,e,n,i,r,s,a){const o=(e+i)/2,l=(n+r)/2,c=(i+s)/2,d=(r+a)/2;t.bezierCurveTo(o+2*(i-o)/3,l+2*(r-l)/3,c+2*(i-c)/3,d+2*(r-d)/3,c,d)}#ya(){const t=this.currentPath;if(t.length<=2)return[[t[0],t[0],t.at(-1),t.at(-1)]];const e=[];let n,[i,r]=t[0];for(n=1;n<t.length-2;n++){const[s,a]=t[n],[o,l]=t[n+1],c=(s+o)/2,d=(a+l)/2,h=[i+2*(s-i)/3,r+2*(a-r)/3],u=[c+2*(s-c)/3,d+2*(a-d)/3];e.push([[i,r],h,u,[c,d]]),[i,r]=[c,d]}const[s,a]=t[n],[o,l]=t[n+1],c=[i+2*(s-i)/3,r+2*(a-r)/3],d=[o+2*(s-o)/3,l+2*(a-l)/3];return e.push([[i,r],c,d,[o,l]]),e}#sa(){if(this.isEmpty())return void this.#_a();this.#ua();const{canvas:t,ctx:e}=this;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height),this.#_a();for(const t of this.bezierPath2D)e.stroke(t)}commit(){this.#Xs||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#Xs=!0,this.div.classList.add("disabled"),this.#ra(!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),this.enableEditMode())}#ca(){if(this.#Zs)return;this.#Zs=new AbortController;const t=this._uiManager.combinedSignal(this.#Zs);this.canvas.addEventListener("pointerdown",this.canvasPointerdown.bind(this),{signal:t})}#da(){this.pointerdownAC?.abort(),this.pointerdownAC=null}canvasPointerdown(t){0===t.button&&this.isInEditMode()&&!this.#Xs&&(this.setInForeground(),t.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),this.#pa(t.offsetX,t.offsetY))}canvasPointermove(t){t.preventDefault(),this.#ga(t.offsetX,t.offsetY)}canvasPointerup(t){t.preventDefault(),this.#wa(t)}canvasPointerleave(t){this.#wa(t)}#wa(t){this.#Ks?.abort(),this.#Ks=null,this.#ca(),this.#Ws&&clearTimeout(this.#Ws),this.#Ws=setTimeout((()=>{this.#Ws=null,this.canvas.removeEventListener("contextmenu",ei)}),10),this.#ba(t.offsetX,t.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#aa(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#oa(){this.#Js=new ResizeObserver((t=>{const e=t[0].contentRect;e.width&&e.height&&this.setDimensions(e.width,e.height)})),this.#Js.observe(this.div),this._uiManager._signal.addEventListener("abort",(()=>{this.#Js?.disconnect(),this.#Js=null}),{once:!0})}get isResizable(){return!this.isEmpty()&&this.#Xs}render(){if(this.div)return this.div;let t,e;this.width&&(t=this.x,e=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[n,i,r,s]=this.#ha();if(this.setAt(n,i,0,0),this.setDims(r,s),this.#aa(),this.width){const[n,i]=this.parentDimensions;this.setAspectRatio(this.width*n,this.height*i),this.setAt(t*n,e*i,this.width*n,this.height*i),this.#Qs=!0,this.#la(),this.setDims(this.width*n,this.height*i),this.#sa(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#oa(),this.div}#la(){if(!this.#Qs)return;const[t,e]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*t),this.canvas.height=Math.ceil(this.height*e),this.#_a()}setDimensions(t,e){const n=Math.round(t),i=Math.round(e);if(this.#ta===n&&this.#ea===i)return;this.#ta=n,this.#ea=i,this.canvas.style.visibility="hidden";const[r,s]=this.parentDimensions;this.width=t/r,this.height=e/s,this.fixAndSetPosition(),this.#Xs&&this.#Aa(t,e),this.#la(),this.#sa(),this.canvas.style.visibility="visible",this.fixDims()}#Aa(t,e){const n=this.#xa(),i=(t-n)/this.#Gs,r=(e-n)/this.#Vs;this.scaleFactor=Math.min(i,r)}#_a(){const t=this.#xa()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+t,this.translationY*this.scaleFactor+t)}static#Ea(t){const e=new Path2D;for(let n=0,i=t.length;n<i;n++){const[i,r,s,a]=t[n];0===n&&e.moveTo(...i),e.bezierCurveTo(r[0],r[1],s[0],s[1],a[0],a[1])}return e}static#Sa(t,e,n){const[i,r,s,a]=e;switch(n){case 0:for(let e=0,n=t.length;e<n;e+=2)t[e]+=i,t[e+1]=a-t[e+1];break;case 90:for(let e=0,n=t.length;e<n;e+=2){const n=t[e];t[e]=t[e+1]+i,t[e+1]=n+r}break;case 180:for(let e=0,n=t.length;e<n;e+=2)t[e]=s-t[e],t[e+1]+=r;break;case 270:for(let e=0,n=t.length;e<n;e+=2){const n=t[e];t[e]=s-t[e+1],t[e+1]=a-n}break;default:throw new Error("Invalid rotation")}return t}static#Ta(t,e,n){const[i,r,s,a]=e;switch(n){case 0:for(let e=0,n=t.length;e<n;e+=2)t[e]-=i,t[e+1]=a-t[e+1];break;case 90:for(let e=0,n=t.length;e<n;e+=2){const n=t[e];t[e]=t[e+1]-r,t[e+1]=n-i}break;case 180:for(let e=0,n=t.length;e<n;e+=2)t[e]=s-t[e],t[e+1]-=r;break;case 270:for(let e=0,n=t.length;e<n;e+=2){const n=t[e];t[e]=a-t[e+1],t[e+1]=s-n}break;default:throw new Error("Invalid rotation")}return t}#Ca(t,e,n,i){const r=[],s=this.thickness/2,a=t*e+s,o=t*n+s;for(const e of this.paths){const n=[],s=[];for(let i=0,r=e.length;i<r;i++){const[l,c,d,h]=e[i];if(l[0]===h[0]&&l[1]===h[1]&&1===r){const e=t*l[0]+a,i=t*l[1]+o;n.push(e,i),s.push(e,i);break}const u=t*l[0]+a,p=t*l[1]+o,f=t*c[0]+a,g=t*c[1]+o,m=t*d[0]+a,v=t*d[1]+o,b=t*h[0]+a,y=t*h[1]+o;0===i&&(n.push(u,p),s.push(u,p)),n.push(f,g,m,v,b,y),s.push(f,g),i===r-1&&s.push(b,y)}r.push({bezier:ca.#Sa(n,i,this.rotation),points:ca.#Sa(s,i,this.rotation)})}return r}#ka(){let t=1/0,e=-1/0,n=1/0,i=-1/0;for(const r of this.paths)for(const[s,a,o,l]of r){const r=qn.bezierBoundingBox(...s,...a,...o,...l);t=Math.min(t,r[0]),n=Math.min(n,r[1]),e=Math.max(e,r[2]),i=Math.max(i,r[3])}return[t,n,e,i]}#xa(){return this.#Xs?Math.ceil(this.thickness*this.parentScale):0}#ra(t=!1){if(this.isEmpty())return;if(!this.#Xs)return void this.#sa();const e=this.#ka(),n=this.#xa();this.#Gs=Math.max(_i.MIN_SIZE,e[2]-e[0]),this.#Vs=Math.max(_i.MIN_SIZE,e[3]-e[1]);const i=Math.ceil(n+this.#Gs*this.scaleFactor),r=Math.ceil(n+this.#Vs*this.scaleFactor),[s,a]=this.parentDimensions;this.width=i/s,this.height=r/a,this.setAspectRatio(i,r);const o=this.translationX,l=this.translationY;this.translationX=-e[0],this.translationY=-e[1],this.#la(),this.#sa(),this.#ta=i,this.#ea=r,this.setDims(i,r);const c=t?n/this.scaleFactor/2:0;this.translate(o-this.translationX-c,l-this.translationY-c)}static async deserialize(t,e,n){if(t instanceof Vs)return null;const i=await super.deserialize(t,e,n);i.thickness=t.thickness,i.color=qn.makeHexColor(...t.color),i.opacity=t.opacity;const[r,s]=i.pageDimensions,a=i.width*r,o=i.height*s,l=i.parentScale,c=t.thickness/2;i.#Xs=!0,i.#ta=Math.round(a),i.#ea=Math.round(o);const{paths:d,rect:h,rotation:u}=t;for(let{bezier:t}of d){t=ca.#Ta(t,h,u);const e=[];i.paths.push(e);let n=l*(t[0]-c),r=l*(t[1]-c);for(let i=2,s=t.length;i<s;i+=6){const s=l*(t[i]-c),a=l*(t[i+1]-c),o=l*(t[i+2]-c),d=l*(t[i+3]-c),h=l*(t[i+4]-c),u=l*(t[i+5]-c);e.push([[n,r],[s,a],[o,d],[h,u]]),n=h,r=u}const s=this.#Ea(e);i.bezierPath2D.push(s)}const p=i.#ka();return i.#Gs=Math.max(_i.MIN_SIZE,p[2]-p[0]),i.#Vs=Math.max(_i.MIN_SIZE,p[3]-p[1]),i.#Aa(a,o),i}serialize(){if(this.isEmpty())return null;const t=this.getRect(0,0),e=_i._colorManager.convert(this.ctx.strokeStyle);return{annotationType:dn.INK,color:e,thickness:this.thickness,opacity:this.opacity,paths:this.#Ca(this.scaleFactor/this.parentScale,this.translationX,this.translationY,t),pageIndex:this.pageIndex,rect:t,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}class da extends _i{#Ma=null;#Ia=null;#La=null;#Pa=null;#Ra=null;#Da="";#Fa=null;#Js=null;#Oa=null;#Na=!1;#Ba=!1;static _type="stamp";static _editorType=dn.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#Pa=t.bitmapUrl,this.#Ra=t.bitmapFile}static initialize(t,e){_i.initialize(t,e)}static get supportedTypes(){return Sn(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map((t=>`image/${t}`)))}static get supportedTypesStr(){return Sn(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,e){e.pasteEditor(dn.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#qa(t,e=!1){t?(this.#Ma=t.bitmap,e||(this.#Ia=t.id,this.#Na=t.isSvg),t.file&&(this.#Da=t.file.name),this.#aa()):this.remove()}#Ha(){if(this.#La=null,this._uiManager.enableWaiting(!1),this.#Fa){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#Ma)return this._editToolbar.hide(),void this._uiManager.editAltText(this,!0);if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#Ma){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:r,height:s}=t||this.copyCanvas(null,null,!0).imageData,a=await n.guess({name:"altText",request:{data:i,width:r,height:s,channels:i.length/(r*s)}});if(!a)throw new Error("No response from the AI service.");if(a.error)throw new Error("Error from the AI service.");if(a.cancel)return null;if(!a.output)throw new Error("No valid response from the AI service.");const o=a.output;return await this.setGuessedAltText(o),e&&!this.hasAltTextData()&&(this.altTextData={alt:o,decorative:!1}),o}#ja(){if(this.#Ia)return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId(this.#Ia).then((t=>this.#qa(t,!0))).finally((()=>this.#Ha()));if(this.#Pa){const t=this.#Pa;return this.#Pa=null,this._uiManager.enableWaiting(!0),void(this.#La=this._uiManager.imageManager.getFromUrl(t).then((t=>this.#qa(t))).finally((()=>this.#Ha())))}if(this.#Ra){const t=this.#Ra;return this.#Ra=null,this._uiManager.enableWaiting(!0),void(this.#La=this._uiManager.imageManager.getFromFile(t).then((t=>this.#qa(t))).finally((()=>this.#Ha())))}const t=document.createElement("input");t.type="file",t.accept=da.supportedTypesStr;const e=this._uiManager._signal;this.#La=new Promise((n=>{t.addEventListener("change",(async()=>{if(t.files&&0!==t.files.length){this._uiManager.enableWaiting(!0);const e=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#qa(e)}else this.remove();n()}),{signal:e}),t.addEventListener("cancel",(()=>{this.remove(),n()}),{signal:e})})).finally((()=>this.#Ha())),t.click()}remove(){this.#Ia&&(this.#Ma=null,this._uiManager.imageManager.deleteId(this.#Ia),this.#Fa?.remove(),this.#Fa=null,this.#Js?.disconnect(),this.#Js=null,this.#Oa&&(clearTimeout(this.#Oa),this.#Oa=null)),super.remove()}rebuild(){this.parent?(super.rebuild(),null!==this.div&&(this.#Ia&&null===this.#Fa&&this.#ja(),this.isAttachedToDOM||this.parent.add(this))):this.#Ia&&this.#ja()}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#La||this.#Ma||this.#Pa||this.#Ra||this.#Ia)}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;if(this.width&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#Ma?this.#aa():this.#ja(),this.width&&!this.annotationElementId){const[n,i]=this.parentDimensions;this.setAt(t*n,e*i,this.width*n,this.height*i)}return this.div}#aa(){const{div:t}=this;let{width:e,height:n}=this.#Ma;const[i,r]=this.pageDimensions,s=.75;if(this.width)e=this.width*i,n=this.height*r;else if(e>s*i||n>s*r){const t=Math.min(s*i/e,s*r/n);e*=t,n*=t}const[a,o]=this.parentDimensions;this.setDims(e*a/i,n*o/r),this._uiManager.enableWaiting(!1);const l=this.#Fa=document.createElement("canvas");l.setAttribute("role","img"),this.addContainer(l),this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&!this.annotationElementId||(t.hidden=!1),this.#za(e,n),this.#oa(),this.#Ba||(this.parent.addUndoableEditor(this),this.#Ba=!0),this._reportTelemetry({action:"inserted_image"}),this.#Da&&l.setAttribute("aria-label",this.#Da)}copyCanvas(t,e,n=!1){t||(t=224);const{width:i,height:r}=this.#Ma,s=new ci;let a=this.#Ma,o=i,l=r,c=null;if(e){if(i>e||r>e){const t=Math.min(e/i,e/r);o=Math.floor(i*t),l=Math.floor(r*t)}c=document.createElement("canvas");const t=c.width=Math.ceil(o*s.sx),n=c.height=Math.ceil(l*s.sy);this.#Na||(a=this.#Ua(t,n));const d=c.getContext("2d");d.filter=this._uiManager.hcmFilter;let h="white",u="#cfcfd8";"none"!==this._uiManager.hcmFilter?u="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(h="#8f8f9d",u="#42414d");const p=15,f=p*s.sx,g=p*s.sy,m=new OffscreenCanvas(2*f,2*g),v=m.getContext("2d");v.fillStyle=h,v.fillRect(0,0,2*f,2*g),v.fillStyle=u,v.fillRect(0,0,f,g),v.fillRect(f,g,f,g),d.fillStyle=d.createPattern(m,"repeat"),d.fillRect(0,0,t,n),d.drawImage(a,0,0,a.width,a.height,0,0,t,n)}let d=null;if(n){let e,n;if(s.symmetric&&a.width<t&&a.height<t)e=a.width,n=a.height;else if(a=this.#Ma,i>t||r>t){const s=Math.min(t/i,t/r);e=Math.floor(i*s),n=Math.floor(r*s),this.#Na||(a=this.#Ua(e,n))}const o=new OffscreenCanvas(e,n).getContext("2d",{willReadFrequently:!0});o.drawImage(a,0,0,a.width,a.height,0,0,e,n),d={width:e,height:n,data:o.getImageData(0,0,e,n).data}}return{canvas:c,width:o,height:l,imageData:d}}#Va(t,e){const[n,i]=this.parentDimensions;this.width=t/n,this.height=e/i,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,null!==this.#Oa&&clearTimeout(this.#Oa),this.#Oa=setTimeout((()=>{this.#Oa=null,this.#za(t,e)}),200)}#Ua(t,e){const{width:n,height:i}=this.#Ma;let r=n,s=i,a=this.#Ma;for(;r>2*t||s>2*e;){const n=r,i=s;r>2*t&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2)),s>2*e&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2));const o=new OffscreenCanvas(r,s);o.getContext("2d").drawImage(a,0,0,n,i,0,0,r,s),a=o.transferToImageBitmap()}return a}#za(t,e){const n=new ci,i=Math.ceil(t*n.sx),r=Math.ceil(e*n.sy),s=this.#Fa;if(!s||s.width===i&&s.height===r)return;s.width=i,s.height=r;const a=this.#Na?this.#Ma:this.#Ua(i,r),o=s.getContext("2d");o.filter=this._uiManager.hcmFilter,o.drawImage(a,0,0,a.width,a.height,0,0,i,r)}getImageForAltText(){return this.#Fa}#Ga(t){if(t){if(this.#Na){const t=this._uiManager.imageManager.getSvgUrl(this.#Ia);if(t)return t}const t=document.createElement("canvas");return({width:t.width,height:t.height}=this.#Ma),t.getContext("2d").drawImage(this.#Ma,0,0),t.toDataURL()}if(this.#Na){const[t,e]=this.pageDimensions,n=Math.round(this.width*t*Gn.PDF_TO_CSS_UNITS),i=Math.round(this.height*e*Gn.PDF_TO_CSS_UNITS),r=new OffscreenCanvas(n,i);return r.getContext("2d").drawImage(this.#Ma,0,0,this.#Ma.width,this.#Ma.height,0,0,n,i),r.transferToImageBitmap()}return structuredClone(this.#Ma)}#oa(){this._uiManager._signal&&(this.#Js=new ResizeObserver((t=>{const e=t[0].contentRect;e.width&&e.height&&this.#Va(e.width,e.height)})),this.#Js.observe(this.div),this._uiManager._signal.addEventListener("abort",(()=>{this.#Js?.disconnect(),this.#Js=null}),{once:!0}))}static async deserialize(t,e,n){let i=null;if(t instanceof Ks){const{data:{rect:r,rotation:s,id:a,structParent:o,popupRef:l},container:c,parent:{page:{pageNumber:d}}}=t,h=c.querySelector("canvas"),u=n.imageManager.getFromCanvas(c.id,h);h.remove();const p=(await e._structTree.getAriaAttributes(`${Un}${a}`))?.get("aria-label")||"";i=t={annotationType:dn.STAMP,bitmapId:u.id,bitmap:u.bitmap,pageIndex:d-1,rect:r.slice(0),rotation:s,id:a,deleted:!1,accessibilityData:{decorative:!1,altText:p},isSvg:!1,structParent:o,popupRef:l}}const r=await super.deserialize(t,e,n),{rect:s,bitmap:a,bitmapUrl:o,bitmapId:l,isSvg:c,accessibilityData:d}=t;l&&n.imageManager.isValidId(l)?(r.#Ia=l,a&&(r.#Ma=a)):r.#Pa=o,r.#Na=c;const[h,u]=r.pageDimensions;return r.width=(s[2]-s[0])/h,r.height=(s[3]-s[1])/u,r.annotationElementId=t.id||null,d&&(r.altTextData=d),r._initialData=i,r.#Ba=!!i,r}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:dn.STAMP,bitmapId:this.#Ia,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#Na,structTreeParentId:this._structTreeParentId};if(t)return n.bitmapUrl=this.#Ga(!0),n.accessibilityData=this.serializeAltText(!0),n;const{decorative:i,altText:r}=this.serializeAltText(!1);if(!i&&r&&(n.accessibilityData={type:"Figure",alt:r}),this.annotationElementId){const t=this.#br(n);if(t.isSame)return null;t.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,null===e)return n;e.stamps||=new Map;const s=this.#Na?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(e.stamps.has(this.#Ia)){if(this.#Na){const t=e.stamps.get(this.#Ia);s>t.area&&(t.area=s,t.serialized.bitmap.close(),t.serialized.bitmap=this.#Ga(!1))}}else e.stamps.set(this.#Ia,{area:s,serialized:n}),n.bitmap=this.#Ga(!1);return n}#br(t){const{rect:e,pageIndex:n,accessibilityData:{altText:i}}=this._initialData,r=t.rect.every(((t,n)=>Math.abs(t-e[n])<1)),s=t.pageIndex===n,a=(t.accessibilityData?.alt||"")===i;return{isSame:r&&s&&a,isSameAltText:a}}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}class ha{#er;#Wa=!1;#$a=null;#Xa=null;#Ka=null;#Ya=new Map;#Qa=!1;#Ja=!1;#Za=!1;#to=null;#eo=null;#g;static _initialized=!1;static#H=new Map([Zs,ca,da,la].map((t=>[t._editorType,t])));constructor({uiManager:t,pageIndex:e,div:n,structTreeLayer:i,accessibilityManager:r,annotationLayer:s,drawLayer:a,textLayer:o,viewport:l,l10n:c}){const d=[...ha.#H.values()];if(!ha._initialized){ha._initialized=!0;for(const e of d)e.initialize(c,t)}t.registerEditorTypes(d),this.#g=t,this.pageIndex=e,this.div=n,this.#er=r,this.#$a=s,this.viewport=l,this.#to=o,this.drawLayer=a,this._structTree=i,this.#g.addLayer(this)}get isEmpty(){return 0===this.#Ya.size}get isInvisible(){return this.isEmpty&&this.#g.getMode()===dn.NONE}updateToolbar(t){this.#g.updateToolbar(t)}updateMode(t=this.#g.getMode()){switch(this.#no(),t){case dn.NONE:return this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),void this.disableClick();case dn.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case dn.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const n of ha.#H.values())e.toggle(`${n._type}Editing`,t===n._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#to?.div}addInkEditorIfNeeded(t){if(this.#g.getMode()===dn.INK){if(!t)for(const t of this.#Ya.values())if(t.isEmpty())return void t.setInBackground();this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}}setEditingState(t){this.#g.setEditingState(t)}addCommands(t){this.#g.addCommands(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#$a?.div.classList.toggle("disabled",!t)}async enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const e of this.#Ya.values())e.enableEditing(),e.show(!0),e.annotationElementId&&(this.#g.removeChangedExistingAnnotation(e),t.add(e.annotationElementId));if(!this.#$a)return;const e=this.#$a.getEditableAnnotations();for(const n of e){if(n.hide(),this.#g.isDeletedAnnotationElement(n.data.id))continue;if(t.has(n.data.id))continue;const e=await this.deserialize(n);e&&(this.addOrRebuild(e),e.enableEditing())}}disable(){this.#Za=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const n of this.#Ya.values())n.disableEditing(),n.annotationElementId&&(null===n.serialize()?(e.set(n.annotationElementId,n),this.getEditableAnnotation(n.annotationElementId)?.show(),n.remove()):t.set(n.annotationElementId,n));if(this.#$a){const n=this.#$a.getEditableAnnotations();for(const i of n){const{id:n}=i.data;if(this.#g.isDeletedAnnotationElement(n))continue;let r=e.get(n);r?(r.resetAnnotationElement(i),r.show(!1),i.show()):(r=t.get(n),r&&(this.#g.addChangedExistingAnnotation(r),r.renderAnnotationElement(i)&&r.show(!1)),i.show())}}this.#no(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const t of ha.#H.values())n.remove(`${t._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#Za=!1}getEditableAnnotation(t){return this.#$a?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#g.getActive()!==t&&this.#g.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#to?.div&&!this.#eo){this.#eo=new AbortController;const t=this.#g.combinedSignal(this.#eo);this.#to.div.addEventListener("pointerdown",this.#io.bind(this),{signal:t}),this.#to.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#to?.div&&this.#eo&&(this.#eo.abort(),this.#eo=null,this.#to.div.classList.remove("highlighting"))}#io(t){this.#g.unselectAll();const{target:e}=t;if(e===this.#to.div||("img"===e.getAttribute("role")||e.classList.contains("endOfContent"))&&this.#to.div.contains(e)){const{isMac:e}=Nn.platform;if(0!==t.button||t.ctrlKey&&e)return;this.#g.showAllEditors("highlight",!0,!0),this.#to.div.classList.add("free"),this.toggleDrawing(),la.startHighlighting(this,"ltr"===this.#g.direction,{target:this.#to.div,x:t.x,y:t.y}),this.#to.div.addEventListener("pointerup",(()=>{this.#to.div.classList.remove("free"),this.toggleDrawing(!0)}),{once:!0,signal:this.#g._signal}),t.preventDefault()}}enableClick(){if(this.#Xa)return;this.#Xa=new AbortController;const t=this.#g.combinedSignal(this.#Xa);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:t})}disableClick(){this.#Xa?.abort(),this.#Xa=null}attach(t){this.#Ya.set(t.id,t);const{annotationElementId:e}=t;e&&this.#g.isDeletedAnnotationElement(e)&&this.#g.removeDeletedAnnotationElement(t)}detach(t){this.#Ya.delete(t.id),this.#er?.removePointerInTextLayer(t.contentDiv),!this.#Za&&t.annotationElementId&&this.#g.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#g.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,this.#Ja||this.addInkEditorIfNeeded(!1)}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#g.addDeletedAnnotationElement(t.annotationElementId),_i.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(t.parent!==this||!t.isAttachedToDOM){if(this.changeParent(t),this.#g.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),this.#g.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#Ka&&(t._focusEventsAllowed=!1,this.#Ka=setTimeout((()=>{this.#Ka=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",(()=>{t._focusEventsAllowed=!0}),{once:!0,signal:this.#g._signal}),e.focus())}),0)),t._structTreeParentId=this.#er?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){this.addCommands({cmd:()=>t._uiManager.rebuild(t),undo:()=>{t.remove()},mustExec:!1})}getNextId(){return this.#g.getId()}get#ro(){return ha.#H.get(this.#g.getMode())}combinedSignal(t){return this.#g.combinedSignal(t)}#so(t){const e=this.#ro;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#ro?.canCreateNewEmptyEditor()}pasteEditor(t,e){this.#g.updateToolbar(t),this.#g.updateMode(t);const{offsetX:n,offsetY:i}=this.#ao(),r=this.getNextId(),s=this.#so({parent:this,id:r,x:n,y:i,uiManager:this.#g,isCentered:!0,...e});s&&this.add(s)}async deserialize(t){return await(ha.#H.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#g))||null}createAndAddNewEditor(t,e,n={}){const i=this.getNextId(),r=this.#so({parent:this,id:i,x:t.offsetX,y:t.offsetY,uiManager:this.#g,isCentered:e,...n});return r&&this.add(r),r}#ao(){const{x:t,y:e,width:n,height:i}=this.div.getBoundingClientRect(),r=Math.max(0,t),s=Math.max(0,e),a=(r+Math.min(window.innerWidth,t+n))/2-t,o=(s+Math.min(window.innerHeight,e+i))/2-e,[l,c]=this.viewport.rotation%180==0?[a,o]:[o,a];return{offsetX:l,offsetY:c}}addNewEditor(){this.createAndAddNewEditor(this.#ao(),!0)}setSelected(t){this.#g.setSelected(t)}toggleSelected(t){this.#g.toggleSelected(t)}unselect(t){this.#g.unselect(t)}pointerup(t){const{isMac:e}=Nn.platform;0!==t.button||t.ctrlKey&&e||t.target===this.div&&this.#Qa&&(this.#Qa=!1,this.#Wa?this.#g.getMode()!==dn.STAMP?this.createAndAddNewEditor(t,!1):this.#g.unselectAll():this.#Wa=!0)}pointerdown(t){if(this.#g.getMode()===dn.HIGHLIGHT&&this.enableTextSelection(),this.#Qa)return void(this.#Qa=!1);const{isMac:e}=Nn.platform;if(0!==t.button||t.ctrlKey&&e)return;if(t.target!==this.div)return;this.#Qa=!0;const n=this.#g.getActive();this.#Wa=!n||n.isEmpty()}findNewParent(t,e,n){const i=this.#g.findParent(e,n);return null!==i&&i!==this&&(i.changeParent(t),!0)}destroy(){this.#g.getActive()?.parent===this&&(this.#g.commitOrRemove(),this.#g.setActiveEditor(null)),this.#Ka&&(clearTimeout(this.#Ka),this.#Ka=null);for(const t of this.#Ya.values())this.#er?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#Ya.clear(),this.#g.removeLayer(this)}#no(){this.#Ja=!0;for(const t of this.#Ya.values())t.isEmpty()&&t.remove();this.#Ja=!1}render({viewport:t}){this.viewport=t,li(this.div,t);for(const t of this.#g.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:t}){this.#g.commitOrRemove(),this.#no();const e=this.viewport.rotation,n=t.rotation;if(this.viewport=t,li(this.div,{rotation:n}),e!==n)for(const t of this.#Ya.values())t.rotate(n);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#g.viewParameters.realScale}}class ua{#Fi=null;#y=0;#oo=new Map;#lo=new Map;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(this.#Fi){if(this.#Fi!==t){if(this.#oo.size>0)for(const e of this.#oo.values())e.remove(),t.append(e);this.#Fi=t}}else this.#Fi=t}static get _svgFactory(){return Sn(this,"_svgFactory",new ys)}static#co(t,{x:e=0,y:n=0,width:i=1,height:r=1}={}){const{style:s}=t;s.top=100*n+"%",s.left=100*e+"%",s.width=100*i+"%",s.height=100*r+"%"}#do(t){const e=ua._svgFactory.create(1,1,!0);return this.#Fi.append(e),e.setAttribute("aria-hidden",!0),ua.#co(e,t),e}#ho(t,e){const n=ua._svgFactory.createElement("clipPath");t.append(n);const i=`clip_${e}`;n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const r=ua._svgFactory.createElement("use");return n.append(r),r.setAttribute("href",`#${e}`),r.classList.add("clip"),i}draw(t,e,n,i=!1){const r=this.#y++,s=this.#do(t.box);s.classList.add(...t.classNamesForDrawing);const a=ua._svgFactory.createElement("defs");s.append(a);const o=ua._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${r}`;o.setAttribute("id",l),o.setAttribute("d",t.toSVGPath()),i&&this.#lo.set(r,o);const c=this.#ho(a,l),d=ua._svgFactory.createElement("use");return s.append(d),s.setAttribute("fill",e),s.setAttribute("fill-opacity",n),d.setAttribute("href",`#${l}`),this.#oo.set(r,s),{id:r,clipPathId:`url(#${c})`}}drawOutline(t){const e=this.#y++,n=this.#do(t.box);n.classList.add(...t.classNamesForOutlining);const i=ua._svgFactory.createElement("defs");n.append(i);const r=ua._svgFactory.createElement("path");i.append(r);const s=`path_p${this.pageIndex}_${e}`;let a;if(r.setAttribute("id",s),r.setAttribute("d",t.toSVGPath()),r.setAttribute("vector-effect","non-scaling-stroke"),t.mustRemoveSelfIntersections){const t=ua._svgFactory.createElement("mask");i.append(t),a=`mask_p${this.pageIndex}_${e}`,t.setAttribute("id",a),t.setAttribute("maskUnits","objectBoundingBox");const n=ua._svgFactory.createElement("rect");t.append(n),n.setAttribute("width","1"),n.setAttribute("height","1"),n.setAttribute("fill","white");const r=ua._svgFactory.createElement("use");t.append(r),r.setAttribute("href",`#${s}`),r.setAttribute("stroke","none"),r.setAttribute("fill","black"),r.setAttribute("fill-rule","nonzero"),r.classList.add("mask")}const o=ua._svgFactory.createElement("use");n.append(o),o.setAttribute("href",`#${s}`),a&&o.setAttribute("mask",`url(#${a})`);const l=o.cloneNode();return n.append(l),o.classList.add("mainOutline"),l.classList.add("secondaryOutline"),this.#oo.set(e,n),e}finalizeLine(t,e){const n=this.#lo.get(t);this.#lo.delete(t),this.updateBox(t,e.box),n.setAttribute("d",e.toSVGPath())}updateLine(t,e){this.#oo.get(t).firstChild.firstChild.setAttribute("d",e.toSVGPath())}updatePath(t,e){this.#lo.get(t).setAttribute("d",e.toSVGPath())}updateBox(t,e){ua.#co(this.#oo.get(t),e)}show(t,e){this.#oo.get(t).classList.toggle("hidden",!e)}rotate(t,e){this.#oo.get(t).setAttribute("data-main-rotation",e)}changeColor(t,e){this.#oo.get(t).setAttribute("fill",e)}changeOpacity(t,e){this.#oo.get(t).setAttribute("fill-opacity",e)}addClass(t,e){this.#oo.get(t).classList.add(e)}removeClass(t,e){this.#oo.get(t).classList.remove(e)}getSVGRoot(t){return this.#oo.get(t)}remove(t){this.#lo.delete(t),null!==this.#Fi&&(this.#oo.get(t).remove(),this.#oo.delete(t))}destroy(){this.#Fi=null;for(const t of this.#oo.values())t.remove();this.#oo.clear(),this.#lo.clear()}}function pa(t){return pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pa(t)}function fa(){fa=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function d(t,e,n,i){var s=e&&e.prototype instanceof v?e:v,a=Object.create(s.prototype),o=new I(i||[]);return r(a,"_invoke",{value:T(t,n,o)}),a}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var u="suspendedStart",p="suspendedYield",f="executing",g="completed",m={};function v(){}function b(){}function y(){}var _={};c(_,a,(function(){return this}));var w=Object.getPrototypeOf,A=w&&w(w(L([])));A&&A!==n&&i.call(A,a)&&(_=A);var x=y.prototype=v.prototype=Object.create(_);function E(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(r,s,a,o){var l=h(t[r],t,s);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==pa(d)&&i.call(d,"__await")?e.resolve(d.__await).then((function(t){n("next",t,a,o)}),(function(t){n("throw",t,a,o)})):e.resolve(d).then((function(t){c.value=t,a(c)}),(function(t){return n("throw",t,a,o)}))}o(l.arg)}var s;r(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,r){n(t,i,e,r)}))}return s=s?s.then(r,r):r()}})}function T(e,n,i){var r=u;return function(s,a){if(r===f)throw Error("Generator is already running");if(r===g){if("throw"===s)throw a;return{value:t,done:!0}}for(i.method=s,i.arg=a;;){var o=i.delegate;if(o){var l=C(o,i);if(l){if(l===m)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===u)throw r=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=f;var c=h(e,n,i);if("normal"===c.type){if(r=i.done?g:p,c.arg===m)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r=g,i.method="throw",i.arg=c.arg)}}}function C(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,C(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var s=h(r,e.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,m;var a=s.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function L(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}throw new TypeError(pa(e)+" is not iterable")}return b.prototype=y,r(x,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:b,configurable:!0}),b.displayName=c(y,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,l,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(S.prototype),c(S.prototype,o,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,i,r,s){void 0===s&&(s=Promise);var a=new S(d(t,n,i,r),s);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),c(x,l,"Generator"),c(x,a,(function(){return this})),c(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=L,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(M),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return o.type="throw",o.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var s=this.tryEntries.length-1;s>=0;--s){var a=this.tryEntries[s],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=t,a.arg=e,s?(this.method="next",this.next=s.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;M(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:L(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),m}},e}function ga(t,e,n,i,r,s,a){try{var o=t[s](a),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,r)}"undefined"!=typeof window&&"Worker"in window&&(rn.GlobalWorkerOptions.workerPort=new Worker(new URL(n.p+n.u(332),n.b),{type:"module"}));var ma={renderedCss:!1};function va(){var t;ma.renderedCss||((t=document.createElement("style")).textContent="\n/* Learnosity render PDF styles */\n.lt__renderPDF_pdf .pdf-viewer {\n    border: none;\n    width: 100%;\n    height: 650px;\n}\n",document.head.append(t),ma.renderedCss=!0),A.appInstance().on("item:load",(function(t){var e,n;e=O.itemReference(),(n=document.querySelector('.learnosity-item[data-reference="'.concat(e,'"]')).querySelectorAll(".lrn_widget .resource")).length&&n.forEach((function(t,e){var n=t.querySelector("a").getAttribute("href");if("pdf"===n.substring(n.length-3)){t.classList.add("sr-only"),function(t){return ba.apply(this,arguments)}(n).then((function(e){!function(e){if(!document.getElementById(e)){var i=document.createElement("div"),r=document.createElement("iframe");i.setAttribute("id",e),i.setAttribute("class","lt__renderPDF_pdf"),t.before(i),r.setAttribute("class","pdf-viewer"),r.setAttribute("src","".concat(n,"#sidebarViewOnLoad=0&_pagemode=none&_toolbar=0&view=FitH")),i.appendChild(r)}}(e)}))}}))}))}function ba(){var t;return t=fa().mark((function t(e){var n,i,r,s,a;return fa().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new TextEncoder,i=n.encode(e),t.next=4,crypto.subtle.digest("SHA-256",i);case 4:return r=t.sent,s=Array.from(new Uint8Array(r)),a=s.map((function(t){return t.toString(16).padStart(2,"0")})).join(""),t.abrupt("return",a);case 8:case"end":return t.stop()}}),t)})),ba=function(){var e=this,n=arguments;return new Promise((function(i,r){var s=t.apply(e,n);function a(t){ga(s,i,r,a,o,"next",t)}function o(t){ga(s,i,r,a,o,"throw",t)}a(void 0)}))},ba.apply(this,arguments)}function ya(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var _a={class:"lrn__resetResponse",label:"Reset question",renderedCss:!1,types:["mcq"]};function wa(t,e){var n,i;t&&"string"==typeof t&&(_a.label=t),e&&Array.isArray(e)&&(_a.types=e),_a.renderedCss||(n=document.createElement("style"),i="\n/* Learnosity reset question styles */\n.lrn .lrn_btn.".concat(_a.class," {\n    margin-top: 1em;\n    margin-bottom: 0.5em;\n    clear: both;\n    display: block;\n}\n"),n.textContent=i,document.head.append(n),_a.renderedCss=!0),A.appInstance().on("item:load",(function(){!function(){var t,e,n=k.questions();try{var i,r=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ya(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ya(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){o=!0,s=t},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw s}}}}(n);try{for(r.s();!(i=r.n()).done;){var s=i.value;if(_a.types.includes("*")||_a.types.includes(s.type)){var a=s.response_id,o=document.getElementById(a),l=o.querySelector(".lrn_response"),c=o.querySelector(".".concat(_a.class));c||(l.append((t=void 0,e=void 0,t=document.createElement("button"),e=document.createElement("span"),t.classList.add("lds-btn","lds-btn-secondary","lrn_btn",_a.class),e.append(_a.label),t.append(e),t)),(c=o.querySelector(".".concat(_a.class))).addEventListener("click",Aa))}}}catch(t){r.e(t)}finally{r.f()}}catch(t){M.A.error(t)}}()}))}function Aa(t){var e=t.srcElement.closest(".lrn_widget").getAttribute("id");A.questionsApp().question(e).resetResponse()}var xa="ERROR",Ea={_initialised:!1,elTimerWrapper:null,forceRenderTimer:!1,renderedCss:!1};function Sa(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60;if(Ea._initialised)M.A.debug("Toggle timer already initialised, ignoring run();",xa);else{var n=document.querySelector(".lrn-sm");if(Ea.elTimerWrapper=document.querySelector(".lrn-timer-wrapper"),n&&Ea.elTimerWrapper){Ea.renderedCss||((t=document.createElement("style")).textContent="\n/* Learnosity toggle timer styles */\n.lrn.lrn-assess .lrn-region:not(.lrn-items-region) .lrn_btn.lt__timer-button {\n    font-size: inherit;\n}\n\n.lrn-assess .lrn_btn.lt__timer-button .timer {\n    padding: 8px;\n    height: 29px;\n    position: relative;\n    top: -4px;\n}\n\n.lrn.lrn-assess .lt__timer-wrapper.lt__timer-hide .lrn_btn.lt__timer-button .timer .clock:before {\n    padding-right: 0;\n}\n\n.lrn-timer-wrapper.lt__timer-hide .lt__timer-button .timer > *:not(.clock) {\n    display: none;\n}\n",document.head.append(t),Ea.renderedCss=!0),Ea._initialised=!0;var i=Array.from(Ea.elTimerWrapper.children),r=document.createElement("button");r.classList.add("lrn_btn","lt__timer-button"),r.setAttribute("type","button"),r.setAttribute("aria-label","".concat(Ea.elTimerWrapper.getAttribute("aria-label"),", click to toggle visibility of the timer.")),Ea.elTimerWrapper.innerHTML="",Ea.elTimerWrapper.appendChild(r),i.forEach((function(t){r.appendChild(t)})),r.addEventListener("click",(function(){Ta()})),A.appInstance().on("time:change",(function(){var t=x.timeRemaining();!Ea.forceRenderTimer&&"number"==typeof t&&t<=Number(e)&&Ea.elTimerWrapper.classList.contains("lt__timer-hide")&&(Ea.forceRenderTimer=!0,Ea.elTimerWrapper.classList.remove("lt__timer-hide"),M.A.info("Force show the timer limit (".concat(e,") reached.")))}))}else M.A.warn("Timer wrapper, or `lrn-sm`, not found")}}function Ta(){Ea.elTimerWrapper.classList.toggle("lt__timer-hide")}var Ca=n(4196),ka={elementId:null,player:{instances:{beach:null,birds:null,wind:null,thunder:null,campfire:null,rain:null},sound:null,volume:null},playlist:{beach:"https://assets.learnosity.com/learnosity_toolkit/whitenoise/beach.mp3",birds:"https://assets.learnosity.com/learnosity_toolkit/whitenoise/birds.mp3",wind:"https://assets.learnosity.com/learnosity_toolkit/whitenoise/wind.mp3",thunder:"https://assets.learnosity.com/learnosity_toolkit/whitenoise/thunder.mp3",campfire:"https://assets.learnosity.com/learnosity_toolkit/whitenoise/campfire.mp3",rain:"https://assets.learnosity.com/learnosity_toolkit/whitenoise/rain.mp3"},queryRoot:document,renderedCss:!1};function Ma(t,e){ka.elementId=t||null,ka.queryRoot=e||document,ka.renderedCss||function(){var t=":root";ka.queryRoot!==document&&(t=":host");var e=document.createElement("style"),n="\n/* Learnosity white noise player styles */\n".concat(t,' {\n    --lt-wn-border: #888888;\n    --lt-wn-border-radius: 10px;\n    --lt-wn-color: #333333;\n    --lt-wn-svg-size: 4rem;\n    --lt-wn-control-svg-size: 1.5rem;\n    --lt-wn-range-size: 15rem;\n    --lt-wn-min-height: 19rem;\n}\n\n@container (max-width: 300px) {\n    .lt__player {\n        min-height: var(--lt-wn-min-height);\n        svg {\n            --lt-wn-svg-size: 3rem;\n        }\n        .lt__control-wrapper {\n            svg {\n                --lt-wn-control-svg-size: 1rem;\n            }\n            input[type="range"] {\n                --lt-wn-range-size: 10rem;\n            }\n        }\n    }\n}\n\n.lt__player {\n    container-type: size;\n    background-color: #fff;\n    width: 100%;\n    max-width: 30rem;\n    min-height: var(--lt-wn-min-height);\n    border: 1px solid #dddddd;\n    border-radius: var(--lt-wn-border-radius);\n    padding: 1rem;\n    filter: drop-shadow(4px 5px 7px #8d8d8d);\n    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;\n    color: var(--lt-wn-color);\n    margin: 0 auto;\n}\n.lt__player svg {\n    width: var(--lt-wn-svg-size);\n    height: var(--lt-wn-svg-size);\n    display: inline;\n}\n.lt__meta ul {\n    display: grid;\n    grid-template-columns: repeat(3, 1fr);\n    list-style: none;\n    text-align: center;\n    margin: 0;\n    padding: 0;\n}\n.lt__meta ul li {\n    box-sizing: border-box;\n    border-radius: var(--lt-wn-border-radius);\n    border: 1px solid var(--lt-wn-border);\n    margin: 0.3rem;\n\n    &:hover {\n        background-color: #f2f4f5;\n    }\n}\n.lt__meta ul li button {\n    display: block;\n    text-decoration: none;\n    border-radius: inherit;\n    width: 100%;\n    border: none;\n    background: none;\n\n    &:hover,\n    &:focus {\n        outline: 5px auto -webkit-focus-ring-color;\n        outline-offset: -2px;\n        background-color: #f2f4f5;\n    }\n\n    &:active {\n        box-shadow: 0 0 0 0.25rem rgba(49, 132, 253, 0.5);\n    }\n}\n.lt__meta ul li button.lt__sound-active {\n    box-shadow: 0 0 0 0.25rem rgba(49, 132, 253, 0.5);\n    background: #efefef;\n}\n.lt__meta ul li svg {\n    padding: 1rem 1rem 0.3rem 1rem;\n    vertical-align: middle;\n}\n.lt__control-wrapper svg {\n    width: var(--lt-wn-control-svg-size);\n}\n.lt__control-wrapper svg:last-child {\n    position: relative;\n    left: 0.6rem;\n}\n.lt__sound-label {\n    display: block;\n    padding-bottom: 0.7rem;\n}\n.lt__toolbar {\n    margin-top: 0.5rem;\n    text-align: center;\n}\n.lt__control-wrapper label {\n    text-align: center;\n    padding-bottom: 0;\n    margin-bottom: 0;\n    display: block;\n    position: relative;\n    top: 10px;\n}\n.lt__control-wrapper button {\n    background: none;\n    border: none;\n    cursor: pointer;\n}\ninput[type="range"] {\n   -webkit-appearance: none;\n    appearance: none;\n    background: transparent;\n    cursor: pointer;\n    width: var(--lt-wn-range-size);\n}\n/* Removes default focus */\ninput[type="range"]:focus {\n  outline: none;\n}\ninput[type="range"]::-webkit-slider-runnable-track {\n   background-color: #01243d;\n   border-radius: 0.5rem;\n   height: 0.5rem;\n}\ninput[type="range"]::-webkit-slider-thumb {\n  -webkit-appearance: none;\n   appearance: none;\n   margin-top: -12px;\n   background-color: #fff;\n   border: 2px solid #01243d;\n   height: 2rem;\n   width: 1rem;\n}\ninput[type="range"]:focus::-webkit-slider-thumb {\n  border: 1px solid #01243d;\n  outline: 3px solid #01243d;\n  outline-offset: 0.125rem;\n}\ninput[type="range"]::-moz-range-track {\n   background-color: #01243d;\n   border-radius: 0.5rem;\n   height: 0.5rem;\n}\ninput[type="range"]::-moz-range-thumb {\n   border: none;\n   border-radius: 0;\n   border: 1px solid #01243d;\n   background-color: #fff;\n   height: 2rem;\n   width: 1rem;\n}\ninput[type="range"]:focus::-moz-range-thumb {\n  border: 1px solid #01243d;\n  outline: 3px solid #01243d;\n  outline-offset: 0.125rem;\n}\n\n@media (max-width: 400px) {\n    .lt__meta ul {\n        display: grid;\n        grid-template-columns: repeat(2, 1fr);\n    }\n    input[type="range"] {\n        width: 10rem;\n    }\n}\n\n.lt__whitenoise-player-icon::before {\n    content: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 80C149.9 80 62.4 159.4 49.6 262c9.4-3.8 19.6-6 30.4-6c26.5 0 48 21.5 48 48V432c0 26.5-21.5 48-48 48c-44.2 0-80-35.8-80-80V384 336 288C0 146.6 114.6 32 256 32s256 114.6 256 256v48 48 16c0 44.2-35.8 80-80 80c-26.5 0-48-21.5-48-48V304c0-26.5 21.5-48 48-48c10.8 0 21 2.1 30.4 6C449.6 159.4 362.1 80 256 80z"/></svg>\');\n    width: 16px;\n    color: var(--lt-wn-color);\n    margin-top: 0;\n    font-size: 16px;\n    -webkit-transition: color .2s;\n    transition: color .2s;\n    -webkit-font-smoothing: antialiased;\n}\n');e.textContent=n,ka.queryRoot===document?document.head.append(e):ka.queryRoot.appendChild(e),ka.renderedCss=!0}();try{A.assessApp().on("button:btn-whitenoise:clicked",(function(){Ia()}))}catch(t){t instanceof TypeError||console.log("Error with white noise player:",t)}}function Ia(){var t='<div class="lt__player">\n    <div class="lt__meta">\n        <p id="lt__player-instructions" class="sr-only">Choose a sound from the list below. Click to play or pause, use the slider at the bottom to control the volume level.</p>\n        <ul aria-labelledby="lt__player-instructions">\n            <li><button class="lt__controls-sound" data-lt-sound="beach" aria-pressed="false" aria-label="Click to play or pause beach sounds"><svg role="img" aria-label="Beach" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M346.3 271.8l-60.1-21.9L214 448H32c-17.7 0-32 14.3-32 32s14.3 32 32 32H544c17.7 0 32-14.3 32-32s-14.3-32-32-32H282.1l64.1-176.2zm121.1-.2l-3.3 9.1 67.7 24.6c18.1 6.6 38-4.2 39.6-23.4c6.5-78.5-23.9-155.5-80.8-208.5c2 8 3.2 16.3 3.4 24.8l.2 6c1.8 57-7.3 113.8-26.8 167.4zM462 99.1c-1.1-34.4-22.5-64.8-54.4-77.4c-.9-.4-1.9-.7-2.8-1.1c-33-11.7-69.8-2.4-93.1 23.8l-4 4.5C272.4 88.3 245 134.2 226.8 184l-3.3 9.1L434 269.7l3.3-9.1c18.1-49.8 26.6-102.5 24.9-155.5l-.2-6zM107.2 112.9c-11.1 15.7-2.8 36.8 15.3 43.4l71 25.8 3.3-9.1c19.5-53.6 49.1-103 87.1-145.5l4-4.5c6.2-6.9 13.1-13 20.5-18.2c-79.6 2.5-154.7 42.2-201.2 108z" /></svg><span class="lt__sound-label">Beach</span></button></li>\n            <li><button class="lt__controls-sound" data-lt-sound="birds" aria-pressed="false" aria-label="Click to play or pause birds sounds"><svg role="img" aria-label="Birds" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M160.8 96.5c14 17 31 30.9 49.5 42.2c25.9 15.8 53.7 25.9 77.7 31.6V138.8C265.8 108.5 250 71.5 248.6 28c-.4-11.3-7.5-21.5-18.4-24.4c-7.6-2-15.8-.2-21 5.8c-13.3 15.4-32.7 44.6-48.4 87.2zM320 144v30.6l0 0v1.3l0 0 0 32.1c-60.8-5.1-185-43.8-219.3-157.2C97.4 40 87.9 32 76.6 32c-7.9 0-15.3 3.9-18.8 11C46.8 65.9 32 112.1 32 176c0 116.9 80.1 180.5 118.4 202.8L11.8 416.6C6.7 418 2.6 421.8 .9 426.8s-.8 10.6 2.3 14.8C21.7 466.2 77.3 512 160 512c3.6 0 7.2-1.2 10-3.5L245.6 448H320c88.4 0 160-71.6 160-160V128l29.9-44.9c1.3-2 2.1-4.4 2.1-6.8c0-6.8-5.5-12.3-12.3-12.3H400c-44.2 0-80 35.8-80 80zm80-16a16 16 0 1 1 0 32 16 16 0 1 1 0-32z" /></svg><span class="lt__sound-label">Birds</span></button></li>\n            <li><button class="lt__controls-sound" data-lt-sound="campfire" aria-pressed="false" aria-label="Click to play or pause campfire sounds"><svg role="img" aria-label="Campfire" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M159.3 5.4c7.8-7.3 19.9-7.2 27.7 .1c27.6 25.9 53.5 53.8 77.7 84c11-14.4 23.5-30.1 37-42.9c7.9-7.4 20.1-7.4 28 .1c34.6 33 63.9 76.6 84.5 118c20.3 40.8 33.8 82.5 33.8 111.9C448 404.2 348.2 512 224 512C98.4 512 0 404.1 0 276.5c0-38.4 17.8-85.3 45.4-131.7C73.3 97.7 112.7 48.6 159.3 5.4zM225.7 416c25.3 0 47.7-7 68.8-21c42.1-29.4 53.4-88.2 28.1-134.4c-4.5-9-16-9.6-22.5-2l-25.2 29.3c-6.6 7.6-18.5 7.4-24.7-.5c-16.5-21-46-58.5-62.8-79.8c-6.3-8-18.3-8.1-24.7-.1c-33.8 42.5-50.8 69.3-50.8 99.4C112 375.4 162.6 416 225.7 416z" /></svg><span class="lt__sound-label">Campfire</span></button></li>\n            <li><button class="lt__controls-sound" data-lt-sound="rain" aria-pressed="false" aria-label="Click to play or pause rain sounds"><svg role="img" aria-label="Rain" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M96 320c-53 0-96-43-96-96c0-42.5 27.6-78.6 65.9-91.2C64.7 126.1 64 119.1 64 112C64 50.1 114.1 0 176 0c43.1 0 80.5 24.3 99.2 60c14.7-17.1 36.5-28 60.8-28c44.2 0 80 35.8 80 80c0 5.5-.6 10.8-1.6 16c.5 0 1.1 0 1.6 0c53 0 96 43 96 96s-43 96-96 96H96zm-6.8 52c1.3-2.5 3.9-4 6.8-4s5.4 1.5 6.8 4l35.1 64.6c4.1 7.5 6.2 15.8 6.2 24.3v3c0 26.5-21.5 48-48 48s-48-21.5-48-48v-3c0-8.5 2.1-16.9 6.2-24.3L89.2 372zm160 0c1.3-2.5 3.9-4 6.8-4s5.4 1.5 6.8 4l35.1 64.6c4.1 7.5 6.2 15.8 6.2 24.3v3c0 26.5-21.5 48-48 48s-48-21.5-48-48v-3c0-8.5 2.1-16.9 6.2-24.3L249.2 372zm124.9 64.6L409.2 372c1.3-2.5 3.9-4 6.8-4s5.4 1.5 6.8 4l35.1 64.6c4.1 7.5 6.2 15.8 6.2 24.3v3c0 26.5-21.5 48-48 48s-48-21.5-48-48v-3c0-8.5 2.1-16.9 6.2-24.3z" /></svg><span class="lt__sound-label">Rain</span></button></li>\n            <li><button class="lt__controls-sound" data-lt-sound="thunder" aria-pressed="false" aria-label="Click to play or pause thunder sounds"><svg role="img" aria-label="Thunder" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M0 224c0 53 43 96 96 96h47.2L290 202.5c17.6-14.1 42.6-14 60.2 .2s22.8 38.6 12.8 58.8L333.7 320H352h64c53 0 96-43 96-96s-43-96-96-96c-.5 0-1.1 0-1.6 0c1.1-5.2 1.6-10.5 1.6-16c0-44.2-35.8-80-80-80c-24.3 0-46.1 10.9-60.8 28C256.5 24.3 219.1 0 176 0C114.1 0 64 50.1 64 112c0 7.1 .7 14.1 1.9 20.8C27.6 145.4 0 181.5 0 224zm330.1 3.6c-5.8-4.7-14.2-4.7-20.1-.1l-160 128c-5.3 4.2-7.4 11.4-5.1 17.8s8.3 10.7 15.1 10.7h70.1L177.7 488.8c-3.4 6.7-1.6 14.9 4.3 19.6s14.2 4.7 20.1 .1l160-128c5.3-4.2 7.4-11.4 5.1-17.8s-8.3-10.7-15.1-10.7H281.9l52.4-104.8c3.4-6.7 1.6-14.9-4.2-19.6z" /></svg><span class="lt__sound-label">Thunder</span></button></li>\n            <li><button class="lt__controls-sound" data-lt-sound="wind" aria-pressed="false" aria-label="Click to play or pause wind sounds"><svg role="img" aria-label="Wind" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M288 32c0 17.7 14.3 32 32 32h32c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32H352c53 0 96-43 96-96s-43-96-96-96H320c-17.7 0-32 14.3-32 32zm64 352c0 17.7 14.3 32 32 32h32c53 0 96-43 96-96s-43-96-96-96H32c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H384c-17.7 0-32 14.3-32 32zM128 512h32c53 0 96-43 96-96s-43-96-96-96H32c-17.7 0-32 14.3-32 32s14.3 32 32 32H160c17.7 0 32 14.3 32 32s-14.3 32-32 32H128c-17.7 0-32 14.3-32 32s14.3 32 32 32z"/></svg><span class="lt__sound-label">Wind</span></button></li>\n        </ul>\n    </div>\n    <div class="lt__toolbar">\n        <div class="lt__control-wrapper">\n            <label for="ld-volume">\n                Volume (<span id="ld-volume-value">100</span>%)\n            </label>\n            <svg role="img" aria-label="Move the slider to the left to reduce volume" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M320 64c0-12.6-7.4-24-18.9-29.2s-25-3.1-34.4 5.3L131.8 160H64c-35.3 0-64 28.7-64 64v64c0 35.3 28.7 64 64 64h67.8L266.7 471.9c9.4 8.4 22.9 10.4 34.4 5.3S320 460.6 320 448V64z"/></svg>\n            <input type="range" id="ld-volume" min="0" max="1.0" value="1.0" step="0.1" class="lt__controls-volume slider">\n            <svg role="img" aria-label="Move the slider to the right to increase volume" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M533.6 32.5C598.5 85.2 640 165.8 640 256s-41.5 170.7-106.4 223.5c-10.3 8.4-25.4 6.8-33.8-3.5s-6.8-25.4 3.5-33.8C557.5 398.2 592 331.2 592 256s-34.5-142.2-88.7-186.3c-10.3-8.4-11.8-23.5-3.5-33.8s23.5-11.8 33.8-3.5zM473.1 107c43.2 35.2 70.9 88.9 70.9 149s-27.7 113.8-70.9 149c-10.3 8.4-25.4 6.8-33.8-3.5s-6.8-25.4 3.5-33.8C475.3 341.3 496 301.1 496 256s-20.7-85.3-53.2-111.8c-10.3-8.4-11.8-23.5-3.5-33.8s23.5-11.8 33.8-3.5zm-60.5 74.5C434.1 199.1 448 225.9 448 256s-13.9 56.9-35.4 74.5c-10.3 8.4-25.4 6.8-33.8-3.5s-6.8-25.4 3.5-33.8C393.1 284.4 400 271 400 256s-6.9-28.4-17.7-37.3c-10.3-8.4-11.8-23.5-3.5-33.8s23.5-11.8 33.8-3.5zM301.1 34.8C312.6 40 320 51.4 320 64V448c0 12.6-7.4 24-18.9 29.2s-25 3.1-34.4-5.3L131.8 352H64c-35.3 0-64-28.7-64-64V224c0-35.3 28.7-64 64-64h67.8L266.7 40.1c9.4-8.4 22.9-10.4 34.4-5.3z"/></svg>\n        </div>\n    </div>\n</div>';if(ka.elementId&&!ka.shadowRoot){var e=ka.queryRoot.querySelector("#".concat(ka.elementId));if(!e)return void M.A.error("Element id '".concat(ka.elementId,"' not found, could not render player."));e.innerHTML=t}else if(ka.elementId&&ka.queryRoot!==document){var n=ka.queryRoot.querySelector("#".concat(ka.elementId));if(console.log(n),!n)return void M.A.error("Shadow root element id '".concat(ka.elementId,"' not found, could not render player."));n.innerHTML=t}else I.dialog({header:"White noise player",body:t,buttons:[{button_id:"dialog_btn_whitenoise_player",label:"Close",is_primary:!1}]});setTimeout((function(){var t=ka.queryRoot.querySelectorAll(".lt__controls-sound"),e=ka.queryRoot.querySelector("#ld-volume");t.forEach((function(t){t.addEventListener("keydown",(function(e){" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),t.click())})),t.addEventListener("click",(function(e){e.preventDefault(),function(t){var e=t.getAttribute("data-lt-sound"),n=ka.queryRoot.querySelector('[data-lt-sound="'.concat(e,'"]'));ka.player.sound&&La(ka.player.sound),n.classList.contains("lt__sound-active")?La(e):(ka.player.instances[e]||function(t){ka.player.instances[t]=new Ca.Howl({src:[ka.playlist[t]],html5:!0,loop:!0})}(e),ka.player.sound=e,function(t){ka.player.instances[t].play()}(e)),Ra(e)}(t)}))})),ka.player.sound&&Ra(ka.player.sound),e.value=ka.player.volume||1,Pa(),e.addEventListener("input",(function(){Pa()}))}),500);try{A.assessApp().on("button:dialog_btn_whitenoise_player:clicked",(function(){I.hideDialog()}))}catch(t){t instanceof TypeError||console.log("Error with white noise player:",t)}}function La(t){ka.player.instances[t].stop()}function Pa(){var t=ka.queryRoot.querySelector("#ld-volume"),e=ka.queryRoot.querySelector("#ld-volume-value"),n=t.value;ka.player.volume=n,Ca.Howler.volume(n),e.innerHTML=100*n}function Ra(t){ka.queryRoot.querySelectorAll(".lt__controls-sound").forEach((function(e){e.getAttribute("data-lt-sound")!==t||e.classList.contains("lt__sound-active")?(e.classList.remove("lt__sound-active"),e.setAttribute("aria-pressed","false")):(e.classList.add("lt__sound-active"),e.focus(),e.setAttribute("aria-pressed","true"))}))}function Da(t){return Da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Da(t)}function Fa(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Oa(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Fa(Object(n),!0).forEach((function(e){Na(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Fa(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Na(t,e,n){return(e=function(t){var e=function(t){if("object"!=Da(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Da(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Da(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ba={extensions:{ariaCountOnNav:Oa({},r),blockGrammarChecks:Oa({},s),checkAnswerValidation:Oa({},a),columnResizer:Oa({},o),contentTabs:Oa({},l),disableOnValidate:Oa({},c),essayLimitByCharacter:Oa({},d),hideAlternatives:Oa({},h),keyboardShortcuts:Oa({},u),magnifier:Oa({},p),mcqLabelPrefix:Oa({},f),networkStatus:Oa({},g),pageOverlay:Oa({},m),renderPDF:Oa({},v),resetResponse:Oa({},b),toggleTimer:Oa({},y),whiteNoise:Oa({},_)}},qa=Oa(Oa({},w.LT),Ba),Ha=i.LT;export{Ha as LT};