/*! For license information please see index.js.LICENSE.txt */
var __webpack_modules__={124:(e,t,r)=>{var n=r(9325);e.exports=function(){return n.Date.now()}},228:e=>{var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function a(e,t,n,a,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var o=new i(n,a||e,s),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function o(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),o.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},o.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,a=n.length,s=new Array(a);i<a;i++)s[i]=n[i].fn;return s},o.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},o.prototype.emit=function(e,t,n,i,a,s){var o=r?r+e:e;if(!this._events[o])return!1;var l,c,d=this._events[o],u=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),u){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,n),!0;case 4:return d.fn.call(d.context,t,n,i),!0;case 5:return d.fn.call(d.context,t,n,i,a),!0;case 6:return d.fn.call(d.context,t,n,i,a,s),!0}for(c=1,l=new Array(u-1);c<u;c++)l[c-1]=arguments[c];d.fn.apply(d.context,l)}else{var p,h=d.length;for(c=0;c<h;c++)switch(d[c].once&&this.removeListener(e,d[c].fn,void 0,!0),u){case 1:d[c].fn.call(d[c].context);break;case 2:d[c].fn.call(d[c].context,t);break;case 3:d[c].fn.call(d[c].context,t,n);break;case 4:d[c].fn.call(d[c].context,t,n,i);break;default:if(!l)for(p=1,l=new Array(u-1);p<u;p++)l[p-1]=arguments[p];d[c].fn.apply(d[c].context,l)}}return!0},o.prototype.on=function(e,t,r){return a(this,e,t,r,!1)},o.prototype.once=function(e,t,r){return a(this,e,t,r,!0)},o.prototype.removeListener=function(e,t,n,i){var a=r?r+e:e;if(!this._events[a])return this;if(!t)return s(this,a),this;var o=this._events[a];if(o.fn)o.fn!==t||i&&!o.once||n&&o.context!==n||s(this,a);else{for(var l=0,c=[],d=o.length;l<d;l++)(o[l].fn!==t||i&&!o[l].once||n&&o[l].context!==n)&&c.push(o[l]);c.length?this._events[a]=1===c.length?c[0]:c:s(this,a)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o},251:(e,t)=>{t.read=function(e,t,r,n,i){var a,s,o=8*i-n-1,l=(1<<o)-1,c=l>>1,d=-7,u=r?i-1:0,p=r?-1:1,h=e[t+u];for(u+=p,a=h&(1<<-d)-1,h>>=-d,d+=o;d>0;a=256*a+e[t+u],u+=p,d-=8);for(s=a&(1<<-d)-1,a>>=-d,d+=n;d>0;s=256*s+e[t+u],u+=p,d-=8);if(0===a)a=1-c;else{if(a===l)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,n),a-=c}return(h?-1:1)*s*Math.pow(2,a-n)},t.write=function(e,t,r,n,i,a){var s,o,l,c=8*a-i-1,d=(1<<c)-1,u=d>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:a-1,f=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=d):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+u>=1?p/l:p*Math.pow(2,1-u))*l>=2&&(s++,l/=2),s+u>=d?(o=0,s=d):s+u>=1?(o=(t*l-1)*Math.pow(2,i),s+=u):(o=t*Math.pow(2,u-1)*Math.pow(2,i),s=0));i>=8;e[r+h]=255&o,h+=f,o/=256,i-=8);for(s=s<<i|o,c+=i;c>0;e[r+h]=255&s,h+=f,s/=256,c-=8);e[r+h-f]|=128*m}},346:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},659:(e,t,r)=>{var n=r(1873),i=Object.prototype,a=i.hasOwnProperty,s=i.toString,o=n?n.toStringTag:void 0;e.exports=function(e){var t=a.call(e,o),r=e[o];try{e[o]=void 0;var n=!0}catch(e){}var i=s.call(e);return n&&(t?e[o]=r:delete e[o]),i}},908:(e,t,r)=>{var n,i,a=r(5969),s=r(6100).isArray;function o(e,t,r){return(!r&&e.spaces?"\n":"")+Array(t+1).join(e.spaces)}function l(e,t,r){if(t.ignoreAttributes)return"";"attributesFn"in t&&(e=t.attributesFn(e,i,n));var a,s,l,c,d=[];for(a in e)e.hasOwnProperty(a)&&null!==e[a]&&void 0!==e[a]&&(c=t.noQuotesForNativeAttributes&&"string"!=typeof e[a]?"":'"',s=(s=""+e[a]).replace(/"/g,"&quot;"),l="attributeNameFn"in t?t.attributeNameFn(a,s,i,n):a,d.push(t.spaces&&t.indentAttributes?o(t,r+1,!1):" "),d.push(l+"="+c+("attributeValueFn"in t?t.attributeValueFn(s,a,i,n):s)+c));return e&&Object.keys(e).length&&t.spaces&&t.indentAttributes&&d.push(o(t,r,!1)),d.join("")}function c(e,t,r){return n=e,i="xml",t.ignoreDeclaration?"":"<?xml"+l(e[t.attributesKey],t,r)+"?>"}function d(e,t,r){if(t.ignoreInstruction)return"";var a;for(a in e)if(e.hasOwnProperty(a))break;var s="instructionNameFn"in t?t.instructionNameFn(a,e[a],i,n):a;if("object"==typeof e[a])return n=e,i=s,"<?"+s+l(e[a][t.attributesKey],t,r)+"?>";var o=e[a]?e[a]:"";return"instructionFn"in t&&(o=t.instructionFn(o,a,i,n)),"<?"+s+(o?" "+o:"")+"?>"}function u(e,t){return t.ignoreComment?"":"\x3c!--"+("commentFn"in t?t.commentFn(e,i,n):e)+"--\x3e"}function p(e,t){return t.ignoreCdata?"":"<![CDATA["+("cdataFn"in t?t.cdataFn(e,i,n):e.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function h(e,t){return t.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in t?t.doctypeFn(e,i,n):e)+">"}function f(e,t){return t.ignoreText?"":(e=(e=(e=""+e).replace(/&amp;/g,"&")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in t?t.textFn(e,i,n):e)}function m(e,t,r,a){return e.reduce((function(e,s){var c=o(t,r,a&&!e);switch(s.type){case"element":return e+c+function(e,t,r){n=e,i=e.name;var a=[],s="elementNameFn"in t?t.elementNameFn(e.name,e):e.name;a.push("<"+s),e[t.attributesKey]&&a.push(l(e[t.attributesKey],t,r));var o=e[t.elementsKey]&&e[t.elementsKey].length||e[t.attributesKey]&&"preserve"===e[t.attributesKey]["xml:space"];return o||(o="fullTagEmptyElementFn"in t?t.fullTagEmptyElementFn(e.name,e):t.fullTagEmptyElement),o?(a.push(">"),e[t.elementsKey]&&e[t.elementsKey].length&&(a.push(m(e[t.elementsKey],t,r+1)),n=e,i=e.name),a.push(t.spaces&&function(e,t){var r;if(e.elements&&e.elements.length)for(r=0;r<e.elements.length;++r)switch(e.elements[r][t.typeKey]){case"text":if(t.indentText)return!0;break;case"cdata":if(t.indentCdata)return!0;break;case"instruction":if(t.indentInstruction)return!0;break;default:return!0}return!1}(e,t)?"\n"+Array(r+1).join(t.spaces):""),a.push("</"+s+">")):a.push("/>"),a.join("")}(s,t,r);case"comment":return e+c+u(s[t.commentKey],t);case"doctype":return e+c+h(s[t.doctypeKey],t);case"cdata":return e+(t.indentCdata?c:"")+p(s[t.cdataKey],t);case"text":return e+(t.indentText?c:"")+f(s[t.textKey],t);case"instruction":var g={};return g[s[t.nameKey]]=s[t.attributesKey]?s:s[t.instructionKey],e+(t.indentInstruction?c:"")+d(g,t,r)}}),"")}function g(e,t,r){var n;for(n in e)if(e.hasOwnProperty(n))switch(n){case t.parentKey:case t.attributesKey:break;case t.textKey:if(t.indentText||r)return!0;break;case t.cdataKey:if(t.indentCdata||r)return!0;break;case t.instructionKey:if(t.indentInstruction||r)return!0;break;case t.doctypeKey:case t.commentKey:default:return!0}return!1}function _(e,t,r,a,s){n=e,i=t;var c="elementNameFn"in r?r.elementNameFn(t,e):t;if(null==e||""===e)return"fullTagEmptyElementFn"in r&&r.fullTagEmptyElementFn(t,e)||r.fullTagEmptyElement?"<"+c+"></"+c+">":"<"+c+"/>";var d=[];if(t){if(d.push("<"+c),"object"!=typeof e)return d.push(">"+f(e,r)+"</"+c+">"),d.join("");e[r.attributesKey]&&d.push(l(e[r.attributesKey],r,a));var u=g(e,r,!0)||e[r.attributesKey]&&"preserve"===e[r.attributesKey]["xml:space"];if(u||(u="fullTagEmptyElementFn"in r?r.fullTagEmptyElementFn(t,e):r.fullTagEmptyElement),!u)return d.push("/>"),d.join("");d.push(">")}return d.push(b(e,r,a+1,!1)),n=e,i=t,t&&d.push((s?o(r,a,!1):"")+"</"+c+">"),d.join("")}function b(e,t,r,n){var i,a,l,m=[];for(a in e)if(e.hasOwnProperty(a))for(l=s(e[a])?e[a]:[e[a]],i=0;i<l.length;++i){switch(a){case t.declarationKey:m.push(c(l[i],t,r));break;case t.instructionKey:m.push((t.indentInstruction?o(t,r,n):"")+d(l[i],t,r));break;case t.attributesKey:case t.parentKey:break;case t.textKey:m.push((t.indentText?o(t,r,n):"")+f(l[i],t));break;case t.cdataKey:m.push((t.indentCdata?o(t,r,n):"")+p(l[i],t));break;case t.doctypeKey:m.push(o(t,r,n)+h(l[i],t));break;case t.commentKey:m.push(o(t,r,n)+u(l[i],t));break;default:m.push(o(t,r,n)+_(l[i],a,t,r,g(l[i],t)))}n=n&&!m.length}return m.join("")}e.exports=function(e,t){t=function(e){var t=a.copyOptions(e);return a.ensureFlagExists("ignoreDeclaration",t),a.ensureFlagExists("ignoreInstruction",t),a.ensureFlagExists("ignoreAttributes",t),a.ensureFlagExists("ignoreText",t),a.ensureFlagExists("ignoreComment",t),a.ensureFlagExists("ignoreCdata",t),a.ensureFlagExists("ignoreDoctype",t),a.ensureFlagExists("compact",t),a.ensureFlagExists("indentText",t),a.ensureFlagExists("indentCdata",t),a.ensureFlagExists("indentAttributes",t),a.ensureFlagExists("indentInstruction",t),a.ensureFlagExists("fullTagEmptyElement",t),a.ensureFlagExists("noQuotesForNativeAttributes",t),a.ensureSpacesExists(t),"number"==typeof t.spaces&&(t.spaces=Array(t.spaces+1).join(" ")),a.ensureKeyExists("declaration",t),a.ensureKeyExists("instruction",t),a.ensureKeyExists("attributes",t),a.ensureKeyExists("text",t),a.ensureKeyExists("comment",t),a.ensureKeyExists("cdata",t),a.ensureKeyExists("doctype",t),a.ensureKeyExists("type",t),a.ensureKeyExists("name",t),a.ensureKeyExists("elements",t),a.checkFnExists("doctype",t),a.checkFnExists("instruction",t),a.checkFnExists("cdata",t),a.checkFnExists("comment",t),a.checkFnExists("text",t),a.checkFnExists("instructionName",t),a.checkFnExists("elementName",t),a.checkFnExists("attributeName",t),a.checkFnExists("attributeValue",t),a.checkFnExists("attributes",t),a.checkFnExists("fullTagEmptyElement",t),t}(t);var r=[];return n=e,i="_root_",t.compact?r.push(b(e,t,0,!0)):(e[t.declarationKey]&&r.push(c(e[t.declarationKey],t,0)),e[t.elementsKey]&&e[t.elementsKey].length&&r.push(m(e[t.elementsKey],t,0,!r.length))),r.join("")}},1026:e=>{e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2736%27 height=%2712%27%3E%3Cpath fill=%27rgba%2817, 17, 17, 0.9%29%27 d=%27M33.342 12H1.338c6 0 11.627-12.002 16.002-12.002S27.406 12 33.342 12%27/%3E%3C/svg%3E"},1113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},1427:(e,t,r)=>{r(8990);const n=r(9233);e.exports={check:function(e,t){const r=t||{};return r.platform=r.platform||"all",n.check(e,t).then((e=>e))},verifyAndFix:function(e,t){const r=t||{};return r.platform=r.platform||"all",n.verifyAndFix(e,t).then((e=>e))}}},1601:e=>{e.exports=function(e){return e[1]}},1701:e=>{function t(e,t,r){const n={type:"tag",tag:e.name};return n.tag=e.name,n.attribute=t,n.value=r||!e.attributes?void 0:e.attributes[t],void 0!==e.position&&(n.position=e.position),n}function r(e,t,r){let n;if(r||"infinity"!==e)if(e.match("[0-9]+ms"))n=parseInt(e);else if(e.match(/^[0-9]+(\.[0-9]+)?s$/g))n=1e3*parseInt(e);else{if("google"!==t||!e.match(/^[0-9]+(\.[0-9]+)?$/g))return;n=1e3*parseInt(e)}else n=Number.MAX_SAFE_INTEGER;return r&&(n=n<=r?n:void 0),n}function n(e,t,r,n){let i=parseFloat(e),a=!0;return isNaN(i)?(a=!1,i=n):i<t?(a=!1,i=t):i>r&&(a=!1,i=r),{inRange:a,value:i}}const i=(e,r,n,i,a,s)=>(Object.keys(i.attributes||{}).forEach((e=>{n.push(t(i,e,!0)),i.attributes[e]=void 0})),!1),a=i,s=(e,t,r,n,i,a)=>{if(n.elements){let e;for(e=0;e<n.elements.length;e++){const t=n.elements[e];if(-1===["par","seq","media"].indexOf(t.name)){const i={type:"tag",tag:n.name};i.value=t.name,void 0!==n.position&&(i.position=n.position),r.push(i),n.elements.splice(e,1),e--}}}return!1},o=s;e.exports={check_alexa_name:(e,r,n,i,a,s)=>{const o=Object.keys(i.attributes||{});return o.forEach((e=>{"type"===e?-1===["first"].indexOf(i.attributes.type)&&(n.push(t(i,e)),i.attributes.type="first"):"personId"===e?-1===i.attributes.personId.indexOf("amzn1.ask.person.")&&n.push(t(i,e)):(n.push(t(i,e,!0)),i.attributes[e]=void 0)})),-1===o.indexOf("type")&&(n.push(t(i,"missing type")),i.attributes={type:"first"}),-1===o.indexOf("personId")&&(n.push(t(i,"missing personId")),i.attributes={personId:"amzn1.ask.person.ABCD"}),!1},check_amazon_auto_breaths:(e,r,n,i,a,s)=>(Object.keys(i.attributes||{}).forEach((e=>{"duration"===e?-1===["default","x-short","short","medium","long","x-long"].indexOf(i.attributes.duration)&&(n.push(t(i,e)),i.attributes.duration="medium"):"volume"===e?-1===["default","x-soft","soft","medium","loud","x-loud"].indexOf(i.attributes.volume)&&(n.push(t(i,e)),i.attributes.volume="medium"):"frequency"===e?-1===["default","x-low","low","medium","high","x-high"].indexOf(i.attributes.frequency)&&(n.push(t(i,e)),i.attributes.frequncy="medium"):(n.push(t(i,e,!0)),i.attributes[e]=void 0)})),!1),check_amazon_breath:(e,r,n,i,a,s)=>(Object.keys(i.attributes||{}).forEach((e=>{"duration"===e?-1===["default","x-short","short","medium","long","x-long"].indexOf(i.attributes.duration)&&(n.push(t(i,e)),i.attributes.duration="medium"):"volume"===e?-1===["default","x-soft","soft","medium","loud","x-loud"].indexOf(i.attributes.volume)&&(n.push(t(i,e)),i.attributes.volume="medium"):(n.push(t(i,e,!0)),i.attributes[e]=void 0)})),!1),check_amazon_domain:(e,r,n,i,a,s)=>{if(s&&-1===["en-US","en-GB","jp-JP","de-DE","en-CA","en-AU"].indexOf(s))return n.push(t(i,"none")),i.elements?e.elements.splice(r,1,...i.elements):e.elements.splice(r,1),!0;const o=Object.keys(i.attributes||{});o.forEach((e=>{if("name"===e){const r={conversational:["en-US","jp-JP"],"long-form":["en-US"],music:["de-DE","en-US","en-CA","en-GB"],news:["en-US","en-AU"],fun:["jp-JP"]};(!r[i.attributes.name]||s&&-1===r[i.attributes.name].indexOf(s))&&(n.push(t(i,e)),i.attributes.name="news")}else n.push(t(i,e,!0)),i.attributes[e]=void 0})),0===o.length&&(n.push(t(i,"none")),i.attributes={name:"news"})},check_amazon_effect:(e,r,i,a,s,o)=>{const l=Object.keys(a.attributes||{});return l.forEach((e=>{if("name"===e)-1===["drc","whispered"].indexOf(a.attributes.name)&&(i.push(t(a,e)),a.attributes.name="whispered");else if("phonation"===e)-1===["soft"].indexOf(a.attributes.phonation)&&(i.push(t(a,e)),a.attributes.phonation="soft");else if("vocal-tract-length"===e){const r=a.attributes["vocal-tract-length"].match(/([\+|\-]?)(\d+)%/);if(r){if(r[1].length){const s=n(`${r[1]}${r[2]}`,-50,100,void 0);s.inRange||(i.push(t(a,e)),a.attributes["vocal-tract-length"]=`${s.value>0?"+":""}${s.value}%`)}}else i.push(t(a,e)),a.attributes["vocal-tract-length"]="+100%"}else i.push(t(a,e,!0)),a.attributes[e]=void 0})),0===l.length&&(i.push(t(a,"none")),a.attributes={name:"whispered"}),!1},check_amazon_emotion:(e,r,n,i,a,s)=>{if(-1===["en-US","en-GB","jp-JP"].indexOf(s))return n.push(t(i,"none")),i.elements?e.elements.splice(r,1,...i.elements):e.elements.splice(r,1),!0;const o=Object.keys(i.attributes||{});return o.forEach((e=>{"name"===e?-1===["excited","disappointed"].indexOf(i.attributes.name)&&(n.push(t(i,e)),i.attributes.name="excited"):"intensity"===e?-1===["low","medium","high"].indexOf(i.attributes.intensity)&&(n.push(t(i,e)),i.attributes.intensity="medium"):(n.push(t(i,e,!0)),i.attributes[e]=void 0)})),2!==o.length&&(n.push(t(i,"none")),i.attributes.name=i.attributes.name||"excited",i.attributes.intensity=i.attributes.intensity||"medium"),!1},check_audio:(e,i,a,s,o,l)=>{const c=Object.keys(s.attributes||{});let d;return c.forEach((e=>{if("google"===o&&"clipBegin"===e)void 0===r(s.attributes.clipBegin,o)&&(a.push(t(s,e)),s.attributes.clipBegin=void 0);else if("google"===o&&"clipEnd"===e)void 0===r(s.attributes.clipEnd,o)&&(a.push(t(s,e)),s.attributes.clipEnd=void 0);else if("google"===o&&"speed"===e){const r=n(s.attributes.speed,50,200,100);s.attributes.speed.match(/^(\+)?[0-9]+(\.[0-9]+)?%$/g)&&r.inRange||(a.push(t(s,e)),s.attributes.speed=r.value+"%")}else if("google"===o&&"repeatCount"===e)s.attributes.repeatCount.match(/^(\+)?[0-9]+(\.[0-9]+)?$/g)||(a.push(t(s,e)),s.attributes.repeatCount="1");else if("google"===o&&"repeatDur"===e)void 0===r(s.attributes.repeatDur,o)&&(a.push(t(s,e)),s.attributes.repeatDur=void 0);else if("google"===o&&"soundLevel"===e){const r=n(s.attributes.soundLevel,-40,40,0);s.attributes.soundLevel.match(/^[+-][0-9]+(\.[0-9]+)?dB$/g)&&r.inRange||(a.push(t(s,e)),s.attributes.soundLevel=r.value<0?r.value+"dB":"+"+r.value+"dB")}else"src"!==e&&(a.push(t(s,e,!0)),s.attributes[e]=void 0)})),0===c.length&&(a.push(t(s,"none")),e.elements.splice(i,1),d=!0),d},check_break:(e,n,i,a,s,o)=>(Object.keys(a.attributes||{}).forEach((e=>{"strength"===e?-1===["none","x-weak","weak","medium","strong","x-strong"].indexOf(a.attributes.strength)&&(i.push(t(a,e)),a.attributes.strength="medium"):"time"===e?void 0===r(a.attributes.time,s,1e4)&&(i.push(t(a,e)),a.attributes.time="10s"):(i.push(t(a,e,!0)),a.attributes[e]=void 0)})),a.attributes.strength||a.attributes.time||(a.attributes.strength="medium"),!1),check_desc:(e,t,r,n,i,a)=>{let s;if(!e||"audio"!==e.name){const i={type:"tag",tag:n.name};void 0!==n.position&&(i.position=n.position),r.push(i),e.elements.splice(t,1),s=!0}return s},check_emphasis:(e,r,n,i,a,s)=>{const o=Object.keys(i.attributes||{});return o.forEach((e=>{"level"===e?-1===["strong","moderate","reduced"].indexOf(i.attributes.level)&&("google"===a&&"none"===i.attributes.level||(n.push(t(i,e)),i.attributes.level="moderate")):(n.push(t(i,e,!0)),i.attributes[e]=void 0)})),0===o.length&&(n.push(t(i,"none")),i.attributes={level:"moderate"}),!1},check_lang:(e,r,n,i,a,s)=>{const o=Object.keys(i.attributes||{}),l=["de-DE","en-AU","en-CA","en-GB","en-IN","en-US","es-ES","es-MX","es-US","fr-CA","fr-FR","hi-IN","it-IT","ja-JP","pt-BR"];return o.forEach((e=>{"xml:lang"===e?l.includes(i.attributes["xml:lang"])||(n.push(t(i,e)),i.attributes["xml:lang"]="en-US"):(n.push(t(i,e,!0)),i.attributes[e]=void 0)})),0===o.length&&(n.push(t(i,"none")),i.attributes={"xml:lang":"en-US"}),!1},check_mark:(e,r,n,i,a,s)=>{const o=Object.keys(i.attributes||{});return o.forEach((e=>{"name"!==e&&(n.push(t(i,e,!0)),i.attributes[e]=void 0)})),0===o.length&&(n.push(t(i,"none")),i.attributes={name:"mark"}),!1},check_media:(e,n,i,a,s,o)=>(Object.keys(a.attributes||{}).forEach((e=>{"xml:id"===e?a.attributes["xml:id"].match(/^([-_#]|[a-z]|[A-Z]|ÃŸ|Ã¶|Ã¤|Ã¼|Ã–|Ã„|Ãœ|Ã¦|Ã©|[0-9])+$/g)||(i.push(t(a,e)),a.attributes["xml:id"]="id_"+n):"begin"===e?a.attributes.begin.match(/^[+-]?[0-9]+(\.[0-9]+)?(h|min|s|ms)$/g)||a.attributes.begin.match(/^([-_#]|[a-z]|[A-Z]|ÃŸ|Ã¶|Ã¤|Ã¼|Ã–|Ã„|Ãœ|Ã¦|Ã©|[0-9])+\.(begin|end)[+-][0-9]+(\.[0-9]+)?(h|min|s|ms)$/g)||(i.push(t(a,e)),a.attributes.begin="0"):"end"===e?a.attributes.end.match(/^[+-]?[0-9]+(\.[0-9]+)?(h|min|s|ms)$/g)||a.attributes.end.match(/^([-_#]|[a-z]|[A-Z]|ÃŸ|Ã¶|Ã¤|Ã¼|Ã–|Ã„|Ãœ|Ã¦|Ã©|[0-9])+\.(begin|end)[+-][0-9]+(\.[0-9]+)?(h|min|s|ms)$/g)||(i.push(t(a,e)),a.attributes.end=void 0):"repeatCount"===e?a.attributes.repeatCount.match(/^(\+)?[0-9]+(\.[0-9]+)?$/g)||(i.push(t(a,e)),a.attributes.repeatCount="1"):"repeatDur"===e?void 0===r(a.attributes.repeatDur,s)&&(i.push(t(a,e)),a.attributes.repeatDur=void 0):"soundLevel"===e?a.attributes.soundLevel.match(/^[+-]?[0-9]+(\.[0-9]+)?dB$/g)||(i.push(t(a,e)),a.attributes.soundLevel="+0dB"):"fadeInDur"===e?void 0===r(a.attributes.fadeInDur,s)&&(i.push(t(a,e)),a.attributes.fadeInDur="0s"):"fadeOutDur"===e?void 0===r(a.attributes.fadeOutDur,s)&&(i.push(t(a,e)),a.attributes.fadeOutDur="0s"):i.push(t(a,e,!0))})),!1),check_p:i,check_par:s,check_phoneme:(e,r,n,i,a,s)=>(Object.keys(i.attributes||{}).forEach((e=>{"alphabet"===e?-1===["ipa","x-sampa"].indexOf(i.attributes.alphabet)&&(n.push(t(i,e)),i.attributes.alphabet="ipa"):"ph"!==e&&(n.push(t(i,e,!0)),i.attributes[e]=void 0)})),!1),check_prosody:(e,i,a,s,o,l)=>(Object.keys(s.attributes||{}).forEach((e=>{if("rate"===e){if(-1===["x-slow","slow","medium","fast","x-fast"].indexOf(s.attributes.rate)){const r=n(s.attributes.rate,20,Number.MAX_SAFE_INTEGER,100);s.attributes.rate.match(/^[0-9]+(\.[0-9]+)?%$/g)&&r.inRange||(a.push(t(s,e)),s.attributes.rate=r.value+"%")}}else if("pitch"===e){if(-1===["x-low","low","medium","high","x-high"].indexOf(s.attributes.pitch)){const r=n(s.attributes.pitch,-33.3,50,0);s.attributes.pitch.match(/^[+-][0-9]+(\.[0-9]+)?%$/g)&&r.inRange||"google"===o&&s.attributes.pitch.match(/^[+-]+[0-9]+(\.[0-9]+)?st$/g)||(a.push(t(s,e)),s.attributes.pitch=r.value<0?r.value+"%":"+"+r.value+"%")}}else"volume"===e?-1===["silent","x-soft","soft","medium","loud","x-loud"].indexOf(s.attributes.volume)&&(s.attributes.volume.match(/^[+-][0-9]+(\.[0-9]+)?dB$/g)||(a.push(t(s,e)),s.attributes.volume="+0dB")):"amazon:max-duration"===e&&"amazon"===o?void 0===r(s.attributes["amazon:max-duration"],o,void 0)&&(a.push(t(s,e)),s.attributes["amazon:max-duration"]="2s"):(a.push(t(s,e,!0)),s.attributes[e]=void 0)})),!1),check_s:a,check_say_as:(e,r,n,i,a,s)=>(Object.keys(i.attributes||{}).forEach((e=>{if("interpret-as"===e){if(-1===["characters","spell-out","cardinal","ordinal","fraction","unit","date","time","telephone","expletive","beep","number","verbatim","currency"].indexOf(i.attributes["interpret-as"])){let r=!1;("amazon"===a&&["number","digits","address","interjection"].indexOf(-1!==i.attributes["interpret-as"])||"google"===a&&["bleep","verbatim"].indexOf(-1!==i.attributes["interpret-as"]))&&(r=!0),r||(n.push(t(i,e)),i.attributes["interpret-as"]="cardinal")}}else"format"===e?"date"===i.attributes["interpret-as"]?-1===["mdy","dmy","ymd","md","dm","ym","my","d","m","y"].indexOf(i.attributes.format)&&(n.push(t(i,e)),i.attributes.format="mdy"):"google"===a?i.attributes.format.match(/^[hmsZ^\s.!?:;(12|24)]*$/g)||(n.push(t(i,e)),i.attributes.format="hms12"):(n.push(t(i,e)),i.attributes.format=void 0):"google"===a&&"detail"===e?-1===["1","2"].indexOf(i.attributes.detail)&&(n.push(t(i,e)),i.attributes.detail="1"):(n.push(t(i,e,!0)),i.attributes[e]=void 0)})),!1),check_seq:o,check_speak:(e,t,r,n,i,a)=>!1,check_sub:(e,r,n,i,a,s)=>(Object.keys(i.attributes||{}).forEach((e=>{"alias"!==e&&(n.push(t(i,e,!0)),i.attributes[e]=void 0)})),!1),check_voice:(e,r,n,i,a,s)=>"amazon"===a?((e,r,n,i)=>(Object.keys(i.attributes||{}).forEach((e=>{"name"===e?-1===["Ivy","Joanna","Joey","Justin","Kendra","Kimberly","Matthew","Salli","Nicole","Russell","Amy","Brian","Emma","Aditi","Raveena","Hans","Marlene","Vicki","Conchita","Enrique","Carla","Giorgio","Mizuki","Takumi","Celine","Lea","Mathieu"].indexOf(i.attributes.name)&&(n.push(t(i,e)),i.attributes.name="Ivy"):(n.push(t(i,e,!0)),i.attributes[e]=void 0)})),!1))(0,0,n,i):"google"===a?((e,r,n,i)=>{const a=e=>{const t=e.split("-");return 4===t.length&&-1!==["af","ar","bn","cmn","cs","da","de","el","en","es","fi","fil","fr","gu","hi","hu","id","it","ja","kn","ko","ml","mr","nb","nl","pl","pt","ru","sk","sv","sw","ta","te","th","tr","uk","vi","yue","zh"].indexOf(t[0])&&-1!==["Standard","Wavenet"].indexOf(t[2])&&-1!==["A","B","C","D","E","F","G","H","I","J"].indexOf(t[3])&&2===t[1].length};let s=!1,o=!1;Object.keys(i.attributes||{}).forEach((e=>{"name"===e?(s=!0,a(i.attributes.name)||(n.push(t(i,e)),i.attributes.name="en-US-Standard-A")):"gender"===e?(o=!0,-1===["male","female","neutral"].indexOf(i.attributes.gender)&&(n.push(t(i,e)),i.attributes.gender="neutral")):"variant"===e?(o=!0,a(i.attributes.variant)||(n.push(t(i,e)),i.attributes.variant="en-US-Standard-A")):"language"===e?(o=!0,i.attributes.language.match(/^[a-z]{2}-[A-Z]{2}$/)||(n.push(t(i,e)),i.attributes.language="en-US")):"required"!==e&&"ordering"!==e&&(n.push(t(i,e,!0)),i.attributes[e]=void 0)})),s||o||(n.push(t(i,"name",!0)),i.attributes||(i.attributes={}),i.attributes.name="en-US-Standard-A")})(0,0,n,i):(n.push(t(i,"voice",!0)),i.attributes.voice=void 0,!1),check_w:(e,r,n,i,a,s)=>(Object.keys(i.attributes||{}).forEach((e=>{"role"===e?-1===["amazon:VB","amazon:VBD","amazon:NN","amazon:DT","amazon:IN","amazon:JJ","amazon:SENSE_1"].indexOf(i.attributes.role)&&(n.push(t(i,e)),i.attributes.role="amazon:VB"):(n.push(t(i,e,!0)),i.attributes[e]=void 0)})),!1)}},1800:e=>{var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},1873:(e,t,r)=>{var n=r(9325).Symbol;e.exports=n},2147:(e,t,r)=>{r.r(t),r.d(t,{diagnostics:()=>s,filterEvent:()=>o,handleEvent:()=>l,listen:()=>c});var n=r(5059);const i={rE:"2.24.5"};var a={events:{broadcast:!1,listenFor:"all"}};function s(){var e=window.LearnosityApp?LearnosityApp.versions:{};return{apps:{},LT:{version:i.rE},versions:e}}function o(e){/^[a-zA-Z:*]*$/.test(e)?a.events.listenFor=e:n.A.warn("Invalid event type")}function l(e){if(a.events.broadcast){var t=a.events.listenFor,r=t.replaceAll("*","");1===t.length&&"*"===t||"all"===t?n.A.info(e):t.startsWith("*")&&!t.endsWith("*")?e.endsWith(r)&&n.A.info(e):t.endsWith("*")&&!t.startsWith("*")?e.startsWith(r)&&n.A.info(e):t.startsWith("*")&&t.endsWith("*")?e.includes(r)&&n.A.info(e):e.startsWith(r)&&n.A.info(e)}}function c(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];a.events.broadcast=Boolean(e),Boolean(e)?n.A.info("ðŸ‘‚ listening for '".concat(a.events.listenFor,"'")):n.A.info("ðŸš«ðŸ‘‚ not listening")}},2530:(e,t,r)=>{r.r(t),r.d(t,{type:()=>i});var n=r(5716);function i(){var e;return null===(e=n.appInstance().getWidget())||void 0===e?void 0:e.type}},2552:(e,t,r)=>{var n=r(1873),i=r(659),a=r(9350),s=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?i(e):a(e)}},2660:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeMap=t.OpIterator=t.Op=void 0;const n=r(5606),i=r(7193),a=r(8142),s=r(9106);t.AttributeMap=s.default;const o=r(5759);t.Op=o.default;const l=r(8317);t.OpIterator=l.default;const c=String.fromCharCode(0),d=(e,t)=>{if("object"!=typeof e||null===e)throw new Error("cannot retain a "+typeof e);if("object"!=typeof t||null===t)throw new Error("cannot retain a "+typeof t);const r=Object.keys(e)[0];if(!r||r!==Object.keys(t)[0])throw new Error(`embed types not matched: ${r} != ${Object.keys(t)[0]}`);return[r,e[r],t[r]]};class u{constructor(e){Array.isArray(e)?this.ops=e:null!=e&&Array.isArray(e.ops)?this.ops=e.ops:this.ops=[]}static registerEmbed(e,t){this.handlers[e]=t}static unregisterEmbed(e){delete this.handlers[e]}static getHandler(e){const t=this.handlers[e];if(!t)throw new Error(`no handlers for embed type "${e}"`);return t}insert(e,t){const r={};return"string"==typeof e&&0===e.length?this:(r.insert=e,null!=t&&"object"==typeof t&&Object.keys(t).length>0&&(r.attributes=t),this.push(r))}delete(e){return e<=0?this:this.push({delete:e})}retain(e,t){if("number"==typeof e&&e<=0)return this;const r={retain:e};return null!=t&&"object"==typeof t&&Object.keys(t).length>0&&(r.attributes=t),this.push(r)}push(e){let t=this.ops.length,r=this.ops[t-1];if(e=i(e),"object"==typeof r){if("number"==typeof e.delete&&"number"==typeof r.delete)return this.ops[t-1]={delete:r.delete+e.delete},this;if("number"==typeof r.delete&&null!=e.insert&&(t-=1,r=this.ops[t-1],"object"!=typeof r))return this.ops.unshift(e),this;if(a(e.attributes,r.attributes)){if("string"==typeof e.insert&&"string"==typeof r.insert)return this.ops[t-1]={insert:r.insert+e.insert},"object"==typeof e.attributes&&(this.ops[t-1].attributes=e.attributes),this;if("number"==typeof e.retain&&"number"==typeof r.retain)return this.ops[t-1]={retain:r.retain+e.retain},"object"==typeof e.attributes&&(this.ops[t-1].attributes=e.attributes),this}}return t===this.ops.length?this.ops.push(e):this.ops.splice(t,0,e),this}chop(){const e=this.ops[this.ops.length-1];return e&&"number"==typeof e.retain&&!e.attributes&&this.ops.pop(),this}filter(e){return this.ops.filter(e)}forEach(e){this.ops.forEach(e)}map(e){return this.ops.map(e)}partition(e){const t=[],r=[];return this.forEach((n=>{(e(n)?t:r).push(n)})),[t,r]}reduce(e,t){return this.ops.reduce(e,t)}changeLength(){return this.reduce(((e,t)=>t.insert?e+o.default.length(t):t.delete?e-t.delete:e),0)}length(){return this.reduce(((e,t)=>e+o.default.length(t)),0)}slice(e=0,t=1/0){const r=[],n=new l.default(this.ops);let i=0;for(;i<t&&n.hasNext();){let a;i<e?a=n.next(e-i):(a=n.next(t-i),r.push(a)),i+=o.default.length(a)}return new u(r)}compose(e){const t=new l.default(this.ops),r=new l.default(e.ops),n=[],i=r.peek();if(null!=i&&"number"==typeof i.retain&&null==i.attributes){let e=i.retain;for(;"insert"===t.peekType()&&t.peekLength()<=e;)e-=t.peekLength(),n.push(t.next());i.retain-e>0&&r.next(i.retain-e)}const o=new u(n);for(;t.hasNext()||r.hasNext();)if("insert"===r.peekType())o.push(r.next());else if("delete"===t.peekType())o.push(t.next());else{const e=Math.min(t.peekLength(),r.peekLength()),n=t.next(e),i=r.next(e);if(i.retain){const l={};if("number"==typeof n.retain)l.retain="number"==typeof i.retain?e:i.retain;else if("number"==typeof i.retain)null==n.retain?l.insert=n.insert:l.retain=n.retain;else{const e=null==n.retain?"insert":"retain",[t,r,a]=d(n[e],i.retain),s=u.getHandler(t);l[e]={[t]:s.compose(r,a,"retain"===e)}}const c=s.default.compose(n.attributes,i.attributes,"number"==typeof n.retain);if(c&&(l.attributes=c),o.push(l),!r.hasNext()&&a(o.ops[o.ops.length-1],l)){const e=new u(t.rest());return o.concat(e).chop()}}else"number"==typeof i.delete&&("number"==typeof n.retain||"object"==typeof n.retain&&null!==n.retain)&&o.push(i)}return o.chop()}concat(e){const t=new u(this.ops.slice());return e.ops.length>0&&(t.push(e.ops[0]),t.ops=t.ops.concat(e.ops.slice(1))),t}diff(e,t){if(this.ops===e.ops)return new u;const r=[this,e].map((t=>t.map((r=>{if(null!=r.insert)return"string"==typeof r.insert?r.insert:c;throw new Error("diff() called "+(t===e?"on":"with")+" non-document")})).join(""))),i=new u,o=n(r[0],r[1],t,!0),d=new l.default(this.ops),p=new l.default(e.ops);return o.forEach((e=>{let t=e[1].length;for(;t>0;){let r=0;switch(e[0]){case n.INSERT:r=Math.min(p.peekLength(),t),i.push(p.next(r));break;case n.DELETE:r=Math.min(t,d.peekLength()),d.next(r),i.delete(r);break;case n.EQUAL:r=Math.min(d.peekLength(),p.peekLength(),t);const e=d.next(r),o=p.next(r);a(e.insert,o.insert)?i.retain(r,s.default.diff(e.attributes,o.attributes)):i.push(o).delete(r)}t-=r}})),i.chop()}eachLine(e,t="\n"){const r=new l.default(this.ops);let n=new u,i=0;for(;r.hasNext();){if("insert"!==r.peekType())return;const a=r.peek(),s=o.default.length(a)-r.peekLength(),l="string"==typeof a.insert?a.insert.indexOf(t,s)-s:-1;if(l<0)n.push(r.next());else if(l>0)n.push(r.next(l));else{if(!1===e(n,r.next(1).attributes||{},i))return;i+=1,n=new u}}n.length()>0&&e(n,{},i)}invert(e){const t=new u;return this.reduce(((r,n)=>{if(n.insert)t.delete(o.default.length(n));else{if("number"==typeof n.retain&&null==n.attributes)return t.retain(n.retain),r+n.retain;if(n.delete||"number"==typeof n.retain){const i=n.delete||n.retain;return e.slice(r,r+i).forEach((e=>{n.delete?t.push(e):n.retain&&n.attributes&&t.retain(o.default.length(e),s.default.invert(n.attributes,e.attributes))})),r+i}if("object"==typeof n.retain&&null!==n.retain){const i=e.slice(r,r+1),a=new l.default(i.ops).next(),[o,c,p]=d(n.retain,a.insert),h=u.getHandler(o);return t.retain({[o]:h.invert(c,p)},s.default.invert(n.attributes,a.attributes)),r+1}}return r}),0),t.chop()}transform(e,t=!1){if(t=!!t,"number"==typeof e)return this.transformPosition(e,t);const r=e,n=new l.default(this.ops),i=new l.default(r.ops),a=new u;for(;n.hasNext()||i.hasNext();)if("insert"!==n.peekType()||!t&&"insert"===i.peekType())if("insert"===i.peekType())a.push(i.next());else{const e=Math.min(n.peekLength(),i.peekLength()),r=n.next(e),o=i.next(e);if(r.delete)continue;if(o.delete)a.push(o);else{const n=r.retain,i=o.retain;let l="object"==typeof i&&null!==i?i:e;if("object"==typeof n&&null!==n&&"object"==typeof i&&null!==i){const e=Object.keys(n)[0];if(e===Object.keys(i)[0]){const r=u.getHandler(e);r&&(l={[e]:r.transform(n[e],i[e],t)})}}a.retain(l,s.default.transform(r.attributes,o.attributes,t))}}else a.retain(o.default.length(n.next()));return a.chop()}transformPosition(e,t=!1){t=!!t;const r=new l.default(this.ops);let n=0;for(;r.hasNext()&&n<=e;){const i=r.peekLength(),a=r.peekType();r.next(),"delete"!==a?("insert"===a&&(n<e||!t)&&(e+=i),n+=i):e-=Math.min(i,e-n)}return e}}u.Op=o.default,u.OpIterator=l.default,u.AttributeMap=s.default,u.handlers={},t.default=u,e.exports=u,e.exports.default=u},2861:(e,t,r)=>{var n=r(8287),i=n.Buffer;function a(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(a(n,t),t.Buffer=s),s.prototype=Object.create(i.prototype),a(i,s),s.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},2978:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(1601),i=r.n(n),a=r(6314),s=r.n(a)()(i());s.push([e.id,"/*!\n * Quill Editor v2.0.3\n * https://quilljs.com\n * Copyright (c) 2017-2024, Slab\n * Copyright (c) 2014, Jason Chen\n * Copyright (c) 2013, salesforce.com\n */\n.ql-container{box-sizing:border-box;font-family:Helvetica,Arial,sans-serif;font-size:13px;height:100%;margin:0;position:relative}.ql-container.ql-disabled .ql-tooltip{visibility:hidden}.ql-container:not(.ql-disabled) li[data-list=checked] > .ql-ui,.ql-container:not(.ql-disabled) li[data-list=unchecked] > .ql-ui{cursor:pointer}.ql-clipboard{left:-100000px;height:1px;overflow-y:hidden;position:absolute;top:50%}.ql-clipboard p{margin:0;padding:0}.ql-editor{box-sizing:border-box;counter-reset:list-0 list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9;line-height:1.42;height:100%;outline:none;overflow-y:auto;padding:12px 15px;tab-size:4;-moz-tab-size:4;text-align:left;white-space:pre-wrap;word-wrap:break-word}.ql-editor > *{cursor:text}.ql-editor p,.ql-editor ol,.ql-editor pre,.ql-editor blockquote,.ql-editor h1,.ql-editor h2,.ql-editor h3,.ql-editor h4,.ql-editor h5,.ql-editor h6{margin:0;padding:0}@supports (counter-set:none){.ql-editor p,.ql-editor h1,.ql-editor h2,.ql-editor h3,.ql-editor h4,.ql-editor h5,.ql-editor h6{counter-set:list-0 list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor p,.ql-editor h1,.ql-editor h2,.ql-editor h3,.ql-editor h4,.ql-editor h5,.ql-editor h6{counter-reset:list-0 list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor table{border-collapse:collapse}.ql-editor td{border:1px solid #000;padding:2px 5px}.ql-editor ol{padding-left:1.5em}.ql-editor li{list-style-type:none;padding-left:1.5em;position:relative}.ql-editor li > .ql-ui:before{display:inline-block;margin-left:-1.5em;margin-right:.3em;text-align:right;white-space:nowrap;width:1.2em}.ql-editor li[data-list=checked] > .ql-ui,.ql-editor li[data-list=unchecked] > .ql-ui{color:#777}.ql-editor li[data-list=bullet] > .ql-ui:before{content:'\\2022'}.ql-editor li[data-list=checked] > .ql-ui:before{content:'\\2611'}.ql-editor li[data-list=unchecked] > .ql-ui:before{content:'\\2610'}@supports (counter-set:none){.ql-editor li[data-list]{counter-set:list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list]{counter-reset:list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered]{counter-increment:list-0}.ql-editor li[data-list=ordered] > .ql-ui:before{content:counter(list-0, decimal) '. '}.ql-editor li[data-list=ordered].ql-indent-1{counter-increment:list-1}.ql-editor li[data-list=ordered].ql-indent-1 > .ql-ui:before{content:counter(list-1, lower-alpha) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-1{counter-set:list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-1{counter-reset:list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-2{counter-increment:list-2}.ql-editor li[data-list=ordered].ql-indent-2 > .ql-ui:before{content:counter(list-2, lower-roman) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-2{counter-set:list-3 list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-2{counter-reset:list-3 list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-3{counter-increment:list-3}.ql-editor li[data-list=ordered].ql-indent-3 > .ql-ui:before{content:counter(list-3, decimal) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-3{counter-set:list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-3{counter-reset:list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-4{counter-increment:list-4}.ql-editor li[data-list=ordered].ql-indent-4 > .ql-ui:before{content:counter(list-4, lower-alpha) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-4{counter-set:list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-4{counter-reset:list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-5{counter-increment:list-5}.ql-editor li[data-list=ordered].ql-indent-5 > .ql-ui:before{content:counter(list-5, lower-roman) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-5{counter-set:list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-5{counter-reset:list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-6{counter-increment:list-6}.ql-editor li[data-list=ordered].ql-indent-6 > .ql-ui:before{content:counter(list-6, decimal) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-6{counter-set:list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-6{counter-reset:list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-7{counter-increment:list-7}.ql-editor li[data-list=ordered].ql-indent-7 > .ql-ui:before{content:counter(list-7, lower-alpha) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-7{counter-set:list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-7{counter-reset:list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-8{counter-increment:list-8}.ql-editor li[data-list=ordered].ql-indent-8 > .ql-ui:before{content:counter(list-8, lower-roman) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-8{counter-set:list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-8{counter-reset:list-9}}.ql-editor li[data-list=ordered].ql-indent-9{counter-increment:list-9}.ql-editor li[data-list=ordered].ql-indent-9 > .ql-ui:before{content:counter(list-9, decimal) '. '}.ql-editor .ql-indent-1:not(.ql-direction-rtl){padding-left:3em}.ql-editor li.ql-indent-1:not(.ql-direction-rtl){padding-left:4.5em}.ql-editor .ql-indent-1.ql-direction-rtl.ql-align-right{padding-right:3em}.ql-editor li.ql-indent-1.ql-direction-rtl.ql-align-right{padding-right:4.5em}.ql-editor .ql-indent-2:not(.ql-direction-rtl){padding-left:6em}.ql-editor li.ql-indent-2:not(.ql-direction-rtl){padding-left:7.5em}.ql-editor .ql-indent-2.ql-direction-rtl.ql-align-right{padding-right:6em}.ql-editor li.ql-indent-2.ql-direction-rtl.ql-align-right{padding-right:7.5em}.ql-editor .ql-indent-3:not(.ql-direction-rtl){padding-left:9em}.ql-editor li.ql-indent-3:not(.ql-direction-rtl){padding-left:10.5em}.ql-editor .ql-indent-3.ql-direction-rtl.ql-align-right{padding-right:9em}.ql-editor li.ql-indent-3.ql-direction-rtl.ql-align-right{padding-right:10.5em}.ql-editor .ql-indent-4:not(.ql-direction-rtl){padding-left:12em}.ql-editor li.ql-indent-4:not(.ql-direction-rtl){padding-left:13.5em}.ql-editor .ql-indent-4.ql-direction-rtl.ql-align-right{padding-right:12em}.ql-editor li.ql-indent-4.ql-direction-rtl.ql-align-right{padding-right:13.5em}.ql-editor .ql-indent-5:not(.ql-direction-rtl){padding-left:15em}.ql-editor li.ql-indent-5:not(.ql-direction-rtl){padding-left:16.5em}.ql-editor .ql-indent-5.ql-direction-rtl.ql-align-right{padding-right:15em}.ql-editor li.ql-indent-5.ql-direction-rtl.ql-align-right{padding-right:16.5em}.ql-editor .ql-indent-6:not(.ql-direction-rtl){padding-left:18em}.ql-editor li.ql-indent-6:not(.ql-direction-rtl){padding-left:19.5em}.ql-editor .ql-indent-6.ql-direction-rtl.ql-align-right{padding-right:18em}.ql-editor li.ql-indent-6.ql-direction-rtl.ql-align-right{padding-right:19.5em}.ql-editor .ql-indent-7:not(.ql-direction-rtl){padding-left:21em}.ql-editor li.ql-indent-7:not(.ql-direction-rtl){padding-left:22.5em}.ql-editor .ql-indent-7.ql-direction-rtl.ql-align-right{padding-right:21em}.ql-editor li.ql-indent-7.ql-direction-rtl.ql-align-right{padding-right:22.5em}.ql-editor .ql-indent-8:not(.ql-direction-rtl){padding-left:24em}.ql-editor li.ql-indent-8:not(.ql-direction-rtl){padding-left:25.5em}.ql-editor .ql-indent-8.ql-direction-rtl.ql-align-right{padding-right:24em}.ql-editor li.ql-indent-8.ql-direction-rtl.ql-align-right{padding-right:25.5em}.ql-editor .ql-indent-9:not(.ql-direction-rtl){padding-left:27em}.ql-editor li.ql-indent-9:not(.ql-direction-rtl){padding-left:28.5em}.ql-editor .ql-indent-9.ql-direction-rtl.ql-align-right{padding-right:27em}.ql-editor li.ql-indent-9.ql-direction-rtl.ql-align-right{padding-right:28.5em}.ql-editor li.ql-direction-rtl{padding-right:1.5em}.ql-editor li.ql-direction-rtl > .ql-ui:before{margin-left:.3em;margin-right:-1.5em;text-align:left}.ql-editor table{table-layout:fixed;width:100%}.ql-editor table td{outline:none}.ql-editor .ql-code-block-container{font-family:monospace}.ql-editor .ql-video{display:block;max-width:100%}.ql-editor .ql-video.ql-align-center{margin:0 auto}.ql-editor .ql-video.ql-align-right{margin:0 0 0 auto}.ql-editor .ql-bg-black{background-color:#000}.ql-editor .ql-bg-red{background-color:#e60000}.ql-editor .ql-bg-orange{background-color:#f90}.ql-editor .ql-bg-yellow{background-color:#ff0}.ql-editor .ql-bg-green{background-color:#008a00}.ql-editor .ql-bg-blue{background-color:#06c}.ql-editor .ql-bg-purple{background-color:#93f}.ql-editor .ql-color-white{color:#fff}.ql-editor .ql-color-red{color:#e60000}.ql-editor .ql-color-orange{color:#f90}.ql-editor .ql-color-yellow{color:#ff0}.ql-editor .ql-color-green{color:#008a00}.ql-editor .ql-color-blue{color:#06c}.ql-editor .ql-color-purple{color:#93f}.ql-editor .ql-font-serif{font-family:Georgia,Times New Roman,serif}.ql-editor .ql-font-monospace{font-family:Monaco,Courier New,monospace}.ql-editor .ql-size-small{font-size:.75em}.ql-editor .ql-size-large{font-size:1.5em}.ql-editor .ql-size-huge{font-size:2.5em}.ql-editor .ql-direction-rtl{direction:rtl;text-align:inherit}.ql-editor .ql-align-center{text-align:center}.ql-editor .ql-align-justify{text-align:justify}.ql-editor .ql-align-right{text-align:right}.ql-editor .ql-ui{position:absolute}.ql-editor.ql-blank::before{color:rgba(0,0,0,0.6);content:attr(data-placeholder);font-style:italic;left:15px;pointer-events:none;position:absolute;right:15px}",""]);const o=s},3141:(e,t,r)=>{var n=r(2861).Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=c,t=4;break;case"utf8":this.fillLast=o,t=4;break;case"base64":this.text=d,this.end=u,t=3;break;default:return this.write=p,void(this.end=h)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function o(e){var t=this.lastTotal-this.lastNeed,r=function(e,t){if(128!=(192&t[0]))return e.lastNeed=0,"ï¿½";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"ï¿½";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"ï¿½"}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function d(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function u(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function p(e){return e.toString(this.encoding)}function h(e){return e&&e.length?this.write(e):""}t.I=a,a.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},a.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"ï¿½":t},a.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=s(t[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<r||-2===i?0:(i=s(t[n]))>=0?(i>0&&(e.lastNeed=i-2),i):--n<r||-2===i?0:(i=s(t[n]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},a.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},3145:(e,t,r)=>{var n=r(908),i=r(8287).Buffer;e.exports=function(e,t){e instanceof i&&(e=e.toString());var r=null;if("string"==typeof e)try{r=JSON.parse(e)}catch(e){throw new Error("The JSON structure is invalid")}else r=e;return n(r,t)}},3167:e=>{e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2748%27 height=%2748%27%3E%3Cpath fill=%27%231269CF%27 d=%27M24 1v1C11.85 2 2 11.85 2 24s9.85 22 22 22 22-9.85 22-22S36.15 2 24 2zm0 0V0c13.254 0 24 10.746 24 24S37.254 48 24 48 0 37.254 0 24 10.746 0 24 0zm7.707 19.293a.999.999 0 1 1-1.414 1.414L25 16.414V34a1 1 0 1 1-2 0V16.414l-5.293 5.293a.999.999 0 1 1-1.414-1.414l7-7a1 1 0 0 1 1.414 0z%27/%3E%3C/svg%3E"},3803:e=>{e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2712%27 height=%2736%27%3E%3Cpath fill=%27rgba%2817, 17, 17, 0.9%29%27 d=%27M0 33.342V1.338c0 6 12.002 11.627 12.002 16.002S0 27.406 0 33.342%27/%3E%3C/svg%3E"},3805:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},3807:function(e){e.exports=function(){function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function t(t){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?e(Object(i),!0).forEach((function(e){n(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function n(e,t,r){return(t=a(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i.apply(this,arguments)}function a(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var s={exports:{}};!function(e){"undefined"!=typeof window&&function(t){var r=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,n=t.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),i=n&&t.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),a=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,s=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,o=(n||a)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(e){var t,r,o,l,c,d,u,p,h;if(!(t=e.match(s)))throw new Error("invalid data URI");for(r=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),o=!!t[4],l=e.slice(t[0].length),c=o?atob(l):decodeURIComponent(l),d=new ArrayBuffer(c.length),u=new Uint8Array(d),p=0;p<c.length;p+=1)u[p]=c.charCodeAt(p);return n?new Blob([i?u:d],{type:r}):((h=new a).append(d),h.getBlob(r))};t.HTMLCanvasElement&&!r.toBlob&&(r.mozGetAsFile?r.toBlob=function(e,t,n){var i=this;setTimeout((function(){n&&r.toDataURL&&o?e(o(i.toDataURL(t,n))):e(i.mozGetAsFile("blob",t))}))}:r.toDataURL&&o&&(r.msToBlob?r.toBlob=function(e,t,n){var i=this;setTimeout((function(){(t&&"image/png"!==t||n)&&r.toDataURL&&o?e(o(i.toDataURL(t,n))):e(i.msToBlob(t))}))}:r.toBlob=function(e,t,r){var n=this;setTimeout((function(){e(o(n.toDataURL(t,r)))}))})),e.exports?e.exports=o:t.dataURLtoBlob=o}(window)}(s);var o=s.exports,l={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},c="undefined"!=typeof window&&void 0!==window.document?window:{},d=function(e){return e>0&&e<1/0},u=Array.prototype.slice;function p(e){return Array.from?Array.from(e):u.call(e)}var h=/^image\/.+$/;function f(e){return h.test(e)}var m=String.fromCharCode;var g=c.btoa;function _(e,t){for(var r=[],n=new Uint8Array(e);n.length>0;)r.push(m.apply(null,p(n.subarray(0,8192)))),n=n.subarray(8192);return"data:".concat(t,";base64,").concat(g(r.join("")))}function b(e){var t,r=new DataView(e);try{var n,i,a;if(255===r.getUint8(0)&&216===r.getUint8(1))for(var s=r.byteLength,o=2;o+1<s;){if(255===r.getUint8(o)&&225===r.getUint8(o+1)){i=o;break}o+=1}if(i){var l=i+10;if("Exif"===function(e,t,r){var n,i="";for(r+=t,n=t;n<r;n+=1)i+=m(e.getUint8(n));return i}(r,i+4,4)){var c=r.getUint16(l);if(((n=18761===c)||19789===c)&&42===r.getUint16(l+2,n)){var d=r.getUint32(l+4,n);d>=8&&(a=l+d)}}}if(a){var u,p,h=r.getUint16(a,n);for(p=0;p<h;p+=1)if(u=a+12*p+2,274===r.getUint16(u,n)){u+=8,t=r.getUint16(u,n),r.setUint16(u,1,n);break}}}catch(e){t=1}return t}var v=/\.\d*(?:0|9){12}\d*$/;function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return v.test(e)?Math.round(e*t)/t:e}function w(e){var t=e.aspectRatio,r=e.height,n=e.width,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",a=d(n),s=d(r);if(a&&s){var o=r*t;("contain"===i||"none"===i)&&o>n||"cover"===i&&o<n?r=n/t:n=r*t}else a?r=n/t:s&&(n=r*t);return{width:n,height:r}}var E=c.ArrayBuffer,S=c.FileReader,T=c.URL||c.webkitURL,C=/\.\w+$/,x=c.Compressor,A=function(){function e(r,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.file=r,this.exif=[],this.image=new Image,this.options=t(t({},l),n),this.aborted=!1,this.result=null,this.init()}return n=e,a=[{key:"init",value:function(){var e,t=this,r=this.file,n=this.options;if(e=r,"undefined"!=typeof Blob&&(e instanceof Blob||"[object Blob]"===Object.prototype.toString.call(e))){var a=r.type;if(f(a))if(T&&S){E||(n.checkOrientation=!1,n.retainExif=!1);var s="image/jpeg"===a,o=s&&n.checkOrientation,l=s&&n.retainExif;if(!T||o||l){var c=new S;this.reader=c,c.onload=function(e){var n=e.target.result,s={},c=1;o&&(c=b(n))>1&&i(s,function(e){var t=0,r=1,n=1;switch(e){case 2:r=-1;break;case 3:t=-180;break;case 4:n=-1;break;case 5:t=90,n=-1;break;case 6:t=90;break;case 7:t=90,r=-1;break;case 8:t=-90}return{rotate:t,scaleX:r,scaleY:n}}(c)),l&&(t.exif=function(e){for(var t=p(new Uint8Array(e)),r=t.length,n=[],i=0;i+3<r;){var a=t[i],s=t[i+1];if(255===a&&218===s)break;if(255===a&&216===s)i+=2;else{var o=i+(256*t[i+2]+t[i+3])+2,l=t.slice(i,o);n.push(l),i=o}}return n.reduce((function(e,t){return 255===t[0]&&225===t[1]?e.concat(t):e}),[])}(n)),s.url=o||l?!T||c>1?_(n,a):T.createObjectURL(r):n,t.load(s)},c.onabort=function(){t.fail(new Error("Aborted to read the image with FileReader."))},c.onerror=function(){t.fail(new Error("Failed to read the image with FileReader."))},c.onloadend=function(){t.reader=null},o||l?c.readAsArrayBuffer(r):c.readAsDataURL(r)}else this.load({url:T.createObjectURL(r)})}else this.fail(new Error("The current browser does not support image compression."));else this.fail(new Error("The first argument must be an image File or Blob object."))}else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"load",value:function(e){var r=this,n=this.file,i=this.image;i.onload=function(){r.draw(t(t({},e),{},{naturalWidth:i.naturalWidth,naturalHeight:i.naturalHeight}))},i.onabort=function(){r.fail(new Error("Aborted to load the image."))},i.onerror=function(){r.fail(new Error("Failed to load the image."))},c.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(c.navigator.userAgent)&&(i.crossOrigin="anonymous"),i.alt=n.name,i.src=e.url}},{key:"draw",value:function(e){var t=this,r=e.naturalWidth,n=e.naturalHeight,i=e.rotate,a=void 0===i?0:i,s=e.scaleX,l=void 0===s?1:s,c=e.scaleY,u=void 0===c?1:c,h=this.file,m=this.image,g=this.options,b=document.createElement("canvas"),v=b.getContext("2d"),E=Math.abs(a)%180==90,T=("contain"===g.resize||"cover"===g.resize)&&d(g.width)&&d(g.height),C=Math.max(g.maxWidth,0)||1/0,x=Math.max(g.maxHeight,0)||1/0,A=Math.max(g.minWidth,0)||0,I=Math.max(g.minHeight,0)||0,D=r/n,k=g.width,L=g.height;if(E){var P=[x,C];C=P[0],x=P[1];var O=[I,A];A=O[0],I=O[1];var R=[L,k];k=R[0],L=R[1]}T&&(D=k/L);var N=w({aspectRatio:D,width:C,height:x},"contain");C=N.width,x=N.height;var B=w({aspectRatio:D,width:A,height:I},"cover");if(A=B.width,I=B.height,T){var F=w({aspectRatio:D,width:k,height:L},g.resize);k=F.width,L=F.height}else{var U=w({aspectRatio:D,width:k,height:L}),M=U.width;k=void 0===M?r:M;var q=U.height;L=void 0===q?n:q}var z=-(k=Math.floor(y(Math.min(Math.max(k,A),C))))/2,H=-(L=Math.floor(y(Math.min(Math.max(L,I),x))))/2,W=k,j=L,V=[];if(T){var $,G,X,K,Y=w({aspectRatio:D,width:r,height:n},{contain:"cover",cover:"contain"}[g.resize]);X=Y.width,K=Y.height,$=(r-X)/2,G=(n-K)/2,V.push($,G,X,K)}if(V.push(z,H,W,j),E){var Q=[L,k];k=Q[0],L=Q[1]}b.width=k,b.height=L,f(g.mimeType)||(g.mimeType=h.type);var Z="transparent";h.size>g.convertSize&&g.convertTypes.indexOf(g.mimeType)>=0&&(g.mimeType="image/jpeg");var J="image/jpeg"===g.mimeType;if(J&&(Z="#fff"),v.fillStyle=Z,v.fillRect(0,0,k,L),g.beforeDraw&&g.beforeDraw.call(this,v,b),!this.aborted&&(v.save(),v.translate(k/2,L/2),v.rotate(a*Math.PI/180),v.scale(l,u),v.drawImage.apply(v,[m].concat(V)),v.restore(),g.drew&&g.drew.call(this,v,b),!this.aborted)){var ee=function(e){if(!t.aborted){var i=function(e){return t.done({naturalWidth:r,naturalHeight:n,result:e})};if(e&&J&&g.retainExif&&t.exif&&t.exif.length>0){var a=function(e){return i(o(_(function(e,t){var r=p(new Uint8Array(e));if(255!==r[2]||224!==r[3])return e;var n=256*r[4]+r[5],i=[255,216].concat(t,r.slice(4+n));return new Uint8Array(i)}(e,t.exif),g.mimeType)))};if(e.arrayBuffer)e.arrayBuffer().then(a).catch((function(){t.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))}));else{var s=new S;t.reader=s,s.onload=function(e){var t=e.target;a(t.result)},s.onabort=function(){t.fail(new Error("Aborted to read the compressed image with FileReader."))},s.onerror=function(){t.fail(new Error("Failed to read the compressed image with FileReader."))},s.onloadend=function(){t.reader=null},s.readAsArrayBuffer(e)}}else i(e)}};b.toBlob?b.toBlob(ee,g.mimeType,g.quality):ee(o(b.toDataURL(g.mimeType,g.quality)))}}},{key:"done",value:function(e){var t,r,n=e.naturalWidth,i=e.naturalHeight,a=e.result,s=this.file,o=this.image,l=this.options;if(T&&0===o.src.indexOf("blob:")&&T.revokeObjectURL(o.src),a)if(l.strict&&!l.retainExif&&a.size>s.size&&l.mimeType===s.type&&!(l.width>n||l.height>i||l.minWidth>n||l.minHeight>i||l.maxWidth<n||l.maxHeight<i))a=s;else{var c=new Date;a.lastModified=c.getTime(),a.lastModifiedDate=c,a.name=s.name,a.name&&a.type!==s.type&&(a.name=a.name.replace(C,(t=a.type,"jpeg"===(r=f(t)?t.substr(6):"")&&(r="jpg"),".".concat(r))))}else a=s;this.result=a,l.success&&l.success.call(this,a)}},{key:"fail",value:function(e){var t=this.options;if(!t.error)throw e;t.error.call(this,e)}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],s=[{key:"noConflict",value:function(){return window.Compressor=x,e}},{key:"setDefaults",value:function(e){i(l,e)}}],a&&r(n.prototype,a),s&&r(n,s),Object.defineProperty(n,"prototype",{writable:!1}),e;var n,a,s}();return A}()},3835:e=>{e.exports=function(){var e={},t=e._fns={};return e.emit=function(e,r,n,i,a,s,o){var l=function(e){for(var r=t[e]?t[e]:[],n=e.indexOf(":"),i=-1===n?[e]:[e.substring(0,n),e.substring(n+1)],a=Object.keys(t),s=0,o=a.length;s<o;s++){var l=a[s];if("*"===l&&(r=r.concat(t[l])),2===i.length&&i[0]===l){r=r.concat(t[l]);break}}return r}(e);l.length&&function(e,t,r){for(var n=0,i=t.length;n<i&&t[n];n++)t[n].event=e,t[n].apply(t[n],r)}(e,l,[r,n,i,a,s,o])},e.on=function(e,r){t[e]||(t[e]=[]),t[e].push(r)},e.once=function(t,r){this.on(t,(function n(){r.apply(this,arguments),e.off(t,n)}))},e.off=function(e,t){var r=[];if(e&&t)for(var n=this._fns[e],i=0,a=n?n.length:0;i<a;i++)n[i]!==t&&r.push(n[i]);r.length?this._fns[e]=r:delete this._fns[e]},e}},4043:(e,t,r)=>{!function(e){e.parser=function(e,t){return new i(e,t)},e.SAXParser=i,e.SAXStream=s,e.createStream=function(e,t){return new s(e,t)},e.MAX_BUFFER_LENGTH=65536;var t,n=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function i(t,r){if(!(this instanceof i))return new i(t,r);var a=this;!function(e){for(var t=0,r=n.length;t<r;t++)e[n[t]]=""}(a),a.q=a.c="",a.bufferCheckPosition=e.MAX_BUFFER_LENGTH,a.opt=r||{},a.opt.lowercase=a.opt.lowercase||a.opt.lowercasetags,a.looseCase=a.opt.lowercase?"toLowerCase":"toUpperCase",a.tags=[],a.closed=a.closedRoot=a.sawRoot=!1,a.tag=a.error=null,a.strict=!!t,a.noscript=!(!t&&!a.opt.noscript),a.state=T.BEGIN,a.strictEntities=a.opt.strictEntities,a.ENTITIES=a.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),a.attribList=[],a.opt.xmlns&&(a.ns=Object.create(u)),void 0===a.opt.unquotedAttributeValues&&(a.opt.unquotedAttributeValues=!t),a.trackPosition=!1!==a.opt.position,a.trackPosition&&(a.position=a.line=a.column=0),x(a,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}),i.prototype={end:function(){L(this)},write:function(t){var r=this;if(this.error)throw this.error;if(r.closed)return k(r,"Cannot write after close. Assign an onready handler.");if(null===t)return L(r);"object"==typeof t&&(t=t.toString());for(var i=0,a="";a=q(t,i++),r.c=a,a;)switch(r.trackPosition&&(r.position++,"\n"===a?(r.line++,r.column=0):r.column++),r.state){case T.BEGIN:if(r.state=T.BEGIN_WHITESPACE,"\ufeff"===a)continue;M(r,a);continue;case T.BEGIN_WHITESPACE:M(r,a);continue;case T.TEXT:if(r.sawRoot&&!r.closedRoot){for(var s=i-1;a&&"<"!==a&&"&"!==a;)(a=q(t,i++))&&r.trackPosition&&(r.position++,"\n"===a?(r.line++,r.column=0):r.column++);r.textNode+=t.substring(s,i-1)}"<"!==a||r.sawRoot&&r.closedRoot&&!r.strict?(g(a)||r.sawRoot&&!r.closedRoot||P(r,"Text data outside of root node."),"&"===a?r.state=T.TEXT_ENTITY:r.textNode+=a):(r.state=T.OPEN_WAKA,r.startTagPosition=r.position);continue;case T.SCRIPT:"<"===a?r.state=T.SCRIPT_ENDING:r.script+=a;continue;case T.SCRIPT_ENDING:"/"===a?r.state=T.CLOSE_TAG:(r.script+="<"+a,r.state=T.SCRIPT);continue;case T.OPEN_WAKA:if("!"===a)r.state=T.SGML_DECL,r.sgmlDecl="";else if(g(a));else if(v(p,a))r.state=T.OPEN_TAG,r.tagName=a;else if("/"===a)r.state=T.CLOSE_TAG,r.tagName="";else if("?"===a)r.state=T.PROC_INST,r.procInstName=r.procInstBody="";else{if(P(r,"Unencoded <"),r.startTagPosition+1<r.position){var c=r.position-r.startTagPosition;a=new Array(c).join(" ")+a}r.textNode+="<"+a,r.state=T.TEXT}continue;case T.SGML_DECL:if(r.sgmlDecl+a==="--"){r.state=T.COMMENT,r.comment="",r.sgmlDecl="";continue}r.doctype&&!0!==r.doctype&&r.sgmlDecl?(r.state=T.DOCTYPE_DTD,r.doctype+="<!"+r.sgmlDecl+a,r.sgmlDecl=""):(r.sgmlDecl+a).toUpperCase()===o?(A(r,"onopencdata"),r.state=T.CDATA,r.sgmlDecl="",r.cdata=""):(r.sgmlDecl+a).toUpperCase()===l?(r.state=T.DOCTYPE,(r.doctype||r.sawRoot)&&P(r,"Inappropriately located doctype declaration"),r.doctype="",r.sgmlDecl=""):">"===a?(A(r,"onsgmldeclaration",r.sgmlDecl),r.sgmlDecl="",r.state=T.TEXT):_(a)?(r.state=T.SGML_DECL_QUOTED,r.sgmlDecl+=a):r.sgmlDecl+=a;continue;case T.SGML_DECL_QUOTED:a===r.q&&(r.state=T.SGML_DECL,r.q=""),r.sgmlDecl+=a;continue;case T.DOCTYPE:">"===a?(r.state=T.TEXT,A(r,"ondoctype",r.doctype),r.doctype=!0):(r.doctype+=a,"["===a?r.state=T.DOCTYPE_DTD:_(a)&&(r.state=T.DOCTYPE_QUOTED,r.q=a));continue;case T.DOCTYPE_QUOTED:r.doctype+=a,a===r.q&&(r.q="",r.state=T.DOCTYPE);continue;case T.DOCTYPE_DTD:"]"===a?(r.doctype+=a,r.state=T.DOCTYPE):"<"===a?(r.state=T.OPEN_WAKA,r.startTagPosition=r.position):_(a)?(r.doctype+=a,r.state=T.DOCTYPE_DTD_QUOTED,r.q=a):r.doctype+=a;continue;case T.DOCTYPE_DTD_QUOTED:r.doctype+=a,a===r.q&&(r.state=T.DOCTYPE_DTD,r.q="");continue;case T.COMMENT:"-"===a?r.state=T.COMMENT_ENDING:r.comment+=a;continue;case T.COMMENT_ENDING:"-"===a?(r.state=T.COMMENT_ENDED,r.comment=D(r.opt,r.comment),r.comment&&A(r,"oncomment",r.comment),r.comment=""):(r.comment+="-"+a,r.state=T.COMMENT);continue;case T.COMMENT_ENDED:">"!==a?(P(r,"Malformed comment"),r.comment+="--"+a,r.state=T.COMMENT):r.doctype&&!0!==r.doctype?r.state=T.DOCTYPE_DTD:r.state=T.TEXT;continue;case T.CDATA:"]"===a?r.state=T.CDATA_ENDING:r.cdata+=a;continue;case T.CDATA_ENDING:"]"===a?r.state=T.CDATA_ENDING_2:(r.cdata+="]"+a,r.state=T.CDATA);continue;case T.CDATA_ENDING_2:">"===a?(r.cdata&&A(r,"oncdata",r.cdata),A(r,"onclosecdata"),r.cdata="",r.state=T.TEXT):"]"===a?r.cdata+="]":(r.cdata+="]]"+a,r.state=T.CDATA);continue;case T.PROC_INST:"?"===a?r.state=T.PROC_INST_ENDING:g(a)?r.state=T.PROC_INST_BODY:r.procInstName+=a;continue;case T.PROC_INST_BODY:if(!r.procInstBody&&g(a))continue;"?"===a?r.state=T.PROC_INST_ENDING:r.procInstBody+=a;continue;case T.PROC_INST_ENDING:">"===a?(A(r,"onprocessinginstruction",{name:r.procInstName,body:r.procInstBody}),r.procInstName=r.procInstBody="",r.state=T.TEXT):(r.procInstBody+="?"+a,r.state=T.PROC_INST_BODY);continue;case T.OPEN_TAG:v(h,a)?r.tagName+=a:(O(r),">"===a?B(r):"/"===a?r.state=T.OPEN_TAG_SLASH:(g(a)||P(r,"Invalid character in tag name"),r.state=T.ATTRIB));continue;case T.OPEN_TAG_SLASH:">"===a?(B(r,!0),F(r)):(P(r,"Forward-slash in opening tag not followed by >"),r.state=T.ATTRIB);continue;case T.ATTRIB:if(g(a))continue;">"===a?B(r):"/"===a?r.state=T.OPEN_TAG_SLASH:v(p,a)?(r.attribName=a,r.attribValue="",r.state=T.ATTRIB_NAME):P(r,"Invalid attribute name");continue;case T.ATTRIB_NAME:"="===a?r.state=T.ATTRIB_VALUE:">"===a?(P(r,"Attribute without value"),r.attribValue=r.attribName,N(r),B(r)):g(a)?r.state=T.ATTRIB_NAME_SAW_WHITE:v(h,a)?r.attribName+=a:P(r,"Invalid attribute name");continue;case T.ATTRIB_NAME_SAW_WHITE:if("="===a)r.state=T.ATTRIB_VALUE;else{if(g(a))continue;P(r,"Attribute without value"),r.tag.attributes[r.attribName]="",r.attribValue="",A(r,"onattribute",{name:r.attribName,value:""}),r.attribName="",">"===a?B(r):v(p,a)?(r.attribName=a,r.state=T.ATTRIB_NAME):(P(r,"Invalid attribute name"),r.state=T.ATTRIB)}continue;case T.ATTRIB_VALUE:if(g(a))continue;_(a)?(r.q=a,r.state=T.ATTRIB_VALUE_QUOTED):(r.opt.unquotedAttributeValues||k(r,"Unquoted attribute value"),r.state=T.ATTRIB_VALUE_UNQUOTED,r.attribValue=a);continue;case T.ATTRIB_VALUE_QUOTED:if(a!==r.q){"&"===a?r.state=T.ATTRIB_VALUE_ENTITY_Q:r.attribValue+=a;continue}N(r),r.q="",r.state=T.ATTRIB_VALUE_CLOSED;continue;case T.ATTRIB_VALUE_CLOSED:g(a)?r.state=T.ATTRIB:">"===a?B(r):"/"===a?r.state=T.OPEN_TAG_SLASH:v(p,a)?(P(r,"No whitespace between attributes"),r.attribName=a,r.attribValue="",r.state=T.ATTRIB_NAME):P(r,"Invalid attribute name");continue;case T.ATTRIB_VALUE_UNQUOTED:if(!b(a)){"&"===a?r.state=T.ATTRIB_VALUE_ENTITY_U:r.attribValue+=a;continue}N(r),">"===a?B(r):r.state=T.ATTRIB;continue;case T.CLOSE_TAG:if(r.tagName)">"===a?F(r):v(h,a)?r.tagName+=a:r.script?(r.script+="</"+r.tagName,r.tagName="",r.state=T.SCRIPT):(g(a)||P(r,"Invalid tagname in closing tag"),r.state=T.CLOSE_TAG_SAW_WHITE);else{if(g(a))continue;y(p,a)?r.script?(r.script+="</"+a,r.state=T.SCRIPT):P(r,"Invalid tagname in closing tag."):r.tagName=a}continue;case T.CLOSE_TAG_SAW_WHITE:if(g(a))continue;">"===a?F(r):P(r,"Invalid characters in closing tag");continue;case T.TEXT_ENTITY:case T.ATTRIB_VALUE_ENTITY_Q:case T.ATTRIB_VALUE_ENTITY_U:var d,u;switch(r.state){case T.TEXT_ENTITY:d=T.TEXT,u="textNode";break;case T.ATTRIB_VALUE_ENTITY_Q:d=T.ATTRIB_VALUE_QUOTED,u="attribValue";break;case T.ATTRIB_VALUE_ENTITY_U:d=T.ATTRIB_VALUE_UNQUOTED,u="attribValue"}if(";"===a){var w=U(r);r.opt.unparsedEntities&&!Object.values(e.XML_ENTITIES).includes(w)?(r.entity="",r.state=d,r.write(w)):(r[u]+=w,r.entity="",r.state=d)}else v(r.entity.length?m:f,a)?r.entity+=a:(P(r,"Invalid character in entity name"),r[u]+="&"+r.entity+a,r.entity="",r.state=d);continue;default:throw new Error(r,"Unknown state: "+r.state)}return r.position>=r.bufferCheckPosition&&function(t){for(var r=Math.max(e.MAX_BUFFER_LENGTH,10),i=0,a=0,s=n.length;a<s;a++){var o=t[n[a]].length;if(o>r)switch(n[a]){case"textNode":I(t);break;case"cdata":A(t,"oncdata",t.cdata),t.cdata="";break;case"script":A(t,"onscript",t.script),t.script="";break;default:k(t,"Max buffer length exceeded: "+n[a])}i=Math.max(i,o)}var l=e.MAX_BUFFER_LENGTH-i;t.bufferCheckPosition=l+t.position}(r),r},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;I(e=this),""!==e.cdata&&(A(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(A(e,"onscript",e.script),e.script="")}};try{t=r(4789).Stream}catch(e){t=function(){}}t||(t=function(){});var a=e.EVENTS.filter((function(e){return"error"!==e&&"end"!==e}));function s(e,r){if(!(this instanceof s))return new s(e,r);t.apply(this),this._parser=new i(e,r),this.writable=!0,this.readable=!0;var n=this;this._parser.onend=function(){n.emit("end")},this._parser.onerror=function(e){n.emit("error",e),n._parser.error=null},this._decoder=null,a.forEach((function(e){Object.defineProperty(n,"on"+e,{get:function(){return n._parser["on"+e]},set:function(t){if(!t)return n.removeAllListeners(e),n._parser["on"+e]=t,t;n.on(e,t)},enumerable:!0,configurable:!1})}))}s.prototype=Object.create(t.prototype,{constructor:{value:s}}),s.prototype.write=function(e){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(e)){if(!this._decoder){var t=r(3141).I;this._decoder=new t("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},s.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},s.prototype.on=function(e,r){var n=this;return n._parser["on"+e]||-1===a.indexOf(e)||(n._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),n.emit.apply(n,t)}),t.prototype.on.call(n,e,r)};var o="[CDATA[",l="DOCTYPE",c="http://www.w3.org/XML/1998/namespace",d="http://www.w3.org/2000/xmlns/",u={xml:c,xmlns:d},p=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,h=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,f=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function g(e){return" "===e||"\n"===e||"\r"===e||"\t"===e}function _(e){return'"'===e||"'"===e}function b(e){return">"===e||g(e)}function v(e,t){return e.test(t)}function y(e,t){return!v(e,t)}var w,E,S,T=0;for(var C in e.STATE={BEGIN:T++,BEGIN_WHITESPACE:T++,TEXT:T++,TEXT_ENTITY:T++,OPEN_WAKA:T++,SGML_DECL:T++,SGML_DECL_QUOTED:T++,DOCTYPE:T++,DOCTYPE_QUOTED:T++,DOCTYPE_DTD:T++,DOCTYPE_DTD_QUOTED:T++,COMMENT_STARTING:T++,COMMENT:T++,COMMENT_ENDING:T++,COMMENT_ENDED:T++,CDATA:T++,CDATA_ENDING:T++,CDATA_ENDING_2:T++,PROC_INST:T++,PROC_INST_BODY:T++,PROC_INST_ENDING:T++,OPEN_TAG:T++,OPEN_TAG_SLASH:T++,ATTRIB:T++,ATTRIB_NAME:T++,ATTRIB_NAME_SAW_WHITE:T++,ATTRIB_VALUE:T++,ATTRIB_VALUE_QUOTED:T++,ATTRIB_VALUE_CLOSED:T++,ATTRIB_VALUE_UNQUOTED:T++,ATTRIB_VALUE_ENTITY_Q:T++,ATTRIB_VALUE_ENTITY_U:T++,CLOSE_TAG:T++,CLOSE_TAG_SAW_WHITE:T++,SCRIPT:T++,SCRIPT_ENDING:T++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach((function(t){var r=e.ENTITIES[t],n="number"==typeof r?String.fromCharCode(r):r;e.ENTITIES[t]=n})),e.STATE)e.STATE[e.STATE[C]]=C;function x(e,t,r){e[t]&&e[t](r)}function A(e,t,r){e.textNode&&I(e),x(e,t,r)}function I(e){e.textNode=D(e.opt,e.textNode),e.textNode&&x(e,"ontext",e.textNode),e.textNode=""}function D(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function k(e,t){return I(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,x(e,"onerror",t),e}function L(e){return e.sawRoot&&!e.closedRoot&&P(e,"Unclosed root tag"),e.state!==T.BEGIN&&e.state!==T.BEGIN_WHITESPACE&&e.state!==T.TEXT&&k(e,"Unexpected end"),I(e),e.c="",e.closed=!0,x(e,"onend"),i.call(e,e.strict,e.opt),e}function P(e,t){if("object"!=typeof e||!(e instanceof i))throw new Error("bad call to strictFail");e.strict&&k(e,t)}function O(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,r=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(r.ns=t.ns),e.attribList.length=0,A(e,"onopentagstart",r)}function R(e,t){var r=e.indexOf(":")<0?["",e]:e.split(":"),n=r[0],i=r[1];return t&&"xmlns"===e&&(n="xmlns",i=""),{prefix:n,local:i}}function N(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=R(e.attribName,!0),r=t.prefix,n=t.local;if("xmlns"===r)if("xml"===n&&e.attribValue!==c)P(e,"xml: prefix must be bound to "+c+"\nActual: "+e.attribValue);else if("xmlns"===n&&e.attribValue!==d)P(e,"xmlns: prefix must be bound to "+d+"\nActual: "+e.attribValue);else{var i=e.tag,a=e.tags[e.tags.length-1]||e;i.ns===a.ns&&(i.ns=Object.create(a.ns)),i.ns[n]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,A(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function B(e,t){if(e.opt.xmlns){var r=e.tag,n=R(e.tagName);r.prefix=n.prefix,r.local=n.local,r.uri=r.ns[n.prefix]||"",r.prefix&&!r.uri&&(P(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),r.uri=n.prefix);var i=e.tags[e.tags.length-1]||e;r.ns&&i.ns!==r.ns&&Object.keys(r.ns).forEach((function(t){A(e,"onopennamespace",{prefix:t,uri:r.ns[t]})}));for(var a=0,s=e.attribList.length;a<s;a++){var o=e.attribList[a],l=o[0],c=o[1],d=R(l,!0),u=d.prefix,p=d.local,h=""===u?"":r.ns[u]||"",f={name:l,value:c,prefix:u,local:p,uri:h};u&&"xmlns"!==u&&!h&&(P(e,"Unbound namespace prefix: "+JSON.stringify(u)),f.uri=u),e.tag.attributes[l]=f,A(e,"onattribute",f)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),A(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=T.TEXT:e.state=T.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function F(e){if(!e.tagName)return P(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=T.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=T.SCRIPT);A(e,"onscript",e.script),e.script=""}var t=e.tags.length,r=e.tagName;e.strict||(r=r[e.looseCase]());for(var n=r;t--&&e.tags[t].name!==n;)P(e,"Unexpected close tag");if(t<0)return P(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=T.TEXT);e.tagName=r;for(var i=e.tags.length;i-- >t;){var a=e.tag=e.tags.pop();e.tagName=e.tag.name,A(e,"onclosetag",e.tagName);var s={};for(var o in a.ns)s[o]=a.ns[o];var l=e.tags[e.tags.length-1]||e;e.opt.xmlns&&a.ns!==l.ns&&Object.keys(a.ns).forEach((function(t){var r=a.ns[t];A(e,"onclosenamespace",{prefix:t,uri:r})}))}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=T.TEXT}function U(e){var t,r=e.entity,n=r.toLowerCase(),i="";return e.ENTITIES[r]?e.ENTITIES[r]:e.ENTITIES[n]?e.ENTITIES[n]:("#"===(r=n).charAt(0)&&("x"===r.charAt(1)?(r=r.slice(2),i=(t=parseInt(r,16)).toString(16)):(r=r.slice(1),i=(t=parseInt(r,10)).toString(10))),r=r.replace(/^0+/,""),isNaN(t)||i.toLowerCase()!==r?(P(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function M(e,t){"<"===t?(e.state=T.OPEN_WAKA,e.startTagPosition=e.position):g(t)||(P(e,"Non-whitespace before first tag."),e.textNode=t,e.state=T.TEXT)}function q(e,t){var r="";return t<e.length&&(r=e.charAt(t)),r}T=e.STATE,String.fromCodePoint||(w=String.fromCharCode,E=Math.floor,S=function(){var e,t,r=[],n=-1,i=arguments.length;if(!i)return"";for(var a="";++n<i;){var s=Number(arguments[n]);if(!isFinite(s)||s<0||s>1114111||E(s)!==s)throw RangeError("Invalid code point: "+s);s<=65535?r.push(s):(e=55296+((s-=65536)>>10),t=s%1024+56320,r.push(e,t)),(n+1===i||r.length>16384)&&(a+=w.apply(null,r),r.length=0)}return a},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:S,configurable:!0,writable:!0}):String.fromCodePoint=S)}(t)},4107:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA3NCSVQICAjb4U/gAAAABlBMVEXMzMz////TjRV2AAAACXBIWXMAAArrAAAK6wGCiw1aAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABFJREFUCJlj+M/AgBVhF/0PAH6/D/HkDxOGAAAAAElFTkSuQmCC"},4128:(e,t,r)=>{var n=r(1800),i=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(i,""):e}},4394:(e,t,r)=>{var n=r(2552),i=r(346);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==n(e)}},4417:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},4598:(e,t,r)=>{var n=r(6690),i=r(6907),a=r(908),s=r(3145);e.exports={xml2js:n,xml2json:i,js2xml:a,json2xml:s}},4730:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{class GenericElementUtils{static hideElements(...e){e.forEach((e=>e.style.display="none"))}static getStyleWidth(e,t){return Number.parseFloat(e.style[t])||0}static doesElementExistInDom(e){return!!e.parentElement}static isFirstChildInParent(e){var t;return(null==(t=e.parentElement)?void 0:t.firstChild)===e}}GenericElementUtils.NOT_SELECTABLE_CLASS="not-selectable";class SVGIconUtils{static createSVGElement(e){return(new DOMParser).parseFromString(e,"image/svg+xml").documentElement}}SVGIconUtils.WHITE_FILTER="brightness(0) saturate(100%) invert(100%) sepia(1%) saturate(3877%)\n    hue-rotate(184deg) brightness(103%) contrast(100%)",SVGIconUtils.LIGHT_GREY_FILTER="brightness(0) saturate(100%) invert(68%) sepia(0%) saturate(317%)\n    hue-rotate(84deg) brightness(92%) contrast(93%)",SVGIconUtils.HEADER_FILTER="brightness(0) saturate(100%) invert(34%) sepia(0%) saturate(1075%)\n    hue-rotate(211deg) brightness(96%) contrast(90%)",SVGIconUtils.DROPDOWN_ITEM_FILTER="brightness(0) saturate(100%) invert(7%) sepia(23%) saturate(258%)\n    hue-rotate(63deg) brightness(99%) contrast(97%)";class StaticDropdown{}StaticDropdown.DROPDOWN_CLASS="static-dropdown",StaticDropdown.ITEM_CLASS="static-dropdown-item",StaticDropdown.ACTIVE_ITEM_CLASS="active-static-dropdown-item";const _DropdownItemHighlightUtils=class e{static fadeCurrentlyHighlighted(e){const t=e.dropdownItem;t&&(t.classList.contains(StaticDropdown.ACTIVE_ITEM_CLASS)&&t.classList.remove(StaticDropdown.ACTIVE_ITEM_CLASS),t.style.backgroundColor="",delete e.dropdownItem)}static highlightNew(t,r){e.fadeCurrentlyHighlighted(t),r.focus(),t.dropdownItem=r,r.classList.contains(StaticDropdown.ITEM_CLASS)?r.classList.add(StaticDropdown.ACTIVE_ITEM_CLASS):r.classList.contains(DropdownItem.DROPDOWN_INPUT_CLASS)||(r.style.backgroundColor=e.HOVER_BACKGROUND_COLOR)}};_DropdownItemHighlightUtils.HOVER_BACKGROUND_COLOR="#eaeaea";let DropdownItemHighlightUtils=_DropdownItemHighlightUtils;class DropdownItemEvents{static addItemEvents(e,t){t.addEventListener("mouseenter",DropdownItemHighlightUtils.highlightNew.bind(this,e,t)),t.addEventListener("mouseleave",DropdownItemHighlightUtils.fadeCurrentlyHighlighted.bind(this,e))}}const _DropdownItem=class e{static toggleItem(t,r){t.style.display=r?e.DISPLAY:e.HIDDEN}static isDisplayed(t){return t.style.display===e.DISPLAY}static createDropdownItemBaseElement(t){const r=document.createElement(t);return r.classList.add(e.DROPDOWN_ITEM_IDENTIFIER),r}static createItem(t){const r=e.createDropdownItemBaseElement("div");return t&&(r.tabIndex=t.children.length),r.classList.add(e.DROPDOWN_ITEM_CLASS,GenericElementUtils.NOT_SELECTABLE_CLASS),r}static addInputItem(t,r){const n=e.createItem(r);n.classList.add(e.DROPDOWN_INPUT_ITEM_CLASS);const i=e.createDropdownItemBaseElement("input");i.classList.add(e.DROPDOWN_INPUT_CLASS),n.appendChild(i),r.appendChild(n),DropdownItemEvents.addItemEvents(t._activeOverlayElements,i)}static insertIcon(t,r){const{svgString:n,containerStyles:i}=r,a=document.createElement("div");a.classList.add(e.DROPDOWN_ITEM_ICON_CONTAINER_CLASS),Object.assign(a.style,null==i?void 0:i.dropdown);const s=SVGIconUtils.createSVGElement(n);s.style.filter=SVGIconUtils.DROPDOWN_ITEM_FILTER,a.appendChild(s),t.insertBefore(a,t.children[0])}static addPlaneButtonItem(t,r,n){const i=e.createItem(t),a=e.createDropdownItemBaseElement("div");return a.innerText=r||e.DROPDOWN_ITEM_EMPTY_PLACEHOLDER_TEXT,""===r.trim()&&a.classList.add(e.DROPDOWN_ITEM_EMPTY_CLASS),i.append(a),t&&(void 0!==n&&t.children[n]?t.insertBefore(i,t.children[n]):t.appendChild(i)),i}static createButtonItemNoEvents(t,r,...n){const i=e.addPlaneButtonItem(t,r.text);return r.iconSettings&&e.insertIcon(i,r.iconSettings),n.length>0&&i.classList.add(...n),i}static addTitle(t,r){const n=e.createDropdownItemBaseElement("div");n.classList.add(e.DROPDOWN_ITEM_CLASS,e.DROPDOWN_TITLE_ITEM_CLASS),n.innerText=r,t.appendChild(n)}static addDivider(t){const r=e.createDropdownItemBaseElement("div");r.classList.add(e.DROPDOWN_ITEM_DIVIDER_CLASS),t.appendChild(r)}static addButtonItem(t,r,n,...i){const a=e.createButtonItemNoEvents(r,n,...i);return DropdownItemEvents.addItemEvents(t._activeOverlayElements,a),a}static addNewButtonItems(t,r,n){return n.map((n=>e.addButtonItem(t,r,n)))}static addButtonItemElements(e,t,r){r.forEach((r=>{r.tabIndex=t.children.length,t.appendChild(r),DropdownItemEvents.addItemEvents(e._activeOverlayElements,r)}))}static removeItems(e){Array.from(e.children).forEach((e=>e.remove()))}static doesElementContainItemClass(t){return t.classList.contains(e.DROPDOWN_ITEM_IDENTIFIER)}static doesElementContainInputClass(t){return t.classList.contains(e.DROPDOWN_INPUT_CLASS)}static getInputElement(t){return t.getElementsByClassName(e.DROPDOWN_INPUT_ITEM_CLASS)[0]}static toggleUsability(t,r){const n=t.children[0];r?(t.classList.remove(e.DISABLED_ITEM_CLASS),n.style.filter=""):(t.classList.add(e.DISABLED_ITEM_CLASS),n.style.filter=SVGIconUtils.LIGHT_GREY_FILTER)}};_DropdownItem.DROPDOWN_ITEM_CLASS="dropdown-item",_DropdownItem.DISABLED_ITEM_CLASS="dropdown-disabled-item",_DropdownItem.ACTIVE_ITEM_CLASS="active-dropdown-item",_DropdownItem.DROPDOWN_INPUT_CLASS="dropdown-input",_DropdownItem.DROPDOWN_ITEM_ICON_CONTAINER_CLASS="dropdown-item-icon-container",_DropdownItem.DROPDOWN_INPUT_ITEM_CLASS="dropdown-input-item",_DropdownItem.DROPDOWN_TITLE_ITEM_CLASS="dropdown-title-item",_DropdownItem.DROPDOWN_ITEM_DIVIDER_CLASS="dropdown-item-divider",_DropdownItem.DROPDOWN_ITEM_EMPTY_CLASS="dropdown-item-empty",_DropdownItem.DROPDOWN_ITEM_EMPTY_PLACEHOLDER_TEXT="...",_DropdownItem.DROPDOWN_ITEM_IDENTIFIER="dropdown-item-identifier",_DropdownItem.HIDDEN="none",_DropdownItem.DISPLAY="";let DropdownItem=_DropdownItem;class OuterDropdownItem{static unsetHoverColors(e){e.forEach((e=>e.style.backgroundColor=""))}static unsetActiveItem(e){const t=e.getElementsByClassName(DropdownItem.ACTIVE_ITEM_CLASS)[0];null==t||t.classList.remove(DropdownItem.ACTIVE_ITEM_CLASS)}static setActive(e,t){const r=e.find((e=>e.innerText===t));null==r||r.classList.add(DropdownItem.ACTIVE_ITEM_CLASS)}static setActiveByIndex(e,t){e[t].classList.add(DropdownItem.ACTIVE_ITEM_CLASS)}}class ElementStyle{static setStyle(e,t,r){e.style[t]=r}static moveStyles(e,t,...r){r.forEach((r=>{e.style[r]&&ElementStyle.setStyle(t,r,e.style[r])}))}static unsetStyle(e,t){const r=Object.keys(t).reduce(((e,t)=>(e[t]="",e)),{});Object.assign(e.style,r)}static unsetAllCSSStates(e,t){t.click&&ElementStyle.unsetStyle(e,t.click),t.hover&&ElementStyle.unsetStyle(e,t.hover),t.default&&ElementStyle.unsetStyle(e,t.default)}static generateStatefulCSS(e,t,r){const n=e.default||{},i=Object.assign(JSON.parse(JSON.stringify({...n,...t})),null==e?void 0:e.hover);return{default:n,hover:i,click:Object.assign(JSON.parse(JSON.stringify({...i,...r})),null==e?void 0:e.click)}}}const _ToggleableElement=class e{static set(t,r){t.classList.add(e.ACTIVE_BUTTON_CLASS),Object.assign(t.style,r)}static unset(t,r){t.classList.remove(e.ACTIVE_BUTTON_CLASS),ElementStyle.unsetStyle(t,r)}static toggleActive(t,r){const n=!!t.classList.contains(e.ACTIVE_BUTTON_CLASS);return n?(e.unset(t,r),t.dispatchEvent(new MouseEvent("mouseenter"))):e.set(t,r),n}static unsetActive(t,r){t.classList.contains(e.ACTIVE_BUTTON_CLASS)&&(e.unset(t,r),t.dispatchEvent(new MouseEvent("mouseleave")))}static setActive(t,r){t.classList.contains(e.ACTIVE_BUTTON_CLASS)||e.set(t,r)}};_ToggleableElement.ACTIVE_BUTTON_CLASS="toggleable-button-active",_ToggleableElement.AUTO_STYLING_CLASS="toggleable-button-auto-styling";let ToggleableElement=_ToggleableElement;const _Dropdown=class e{static createBase(){const t=document.createElement("div");return t.classList.add(e.DROPDOWN_CLASS),t.style.width=`${e.DROPDOWN_WIDTH}px`,t.style.paddingTop=e.DROPDOWN_VERTICAL_PX,t.style.paddingBottom=e.DROPDOWN_VERTICAL_PX,e.hide(t),t}static isDisplayed(t){return(null==t?void 0:t.style.display)===e.CSS_DISPLAY_VISIBLE}static display(...t){t.forEach((t=>{t.style.display=e.CSS_DISPLAY_VISIBLE}))}static hide(...e){GenericElementUtils.hideElements(...e)}static isPartOfDropdownElement(t){return t.classList.contains(e.DROPDOWN_CLASS)||DropdownItem.doesElementContainItemClass(t)}};_Dropdown.DROPDOWN_CLASS="active-table-dropdown",_Dropdown.CSS_DISPLAY_VISIBLE="grid",_Dropdown.DROPDOWN_WIDTH=176,_Dropdown.DROPDOWN_VERTICAL_PX="4px";let Dropdown=_Dropdown;const _OuterDropdownButtonEvents=class e{static mouseClickButton(t,r,n){const{element:i}=r;i.classList.contains(e.DO_NOT_DISPLAY_DROPDOWN_CLASS)?i.classList.remove(e.DO_NOT_DISPLAY_DROPDOWN_CLASS):n(t,r)}static mouseDownButton(t){const{element:r,button:n,activeButtonStyle:i}=t;Dropdown.isDisplayed(r)&&(r.classList.add(e.DO_NOT_DISPLAY_DROPDOWN_CLASS),ToggleableElement.unsetActive(n,i))}static getDisplayFunc(e){return e.startsWith("top")?OuterDropdownElement.display:OuterDropdownElement.displayReactToBottomVisibility}static set(t,r,n,i,a){const s=a||e.getDisplayFunc(n);r.addEventListener("mousedown",e.mouseDownButton.bind(this,i)),r.addEventListener("click",e.mouseClickButton.bind(this,t,i,s))}};_OuterDropdownButtonEvents.DO_NOT_DISPLAY_DROPDOWN_CLASS="do-not-display-class";let OuterDropdownButtonEvents=_OuterDropdownButtonEvents;const VH="vh",VW="vw";class LITElementTypeConverters{static convertToBoolean(e){return"string"==typeof e?"true"===e:!!e}static convertToFunction(value){if("function"==typeof value)return value;if("string"==typeof value){const evaluatedExpression=eval(value);if("function"==typeof evaluatedExpression)return evaluatedExpression}return()=>{}}}class ObjectUtils{static createTwoWayObject(e){return Object.keys(e).forEach((t=>{e[e[t]]=t})),e}static convertStringToFunction(e,t){"string"==typeof e[t]&&(e[t]=LITElementTypeConverters.convertToFunction(e[t]))}static areValuesFullyDefined(...e){return-1===e.findIndex((e=>null==e))}static removeProperties(e,...t){t.forEach((t=>{delete e[t]}))}}class RegexUtils{static extractIntegerStrs(e){return e.match(/\d+/g)}static extractFloatStrs(e){return e.match(/-?\d+(\.\d+)?$/g)}}class StringDimensionUtils{static processDimension(e,t){return e<t?t:e}static processPercentageDimension(e,t,r,n){t>100&&(t=100);const i=(r?e.getBoundingClientRect().width:e.offsetHeight)*(t/100);return{number:StringDimensionUtils.processDimension(i,n),isPercentage:!0}}static generateNumberDimensionFromClientString(e,t,r,n,i=0){const a=t[r],s="string"==typeof a;let o=s?Number(RegexUtils.extractIntegerStrs(a)[0]):a;if(s){if(a.includes("%"))return StringDimensionUtils.processPercentageDimension(e,o,n,i);a.includes(VH)?o=window.innerHeight*(o/100):a.includes(VW)&&(o=window.innerWidth*(o/100))}return{number:StringDimensionUtils.processDimension(o,i),isPercentage:!1}}static removeAllDimensions(e){if(e)return ObjectUtils.removeProperties(e,"width","minWidth","maxWidth","height","minHeight","maxHeight"),e}}class PageButtonStyle{static unsetAllCSSStates(e,t,r){ElementStyle.unsetAllCSSStates(e,t[r])}static unsetAll(e,t,r){e.classList.contains(t.activeButtonClass)?PageButtonStyle.unsetAllCSSStates(e,t,"activeButton"):e.classList.contains(PageButtonElement.DISABLED_PAGINATION_BUTTON_CLASS)?ElementStyle.unsetStyle(e,t.disabledButtons):PageButtonStyle.unsetAllCSSStates(e,t,r?"actionButtons":"buttons")}static setDefault(e,t,r){PageButtonStyle.unsetAll(e,t,r),r?Object.assign(e.style,t.actionButtons.default):Object.assign(e.style,t.buttons.default)}static setActive(e,t,r){r&&(PageButtonStyle.unsetAllCSSStates(r,t,"activeButton"),Object.assign(r.style,t.buttons.default)),e.classList.contains(PageButtonElement.DISABLED_PAGINATION_BUTTON_CLASS)?ElementStyle.unsetStyle(e,t.disabledButtons):PageButtonStyle.unsetAllCSSStates(e,t,"buttons"),Object.assign(e.style,t.activeButton.default)}static setDisabled(e,t,r){PageButtonStyle.setDefault(e,t,r),Object.assign(e.style,t.disabledButtons)}static mouseDown(e,t,r){e.classList.contains(t.activeButtonClass)?Object.assign(e.style,t.activeButton.click):r?Object.assign(e.style,t.actionButtons.click):Object.assign(e.style,t.buttons.click),PaginationVisibleButtonsUtils.overrideOnMouseEvent(e,t)}static mouseEnter(e,t,r){e.classList.contains(PageButtonElement.DISABLED_PAGINATION_BUTTON_CLASS)||(e.classList.contains(t.activeButtonClass)?(PageButtonStyle.unsetAllCSSStates(e,t,"activeButton"),Object.assign(e.style,t.activeButton.default),Object.assign(e.style,t.activeButton.hover)):(PageButtonStyle.setDefault(e,t,r),r?Object.assign(e.style,t.actionButtons.hover):Object.assign(e.style,t.buttons.hover)),PaginationVisibleButtonsUtils.overrideOnMouseEvent(e,t))}static mouseLeave(e,t,r){e.classList.contains(PageButtonElement.DISABLED_PAGINATION_BUTTON_CLASS)||(e.classList.contains(t.activeButtonClass)?(PageButtonStyle.unsetAll(e,t,!1),Object.assign(e.style,t.activeButton.default)):PageButtonStyle.setDefault(e,t,r),PaginationVisibleButtonsUtils.overrideOnMouseEvent(e,t))}}const _FilterInputElement=class e{static setPlaceholder(t,r,n){if(r&&""!==r){const i=n||e.DEFAULT_PLACEHOLDER_TEMPLATE;t.placeholder=i.replace(e.TEMPLATE_VARIABLE,r)}else t.placeholder=e.DEFAULT_PLACEHOLDER}static createElement(t,r,n){const i=document.createElement("input");i.classList.add(e.INPUT_CLASS);const a=(null==n?void 0:n.placeholderColor)||"#656565";return i.style.setProperty("--active-table-filter-placeholder-color",a),Object.assign(i.style,null==n?void 0:n.input),e.setPlaceholder(i,t,r),i}static create(t,r,n){const i=FilterInternalUtils.generateDefaultHeaderName(n,t.defaultColumnHeaderName),a=e.createElement(i,t.placeholderTemplate,r.styles);return t.inputElement=a,a}};_FilterInputElement.INPUT_CLASS="filter-rows-input",_FilterInputElement.TEMPLATE_VARIABLE="{headerName}",_FilterInputElement.DEFAULT_PLACEHOLDER="Filter",_FilterInputElement.DEFAULT_PLACEHOLDER_TEMPLATE=`Filter ${_FilterInputElement.TEMPLATE_VARIABLE}...`;let FilterInputElement=_FilterInputElement;class FilterInputEvents{static unsetEvents(e){e&&e.forEach((e=>e.inputElement.oninput=()=>{}))}static updateSameInputValues(e,t){e.forEach((e=>{e.elements===t.elements&&(e.inputElement.value=t.inputElement.value)}))}static getFilterData(e){return e.map((e=>({filterText:e.isCaseSensitive?e.inputElement.value:e.inputElement.value.toLocaleLowerCase(),colCells:e.elements.slice(1),isCaseSensitive:e.isCaseSensitive})))}static splitChunksAndExecute(e,t){const r=e.filter((e=>""!==e.filterText));0===r.length&&r.push(e[0]);const n=Math.ceil(r[0].colCells.length/FilterInternalUtils.CHUNK_SIZE);for(let e=0;e<n;e+=1){const n=e*FilterInternalUtils.CHUNK_SIZE,i=r.map((e=>({...e,chunk:e.colCells.slice(n,n+FilterInternalUtils.CHUNK_SIZE)})));t(i)}}static setEvents(e,t,r){if(!t.elements)return;const n=FilterInternalUtils.getFilterFunc(e),i=r.filter((e=>e!==t));t.inputElement.oninput=()=>{FilterInputEvents.updateSameInputValues(i,t),FilterInputEvents.splitChunksAndExecute(FilterInputEvents.getFilterData(r),n)}}}const ARROW_DOWN_SVG_STRING='<?xml version="1.0" encoding="UTF-8"?>\n<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n\t<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n\t\t<g transform="translate(-288.000000, 0.000000)">\n\t\t\t<g transform="translate(288.000000, 0.000000)">\n\t\t\t\t<path d="M24,0 L24,24 L0,24 L0,0 L24,0 Z M12.5934901,23.257841 L12.5819402,23.2595131 L12.5108777,23.2950439 L12.4918791,23.2987469 L12.4918791,23.2987469 L12.4767152,23.2950439 L12.4056548,23.2595131 C12.3958229,23.2563662 12.3870493,23.2590235 12.3821421,23.2649074 L12.3780323,23.275831 L12.360941,23.7031097 L12.3658947,23.7234994 L12.3769048,23.7357139 L12.4804777,23.8096931 L12.4953491,23.8136134 L12.4953491,23.8136134 L12.5071152,23.8096931 L12.6106902,23.7357139 L12.6232938,23.7196733 L12.6232938,23.7196733 L12.6266527,23.7031097 L12.609561,23.275831 C12.6075724,23.2657013 12.6010112,23.2592993 12.5934901,23.257841 L12.5934901,23.257841 Z M12.8583906,23.1452862 L12.8445485,23.1473072 L12.6598443,23.2396597 L12.6498822,23.2499052 L12.6498822,23.2499052 L12.6471943,23.2611114 L12.6650943,23.6906389 L12.6699349,23.7034178 L12.6699349,23.7034178 L12.678386,23.7104931 L12.8793402,23.8032389 C12.8914285,23.8068999 12.9022333,23.8029875 12.9078286,23.7952264 L12.9118235,23.7811639 L12.8776777,23.1665331 C12.8752882,23.1545897 12.8674102,23.1470016 12.8583906,23.1452862 L12.8583906,23.1452862 Z M12.1430473,23.1473072 C12.1332178,23.1423925 12.1221763,23.1452606 12.1156365,23.1525954 L12.1099173,23.1665331 L12.0757714,23.7811639 C12.0751323,23.7926639 12.0828099,23.8018602 12.0926481,23.8045676 L12.108256,23.8032389 L12.3092106,23.7104931 L12.3186497,23.7024347 L12.3186497,23.7024347 L12.3225043,23.6906389 L12.340401,23.2611114 L12.337245,23.2485176 L12.337245,23.2485176 L12.3277531,23.2396597 L12.1430473,23.1473072 Z" fill-rule="nonzero"></path>\n\t\t\t\t<path d="M12.7071,15.7072 C12.3166,16.0977 11.6834,16.0977 11.2929,15.7072 L5.63604,10.0503 C5.24551,9.65982 5.24551,9.02666 5.63604,8.63613 C6.02656,8.24561 6.65973,8.24561 7.05025,8.63613 L12,13.5859 L16.9497,8.63613 C17.3403,8.24561 17.9734,8.24561 18.364,8.63613 C18.7545,9.02666 18.7545,9.65982 18.364,10.0503 L12.7071,15.7072 Z" fill="#09244B"></path>\n\t\t\t</g>\n\t\t</g>\n\t</g>\n</svg>',_FilterButtonElement=class e{static create(t={}){const r=document.createElement("div");r.classList.add("filter-rows-dropdown-button",ToggleableElement.AUTO_STYLING_CLASS),FilterElements.applyStatefulStyles(r,e.HOVER_STYLE,t);const n=SVGIconUtils.createSVGElement(ARROW_DOWN_SVG_STRING);return r.appendChild(n),r}};_FilterButtonElement.ACTIVE_STYLE={filter:"brightness(0) saturate(100%) invert(14%) sepia(59%) saturate(2970%) hue-rotate(219deg) brightness(98%) contrast(126%)"},_FilterButtonElement.HOVER_STYLE={filter:"brightness(0) saturate(100%) invert(31%) sepia(1%) saturate(75%) hue-rotate(327deg) brightness(100%) contrast(99%)"};let FilterButtonElement=_FilterButtonElement;class OuterDropdownItemEvents{static itemMouseDownCommon(e,t,r){const{_activeOverlayElements:{outerContainerDropdown:n}}=this,i=r.target.innerText;if(!n)return;null==e||e(this,i,r);const a=Array.from(n.element.children);null==t||t(this._activeOverlayElements,a),n.element.classList.contains(StaticDropdown.DROPDOWN_CLASS)||(OuterDropdownItem.unsetActiveItem(n.element),OuterDropdownItem.setActive(a,i),DropdownItemHighlightUtils.fadeCurrentlyHighlighted(this._activeOverlayElements))}}class FilterDropdownItemEvents{static resetInput(e,t,r,n){const i=n.target,a=-1===i.tabIndex?i.parentElement.tabIndex:i.tabIndex,s=t._columnsDetails[a].elements;s!==e.elements&&(e.elements=s,FilterInternalUtils.resetInput(t,e),FilterInternalUtils.unsetFilter(e.inputElement))}static setEvents(e,t,r,n){const i=FilterDropdownItemEvents.resetInput.bind(this,r),a=FilterDropdownElement.hide.bind(this,n);t.onmousedown=OuterDropdownItemEvents.itemMouseDownCommon.bind(e,i,a)}}class FilterDropdownItem{static setActive(e,t,r){const n=e._columnsDetails.findIndex((e=>e.elements===r.elements));OuterDropdownItem.setActiveByIndex(Array.from(t.children),n)}static addItems(e,t,r){var n;const i=null==(n=e.data[0])?void 0:n.map((e=>String(e)));null==i||i.forEach((n=>{const i={text:n},a=DropdownItem.addButtonItem(e,t.element,i);FilterDropdownItemEvents.setEvents(e,a,r,t.activeButtonStyle)}))}static populate(e,t,r){t.element.replaceChildren(),FilterDropdownItem.addItems(e,t,r),FilterDropdownItem.setActive(e,t.element,r)}}class FilterDropdownElement{static hide(e,t){OuterDropdownElement.hide(t,e)}static display(e,t,r,n){r.data[0]&&(FilterDropdownItem.populate(r,n,t),e(r,n))}static create(e,t,r,n,i){const a=FilterButtonElement.create(i);t.appendChild(a);const s=(null==i?void 0:i.active)||{},o={...FilterButtonElement.ACTIVE_STYLE,...s},l=FilterDropdownElement.hide.bind(this,o,e._activeOverlayElements),c=OuterDropdownButtonEvents.getDisplayFunc(r),d=FilterDropdownElement.display.bind(this,c,n),{element:u}=OuterDropdownElement.create(e,a,r,o,["filter-rows-dropdown"],l,d);return u}}class StatefulCSSEvents{static apply(e,t,r){ElementStyle.unsetAllCSSStates(r,e),Object.assign(r.style,t)}static mouseUp(e,t,r){t&&r.classList.contains(t)||(StatefulCSSEvents.apply(e,e.default,r),Object.assign(r.style,e.hover))}static mouseDown(e,t,r){t&&r.classList.contains(t)||Object.assign(r.style,e.click)}static mouseLeave(e,t,r){t&&r.classList.contains(t)||StatefulCSSEvents.apply(e,e.default,r)}static mouseEnter(e,t,r){t&&r.classList.contains(t)||Object.assign(r.style,e.hover)}static getEvents(e,t,r,n){const i=n||e;return{mouseenter:StatefulCSSEvents.mouseEnter.bind(this,t,r,i),mouseleave:StatefulCSSEvents.mouseLeave.bind(this,t,r,i),mousedown:StatefulCSSEvents.mouseDown.bind(this,t,r,i),mouseup:StatefulCSSEvents.mouseUp.bind(this,t,r,i)}}static setEvents(e,t,r,n){const i=StatefulCSSEvents.getEvents(e,t,r,n);return e.addEventListener("mouseenter",i.mouseenter),e.addEventListener("mouseleave",i.mouseleave),e.addEventListener("mousedown",i.mousedown),e.addEventListener("mouseup",i.mouseup),i}}class FilterInputCaseEvents{static clickButton(e,t,r){const n=r||{},i=ToggleableElement.toggleActive(e,{color:"#000000",...n});t.isCaseSensitive=!i,FilterInternalUtils.resetInput(this,t),t.inputElement.dispatchEvent(new Event("input"))}static setEvents(e,t,r,n){t.onclick=FilterInputCaseEvents.clickButton.bind(e,t,r,n)}}class FilterInputCaseElement{static createButton(e={}){const t=document.createElement("div");return t.classList.add("filter-rows-case-button"),t.textContent="Aa",FilterElements.applyStatefulStyles(t,{color:"#626262"},e),t}static create(e,t,r,n){const i=FilterInputCaseElement.createButton(null==n?void 0:n.caseIcon);t.appendChild(i),setTimeout((()=>{var t;return FilterInputCaseEvents.setEvents(e,i,r,null==(t=null==n?void 0:n.caseIcon)?void 0:t.active)}))}}const _FilterElements=class e{static createContainerElement(e){const t=document.createElement("div");return t.classList.add("filter-rows-container"),t.style.order=String(e||0),t}static createComponent(t,r,n){var i;const a=n.position||e.DEFAULT_INPUT_POSITION,s=e.createContainerElement(n.order),o=FilterInternalUtils.addConfig(t,n);if(!1!==n.dropdown){const e=FilterDropdownElement.create(t,s,a,o,null==(i=n.styles)?void 0:i.dropdownIcon);setTimeout((()=>s.appendChild(e)))}!1!==n.caseButton&&FilterInputCaseElement.create(t,s,o,n.styles);const l=FilterInputElement.create(o,n,t.data);s.appendChild(l),OuterContainerElements.addToContainer(a,r,s)}static create(t,r){"boolean"==typeof t.filter?e.createComponent(t,r,{}):Array.isArray(t.filter)?t.filter.forEach((n=>{e.createComponent(t,r,n)})):t.filter&&e.createComponent(t,r,t.filter),setTimeout((()=>FilterInternalUtils.resetAllInputs(t)))}static applyStatefulStyles(e,t,r={}){const n=ElementStyle.generateStatefulCSS(r,t,{color:"#484848"});Object.assign(e.style,n.default),setTimeout((()=>StatefulCSSEvents.setEvents(e,n,ToggleableElement.ACTIVE_BUTTON_CLASS)))}};_FilterElements.DEFAULT_INPUT_POSITION="top-right";let FilterElements=_FilterElements;const CALENDAR_ICON_SVG_STRING='<?xml version="1.0" encoding="UTF-8"?>\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="10px" viewBox="0 0 10 10" version="1.1">\n  <g id="surface1">\n    <path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 1.070312 9.285156 L 8.929688 9.285156 L 8.929688 3.570312 L 1.070312 3.570312 Z M 3.214844 2.5 L 3.214844 0.894531 C 3.214844 0.839844 3.199219 0.796875 3.164062 0.765625 C 3.128906 0.730469 3.085938 0.714844 3.035156 0.714844 L 2.679688 0.714844 C 2.625 0.714844 2.582031 0.730469 2.550781 0.765625 C 2.515625 0.796875 2.5 0.839844 2.5 0.894531 L 2.5 2.5 C 2.5 2.550781 2.515625 2.59375 2.550781 2.628906 C 2.582031 2.660156 2.625 2.679688 2.679688 2.679688 L 3.035156 2.679688 C 3.085938 2.679688 3.128906 2.660156 3.164062 2.628906 C 3.199219 2.59375 3.214844 2.550781 3.214844 2.5 Z M 7.5 2.5 L 7.5 0.894531 C 7.5 0.839844 7.484375 0.796875 7.449219 0.765625 C 7.417969 0.730469 7.375 0.714844 7.320312 0.714844 L 6.964844 0.714844 C 6.914062 0.714844 6.871094 0.730469 6.835938 0.765625 C 6.800781 0.796875 6.785156 0.839844 6.785156 0.894531 L 6.785156 2.5 C 6.785156 2.550781 6.800781 2.59375 6.835938 2.628906 C 6.871094 2.660156 6.914062 2.679688 6.964844 2.679688 L 7.320312 2.679688 C 7.375 2.679688 7.417969 2.660156 7.449219 2.628906 C 7.484375 2.59375 7.5 2.550781 7.5 2.5 Z M 9.644531 2.144531 L 9.644531 9.285156 C 9.644531 9.480469 9.570312 9.648438 9.429688 9.789062 C 9.289062 9.929688 9.121094 10 8.929688 10 L 1.070312 10 C 0.878906 10 0.710938 9.929688 0.570312 9.789062 C 0.429688 9.648438 0.355469 9.480469 0.355469 9.285156 L 0.355469 2.144531 C 0.355469 1.949219 0.429688 1.78125 0.570312 1.640625 C 0.710938 1.5 0.878906 1.429688 1.070312 1.429688 L 1.785156 1.429688 L 1.785156 0.894531 C 1.785156 0.648438 1.875 0.4375 2.046875 0.261719 C 2.222656 0.0859375 2.433594 0 2.679688 0 L 3.035156 0 C 3.28125 0 3.492188 0.0859375 3.667969 0.261719 C 3.839844 0.4375 3.929688 0.648438 3.929688 0.894531 L 3.929688 1.429688 L 6.070312 1.429688 L 6.070312 0.894531 C 6.070312 0.648438 6.160156 0.4375 6.332031 0.261719 C 6.507812 0.0859375 6.71875 0 6.964844 0 L 7.320312 0 C 7.566406 0 7.777344 0.0859375 7.953125 0.261719 C 8.125 0.4375 8.214844 0.648438 8.214844 0.894531 L 8.214844 1.429688 L 8.929688 1.429688 C 9.121094 1.429688 9.289062 1.5 9.429688 1.640625 C 9.570312 1.78125 9.644531 1.949219 9.644531 2.144531 Z M 9.644531 2.144531 "/>\n  </g>\n</svg>',_DateCellCalendarIconElement=class e{static createContainer(){const t=document.createElement("div");return t.classList.add(e.CALENDAR_ICON_CONTAINER_CLASS),t}static createSVGElement(){const e=SVGIconUtils.createSVGElement(CALENDAR_ICON_SVG_STRING);return e.style.pointerEvents="none",e.style.height="25px",e}static createSVG(){const t=e.createSVGElement(),r=e.createContainer();return r.appendChild(t),r}static get(){return e.CALENDAR_ICON_ELEMENT.cloneNode(!0)}};_DateCellCalendarIconElement.CALENDAR_ICON_CONTAINER_CLASS="calender-icon-container",_DateCellCalendarIconElement.CALENDAR_ICON_ELEMENT=_DateCellCalendarIconElement.createSVG();let DateCellCalendarIconElement=_DateCellCalendarIconElement;class ColumnDetailsUtils{static getColumnsByWidth(e){var t;const r=[],n=[];for(let i=0;i<e.length;i+=1){const a=e[i];void 0!==(null==(t=a.settings.widths)?void 0:t.staticWidth)?n.push(a):r.push(a)}return{dynamicWidth:r,staticWidth:n}}static aggregateItems(e){return e.labelDetails?Object.keys(e.itemsDetails).map((t=>({name:t,backgroundColor:e.itemsDetails[t].backgroundColor}))):Object.keys(e.itemsDetails).map((e=>({name:e})))}static getDetails(e){const t={width:e.elements[0].offsetWidth,typeName:e.activeType.name};return e.activeType.cellDropdownProps&&(t.cellDropdownItems=ColumnDetailsUtils.aggregateItems(e.cellDropdown)),t}static getAllColumnsDetails(e){return e.map((e=>ColumnDetailsUtils.getDetails(e)))}}class FireEvents{static onCellUpdate(e,t,r,n,i){const a={text:String(t),rowIndex:r,columnIndex:n,updateType:i};e.onCellUpdate(a),e.dispatchEvent(new CustomEvent("cell-update",{detail:a}))}static onDataUpdate(e){const t=JSON.parse(JSON.stringify(e.data));e.onDataUpdate(t),e.dispatchEvent(new CustomEvent("data-update",{detail:t}))}static onColumnsUpdate(e){const t=ColumnDetailsUtils.getAllColumnsDetails(e._columnsDetails);e.onColumnsUpdate(t),e.dispatchEvent(new CustomEvent("columns-update",{detail:t}))}static onRender(e){e.onRender(),e.dispatchEvent(new CustomEvent("render"))}}class StaticTable{static isTableAtMaxWidth(e,t){return void 0!==t.maxWidth&&t.maxWidth<=e.offsetWidth+2}static isStaticTableWidth(e,t){return void 0!==t.width||StaticTable.isTableAtMaxWidth(e,t)}}class StaticTableWidthUtils{static togglePreserveNarrowColumns(e,t,r){r||(t.style.display=e?"block":"")}static toggleWidthUsingMaxWidth(e,t){const{_tableElementRef:r,_tableDimensions:{maxWidth:n,preserveNarrowColumns:i}}=e;r&&void 0!==n&&(r.style.width=t?`${n}px`:"",StaticTableWidthUtils.togglePreserveNarrowColumns(t,r,i))}static setTableWidth(e){const{_tableDimensions:{preserveNarrowColumns:t,width:r},_tableElementRef:n}=e;n&&void 0!==r&&(n.style.width=`${r}px`,StaticTableWidthUtils.togglePreserveNarrowColumns(!0,n,t))}static changeTableWidthForNonDynamicColumns(e,t,r,n,i){0===e.length||t.dynamicWidth.length>0?r.offsetWidth!==n&&(r.style.width=`${n}px`):r.style.width=`${i}px`}static resetDynamicWidthColumns(e,t){e.forEach((e=>{e.elements[0].style.width=`${t.newColumnWidth}px`}))}static setNewColumnWidth(e,t,r){if(t>0){const n=e-r.staticWidth;r.newColumnWidth=n/t}}static resetColumnSizes(e,t,r){const n=ColumnDetailsUtils.getColumnsByWidth(e);return StaticTableWidthUtils.setNewColumnWidth(t,n.dynamicWidth.length,r),StaticTableWidthUtils.resetDynamicWidthColumns(n.dynamicWidth,r),n}static changeWidthsBasedOnColumnInsertRemove(e,t){const{_tableElementRef:r,_tableDimensions:n,_columnsDetails:i}=e;if(!r)return;const{width:a,maxWidth:s,staticWidth:o}=n;if(void 0!==a){const e=StaticTableWidthUtils.resetColumnSizes(i,a,n);StaticTableWidthUtils.changeTableWidthForNonDynamicColumns(i,e,r,a,o)}else t&&StaticTable.isTableAtMaxWidth(r,n)&&StaticTableWidthUtils.resetColumnSizes(i,s,n);setTimeout((()=>FireEvents.onColumnsUpdate(e)))}}class ConvertCellTypeUtils{static preprocessCell(e){e.style.cursor=""}}class CellStructureUtils{static setColumn(e,t,r,n){const{elements:i}=e._columnsDetails[t];i.slice(1).forEach(((i,a)=>{const s=a+1;r(e,i,t,s),e._columnsDetails[t].settings.isCellTextEditable&&n(e,i,s,t)}))}}class FocusedCellUtils{static createEmpty(){return{}}static setHeaderCell(e,t,r){e.element=t,e.rowIndex=0,e.columnIndex=r}static setIndexCell(e,t,r){e.element=t,e.rowIndex=r,delete e.columnIndex}static set(e,t,r,n){e.element=t,e.rowIndex=r,e.columnIndex=n}static incrementColumnIndex(e,t){void 0!==e.columnIndex&&t<=e.columnIndex&&(e.columnIndex+=1)}static purge(e){delete e.columnIndex,delete e.element,delete e.rowIndex}}var KEYBOARD_KEY=(e=>(e.ESCAPE="Escape",e.ENTER="Enter",e.TAB="Tab",e.ARROW_UP="ArrowUp",e.ARROW_DOWN="ArrowDown",e.ARROW_RIGHT="ArrowRight",e.ARROW_LEFT="ArrowLeft",e))(KEYBOARD_KEY||{});const _Browser=class{static createDateInput(){const e=document.createElement("input");return e.type="date",e}static createColorInput(){const e=document.createElement("input");return e.type="color",e}};_Browser.IS_FIREFOX=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,_Browser.IS_SAFARI=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),_Browser.IS_CHROMIUM=window.chrome,_Browser.IS_INPUT_DATE_SUPPORTED="date"===_Browser.createDateInput().type&&"showPicker"in HTMLInputElement.prototype,_Browser.IS_COLOR_PICKER_SUPPORTED="color"===_Browser.createColorInput().type&&"showPicker"in HTMLInputElement.prototype;let Browser=_Browser;class ColumnSettingsStyleUtils{static applySettingsStyleOnCell(e,t,r){var n;Object.assign(t.style,e.cellStyle||{},r&&(null==(n=e.headerStyles)?void 0:n.default)||{})}static setNewHeaderStyle(e,t){var r;const{settings:n,elements:i}=t,a=n.cellStyle||(null==(r=n.headerStyles)?void 0:r.default);a&&ColumnSettingsStyleUtils.applySettingsStyleOnCell(n,i[0],!0);const s=a?n:void 0;t.headerStateColors=ColumnDetails.createHeaderStateColors(e._defaultColumnsSettings,s,e._defaultCellHoverColors),ColumnSettingsBorderUtils.overwriteSideBorderIfSiblingsHaveSettings(t,[i[0]])}static unsetHeaderSettingStyle(e,t){Object.keys(t).forEach((t=>{ElementStyle.setStyle(e,t,"")}))}static resetHeaderStyleToDefault(e,t,r){var n;null!=(n=t.headerStyles)&&n.default&&ColumnSettingsStyleUtils.unsetHeaderSettingStyle(e[0],t.headerStyles.default),t.cellStyle&&ElementStyle.unsetStyle(e[0],t.cellStyle);const{cellStyle:i,headerStyles:a}=r;CellElement.setDefaultCellStyle(e[0],i,null==a?void 0:a.default)}static changeHeaderStyleFunc(e,t){var r,n,i;const a=this._columnsDetails[e],{elements:s,settings:{isHeaderTextEditable:o}}=a;ColumnSettingsStyleUtils.resetHeaderStyleToDefault(s,t,this._defaultColumnsSettings),ColumnSettingsStyleUtils.setNewHeaderStyle(this,a);const l=null==(i=null==(n=null==(r=this._defaultColumnsSettings.columnDropdown)?void 0:r.displaySettings)?void 0:n.openMethod)?void 0:i.cellClick,c=!l&&o;CellElement.prepContentEditable(CellElement.getTextElement(s[0]),!!c,l)}static changeStyleFunc(e,t,r){ProcessedDataTextStyle.resetDataCellsStyle(e,t,ColumnSettingsStyleUtils.changeHeaderStyleFunc.bind(e,t,r),r.cellStyle)}static doStylesHaveVisibleDimension(e,t){for(let r=0;r<t.length;r+=1){const n=e[t[r]];if(n){const e=RegexUtils.extractIntegerStrs(String(n));if(e.length>0&&Number(e[0])>0)return!0}}return!1}static doesSettingHaveSideBorderStyle(e){var t;const r=e.cellStyle||(null==(t=e.headerStyles)?void 0:t.default);return!!r&&ColumnSettingsStyleUtils.doStylesHaveVisibleDimension(r,["border","borderLeft","borderLeftWidth","borderRight","borderRightWidth"])}}class ResetColumnStyles{static applyDefaultStyles(e,t){const{cellStyle:r,headerStyles:n}=t;CellElement.setDefaultCellStyle(e[0],r,null==n?void 0:n.default),e.slice(1).forEach((e=>{CellElement.setDefaultCellStyle(e,r)}))}static unsetLastAppliedStyle(e,t){Object.keys(e.lastAppliedStyle).forEach((e=>{ElementStyle.setStyle(t,e,"")}))}static setDefaultStyle(e,t,r,n,i){ResetColumnStyles.unsetLastAppliedStyle(t,r),i&&ElementStyle.unsetStyle(r,i),CellElement.setDefaultCellStyle(r,n.cellStyle),ColumnSettingsStyleUtils.applySettingsStyleOnCell(e.settings,r,!1)}}const _ProcessedDataTextStyle=class e{static setCustomStyle(e,t,r,n,i,a,s){if(e){ResetColumnStyles.setDefaultStyle(r,i,a,s);const o=e(String(t),n);Object.assign(a.style,o),i.lastAppliedStyle=o,ColumnSettingsBorderUtils.overwriteSideBorderIfSiblingsHaveSettings(r,[a])}}static setFailedValidationStyle(t,r,n){const{textValidation:i}=t.activeType,a=i.failedStyle||e.DEFAULT_FAILED_VALIDATION_STYLE;Object.assign(n.style,a),r.lastAppliedStyle=a}static setStyle(t,r,n,i,a,s){let o=!1;return t?null!=i&&i.changeStyleFunc||(ResetColumnStyles.setDefaultStyle(r,n,a,s),n.lastAppliedStyle={},o=!0):(null!=i&&i.changeStyleFunc&&ResetColumnStyles.setDefaultStyle(r,n,a,s),e.setFailedValidationStyle(r,n,a),o=!0),o&&ColumnSettingsBorderUtils.overwriteSideBorderIfSiblingsHaveSettings(r,[a]),o}static setCellStyle(t,r,n,i=!1){const a=t._columnsDetails[n],s=a.elements[r],o=a.processedStyle[r],l=CellElement.getText(s),{textValidation:{func:c},customTextProcessing:d}=a.activeType;let u=!1;if(c){const r=c(l);(i||o.isValid!==r)&&(u=e.setStyle(r,a,o,d,s,t._defaultColumnsSettings),o.isValid=r)}!u&&null!=d&&d.changeStyleFunc&&e.setCustomStyle(d.changeStyleFunc,l,a,r,o,s,t._defaultColumnsSettings)}static setStyleOnColumn(t,r){const n=t._columnsDetails[r];n.elements.slice(1).forEach(((i,a)=>{const s=a+1;e.setCellStyle(t,s,r,!0),ColumnSettingsBorderUtils.overwriteSideBorderIfSiblingsHaveSettings(n,[i])}))}static unsetStyleOnColumn(e,t,r){const n=e._columnsDetails[t];n.elements.slice(1).forEach(((t,i)=>{const a=i+1,s=n.processedStyle[a];ResetColumnStyles.setDefaultStyle(n,s,t,e._defaultColumnsSettings,r)}))}static resetDataCellsStyle(t,r,n,i){e.unsetStyleOnColumn(t,r,i),n(),e.setStyleOnColumn(t,r)}static reapplyCellsStyle(e,t){const r=e._columnsDetails[t],{textValidation:{func:n},customTextProcessing:i}=r.activeType;(n||null!=i&&i.changeStyleFunc)&&r.elements.slice(1).forEach(((e,t)=>{const n=t+1;Object.assign(e.style,r.processedStyle[n].lastAppliedStyle)}))}static getDefaultProcessedTextStyle(){return{isValid:!0,lastAppliedStyle:{}}}};_ProcessedDataTextStyle.DEFAULT_FAILED_VALIDATION_STYLE={color:"grey"};let ProcessedDataTextStyle=_ProcessedDataTextStyle;class NumberOfIdenticalCells{static get(e,t){return t.map((e=>e.elements.length>0?CellElement.getText(e.elements[0]):"")).filter((t=>t===e)).length}}const EMPTY_STRING="";class DataUtils{static createEmptyStringDataArray(e){return new Array(e).fill(EMPTY_STRING)}static isTextEmpty(e,t){return e!==EMPTY_STRING&&("string"==typeof t?t.trim():t)===EMPTY_STRING}static shouldBeSetToDefault(e,t,r,n,i){const{allowDuplicateHeaders:a,_columnsDetails:s}=e;return DataUtils.isTextEmpty(r,t)||0===n&&!a&&NumberOfIdenticalCells.get(t,s)>1||n>0&&!(void 0===i.func||i.func(String(t)))}static processCellText(e,t,r,n){let i="string"==typeof n?n.trim():n;const a=e._columnsDetails[r];if(!a)return i;const{activeType:{textValidation:s,customTextProcessing:o},settings:{defaultText:l}}=a;return t>0&&(null!=o&&o.changeTextFunc&&(i=o.changeTextFunc(String(i),t)),!s.setTextToDefaultOnFail&&i!==EMPTY_STRING)?i:DataUtils.shouldBeSetToDefault(e,i,l,t,s)?l:i}}var CELL_UPDATE_TYPE=(e=>(e.UPDATE="Update",e.ADD="Add",e.REMOVED="Removed",e))(CELL_UPDATE_TYPE||{});class CellEvents{static executeUpdateOperation(e,t){return void 0===(null==t?void 0:t[e])||!0===t[e]}static updateCell(e,t,r,n,i){return CellEvents.executeUpdateOperation("processText",i)&&(t=DataUtils.processCellText(e,r,n,t)),CellEvents.executeUpdateOperation("updateData",i)&&(e.data[r][n]=t),null!=i&&i.element&&CellElement.setNewText(e,i.element,t,!1,!1),CellEvents.executeUpdateOperation("updateTableEvent",i)&&e.onDataUpdate(e.data),r>0&&ProcessedDataTextStyle.setCellStyle(e,r,n),CellEvents.executeUpdateOperation("updateCellEvent",i)&&FireEvents.onCellUpdate(e,t,r,n,CELL_UPDATE_TYPE.UPDATE),t}static setCellToDefaultIfNeeded(e,t,r,n,i=!0){const a=CellElement.getText(n),s=DataUtils.processCellText(e,t,r,a);return s!==a&&(CellEvents.updateCell(e,s,t,r,{element:n,processText:!1,updateTableEvent:i}),!0)}static removeTextIfDefault(e,t,r,n){const{isDefaultTextRemovable:i,defaultText:a}=e._columnsDetails[r].settings;i&&a!==EMPTY_STRING&&a===CellElement.getText(n)&&CellEvents.updateCell(e,EMPTY_STRING,t,r,{element:n,processText:!1})}}class CheckboxEvents{static focusCheckbox(e,t,r){Browser.IS_SAFARI||FocusedCellUtils.set(this._focusedElements.cell,e,t,r)}static blurCheckbox(){Browser.IS_SAFARI||FocusedCellUtils.purge(this._focusedElements.cell)}static changeValueCheckbox(e,t,r){const n=r.target;CellEvents.updateCell(this,String(n.checked),e,t,{processText:!1})}static keyDownCheckbox(e){e.key===KEYBOARD_KEY.ENTER&&e.target.click()}static setEvents(e,t,r,n){t.onkeydown=CheckboxEvents.keyDownCheckbox,t.onchange=CheckboxEvents.changeValueCheckbox.bind(e,r,n),t.onfocus=CheckboxEvents.focusCheckbox.bind(e,t,r,n),t.onblur=CheckboxEvents.blurCheckbox.bind(e)}}class CheckboxCellEvents{static mouseDownCell(e){const t=e.target;t.classList.contains(CellElement.CELL_CLASS)&&t.children[0].click()}static focusCell(e){e.target.children[0].focus()}static setEvents(e,t,r,n){if(!e._columnsDetails[n].settings.isCellTextEditable)return;t.onblur=()=>{},t.onfocus=CheckboxCellEvents.focusCell,t.onmouseenter=()=>{},t.onmouseleave=()=>{},t.oninput=()=>{},t.onmousedown=CheckboxCellEvents.mouseDownCell.bind(e);const i=CheckboxCellElement.getCheckboxElement(t);CheckboxEvents.setEvents(e,i,r,n)}}class CheckboxElement{static createCheckbox(e){const t=document.createElement("input");return t.type="checkbox",t.style.cursor=e?"pointer":"auto",t.style.pointerEvents=e?"":"none",t}static setCellTextAsCheckbox(e,t){const r=CheckboxElement.createCheckbox(t);e.replaceChildren(r)}}class CheckboxCellElement{static isCheckbox(e){return"checkbox"===(null==e?void 0:e.type)}static isCheckboxCell(e){return CheckboxCellElement.isCheckbox(e.children[0])}static getCheckboxElement(e){return CheckboxCellElement.isCheckboxCell(e)?e.children[0]:CheckboxCellElement.isCheckbox(e)?e:void 0}static getValue(e){const t=CheckboxCellElement.getCheckboxElement(e);if(t)return String(t.checked)}static setValue(e,t){const r=CheckboxCellElement.getCheckboxElement(e);return!!r&&(r.checked="true"===t,!0)}static setCellTextAsAnElement(e,t,r,n){const{settings:{isCellTextEditable:i}}=e._columnsDetails[n],a=CellElement.getText(t);CheckboxElement.setCellTextAsCheckbox(t,i),t.contentEditable="false",t.style.cursor=i?"pointer":"default",CellEvents.updateCell(e,a,r,n,{element:t})}static setCellCheckboxStructure(e,t,r,n){ConvertCellTypeUtils.preprocessCell(t),CheckboxCellElement.setCellTextAsAnElement(e,t,n,r)}static setColumnCheckboxStructure(e,t){CellStructureUtils.setColumn(e,t,CheckboxCellElement.setCellCheckboxStructure,CheckboxCellEvents.setEvents)}}class CaretPosition{static setSelectionToEndOfText(e,t){const r=CellElement.getTextElement(e),n=document.createRange();n.setStart(r.childNodes[0],CellElement.getText(r).length||0),n.collapse(!0),t.removeAllRanges(),t.addRange(n)}static getSelection(e){var t;const r=e.shadowRoot;return r.getSelection?r.getSelection():(null==(t=window.document.activeElement)?void 0:t.shadowRoot)===r?window.document.getSelection():null}static setToEndOfText(e,t){if(CheckboxCellElement.isCheckboxCell(t))return;let r=CaretPosition.getSelection(e);Browser.IS_SAFARI&&!r&&(t.focus(),r=CaretPosition.getSelection(e)),r&&CaretPosition.setSelectionToEndOfText(t,r)}}class ArrayUtils{static transpose(e){if(0===e.length)return e;const t=[],r=Math.max(e.length,e[0].length);e:for(let n=0;n<r;n+=1){const i=[];for(let t=0;t<r&&void 0!==e[t];t+=1){if(void 0===e[t][n])break e;i.push(e[t][n])}t.push(i)}return t}static shuffle(e){return e.sort((()=>Math.random()-.5))}static swap(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}}const _LabelColorUtils=class e{static generateNewPasteleColor(){return`hsl(${Math.floor(360*Math.random())}, 95%, 90%)`}static setNewLatestPasteleColor(){e.LATEST_PASTELE_COLOR=e.generateNewPasteleColor()}static getLatestPasteleColor(){return e.LATEST_PASTELE_COLOR}static getLatestPasteleColorAndSetNew(){const t=e.getLatestPasteleColor();return e.setNewLatestPasteleColor(),t}static generateDefaultColors(){return ArrayUtils.shuffle(["hsl(154deg 96% 90%)","hsl(50deg 96% 90%)","hsl(171deg 96% 90%)","hsl(76deg 96% 90%)","hsl(315deg 96% 90%)","hsl(251deg 96% 90%)","hsl(209deg 84% 92%)","hsl(0deg 100% 81%)","hsl(29deg 100% 79%)","hsl(31deg 73% 75%)","hsl(137deg 80% 80%)","hsl(60deg 100% 82%)","hsl(219deg 100% 84%)","hsl(93deg 62% 74%)","hsl(54deg 93% 84%)","hsl(146deg 100% 90%)","hsl(334deg 100% 87%)","hsl(19deg 95% 84%)","hsl(203deg 95% 84%)","hsl(76deg 100% 78%)","hsl(0deg 100% 86%)","hsl(42deg 82% 82%)","hsl(97deg 100% 87%)"])}static generateGlobalItemColors(){return{newColors:e.generateDefaultColors(),existingColors:{}}}};_LabelColorUtils.LATEST_PASTELE_COLOR=_LabelColorUtils.generateNewPasteleColor();let LabelColorUtils=_LabelColorUtils;class ScrollbarUtils{static isVerticalPresent(e){return e.scrollHeight>e.clientHeight}static isHorizontalPresent(e){return e.scrollWidth>e.clientWidth}}const _CellDropdownHorizontalScrollFix=class e{static setPropertiesIfHorizontalScrollPresent(t){const{element:r,scrollbarPresence:n,customDropdownStyle:i}=t;ScrollbarUtils.isHorizontalPresent(r)&&ScrollbarUtils.isVerticalPresent(r)?(n.horizontal=!0,r.style.paddingBottom=e.NEW_BOTTOM_PADDING_IF_PRESENT):(n.horizontal=!1,r.style.paddingBottom=(null==i?void 0:i.paddingBottom)||Dropdown.DROPDOWN_VERTICAL_PX)}static scrollDownFurther(t){t.scrollTop+=e.SCROLL_FURTHER_BOTTOM_PX}};_CellDropdownHorizontalScrollFix.NEW_BOTTOM_PADDING_IF_PRESENT="8px",_CellDropdownHorizontalScrollFix.SCROLL_FURTHER_BOTTOM_PX=14;let CellDropdownHorizontalScrollFix=_CellDropdownHorizontalScrollFix;const _RGBAToHex=class e{static extractIndividualNumbers(t){return t.match(e.REGEX)}static convert(t){return`#${e.extractIndividualNumbers(t).slice(1).map(((e,t)=>(3===t?Math.round(255*parseFloat(e)):parseFloat(e)).toString(16).padStart(2,"0").replace("NaN",""))).join("")}`}};_RGBAToHex.REGEX=/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+\.{0,1}\d*))?\)$/;let RGBAToHex=_RGBAToHex;const _OptionColorButton=class e{static extractRelativeParentElements(e){var t;const r=e.parentElement;return{containerElement:r,textElement:null==(t=r.previousSibling)?void 0:t.previousSibling,dropdownItemElement:r.parentElement}}static changeVisibility(e,t,r){const n=e.children[2];if(n.style.display=r?"block":"none",r){const e=n.children[0],i=Browser.IS_SAFARI?9:5;e.style.left=`${r.offsetWidth-t+i}px`,n.children[1].style.left=r.offsetWidth-t+"px"}}static createIcon(){const t=document.createElement("div");return t.innerText=e.COLOR_ICON_TEXT,t.classList.add(e.COLOR_BUTTON_ICON_CLASS),t}static createButton(){const t=document.createElement("div");t.classList.add(OptionButton.BUTTON_CLASS,e.COLOR_BUTTON_CLASS);const r=e.createIcon();return t.appendChild(r),t}static createInput(){const t=document.createElement("input");return t.type="color",t.style.top=Browser.IS_SAFARI?"0px":"14px",t.classList.add(e.COLOR_INPUT_CLASS),t}static createContainer(){const e=document.createElement("div");return e.classList.add(OptionButton.BUTTON_CONTAINER_CLASS),e}static create(t,r){const n=e.createContainer(),i=e.createInput();n.appendChild(i);const a=e.createButton();return n.appendChild(a),OptionColorButtonEvents.setEvents(n,i,t,r),n}};_OptionColorButton.COLOR_INPUT_CLASS="color-input",_OptionColorButton.COLOR_BUTTON_CLASS="option-color-button",_OptionColorButton.COLOR_BUTTON_ICON_CLASS="cell-dropdown-option-color-button-icon",_OptionColorButton.COLOR_ICON_TEXT="c";let OptionColorButton=_OptionColorButton;class OptionColorButtonEvents{static updateCellElements(e,t){const{itemText:r,backgroundColor:n}=t;e.elements.slice(1).forEach((e=>{const t=e.children[0];t.innerText===r&&(t.style.backgroundColor=n)}))}static updateIfUpdatable(e,t,r){const{itemText:n,backgroundColor:i}=r,a=e.cellDropdown.itemsDetails[n];a&&(!a.isCustomBackgroundColor||t===e.activeType.name)&&(a.backgroundColor=i,OptionColorButtonEvents.updateCellElements(e,r))}static updateElements(e,t,r){e.forEach((e=>{e.cellDropdown.labelDetails&&OptionColorButtonEvents.updateIfUpdatable(e,t,r)}))}static updateColorStates(e,t){var r,n,i;const{itemText:a,backgroundColor:s}=t;null==(n=null==(r=e.activeType.cellDropdownProps)?void 0:r.options)||n.forEach((e=>{e.text===a&&(e.backgroundColor=s)}));const o=null==(i=e.cellDropdown.labelDetails)?void 0:i.globalItemColors.existingColors;null!=o&&o[a]&&(o[a]=s)}static updateColumnLabelColors(e,t){const{cellDropdown:{labelDetails:r},activeType:n}=t;!r||!r.colorPickerNewValue||(OptionColorButtonEvents.updateColorStates(t,r.colorPickerNewValue),OptionColorButtonEvents.updateElements(e,n.name,r.colorPickerNewValue),delete r.colorPickerNewValue,setTimeout((()=>t.fireColumnsUpdate())))}static windowEventClosePicker(e,t){if(t.cellDropdown){const r=t.cell.columnIndex;OptionButton.hideAfterColorPickerContainerClose(e,e[r])}}static inputEvent(e,t){if(!Dropdown.isDisplayed(e.element))return;const r=t.target,{containerElement:n,textElement:i,dropdownItemElement:a}=OptionColorButton.extractRelativeParentElements(r),s=i.textContent,o=r.value;a.style.backgroundColor=o;const l=e.itemsDetails[s];l.backgroundColor!==o&&(l.backgroundColor=o,e.labelDetails.colorPickerNewValue={backgroundColor:o,itemText:s},setTimeout((()=>{var t;(t=e.labelDetails).colorPickerContainer??(t.colorPickerContainer=n)})))}static mouseDownContainer(e,t,r){const{cellDropdown:{labelDetails:n}}=t;if(!n)return;if(n.colorPickerContainer)return delete n.colorPickerContainer,void OptionColorButtonEvents.updateColumnLabelColors(e,t);const i=r.target,{containerElement:a,dropdownItemElement:s}=OptionColorButton.extractRelativeParentElements(i),o=i.previousSibling;o.value=RGBAToHex.convert(getComputedStyle(s).backgroundColor),o.showPicker(),setTimeout((()=>n.colorPickerContainer=a))}static setEvents(e,t,r,n){e.onmousedown=OptionColorButtonEvents.mouseDownContainer.bind(this,r,n),t.oninput=OptionColorButtonEvents.inputEvent.bind(this,n.cellDropdown)}}class FocusNextRowCell{static focus(e,t,r,n){n.preventDefault();const i=r[t+1];i&&(i.focus(),CaretPosition.setToEndOfText(e,i))}static focusOrBlurSelect(e,t){const r=e[t+1];if(r)return r.dispatchEvent(new Event("mousedown")),r.scrollIntoView({block:"nearest"}),r;e[t].children[0].blur()}}const ARROW_DOWN_ICON_SVG_STRING='<?xml version="1.0" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="12" height="12">\n  <g style="pointer-events: none" transform="matrix(0.6315789 0 0 0.6315789 0 0)">\n    <g transform="matrix(0.027142858 0 0 0.027142858 0 0)">\n      <path d="M0 87.5L350 507.5L700 87.5L0 87.5z" stroke="none" fill="#3e3e3e" fill-rule="nonzero" />\n    </g>\n  </g>\n</svg>\n',_ArrowDownIconElement=class e{static toggle(e,t){if(!e)return;const r=e.children[1];r.style.display=t?"block":"none";const n=r.children[0];!t&&n.style.filter&&(n.style.filter="")}static setActive(e){e.children[1].children[0].style.filter="brightness(0) saturate(100%) invert(24%) sepia(73%) saturate(631%)\n      hue-rotate(171deg) brightness(98%) contrast(98%)"}static createContainer(){const t=document.createElement("div");return t.classList.add(e.ARROW_ICON_CONTAINER_CLASS),t.style.display="none",t}static createSVGElement(){const t=SVGIconUtils.createSVGElement(ARROW_DOWN_ICON_SVG_STRING);return t.classList.add(e.ARROW_ICON_CLASS),t}static createSVG(){const t=e.createSVGElement(),r=e.createContainer();return r.appendChild(t),r}static get(){return e.ARROW_ICON_ELEMENT.cloneNode(!0)}};_ArrowDownIconElement.ARROW_ICON_CLASS="arrow-down-icon",_ArrowDownIconElement.ARROW_ICON_CONTAINER_CLASS="arrow-down-icon-container",_ArrowDownIconElement.ARROW_ICON_ELEMENT=_ArrowDownIconElement.createSVG();let ArrowDownIconElement=_ArrowDownIconElement;class TableBorderDimensionsUtils{static generateDefault(){return{leftWidth:0,rightWidth:0,topWidth:0,bottomWidth:0}}static getWidth(e,t){return""===e.style[t]?1:Number.parseFloat(e.style[t])||0}static generateUsingElement(e){return{leftWidth:TableBorderDimensionsUtils.getWidth(e,"borderLeftWidth"),rightWidth:TableBorderDimensionsUtils.getWidth(e,"borderRightWidth"),topWidth:TableBorderDimensionsUtils.getWidth(e,"borderTopWidth"),bottomWidth:TableBorderDimensionsUtils.getWidth(e,"borderBottomWidth")}}}const _UpdateIndexColumnWidth=class e{static wrapColumnTextAndGetDefaultWidth(e){const{_tableBodyElementRef:t,data:r,_tableDimensions:n}=e;return ExtractElements.textRowsArrFromTBody(t,r).forEach((e=>{e.children[0].classList.remove(IndexColumn.INDEX_CELL_OVERFLOW_CLASS)})),n.isColumnIndexCellTextWrapped=!0,ToggleAdditionElements.update(e,!0,AddNewColumnElement.toggle),IndexColumn.DEFAULT_WIDTH}static changeTableWidths(e,t){const r=t-e._tableDimensions.indexColumnWidth;e._tableDimensions.indexColumnWidth=t,TableElement.changeStaticWidthTotal(e._tableDimensions,r),StaticTableWidthUtils.changeWidthsBasedOnColumnInsertRemove(e,!0)}static changeCellAndTableWidths(t,r,n){const i=r.children[0];e.changeTableWidths(t,n),i.style.width=`${n}px`}static forceWrap(t,r){const n=e.wrapColumnTextAndGetDefaultWidth(t);e.changeCellAndTableWidths(t,r,n)}static shouldTextBeWrapped(e){return!e._tableDimensions.isColumnIndexCellTextWrapped&&TableDimensionsUtils.hasSetTableWidthBeenBreached(e)}static changeWidth(t,r,n){e.changeCellAndTableWidths(t,r,n),e.shouldTextBeWrapped(t)&&e.forceWrap(t,r)}static getCellWidth(e){return e.scrollWidth+(Number.parseInt(getComputedStyle(e).borderRightWidth)||0)}static temporarilySetFirstRowCellWithLastNumber(t,r,n){const i=t.textContent;t.id||(t.id=r?e.TEMPORARY_INDEX_NUMBER:e.TEMPORARY_INVISIBLE_INDEX_NUMBER),t.textContent=n.textContent,setTimeout((()=>{""!==t.id&&(t.textContent=i,t.removeAttribute("id"))}))}static getIndexColumnWidthWithAsyncFix(t,r,n){if(0===n.scrollWidth){const i=t.children[0];return e.temporarilySetFirstRowCellWithLastNumber(i,r,n),e.getCellWidth(i)}return e.getCellWidth(n)}static updateColumnWidthWhenOverflow(t,r,n){const i=!!t.dataStartsAtHeader,a=e.getIndexColumnWidthWithAsyncFix(r,i,n);if(t._tableDimensions.indexColumnWidth!==a&&0!==a){const n=a+(Browser.IS_FIREFOX?4:0);Browser.IS_SAFARI?setTimeout((()=>e.changeWidth(t,r,n))):e.changeWidth(t,r,n)}}static checkAutoColumnWidthUpdate(t,r){if(r.offsetWidth!==t._tableDimensions.indexColumnWidth){let n=r.offsetWidth;t.offsetWidth!==t.scrollWidth&&(n=e.wrapColumnTextAndGetDefaultWidth(t)),e.changeTableWidths(t,n)}}static updatedBasedOnTableStyle(t,r,n,i=!1){i?e.forceWrap(t,r):t._tableDimensions.preserveNarrowColumns||void 0!==t._tableDimensions.maxWidth?e.updateColumnWidthWhenOverflow(t,r,n):void 0!==t._tableDimensions.width&&e.checkAutoColumnWidthUpdate(t,n)}static getFirstVisibleRow(e){const{_pagination:t,_tableBodyElementRef:r,dataStartsAtHeader:n}=e;return n&&t?t.visibleRows[0]:null==r?void 0:r.children[0]}static updatedBasedOnVisiblity(t,r,n=!1){const i=e.getFirstVisibleRow(t);t._pagination&&t.filter?i?e.updatedBasedOnTableStyle(t,i,r,n):setTimeout((()=>{const i=e.getFirstVisibleRow(t);i&&e.updatedBasedOnTableStyle(t,i,r,n)})):i&&e.updatedBasedOnTableStyle(t,i,r,n)}static update(t,r,n=!1){var i;if(t._tableDimensions.isColumnIndexCellTextWrapped)return;if(!r){const{_tableBodyElementRef:e,data:n}=t;r=ExtractElements.textRowsArrFromTBody(e,n)}const a=null==(i=r[r.length-1])?void 0:i.children[0];a&&e.updatedBasedOnVisiblity(t,a,n)}static wrapTextWhenNarrowColumnsBreached(t){t._frameComponents.displayIndexColumn&&e.shouldTextBeWrapped(t)&&e.update(t,void 0,!0)}};_UpdateIndexColumnWidth.TEMPORARY_INDEX_NUMBER="temp-index-number",_UpdateIndexColumnWidth.TEMPORARY_INVISIBLE_INDEX_NUMBER="temp-invisible-index-number";let UpdateIndexColumnWidth=_UpdateIndexColumnWidth;const _IndexColumn=class e{static updateIndexes(e,t){const{_tableBodyElementRef:r,data:n,dataStartsAtHeader:i}=e,a=ExtractElements.textRowsArrFromTBody(r,n,t),s=Number(i);a.forEach(((e,r)=>{const n=e.children[0],i=t+r+s;n.innerText=String(i)})),UpdateIndexColumnWidth.update(e,0===a.length?void 0:a)}static createCell(t,r){var n,i;const{_tableDimensions:a,_defaultColumnsSettings:s,_frameComponents:{styles:o,cellColors:l,inheritHeaderColors:c}}=t,d=CellElement.createBaseCell(r);d.classList.add(e.INDEX_CELL_CLASS,GenericElementUtils.NOT_SELECTABLE_CLASS);const{displaySettings:u,canEditHeaderRow:p}=t.rowDropdown;return d.style.cursor=null==(n=u.openMethod)||!n.cellClick||r&&!p?"default":"pointer",a.isColumnIndexCellTextWrapped||d.classList.add(e.INDEX_CELL_OVERFLOW_CLASS),Object.assign(d.style,s.cellStyle,(null==o?void 0:o.default)||{}),r&&Object.assign(d.style,c?null==(i=s.headerStyles)?void 0:i.default:{},l.header.default),d}static createHeaderCell(t){const r=e.createCell(t,!0);return t.dataStartsAtHeader&&(r.innerText="1"),r.style.width=e.DEFAULT_WIDTH_PX,Browser.IS_SAFARI&&setTimeout((()=>r.style.width=e.DEFAULT_WIDTH_PX)),r}static createDataCell(t,r){const n=e.createCell(t,!1),i=t.dataStartsAtHeader?r+1:r;return n.innerText=String(i),n}static createAndPrependToRow(t,r,n){const i=0===n?e.createHeaderCell(t):e.createDataCell(t,n);t._columnsDetails[0]&&ColumnSettingsBorderUtils.unsetSubjectBorder([i],t._columnsDetails[0].elements,"right",0),r.appendChild(i)}};_IndexColumn.INDEX_CELL_CLASS="index-cell",_IndexColumn.INDEX_CELL_OVERFLOW_CLASS="index-cell-overflow",_IndexColumn.DEFAULT_WIDTH=30,_IndexColumn.DEFAULT_WIDTH_PX=`${_IndexColumn.DEFAULT_WIDTH}px`;let IndexColumn=_IndexColumn;const UNSET_NUMBER_IDENTIFIER=-1,_TableDimensionsUtils=class e{static setIsColumnIndexCellTextWrapped(e,t){t&&("object"==typeof t&&t.wrapIndexCellText?e.isColumnIndexCellTextWrapped=!0:void 0===e.isColumnIndexCellTextWrapped&&(e.isColumnIndexCellTextWrapped=!1))}static setPreserveNarrowColumnsProp(e,t){t.preserveNarrowColumns=e.preserveNarrowColumns}static setDimension(t,r){const{tableStyle:n,_tableDimensions:i,_tableElementRef:a,parentElement:s}=t;if(!a||!s)return;const o=StringDimensionUtils.generateNumberDimensionFromClientString(s,n,r,!0,e.MINIMAL_TABLE_WIDTH);o.number>0&&(t.overflow&&OverflowUtils.processNumberDimension(i,o),i[r]=o.number,i.isPercentage=o.isPercentage)}static setTableDimensions(t){const{tableStyle:r,_tableDimensions:n,_frameComponents:{displayIndexColumn:i}}=t;void 0!==r.width?e.setDimension(t,"width"):void 0!==r.maxWidth&&e.setDimension(t,"maxWidth"),e.setPreserveNarrowColumnsProp(t,n),e.setIsColumnIndexCellTextWrapped(n,i)}static hasSetTableWidthBeenBreached(e){const{width:t,maxWidth:r}=e._tableDimensions,n=e.offsetWidth,i=t||r;return!!i&&Math.ceil(i)<n}static record(e){e._tableDimensions.recordedParentWidth=e.parentElement.offsetWidth,e._tableDimensions.recordedParentHeight=e.parentElement.offsetHeight,e._tableDimensions.recordedWindowWidth=window.innerWidth,e._tableDimensions.recordedWindowHeight=window.innerHeight}static getDefault(){return{recordedParentWidth:0,recordedParentHeight:0,recordedWindowWidth:0,recordedWindowHeight:0,border:TableBorderDimensionsUtils.generateDefault(),staticWidth:UNSET_NUMBER_IDENTIFIER,newColumnWidth:140,indexColumnWidth:IndexColumn.DEFAULT_WIDTH}}};_TableDimensionsUtils.MINIMAL_TABLE_WIDTH=70;let TableDimensionsUtils=_TableDimensionsUtils;class MaximumRows{static canAddMore(e){var t;const{_columnsDetails:r,maxRows:n}=e,i=null==(t=r[0])?void 0:t.elements.length;return!(void 0!==i&&void 0!==n&&n>0&&n<=i)}}class FrameComponentsColors{static getInheritedHeaderColors(e){var t,r,n,i,a,s;const{_defaultColumnsSettings:{headerStyles:o,cellStyle:l}}=e;return{default:{backgroundColor:(null==(t=null==o?void 0:o.default)?void 0:t.backgroundColor)||(null==l?void 0:l.backgroundColor)||"",color:(null==(r=null==o?void 0:o.default)?void 0:r.color)||(null==l?void 0:l.color)||""},hover:{backgroundColor:(null==(n=null==o?void 0:o.hoverColors)?void 0:n.backgroundColor)||(null==(i=null==o?void 0:o.default)?void 0:i.backgroundColor)||(null==l?void 0:l.backgroundColor)||e._defaultCellHoverColors.backgroundColor,color:(null==(a=null==o?void 0:o.hoverColors)?void 0:a.color)||(null==(s=null==o?void 0:o.default)?void 0:s.color)||(null==l?void 0:l.color)||e._defaultCellHoverColors.color}}}static getHoverColorValue(e,t){var r,n,i;const{_frameComponents:{styles:a},_defaultCellHoverColors:s}=e;return(null==(r=null==a?void 0:a.hoverColors)?void 0:r[t])||(null==(n=null==a?void 0:a.default)?void 0:n[t])||(null==(i=e._defaultColumnsSettings.cellStyle)?void 0:i[t])||s[t]}static getDefaultColorValue(e,t){var r,n,i;return(null==(n=null==(r=e._frameComponents.styles)?void 0:r.default)?void 0:n[t])||(null==(i=e._defaultColumnsSettings.cellStyle)?void 0:i[t])||""}static setEventColors(e){const t={default:{backgroundColor:FrameComponentsColors.getDefaultColorValue(e,"backgroundColor"),color:FrameComponentsColors.getDefaultColorValue(e,"color")},hover:{backgroundColor:FrameComponentsColors.getHoverColorValue(e,"backgroundColor"),color:FrameComponentsColors.getHoverColorValue(e,"color")}},{_frameComponents:{cellColors:r,inheritHeaderColors:n}}=e;r.data=t,r.header=n?FrameComponentsColors.getInheritedHeaderColors(e):t}static getColorsBasedOnParam(e,t){const{data:r,header:n}=e;return 0===t?n:r}static getDefaultCellColors(){return{data:{default:{backgroundColor:"",color:""},hover:{backgroundColor:"",color:""}},header:{default:{backgroundColor:"",color:""},hover:{backgroundColor:"",color:""}}}}}class CellHighlightUtils{static fade(e,t){e.style.backgroundColor=(null==t?void 0:t.backgroundColor)||"",e.style.color=(null==t?void 0:t.color)||""}static highlight(e,t){null!=t&&t.backgroundColor&&(e.style.backgroundColor=t.backgroundColor),null!=t&&t.color&&(e.style.color=t.color)}static unsetDefaultHoverProperties(e){e.backgroundColor="",e.color=""}static getDefaultHoverProperties(){return{backgroundColor:"#f7f7f7",color:""}}}class ElementOffset{static processLeft(e,t){return Browser.IS_FIREFOX?e+=t.leftWidth:Browser.IS_SAFARI&&(e-=t.leftWidth),e}static processTop(e,t){return Browser.IS_FIREFOX?e+=t.topWidth:Browser.IS_SAFARI&&(e-=t.topWidth),e}static processWidth(e,t){return Browser.IS_FIREFOX&&(e+=t.leftWidth),e}}class VisibilityUtils{static headerChanged(e){setTimeout((()=>{e._visiblityInternal.filters&&FilterInternalUtils.resetAllInputs(e)}))}static completeReset(e){e._visiblityInternal.filters&&FilterInternalUtils.completeReset(e)}}const _CaretDisplayFix=class e{static removeContentEditable(t){t.removeAttribute(e.CONTENT_EDITABLE)}static setContentEditable(t){t.setAttribute(e.CONTENT_EDITABLE,"true")}static removeTabIndex(t){t.removeAttribute(e.TAB_INDEX)}static setTabIndex(t){t.setAttribute(e.TAB_INDEX,"0")}static removeBRPadding(t,r){const n=CellElement.getTextElement(r).childNodes[0];n.tagName===e.BR_TAG_NAME&&(n.remove(),CaretPosition.setToEndOfText(t,r))}static addBRPaddingToEmptyCell(t,r){const n=CellElement.getTextElement(t);r===EMPTY_STRING&&0===n.childNodes.length&&n.appendChild(document.createElement(e.BR_TAG_NAME))}static toggleCellTextBRPadding(t,r,n){const i=CellElement.getText(r);n&&i!==EMPTY_STRING?e.removeBRPadding(t,r):e.addBRPaddingToEmptyCell(r,i)}static isIssueBrowser(){return Browser.IS_FIREFOX||Browser.IS_SAFARI}};_CaretDisplayFix.CONTENT_EDITABLE="contenteditable",_CaretDisplayFix.TAB_INDEX="tabindex",_CaretDisplayFix.BR_TAG_NAME="BR";let CaretDisplayFix=_CaretDisplayFix;const _CellTextElement=class e{static set(e,t){e.innerText="",e.contentEditable="false",CaretDisplayFix.isIssueBrowser()&&CaretDisplayFix.removeTabIndex(e),e.appendChild(t)}static createTextElement(t,r){const n=document.createElement("div");return n.innerText=t,""===t&&CaretDisplayFix.addBRPaddingToEmptyCell(n,""),n.classList.add(e.CELL_TEXT_DIV_CLASS),CellElement.prepContentEditable(n,r),n}static setCellTextAsAnElement(t,r){const n=CellElement.getText(t),i=e.createTextElement(n,r);return e.set(t,i),i}};_CellTextElement.CELL_TEXT_DIV_CLASS="cell-text-div";let CellTextElement=_CellTextElement;const _HeaderIconCellElement=class e{static createTextElement(t,r){const n=CellTextElement.setCellTextAsAnElement(t,r);return n.classList.add(e.TEXT_CLASS),n.style.pointerEvents=r?"":"none",n}static setScale(e,t){const r=`scale(${(null==t?void 0:t.x)||1.2}, ${(null==t?void 0:t.y)||1.2})`;e.style.transform=r,e.style.webkitTransform=r}static createSvgIcon(t,r){var n,i;const a=SVGIconUtils.createSVGElement(t.svgString);return e.setScale(a,null==(n=r.headerIconStyle)?void 0:n.scale),a.style.filter=(null==(i=r.headerIconStyle)?void 0:i.filterColor)||SVGIconUtils.HEADER_FILTER,a}static createSVGContainer(t){const r=document.createElement("div"),{containerStyles:n}=t;return null!=n&&n.dropdown&&Object.assign(r.style,null==n?void 0:n.dropdown),null!=n&&n.headerCorrections&&Object.assign(r.style,null==n?void 0:n.headerCorrections),r.classList.add(e.ICON_CONTAINER_CLASS),r}static createSVG(t,r){const n=e.createSVGContainer(t),i=e.createSvgIcon(t,r);return n.appendChild(i),n}static changeHeaderIcon(t){const{elements:r,activeType:n,settings:i}=t,a=e.createSVG(n.dropdownItem.settings.iconSettings,i),s=r[0];s.replaceChild(a,s.children[0])}static setHeaderIconStructure(t,r,n){var i,a,s;const{activeType:o,settings:l}=t._columnsDetails[n],c=e.createSVG(o.dropdownItem.settings.iconSettings,l),d=null==(s=null==(a=null==(i=t._defaultColumnsSettings.columnDropdown)?void 0:i.displaySettings)?void 0:a.openMethod)?void 0:s.cellClick,u=l.isHeaderTextEditable&&!d,p=e.createTextElement(r,u);r.insertBefore(c,p)}};_HeaderIconCellElement.TEXT_CLASS="header-icon-side-text",_HeaderIconCellElement.ICON_CONTAINER_CLASS="header-icon-container";let HeaderIconCellElement=_HeaderIconCellElement;const _DateCellInputElement=class e{static isInputElement(t){return(null==t?void 0:t.type)===e.ELEMENT_TYPE}static toggle(e,t){e&&(e.children[1].style.display=t?"block":"none")}static extractInputElementFromCell(e){return e.children[1].children[0]}static convertTextToInputValue(e,t){if(t.calendar&&(void 0===t.textValidation.func||t.textValidation.func(e))){const r=t.calendar.toYMDFunc(e);return[r[0],r[1].padStart(2,"0"),r[2].padStart(2,"0")].join("-")}return"-"}static updateInputBasedOnTextDiv(t,r){const n=e.convertTextToInputValue(CellElement.getText(t),r);e.extractInputElementFromCell(t).value=n}static createInputElement(t,r){const n=document.createElement("input");return n.type=e.ELEMENT_TYPE,n.classList.add(e.DATE_INPUT_CLASS),n.value=e.convertTextToInputValue(t,r),n}static createInputElementContainer(){const t=document.createElement("div");return t.classList.add(e.DATE_INPUT_CONTAINER_CLASS),t.style.display="none",t}static addDateInputElement(t,r,n){const i=e.createInputElementContainer(),a=e.createInputElement(CellElement.getText(r),n);i.appendChild(a);const s=DateCellCalendarIconElement.get();i.appendChild(s),t.appendChild(i)}};_DateCellInputElement.ELEMENT_TYPE="date",_DateCellInputElement.DATE_INPUT_CLASS="date-input",_DateCellInputElement.DATE_INPUT_CONTAINER_CLASS="date-input-container";let DateCellInputElement=_DateCellInputElement;class DateCellTextElement{static convertInputValueToText(e,t,r){const n=RegexUtils.extractIntegerStrs(e);return n?r.fromYMDFunc(n):t}static setCellTextAsAnElement(e,t){const r=CellTextElement.setCellTextAsAnElement(e,t);return r.style.float="left",r}}const _DateCellCalendarIconEvents=class e{static mouseDownIcon(t,r,n){const{_focusedElements:i,_activeOverlayElements:a}=this,s=n.target.previousSibling,o=CellElement.getCellElement(s);setTimeout((()=>{FocusedCellUtils.set(i.cell,o,t,r),a.datePickerCell=o,Browser.IS_SAFARI?s.dispatchEvent(new MouseEvent("click")):s.showPicker()}),e.PICKER_DISPLAY_DELAY_ML)}static setEvents(t,r,n,i){r.onmousedown=e.mouseDownIcon.bind(t,n,i)}};_DateCellCalendarIconEvents.PICKER_DISPLAY_DELAY_ML=Browser.IS_FIREFOX?190:0;let DateCellCalendarIconEvents=_DateCellCalendarIconEvents;var MOUSE_EVENT=(e=>(e.DOWN="Down",e))(MOUSE_EVENT||{});class DateCellInputEvents{static escapeKeyInput(e){if(e._activeOverlayElements.datePickerCell){const t=e._focusedElements.cell.element;e._hoveredElements.dateCell!==t&&DateCellInputElement.toggle(t,!1),delete e._activeOverlayElements.datePickerCell}}static inputInput(e,t,r){const{elements:n,settings:{defaultText:i},activeType:{calendar:a}}=this._columnsDetails[t];if(!a)return;const s=r.target.value,o=DateCellTextElement.convertInputValueToText(s,i,a),l=n[e];CellEvents.updateCell(this,o,e,t,{element:l})}static changeInput(){const e=this._focusedElements.cell.element;!this._userKeyEventsState[MOUSE_EVENT.DOWN]&&this._hoveredElements.dateCell!==e&&DateCellInputElement.toggle(e,!1),delete this._activeOverlayElements.datePickerCell}static setEvents(e,t,r,n){t.onchange=DateCellInputEvents.changeInput.bind(e),t.oninput=DateCellInputEvents.inputInput.bind(e,r,n)}}class FocusNextColumnCellFromTextDiv{static focusDifferentColumnCell(e,t,r){const{elements:n,activeType:i,settings:a}=e._columnsDetails[t],s=n[r];if(!a.isCellTextEditable||0===r&&!a.isHeaderTextEditable||Browser.IS_SAFARI&&CheckboxCellElement.isCheckboxCell(s))return FocusNextColumnCellFromTextDiv.focusOrBlurNext(e,t,r);i.cellDropdownProps?s.dispatchEvent(new Event("mousedown")):(CellWithTextEvents.programmaticBlur(e),CellElement.getTextElement(s).focus()),s.scrollIntoView({block:"nearest"})}static focusOrBlurNextRowFirstCell(e,t){const r=t+1;e._columnsDetails[0].elements[r]?FocusNextColumnCellFromTextDiv.focusDifferentColumnCell(e,0,r):e._focusedElements.cell.element.children[0].blur()}static focusOrBlurNext(e,t,r){e._columnsDetails[t+1]?FocusNextColumnCellFromTextDiv.focusDifferentColumnCell(e,t+1,r):FocusNextColumnCellFromTextDiv.focusOrBlurNextRowFirstCell(e,r)}}class CellTextEvents{static tabOutOfCell(e,t,r,n){n.preventDefault(),DataCellEvents.keyDownCell.bind(e,t,r)(n),FocusNextColumnCellFromTextDiv.focusOrBlurNext(e,r,t)}}class DateCellTextEvents{static keyDownOnText(e,t,r){r.key===KEYBOARD_KEY.TAB&&CellTextEvents.tabOutOfCell(this,e,t,r)}static inputText(e,t){if(Browser.IS_INPUT_DATE_SUPPORTED){const{activeType:r}=this._columnsDetails[e],n=CellElement.getCellElement(t.target);DateCellInputElement.updateInputBasedOnTextDiv(n,r)}}static blurText(e,t,r){const n=r.target;DataCellEvents.blur(this,e,t,n)}static setEvents(e,t,r,n){e._columnsDetails[n].settings.isCellTextEditable&&(t.onfocus=CellWithTextEvents.focusText.bind(e,r,n,null),t.onblur=DateCellTextEvents.blurText.bind(e,r,n),t.oninput=DateCellTextEvents.inputText.bind(e,n),t.onkeydown=DateCellTextEvents.keyDownOnText.bind(e,r,n))}}class DateCellEvents{static mouseLeaveCell(e){if(delete this._hoveredElements.dateCell,Browser.IS_INPUT_DATE_SUPPORTED){const t=e.target;if(this._activeOverlayElements.datePickerCell===t)return;DateCellInputElement.toggle(t,!1)}}static mouseEnterCell(e){this._hoveredElements.dateCell=e.target,Browser.IS_INPUT_DATE_SUPPORTED&&DateCellInputElement.toggle(this._hoveredElements.dateCell,!0)}static setEvents(e,t,r,n){if(!e._columnsDetails[n].settings.isCellTextEditable)return;t.onblur=()=>{},t.onfocus=()=>{},t.onmouseenter=DateCellEvents.mouseEnterCell.bind(e),t.onmouseleave=DateCellEvents.mouseLeaveCell.bind(e),t.onmousedown=CellWithTextEvents.mouseDown.bind(e,null);const i=t.children[0];if(DateCellTextEvents.setEvents(e,i,r,n),Browser.IS_INPUT_DATE_SUPPORTED){const i=t.children[1];DateCellInputEvents.setEvents(e,i,r,n);const a=i.children[1];DateCellCalendarIconEvents.setEvents(e,a,r,n)}}}class DateCellElement{static setCellDateStructure(e,t,r){ConvertCellTypeUtils.preprocessCell(t),t.style.cursor="text";const{isCellTextEditable:n}=e._columnsDetails[r].settings,i=DateCellTextElement.setCellTextAsAnElement(t,n);Browser.IS_INPUT_DATE_SUPPORTED&&DateCellInputElement.addDateInputElement(t,i,e._columnsDetails[r].activeType)}static setColumnDateStructure(e,t){CellStructureUtils.setColumn(e,t,DateCellElement.setCellDateStructure,DateCellEvents.setEvents)}}const _SelectCellTextElement=class e{static setCellTextAsAnElement(t,r,n){const{isCellTextEditable:i}=t._columnsDetails[n].settings;CellTextElement.setCellTextAsAnElement(r,i).classList.add(e.TEXT_CLASS)}static finaliseEditedText(e,t,r){var n,i;const a=e._columnsDetails[r],{cellDropdown:s,activeType:o,settings:l}=a,c=CellElement.getText(t),d=!(null==(n=s.itemsDetails[c])||!n.backgroundColor);null!=(i=o.cellDropdownProps)&&i.canAddMoreOptions&&c!==EMPTY_STRING&&!d&&(!l.isDefaultTextRemovable||c!==l.defaultText)&&CellDropdownItem.addNewItem(e,t,a,t.style.backgroundColor)}};_SelectCellTextElement.TEXT_CLASS="select-cell-text";let SelectCellTextElement=_SelectCellTextElement;class SelectCellBaseEvents{static blurIfDropdownFocused(e){e._focusedElements.cellDropdown&&CellWithTextEvents.programmaticBlur(e)}}class SelectCellEvents{static mouseLeaveCell(e,t){delete this._hoveredElements.selectCell;const r=t.target,{cellDropdown:n}=this._columnsDetails[e];(!Dropdown.isDisplayed(n.element)||n.displayedCellElement!==r)&&ArrowDownIconElement.toggle(r,!1)}static mouseEnterCell(e){this._hoveredElements.selectCell=e.target,ArrowDownIconElement.toggle(this._hoveredElements.selectCell,!0)}static mouseDownCell(e){var t;const r=e.target;if(r.classList.contains(CellElement.CELL_CLASS))CellWithTextEvents.mouseDownCell(this,SelectCellBaseEvents.blurIfDropdownFocused,r,e);else if(r.classList.contains(ArrowDownIconElement.ARROW_ICON_CLASS)){const n=null==(t=r.parentElement)?void 0:t.parentElement;CellWithTextEvents.mouseDownCell(this,SelectCellBaseEvents.blurIfDropdownFocused,n,e)}}static setEvents(e,t,r,n){if(!e._columnsDetails[n].settings.isCellTextEditable)return;t.onblur=()=>{},t.onfocus=()=>{},t.onmouseenter=SelectCellEvents.mouseEnterCell.bind(e),t.onmouseleave=SelectCellEvents.mouseLeaveCell.bind(e,n),t.onmousedown=SelectCellEvents.mouseDownCell.bind(e);const i=t.children[0];SelectCellTextBaseEvents.setEvents(e,i,r,n)}}class SelectCellElement{static setCellSelectStructure(e,t,r){ConvertCellTypeUtils.preprocessCell(t),SelectCellTextElement.setCellTextAsAnElement(e,t,r),t.appendChild(ArrowDownIconElement.get()),SelectCell.setPointerCursorIfCantAdd(t,e._columnsDetails[r].activeType)}static setColumnSelectStructure(e,t){CellStructureUtils.setColumn(e,t,SelectCellElement.setCellSelectStructure,SelectCellEvents.setEvents)}}class LabelCellEvents{static setEvents(e,t,r,n){if(!e._columnsDetails[n].settings.isCellTextEditable)return;t.onblur=()=>{},t.onfocus=()=>{},t.onmouseenter=()=>{},t.onmouseleave=()=>{},t.onmousedown=CellWithTextEvents.mouseDown.bind(e,SelectCellBaseEvents.blurIfDropdownFocused);const i=t.children[0];SelectCellTextBaseEvents.setEvents(e,i,r,n)}}class LabelCellElement{static setCellLabelStructure(e,t,r){var n;ConvertCellTypeUtils.preprocessCell(t);const{cellDropdown:{itemsDetails:i},settings:{isCellTextEditable:a}}=e._columnsDetails[r],s=(null==(n=i[CellElement.getText(t)])?void 0:n.backgroundColor)||"";LabelCellTextElement.setCellTextAsAnElement(t,s,a),SelectCell.setPointerCursorIfCantAdd(t,e._columnsDetails[r].activeType)}static setColumnLabelStructure(e,t){CellStructureUtils.setColumn(e,t,LabelCellElement.setCellLabelStructure,LabelCellEvents.setEvents)}}class SelectCell{static convertCell(e,t,r){var n;null!=(n=e._columnsDetails[t].activeType.cellDropdownProps)&&n.isBasicSelect?SelectCellElement.setCellSelectStructure(e,r,t):LabelCellElement.setCellLabelStructure(e,r,t)}static convertColumn(e,t,r){var n;null!=(n=r.cellDropdownProps)&&n.isBasicSelect?SelectCellElement.setColumnSelectStructure(e,t):LabelCellElement.setColumnLabelStructure(e,t)}static setEvents(e,t,r,n){var i;const{activeType:a}=e._columnsDetails[n];null!=(i=a.cellDropdownProps)&&i.isBasicSelect?SelectCellEvents.setEvents(e,t,r,n):LabelCellEvents.setEvents(e,t,r,n)}static finaliseEditedText(e,t,r,n=!1){var i;const{activeType:a}=e._columnsDetails[r];null!=(i=a.cellDropdownProps)&&i.isBasicSelect?SelectCellTextElement.finaliseEditedText(e,t,r):LabelCellTextElement.finaliseEditedText(e,t,r,n)}static setPointerCursorIfCantAdd(e,t){var r;if(e.style.cursor="pointer",null==(r=t.cellDropdownProps)||!r.canAddMoreOptions){const t=e.children[0];t.style.caretColor="transparent",t.style.cursor="pointer"}}}class DataCellElement{static setCellDataStructure(e,t,r){t.innerText=CellElement.getTextElement(t).innerText;const{isCellTextEditable:n}=e._columnsDetails[r].settings;CellElement.prepContentEditable(t,n)}static setColumnDataStructure(e,t){CellStructureUtils.setColumn(e,t,DataCellElement.setCellDataStructure,DataCellEvents.setEvents)}}class ChangeColumnType{static setInvalidCellToDefault(e,t,r){const n=t+1,i=e._columnsDetails[r].elements[n];return CellEvents.setCellToDefaultIfNeeded(e,n,r,i,!1)}static setInvalidCellsToDefault(e,t){let r=!1;e.data.slice(1).forEach(((n,i)=>{ChangeColumnType.setInvalidCellToDefault(e,i,t)&&!r&&(r=!0)})),r&&setTimeout((()=>FireEvents.onDataUpdate(e)))}static setNew(e,t,r){const n=e._columnsDetails[r];return n.activeType=n.settings.types.find((e=>e.name===t)),n.activeType}static setNewStructureBasedOnType(e,t,r){delete e._columnsDetails[t].cellDropdown.labelDetails,r.cellDropdownProps?(CellDropdown.setUpDropdown(e,t),SelectCell.convertColumn(e,t,r)):r.calendar?DateCellElement.setColumnDateStructure(e,t):r.checkbox?CheckboxCellElement.setColumnCheckboxStructure(e,t):DataCellElement.setColumnDataStructure(e,t)}static resetCheckboxElements(e){e.elements.slice(1).forEach((e=>{e.innerText=CellElement.getText(e)}))}static resetAndChangeFunc(e,t,r){const n=e._columnsDetails[r];n.activeType.checkbox&&ChangeColumnType.resetCheckboxElements(n);const i=ChangeColumnType.setNew(e,t,r);i.textValidation.func&&i.textValidation.setTextToDefaultOnFail&&ChangeColumnType.setInvalidCellsToDefault(e,r),ChangeColumnType.setNewStructureBasedOnType(e,r,i),e.displayHeaderIcons&&HeaderIconCellElement.changeHeaderIcon(e._columnsDetails[r]),setTimeout((()=>FireEvents.onColumnsUpdate(e)))}static change(e,t){e!==this._columnsDetails[t].activeType.name&&ProcessedDataTextStyle.resetDataCellsStyle(this,t,ChangeColumnType.resetAndChangeFunc.bind(this,this,e,t))}}class CheckboxValidationFunc{static getDefault(){return e=>{const t=String(e).trim().toLocaleLowerCase();return""===t||"0"===t||"00"===t||"false"===t?"false":"true"}}}const CURRENCY_ICON_SVG_STRING='<?xml version="1.0" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="16">\n\t<g transform="matrix(0.84210527 0 0 0.84210527 0 0)">\n\t\t<g transform="matrix(0.027142858 0 0 0.027142858 0 0)">\n\t\t\t<g>\n\t\t\t\t<path d="M441.1 297.29C 422.358 282.915 397.057 271.728 364.155 263.138L364.155 263.138L364.155 113.058C 378.792 114.1439 405.382 119.14 452.362 140.058C 458.8308 142.9291 466.339 142.1322 472.061 137.97209C 477.7837 133.81189 480.854 126.91709 480.1157 119.87809C 479.38132 112.84289 474.9477 106.73009 468.4867 103.843094C 413.2097 79.230095 381.8067 74.17909 364.15668 73.300095L364.15668 73.300095L364.15668 42.152092C 364.15668 34.335693 357.82077 27.996092 350.00067 27.996092C 342.18057 27.996092 335.84467 34.33589 335.84467 42.152092L335.84467 42.152092L335.84467 73.93709C 307.65366 76.28479 280.86768 87.23009 259.09866 105.29208C 234.52066 125.13208 220.09067 154.91309 219.75467 186.49509C 219.5242 216.7761 234.14967 245.24908 258.89966 262.7021C 277.64166 277.0771 302.94266 288.2641 335.84467 296.8541L335.84467 296.8541L335.84467 446.93408C 321.20767 445.84818 294.60666 440.84818 247.63766 419.93408L247.63766 419.93408L247.63766 419.93018C 241.16887 417.05908 233.66066 417.856 227.93866 422.01608C 222.21596 426.17627 219.14566 433.07108 219.88396 440.11008C 220.61833 447.14526 225.05196 453.2581 231.51295 456.14508C 286.72797 480.73108 318.18097 485.80908 335.84296 486.69608L335.84296 486.69608L335.84296 517.8371C 335.84296 525.6535 342.17886 531.9931 349.99896 531.9931C 357.81906 531.9931 364.15497 525.6533 364.15497 517.8371L364.15497 517.8371L364.15497 486.0521C 392.34598 483.7044 419.13196 472.7591 440.90097 454.69708C 465.47897 434.8571 479.90897 405.07608 480.24496 373.49408C 480.47543 343.21307 465.84998 314.74008 441.09998 297.28708L441.09998 297.28708L441.1 297.29zM282.99 231.22801C 268.099 221.23581 259.232 204.42702 259.392 186.49802C 259.81778 166.59201 269.1029 147.90802 284.712 135.54501C 299.302 123.52501 317.06 115.99001 335.841 113.85401L335.841 113.85401L335.841 255.71402C 316.907 250.75702 299.013 242.46402 282.989 231.22601zM415.27997 424.448L415.28387 424.448C 400.69388 436.468 382.93588 444.003 364.15488 446.139L364.15488 446.139L364.15488 304.279C 383.08887 309.236 400.98288 317.529 417.00687 328.767C 431.89786 338.7592 440.76486 355.568 440.60486 373.497C 440.17908 393.403 430.89395 412.087 415.28485 424.45z" stroke="none" fill="#000000" fill-rule="nonzero" />\n\t\t\t</g>\n\t\t</g>\n\t</g>\n</svg>',CHECKBOX_ICON_SVG_STRING='<?xml version="1.0" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="13" height="13">\n  <g transform="matrix(0.68421054 0 0 0.68421054 0 0)">\n    <g transform="matrix(0.027142858 0 0 0.027142858 0 0)">\n      <g>\n        <path d="M521.77 0L178.24002 0C 119.416016 0 70.01002 49.41 70.01002 108.23L70.01002 108.23L70.01002 454.11002C 70.01002 512.934 119.42001 562.34 178.24002 562.34L178.24002 562.34L524.12 562.34C 582.944 562.34 632.35 512.93005 632.35 454.11002L632.35 454.11002L632.35 108.23001C 629.99835 49.40601 582.94 7.6293945E-06 521.76 7.6293945E-06L521.76 7.6293945E-06L521.77 0zM587.653 451.77C 587.653 487.063 559.419 515.30096 524.122 515.30096L524.122 515.30096L178.242 515.29706C 142.949 515.29706 114.711006 487.06305 114.711006 451.76605L114.711006 451.76605L114.71491 108.23605C 114.71491 72.943054 142.94891 44.705055 178.24591 44.705055L178.24591 44.705055L524.1259 44.705055C 559.41895 44.705055 587.6569 72.93906 587.6569 108.23605z" stroke="none" fill="#010101" fill-rule="nonzero" />\n        <path d="M479.41 164.71L293.53 350.59003L222.94 280.00003C 213.5298 270.58984 201.764 270.58984 192.35 280.00003C 182.9398 289.41022 182.9398 301.17603 192.35 310.59003L192.35 310.59003L279.409 397.64902C 281.7684 400.0006 286.4715 402.3521 293.534 402.3521C 300.5926 402.3521 305.3 400.00052 307.651 395.29352L307.651 395.29352L510.001 192.94351C 517.05963 185.88492 517.05963 171.76752 510.001 164.70952C 500.59082 155.29543 486.47 155.29543 479.411 164.70952L479.411 164.70952L479.41 164.71z" stroke="none" fill="#010101" fill-rule="nonzero" />\n      </g>\n    </g>\n  </g>\n</svg>',SELECT_ICON_SVG_STRING='<?xml version="1.0" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="14">\n\t<g transform="matrix(0.9 0 0 0.93333334 0 0)">\n\t\t<g transform="matrix(0.03 0 0 0.03 2.5000005 -0)">\n\t\t\t<g transform="matrix(1 0 0 1 -86.77152 -33.81399)">\n\t\t\t\t<g transform="matrix(1 0 0 1 -13.737094 17.33647)">\n\t\t\t\t\t<path d="M399.537 218.885L277.33 218.885C 262.315 218.885 254.544 236.996 265.421 247.859L265.421 247.859L328.596 310.981C 335.328 317.708 346.201 317.708 352.933 310.466L352.933 310.466L411.966 247.343C 421.805 236.476 414.555 218.885 399.537 218.885z" stroke="none" fill="#000000" fill-rule="nonzero" />\n\t\t\t\t\t<path d="M340.559 56.069C 226.133 56.069 128.026 151.307 128.026 265.753C 128.026 380.198 224.339 475.408 338.765 475.408C 453.191 475.408 547.665 380.561 547.665 266.116C 547.665 151.67 454.985 56.069 340.559 56.069zM338.765 452.542C 235.73 452.542 152.37 369.168 152.37 266.116C 152.37 163.063 235.73 79.689 338.765 79.689C 441.8 79.689 525.16 163.063 525.16 266.116C 525.157 369.168 441.797 452.542 338.765 452.542z" stroke="none" fill="#000000" fill-rule="nonzero" />\n\t\t\t\t</g>\n\t\t\t</g>\n\t\t</g>\n\t</g>\n</svg>',NUMBER_ICON_SVG_STRING='<?xml version="1.0" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14">\n\t<g transform="matrix(0.7368421 0 0 0.7368421 0 0)">\n\t\t<g transform="matrix(0.027142858 0 0 0.027142858 0 0)">\n\t\t\t<path d="M577.5 175L471.36 175L489.78598 55.160004C 490.4813 49.101402 487.96957 43.117004 483.15707 39.367004C 478.34848 35.620903 471.93008 34.644302 466.22308 36.796703C 460.51608 38.949005 456.34418 43.917805 455.2071 49.909702L455.2071 49.909702L435.9371 174.9997L296.35712 174.9997L314.7831 55.1597C 315.66983 50.4917 314.61905 45.6597 311.87292 41.7807C 309.12292 37.901802 304.91592 35.308 300.21692 34.5971C 295.51773 33.88226 290.7325 35.11272 286.95493 37.999397C 283.18152 40.886097 280.74402 45.186897 280.20493 49.909397L280.20493 49.909397L260.93494 174.99939L157.49493 174.99939C 151.24103 174.99939 145.46393 178.3353 142.33893 183.74939C 139.21393 189.16348 139.21393 195.83539 142.33893 201.24939C 145.46393 206.66339 151.24123 209.99939 157.49493 209.99939L157.49493 209.99939L255.49493 209.99939L234.02194 349.9994L122.49194 349.9994C 116.238045 349.9994 110.460945 353.3353 107.335945 358.7494C 104.210945 364.16348 104.210945 370.8354 107.335945 376.2494C 110.460945 381.6634 116.23824 384.9994 122.49194 384.9994L122.49194 384.9994L228.63194 384.9994L210.20595 504.8394C 209.31923 509.5074 210.37001 514.33936 213.11615 518.2184C 215.86615 522.0973 220.07315 524.6911 224.77216 525.402C 229.47136 526.1168 234.25656 524.88635 238.03415 521.9997C 241.80756 519.113 244.24506 514.8122 244.78415 510.0897L244.78415 510.0897L264.05414 384.9997L403.63416 384.9997L385.20816 504.8397C 384.32144 509.5077 385.37222 514.3397 388.11835 518.2187C 390.86835 522.0976 395.07535 524.6914 399.77435 525.4023C 404.47354 526.1171 409.25876 524.88666 413.03635 522C 416.80975 519.1133 419.24725 514.8125 419.78635 510.09L419.78635 510.09L439.05634 385L542.49634 385C 548.75024 385 554.52734 381.6641 557.65234 376.25C 560.77734 370.8359 560.77734 364.164 557.65234 358.75C 554.52734 353.336 548.75006 350 542.49634 350L542.49634 350L444.49634 350L466.03934 210L577.4993 210C 583.75323 210 589.53033 206.6641 592.65533 201.25C 595.78033 195.8359 595.78033 189.164 592.65533 183.75C 589.53033 178.336 583.75305 175 577.4993 175L577.4993 175L577.5 175zM430.5 210L408.957 350L269.497 350L291.04 210z" stroke="none" fill="#000000" fill-rule="nonzero" />\n\t\t</g>\n\t</g>\n</svg>',LABEL_ICON_SVG_STRING='<?xml version="1.0" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14">\n\t<g transform="matrix(0.7368421 0 0 0.7368421 0 0)">\n\t\t<g transform="matrix(0.027142858 0 0 0.027142858 0 0)">\n\t\t\t<g>\n\t\t\t\t<path d="M279.16 122.86L470.53 122.86L470.53 95.829C 470.53 82.16901 464.9362 69.755005 455.913 60.735C 446.8896 51.7116 434.475 46.118 420.835 46.118L420.835 46.118L165.825 46.118C 152.165 46.118 139.75099 51.7118 130.73099 60.735C 121.70759 69.7584 116.11399 82.173004 116.11399 95.829L116.11399 95.829L116.11399 350.839C 116.11399 364.47998 121.707794 376.913 130.73099 385.917C 139.7544 394.9404 152.16899 400.534 165.82498 400.534L165.82498 400.534L192.85599 400.534L192.85599 209.164C 192.85599 185.41 202.5669 163.836 218.19199 148.195C 233.81708 132.55402 255.40298 122.85901 279.16098 122.85901L279.16098 122.85901L279.16 122.86zM507.14 122.86L534.171 122.86C 557.92505 122.86 579.499 132.5709 595.14 148.196C 610.765 163.821 620.476 185.407 620.476 209.16501L620.476 209.16501L620.476 464.175C 620.476 487.929 610.76514 509.503 595.14 525.144C 579.499 540.785 557.929 550.48 534.171 550.48L534.171 550.48L279.161 550.48C 255.40701 550.48 233.83301 540.7691 218.19202 525.144C 202.55103 509.51886 192.85602 487.93298 192.85602 464.175L192.85602 464.175L192.85602 437.14398L165.82501 437.14398C 142.07101 437.14398 120.49701 427.43307 104.85601 411.80798C 89.23101 396.18298 79.52001 374.597 79.52001 350.839L79.52001 350.839L79.52001 95.828995C 79.52001 72.075 89.23091 50.500996 104.85601 34.859993C 120.49701 19.234993 142.06702 9.523993 165.82501 9.523993L165.82501 9.523993L420.83502 9.523993C 444.58902 9.523993 466.16302 19.234894 481.80402 34.859993C 497.445 50.50099 507.14 72.07099 507.14 95.828995zM534.171 159.469L279.161 159.469C 265.52002 159.469 253.087 165.06279 244.08301 174.086C 235.0596 183.1094 229.466 195.524 229.466 209.18L229.466 209.18L229.466 464.19C 229.466 477.831 235.0598 490.264 244.08301 499.284C 253.10641 508.3074 265.521 513.901 279.161 513.901L279.161 513.901L534.171 513.901C 547.831 513.901 560.245 508.3072 569.265 499.284C 578.2884 490.2606 583.882 477.846 583.882 464.19L583.882 464.19L583.882 209.18001C 583.882 195.539 578.2882 183.106 569.265 174.086C 560.24164 165.06259 547.827 159.469 534.171 159.469z" stroke="none" fill="#000000" fill-rule="nonzero" />\n\t\t\t</g>\n\t\t</g>\n\t</g>\n</svg>',TEXT_ICON_SVG_STRING='<?xml version="1.0" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="12" height="12">\n  <g transform="matrix(0.6315789 0 0 0.6315789 0 0)">\n    <g transform="matrix(0.027142858 0 0 0.027142858 0 0)">\n      <g>\n        <path d="M84 32.48L616 32.48L616 92.96L84 92.96L84 32.48z" stroke="none" fill="#000000" fill-rule="nonzero" />\n        <path d="M84 177.52L470.4 177.52L470.4 238L84 238L84 177.52z" stroke="none" fill="#000000" fill-rule="nonzero" />\n        <path d="M84 322.56L616 322.56L616 383.04L84 383.04L84 322.56z" stroke="none" fill="#000000" fill-rule="nonzero" />\n        <path d="M84 467.6L470.4 467.6L470.4 528.08L84 528.08L84 467.6z" stroke="none" fill="#000000" fill-rule="nonzero" />\n      </g>\n    </g>\n  </g>\n</svg>';var DEFAULT_COLUMN_TYPES=(e=>(e.TEXT="Text",e.NUMBER="Number",e.CURRENCY="Currency",e.DATE_DMY="Date d-m-y",e.DATE_MDY="Date m-d-y",e.CHECKBOX="Checkbox",e.SELECT="Select",e.LABEL="Label",e))(DEFAULT_COLUMN_TYPES||{});const _CalendarFunctionalityUtils=class{static mdYCellTextToYMD(e){const t=RegexUtils.extractIntegerStrs(e);return[t[2],t[0],t[1]]}static yMDToMDYCellText(e){return[e[1],e[2],e[0]].join("-")}static dMYCellTextToYMD(e){const t=RegexUtils.extractIntegerStrs(e);return[t[2],t[1],t[0]]}static yMDToDMYCellText(e){return[e[2],e[1],e[0]].join("-")}};_CalendarFunctionalityUtils.DEFAULT_TYPES_FUNCTIONALITY={[DEFAULT_COLUMN_TYPES.DATE_DMY]:{toYMDFunc:e=>_CalendarFunctionalityUtils.dMYCellTextToYMD(e),fromYMDFunc:e=>_CalendarFunctionalityUtils.yMDToDMYCellText(e)},[DEFAULT_COLUMN_TYPES.DATE_MDY]:{toYMDFunc:e=>_CalendarFunctionalityUtils.mdYCellTextToYMD(e),fromYMDFunc:e=>_CalendarFunctionalityUtils.yMDToMDYCellText(e)}};let CalendarFunctionalityUtils=_CalendarFunctionalityUtils;const _Validation=class{static setSelectValidation(e,t,r){var n,i;if(null==(n=e.cellDropdownProps)||!n.options||null!=(i=e.cellDropdownProps)&&i.canAddMoreOptions)return;const a=new Set(e.cellDropdownProps.options.map((e=>e.text)));e.textValidation??(e.textValidation={}),e.textValidation.func=e=>!!a.has(e)||!t&&e===r}};_Validation.DEFAULT_TYPES_REGEX={[DEFAULT_COLUMN_TYPES.CURRENCY]:new RegExp(/^(([$â‚¬Â£Â¥]\s*?-?(([1-9]\d{0,2}(,\d{3})*)|\d+)?(\.\d{1,2})?)|(-?(([1-9]\d{0,2}(,\d{3})*)|\d+)?(\.\d{1,2})?\s*?[$â‚¬Â£Â¥]))$/),[DEFAULT_COLUMN_TYPES.DATE_DMY]:new RegExp(/^(0?[1-9]|[12][0-9]|3[01])\s*?[/-]\s*?(0?[1-9]|1[012])\s*?[/-]\s*?\d{4}$/),[DEFAULT_COLUMN_TYPES.DATE_MDY]:new RegExp(/^(0?[1-9]|1[012])\s*?[/-]\s*?(0?[1-9]|[12][0-9]|3[01])\s*?[/-]\s*?\d{4}$/)},_Validation.DEFAULT_TYPES_FUNCTIONALITY={[DEFAULT_COLUMN_TYPES.NUMBER]:e=>e!==EMPTY_STRING&&!isNaN(e),[DEFAULT_COLUMN_TYPES.CURRENCY]:e=>_Validation.DEFAULT_TYPES_REGEX[DEFAULT_COLUMN_TYPES.CURRENCY].test(e),[DEFAULT_COLUMN_TYPES.DATE_DMY]:e=>_Validation.DEFAULT_TYPES_REGEX[DEFAULT_COLUMN_TYPES.DATE_DMY].test(e),[DEFAULT_COLUMN_TYPES.DATE_MDY]:e=>_Validation.DEFAULT_TYPES_REGEX[DEFAULT_COLUMN_TYPES.DATE_MDY].test(e)};let Validation=_Validation;class CellElementIndex{static getViaColumnIndex(e,t){return 2*e+Number(t)}}const _Sort=class e{static extractNumberFromString(e){const t=RegexUtils.extractFloatStrs(e);return t&&t.length>0?Number(t[0]):0}static update(e,t){const{_tableBodyElementRef:r,_frameComponents:{displayIndexColumn:n},data:i}=e,a=r.children;t.forEach(((t,r)=>{const i=r+1,s=a[i].children;t.forEach(((t,a)=>{const o=CellElementIndex.getViaColumnIndex(a,!!n),l=s[o];CellEvents.updateCell(e,t,i,a,{processText:!1,element:l,updateTableEvent:!1,updateData:!1}),ColumnTypesUtils.updateDataElements(e,r,a,l)}))})),i.splice(1,t.length,...t),setTimeout((()=>FireEvents.onDataUpdate(e)))}static sortStringsColumnAscending(e,t){e.sort(((e,r)=>String(e[t]).localeCompare(String(r[t]))))}static sortStringsColumnDescending(e,t){e.sort(((e,r)=>String(r[t]).localeCompare(String(e[t]))))}static sortStrings(t,r,n){n?e.sortStringsColumnAscending(t,r):e.sortStringsColumnDescending(t,r)}static parseComparedText(e,t,r,n){const i=n(e);if(void 0===i)return r?1:-1;const a=n(t);return void 0===a?r?-1:1:[i,a]}static validateType(e,t){return void 0===e||e(t)?t:void 0}static validateAndSort(t,r,n,i,a){const s=e.parseComparedText(t,r,a,e.validateType.bind(this,i));return"number"==typeof s?s:(a?n.ascendingFunc:n.descendingFunc)(s[0],s[1])}static sortViaSortFuncs(t,r,n,i){const{sorting:a,textValidation:s}=t;a&&r.sort(((t,r)=>e.validateAndSort(t[n],r[n],a,s.func,i)))}static compareDates(e,t){return new Date(...e)-new Date(...t)}static parseYMDFormat(t,r,n){return e.validateType(t,n)?r.toYMDFunc(n):void 0}static sortDates(t,r,n,i){const{calendar:a,textValidation:s}=t;a&&r.sort(((t,r)=>{const o=e.parseComparedText(t[n],r[n],!0,e.parseYMDFormat.bind(this,s.func,a));return"number"==typeof o?o:i?e.compareDates(o[0],o[1]):e.compareDates(o[1],o[0])}))}static sortColumn(t,r,n){const i=t.data.slice(1),{activeType:a}=t._columnsDetails[r];a.calendar?e.sortDates(a,i,r,n):a.sorting?e.sortViaSortFuncs(a,i,r,n):e.sortStrings(i,r,n),e.update(t,i)}};_Sort.DEFAULT_TYPES_SORT_FUNCS={[DEFAULT_COLUMN_TYPES.NUMBER]:{ascendingFunc:(e,t)=>Number(e)-Number(t),descendingFunc:(e,t)=>Number(t)-Number(e)},[DEFAULT_COLUMN_TYPES.CURRENCY]:{ascendingFunc:(e,t)=>_Sort.extractNumberFromString(e)-_Sort.extractNumberFromString(t),descendingFunc:(e,t)=>_Sort.extractNumberFromString(t)-_Sort.extractNumberFromString(e)}};let Sort=_Sort;const _DefaultColumnTypes=class e{static createDropdownItemsForDefaultTypes(){e.DEFAULT_TYPES.forEach((e=>{const t={text:e.name,iconSettings:e.iconSettings||DropdownButtonItemConf.DEFAULT_ITEM.iconSettings};e.dropdownItem={element:DropdownItem.createButtonItemNoEvents(void 0,t),settings:t}}))}};_DefaultColumnTypes.FALLBACK_TYPE={name:DEFAULT_COLUMN_TYPES.TEXT,iconSettings:{svgString:TEXT_ICON_SVG_STRING,containerStyles:{dropdown:{marginLeft:"-0.25px",marginRight:"6px",marginTop:"2.5px"},headerCorrections:{marginTop:"2.5px"}}}},_DefaultColumnTypes.DEFAULT_TYPES=[_DefaultColumnTypes.FALLBACK_TYPE,{name:DEFAULT_COLUMN_TYPES.NUMBER,textValidation:{func:Validation.DEFAULT_TYPES_FUNCTIONALITY[DEFAULT_COLUMN_TYPES.NUMBER]},sorting:Sort.DEFAULT_TYPES_SORT_FUNCS[DEFAULT_COLUMN_TYPES.NUMBER],iconSettings:{svgString:NUMBER_ICON_SVG_STRING,containerStyles:{dropdown:{marginLeft:"-1px",marginRight:"4.5px",marginTop:"2px"},headerCorrections:{marginTop:"2.5px"}}}},{name:DEFAULT_COLUMN_TYPES.CURRENCY,textValidation:{func:Validation.DEFAULT_TYPES_FUNCTIONALITY[DEFAULT_COLUMN_TYPES.CURRENCY]},sorting:Sort.DEFAULT_TYPES_SORT_FUNCS[DEFAULT_COLUMN_TYPES.CURRENCY],iconSettings:{svgString:CURRENCY_ICON_SVG_STRING,containerStyles:{dropdown:{marginLeft:"-2px",marginRight:"4px",marginTop:"1px"},headerCorrections:{marginRight:"3px",marginTop:"2px"}}}},{name:DEFAULT_COLUMN_TYPES.SELECT,select:{},iconSettings:{svgString:SELECT_ICON_SVG_STRING,containerStyles:{dropdown:{marginTop:"0px",marginRight:"3px",marginLeft:"-2.75px"},headerCorrections:{marginTop:"1px"}}}},{name:DEFAULT_COLUMN_TYPES.LABEL,label:{},iconSettings:{svgString:LABEL_ICON_SVG_STRING,containerStyles:{dropdown:{marginTop:"1.5px",marginRight:"5.5px",marginLeft:"-1px"},headerCorrections:{marginTop:"2.5px",marginRight:"5.5px",marginLeft:"0px"}}}},{name:DEFAULT_COLUMN_TYPES.CHECKBOX,iconSettings:{svgString:CHECKBOX_ICON_SVG_STRING,containerStyles:{dropdown:{marginRight:"6px",marginTop:"2px"},headerCorrections:{marginRight:"5px",marginLeft:"1px",marginTop:"3px"}}},checkbox:!0,customTextProcessing:{changeTextFunc:CheckboxValidationFunc.getDefault()}},{name:DEFAULT_COLUMN_TYPES.DATE_DMY,textValidation:{func:Validation.DEFAULT_TYPES_FUNCTIONALITY[DEFAULT_COLUMN_TYPES.DATE_DMY]},calendar:CalendarFunctionalityUtils.DEFAULT_TYPES_FUNCTIONALITY[DEFAULT_COLUMN_TYPES.DATE_DMY],iconSettings:{svgString:CALENDAR_ICON_SVG_STRING,containerStyles:{dropdown:{marginLeft:"1.25px",marginRight:"8px",marginTop:"-1.5px"},headerCorrections:{marginTop:"0px"}}}},{name:DEFAULT_COLUMN_TYPES.DATE_MDY,textValidation:{func:Validation.DEFAULT_TYPES_FUNCTIONALITY[DEFAULT_COLUMN_TYPES.DATE_MDY]},calendar:CalendarFunctionalityUtils.DEFAULT_TYPES_FUNCTIONALITY[DEFAULT_COLUMN_TYPES.DATE_MDY],iconSettings:{svgString:CALENDAR_ICON_SVG_STRING,containerStyles:{dropdown:{marginLeft:"1.25px",marginRight:"8px",marginTop:"-1.5px"},headerCorrections:{marginTop:"0px"}}}}];let DefaultColumnTypes=_DefaultColumnTypes;class DropdownButtonItemConf{}DropdownButtonItemConf.DEFAULT_ITEM={text:DefaultColumnTypes.FALLBACK_TYPE.name,iconSettings:DefaultColumnTypes.FALLBACK_TYPE.iconSettings};class ColumnTypesUtils{static getTypeByName(e,t){return e.find((e=>e.name.toLocaleLowerCase()===(null==t?void 0:t.toLocaleLowerCase())))}static getTypeBasedOnProperties(e,t){if(t){const r=ColumnTypesUtils.getTypeByName(e.types,t);if(r)return r}if(e.defaultColumnTypeName){const t=ColumnTypesUtils.getTypeByName(e.types,e.defaultColumnTypeName);if(t)return t}}static getActiveType(e,t){const r=ColumnTypesUtils.getTypeBasedOnProperties(e,t);if(r)return r;const n=e.types.find((e=>!e.textValidation.func));return n||(e.types[0]||DefaultColumnTypes.FALLBACK_TYPE)}static getReusableDefaultIcon(e){var t;const r=null==(t=e.reusableIconName)?void 0:t.toLocaleLowerCase(),n=DefaultColumnTypes.DEFAULT_TYPES.find((e=>e.name.toLocaleLowerCase()===r));return null!=n&&n.iconSettings?n.iconSettings:DropdownButtonItemConf.DEFAULT_ITEM.iconSettings}static processDropdownItemSettings(e){const{name:t,iconSettings:r}=e;let n;r?r.reusableIconName?n=ColumnTypesUtils.getReusableDefaultIcon(r):(n=r,0===Object.keys(r).length?n=DropdownButtonItemConf.DEFAULT_ITEM.iconSettings:r.svgString||(n.svgString??(n.svgString=DropdownButtonItemConf.DEFAULT_ITEM.iconSettings.svgString),n.containerStyles??(n.containerStyles=DropdownButtonItemConf.DEFAULT_ITEM.iconSettings.containerStyles))):n=DropdownButtonItemConf.DEFAULT_ITEM.iconSettings;const i={text:t,iconSettings:n},a=e;a.dropdownItem??(a.dropdownItem={element:null,settings:i}),setTimeout((()=>{var e;(e=a.dropdownItem).element??(e.element=DropdownItem.createButtonItemNoEvents(void 0,i))}))}static processTextValidationProps(e){var t;e.textValidation??(e.textValidation={}),(t=e.textValidation).setTextToDefaultOnFail??(t.setTextToDefaultOnFail=!0)}static processCheckbox(e){var t;e.checkbox&&(null==(t=e.customTextProcessing)||!t.changeTextFunc)&&(e.customTextProcessing??(e.customTextProcessing={}),e.customTextProcessing.changeTextFunc=CheckboxValidationFunc.getDefault())}static processSelectOptions(e){"object"==typeof e.select&&e.select.options?e.select.options=e.select.options.map((e=>({text:e}))):"object"==typeof e.label&&e.label.options&&(e.label.options=JSON.parse(JSON.stringify(e.label.options)))}static processSelect(e,t,r){var n;const i=e;!0===e.select||!0===e.label?i.cellDropdownProps={isBasicSelect:!e.label}:("object"==typeof e.select||"object"==typeof e.label)&&(i.cellDropdownProps=e.select||e.label,i.cellDropdownProps.isBasicSelect=!e.label,ColumnTypesUtils.processSelectOptions(e),Validation.setSelectValidation(i,t,r)),i.cellDropdownProps&&void 0===i.cellDropdownProps.canAddMoreOptions&&(i.cellDropdownProps.canAddMoreOptions=!(null!=(n=i.cellDropdownProps)&&n.options))}static convertStringFunctionsToRealFunctions(e){e.textValidation&&ObjectUtils.convertStringToFunction(e.textValidation,"func"),e.customTextProcessing&&(ObjectUtils.convertStringToFunction(e.customTextProcessing,"changeTextFunc"),ObjectUtils.convertStringToFunction(e.customTextProcessing,"changeStyleFunc")),e.sorting&&(ObjectUtils.convertStringToFunction(e.sorting,"ascendingFunc"),ObjectUtils.convertStringToFunction(e.sorting,"descendingFunc")),e.calendar&&(ObjectUtils.convertStringToFunction(e.calendar,"toYMDFunc"),ObjectUtils.convertStringToFunction(e.calendar,"fromYMDFunc"))}static createTypeDeepCopy(e){const t=JSON.parse(JSON.stringify(e));return e.dropdownItem&&(t.dropdownItem=e.dropdownItem),e.textValidation&&(t.textValidation=e.textValidation),e.customTextProcessing&&(t.customTextProcessing=e.customTextProcessing),e.sorting&&(t.sorting=e.sorting),e.calendar&&(t.calendar=e.calendar),t}static process(e,t,r){return e.map((e=>{const n=ColumnTypesUtils.createTypeDeepCopy(e);return ColumnTypesUtils.convertStringFunctionsToRealFunctions(n),ColumnTypesUtils.processSelect(n,t,r),ColumnTypesUtils.processCheckbox(n),ColumnTypesUtils.processTextValidationProps(n),ColumnTypesUtils.processDropdownItemSettings(n),n}))}static getAvailableTypes(e){let t=[...DefaultColumnTypes.DEFAULT_TYPES];const{availableDefaultColumnTypes:r,customColumnTypes:n}=e;if(r){const e=r.map((e=>e.toLocaleLowerCase()));t=t.filter((t=>e.indexOf(t.name.toLocaleLowerCase())>-1))}return n&&t.push(...n),0===t.length&&t.push(DefaultColumnTypes.FALLBACK_TYPE),t}static getProcessedTypes(e){const{isDefaultTextRemovable:t,defaultText:r}=e,n=ColumnTypesUtils.getAvailableTypes(e);return ColumnTypesUtils.process(n,t,r)}static updateDataElements(e,t,r,n){const{_columnsDetails:i,_tableDimensions:a}=e,s=i[r];0!==t&&(s.activeType.cellDropdownProps?(CellDropdown.updateCellDropdown(n,s.cellDropdown,a.border,s.settings.defaultText,!0),SelectCell.finaliseEditedText(e,n.children[0],r,!0)):Browser.IS_INPUT_DATE_SUPPORTED&&s.activeType.calendar&&DateCellInputElement.updateInputBasedOnTextDiv(n,s.activeType))}}class MoveUtils{static setNewElementText(e,t,r,n,i){const a=CellElement.getText(r);return CellEvents.updateCell(e,t,i,n,{element:r,processText:!1}),ColumnTypesUtils.updateDataElements(e,i,n,r),a}}class MoveColumn{static overwriteDataElements(e,t,r,n){t.slice(1).forEach(((t,i)=>{const a=i+1,s=n[a];MoveUtils.setNewElementText(e,s,t,r,a)}))}static changeSettings(e,t,r,n,i){HeaderText.onAttemptChange(e,r,t,{colMove:!0}),i!==n.activeType&&ChangeColumnType.change.bind(e)(i.name,t)}static overwrite(e,t,r,n,i,a){const{elements:s,activeType:o}=t;MoveUtils.setNewElementText(e,n[0],s[0],r,0),MoveColumn.changeSettings(e,r,s[0],t,i),MoveColumn.overwriteDataElements(e,s,r,n);const l=s[0].style.width;return s[0].style.width=a,{overwrittenType:o,overwrittenWidth:l}}static firstChangeSettingsIfSettingsChanged(e,t){const{areSettingsDifferent:r}=ColumnSettingsUtils.parseSettingsChange(e);if(r){const r=e._columnsDetails[t];HeaderText.onAttemptChange(e,r.elements[0],t)}}static move(e,t,r){MoveColumn.firstChangeSettingsIfSettingsChanged(e,t);const n=e._columnsDetails[t],i=e._columnsDetails[t].elements.map((e=>CellElement.getText(e)));CellHighlightUtils.fade(n.elements[0],null==n?void 0:n.headerStateColors.default);const a=r?t+1:t-1,s=e._columnsDetails[a],o=s.elements.map((e=>CellElement.getText(e))),l=s.elements[0].style.width,c=MoveColumn.overwrite(e,n,t,o,s.activeType,l);FocusedCellUtils.set(e._focusedElements.cell,s.elements[0],0,a),MoveColumn.overwrite(e,s,a,i,c.overwrittenType,c.overwrittenWidth),setTimeout((()=>FireEvents.onColumnsUpdate(e)))}}class ColumnSizerGenericUtils{static canHeightBeInherited(){return Browser.IS_CHROMIUM||Browser.IS_FIREFOX}static getSizerDetailsViaElementId(e,t){const r=Number(RegexUtils.extractIntegerStrs(e)[0]),n=t[r];return{columnSizer:n.columnSizer,headerCell:n.elements[0],sizerNumber:r}}static findNextResizableColumnHeader(e,t){const r=e.slice(t+1).find((e=>{var t;return!(null!=(t=e.settings.widths)&&t.staticWidth)}));return null==r?void 0:r.elements[0]}}const _UpdateRowElement=class e{static updateHeaderRowHeight(t){ColumnSizerGenericUtils.canHeightBeInherited()||(t.style.height=e.UNSET,t.style.height=getComputedStyle(t).height)}static updateHeadRowHeightOnKeyDown(t){var r;if(!ColumnSizerGenericUtils.canHeightBeInherited()){const n=null==(r=t.children)?void 0:r[0];n&&n.style.height!==e.UNSET&&(n.style.height=e.UNSET,setTimeout((()=>{n.style.height=`${n.offsetHeight}px`})))}}static getUnsetHeightFunc(t,r){if(!ColumnSizerGenericUtils.canHeightBeInherited()&&0===r)return()=>t.style.height=e.UNSET}};_UpdateRowElement.UNSET="unset";let UpdateRowElement=_UpdateRowElement;class RowHoverEvents{static canStyleBeApplied(e,t,r){return(r>0||e.header)&&(!AddNewRowElement.isAddNewRowRow(t)||e.addNewRowButton)}static getRemoveColorFunc(e,t,r,n){const i=e.rowHoverStyles;if(null!=i&&i.style&&RowHoverEvents.canStyleBeApplied(i,t,r))return()=>{ElementStyle.unsetStyle(t,i.style),Object.assign(t.style,n)}}static addMouseLeaveEvent(e,t,r,n){const i=RowHoverEvents.getRemoveColorFunc(e,t,r,n),a=UpdateRowElement.getUnsetHeightFunc(t,r);t.onmouseleave=()=>{null==i||i(),null==a||a()}}static addMouseEnterEvent(e,t,r){const{rowHoverStyles:n,_focusedElements:{rowDragEl:i}}=e,a=null!=n&&n.style&&RowHoverEvents.canStyleBeApplied(n,t,r)?()=>Object.assign(t.style,null==n?void 0:n.style):void 0;t.onmouseenter=()=>{i||null==a||a()}}static addEvents(e,t,r,n){RowHoverEvents.addMouseEnterEvent(e,t,r),RowHoverEvents.addMouseLeaveEvent(e,t,r,n)}static process(e,t){null!=e&&e.style&&(e.header??(e.header=!0),e.addNewRowButton??(e.addNewRowButton=!0),CellHighlightUtils.unsetDefaultHoverProperties(t))}}const _StripedRows=class e{static setRowStyle(e,t,r){const n=t%2?r.even:r.odd;return Object.assign(e.style,n),n}static process(t){const{stripedRows:r,_defaultCellHoverColors:n}=t;r&&(t._stripedRows="boolean"==typeof r?e.DEFAULT_PROPERTIES:{even:r.even||e.DEFAULT_PROPERTIES.even,odd:r.odd||e.DEFAULT_PROPERTIES.odd},CellHighlightUtils.unsetDefaultHoverProperties(n))}};_StripedRows.DEFAULT_PROPERTIES={odd:{backgroundColor:""},even:{backgroundColor:"#dcdcdc7a"}};let StripedRows=_StripedRows;class CustomRowProperties{static setStyle(e,t,r,n){if(e._stripedRows)return n&&AddNewRowElement.isAddNewRowRow(t)&&(r=+!e.dataStartsAtHeader),StripedRows.setRowStyle(t,r,e._stripedRows)}static updateRow(e,t,r,n,i){const a=CustomRowProperties.setStyle(e,t,r,n);r===i?RowHoverEvents.addEvents(e,t,r,a):setTimeout((()=>{RowHoverEvents.addEvents(e,t,r,a)}))}static isAddRowRowSame(e){return!(!e.pagination||!e._frameComponents.displayAddNewRow||PaginationUtils.getLastPossiblePageNumber(e)===e._pagination.activePageNumber)}static update(e,t=0){if(!e._tableBodyElementRef)return;const r=Array.from(e._tableBodyElementRef.children),n=CustomRowProperties.isAddRowRowSame(e),i=r.length-1;r.slice(t).forEach(((r,a)=>{const s=a+t;CustomRowProperties.updateRow(e,r,s,n,i)}))}}class MoveRow{static overwrite(e,t,r){const n=[];return e._columnsDetails.forEach(((i,a)=>{const s=MoveUtils.setNewElementText(e,t[a],i.elements[r],a,r);n.push(s)})),n}static moveDataRows(e,t,r){const n=e._columnsDetails.map((({elements:e})=>CellElement.getText(e[r]))),i=MoveRow.overwrite(e,n,t);MoveRow.overwrite(e,i,r)}static resetFocusedCell(e,t){const{_frameComponents:r,_focusedElements:n}=e,{element:i,rowIndex:a,columnIndex:s}=t;r.displayIndexColumn?FocusedCellUtils.setIndexCell(n.cell,i,a):FocusedCellUtils.set(n.cell,i,a,s)}static moveHeaderToDataRow(e){const{_columnsDetails:t,_focusedElements:r}=e,n={...r.cell},i=t.map((({elements:e})=>CellElement.getText(e[1]))),a=MoveRow.overwrite(e,i,0);t.forEach(((t,n)=>{FocusedCellUtils.set(r.cell,t.elements[0],0,n),HeaderText.onAttemptChange(e,t.elements[0],n)})),MoveRow.overwrite(e,a,1),MoveRow.resetFocusedCell(e,n)}static move(e,t,r){const n=r?t+1:t-1;0===t||0===n?MoveRow.moveHeaderToDataRow(e):MoveRow.moveDataRows(e,t,n),CustomRowProperties.update(e,t),e.pagination&&PaginationUtils.updateOnRowMove(e,n)}}const _Drag=class e{static move(t,r,n){if(0===r)return;const i=r>0,a=i?1:-1;for(let s=0;s<Math.abs(r);s+=1)n(t,e.ORIGINAL_INDEX+s*a,i);setTimeout((()=>FocusedCellUtils.purge(t._focusedElements.cell)),5)}};_Drag.CELL_HIDDEN_CLASS="cell-hidden",_Drag.DRAG_PX_TO_MOVE=10,_Drag.ORIGINAL_INDEX=0;let Drag=_Drag;const _DragRow=class e extends Drag{static resetElements(t){var r,n;null==(r=e.CLONE_ROW)||r.remove(),Array.from(t.children||[]).forEach((e=>{e.classList.remove(Drag.CELL_HIDDEN_CLASS)})),null==(n=e.TARGET_LINE)||n.remove()}static appendTargetLine(t){e.TARGET_LINE=document.createElement("div"),e.TARGET_LINE.classList.add("row-drag-target-line"),e.TARGET_LINE.style.opacity="0",t.appendChild(e.TARGET_LINE)}static prepareElements(t,r,n){r.classList.add(e.ROW_CLONE_CLASS),r.style.top=`${n.offsetTop}px`;const i=`${n.children[0].offsetHeight}px`,a=Array.from(n.children||[]);Array.from(r.children).forEach(((e,t)=>{e.style.width=`${a[t].offsetWidth}px`,e.style.height=i})),a.forEach((e=>{e.classList.add(Drag.CELL_HIDDEN_CLASS)})),e.appendTargetLine(t)}static calculateThresholdDown(t){e.TARGET_DOWN_ROW&&t&&(e.THRESHOLD_DOWN=e.TARGET_DOWN_ROW.offsetTop+e.TARGET_DOWN_ROW.offsetHeight/2-t.offsetHeight)}static calculateThresholdUp(){e.TARGET_UP_ROW&&(e.THRESHOLD_UP=e.TARGET_UP_ROW.offsetTop+e.TARGET_UP_ROW.offsetHeight/2)}static initiateDragState(t,r,n){var i;if(e.TARGET_UP_ROW=n.previousSibling,e.TARGET_DOWN_ROW=null==(i=n.nextSibling)?void 0:i.nextSibling,!e.TARGET_UP_ROW&&AddNewRowElement.isAddNewRowRow(e.TARGET_DOWN_ROW.children[0]))return;e.CLONE_ROW=r,e.ACTIVE_ROW_TOP_PX=n.offsetTop,e.ACTIVE_INDEX=0,e.calculateThresholdUp(),e.calculateThresholdDown(n);const a=Array.from(t.children);Drag.ORIGINAL_INDEX=a.findIndex((e=>e===n));const s=a[a.length-2].offsetHeight;e.MAX_DOWN=t.offsetHeight-n.offsetHeight-s}static processRowCellsToDrag(t,r){const n=r.parentElement;n.dispatchEvent(new MouseEvent("mouseleave"));const i=n.cloneNode(!0);return null==n||n.insertAdjacentElement("afterend",i),e.prepareElements(t,i,n),e.initiateDragState(t,i,n),n}static applyEventsToElement(t,r,n){e.isDisabled(t)||(r.onmousedown=()=>{e.IS_MOUSE_DOWN=!0},r.onmousemove=()=>{e.IS_MOUSE_DOWN&&!t._focusedElements.rowDragEl&&t._tableBodyElementRef&&(e.INITIALISING_DRAG_PX+=1,e.INITIALISING_DRAG_PX>Drag.DRAG_PX_TO_MOVE&&(t._focusedElements.rowDragEl=e.processRowCellsToDrag(t._tableBodyElementRef,n),FocusedCellUtils.set(t._focusedElements.cell,n,0,Drag.ORIGINAL_INDEX)))})}static moveTargetLine(e,t){e.style.opacity="1",e.style.top=`${t}px`}static removeLineOnMoveDown(t){t.style.opacity="0",e.ACTIVE_INDEX=0,e.THRESHOLD_TO_NO_LINE_DOWN=-1,e.calculateThresholdUp()}static attemptSwitchUp(t,r){var n;e.TARGET_UP_ROW&&r&&((null==(n=e.TARGET_UP_ROW.previousSibling)?void 0:n.previousSibling)===r?(e.THRESHOLD_TO_NO_LINE_UP=r.offsetTop+r.offsetHeight/2,e.THRESHOLD_DOWN=e.TARGET_UP_ROW.offsetTop+e.TARGET_UP_ROW.offsetHeight/2,e.TARGET_DOWN_ROW=e.TARGET_UP_ROW,e.TARGET_UP_ROW=r.previousSibling,e.TARGET_UP_ROW?e.calculateThresholdUp():e.THRESHOLD_UP=-1):(e.moveTargetLine(t,e.TARGET_UP_ROW.offsetTop-3),e.THRESHOLD_DOWN=e.THRESHOLD_UP,e.TARGET_DOWN_ROW=e.TARGET_UP_ROW,e.TARGET_UP_ROW=e.TARGET_UP_ROW.previousSibling,e.calculateThresholdUp(),e.ACTIVE_INDEX-=1))}static removeLineOnMoveUp(t,r){t.style.opacity="0",e.ACTIVE_INDEX=0,e.THRESHOLD_TO_NO_LINE_UP=-1,e.calculateThresholdDown(r)}static attemptSwitchDown(t,r){var n;e.TARGET_DOWN_ROW&&(e.TARGET_DOWN_ROW.nextSibling===r?(e.THRESHOLD_TO_NO_LINE_DOWN=e.TARGET_DOWN_ROW.offsetTop+e.TARGET_DOWN_ROW.offsetHeight/2,e.TARGET_UP_ROW=e.TARGET_DOWN_ROW,e.THRESHOLD_UP=e.TARGET_UP_ROW.offsetTop-e.TARGET_UP_ROW.offsetHeight/2,e.TARGET_DOWN_ROW=null==(n=null==r?void 0:r.nextSibling)?void 0:n.nextSibling,e.calculateThresholdDown(r)):(e.moveTargetLine(t,e.TARGET_DOWN_ROW.offsetTop+e.TARGET_DOWN_ROW.offsetHeight-3),e.THRESHOLD_UP=e.THRESHOLD_DOWN,e.TARGET_UP_ROW=e.TARGET_DOWN_ROW,e.TARGET_DOWN_ROW=e.TARGET_DOWN_ROW.nextSibling,e.calculateThresholdDown(r),e.ACTIVE_INDEX+=1))}static windowDrag(t,r){if(e.isDisabled(t)||!e.TARGET_LINE||!t._focusedElements.rowDragEl||!e.CLONE_ROW)return;const n=Math.max(0,e.ACTIVE_ROW_TOP_PX+r.movementY),i=Math.min(n,e.MAX_DOWN);e.ACTIVE_ROW_TOP_PX=i,e.CLONE_ROW.style.top=`${e.ACTIVE_ROW_TOP_PX}px`,e.ACTIVE_ROW_TOP_PX>e.THRESHOLD_DOWN?e.attemptSwitchDown(e.TARGET_LINE,t._focusedElements.rowDragEl):e.ACTIVE_ROW_TOP_PX<e.THRESHOLD_UP?e.attemptSwitchUp(e.TARGET_LINE,t._focusedElements.rowDragEl):e.THRESHOLD_TO_NO_LINE_DOWN>=0&&e.THRESHOLD_TO_NO_LINE_DOWN<e.ACTIVE_ROW_TOP_PX?e.removeLineOnMoveDown(e.TARGET_LINE):e.THRESHOLD_TO_NO_LINE_UP>=0&&e.THRESHOLD_TO_NO_LINE_UP>e.ACTIVE_ROW_TOP_PX&&e.removeLineOnMoveUp(e.TARGET_LINE,t._focusedElements.rowDragEl)}static windowMouseUp(t){e.IS_MOUSE_DOWN=!1,!e.isDisabled(t)&&t._focusedElements.rowDragEl&&(e.resetElements(t._focusedElements.rowDragEl),delete t._focusedElements.rowDragEl,e.INITIALISING_DRAG_PX=0,e.move(t,e.ACTIVE_INDEX,MoveRow.move))}static isDisabled(e){return!1===e.dragRows||e.filter||e.pagination}};_DragRow.ROW_CLONE_CLASS="row-clone",_DragRow.INITIALISING_DRAG_PX=0,_DragRow.ACTIVE_ROW_TOP_PX=0,_DragRow.CLONE_ROW=null,_DragRow.IS_MOUSE_DOWN=!1,_DragRow.ACTIVE_INDEX=0,_DragRow.THRESHOLD_UP=0,_DragRow.THRESHOLD_DOWN=0,_DragRow.MAX_DOWN=0,_DragRow.THRESHOLD_TO_NO_LINE_DOWN=-1,_DragRow.THRESHOLD_TO_NO_LINE_UP=-1;let DragRow=_DragRow;const _DragColumn=class e extends Drag{static setHeaderElementsToDefault(t){var r;const n=null==(r=t.parentElement)?void 0:r.children;e.CLONE_CELLS.forEach((e=>e.remove())),Array.from(n||[]).forEach((e=>{e.tagName===CellElement.HEADER_TAG&&e.classList.remove(Drag.CELL_HIDDEN_CLASS)})),e.DIVIDERS.forEach((e=>{e.style.pointerEvents=""}))}static applyCloneHeaderCell(t,r,n,i){r.classList.add(Drag.CELL_HIDDEN_CLASS),t.classList.add(e.HEADER_CELL_CLONE_CLASS),t.classList.add(e.HEADER_CELL_CLONE_ANIMATION_CLASS),t.style.left=`${r.offsetLeft}px`,t.style.height=i,null==n||n.insertAdjacentElement("beforebegin",t),e.CLONE_CELLS.push(t),e.REAL_CELLS.push(r)}static getThreshold(t,r){const n=e.REAL_CELLS[e.ACTIVE_INDEX+r],i=Math.min(t.offsetWidth/2,(null==n?void 0:n.offsetWidth)/2)*r;return t.offsetLeft+i}static initiateDragState(t,r){if(e.ACTIVE_INDEX=e.REAL_CELLS.findIndex((e=>r===e)),e.ACTIVE_INDEX+2>=e.CLONE_CELLS.length&&e.ACTIVE_INDEX-1<=0)return;t._focusedElements.colDragEl=e.CLONE_CELLS[e.ACTIVE_INDEX],t._focusedElements.colDragEl.classList.remove(e.HEADER_CELL_CLONE_ANIMATION_CLASS),e.ACTIVE_CELL_LEFT_PX=r.offsetLeft,e.THRESHOLD_LEFT=e.getThreshold(r,-1),e.THRESHOLD_RIGHT=e.getThreshold(r,1);const n=e.REAL_CELLS[0];e.MIN_LEFT=n.classList.contains(IndexColumn.INDEX_CELL_CLASS)?n.offsetWidth:0;const i=e.REAL_CELLS[e.REAL_CELLS.length-1],a=i.classList.contains(AddNewColumnElement.ADD_COLUMN_CELL_CLASS)?0:i.offsetWidth;e.MAX_LEFT=i.offsetLeft+a-r.offsetWidth;const s=e.REAL_CELLS[0].classList.contains(IndexColumn.INDEX_CELL_CLASS);Drag.ORIGINAL_INDEX=e.ACTIVE_INDEX-(s?1:0)}static processHeaderCellsToDrag(t,r,n){var i;const a=`${r.offsetHeight}px`;Array.from((null==(i=r.parentElement)?void 0:i.children)||[]).forEach((t=>{if(t.tagName===CellElement.HEADER_TAG){const r=t.cloneNode(!0);e.applyCloneHeaderCell(r,t,n,a)}else t.style.pointerEvents="none",e.DIVIDERS.push(t)})),e.initiateDragState(t,r)}static applyEventsToElement(t,r,n){!1!==t.dragColumns&&(r.onmousedown=()=>{e.IS_MOUSE_DOWN=!0},r.onmousemove=()=>{var r;if(e.IS_MOUSE_DOWN&&!t._focusedElements.colDragEl&&(e.INITIALISING_DRAG_PX+=1,e.INITIALISING_DRAG_PX>Drag.DRAG_PX_TO_MOVE)){const i=null==(r=n.parentElement)?void 0:r.children[n.parentElement.children.length-1];e.processHeaderCellsToDrag(t,n,i),FocusedCellUtils.set(t._focusedElements.cell,n,0,Drag.ORIGINAL_INDEX)}})}static switch(t){const r=e.CLONE_CELLS[e.ACTIVE_INDEX],n=e.CLONE_CELLS[e.ACTIVE_INDEX+t];t>0?(e.THRESHOLD_LEFT=e.THRESHOLD_RIGHT-5,e.THRESHOLD_RIGHT=r.offsetLeft+n.offsetWidth,n.style.left=n.offsetLeft-r.offsetWidth+"px"):(e.THRESHOLD_RIGHT=e.THRESHOLD_LEFT+5,e.THRESHOLD_LEFT=r.offsetLeft-n.offsetWidth,n.style.left=`${n.offsetLeft+r.offsetWidth}px`),ArrayUtils.swap(e.CLONE_CELLS,e.ACTIVE_INDEX,e.ACTIVE_INDEX+t),e.ACTIVE_INDEX+=t}static windowDrag(t,r,n){if(!1===t.dragColumns)return;const i=Math.max(e.MIN_LEFT,e.ACTIVE_CELL_LEFT_PX+n.movementX),a=Math.min(i,e.MAX_LEFT);e.ACTIVE_CELL_LEFT_PX=a,r.style.left=`${e.ACTIVE_CELL_LEFT_PX}px`,e.ACTIVE_CELL_LEFT_PX>e.THRESHOLD_RIGHT?e.switch(1):e.ACTIVE_CELL_LEFT_PX<e.THRESHOLD_LEFT&&e.switch(-1)}static windowMouseUp(t){if(e.IS_MOUSE_DOWN=!1,!1===t.dragColumns||!t._focusedElements.colDragEl)return;e.setHeaderElementsToDefault(t._focusedElements.colDragEl),delete t._focusedElements.colDragEl,e.INITIALISING_DRAG_PX=0,e.ACTIVE_CELL_LEFT_PX=0,e.CLONE_CELLS=[],e.DIVIDERS=[];const r=e.REAL_CELLS[0].classList.contains(IndexColumn.INDEX_CELL_CLASS);DragRow.move(t,e.ACTIVE_INDEX-Drag.ORIGINAL_INDEX-(r?1:0),MoveColumn.move),e.REAL_CELLS=[]}};_DragColumn.HEADER_CELL_CLONE_CLASS="header-cell-clone",_DragColumn.HEADER_CELL_CLONE_ANIMATION_CLASS="header-cell-clone-animation",_DragColumn.INITIALISING_DRAG_PX=0,_DragColumn.ACTIVE_CELL_LEFT_PX=0,_DragColumn.IS_MOUSE_DOWN=!1,_DragColumn.CLONE_CELLS=[],_DragColumn.REAL_CELLS=[],_DragColumn.DIVIDERS=[],_DragColumn.ACTIVE_INDEX=0,_DragColumn.THRESHOLD_RIGHT=0,_DragColumn.THRESHOLD_LEFT=0,_DragColumn.MAX_LEFT=0,_DragColumn.MIN_LEFT=0;let DragColumn=_DragColumn;class DropdownCellOverlay{}DropdownCellOverlay.HIDDEN_PX="0px",DropdownCellOverlay.VISIBLE_PX="10px",DropdownCellOverlay.DROPDOWN_CELL_OVERLAY_CLASS="dropdown-cell-overlay";const _ColumnDropdownCellOverlay=class e{static setDefault(e,t){var r;e.style.backgroundColor=(null==(r=null==t?void 0:t.default)?void 0:r.backgroundColor)||""}static resetDefaultColor(t,r){var n;const i=null==r?void 0:r.overlayStyles;null!=(n=null==i?void 0:i.hover)&&n.backgroundColor&&e.setDefault(t,i)}static setHoverColor(e,t){var r,n;const i=null==(n=null==(r=null==t?void 0:t.overlayStyles)?void 0:r.hover)?void 0:n.backgroundColor;i&&(e.columnDropdownCellOverlay.style.backgroundColor=i)}static hide(e,t){const{columnDropdownCellOverlay:r}=t,n=e._hoveredElements.headerCell;setTimeout((()=>{n!==e._hoveredElements.headerCell&&(r.style.height=DropdownCellOverlay.HIDDEN_PX)}))}static setHorizontalDimensions(e){const{columnDropdownCellOverlay:t,elements:r}=e,n=r[0].offsetWidth/100;t.style.width=50*n+"px",t.style.right=25*n+"px"}static display(t){t.columnDropdownCellOverlay.style.height=DropdownCellOverlay.VISIBLE_PX,e.setHorizontalDimensions(t)}static isDisplayed(e){return e.style.height===DropdownCellOverlay.VISIBLE_PX}static updateIfDisplayed(t){e.isDisplayed(t.columnDropdownCellOverlay)&&e.setHorizontalDimensions(t)}static create(t,r,n){const i=document.createElement("div");return i.classList.add(DropdownCellOverlay.DROPDOWN_CELL_OVERLAY_CLASS),i.classList.add(e.COLUMN_DROPDOWN_CELL_OVERLAY_CLASS),i.style.height=DropdownCellOverlay.HIDDEN_PX,e.setDefault(i,n),DragColumn.applyEventsToElement(t,i,r),i}static add(t,r){var n,i;const a=null==(i=null==(n=t._defaultColumnsSettings.columnDropdown)?void 0:n.displaySettings)?void 0:i.overlayStyles,s=t._columnsDetails[r].elements[0],o=e.create(t,s,a);return s.nextSibling.appendChild(o),o}};_ColumnDropdownCellOverlay.COLUMN_DROPDOWN_CELL_OVERLAY_CLASS="column-dropdown-cell-overlay";let ColumnDropdownCellOverlay=_ColumnDropdownCellOverlay;const _MovableColumnSizerElement=class e{static setStaticProperties(e,t,r){e.style.marginRight=t,e.style.width=r}static isMovableColumnSizer(t){return t.classList.contains(e.MOVABLE_SIZER_CLASS)}static getVerticalLineHeight(e,t){let r=e.offsetHeight;return t&&(r-=e.lastChild.offsetHeight),r}static display(t,r,n){const i=r.movableElement;i.style.display="flex",i.children[0].style.height=`${e.getVerticalLineHeight(t,n)}px`}static hide(e){e.style.display="none",e.style.left=""}static createVerticalLine(t){const r=document.createElement("div");return r.style.backgroundColor=t,r.classList.add(e.VERTICAL_LINE_CLASS),r}static getMovableBackgroundColor(t){return t.click||t.hover||e.DEFAULT_BACKGROUND_COLOR}static create(t){const r=e.getMovableBackgroundColor(t),n=document.createElement("div");n.style.backgroundColor=r,n.classList.add(e.MOVABLE_SIZER_CLASS),e.hide(n);const i=e.createVerticalLine(r);return n.appendChild(i),n}};_MovableColumnSizerElement.DEFAULT_BACKGROUND_COLOR="#4668ed",_MovableColumnSizerElement.MOVABLE_SIZER_CLASS="movable-column-sizer",_MovableColumnSizerElement.VERTICAL_LINE_CLASS="movable-column-sizer-vertical-line";let MovableColumnSizerElement=_MovableColumnSizerElement;class MoveLimits{static getSideLimitDelta(e){const t=ExtractElements.getRightColumnSiblingCell(e);return((Number.parseFloat(getComputedStyle(e).borderRightWidth)||0)-(Number.parseFloat(getComputedStyle(t).borderLeftWidth)||0))/2}static getRightLimitDynamicWidthTable(){return window.innerWidth}static getRightLimitForMaxWidth(e,t,r){return StaticTable.isTableAtMaxWidth(e,t)?r?Number.parseFloat(r.style.width):0:t.maxWidth-e.offsetWidth}static getRightLimit(e,t){return void 0!==e._tableDimensions.width?Number.parseFloat(t.style.width):void 0!==e._tableDimensions.maxWidth&&e._tableElementRef?MoveLimits.getRightLimitForMaxWidth(e._tableElementRef,e._tableDimensions,t):MoveLimits.getRightLimitDynamicWidthTable()}static getLeftLimit(e,t){let r=-e.offsetWidth;return void 0!==t&&(r+=t),r}static generate(e,t,r,n,i,a){const s=t||r?MoveLimits.getSideLimitDelta(a):0;return{left:MoveLimits.getLeftLimit(a,t?s:void 0)+n,right:MoveLimits.getRightLimit(e,i)}}}class SelectedColumnSizer{static generateObj(e,t,r,n,i,a){const s=t.movableElement.offsetLeft;return{element:t.element,moveLimits:MoveLimits.generate(e,r,n,s,a,i),initialOffset:s,mouseMoveOffset:s,fireColumnsUpdate:FireEvents.onColumnsUpdate.bind(this,e)}}static get(e,t){const r=e._columnsDetails[t].columnSizer,n=0===t,i=e._columnsDetails.length-2===t,a=e._columnsDetails[t].elements[0],s=ColumnSizerGenericUtils.findNextResizableColumnHeader(e._columnsDetails,t);return SelectedColumnSizer.generateObj(e,r,n,i,a,s)}}const SEMI_TRANSPARENT_COLOR="#ffffff01";class ColumnSizer{static shouldWidthBeIncreased(e){return e>4}static getBackgroundImage(e,t,r,n,i){if(n&&i){if(Number.parseInt(getComputedStyle(i).borderRightWidth)>0&&(t>0||void 0===r||r>0))return ColumnSizerElement.EMPTY_BACKGROUND_IMAGE}else if(e>0)return ColumnSizerElement.EMPTY_BACKGROUND_IMAGE;return ColumnSizerElement.FILLED_BACKGROUND_IMAGE}static getMarginRight(e,t){return t||!e?"0px":e.leftCellRight-e.rightCellLeft+"px"}static getTotalCellBorderWidth(e){return e?e.rightCellLeft+e.leftCellRight:0}static generateBorderWidthsInfo(e,t){var r,n,i;const a={rightCellLeft:0,leftCellLeft:0,leftCellRight:0,beforeLeftCellRight:void 0},s=null==(r=e[t-1])?void 0:r.elements[0];s&&(a.beforeLeftCellRight=Number.parseInt(getComputedStyle(s).borderRightWidth)||0);const o=null==(n=e[t])?void 0:n.elements[0];if(o){const e=getComputedStyle(o);a.leftCellLeft=Number.parseInt(e.borderLeftWidth)||0,a.leftCellRight=Number.parseInt(e.borderRightWidth)||0}const l=null==(i=e[t+1])?void 0:i.elements[0];return l&&(a.rightCellLeft=Number.parseInt(getComputedStyle(l).borderLeftWidth)||0),a}static createObject(e,t,r,n,i,a,s){const o=ColumnSizer.generateBorderWidthsInfo(t,r),l=ColumnSizer.getTotalCellBorderWidth(o),c=t.length-1===r,d=ColumnSizer.getMarginRight(o,c),u=ColumnSizer.getBackgroundImage(l,o.leftCellLeft,o.beforeLeftCellRight,c,n),p=ColumnSizer.shouldWidthBeIncreased(l),h={element:e,styles:{default:{width:p?`${l+2}px`:"1.5px",backgroundImage:u},hover:{width:p?1.5*(l+2)+"px":"9px"},static:{marginRight:d}},isSideCellHovered:!1,isSizerHovered:!1,isMouseUpOnSizer:!1};return s&&(h.hoverColor=s.hover||ColumnSizerElement.DEFAULT_HOVER_COLOR),a&&(h.movableElement=a),i&&(h.overlayElement=i),h}static create(e,t){const{_columnsDetails:r,_tableElementRef:n,columnResizerColors:i}=e,a=ColumnSizerElement.create(t,i.hover),s=MovableColumnSizerElement.create(i),o=ColumnSizerOverlayElement.create(),l=ColumnSizer.createObject(a,r,t,n,o,s,i);return ColumnSizerOverlayElement.applyEvents(e,l),l}}const _ColumnSizerFillerElement=class e{static create(t){const r=document.createElement("div");return r.classList.add(e.SIZER_FILLER_CLASS),r.style.backgroundColor=t||ColumnSizerElement.DEFAULT_HOVER_COLOR,r.style.display="none",r}static setWidth(e,t){const r=Number.parseInt(t);e.style.width=`${ColumnSizer.shouldWidthBeIncreased(r)?r:4}px`}static display(e){e.style.display="block"}static hide(e){e.style.display="none"}};_ColumnSizerFillerElement.SIZER_FILLER_CLASS="column-sizer-filler";let ColumnSizerFillerElement=_ColumnSizerFillerElement;const _ColumnSizerElement=class e{static isHovered(t){return t.style.backgroundImage===e.EMPTY_BACKGROUND_IMAGE}static setBackgroundImage(e,t){e.style.backgroundImage=t}static unsetBackgroundImage(t){t.style.backgroundImage=e.EMPTY_BACKGROUND_IMAGE}static setBackgroundColor(e,t){e.style.backgroundColor=t}static setTransitionTime(t){t.style.transition=e.TRANSITION_TIME}static unsetTransitionTime(e){e.style.transition="0.0s"}static unsetElementsToDefault(t,r,n=!0){n&&e.setBackgroundColor(t,SEMI_TRANSPARENT_COLOR),ColumnSizerFillerElement.hide(t.children[0]),t.style.width=r}static setStaticProperties(e,t){e.style.marginRight=t}static setElementId(t,r){t.id=`${e.COLUMN_SIZER_ID_PREFIX}${r}`}static create(t,r){const n=document.createElement("div");e.setElementId(n,t),n.classList.add(e.COLUMN_SIZER_CLASS);const i=ColumnSizerFillerElement.create(r);return n.append(i),e.hide(n),n}static display(e){var t;UpdateRowElement.updateHeaderRowHeight(null==(t=e.parentElement)?void 0:t.parentElement),e.style.display="flex"}static hide(e){e.style.display="none"}static hideWithBlurAnimation(t){setTimeout((()=>{e.hide(t)}),e.HALF_TRANSITION_TIME_ML)}static hideWhenCellNotHovered(t,r){t.isSideCellHovered||(r?e.hideWithBlurAnimation(t.element):e.hide(t.element))}static setHoverStyle(t,r,n,i){const{element:a,hoverColor:s}=t;ColumnSizerFillerElement.display(a.children[0]),n&&e.setTransitionTime(a),e.setBackgroundColor(a,i||s),a.style.width=r}};_ColumnSizerElement.FILLED_BACKGROUND_IMAGE="linear-gradient(180deg, #cdcdcd, #cdcdcd 75%, transparent 75%, transparent 100%)",_ColumnSizerElement.EMPTY_BACKGROUND_IMAGE="none",_ColumnSizerElement.DEFAULT_HOVER_COLOR="grey",_ColumnSizerElement.COLUMN_SIZER_CLASS="column-sizer",_ColumnSizerElement.COLUMN_SIZER_ID_PREFIX=`${_ColumnSizerElement.COLUMN_SIZER_CLASS}-`,_ColumnSizerElement.TRANSITION_TIME_ML=200,_ColumnSizerElement.TRANSITION_TIME=_ColumnSizerElement.TRANSITION_TIME_ML/1e3+"s",_ColumnSizerElement.HALF_TRANSITION_TIME_ML=_ColumnSizerElement.TRANSITION_TIME_ML/2;let ColumnSizerElement=_ColumnSizerElement;const _ColumnSizerOverlayEvents=class e{static overlayMouseEnter(t){if(t.isSizerHovered=!0,t.isMouseUpOnSizer||this._activeOverlayElements.selectedColumnSizer)return;const{width:r}=t.styles.hover;ColumnSizerElement.display(t.element),ColumnSizerElement.setTransitionTime(t.element),setTimeout((()=>{t.isSizerHovered&&ColumnSizerElement.setHoverStyle(t,r,!1)}),1),setTimeout((()=>{t.isSizerHovered&&ColumnSizerElement.unsetBackgroundImage(t.element)}),e.MOUSE_PASSTHROUGH_TIME_ML)}static unsetColorDuringTransition(e){setTimeout((()=>{e.isSizerHovered||(ColumnSizerElement.setBackgroundImage(e.element,e.styles.default.backgroundImage),setTimeout((()=>{e.isSizerHovered||(ColumnSizerElement.unsetTransitionTime(e.element),ColumnSizerElement.setBackgroundColor(e.element,SEMI_TRANSPARENT_COLOR))}),ColumnSizerElement.HALF_TRANSITION_TIME_ML))}),ColumnSizerElement.HALF_TRANSITION_TIME_ML)}static overlayMouseLeave(t){if(t.isSizerHovered=!1,this._activeOverlayElements.selectedColumnSizer||t.isMouseUpOnSizer)return;const{element:r,styles:n}=t;ColumnSizerElement.unsetElementsToDefault(r,n.default.width);const i=ColumnSizerElement.isHovered(r);setTimeout((()=>{!this._activeOverlayElements.selectedColumnSizer&&!t.isSizerHovered&&(e.unsetColorDuringTransition(t),ColumnSizerElement.hideWhenCellNotHovered(t,i))}),e.MOUSE_PASSTHROUGH_TIME_ML)}static overlayMouseDown(e){const{_columnsDetails:t,_tableBodyElementRef:r,_frameComponents:{displayAddNewRow:n}}=this,{columnSizer:i,sizerNumber:a}=ColumnSizerGenericUtils.getSizerDetailsViaElementId(e.id,t),{element:s,styles:o}=i;MovableColumnSizerElement.display(r,i,n),ColumnSizerElement.unsetElementsToDefault(s,o.default.width),ColumnSizerElement.setBackgroundImage(s,o.default.backgroundImage),this._activeOverlayElements.selectedColumnSizer=SelectedColumnSizer.get(this,a)}};_ColumnSizerOverlayEvents.MOUSE_PASSTHROUGH_TIME_ML=50;let ColumnSizerOverlayEvents=_ColumnSizerOverlayEvents;const _ColumnSizerOverlayElement=class e{static setStaticProperties(e,t,r){e.style.marginRight=t,e.style.width=r}static applyEvents(e,t){t.overlayElement.onmouseenter=ColumnSizerOverlayEvents.overlayMouseEnter.bind(e,t),t.overlayElement.onmouseleave=ColumnSizerOverlayEvents.overlayMouseLeave.bind(e,t),t.overlayElement.onmousedown=ColumnSizerOverlayEvents.overlayMouseDown.bind(e,t.element)}static create(){const t=document.createElement("div");return t.classList.add(e.SIZER_OVERLAY_CLASS),t}};_ColumnSizerOverlayElement.SIZER_OVERLAY_CLASS="column-sizer-overlay";let ColumnSizerOverlayElement=_ColumnSizerOverlayElement;class InsertRemoveColumnSizer{static updateIdsOfAllSubsequent(e,t){e.slice(t).forEach(((e,r)=>{if(!e.columnSizer)return;const n=t+r;ColumnSizerElement.setElementId(e.columnSizer.element,n)}))}static applySizerStateToElements(e){const{element:t,movableElement:r,overlayElement:n,styles:i}=e;ColumnSizerElement.unsetElementsToDefault(t,i.default.width),ColumnSizerFillerElement.setWidth(t.children[0],i.default.width),ColumnSizerElement.setStaticProperties(t,i.static.marginRight),ColumnSizerElement.setBackgroundImage(t,i.default.backgroundImage),MovableColumnSizerElement.setStaticProperties(r,i.static.marginRight,i.hover.width),ColumnSizerOverlayElement.setStaticProperties(n,i.static.marginRight,i.hover.width)}static insertAtIndex(e,t,r){const n=t.elements[0].nextSibling,i=ColumnSizer.create(e,r);t.columnSizer=i,n.appendChild(i.element),n.appendChild(i.overlayElement),n.appendChild(i.movableElement),InsertRemoveColumnSizer.applySizerStateToElements(i)}static updateSizer(e,t,r,n){const i=ColumnSizer.createObject(e.element,t,r,n);Object.assign(e,i),InsertRemoveColumnSizer.applySizerStateToElements(e)}static updatePrevious(e,t,r){var n;const i=t-1;if(i<0)return;const{columnSizer:a}=e[i];void 0!==(null==(n=e[i].settings.widths)?void 0:n.staticWidth)||!a||InsertRemoveColumnSizer.updateSizer(a,e,t,r)}static getNewColumnIndexIfWidthSet(e,t){var r;return e.length-1===t?null!=(r=e[t-1])&&r.columnSizer?-1:t-1:t}static isNotResizable(e){const{widths:t,isColumnResizable:r}=e.settings;return void 0!==(null==t?void 0:t.staticWidth)||!r}static insert(e,t){const{_columnsDetails:r}=e;if(!InsertRemoveColumnSizer.isNotResizable(r[t])){if(void 0!==e._tableDimensions.width){if(-1===(t=InsertRemoveColumnSizer.getNewColumnIndexIfWidthSet(e._columnsDetails,t))||InsertRemoveColumnSizer.isNotResizable(r[t]))return}else InsertRemoveColumnSizer.updatePrevious(r,t,e._tableElementRef);InsertRemoveColumnSizer.insertAtIndex(e,r[t],t),InsertRemoveColumnSizer.updateIdsOfAllSubsequent(r,t+1)}}static removeSizer(e){var t,r,n,i,a,s;null==(r=null==(t=e.columnSizer)?void 0:t.element)||r.remove(),null==(i=null==(n=e.columnSizer)?void 0:n.movableElement)||i.remove(),null==(s=null==(a=e.columnSizer)?void 0:a.overlayElement)||s.remove(),delete e.columnSizer}static removeIfLastColumn(e,t){return e.length===t&&e[t]&&(t-=1,InsertRemoveColumnSizer.removeSizer(e[t])),t}static remove(e,t){const{_tableDimensions:r,_columnsDetails:n,_tableElementRef:i}=e;void 0!==r.width&&(t=InsertRemoveColumnSizer.removeIfLastColumn(n,t)),InsertRemoveColumnSizer.updatePrevious(n,t,i),InsertRemoveColumnSizer.updateIdsOfAllSubsequent(n,t)}static cleanUpCustomColumnSizers(e,t){const{_tableDimensions:r,_columnsDetails:n}=e;if(void 0===r.width)return;let i=!1;for(let r=n.length-1;r>=0;r-=1){const a=n[r];if(InsertRemoveColumnSizer.isNotResizable(a))a.columnSizer&&InsertRemoveColumnSizer.removeSizer(a);else if(!1===i){if(i=!0,a.columnSizer&&InsertRemoveColumnSizer.removeSizer(a),r<t)break}else if(!a.columnSizer&&n.length-1!==r&&InsertRemoveColumnSizer.insertAtIndex(e,a,r),!0===i&&r<t)break}}}class DropdownDisplaySettingsUtil{static process(e){e.isAvailable??(e.isAvailable=!0),e.isAvailable?(e.openMethod??(e.openMethod={}),e.openMethod.overlayClick?delete e.openMethod.cellClick:e.openMethod.cellClick?delete e.openMethod.overlayClick:e.openMethod.overlayClick=!0):(delete e.openMethod,delete e.overlayStyles)}}class ColumnSettingsDefaultTextUtils{static unsetDefaultText(e,t,r){t.elements.slice(1).forEach(((t,n)=>{const i=n+1;CellEvents.removeTextIfDefault(e,i,r,t)}))}static setDefaultText(e,t,r){t.elements.slice(1).forEach(((t,n)=>{const i=n+1;CellEvents.setCellToDefaultIfNeeded(e,i,r,t,!1)})),setTimeout((()=>FireEvents.onDataUpdate(e)))}}class ColumnSettingsWidthUtils{static getSettingsWidthNumber(e,t,r=!0){return StringDimensionUtils.generateNumberDimensionFromClientString(e,t,r?"staticWidth":"initialWidth",!0,ColumnDetails.MINIMAL_COLUMN_WIDTH)}static updateColumnWidth(e,t,r,n){const{_tableDimensions:i,_tableElementRef:a}=e,{number:s}=ColumnSettingsWidthUtils.getSettingsWidthNumber(a,r);t.style.width=`${s}px`,TableElement.changeStaticWidthTotal(i,n?s:-s)}static changeWidth(e,t,r,n){let i=!1;null!=r&&r.staticWidth&&(ColumnSettingsWidthUtils.updateColumnWidth(e,t,r,!1),i=!0),null!=n&&n.staticWidth&&(ColumnSettingsWidthUtils.updateColumnWidth(e,t,n,!0),i=!0),i&&StaticTableWidthUtils.changeWidthsBasedOnColumnInsertRemove(e,!0)}}class ColumnDropdownCellOverlayEvents{static mouseClick(e,t){ColumnDropdown.display(this,e);const r=t.elements[0];setTimeout((()=>FocusedCellUtils.setHeaderCell(this._focusedElements.cell,r,e)))}static mouseLeave(e){var t;ColumnDropdownCellOverlay.hide(this,e),delete this._hoveredElements.headerCell,ColumnDropdownCellOverlay.resetDefaultColor(e.columnDropdownCellOverlay,null==(t=this._defaultColumnsSettings.columnDropdown)?void 0:t.displaySettings)}static mouseEnter(e){var t;const r=e.elements[0];this._hoveredElements.headerCell=r,ColumnDropdownCellOverlay.setHoverColor(e,null==(t=this._defaultColumnsSettings.columnDropdown)?void 0:t.displaySettings)}static setEvents(e,t){const r=e._columnsDetails[t],{columnDropdownCellOverlay:n}=r;n&&(n.onmouseenter=ColumnDropdownCellOverlayEvents.mouseEnter.bind(e,r),n.onmouseleave=ColumnDropdownCellOverlayEvents.mouseLeave.bind(e,r),n.onclick=ColumnDropdownCellOverlayEvents.mouseClick.bind(e,t,r))}}class EditableHeaderIconTextEvents{static keyDownOnText(e,t,r){UpdateRowElement.updateHeadRowHeightOnKeyDown(this._tableBodyElementRef),r.key===KEYBOARD_KEY.TAB&&CellTextEvents.tabOutOfCell(this,e,t,r)}static blurText(e,t,r){const n=r.target,i=CellElement.getCellElement(n);HeaderText.onAttemptChange(this,i,t),DataCellEvents.blur(this,e,t,n)}static setEvents(e,t,r,n){e._columnsDetails[n].settings.isHeaderTextEditable&&(t.onfocus=CellWithTextEvents.focusText.bind(e,r,n,null),t.onblur=EditableHeaderIconTextEvents.blurText.bind(e,r,n),t.onkeydown=EditableHeaderIconTextEvents.keyDownOnText.bind(e,r,n))}}class ColumnSizerCellEvents{static hideColumnSizer(e){if(!e)return;e.isSideCellHovered=!1;const t=ColumnSizerElement.isHovered(e.element);setTimeout((()=>{e.isSizerHovered||ColumnSizerElement.hideWhenCellNotHovered(e,t)}))}static cellMouseLeave(e,t){var r,n;ColumnSizerCellEvents.hideColumnSizer(null==(r=e[t-1])?void 0:r.columnSizer),ColumnSizerCellEvents.hideColumnSizer(null==(n=e[t])?void 0:n.columnSizer)}static displayColumnSizer(e){e&&(ColumnSizerElement.display(e.element),e.isSideCellHovered=!0)}static cellMouseEnter(e,t){var r,n;ColumnSizerCellEvents.displayColumnSizer(null==(r=e[t-1])?void 0:r.columnSizer),ColumnSizerCellEvents.displayColumnSizer(null==(n=e[t])?void 0:n.columnSizer)}}class HeaderCellEvents{static mouseEnterCell(e,t){var r,n,i,a;if(!this._activeOverlayElements.selectedColumnSizer){const s=this._columnsDetails[e],o=t.target;CellHighlightUtils.highlight(o,null==(r=s.headerStateColors)?void 0:r.hover),ColumnSizerCellEvents.cellMouseEnter(this._columnsDetails,e),(null==(a=null==(i=null==(n=this._defaultColumnsSettings.columnDropdown)?void 0:n.displaySettings)?void 0:i.openMethod)?void 0:a.overlayClick)&&ColumnDropdownCellOverlay.display(s),this._hoveredElements.headerCell=o}}static mouseLeaveCell(e,t){var r,n,i,a;Dropdown.isDisplayed(this._activeOverlayElements.columnDropdown)||(CellHighlightUtils.fade(t.target,null==(r=this._columnsDetails[e].headerStateColors)?void 0:r.default),ColumnDropdownCellOverlay.hide(this,this._columnsDetails[e]),null!=(a=null==(i=null==(n=this._defaultColumnsSettings.columnDropdown)?void 0:n.displaySettings)?void 0:i.openMethod)&&a.overlayClick&&delete this._hoveredElements.headerCell),this._activeOverlayElements.selectedColumnSizer||ColumnSizerCellEvents.cellMouseLeave(this._columnsDetails,e)}static mouseClick(e,t){var r,n,i;const a=t.target;CellEvents.removeTextIfDefault(this,0,e,a),(null==(i=null==(n=null==(r=this._defaultColumnsSettings.columnDropdown)?void 0:r.displaySettings)?void 0:n.openMethod)?void 0:i.cellClick)&&ColumnDropdown.display(this,e),setTimeout((()=>FocusedCellUtils.setHeaderCell(this._focusedElements.cell,a,e)))}static setEvents(e,t,r){t.onmouseenter=HeaderCellEvents.mouseEnterCell.bind(e,r),t.onmouseleave=HeaderCellEvents.mouseLeaveCell.bind(e,r),t.onclick=HeaderCellEvents.mouseClick.bind(e,r),DragColumn.applyEventsToElement(e,t,t)}}class EditableHeaderCellEvents{static mouseClickCell(e,t){const r=t.target;FocusedCellUtils.purge(this._focusedElements.cell),setTimeout((()=>FocusedCellUtils.setHeaderCell(this._focusedElements.cell,r,e)))}static setEvents(e,t,r,n){if(t.onmouseenter=HeaderCellEvents.mouseEnterCell.bind(e,n),t.onmouseleave=HeaderCellEvents.mouseLeaveCell.bind(e,n),e.displayHeaderIcons){t.onfocus=()=>{},t.onblur=()=>{},t.onmousedown=CellWithTextEvents.mouseDown.bind(e,null),t.onclick=EditableHeaderCellEvents.mouseClickCell.bind(e,n);const i=CellElement.getTextElement(t);EditableHeaderIconTextEvents.setEvents(e,i,r,n)}else t.onclick=HeaderCellEvents.mouseClick.bind(e,n)}}class CellEventsReset{static unset(e){e.onfocus=()=>{},e.onblur=()=>{},e.onmouseenter=()=>{},e.onmouseleave=()=>{},e.onmousedown=()=>{},e.oninput=()=>{},e.onpaste=()=>{},e.onkeydown=()=>{}}static setDataCellEvents(e,t,r,n){const{settings:i,activeType:a}=e._columnsDetails[n];if(!i.isCellTextEditable)return;DataCellEvents.setEvents(e,t,r,n);const{cellDropdownProps:s,calendar:o,checkbox:l}=a;s?SelectCell.setEvents(e,t,r,n):o?DateCellEvents.setEvents(e,t,r,n):l&&CheckboxCellEvents.setEvents(e,t,r,n)}static setHeaderCellEvents(e,t,r,n){var i,a,s;null!=(s=null==(a=null==(i=e._defaultColumnsSettings.columnDropdown)?void 0:i.displaySettings)?void 0:a.openMethod)&&s.cellClick?HeaderCellEvents.setEvents(e,t,n):(DataCellEvents.setEvents(e,t,r,n),EditableHeaderCellEvents.setEvents(e,t,0,n),ColumnDropdownCellOverlayEvents.setEvents(e,n))}static reset(e,t,r,n){0===r?CellEventsReset.setHeaderCellEvents(e,t,r,n):CellEventsReset.setDataCellEvents(e,t,r,n),!e._frameComponents.displayIndexColumn&&0===n&&RowDropdownCellOverlayEvents.addCellEvents(e,r,t)}}class ResetColumnStructure{static reset(e,t,r){const{elements:n,activeType:i,settings:a}=t;n.slice(1).forEach((e=>{a.isCellTextEditable||CellEventsReset.unset(e)})),ChangeColumnType.setNewStructureBasedOnType(e,r,i),ColumnSettingsBorderUtils.resetBorderOverwritingState(t),setTimeout((()=>FireEvents.onColumnsUpdate(e)))}}class ColumnSettingsUtils{static updateSizer(e,t){const{_columnsDetails:r,_tableElementRef:n}=e;if(!n)return;const{columnSizer:i}=r[t];i||InsertRemoveColumnSizer.insert(e,t),InsertRemoveColumnSizer.cleanUpCustomColumnSizers(e,t),i&&InsertRemoveColumnSizer.updateSizer(i,r,t,n);const a=t-1;if(t>0&&r[a].columnSizer){const{columnSizer:e}=r[a];InsertRemoveColumnSizer.updateSizer(e,r,a,n)}}static change(e,t,r,n,i,a){const s=e._columnsDetails[r];ColumnSettingsDefaultTextUtils.unsetDefaultText(e,s,r),s.settings=i,s.activeType=ColumnTypesUtils.getActiveType(i,s.settings.defaultColumnTypeName),ResetColumnStructure.reset(e,s,r),ColumnSettingsDefaultTextUtils.setDefaultText(e,s,r),a||ColumnSettingsWidthUtils.changeWidth(e,t,n.widths,i.widths),ColumnSettingsStyleUtils.changeStyleFunc(e,r,n),ColumnSettingsBorderUtils.updateSiblingColumns(e,r),ColumnSettingsUtils.updateSizer(e,r),e.displayHeaderIcons&&HeaderIconCellElement.changeHeaderIcon(e._columnsDetails[r]),ColumnDropdownCellOverlay.updateIfDisplayed(s),AddNewColumnElement.toggle(e,!0)}static parseSettingsChange(e){const{_customColumnsSettings:t,_columnsDetails:r,_focusedElements:{cell:{element:n,columnIndex:i}}}=e,a=r[i].settings,s=t[CellElement.getText(n)];return{oldSettings:a,newSettings:s,areSettingsDifferent:!!s&&a!==s}}static changeColumnSettingsIfNameDifferent(e,t,r,n=!1){const{oldSettings:i,newSettings:a,areSettingsDifferent:s}=ColumnSettingsUtils.parseSettingsChange(e);s&&ColumnSettingsUtils.change(e,t,r,i,a,n)}static setDropdownSettings(e,t){!e||!t||(e.isSortAvailable??(e.isSortAvailable=t.isSortAvailable),e.isDeleteAvailable??(e.isDeleteAvailable=t.isDeleteAvailable),e.isInsertLeftAvailable??(e.isInsertLeftAvailable=t.isInsertLeftAvailable),e.isInsertRightAvailable??(e.isInsertRightAvailable=t.isInsertRightAvailable),e.isMoveAvailable??(e.isMoveAvailable=t.isMoveAvailable))}static processCellDimensions(e){const t=e.cellStyle;if(!t)return;const r=e;if(t.width){const n=!1===e.isColumnResizable?"staticWidth":"initialWidth";r.widths={[n]:t.width}}else r.widths&&e.isColumnResizable&&r.widths.staticWidth&&(r.widths={initialWidth:r.widths.staticWidth});StringDimensionUtils.removeAllDimensions(t)}static createInternalSettings(e,t){const r=e;return ColumnSettingsStyleUtils.doesSettingHaveSideBorderStyle(r)&&(r.stylePrecedence=!0),ColumnSettingsUtils.setDropdownSettings(e.columnDropdown,t.columnDropdown),Object.keys(t).forEach((e=>{r[e]??(r[e]=t[e])})),r.types=ColumnTypesUtils.getProcessedTypes(r),ColumnSettingsUtils.processCellDimensions(e),r}static createInternalMap(e,t){return e.reduce(((e,r)=>(e[r.headerName]=ColumnSettingsUtils.createInternalSettings(r,t),e)),{})}static setDefaultTypeProperties(e){const{_defaultColumnsSettings:t}=e;t.availableDefaultColumnTypes=e.availableDefaultColumnTypes,t.customColumnTypes=e.customColumnTypes,t.defaultColumnTypeName=e.defaultColumnTypeName,t.types=ColumnTypesUtils.getProcessedTypes(t)}static setDefaultDropdownProperties(e){var t,r,n,i,a,s;const{_defaultColumnsSettings:o}=e,l={openMethod:{cellClick:!0}};o.columnDropdown=e.columnDropdown||{displaySettings:l},(t=o.columnDropdown).displaySettings??(t.displaySettings=l),DropdownDisplaySettingsUtil.process(o.columnDropdown.displaySettings),(r=o.columnDropdown).isSortAvailable??(r.isSortAvailable=!0),(n=o.columnDropdown).isDeleteAvailable??(n.isDeleteAvailable=!0),(i=o.columnDropdown).isInsertLeftAvailable??(i.isInsertLeftAvailable=!0),(a=o.columnDropdown).isInsertRightAvailable??(a.isInsertRightAvailable=!0),(s=o.columnDropdown).isMoveAvailable??(s.isMoveAvailable=!0)}static setDefaultGenericProperties(e){const{_defaultColumnsSettings:t}=e;t.defaultText=e.defaultText??EMPTY_STRING,t.isDefaultTextRemovable=e.isDefaultTextRemovable??!0,t.cellStyle=e.cellStyle,t.isCellTextEditable=e.isCellTextEditable??!0,t.headerStyles=e.headerStyles,t.isHeaderTextEditable=e.isHeaderTextEditable??t.isCellTextEditable,t.headerIconStyle=e.headerIconStyle,t.isColumnResizable=e.isColumnResizable??!0}static setDefaultColumnsSettings(e){const{_defaultColumnsSettings:t}=e;ColumnSettingsUtils.setDefaultGenericProperties(e),ColumnSettingsUtils.processCellDimensions(t),ColumnSettingsUtils.setDefaultDropdownProperties(e),ColumnSettingsUtils.setDefaultTypeProperties(e)}static setUpInternalSettings(e){ColumnSettingsUtils.setDefaultColumnsSettings(e),e._customColumnsSettings=ColumnSettingsUtils.createInternalMap(e.customColumnsSettings,e._defaultColumnsSettings)}}class HeaderText{static onAttemptChange(e,t,r,n){const i=null==n?void 0:n.colRemove;i||ColumnSettingsUtils.changeColumnSettingsIfNameDifferent(e,t,r,null==n?void 0:n.colMove),e._visiblityInternal.filters&&FilterInternalUtils.wasHeaderChanged(e._columnsDetails,e._visiblityInternal.filters,r,i)&&VisibilityUtils.headerChanged(e)}}class NestedDropdownItem{static resetItemStyle(e){Array.from(e.children).forEach((e=>{const t=e;t.style.backgroundColor="",t.style.color=""}))}}NestedDropdownItem.NESTED_DROPDOWN_ITEM="nested-dropdown-item";class DropdownItemNavigation{static focusInputElement(e){e.children[0].dispatchEvent(new MouseEvent("mouseenter"))}static focusItemWhenOnEdge(e,t,r){var n;if(DropdownItem.doesElementContainInputClass(e)){const n=e.parentElement;return DropdownItemNavigation.focusSiblingItem(n,t,r)}(null==(n=e.parentElement)?void 0:n.parentElement).classList.contains(DropdownItem.DROPDOWN_ITEM_CLASS)&&(t=e.parentElement);const i=r?t.children[0]:t.children[t.children.length-1];return DropdownItemNavigation.focusSiblingItem(i,t,r,!0)}static focusSiblingItem(e,t,r,n=!1){if(e.classList.contains(NestedDropdownItem.NESTED_DROPDOWN_ITEM)){const t=e.children[2];Dropdown.isDisplayed(t)&&Dropdown.hide(t)}const i=n?e:e[r?"nextSibling":"previousSibling"];return i?!DropdownItem.isDisplayed(i)||i.classList.contains(DropdownItem.DROPDOWN_TITLE_ITEM_CLASS)||i.classList.contains(DropdownItem.DROPDOWN_ITEM_DIVIDER_CLASS)?DropdownItemNavigation.focusSiblingItem(i,t,r):i.classList.contains(DropdownItem.DROPDOWN_INPUT_ITEM_CLASS)?DropdownItemNavigation.focusInputElement(i):void i.dispatchEvent(new MouseEvent("mouseenter")):DropdownItemNavigation.focusItemWhenOnEdge(e,t,r)}static focusFirstNestedDropdownItem(e){if(e.classList.contains(NestedDropdownItem.NESTED_DROPDOWN_ITEM)){const t=e.children[2];Dropdown.isDisplayed(t)&&t.children[0].dispatchEvent(new MouseEvent("mouseenter"))}}static focusNestedDropdownParentItem(e){var t;const r=null==(t=e.parentElement)?void 0:t.parentElement;r.classList.contains(DropdownItem.DROPDOWN_ITEM_CLASS)&&(Dropdown.hide(e.parentElement),r.dispatchEvent(new MouseEvent("mouseenter")))}}class ColumnTypeDropdownItemEvents{static onClickMiddleware(e){ColumnSettingsUtils.parseSettingsChange(this).areSettingsDifferent||e(),ColumnDropdown.processTextAndHide(this)}static set(e,t,r){t.forEach((t=>{const n=t;n.onclick=ColumnTypeDropdownItemEvents.onClickMiddleware.bind(e,ChangeColumnType.change.bind(e,n.innerText.trim(),r))}))}}class ColumnTypeDropdownItem{static unsetActiveItem(e){const t=e.getElementsByClassName(DropdownItem.ACTIVE_ITEM_CLASS)[0];t&&(t.children[0].style.filter="",t.classList.remove(DropdownItem.ACTIVE_ITEM_CLASS))}static reset(e){ColumnTypeDropdownItem.unsetActiveItem(e),DropdownItem.removeItems(e)}static setActiveItem(e,t){const r=e.find((e=>CellElement.getText(e)===t));r&&(r.classList.add(DropdownItem.ACTIVE_ITEM_CLASS),r.children[0].style.filter=SVGIconUtils.WHITE_FILTER)}static setUp(e,t){const{columnTypeDropdown:r}=e._activeOverlayElements,n=e._columnsDetails[t],i=n.settings.types.map((e=>e.dropdownItem.element));DropdownItem.addButtonItemElements(e,r,i),ColumnTypeDropdownItemEvents.set(e,i,t),ColumnTypeDropdownItem.setActiveItem(i,n.activeType.name)}}class DropdownEvents{static itemKeyNavigation(e,t,r){if(r.key===KEYBOARD_KEY.TAB||r.key===KEYBOARD_KEY.ARROW_DOWN){r.preventDefault();const n=null!=e&&e.activeElement?r.target:t.children[0];DropdownItemNavigation.focusSiblingItem(n,t,!0)}else r.key===KEYBOARD_KEY.ARROW_UP?DropdownItemNavigation.focusSiblingItem(r.target,t,!1):r.key===KEYBOARD_KEY.ARROW_RIGHT?DropdownItemNavigation.focusFirstNestedDropdownItem(r.target):r.key===KEYBOARD_KEY.ARROW_LEFT&&DropdownItemNavigation.focusNestedDropdownParentItem(r.target)}}class ColumnDropdownEvents{static focusNextColumnDropdown(e,t){var r,n,i;t.preventDefault(),ColumnDropdown.processTextAndHide(e);let a=e._focusedElements.cell.columnIndex;a===e._columnsDetails.length-1&&(a=-1);const s=e._columnsDetails[a+1];null!=(i=null==(n=null==(r=e._defaultColumnsSettings.columnDropdown)?void 0:r.displaySettings)?void 0:n.openMethod)&&i.cellClick?s.elements[0].click():s.columnDropdownCellOverlay.click()}static onKeyDown(e,t){if(t.key===KEYBOARD_KEY.ENTER){const e=t.target;DropdownItem.doesElementContainInputClass(e)?ColumnDropdown.processTextAndHide(this):(e.dispatchEvent(new Event("mouseenter")),e.dispatchEvent(new Event("click")))}else t.key===KEYBOARD_KEY.ESCAPE?ColumnDropdown.processTextAndHide(this):t.key===KEYBOARD_KEY.TAB&&this._columnsDetails.length>0?ColumnDropdownEvents.focusNextColumnDropdown(this,t):DropdownEvents.itemKeyNavigation(this.shadowRoot,e,t)}static set(e,t){t.onkeydown=ColumnDropdownEvents.onKeyDown.bind(e,t)}}function buildIcon$4(e){return`<?xml version="1.0" standalone="no"?>\n    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">\n    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="16" style="transform: ${e}">\n      <g transform="matrix(0.84210527 0 0 0.84210527 0 0)">\n        <g transform="matrix(0.027142858 0 0 0.027142858 0 0)">\n          <path d="M186.67 193.5L186.67 58.33C 186.67 51.888603 191.8927 46.666 198.334 46.666C 204.7793 46.666 210.002 51.888702 210.002 58.33L210.002 58.33L210.002 193.5L260.08398 143.418C 264.64258 138.8594 272.029 138.8594 276.58398 143.418C 281.14258 147.9727 281.14258 155.359 276.58398 159.918L276.58398 159.918L206.58398 229.918C 202.02928 234.4727 194.64299 234.4727 190.08398 229.918L190.08398 229.918L120.083984 159.918C 115.52928 155.3594 115.52928 147.97299 120.083984 143.418C 124.642586 138.8594 132.02899 138.8594 136.58398 143.418L136.58398 143.418L186.67 193.5zM396.66998 93.33L326.66998 93.33L326.66998 443.33002L396.66998 443.33002zM420.00198 93.33L420.00198 443.33002L490.00198 443.33002L490.00198 93.33002zM151.672 490C 145.2267 490 140.004 484.7773 140.004 478.332L140.004 478.332L140.004 268.332C 140.004 261.8906 145.2267 256.668 151.672 256.668L151.672 256.668L245.004 256.668C 251.4454 256.668 256.672 261.8907 256.672 268.332L256.672 268.332L256.672 478.332C 256.672 484.7773 251.4454 490 245.004 490zM163.336 466.668L233.336 466.668L233.336 279.998L163.336 279.998zM315.00598 466.668C 308.56458 466.668 303.33798 461.4414 303.33798 455L303.33798 455L303.33798 81.67001C 303.33798 75.22472 308.56458 70.002014 315.00598 70.002014L315.00598 70.002014L501.67596 70.002014C 508.11737 70.002014 513.33997 75.22472 513.33997 81.67001L513.33997 81.67001L513.33997 455C 513.33997 461.4414 508.11728 466.668 501.67596 466.668z" stroke="none" fill="#000000" fill-rule="nonzero" />\n        </g>\n      </g>\n    </svg>`}const INSERT_LEFT_ICON_SVG_STRING=buildIcon$4(""),INSERT_RIGHT_ICON_SVG_STRING=buildIcon$4("rotate(180deg) scale(1, -1)"),INSERT_UP_ICON_SVG_STRING=buildIcon$4("rotate(90deg) scale(1, -1)"),INSERT_DOWN_ICON_SVG_STRING=buildIcon$4("rotate(-90deg)");function buildIcon$3(e){return`<?xml version="1.0" standalone="no"?>\n    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">\n    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="9" height="9" style="transform: ${e}">\n      <g transform="matrix(0.47368425 0 0 0.47368425 0 0)">\n        <g transform="matrix(0.027142858 0 0 0.027142858 0 0)">\n          <g>\n            <path d="M169 139.73L308.72998 0L349.175 40.484L109.124985 280.544L348.645 520.054L308.74698 559.999L169.01698 420.26904C 92.164986 343.42105 29.286987 280.29904 29.286987 279.99902C 29.286987 279.699 92.165985 216.57303 169.01698 139.72902L169.01698 139.72902L169 139.73zM490.55 139.73L630.27997 0L670.725 40.484L430.675 280.544L670.195 520.054L630.297 559.999L490.56702 420.26904C 413.71503 343.42105 350.83704 280.29904 350.83704 279.99902C 350.83704 279.699 413.71603 216.57303 490.56702 139.72902z" stroke="none" fill="#000000" fill-rule="nonzero" />\n          </g>\n        </g>\n      </g>\n    </svg>`}const MOVE_LEFT_ICON_SVG_STRING=buildIcon$3(""),MOVE_RIGHT_ICON_SVG_STRING=buildIcon$3("rotate(180deg)"),MOVE_UP_ICON_SVG_STRING=buildIcon$3("rotate(90deg)"),MOVE_DOWN_ICON_SVG_STRING=buildIcon$3("rotate(-90deg)");function buildIcon$2(e){return`<?xml version="1.0" standalone="no"?>\n    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">\n    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="9" height="12" style="transform: ${e}">\n      <g transform="matrix(0.5 0 0 0.5 0 0)">\n        <path d="M0 0L24 0L24 24L0 24L0 0z" stroke="none" fill="none" />\n        <path d="M3 18L9 18L9 16L3 16L3 18zM3 6L3 8L21 8L21 6L3 6zM3 13L15 13L15 11L3 11L3 13z" stroke="none" fill="#000000" fill-rule="nonzero" />\n      </g>\n    </svg>`}const SORT_ASC_ICON_SVG_STRING=buildIcon$2("scale(1, -1)"),SORT_DESC_ICON_SVG_STRING=buildIcon$2(""),TRASH_ICON_SVG_STRING='<?xml version="1.0" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="15">\n  <g transform="matrix(1.0666668 0 0 1.0714285 0 0)">\n    <g transform="matrix(0.027142858 0 0 0.027142858 0 0)">\n      <g>\n        <path d="M459.21 156.28L448.835 436.32C 448.6592 441.1247 444.4248 445.195 439.6006 445.195L439.6006 445.195L260.40057 445.195C 255.58028 445.195 251.34198 441.1091 251.16617 436.32L251.16617 436.32L240.79117 156.28C 240.50601 148.5534 234.00996 142.522 226.28317 142.807C 218.55658 143.09607 212.52518 149.58821 212.81018 157.315L212.81018 157.315L223.18118 437.355C 223.91946 457.195 240.51718 473.195 260.40018 473.195L260.40018 473.195L439.60016 473.195C 459.47516 473.195 476.08017 457.22202 476.81915 437.355L476.81915 437.355L487.19016 157.315C 487.4753 149.58841 481.44406 143.09601 473.71716 142.807C 465.99057 142.52185 459.49417 148.5531 459.20917 156.28L459.20917 156.28L459.21 156.28z" stroke="none" fill="#000000" fill-rule="nonzero" />\n        <path d="M338.8 212.8L338.8 403.2C 338.8 409.3875 343.81168 414.39902 349.999 414.39902C 356.1863 414.39902 361.198 409.38733 361.198 403.2L361.198 403.2L361.198 212.80002C 361.198 206.61252 356.1863 201.60101 349.999 201.60101C 343.81168 201.60101 338.8 206.61272 338.8 212.80002L338.8 212.80002L338.8 212.8z" stroke="none" fill="#000000" fill-rule="nonzero" />\n        <path d="M277.2 213.13L282.8016 403.53C 282.9852 409.7136 288.14142 414.581 294.32462 414.397C 300.5082 414.21732 305.3756 409.0572 305.19162 402.874L305.19162 402.874L299.59003 212.474C 299.41034 206.2904 294.2502 201.423 288.06702 201.607C 281.88342 201.78668 277.02002 206.9468 277.2 213.12999L277.2 213.12999L277.2 213.13z" stroke="none" fill="#000000" fill-rule="nonzero" />\n        <path d="M400.41 212.47L394.8084 402.87C 394.62482 409.0536 399.492 414.214 405.6754 414.393C 411.859 414.5766 417.0154 409.7094 417.19843 403.526L417.19843 403.526L422.80002 213.126C 422.9797 206.94241 418.11642 201.78201 411.933 201.60301C 405.74942 201.41942 400.58902 206.2866 400.41 212.47002L400.41 212.47002L400.41 212.47z" stroke="none" fill="#000000" fill-rule="nonzero" />\n        <path d="M210 162.4L490 162.4C 497.7305 162.4 504 156.1344 504 148.4C 504 140.6695 497.7305 134.4 490 134.4L490 134.4L210 134.4C 202.2695 134.4 196 140.6695 196 148.4C 196 156.1344 202.2695 162.4 210 162.4z" stroke="none" fill="#000000" fill-rule="nonzero" />\n        <path d="M307.46 143.85L313.2881 123.44401C 314.5381 119.076805 320.20218 114.803406 324.75308 114.803406L324.75308 114.803406L375.2451 114.803406C 379.7959 114.803406 385.46008 119.07291 386.71008 123.44401L386.71008 123.44401L392.53818 143.85L419.46017 136.15471L413.63208 115.75271C 408.94458 99.35771 392.29608 86.80371 375.2451 86.80371L375.2451 86.80371L324.75308 86.80371C 307.7021 86.80371 291.05008 99.36271 286.3661 115.75271L286.3661 115.75271L280.538 136.15471L307.46 143.85z" stroke="none" fill="#000000" fill-rule="nonzero" />\n      </g>\n    </g>\n  </g>\n</svg>';class ColumnDropdownButtonItemConf{}ColumnDropdownButtonItemConf.ITEMS=[{text:"Sort Ascending",iconSettings:{svgString:SORT_ASC_ICON_SVG_STRING,containerStyles:{dropdown:{marginRight:"9px",marginTop:"2px"}}}},{text:"Sort Descending",iconSettings:{svgString:SORT_DESC_ICON_SVG_STRING,containerStyles:{dropdown:{marginRight:"9px",marginTop:"1px"}}}},{text:"Insert Left",iconSettings:{svgString:INSERT_LEFT_ICON_SVG_STRING,containerStyles:{dropdown:{marginLeft:"-2px",marginRight:"3px",marginTop:"1px"}}}},{text:"Insert Right",iconSettings:{svgString:INSERT_RIGHT_ICON_SVG_STRING,containerStyles:{dropdown:{marginLeft:"-3px",marginRight:"4px",marginTop:"1px"}}}},{text:"Move Left",iconSettings:{svgString:MOVE_LEFT_ICON_SVG_STRING,containerStyles:{dropdown:{marginLeft:"1px",marginRight:"7px",marginTop:"3.5px"}}}},{text:"Move Right",iconSettings:{svgString:MOVE_RIGHT_ICON_SVG_STRING,containerStyles:{dropdown:{marginLeft:"1px",marginRight:"7px",marginTop:"1.5px"}}}},{text:"Delete",iconSettings:{svgString:TRASH_ICON_SVG_STRING,containerStyles:{dropdown:{marginLeft:"-4px",marginRight:"5px",marginTop:"-1px"}}}}];class UpdateCellsForColumns{static updateColumn(e,t,r,n,i){i!==CELL_UPDATE_TYPE.REMOVED&&CellEventsReset.reset(e,r,t,n),FireEvents.onCellUpdate(e,CellElement.getText(r),t,n,i)}static updateNextBeforeLastColumns(e,t,r,n){ExtractElements.textCellsArrFromRow(t.element).slice(r,n).forEach(((n,i)=>{const a=i+r;UpdateCellsForColumns.updateColumn(e,t.index,n,a,CELL_UPDATE_TYPE.UPDATE)}))}static rebindAndFireUpdates(e,t,r,n,i){UpdateCellsForColumns.updateNextBeforeLastColumns(e,t,r,i.index),UpdateCellsForColumns.updateColumn(e,t.index,i.element,i.index,n)}}class LastColumn{static getDetails(e,t){const r=e.length-1;return{element:e[r].elements[t],index:r}}}class RemoveColumn{static reduceStaticWidthTotal(e,t){var r;if(null!=(r=t.widths)&&r.staticWidth){const{number:r}=ColumnSettingsWidthUtils.getSettingsWidthNumber(e._tableElementRef,t.widths);TableElement.changeStaticWidthTotal(e._tableDimensions,-r)}}static updateTableDimensions(e,t){RemoveColumn.reduceStaticWidthTotal(e,t),StaticTableWidthUtils.changeWidthsBasedOnColumnInsertRemove(e,!1)}static cleanUpData(e){e.length>0&&0===e[0].length&&e.splice(0)}static removeElements(e,t,r){const n=CellElementIndex.getViaColumnIndex(t,r);e.children[n].remove(),e.children[n].remove()}static removeCell(e,t,r,n){const i=LastColumn.getDetails(e._columnsDetails,r);RemoveColumn.removeElements(t,n,!!e._frameComponents.displayIndexColumn),e.data[r].splice(n,1),setTimeout((()=>{const a={element:t,index:r};UpdateCellsForColumns.rebindAndFireUpdates(e,a,n,CELL_UPDATE_TYPE.REMOVED,i)}))}static removeCellFromAllRows(e,t){ExtractElements.textRowsArrFromTBody(e._tableBodyElementRef,e.data).forEach(((r,n)=>{RemoveColumn.removeCell(e,r,n,t)})),RemoveColumn.cleanUpData(e.data),HeaderText.onAttemptChange(e,e._columnsDetails[t].elements[0],t,{colRemove:!0});const r=e._columnsDetails.splice(t,1)[0];return RemoveColumn.updateTableDimensions(e,r.settings),r}static remove(e,t){const r=RemoveColumn.removeCellFromAllRows(e,t);ToggleAdditionElements.update(e,!1,AddNewColumnElement.toggle),ColumnSettingsBorderUtils.updateSiblingColumns(e,t),setTimeout((()=>{r.cellDropdown.element.remove(),InsertRemoveColumnSizer.remove(e,t),InsertRemoveColumnSizer.cleanUpCustomColumnSizers(e,t),0===t&&e._columnsDetails.length>0&&RowDropdownCellOverlay.resetOverlays(e),setTimeout((()=>{FireEvents.onDataUpdate(e),FireEvents.onColumnsUpdate(e)}))}))}static removeEvent(e){RemoveColumn.remove(this,e)}}class ElementSiblingIterator{static create(e){let t=e;return{next:()=>{const e=t.nextSibling;return e&&(t=e),e},currentElement:()=>t}}}class ColumnDropdownItemEvents{static onClickMiddleware(e){e(),ColumnDropdown.processTextAndHide(this)}static setItemEvents(e,t,r){const n=r.getElementsByClassName(ColumnDropdownItem.SORT_ITEM_CLASS)[0],i=ElementSiblingIterator.create(n);i.currentElement().onclick=ColumnDropdownItemEvents.onClickMiddleware.bind(e,Sort.sortColumn.bind(this,e,t,!0)),i.next().onclick=ColumnDropdownItemEvents.onClickMiddleware.bind(e,Sort.sortColumn.bind(this,e,t,!1)),i.next().onclick=ColumnDropdownItemEvents.onClickMiddleware.bind(e,InsertNewColumn.insert.bind(this,e,t)),i.next().onclick=ColumnDropdownItemEvents.onClickMiddleware.bind(e,InsertNewColumn.insert.bind(this,e,t+1)),i.next().onclick=ColumnDropdownItemEvents.onClickMiddleware.bind(e,MoveColumn.move.bind(this,e,t,!1)),i.next().onclick=ColumnDropdownItemEvents.onClickMiddleware.bind(e,MoveColumn.move.bind(this,e,t,!0)),i.next().onclick=ColumnDropdownItemEvents.onClickMiddleware.bind(e,RemoveColumn.remove.bind(this,e,t))}static onInput(e,t,r,n){setTimeout((()=>{CellEvents.updateCell(this,n.value,0,e,{element:t,processText:!1}),r.style.top=ColumnDropdown.getTopPosition(this,t)}))}static setInputItemEvent(e,t,r,n,i){n.oninput=ColumnDropdownItemEvents.onInput.bind(e,t,r,i,n)}}var SIDE=(e=>(e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.TOP=2]="TOP",e[e.BOTTOM=3]="BOTTOM",e))(SIDE||{});class NestedDropdown{static create(e,t){const r=Dropdown.createBase();return r.style.top=`-${Number.parseInt(r.style.paddingTop)+22}px`,e&&t&&DropdownItem.addNewButtonItems(e,r,t),r}static resetPosition(e){e.style.left=""}static hideDropdown(e){const t=e.target.children[2];t.style.display="none",NestedDropdown.resetPosition(t)}static correctPosition(e,t,r){const n=ElementVisibility.getDetailsInWindow(e,r);if(!n.isFullyVisible&&n.blockingSides.has(SIDE.RIGHT)){e.style.left=`-${t.style.width}`;const n=ElementVisibility.getDetailsInWindow(e,r);!n.isFullyVisible&&n.blockingSides.has(SIDE.LEFT)&&(e.style.left="")}}static correctPositionForOverflow(e,t,r){const{_tableElementRef:n,_overflow:i}=e;!n||!i||n.offsetWidth!==i.overflowContainer.scrollWidth&&(t.style.left=`-${r.style.width}`,t.getBoundingClientRect().x<0&&(t.style.left=""))}static displayAndSetDropdownPosition(e){const t=e.target.children[2],r=e.target.parentElement;t.style.left=r.style.width,t.style.display=r.style.display,this._overflow&&OverflowUtils.isOverflowElement(this._overflow.overflowContainer)?NestedDropdown.correctPositionForOverflow(this,t,r):NestedDropdown.correctPosition(t,r,this._tableDimensions.border)}}class NestedDropdownItemEvents{static addEvents(e,t){t.addEventListener("mouseenter",NestedDropdown.displayAndSetDropdownPosition.bind(e)),t.addEventListener("mouseleave",NestedDropdown.hideDropdown),t.children[1].addEventListener("mouseenter",DropdownItemHighlightUtils.highlightNew.bind(this,e._activeOverlayElements,t))}}const _ColumnTypeDropdown=class e{static setupParentItemData(e,t){var r;const{name:n,dropdownItem:i}=t,a=(null==(r=i.element)?void 0:r.children[0]).cloneNode(!0);e.replaceChild(a,e.children[0]),e.children[1].innerText=n}static setUp(t,r,n){const{activeType:i,settings:a}=t._columnsDetails[n],s=r.getElementsByClassName(e.COLUMN_TYPE_ITEM_CLASS)[0];if(e.setupParentItemData(s,i),a.types.length<2)return s.style.pointerEvents="none";s.style.pointerEvents="",setTimeout((()=>ColumnTypeDropdownItem.setUp(t,n)))}static create(t,r){const n=DropdownItem.addButtonItem(t,r,DropdownButtonItemConf.DEFAULT_ITEM,NestedDropdownItem.NESTED_DROPDOWN_ITEM,e.COLUMN_TYPE_ITEM_CLASS);NestedDropdownItemEvents.addEvents(t,n);const i=NestedDropdown.create();n.appendChild(i),t._activeOverlayElements.columnTypeDropdown=i}};_ColumnTypeDropdown.COLUMN_TYPE_ITEM_CLASS="dropdown-column-type-item";let ColumnTypeDropdown=_ColumnTypeDropdown;const _ColumnDropdownItem=class e{static resetItems(e){Array.from(e.children).forEach((e=>DropdownItem.toggleItem(e,!0)))}static addItems(t,r){setTimeout((()=>{DropdownItem.addTitle(r,"Property type"),ColumnTypeDropdown.create(t,r),DropdownItem.addDivider(r),ColumnDropdownButtonItemConf.ITEMS.slice(0,2).forEach((n=>{DropdownItem.addButtonItem(t,r,n,e.SORT_ITEM_CLASS)})),ColumnDropdownButtonItemConf.ITEMS.slice(2).forEach((e=>{DropdownItem.addButtonItem(t,r,e)}))}))}static hideDivider(e){e.slice(4).find((e=>"none"!==e.style.display))||DropdownItem.toggleItem(e[3],!1)}static toggleItems(t,r){const{isSortAvailable:n,isDeleteAvailable:i,isInsertLeftAvailable:a,isInsertRightAvailable:s,isMoveAvailable:o}=t;n||(DropdownItem.toggleItem(r[4],!1),DropdownItem.toggleItem(r[5],!1)),a||DropdownItem.toggleItem(r[6],!1),s||DropdownItem.toggleItem(r[7],!1),o||(DropdownItem.toggleItem(r[8],!1),DropdownItem.toggleItem(r[9],!1)),i||DropdownItem.toggleItem(r[10],!1),e.hideDivider(r)}static setUpInputElement(e,t,r,n,i){var a,s,o;const{isCellTextEditable:l,isHeaderTextEditable:c}=e._columnsDetails[t].settings;if(null!=(o=null==(s=null==(a=e._defaultColumnsSettings.columnDropdown)?void 0:a.displaySettings)?void 0:s.openMethod)&&o.overlayClick||(ObjectUtils.areValuesFullyDefined(c)?!c:!l))DropdownItem.toggleItem(n,!1);else{const a=n.children[0];a.value=e.data[0][t],ColumnDropdownItemEvents.setInputItemEvent(e,t,r,a,i)}}static setUp(t,r,n,i){ColumnTypeDropdown.setUp(t,r,n);const a=Array.from(r.children);e.setUpInputElement(t,n,i,a[0],r),e.toggleItems(t._columnsDetails[n].settings.columnDropdown,a),e.updateItemsStyle(t,n,r),ColumnDropdownItemEvents.setItemEvents(t,n,r)}static updateMoveColumnItemsStyle(e,t,r){const{isMoveAvailable:n}=e._columnsDetails[t].settings.columnDropdown;n&&(DropdownItem.toggleUsability(r[8],!0),DropdownItem.toggleUsability(r[9],!0),0===t&&DropdownItem.toggleUsability(r[8],!1),t===e._columnsDetails.length-1&&DropdownItem.toggleUsability(r[9],!1))}static updateInsertColumnItemsStyle(e,t){MaximumColumns.canAddMore(e)?(DropdownItem.toggleUsability(t[6],!0),DropdownItem.toggleUsability(t[7],!0)):(DropdownItem.toggleUsability(t[6],!1),DropdownItem.toggleUsability(t[7],!1))}static updateItemsStyle(t,r,n){const i=Array.from(n.children);e.updateInsertColumnItemsStyle(t,i),e.updateMoveColumnItemsStyle(t,r,i)}};_ColumnDropdownItem.SORT_ITEM_CLASS="dropdown-sort-item";let ColumnDropdownItem=_ColumnDropdownItem;class ColumnDropdown{static resetDropdownPosition(e){e.style.left=""}static processTextAndHide(e){var t;const{_activeOverlayElements:r,_columnsDetails:n,_focusedElements:{cell:{element:i,columnIndex:a}}}=e,{columnDropdown:s,columnTypeDropdown:o,fullTableOverlay:l}=r;!s||!l||!o||!i||(GenericElementUtils.doesElementExistInDom(i)&&(CellEvents.setCellToDefaultIfNeeded(e,0,a,i),HeaderText.onAttemptChange(e,i,a)),CellHighlightUtils.fade(i,null==(t=n[a])?void 0:t.headerStateColors.default),Dropdown.hide(s,l,o),ColumnTypeDropdownItem.reset(o),ColumnDropdown.resetDropdownPosition(s),ColumnDropdownItem.resetItems(s),DropdownItemHighlightUtils.fadeCurrentlyHighlighted(r))}static create(e){const t=Dropdown.createBase();return ColumnDropdownEvents.set(e,t),DropdownItem.addInputItem(e,t),ColumnDropdownItem.addItems(e,t),t}static getDefaultDropdownTopPosition(e,t,r){return r?`${Browser.IS_FIREFOX?1+t.topWidth:1}px`:`${ElementOffset.processTop(e.offsetTop+e.offsetHeight,t)}px`}static getTopPosition(e,t){var r,n,i;const a=null==(i=null==(n=null==(r=e._defaultColumnsSettings.columnDropdown)?void 0:r.displaySettings)?void 0:n.openMethod)?void 0:i.overlayClick;if(e._overflow){const r=e._overflow.overflowContainer;return`${a?r.scrollTop+1:r.scrollTop+t.offsetHeight}px`}if(e._stickyProps.header){const e=t.parentElement.offsetTop;return`${(a?1:t.offsetHeight)+e}px`}return ColumnDropdown.getDefaultDropdownTopPosition(t,e._tableDimensions.border,a)}static getLeftPropertyToCenterDropdown(e,t){return ElementOffset.processLeft(e.offsetLeft+e.offsetWidth/2,t)-Dropdown.DROPDOWN_WIDTH/2+"px"}static displayAndSetDropdownPosition(e,t,r){r.style.left=ColumnDropdown.getLeftPropertyToCenterDropdown(t,e._tableDimensions.border),r.style.top=ColumnDropdown.getTopPosition(e,t),Dropdown.display(r);const n=ElementVisibility.getDetailsInWindow(r,e._tableDimensions.border);n.isFullyVisible||(n.blockingSides.has(SIDE.LEFT)?r.style.left="0px":n.blockingSides.has(SIDE.RIGHT)&&(r.style.left=t.offsetLeft+t.offsetWidth-Dropdown.DROPDOWN_WIDTH+"px"))}static displayAndSetPositionForSticky(e,t,r){r.style.left=ColumnDropdown.getLeftPropertyToCenterDropdown(t,e._tableDimensions.border),r.style.top=ColumnDropdown.getTopPosition(e,t),Dropdown.display(r)}static displayAndSetPositionForOverflow(e,t,r){const{_tableElementRef:n,_overflow:i,_tableDimensions:a}=e;if(!n||null==i||!i.overflowContainer)return;const s=i.overflowContainer;r.style.left=ColumnDropdown.getLeftPropertyToCenterDropdown(t,a.border),r.style.top=ColumnDropdown.getTopPosition(e,t),Dropdown.display(r),n.offsetWidth!==s.scrollWidth?r.style.left=n.offsetWidth-r.offsetWidth+"px":r.offsetLeft<0&&(r.style.left="0px")}static display(e,t){const r=e._activeOverlayElements.columnDropdown,n=e._columnsDetails[t].elements[0];ColumnDropdownItem.setUp(e,r,t,n),e._overflow?ColumnDropdown.displayAndSetPositionForOverflow(e,n,r):e._stickyProps.header?ColumnDropdown.displayAndSetPositionForSticky(e,n,r):ColumnDropdown.displayAndSetDropdownPosition(e,n,r);const i=DropdownItem.getInputElement(r);i&&DropdownItemNavigation.focusInputElement(i),FullTableOverlayElement.display(e)}}class FullTableOverlayEvents{static onMouseDown(e){const{_activeOverlayElements:{columnDropdown:t,rowDropdown:r}}=this;Dropdown.isDisplayed(t)&&!Dropdown.isPartOfDropdownElement(e.target)&&ColumnDropdown.processTextAndHide(this),Dropdown.isDisplayed(r)&&RowDropdown.hide(this)}}class FullTableOverlayElement{static display(e){var t;const r=e._activeOverlayElements.fullTableOverlay;if(r.style.width=`${e.offsetWidth}px`,r.style.height=`${e.offsetHeight}px`,null!=(t=e._overflow)&&t.overflowContainer)r.style.top=`${e.offsetTop}px`,r.style.left=`${e.offsetLeft}px`;else{const t=e._tableElementRef.offsetTop-e.offsetTop;r.style.top=`-${Browser.IS_FIREFOX?t:t+e._tableDimensions.border.topWidth}px`,r.style.left=`-${Browser.IS_FIREFOX?0:e._tableDimensions.border.leftWidth}px`}Dropdown.display(r)}static create(e){const t=document.createElement("div");return t.id="full-table-overlay",t.style.backgroundColor=SEMI_TRANSPARENT_COLOR,t.style.display="none",t.onmousedown=FullTableOverlayEvents.onMouseDown.bind(e),t}}class RowDropdownEvents{static windowOnKeyDown(e,t){const{_activeOverlayElements:{rowDropdown:r,fullTableOverlay:n},shadowRoot:i}=e;e._focusedElements.rowDropdown||!r||!n||(t.key===KEYBOARD_KEY.ENTER||t.key===KEYBOARD_KEY.ESCAPE?RowDropdown.hide(e):null!=i&&i.activeElement||(t.key===KEYBOARD_KEY.TAB||t.key===KEYBOARD_KEY.ARROW_DOWN?(t.preventDefault(),e._focusedElements.rowDropdown=r,DropdownItemNavigation.focusSiblingItem(r.children[0],r,!0,!0)):t.key===KEYBOARD_KEY.ARROW_UP&&(e._focusedElements.rowDropdown=r,DropdownItemNavigation.focusSiblingItem(r.children[r.children.length-1],r,!1,!0))))}static dropdownOnKeyDown(e,t){if(t.key===KEYBOARD_KEY.ENTER){const e=t.target;e.dispatchEvent(new Event("mouseenter")),e.dispatchEvent(new Event("click"))}else t.key===KEYBOARD_KEY.ESCAPE&&RowDropdown.hide(this);DropdownEvents.itemKeyNavigation(this.shadowRoot,e,t)}static set(e,t){t.onkeydown=RowDropdownEvents.dropdownOnKeyDown.bind(e,t)}}class RowDropdownButtonItemConf{}RowDropdownButtonItemConf.ITEMS=[{text:"Insert Up",iconSettings:{svgString:INSERT_UP_ICON_SVG_STRING,containerStyles:{dropdown:{marginRight:"1px"}}}},{text:"Insert Down",iconSettings:{svgString:INSERT_DOWN_ICON_SVG_STRING,containerStyles:{dropdown:{marginRight:"1px"}}}},{text:"Move Up",iconSettings:{svgString:MOVE_UP_ICON_SVG_STRING,containerStyles:{dropdown:{marginRight:"8px",marginTop:"3.5px"}}}},{text:"Move Down",iconSettings:{svgString:MOVE_DOWN_ICON_SVG_STRING,containerStyles:{dropdown:{marginLeft:"2px",marginRight:"6px",marginTop:"3.5px"}}}},{text:"Delete",iconSettings:{svgString:TRASH_ICON_SVG_STRING,containerStyles:{dropdown:{marginLeft:"-4px",marginRight:"5px",marginTop:"-1px"}}}}];class IndexColumnEvents{static mouseEnterCell(e,t){const r=t.target,{cellColors:n}=this._frameComponents,i=FrameComponentsColors.getColorsBasedOnParam(n,e);CellHighlightUtils.highlight(r,i.hover)}static mouseLeaveCell(e,t){if(!Dropdown.isDisplayed(this._activeOverlayElements.rowDropdown)){const{cellColors:r}=this._frameComponents,n=FrameComponentsColors.getColorsBasedOnParam(r,e);CellHighlightUtils.fade(t.target,n.default)}}static setEvents(e,t,r){var n;t.onmouseenter=IndexColumnEvents.mouseEnterCell.bind(e,r),t.onmouseleave=IndexColumnEvents.mouseLeaveCell.bind(e,r);const{displaySettings:i,canEditHeaderRow:a}=e.rowDropdown;!a&&0===r||(i.isAvailable&&null!=(n=i.openMethod)&&n.cellClick?t.onclick=RowDropdown.display.bind(e,r,t):RowDropdownCellOverlayEvents.addCellEvents(e,r,t))}}class UpdateCellsForRows{static updateRowCells(e,t,r,n,i=!0){var a;if(ExtractElements.textCellsArrFromRow(t).forEach(((t,a)=>{n!==CELL_UPDATE_TYPE.REMOVED&&CellEventsReset.reset(e,t,r,a),i&&FireEvents.onCellUpdate(e,CellElement.getText(t),r,a,n)})),n!==CELL_UPDATE_TYPE.REMOVED){const n=t.children[0];if(e._frameComponents.displayIndexColumn&&(IndexColumnEvents.setEvents(e,n,r),DragRow.applyEventsToElement(e,n,n)),null!=(a=e.rowDropdown.displaySettings.openMethod)&&a.overlayClick){const t=RowDropdownCellOverlayEvents.setOverlayEvents(e,r,n);DragRow.applyEventsToElement(e,t,n)}}}static updateLastRow(e,t,r){var n;null!=(n=e._tableBodyElementRef)&&n.children&&UpdateCellsForRows.updateRowCells(e,r.element,r.index,t)}static updateLowerBeforeLastRows(e,t,r){var n;const i=null==(n=e._tableBodyElementRef)?void 0:n.children;i&&Array.from(i).slice(t,r).forEach(((r,n)=>{const i=n+t,a=r;UpdateCellsForRows.updateRowCells(e,a,i,CELL_UPDATE_TYPE.UPDATE)}))}static rebindAndFireUpdates(e,t,r,n){UpdateCellsForRows.updateLowerBeforeLastRows(e,t,n.index),UpdateCellsForRows.updateLastRow(e,r,n)}}class RemoveRow{static removeAllColumnsDetails(e){const{_columnsDetails:t}=e;t.forEach((t=>RemoveColumn.reduceStaticWidthTotal(e,t.settings))),t.splice(0,t.length)}static update(e,t,r,n){const i={element:r,index:n};UpdateCellsForRows.rebindAndFireUpdates(e,t,CELL_UPDATE_TYPE.REMOVED,i),setTimeout((()=>FireEvents.onDataUpdate(e))),!e._isRendering&&(0===e.data.length&&RemoveRow.removeAllColumnsDetails(e),e._addColumnCellsElementsRef.splice(t,1))}static rowToBeRemovedIndexWhenPagination(e,t){var r;const n=null==(r=e._tableBodyElementRef)?void 0:r.children[t];return e._pagination.visibleRows.findIndex((e=>e===n))}static removeRow(e,t){var r;const n=e.pagination?RemoveRow.rowToBeRemovedIndexWhenPagination(e,t):0;null==(r=e._tableBodyElementRef)||r.children[t].remove(),e._rowDropdownCellOverlays.splice(t,1);const i=e.data.splice(t,1);return i[0].forEach(((r,n)=>{e._columnsDetails[n].elements.splice(t,1),e._columnsDetails[n].processedStyle.splice(t,1)})),e.pagination&&PaginationUtils.updateOnRowChange(e,n),i[0]}static changeRowIndexIfRemoveHeaderWithDataBelow(e,t){return 0===t&&e._columnsDetails[0].elements.length>1?(MoveRow.move(e,0,!0),1):t}static remove(e,t){var r;t=RemoveRow.changeRowIndexIfRemoveHeaderWithDataBelow(e,t);const n=e.data.length-1,i=null==(r=e._tableBodyElementRef)?void 0:r.children[n];RemoveRow.removeRow(e,t),ToggleAdditionElements.update(e,!1,AddNewRowElement.toggle),e._frameComponents.displayIndexColumn&&IndexColumn.updateIndexes(e,t),CustomRowProperties.update(e,t),setTimeout((()=>RemoveRow.update(e,t,i,n)))}}class RowDropdownItemEvents{static onClickMiddleware(e){e(),RowDropdown.hide(this)}static set(e,t,r){const n=t.getElementsByClassName(DropdownItem.DROPDOWN_ITEM_CLASS)[0],i=ElementSiblingIterator.create(n);i.currentElement().onclick=RowDropdownItemEvents.onClickMiddleware.bind(e,InsertNewRow.insert.bind(this,e,r,!0)),i.next().onclick=RowDropdownItemEvents.onClickMiddleware.bind(e,InsertNewRow.insert.bind(this,e,r+1,!0)),i.next().onclick=RowDropdownItemEvents.onClickMiddleware.bind(e,MoveRow.move.bind(this,e,r,!1)),i.next().onclick=RowDropdownItemEvents.onClickMiddleware.bind(e,MoveRow.move.bind(this,e,r,!0)),i.next().onclick=RowDropdownItemEvents.onClickMiddleware.bind(e,RemoveRow.remove.bind(this,e,r))}}class RowDropdownItem{static updateDeleteRowItemStyle(e,t,r){DropdownItem.toggleUsability(r[4],!!(t>0||e.rowDropdown.canEditHeaderRow))}static updateMoveRowsItemsStyle(e,t,r){const{isMoveAvailable:n,canEditHeaderRow:i}=e.rowDropdown;n&&(DropdownItem.toggleUsability(r[2],!0),DropdownItem.toggleUsability(r[3],!0),(0===t||1===t&&!i)&&DropdownItem.toggleUsability(r[2],!1),(t===e._columnsDetails[0].elements.length-1||0===t&&!i)&&DropdownItem.toggleUsability(r[3],!1))}static updateInsertRowsItemsStyle(e,t,r){MaximumRows.canAddMore(e)?(0!==t||e.rowDropdown.canEditHeaderRow?DropdownItem.toggleUsability(r[0],!0):DropdownItem.toggleUsability(r[0],!1),DropdownItem.toggleUsability(r[1],!0)):(DropdownItem.toggleUsability(r[0],!1),DropdownItem.toggleUsability(r[1],!1))}static updateItemStyle(e,t,r){const n=Array.from(t.children);RowDropdownItem.updateInsertRowsItemsStyle(e,r,n),RowDropdownItem.updateMoveRowsItemsStyle(e,r,n),RowDropdownItem.updateDeleteRowItemStyle(e,r,n)}static update(e,t,r){RowDropdownItem.updateItemStyle(e,t,r),RowDropdownItemEvents.set(e,t,r)}static setUpItems(e,t){setTimeout((()=>{const{rowDropdown:r}=e,{isInsertUpAvailable:n,isInsertDownAvailable:i,isMoveAvailable:a,isDeleteAvailable:s}=r,o=RowDropdownButtonItemConf.ITEMS.map((r=>DropdownItem.addButtonItem(e,t,r)));n||DropdownItem.toggleItem(o[0],!1),i||DropdownItem.toggleItem(o[1],!1),a||(DropdownItem.toggleItem(o[2],!1),DropdownItem.toggleItem(o[3],!1)),s||DropdownItem.toggleItem(o[4],!1)}))}}class RowDropdown{static hide(e){const{_activeOverlayElements:{rowDropdown:t,fullTableOverlay:r},_focusedElements:{cell:{element:n,rowIndex:i}},_frameComponents:{cellColors:a,displayIndexColumn:s}}=e;if(!t||!r||!n)return;Dropdown.hide(t,r);const o=FrameComponentsColors.getColorsBasedOnParam(a,i);s&&CellHighlightUtils.fade(n,o.default),DropdownItemHighlightUtils.fadeCurrentlyHighlighted(e._activeOverlayElements),setTimeout((()=>{delete e._focusedElements.rowDropdown,FocusedCellUtils.purge(e._focusedElements.cell)}))}static focusCell(e,t,r){const{_frameComponents:n,_focusedElements:i}=e;n.displayIndexColumn?FocusedCellUtils.setIndexCell(i.cell,r,t):FocusedCellUtils.set(i.cell,r,t,0)}static correctPositionWhenBottomOverflow(e,t,r){const{top:n}=t.parentElement.getBoundingClientRect(),i=n+e.border.topWidth;let a=window.innerHeight-i-t.offsetHeight;Browser.IS_FIREFOX&&(a+=e.border.topWidth),t.style.top=`${a}px`;const s=ElementVisibility.getDetailsInWindow(t,e.border);!s.isFullyVisible&&s.blockingSides.has(SIDE.TOP)&&(t.style.top=r)}static getLeft(e,t){var r;const n=null==(r=e.rowDropdown.displaySettings.openMethod)?void 0:r.cellClick;return`${ElementOffset.processWidth(n?t.offsetWidth:5,e._tableDimensions.border)}px`}static displayAndSetPosition(e,t,r){const n=`${ElementOffset.processTop(t.offsetTop,e._tableDimensions.border)}px`;r.style.top=n,r.style.left=RowDropdown.getLeft(e,t),Dropdown.display(r);const i=ElementVisibility.getDetailsInWindow(r,e._tableDimensions.border);i.isFullyVisible||i.blockingSides.has(SIDE.BOTTOM)&&RowDropdown.correctPositionWhenBottomOverflow(e._tableDimensions,r,n)}static setOverflowPosition(e,t,r,n){if(e._stickyProps.header&&t.tagName===CellElement.HEADER_TAG)if(e._overflow)r.style.top=`${n.scrollTop}px`;else{const e=t.parentElement.offsetTop,n=Number.parseInt(getComputedStyle(t).borderTopWidth);r.style.top=`${e+n}px`}else r.style.top=`${ElementOffset.processTop(t.offsetTop,e._tableDimensions.border)}px`;r.style.left=RowDropdown.getLeft(e,t)}static displayAndSetPositionForSticky(e,t,r){const n=e.parentElement;RowDropdown.setOverflowPosition(e,t,r,n),Dropdown.display(r)}static displayAndSetPositionOverflow(e,t,r){const{_tableElementRef:n,_overflow:i,_stickyProps:a}=e;if(!n||null==i||!i.overflowContainer)return;RowDropdown.setOverflowPosition(e,t,r,i.overflowContainer),Dropdown.display(r);const s=a.header&&t.tagName===CellElement.HEADER_TAG;n.offsetHeight!==i.overflowContainer.scrollHeight&&!s&&(r.style.top=n.offsetHeight-r.offsetHeight+"px")}static display(e,t){var r;const n=this._activeOverlayElements.rowDropdown;RowDropdownItem.update(this,n,e),null!=(r=this._overflow)&&r.overflowContainer?RowDropdown.displayAndSetPositionOverflow(this,t,n):this._stickyProps.header?RowDropdown.displayAndSetPositionForSticky(this,t,n):RowDropdown.displayAndSetPosition(this,t,n),FullTableOverlayElement.display(this),setTimeout((()=>RowDropdown.focusCell(this,e,t)))}static create(e){const t=Dropdown.createBase();return RowDropdownEvents.set(e,t),RowDropdownItem.setUpItems(e,t),t}}class RowDropdownCellOverlayEvents{static mouseLeave(e,t){RowDropdownCellOverlay.hide(this,e),delete this._hoveredElements.leftMostCell,RowDropdownCellOverlay.resetDefaultColor(this.rowDropdown.displaySettings,t)}static mouseEnter(e,t){this._hoveredElements.leftMostCell=e,RowDropdownCellOverlay.setHoverColor(this.rowDropdown.displaySettings,t)}static setOverlayEvents(e,t,r){const n=e._rowDropdownCellOverlays[t].element;return n.onmouseenter=RowDropdownCellOverlayEvents.mouseEnter.bind(e,r,n),n.onmouseleave=RowDropdownCellOverlayEvents.mouseLeave.bind(e,t,n),n.onclick=RowDropdown.display.bind(e,t,r),n}static cellMouseLeave(e){RowDropdownCellOverlay.hide(this,e),delete this._hoveredElements.leftMostCell}static cellMouseEnter(e,t){RowDropdownCellOverlay.display(this,e),this._hoveredElements.leftMostCell=t}static addCellEvents(e,t,r){const{displaySettings:n,canEditHeaderRow:i}=e.rowDropdown;if(!n.isAvailable||!i&&0===t)return;const a=e._rowDropdownCellOverlays[t];if(null!=a&&a.cellElement){const{cellElement:e,enter:t,leave:r}=a;e.removeEventListener("mouseenter",t),e.removeEventListener("mouseleave",r)}a.cellElement=r,a.enter=RowDropdownCellOverlayEvents.cellMouseEnter.bind(e,t,r),a.leave=RowDropdownCellOverlayEvents.cellMouseLeave.bind(e,t),r.addEventListener("mouseenter",a.enter),r.addEventListener("mouseleave",a.leave)}}const _RowDropdownCellOverlay=class e{static setDefault(e,t){var r;e.style.backgroundColor=(null==(r=null==t?void 0:t.default)?void 0:r.backgroundColor)||""}static resetDefaultColor(t,r){var n;const i=t.overlayStyles;null!=(n=null==i?void 0:i.hover)&&n.backgroundColor&&e.setDefault(r,i)}static setHoverColor(e,t){var r,n;const i=null==(n=null==(r=e.overlayStyles)?void 0:r.hover)?void 0:n.backgroundColor;i&&(t.style.backgroundColor=i)}static hide(e,t){const r=e._hoveredElements.leftMostCell;setTimeout((()=>{r!==e._hoveredElements.leftMostCell&&(e._rowDropdownCellOverlays[t].element.style.width=DropdownCellOverlay.HIDDEN_PX)}))}static display(e,t){const r=e._columnsDetails[0],n=e._rowDropdownCellOverlays[t].element;n.style.width=DropdownCellOverlay.VISIBLE_PX;const i=r.elements[t],{displayIndexColumn:a}=e._frameComponents,s=a?i.previousSibling:i,o=s.offsetHeight/100;n.style.height=60*o+"px",n.style.top=20*o+"px";const l=a?r.elements[0].offsetWidth:0;n.style.left=`-${s.offsetWidth+l}px`}static create(t){const r=document.createElement("div");return r.classList.add(e.ROW_DROPDOWN_CELL_OVERLAY_CLASS),r.classList.add(DropdownCellOverlay.DROPDOWN_CELL_OVERLAY_CLASS),r.style.width=DropdownCellOverlay.HIDDEN_PX,e.setDefault(r,t),r}static getCellDividerElement(e,t){let r=e.nextSibling;return t&&(r=r.nextSibling),r}static add(t,r,n){const i=e.create(t.rowDropdown.displaySettings.overlayStyles),{displayIndexColumn:a}=t._frameComponents;e.getCellDividerElement(n,!!a).appendChild(i),t._rowDropdownCellOverlays.splice(r,0,{element:i,enter:()=>{},leave:()=>{}})}static resetOverlays(t){var r;null!=(r=t.rowDropdown.displaySettings.openMethod)&&r.overlayClick&&(t._rowDropdownCellOverlays.splice(0,t._rowDropdownCellOverlays.length),ExtractElements.textRowsArrFromTBody(t._tableBodyElementRef,t.data).forEach(((r,n)=>{const i=r.children[0];e.add(t,n,i),RowDropdownCellOverlayEvents.setOverlayEvents(t,n,i)})))}};_RowDropdownCellOverlay.ROW_DROPDOWN_CELL_OVERLAY_CLASS="row-dropdown-cell-overlay";let RowDropdownCellOverlay=_RowDropdownCellOverlay;class PaginationRowIndexes{static getVisibleRowRealIndex(e,t,r){const n=Array.from(e.children),i=void 0===r?t.visibleRows.length-1:r,a=t.visibleRows[i];return n.findIndex((e=>e===a))}static getVisibleRowIndex(e,t,r){const n=e.children[r];return t.visibleRows.findIndex((e=>e===n))}static getFilteredMaxVisibleRowIndex(e,t){const{rowsPerPage:r,visibleRows:n}=t,i=PaginationRowIndexes.getVisibleRowRealIndex(e,t);return n.length===r?i:i+(r-n.length)}static getRawMaxVisibleRowIndex(e){const{_pagination:t,_tableBodyElementRef:r,data:n,_visiblityInternal:i}=e,{activePageNumber:a,rowsPerPage:s,isAllRowsOptionSelected:o}=t;return o?n.length+1:i.filters?PaginationRowIndexes.getFilteredMaxVisibleRowIndex(r,t):a*s}static getMaxVisibleRowIndex(e){const{dataStartsAtHeader:t}=e;let r=PaginationRowIndexes.getRawMaxVisibleRowIndex(e);return t||(r+=1),r}}const _RowElement=class e{static create(){const e=document.createElement("tr");return e.classList.add("row"),e}static moveClassToLastVisibleRow(t,r){r&&(r.id=""),t.id=e.LAST_VISIBLE_ROW_ID}static toggleNonAddRow(t,r,n){if(t.pagination&&t._pagination){const r=t._pagination.visibleRows[t._pagination.visibleRows.length-1];if(r)return e.moveClassToLastVisibleRow(r,n)}const{previousElementSibling:i}=r;i&&e.moveClassToLastVisibleRow(i,n)}static toggleLastRowClass(t){const r=t.shadowRoot,n=t._addRowCellElementRef.parentElement,i=r.getElementById(e.LAST_VISIBLE_ROW_ID);AddNewRowElement.isDisplayed(n.children[0])?n.id!==e.LAST_VISIBLE_ROW_ID&&e.moveClassToLastVisibleRow(n,i):e.toggleNonAddRow(t,n,i)}};_RowElement.LAST_VISIBLE_ROW_ID="last-visible-row";let RowElement=_RowElement;class CellDividerElement{static create(e){const t=document.createElement("div");return t.classList.add("cell-divider"),0===e&&(t.style.height=ColumnSizerGenericUtils.canHeightBeInherited()?"100%":"inherit"),t}}class InsertNewCell{static insertElementsToRow(e,t,r,n,i){const a=CellElementIndex.getViaColumnIndex(n,i);e.insertBefore(t,e.children[a]);const s=CellDividerElement.create(r);e.insertBefore(s,e.children[a+1])}static updateColumnDetailsAndSizers(e,t,r,n){const i=e._columnsDetails[r];if(i&&0===t){const t=ColumnDropdownCellOverlay.add(e,r);ColumnDetails.updateWithNoSizer(i,t),InsertRemoveColumnSizer.insert(e,r),n&&(InsertRemoveColumnSizer.cleanUpCustomColumnSizers(e,r),UpdateIndexColumnWidth.wrapTextWhenNarrowColumnsBreached(e))}}static insert(e,t,r,n,i,a,s){const{_frameComponents:{displayIndexColumn:o},data:l,_columnsDetails:c}=e,d=c[s];d.elements.splice(a,0,r),d.processedStyle.splice(a,0,ProcessedDataTextStyle.getDefaultProcessedTextStyle()),InsertNewCell.insertElementsToRow(t,r,a,s,!!o),l[a].splice(s,i?0:1,n)}static convertCell(e,t,r,n){const i=e._columnsDetails[r];0===t&&e.displayHeaderIcons&&HeaderIconCellElement.setHeaderIconStructure(e,n,r),i.activeType&&(i.activeType.cellDropdownProps?0===t?CellDropdown.setUpDropdown(e,r):(SelectCell.convertCell(e,r,n),SelectCell.finaliseEditedText(e,n.children[0],r,!0)):t>0&&(i.activeType.checkbox&&CheckboxCellElement.setCellCheckboxStructure(e,n,r,t),i.activeType.calendar&&DateCellElement.setCellDateStructure(e,n,r)))}static insertInitialColumnDetails(e,t,r){const{_columnsDetails:n,_customColumnsSettings:i,_cellDropdownContainer:a,_defaultColumnsSettings:s}=e,o=CellDropdown.createAndAppend(a),l=ColumnDetails.createInitial(s,o,i[t],e._defaultCellHoverColors,FireEvents.onColumnsUpdate.bind(this,e));n.splice(r,0,l)}static insertToRow(e,t,r,n,i,a){0===r&&InsertNewCell.insertInitialColumnDetails(e,i,n);const s=DataUtils.processCellText(e,r,n,i),o=CellElement.createCellElement(e,s,n,0===r);InsertNewCell.insert(e,t,o,s,a,r,n),InsertNewCell.convertCell(e,r,n,o),0===r?(a&&StaticTableWidthUtils.changeWidthsBasedOnColumnInsertRemove(e,!0),ColumnSettingsBorderUtils.updateSiblingColumns(e,n)):ProcessedDataTextStyle.setCellStyle(e,r,n),setTimeout((()=>InsertNewCell.updateColumnDetailsAndSizers(e,r,n,a)))}}class InsertNewRow{static bindAndfireCellUpdates(e,t){var r;const n=e.data.length-1,i={element:null==(r=e._tableBodyElementRef)?void 0:r.children[n],index:n};UpdateCellsForRows.rebindAndFireUpdates(e,t,CELL_UPDATE_TYPE.ADD,i),setTimeout((()=>FireEvents.onDataUpdate(e)))}static canStartRenderCellBeAdded(e,t,r){return 0===t?MaximumColumns.canAddMore(e):e._columnsDetails[r]}static addCells(e,t,r,n,i){const{_frameComponents:{displayIndexColumn:a,displayAddNewColumn:s}}=e;a&&IndexColumn.createAndPrependToRow(e,r,n),t.forEach(((t,a)=>{(i||InsertNewRow.canStartRenderCellBeAdded(e,n,a))&&InsertNewCell.insertToRow(e,r,n,a,t,i)})),s&&AddNewColumnElement.createAndAppendToRow(e,r,n),setTimeout((()=>RowDropdownCellOverlay.add(e,n,r.children[0])))}static updatePagination(e,t,r,n){r?PaginationUtils.updateOnRowChange(e,t,n):PaginationUtils.initialRowUpdates(e,t,n)}static insertNewRow(e,t,r,n){var i,a;const s=n||DataUtils.createEmptyStringDataArray((null==(i=e.data[0])?void 0:i.length)||1),o=RowElement.create();return e.pagination&&InsertNewRow.updatePagination(e,t,r,o),null==(a=e._tableBodyElementRef)||a.insertBefore(o,e._tableBodyElementRef.children[t]),r&&e.data.splice(t,0,[]),InsertNewRow.addCells(e,s,o,t,r),o}static insert(e,t,r,n){if(!MaximumRows.canAddMore(e))return;const i=r&&0===t&&e._columnsDetails.length>0;i&&(t=1);const a=InsertNewRow.insertNewRow(e,t,r,n);r&&(ToggleAdditionElements.update(e,!0,AddNewRowElement.toggle),e._frameComponents.displayIndexColumn&&IndexColumn.updateIndexes(e,t+1),CustomRowProperties.update(e,t)),i&&MoveRow.move(e,0,!0),setTimeout((()=>{e._isPopulatingTable?UpdateCellsForRows.updateRowCells(e,a,t,CELL_UPDATE_TYPE.ADD):n?t===e.data.length-1&&InsertNewRow.bindAndfireCellUpdates(e,0):InsertNewRow.bindAndfireCellUpdates(e,t)}))}static insertEvent(){let e=this.data.length;if(this.pagination)if(this._visiblityInternal.filters&&this._tableBodyElementRef)e=1!==this.data.length||this.dataStartsAtHeader?PaginationRowIndexes.getVisibleRowRealIndex(this._tableBodyElementRef,this._pagination)+1:1;else{const t=PaginationRowIndexes.getMaxVisibleRowIndex(this);t<e&&(e=t)}InsertNewRow.insert(this,e,!0)}}class AddNewRowEvents{static mouseEnterCell(e,t){CellHighlightUtils.highlight(t.target,e.hover)}static mouseLeaveCell(e,t){CellHighlightUtils.fade(t.target,e.default)}static setCellEvents(e,t){t.onclick=InsertNewRow.insertEvent.bind(e);const r=e._frameComponents.cellColors.data;t.onmouseenter=AddNewRowEvents.mouseEnterCell.bind(this,r),t.onmouseleave=AddNewRowEvents.mouseLeaveCell.bind(this,r)}}const _AddNewRowElement=class e{static isDisplayed(t){return t.style.display===e.VISIBLE}static setDisplay(t,r){e.isDisplayed(t)!==r&&(t.style.display=r?e.VISIBLE:e.HIDDEN)}static setDefaultStyle(e){e.innerText="+ New",e.style.width=""}static createCell(t){const{_defaultColumnsSettings:{cellStyle:r},_frameComponents:{displayAddNewRow:n,styles:i},rootCell:a}=t,s=CellElement.createDataCell(!1,r,null==i?void 0:i.default);return s.id=e.ID,n?e.setDefaultStyle(s):(RootCellElement.convertToRootCell(s,null==a?void 0:a.text),s.addEventListener("click",e.setDisplay.bind(this,s,!1))),e.setDisplay(s,n),s.colSpan=e.DEFAULT_COL_SPAN,AddNewRowEvents.setCellEvents(t,s),s}static create(t){const r=RowElement.create(),n=e.createCell(t);return r.appendChild(n),n}static toggle(t){const{_tableBodyElementRef:r,_addRowCellElementRef:n,_frameComponents:{displayAddNewRow:i}}=t;null==n||!n.parentElement||!r||(i&&e.setDisplay(n,MaximumRows.canAddMore(t)),RowElement.toggleLastRowClass(t))}static isAddNewRowRow(t){var r;return(null==(r=null==t?void 0:t.children[0])?void 0:r.id)===e.ID}};_AddNewRowElement.DEFAULT_COL_SPAN=1e9,_AddNewRowElement.HIDDEN="none",_AddNewRowElement.VISIBLE="",_AddNewRowElement.ID="add-new-row-cell";let AddNewRowElement=_AddNewRowElement;class ElementEvents{static toggleListeners(e,t,r){Object.keys(t).forEach((n=>{(t[n]||[]).forEach((t=>{e[r?"addEventListener":"removeEventListener"](n,t)}))}))}static convertToArrayObj(e){return Object.keys(e).reduce(((t,r)=>{const n=r,i=e[n];return n&&i&&(t[n]=[i]),t}),{})}static getDefault(){return{rootCell:{styles:{}}}}}class RootCellEvents{static removeEvents(e,t){AddNewRowElement.setDefaultStyle(e),ElementEvents.toggleListeners(e,t.styles,!1),e.dispatchEvent(new MouseEvent("mouseenter")),delete t.applied}static setEventFunctions(e,t,r){if(r&&(e._eventFunctions.rootCell.styles=ElementEvents.convertToArrayObj(StatefulCSSEvents.getEvents(t,r))),e._frameComponents.displayAddNewRow){const t=RootCellElement.convertFromRootCell.bind(this,e),{styles:r}=e._eventFunctions.rootCell;r.click??(r.click=[]),r.click.push(t)}}static applyStyles(e,t,r){var n,i,a,s;const o=ElementStyle.generateStatefulCSS(t,{},{});null!=(n=o.default)&&n.width&&(r.style.width=o.default.width),null==(i=o.default)||delete i.width,null==(a=o.hover)||delete a.width,null==(s=o.click)||delete s.width,Object.assign(e.style,o.default)}static applyEvents(e,t){const{_tableElementRef:r,rootCell:n,_eventFunctions:{rootCell:i}}=e,a=null!=n&&n.styles?JSON.parse(JSON.stringify(n.styles)):null;a&&r&&RootCellEvents.applyStyles(t,a,r),0===Object.keys(i.styles).length&&RootCellEvents.setEventFunctions(e,t,a),ElementEvents.toggleListeners(t,i.styles,!0),i.applied=!0}}const _RootCellElement=class e{static convertFromRootCell(t){const{_addRowCellElementRef:r,rootCell:n,_eventFunctions:{rootCell:i}}=t;r&&(r.classList.remove(e.ROOT_CELL_CLASS),null!=n&&n.styles&&ElementStyle.unsetAllCSSStates(r,n.styles),RootCellEvents.removeEvents(r,i))}static convertToRootCell(t,r){t.classList.add(e.ROOT_CELL_CLASS),t.innerText=r||"+",t.style.width=`${TableDimensionsUtils.MINIMAL_TABLE_WIDTH}px`}static removeRows(e){Array.from(e.children).slice(0,e.children.length-1).forEach((e=>e.remove()))}static display(t){const{_tableBodyElementRef:r,_addColumnCellsElementsRef:n,_addRowCellElementRef:i,rootCell:a,_frameComponents:{displayAddNewColumn:s,displayAddNewRow:o}}=t;if(!i)return;const l=r;s&&n.splice(0,n.length),e.removeRows(l),o&&e.convertToRootCell(i,null==a?void 0:a.text),t._eventFunctions.rootCell.applied||RootCellEvents.applyEvents(t,i),AddNewRowElement.setDisplay(i,!0)}};_RootCellElement.ROOT_CELL_CLASS="root-cell";let RootCellElement=_RootCellElement;class ToggleAdditionElements{static update(e,t,r){0===e.data.length||0===e._columnsDetails.length?RootCellElement.display(e):r(e,t)}}class InsertNewColumn{static updateColumns(e,t,r,n){const i={element:t,index:r},a=LastColumn.getDetails(e._columnsDetails,r);UpdateCellsForColumns.rebindAndFireUpdates(e,i,n,CELL_UPDATE_TYPE.ADD,a)}static insertToAllRows(e,t,r){ExtractElements.textRowsArrFromTBody(e._tableBodyElementRef,e.data).forEach(((n,i)=>{const a=r?r[i]:EMPTY_STRING;InsertNewCell.insertToRow(e,n,i,t,a,!0),setTimeout((()=>InsertNewColumn.updateColumns(e,n,i,t)))}))}static insert(e,t,r){MaximumColumns.canAddMore(e)&&(FocusedCellUtils.incrementColumnIndex(e._focusedElements.cell,t),InsertNewColumn.insertToAllRows(e,t,r),ToggleAdditionElements.update(e,!0,AddNewColumnElement.toggle),setTimeout((()=>{FireEvents.onDataUpdate(e),FireEvents.onColumnsUpdate(e)})))}static insertEvent(){InsertNewColumn.insert(this,this._columnsDetails.length)}}class InsertMatrix{static removeDataThatIsNotEditableFromNewRows(e,t,r){return e.slice(r).forEach(((e,r)=>{e.settings.isCellTextEditable||t.forEach((e=>{e[r]=EMPTY_STRING}))})),t}static createRowDataArrayWithEmptyCells(e,t,r){const n=DataUtils.createEmptyStringDataArray(e);return n.splice(r,t.length,...t),n}static createNewRows(e,t,r){InsertMatrix.removeDataThatIsNotEditableFromNewRows(e._columnsDetails,t,r).forEach((t=>{var n;const i=InsertMatrix.createRowDataArrayWithEmptyCells((null==(n=e.data[0])?void 0:n.length)||0,t,r);InsertNewRow.insert(e,e.data.length,!0,i)}))}static changeColumnSettings(e,t){const{elements:r}=e._columnsDetails[t];FocusedCellUtils.set(e._focusedElements.cell,r[0],0,t),HeaderText.onAttemptChange(e,r[0],t)}static processNewColumn(e){const t=e._columnsDetails.length-1;CellEvents.setCellToDefaultIfNeeded(e,0,t,e._columnsDetails[t].elements[0],!1),InsertMatrix.changeColumnSettings(e,t)}static createNewColumns(e,t,r){ArrayUtils.transpose(t).forEach((t=>{const n=InsertMatrix.createRowDataArrayWithEmptyCells(e.data.length,t,r);InsertNewColumn.insert(e,e.data[0].length,n),InsertMatrix.processNewColumn(e)}))}static overwriteCell(e,t,r,n,i){const{_frameComponents:{displayIndexColumn:a},_columnsDetails:s}=e,o=CellElementIndex.getViaColumnIndex(n,!!a),l=t.children[o],c=s[n];0===r&&!c.settings.isHeaderTextEditable||r>0&&!c.settings.isCellTextEditable||(0===r&&CellElement.setNewText(e,l,i,!1,!1),CellEvents.updateCell(e,i,r,n,{element:l,updateTableEvent:!1}),ColumnTypesUtils.updateDataElements(e,r,n,l),0===r&&InsertMatrix.changeColumnSettings(e,n))}static overwriteRowData(e,t,r,n,i){t.forEach(((t,a)=>{const s=n+a;InsertMatrix.overwriteCell(e,i,r,s,t)}))}static setCaretToEndAndHighlightIfSelect(e,t,r){const{activeType:n,cellDropdown:i,settings:{defaultText:a}}=e._columnsDetails[r];CaretPosition.setToEndOfText(e,t),n.cellDropdownProps&&CellDropdown.updateCellDropdown(t,i,e._tableDimensions.border,a,!0)}static overwriteExistingCells(e,t,r,n){const i=[];t.forEach(((t,a)=>{var s;const o=r+a,l=null==(s=e._tableBodyElementRef)?void 0:s.children[o],c=e.data[0].length-n,d=t.slice(0,c);InsertMatrix.overwriteRowData(e,d,o,n,l);const u=t.slice(c);i.push(u)}));const a=e._focusedElements.cell.element;return setTimeout((()=>InsertMatrix.setCaretToEndAndHighlightIfSelect(e,a,n))),i}static canNewRowsBeCreated(e,t,r){return e._columnsDetails.slice(r,r+t[0].length).find((e=>e.settings.isCellTextEditable))}static insertColumnsInsideIfCantInsertRight(e,t,r){const n=e._columnsDetails.slice(r).findIndex((e=>!1===e.settings.columnDropdown.isInsertRightAvailable));if(-1!==n)if(0===n)t.forEach((e=>e.splice(1,e.length-1)));else{const i=t[0].length-(n+1);for(let t=0;t<i;t+=1)InsertNewColumn.insert(e,r+n+t)}}static getNewMatrixBasedOnColumns(e,t,r){var n,i;const a=((null==(n=e[0])?void 0:n.length)||0)-((null==(i=t[0])?void 0:i.length)||0)-r;return a>0?new Array(t.length).fill(new Array(a).fill(EMPTY_STRING)):[]}static insert(e,t,r,n,i){const a=e.data.length-r;i||InsertMatrix.insertColumnsInsideIfCantInsertRight(e,t,n);const s=t.slice(0,a),o=i?InsertMatrix.getNewMatrixBasedOnColumns(t,e.data,n):InsertMatrix.overwriteExistingCells(e,s,r,n);if(InsertMatrix.createNewColumns(e,o,r),!i&&!InsertMatrix.canNewRowsBeCreated(e,t,n))return;const l=t.slice(a);InsertMatrix.createNewRows(e,l,n),setTimeout((()=>FireEvents.onDataUpdate(e)))}}const _ParseCSVClipboardText=class e{static preprocessText(t){let r=t;return t.charAt(0)===e.STRING_QUOTE_SYMBOL&&(r=r.substring(1)),t.charAt(t.length-1)===e.STRING_QUOTE_SYMBOL&&(r=r.substring(0,t.length-2)),r}static getSeparatorSymbols(t){return t.indexOf(e.EXPLICIT_NEW_LINE_SYMBOL)>-1||t.indexOf(e.EXPLICIT_TAB_SYMBOL)>-1?{newLine:e.EXPLICIT_NEW_LINE_SYMBOL,tab:e.EXPLICIT_TAB_SYMBOL}:{newLine:e.NEW_LINE_SYMBOL,tab:e.TAB_SYMBOL}}static parse(t){const r=e.preprocessText(t),{newLine:n,tab:i}=e.getSeparatorSymbols(r);return r.split(n).map((e=>e.split(i).map((e=>e.replace(/\\"/g,"")))))}};_ParseCSVClipboardText.STRING_QUOTE_SYMBOL='"',_ParseCSVClipboardText.TAB_SYMBOL="\\t",_ParseCSVClipboardText.NEW_LINE_SYMBOL="\\n",_ParseCSVClipboardText.EXPLICIT_TAB_SYMBOL="\\\\t",_ParseCSVClipboardText.EXPLICIT_NEW_LINE_SYMBOL="\\\\n";let ParseCSVClipboardText=_ParseCSVClipboardText;class OverwriteCellsViaCSVOnPaste{static trimCSVRowsIfPaginationAsync(e,t,r,n){var i;const a=e.length+r;t.length<a&&(e=e.slice(0,e.length-(a-t.length)));const s=(null==(i=t[0])?void 0:i.length)||0,o=e[0].length+n;if(s<o){const t=e[0].length-(o-s);e.forEach((e=>e.splice(t)))}return e}static focusOriginalCellAfterProcess(e,t){const{element:r,rowIndex:n,columnIndex:i}=e._focusedElements.cell;t(),FocusedCellUtils.set(e._focusedElements.cell,r,n,i)}static overwrite(e,t,r,n,i){r.preventDefault();let a=ParseCSVClipboardText.parse(t);e._pagination.async&&(a=OverwriteCellsViaCSVOnPaste.trimCSVRowsIfPaginationAsync(a,e.data,n,i)),OverwriteCellsViaCSVOnPaste.focusOriginalCellAfterProcess(e,InsertMatrix.insert.bind(this,e,a,n,i))}static isCSVData(e){return e.indexOf(ParseCSVClipboardText.NEW_LINE_SYMBOL)>-1||e.indexOf(ParseCSVClipboardText.TAB_SYMBOL)>-1}}var KEYBOARD_COMBINATION_EVENT=(e=>(e.PASTE="Paste",e))(KEYBOARD_COMBINATION_EVENT||{});const KEYBOARD_EVENT={...KEYBOARD_COMBINATION_EVENT,[KEYBOARD_KEY.TAB]:KEYBOARD_KEY.TAB},_UserKeyEventsStateUtils=class e{static createNew(){return{[KEYBOARD_KEY.TAB]:!1,[KEYBOARD_EVENT.PASTE]:!1,[MOUSE_EVENT.DOWN]:!1}}static temporarilyIndicateEvent(t,r){t[r]=!0,setTimeout((()=>t[r]=!1),e.KEY_PRESS_STATE_TIMEOUT_ML)}};_UserKeyEventsStateUtils.KEY_PRESS_STATE_TIMEOUT_ML=5;let UserKeyEventsStateUtils=_UserKeyEventsStateUtils;const _PasteUtils=class e{static sanitizePastedTextData(e){var t,r;e.preventDefault();const n=null==(t=e.clipboardData)?void 0:t.getData("text/plain");null==(r=document.execCommand)||r.call(document,"insertHTML",!1,n)}static extractClipboardText(t){var r;return JSON.stringify(null==(r=t.clipboardData)?void 0:r.getData(e.TEXT_DATA_FORMAT))}};_PasteUtils.TEXT_DATA_FORMAT="text/plain";let PasteUtils=_PasteUtils;const UNDO_INPUT_TYPE="historyUndo";class DataCellEvents{static keyDownCell(e,t,r){const{elements:n,activeType:i}=this._columnsDetails[t];r.key===KEYBOARD_KEY.TAB?UserKeyEventsStateUtils.temporarilyIndicateEvent(this._userKeyEventsState,KEYBOARD_KEY.TAB):r.key===KEYBOARD_KEY.ENTER&&this.enterKeyMoveDown&&!i.cellDropdownProps&&FocusNextRowCell.focus(this,e,n,r)}static inputCell(e,t,r){const n=r,i=n.target;if(DateCellInputElement.isInputElement(i))return;const a=CellElement.getText(i);if(!this._userKeyEventsState[KEYBOARD_EVENT.PASTE]){const r=n.inputType===UNDO_INPUT_TYPE;CellElement.setNewText(this,i,a,!1,r,!1);const s=this._columnsDetails[t];s.activeType.cellDropdownProps&&e>0&&CellDropdown.updateCellDropdown(i,s.cellDropdown,this._tableDimensions.border,s.settings.defaultText,!0),CellEvents.updateCell(this,a,e,t,{processText:!1})}}static pasteCell(e,t,r){UserKeyEventsStateUtils.temporarilyIndicateEvent(this._userKeyEventsState,KEYBOARD_EVENT.PASTE),PasteUtils.sanitizePastedTextData(r);const n=PasteUtils.extractClipboardText(r);if(OverwriteCellsViaCSVOnPaste.isCSVData(n))OverwriteCellsViaCSVOnPaste.overwrite(this,n,r,e,t);else{const n=r.target,{cellDropdown:i,settings:{defaultText:a},activeType:s}=this._columnsDetails[t],o="BR"===n.tagName?n.parentElement:n;setTimeout((()=>{s.cellDropdownProps&&CellDropdown.updateCellDropdown(o,i,this._tableDimensions.border,a,!0),CellEvents.updateCell(this,CellElement.getText(o),e,t,{processText:!1})}))}}static blur(e,t,r,n){CaretDisplayFix.isIssueBrowser()&&CaretDisplayFix.removeContentEditable(n),CellEvents.setCellToDefaultIfNeeded(e,t,r,n),FocusedCellUtils.purge(e._focusedElements.cell)}static blurCell(e,t,r){var n,i,a;0===e&&!(null!=(a=null==(i=null==(n=this._defaultColumnsSettings.columnDropdown)?void 0:n.displaySettings)?void 0:i.openMethod)&&a.cellClick)&&HeaderText.onAttemptChange(this,r.target,t),DataCellEvents.blur(this,e,t,r.target)}static prepareText(e,t,r,n){var i,a,s;const o=null==(s=null==(a=null==(i=e._defaultColumnsSettings.columnDropdown)?void 0:i.displaySettings)?void 0:a.openMethod)?void 0:s.cellClick;CaretDisplayFix.isIssueBrowser()&&(t>0||!o)&&CaretDisplayFix.setContentEditable(n),CellEvents.removeTextIfDefault(e,t,r,n)}static focusCell(e,t,r){const n=r.target;DataCellEvents.prepareText(this,e,t,n);const{_userKeyEventsState:i,_focusedElements:a}=this;i[KEYBOARD_KEY.TAB]&&CaretPosition.setToEndOfText(this,n),FocusedCellUtils.set(a.cell,n,e,t)}static setEvents(e,t,r,n){t.onfocus=DataCellEvents.focusCell.bind(e,r,n),t.onblur=DataCellEvents.blurCell.bind(e,r,n),t.onmouseenter=()=>{},t.onmouseleave=()=>{},t.onmousedown=()=>{},t.oninput=DataCellEvents.inputCell.bind(e,r,n),t.onpaste=DataCellEvents.pasteCell.bind(e,r,n),t.onkeydown=DataCellEvents.keyDownCell.bind(e,r,n)}}class SelectCellTextBaseEvents{static keyDownText(e,t,r,n){const{cellDropdown:{activeItems:i,canAddMoreOptions:a},elements:s}=e._columnsDetails[r];n.key===KEYBOARD_KEY.ESCAPE?CellWithTextEvents.programmaticBlur(e):n.key===KEYBOARD_KEY.TAB?CellTextEvents.tabOutOfCell(e,t,r,n):n.key===KEYBOARD_KEY.ENTER?(n.preventDefault(),FocusNextRowCell.focusOrBlurSelect(s,t)):n.key===KEYBOARD_KEY.ARROW_UP?(n.preventDefault(),CellDropdownItem.setSiblingItemOnCell(e,i,"previousSibling")):n.key===KEYBOARD_KEY.ARROW_DOWN?(n.preventDefault(),CellDropdownItem.setSiblingItemOnCell(e,i,"nextSibling")):(e.dataStartsAtHeader||t>0)&&!a&&n.preventDefault()}static displayDropdown(e,t,r){var n;const i=CellDropdown.display(e,t,r),{activeType:a,cellDropdown:s}=e._columnsDetails[t];null!=(n=a.cellDropdownProps)&&n.isBasicSelect&&i&&(s.displayedCellElement=r,ArrowDownIconElement.toggle(r,!0),ArrowDownIconElement.setActive(r))}static clearTypeSpecificProps(e,t){const{cellDropdown:r,activeType:n}=t;n.cellDropdownProps&&(n.cellDropdownProps.isBasicSelect?(ArrowDownIconElement.toggle(r.displayedCellElement,!1),delete r.displayedCellElement):OptionButton.hideAfterColorPickerContainerClose(e,t))}static blurring(e,t,r,n){const i=e._columnsDetails[r];Dropdown.hide(i.cellDropdown.element),i.cellDropdown.itemsDetails[CellElement.getText(n)]||SelectCell.finaliseEditedText(e,n,r),SelectCellTextBaseEvents.clearTypeSpecificProps(e._columnsDetails,i),DataCellEvents.blur(e,t,r,n)}static blurText(e,t,r){this._focusedElements.cellDropdown||SelectCellTextBaseEvents.blurring(this,e,t,r.target)}static setEvents(e,t,r,n){t.onblur=SelectCellTextBaseEvents.blurText.bind(e,r,n),t.onfocus=CellWithTextEvents.focusText.bind(e,r,n,SelectCellTextBaseEvents.displayDropdown)}}class CellWithTextEvents{static focusText(e,t,r,n){const i=n.target,a=CellElement.getCellElement(i);DataCellEvents.prepareText(this,e,t,i),null==r||r(this,t,a),FocusedCellUtils.set(this._focusedElements.cell,a,e,t),this._userKeyEventsState[KEYBOARD_KEY.TAB]&&CaretPosition.setToEndOfText(this,i)}static programmaticBlur(e){const{rowIndex:t,columnIndex:r,element:n}=e._focusedElements.cell,i=CellElement.getTextElement(n);i.blur(),e._focusedElements.cellDropdown&&(SelectCellTextBaseEvents.blurring(e,t,r,i),delete e._focusedElements.cellDropdown)}static mouseDownCell(e,t,r,n){e._focusedElements.cellDropdown&&CellWithTextEvents.programmaticBlur(e);const i=CellElement.getTextElement(r);n.preventDefault(),null==t||t(e),CaretDisplayFix.isIssueBrowser()&&i.focus(),CaretPosition.setToEndOfText(e,i)}static mouseDown(e,t){if(t.target.classList.contains(CellElement.CELL_CLASS)){const r=t.target;CellWithTextEvents.mouseDownCell(this,e,r,t)}}}class CellDropdownScrollbar{static setProperties(e){const{element:t,scrollbarPresence:r}=e;CellDropdownHorizontalScrollFix.setPropertiesIfHorizontalScrollPresent(e),r.vertical=ScrollbarUtils.isVerticalPresent(t)}}class OptionDeleteButtonEvents{static delete(e,t){const{cellDropdown:r}=e,n=t.target.parentElement.parentElement;delete r.itemsDetails[CellElement.getText(n.children[0])],n.remove(),0===Object.keys(r.itemsDetails).length?CellWithTextEvents.programmaticBlur(this):CellDropdownScrollbar.setProperties(r),setTimeout((()=>FireEvents.onColumnsUpdate(this)))}static addEvents(e,t,r){r.onclick=OptionDeleteButtonEvents.delete.bind(e,t)}}const _OptionDeleteButton=class e{static createIcon(){const t=document.createElement("div");return t.classList.add(e.DELETE_BUTTON_ICON_CLASS),t.innerText=e.DELETE_ICON_TEXT,t}static createButton(e,t){const r=document.createElement("div");return r.classList.add(DropdownItem.DROPDOWN_ITEM_IDENTIFIER,OptionButton.BUTTON_CLASS),OptionDeleteButtonEvents.addEvents(e,t,r),r}static createContainer(){const e=document.createElement("div");return e.classList.add(OptionButton.BUTTON_CONTAINER_CLASS),e}static create(t,r){const n=e.createContainer(),i=e.createButton(t,r),a=e.createIcon();return i.appendChild(a),n.appendChild(i),n}static changeVisibility(e,t,r){const n=e.children[1];n.style.display=r?"block":"none",r&&(n.children[0].style.left=r.offsetWidth-t+"px")}};_OptionDeleteButton.DELETE_BUTTON_ICON_CLASS="cell-dropdown-option-delete-button-icon",_OptionDeleteButton.DELETE_ICON_TEXT="Ã—";let OptionDeleteButton=_OptionDeleteButton;class OptionButton{static changeVisibility(e,t,r){if(e.isTrusted){const n=e.target,i=t.scrollbarPresence.vertical?31:16;OptionDeleteButton.changeVisibility(n,i,r),Browser.IS_COLOR_PICKER_SUPPORTED&&t.labelDetails&&!t.labelDetails.colorPickerContainer&&OptionColorButton.changeVisibility(n,i+18,r)}}static hideAfterColorPickerContainerClose(e,t){const{cellDropdown:{labelDetails:r}}=t;null!=r&&r.colorPickerContainer&&(r.colorPickerContainer.style.display="none",r.colorPickerContainer.previousElementSibling.style.display="none",delete r.colorPickerContainer,OptionColorButtonEvents.updateColumnLabelColors(e,t))}}OptionButton.BUTTON_CONTAINER_CLASS="cell-dropdown-option-button-container",OptionButton.BUTTON_CLASS="cell-dropdown-option-button";class CellDropdownItemEvents{static blurItem(e,t,r){var n;const{activeItems:i,labelDetails:a}=e;if(null!=a&&a.colorPickerContainer)return;const s=i[t];void 0!==s&&("matchingWithCellText"===t||"hovered"===t&&s!==i.matchingWithCellText)&&(s.style.backgroundColor="",a||(s.style.color=(null==(n=e.customItemStyle)?void 0:n.textColor)||""),delete i[t]),r&&e.canAddMoreOptions&&OptionButton.changeVisibility(r,e)}static scrollToItem(e,t,r,n,i){if(i.isTrusted)return;const a=ElementVisibility.isVerticallyVisibleInsideParent(t,e);a.isFullyVisible||(t.scrollIntoView({block:"nearest"}),r&&a.blockingSides.has(SIDE.BOTTOM)&&CellDropdownHorizontalScrollFix.scrollDownFurther(n))}static highlightItem(e,t){const{scrollbarPresence:r,activeItems:n,labelDetails:i,canAddMoreOptions:a,element:s,itemsDetails:o}=e;if(null!=i&&i.colorPickerContainer)return;n.hovered&&(n.hovered.style.backgroundColor="",i||(n.hovered.style.color=""));const l=t.target,c=l.children[0].innerText;l.style.backgroundColor=o[c].backgroundColor;const d=l.parentElement;CellDropdownItemEvents.scrollToItem(this,l,r.horizontal,d,t),l===n.matchingWithCellText?(i||(l.style.color="white"),delete n.hovered):(i||(l.style.backgroundColor=DropdownItemHighlightUtils.HOVER_BACKGROUND_COLOR),n.hovered=l),a&&OptionButton.changeVisibility(t,e,s)}static set(e,t,r){t.onmouseenter=CellDropdownItemEvents.highlightItem.bind(e,r),t.onmouseleave=CellDropdownItemEvents.blurItem.bind(this,r,"hovered")}}const _CellDropdownItem=class e{static updateCellElementIfNotUpdated(e,t,r,n,i){e.data[r][n]!==t&&CellEvents.updateCell(e,t,r,n,{processText:!1,element:i})}static selectExistingItem(t,r,n,i,a){var s;const o=CellElement.getText(r.children[0]);e.updateCellElementIfNotUpdated(t,o,n,i,a),LabelCellTextElement.isLabelText(a)&&(a.style.backgroundColor=null==(s=t._columnsDetails[i].cellDropdown.itemsDetails[o])?void 0:s.backgroundColor)}static addNewItem(t,r,n,i){const{cellDropdown:{labelDetails:a}}=n,s=CellElement.getText(r);if(s===EMPTY_STRING)return;let o="";if(a){const{globalItemColors:{newColors:e,existingColors:t}}=a;o=i||t[s]||e[e.length-1]||LabelColorUtils.getLatestPasteleColor(),r.style.backgroundColor=o,t[s]??(t[s]=o),e.pop()||LabelColorUtils.setNewLatestPasteleColor()}else o=e.ACTIVE_ITEM_BACKGROUND_COLOR;e.addItem(t,s,o,n),setTimeout((()=>FireEvents.onColumnsUpdate(t)))}static updateCellTextBgColor(e,t,r,n){const i=CellElement.getText(t);if(e)t.style.backgroundColor=r.itemsDetails[i].backgroundColor;else if(r.canAddMoreOptions&&i!==EMPTY_STRING&&i!==n){if(r.labelDetails){const{globalItemColors:{newColors:e,existingColors:n}}=r.labelDetails;t.style.backgroundColor=n[i]||(null==e?void 0:e[e.length-1])||LabelColorUtils.getLatestPasteleColor()}}else t.style.backgroundColor=""}static updateItemColor(e,t){e&&(t.matchingWithCellText=e,e.dispatchEvent(new MouseEvent("mouseenter")))}static hideHoveredItemHighlight(e){const{hovered:t,matchingWithCellText:r}=e;t?t.style.backgroundColor="":e.hovered=r}static attemptHighlightMatchingItemWithCell(t,r,n,i,a){var s;const{activeItems:o,itemsDetails:l}=r,c=CellElement.getText(t),d=a||(null==(s=l[c])?void 0:s.element);(!d||o.matchingWithCellText!==d)&&(e.hideHoveredItemHighlight(o),CellDropdownItemEvents.blurItem(r,"matchingWithCellText")),e.updateItemColor(d,o),i&&r.labelDetails&&e.updateCellTextBgColor(d,t,r,n)}static setItemOnCell(t,r){const{element:n,rowIndex:i,columnIndex:a}=t._focusedElements.cell,{cellDropdown:s,settings:{defaultText:o}}=t._columnsDetails[a],l=n.children[0],c=CellElement.getText(r.children[0]);e.updateCellElementIfNotUpdated(t,c,i,a,l),e.attemptHighlightMatchingItemWithCell(l,s,o,!0,r),CaretPosition.setToEndOfText(t,l)}static setSiblingItemOnCell(t,r,n){const{hovered:i,matchingWithCellText:a}=r,s=i||a,o=null==s?void 0:s[n];if(o)e.setItemOnCell(t,o);else{const{columnIndex:r}=t._focusedElements.cell,i=t._columnsDetails[r].cellDropdown.element;if("nextSibling"===n){const r=i.children[0];r&&e.setItemOnCell(t,r)}else{const r=i.children[i.children.length-1];r&&e.setItemOnCell(t,r)}}}static addItemElement(e,t,r,n=!1){const{cellDropdown:i}=r,a=DropdownItem.addPlaneButtonItem(i.element,t,n?0:void 0);if(i.customItemStyle&&(a.style.color=i.customItemStyle.textColor),i.canAddMoreOptions){const t=OptionDeleteButton.create(e,r);if(a.appendChild(t),Browser.IS_COLOR_PICKER_SUPPORTED&&i.labelDetails){const t=OptionColorButton.create(e._columnsDetails,r);a.appendChild(t)}}return CellDropdownItemEvents.set(e.shadowRoot,a,i),a}static addItem(t,r,n,i,a=!1){i.cellDropdown.itemsDetails[r]={backgroundColor:n,isCustomBackgroundColor:a,element:e.addItemElement(t,r,i)}}static addItems(t,r,n){n.cellDropdown.element.replaceChildren(),n.cellDropdown.itemsDetails={},Object.keys(r).forEach((i=>{e.addItem(t,i,r[i].color,n,!!r[i].isCustom)}))}static postProcessItemToColor(e,t,r){e&&delete t[r]}static processNewItemsToColor(t,r,n,i){t.slice(1).reduce(((t,n)=>{const a=n[r];if(a!==EMPTY_STRING&&!t[a])if(i){const{globalItemColors:{newColors:e,existingColors:r}}=i;t[a]={color:r[a]||e.pop()||LabelColorUtils.getLatestPasteleColorAndSetNew()},r[a]??(r[a]=t[a].color)}else t[a]={color:e.ACTIVE_ITEM_BACKGROUND_COLOR};return t}),n)}static changeUserOptionsToItemToColor(t,r){return t.reduce(((t,n)=>{var i;if(r){const{globalItemColors:{newColors:e,existingColors:a}}=r;t[n.text]={color:n.backgroundColor||a[n.text]||e.pop()||LabelColorUtils.getLatestPasteleColorAndSetNew(),isCustom:!0},a[i=n.text]??(a[i]=t[n.text].color)}else t[n.text]={color:e.ACTIVE_ITEM_BACKGROUND_COLOR,isCustom:!0};return t}),{})}static populateItems(t,r){const{data:n,_columnsDetails:i}=t,a=i[r],{cellDropdown:{labelDetails:s},settings:{defaultText:o,isDefaultTextRemovable:l},activeType:{cellDropdownProps:c}}=a;if(!c)return;let d={};c.options&&(d=e.changeUserOptionsToItemToColor(c.options,s)),c.canAddMoreOptions&&e.processNewItemsToColor(n,r,d,s),e.postProcessItemToColor(l,d,o),e.addItems(t,d,a)}};_CellDropdownItem.ACTIVE_ITEM_BACKGROUND_COLOR="#4a69d4";let CellDropdownItem=_CellDropdownItem;const _LabelCellTextElement=class e{static isLabelText(t){return t.classList.contains(e.TEXT_CLASS)}static setCellTextAsAnElement(t,r,n){const i=CellTextElement.setCellTextAsAnElement(t,n);i.classList.add(e.TEXT_CLASS),i.style.backgroundColor=r}static finaliseEditedText(e,t,r,n=!1){var i;const a=e._columnsDetails[r],{cellDropdown:s,activeType:{cellDropdownProps:o},settings:{defaultText:l,isDefaultTextRemovable:c}}=a,d=null==(i=s.itemsDetails[CellElement.getText(t)])?void 0:i.backgroundColor;CellElement.getText(t)===EMPTY_STRING||c&&CellElement.getText(t)===l?t.style.backgroundColor="":n&&d?t.style.backgroundColor=d:null!=o&&o.canAddMoreOptions&&CellDropdownItem.addNewItem(e,t,a,t.style.backgroundColor)}};_LabelCellTextElement.TEXT_CLASS="label-cell-text";let LabelCellTextElement=_LabelCellTextElement;class CellDropdownEvents{static click(e){const t=e.target;if(t.classList.contains(Dropdown.DROPDOWN_CLASS)||t.classList.contains(OptionButton.BUTTON_CLASS))return;const{rowIndex:r,columnIndex:n,element:i}=this._focusedElements.cell,a=t.classList.contains(DropdownItem.DROPDOWN_ITEM_CLASS)?t:t.parentElement;CellDropdownItem.selectExistingItem(this,a,r,n,i.children[0]),CellWithTextEvents.programmaticBlur(this)}static mouseDown(e,t){e.cellDropdown=t}static set(e,t){t.onmousedown=CellDropdownEvents.mouseDown.bind(this,e._focusedElements,t),t.onclick=CellDropdownEvents.click.bind(e)}}const _CellDropdown2=class e{static generateRightPosition(){return"4px"}static generateBottomPosition(e,t,r){const n=e.offsetParent,i=r.bottomWidth+r.topWidth;return n.offsetHeight-i-e.offsetTop-t.offsetTop+6+"px"}static generateTopPosition(e,t,r){const n=LabelCellTextElement.isLabelText(t)?t.offsetTop+t.offsetHeight+2:e.offsetHeight-8;return`${ElementOffset.processTop(e.offsetTop+n,r)}px`}static generateLeftPosition(e,t,r){const n=LabelCellTextElement.isLabelText(t)?t.offsetLeft:1;return`${ElementOffset.processLeft(e.offsetLeft+n,r)}px`}static correctPosition(t,r,n,i){const a=ElementVisibility.getDetailsInWindow(t,i);a.isFullyVisible||(a.blockingSides.has(SIDE.RIGHT)&&(t.style.left="",t.style.right=e.generateRightPosition()),a.blockingSides.has(SIDE.BOTTOM)&&(t.style.top="",t.style.bottom=e.generateBottomPosition(r,n,i)))}static correctPositionForOverflow(e,t,r){t.offsetHeight!==r.scrollHeight&&(e.style.top=t.offsetHeight-e.offsetHeight+"px"),t.offsetWidth!==r.scrollWidth&&(e.style.left=t.offsetWidth-e.offsetWidth+"px")}static setPosition(t,r,n){const i=r.children[0];t.style.bottom="",t.style.right="",t.style.left=e.generateLeftPosition(r,i,n),t.style.top=e.generateTopPosition(r,i,n);const a=t.parentElement.parentElement,s=a.parentElement;OverflowUtils.isOverflowElement(s)?e.correctPositionForOverflow(t,a,s):e.correctPosition(t,r,i,n)}static updateCellDropdown(t,r,n,i,a,s){const o=CellElement.getTextElement(t);CellDropdownItem.attemptHighlightMatchingItemWithCell(o,r,i,a,s),a&&e.setPosition(r.element,o.parentElement,n)}static focusItemOnDropdownOpen(e,t,r){CellDropdownItem.attemptHighlightMatchingItemWithCell(e,t,r,!1)}static correctWidthForOverflow(t){if(t.clientWidth!==t.scrollWidth){const r=t.clientHeight!==t.scrollHeight?16:0,n=t.scrollWidth+r;t.style.width=`${Math.min(n,e.MAX_WIDTH)}px`}t.children.length>0&&t.scrollWidth<t.children[0].getBoundingClientRect().width&&(t.style.width=`${t.clientWidth+1}px`)}static getWidth(t,r,n){if(null!=n&&n.width)return Number.parseInt(n.width);if(!r.labelDetails)return Math.max(t.offsetWidth-2,e.MIN_WIDTH);const i=t.children[0];return Math.max(t.offsetWidth-2*i.offsetLeft,e.MIN_WIDTH)}static display(t,r,n){const{cellDropdown:i,settings:{defaultText:a},activeType:{cellDropdownProps:s}}=t._columnsDetails[r],{element:o,itemsDetails:l}=i;if(Object.keys(l).length>0&&s){CellDropdownEvents.set(t,o),CellDropdownItemEvents.blurItem(i,"hovered"),CellDropdownItemEvents.blurItem(i,"matchingWithCellText"),o.style.width=`${e.getWidth(n,i,s.dropdownStyle)}px`,Dropdown.display(o),o.scrollLeft=0,e.correctWidthForOverflow(o),CellDropdownScrollbar.setProperties(i),e.setPosition(o,n,t._tableDimensions.border);const r=n.children[0];return e.focusItemOnDropdownOpen(r,i,a),!0}return!1}static setCustomStyle(e,t){const{paddingTop:r,paddingBottom:n,marginTop:i,marginLeft:a,border:s,textAlign:o}=t;e.element.style.paddingTop=r||Dropdown.DROPDOWN_VERTICAL_PX,e.element.style.paddingBottom=n||Dropdown.DROPDOWN_VERTICAL_PX,e.element.style.marginTop=i||"0px",e.element.style.marginLeft=a||"0px",e.element.style.border=s||"none",e.element.style.textAlign=o||"left"}static setCustomState(e,t){e.customDropdownStyle=t.dropdownStyle,e.customItemStyle=t.optionStyle,e.canAddMoreOptions=!!t.canAddMoreOptions}static setUpDropdown(t,r){const{_columnsDetails:n,_globalItemColors:i}=t,{activeType:{cellDropdownProps:a},cellDropdown:s}=n[r];a&&(s.labelDetails=a.isBasicSelect?void 0:{globalItemColors:i},e.setCustomState(s,a),CellDropdownItem.populateItems(t,r),a.dropdownStyle&&e.setCustomStyle(s,a.dropdownStyle))}static createAndAppend(t){const r=Dropdown.createBase();return r.style.maxHeight=e.MAX_HEIGHT_PX,r.classList.add(e.CELL_DROPDOWN_CLASS),t.appendChild(r),r}static getDefaultObj(e){return{itemsDetails:{},activeItems:{},element:e,canAddMoreOptions:!0,scrollbarPresence:{horizontal:!1,vertical:!1}}}static createContainerElement(){return document.createElement("div")}};_CellDropdown2.CELL_DROPDOWN_CLASS="cell-dropdown",_CellDropdown2.MAX_HEIGHT_PX="147px",_CellDropdown2.MIN_WIDTH=70,_CellDropdown2.MAX_WIDTH=200;let CellDropdown=_CellDropdown2;const _ColumnDetails=class e{static getHeaderDefaultColor(e,t,r,n){var i,a,s,o,l,c;return(null==(a=null==(i=null==n?void 0:n.headerStyles)?void 0:i.default)?void 0:a[t])||(null==(s=null==n?void 0:n.cellStyle)?void 0:s[t])||(null==(l=null==(o=e.headerStyles)?void 0:o.default)?void 0:l[t])||(null==(c=e.cellStyle)?void 0:c[t])||r}static getHeaderHoverColor(t,r,n,i){var a,s,o,l;return(null==(s=null==(a=null==i?void 0:i.headerStyles)?void 0:a.hoverColors)?void 0:s[r])||(null==(l=null==(o=t.headerStyles)?void 0:o.hoverColors)?void 0:l[r])||e.getHeaderDefaultColor(t,r,n,i)}static createHeaderStateColors(t,r,n){return{hover:{color:e.getHeaderHoverColor(t,"color",n.color,r),backgroundColor:e.getHeaderHoverColor(t,"backgroundColor",n.backgroundColor,r)},default:{color:e.getHeaderDefaultColor(t,"color","",r),backgroundColor:e.getHeaderDefaultColor(t,"backgroundColor","",r)}}}static createInitial(t,r,n,i,a){const s=n||t;return{elements:[],processedStyle:[],settings:s,headerStateColors:e.createHeaderStateColors(t,n,i),bordersOverwrittenBySiblings:{},activeType:ColumnTypesUtils.getActiveType(s),cellDropdown:CellDropdown.getDefaultObj(r),fireColumnsUpdate:a}}static updateWithNoSizer(e,t){return Object.assign(e,{columnDropdownCellOverlay:t}),e}};_ColumnDetails.MINIMAL_COLUMN_WIDTH=34;let ColumnDetails=_ColumnDetails;class MaximumColumns{static isStaticContentBreachingSetTableWidth(e,t){if(t)return!1;const r=e.width||e.maxWidth;return void 0!==r&&e.staticWidth>r}static ignoreMinimalColumnWidthCheck(e,t,r){return e.preserveNarrowColumns||!StaticTable.isStaticTableWidth(t,e)||0===r}static canAddMore(e){const{_tableElementRef:t,_columnsDetails:r,_tableDimensions:n,maxColumns:i,preserveNarrowColumns:a}=e,s=r.length;if(void 0!==i&&i>0&&i===s||MaximumColumns.isStaticContentBreachingSetTableWidth(n,a))return!1;const o=t;return!!MaximumColumns.ignoreMinimalColumnWidthCheck(n,o,s)||(o.offsetWidth-n.staticWidth)/(s+1)>=ColumnDetails.MINIMAL_COLUMN_WIDTH}}const _AddNewColumnEvents=class e{static setHeaderCellStyle(e,t,r){const{default:n,hover:i}=t;e.style.color=r?i.color:n.color,e.style.backgroundColor=r?i.backgroundColor:n.backgroundColor}static setDataCellStyle(e,t){setTimeout((()=>{e.forEach((e=>{e.style.backgroundColor=t}))}))}static setDataCellsStyle(t,r,n){const i=t?n.hover.backgroundColor:n.default.backgroundColor,a=r.slice(1),s=Math.ceil(a.length/e.NUMBER_OF_HIGHLIGHT_CHUNKS);for(let t=0;t<a.length;t+=s){const r=a.slice(t,t+s);e.setDataCellStyle(r,i)}}static toggleColor(t,r,n){const{data:i,header:a}=n,s=r[0];s&&e.setHeaderCellStyle(s,a,t),r.length>1&&e.setDataCellsStyle(t,r,i)}static setEvents(t,r){const{_addColumnCellsElementsRef:n,_frameComponents:{cellColors:i}}=t;r.onmouseenter=e.toggleColor.bind(this,!0,n,i),r.onmouseleave=e.toggleColor.bind(this,!1,n,i),r.onclick=InsertNewColumn.insertEvent.bind(t)}};_AddNewColumnEvents.NUMBER_OF_HIGHLIGHT_CHUNKS=3;let AddNewColumnEvents=_AddNewColumnEvents;const _AddNewColumnElement=class e{static setDisplay(e,t,r,n){t?r.children[n].appendChild(e):e.remove()}static createCell(t,r){var n;const i=CellElement.createBaseCell(r);return i.classList.add(CellElement.CELL_CLASS,GenericElementUtils.NOT_SELECTABLE_CLASS,e.ADD_COLUMN_CELL_CLASS),Object.assign(i.style,t._defaultColumnsSettings.cellStyle,null==(n=t._frameComponents.styles)?void 0:n.default),AddNewColumnEvents.setEvents(t,i),i}static createHeaderCell(t){const{_defaultColumnsSettings:{headerStyles:r},_frameComponents:{cellColors:n,inheritHeaderColors:i}}=t,a=e.createCell(t,!0);return a.style.width=e.DEFAULT_WIDTH_PX,a.innerText="+",Object.assign(a.style,i?null==r?void 0:r.default:{},n.header.default),a}static createDataCell(t){const r=e.createCell(t,!1);return Object.assign(r.style,t._frameComponents.cellColors.data.default),r}static isDisplayed(e){return GenericElementUtils.doesElementExistInDom(e[0])}static createAndAppendToRow(t,r,n){const{_addColumnCellsElementsRef:i,_columnsDetails:a}=t,s=0===i.length||e.isDisplayed(i),o=0===n?e.createHeaderCell(t):e.createDataCell(t);i.splice(n,0,o);const l=a[a.length-1];ColumnSettingsBorderUtils.unsetSubjectBorder(i,l.elements,"left",n),s&&(MaximumColumns.canAddMore(t)?r.appendChild(o):0===n&&TableElement.changeStaticWidthTotal(t._tableDimensions,-e.DEFAULT_WIDTH))}static toggleEachCell(t,r,n,i){n.forEach(((n,i)=>{e.setDisplay(n,t,r,i)})),t||setTimeout((()=>AddNewColumnEvents.toggleColor(!1,n,i)))}static changeTableWidths(t,r,n){const i=r?e.DEFAULT_WIDTH:-e.DEFAULT_WIDTH;TableElement.changeStaticWidthTotal(t._tableDimensions,i),StaticTableWidthUtils.changeWidthsBasedOnColumnInsertRemove(t,n)}static toggle(t,r){const{_addColumnCellsElementsRef:n,_tableBodyElementRef:i,_frameComponents:{displayAddNewColumn:a,cellColors:s}}=t;if(!a||!i)return;const o=MaximumColumns.canAddMore(t);o!==e.isDisplayed(n)&&(o?(e.toggleEachCell(o,i,n,s),e.changeTableWidths(t,o,r)):(e.changeTableWidths(t,o,r),e.toggleEachCell(o,i,n,s)))}};_AddNewColumnElement.ADD_COLUMN_CELL_CLASS="add-column-cell",_AddNewColumnElement.DEFAULT_WIDTH=25,_AddNewColumnElement.DEFAULT_WIDTH_PX=`${_AddNewColumnElement.DEFAULT_WIDTH}px`;let AddNewColumnElement=_AddNewColumnElement;class ExtractElements{static textCellsArrFromRow(e){return Array.from(e.children).filter((e=>!(e.tagName!==CellElement.HEADER_TAG&&e.tagName!==CellElement.DATA_TAG||e.classList.contains(AddNewColumnElement.ADD_COLUMN_CELL_CLASS)||e.classList.contains(IndexColumn.INDEX_CELL_CLASS))))}static textRowsArrFromTBody(e,t,r=0){return Array.from(e.children).slice(r,t.length)}static getRightColumnSiblingCell(e){var t;return null==(t=e.nextSibling)?void 0:t.nextSibling}}class ColumnSettingsFrameBorderUtils{static toggleFrameBorder(e,t,r,n){if(e.length>0){const{subjectBorderStyle:i,siblingBorderStyle:a}=ColumnSettingsBorderUtils.getColumnBorderStyles(r),s=e[0],o=t[0];ColumnSettingsBorderUtils.isBorderDisplayed(o,a)?ColumnSettingsBorderUtils.unsetSubjectBorder(e,t,r,0):s.style[i]===ColumnSettingsBorderUtils.UNSET_PX&&ResetColumnStyles.applyDefaultStyles(e,n)}}static updateFrameColumns(e,t,r,n){const i=t||r;if(!i)return;const{_defaultColumnsSettings:a,_addColumnCellsElementsRef:s,_frameComponents:{displayAddNewColumn:o,displayIndexColumn:l}}=e;if(!n&&o&&ColumnSettingsFrameBorderUtils.toggleFrameBorder(s,i.elements,"left",a),!r&&l){const t=ExtractElements.textRowsArrFromTBody(e._tableBodyElementRef,e.data,0).map((e=>e.children[0]));ColumnSettingsFrameBorderUtils.toggleFrameBorder(t,i.elements,"right",a)}}}const _ColumnSettingsBorderUtils=class e{static overwriteSideBorderIfSiblingsHaveSettings(t,r){const{left:n,right:i}=t.bordersOverwrittenBySiblings;r.forEach((t=>{n&&(t.style.borderLeftWidth=e.UNSET_PX),i&&(t.style.borderRightWidth=e.UNSET_PX)}))}static getColumnBorderStyles(e){return{subjectBorderStyle:"left"===e?"borderLeftWidth":"borderRightWidth",siblingBorderStyle:"left"===e?"borderRightWidth":"borderLeftWidth"}}static isBorderDisplayed(t,r){return!(!t.style[r]||t.style[r]===e.UNSET_PX)}static unsetSubjectBorder(t,r,n,i,a){const{subjectBorderStyle:s,siblingBorderStyle:o}=e.getColumnBorderStyles(n),l=t[i],c=r[i];e.isBorderDisplayed(l,s)&&e.isBorderDisplayed(c,o)&&(a&&(a[n]=!0),t.forEach((t=>{ElementStyle.setStyle(t,s,e.UNSET_PX)})))}static unsetColumnBorder(t,r,n){e.unsetSubjectBorder(t.elements,r.elements,n,0,t.bordersOverwrittenBySiblings)}static unsetBorders(t,r,n){t&&(t.settings.stylePrecedence?(r&&e.unsetColumnBorder(r,t,"right"),n&&(n.settings.stylePrecedence?e.unsetColumnBorder(t,n,"right"):n.settings.stylePrecedence||e.unsetColumnBorder(n,t,"left"))):(n&&n.settings.stylePrecedence&&e.unsetColumnBorder(t,n,"right"),r&&r.settings.stylePrecedence&&e.unsetColumnBorder(t,r,"left")))}static resetBorderOverwritingState(e){e&&(e.bordersOverwrittenBySiblings.left=!1,e.bordersOverwrittenBySiblings.right=!1)}static resetIfBorderOverwritten(e,t,r,n){null!=r&&r.bordersOverwrittenBySiblings[n]&&(r.bordersOverwrittenBySiblings[n]=!1,ColumnSettingsStyleUtils.changeStyleFunc(e,t,e._columnsDetails[t].settings))}static updateSiblingColumns(t,r){const{_columnsDetails:n}=t,i=n[r],a=n[r-1],s=n[r+1];e.resetIfBorderOverwritten(t,r+1,s,"left"),e.resetIfBorderOverwritten(t,r-1,a,"right"),e.resetBorderOverwritingState(i),e.unsetBorders(i,a,s),ColumnSettingsFrameBorderUtils.updateFrameColumns(t,i,a,s)}};_ColumnSettingsBorderUtils.UNSET_PX="0px";let ColumnSettingsBorderUtils=_ColumnSettingsBorderUtils;const _CellElement=class e{static setDefaultCellStyle(e,t,r){Object.assign(e.style,t,r)}static createBaseCell(t){const r=document.createElement(t?e.HEADER_TAG:e.DATA_TAG);return t&&r.classList.add(e.HEADER_CELL_CLASS),r.classList.add(e.CELL_CLASS),r}static createDataCell(t,r,n,i){const a=e.createBaseCell(t);return t&&i&&a.classList.add(GenericElementUtils.NOT_SELECTABLE_CLASS),a.setAttribute("role","textbox"),e.setDefaultCellStyle(a,r,n),a}static setCursor(e,t){e.style.cursor=t?"text":"default"}static prepContentEditable(t,r,n=!1){CaretDisplayFix.isIssueBrowser()?(r&&CaretDisplayFix.setTabIndex(t),CaretDisplayFix.removeContentEditable(t)):t.contentEditable=String(r),n||e.setCursor(t,r)}static getCellElement(e){return e.classList.contains(CellTextElement.CELL_TEXT_DIV_CLASS)||e.classList.contains(DateCellInputElement.DATE_INPUT_CONTAINER_CLASS)?e.parentElement:e.classList.contains(DateCellInputElement.DATE_INPUT_CLASS)||e.classList.contains(DateCellCalendarIconElement.CALENDAR_ICON_CONTAINER_CLASS)?e.parentElement.parentElement:e}static getTextElement(e){var t,r;return null!=(t=e.children[0])&&t.classList.contains(CellTextElement.CELL_TEXT_DIV_CLASS)?e.children[0]:null!=(r=e.children[1])&&r.classList.contains(CellTextElement.CELL_TEXT_DIV_CLASS)?e.children[1]:CheckboxCellElement.isCheckboxCell(e)?e.children[0]:e}static getText(e){const t=CheckboxCellElement.getValue(e);return void 0!==t?t:e.innerText.trim()}static setText(t,r){CheckboxCellElement.setValue(t,r)||(e.getTextElement(t).innerText=r)}static setNewText(t,r,n,i,a,s=!0){s&&e.setText(r,n),i?setTimeout((()=>CaretDisplayFix.toggleCellTextBRPadding(t,r,a))):CaretDisplayFix.toggleCellTextBRPadding(t,r,a)}static setColumnWidth(e,t,r,n){if(!e._tableElementRef)return;const i=(null==r?void 0:r.widths)||(null==n?void 0:n.widths);if(null!=i&&i.staticWidth)ColumnSettingsWidthUtils.updateColumnWidth(e,t,i,!0);else if(null!=i&&i.initialWidth){const r=ColumnSettingsWidthUtils.getSettingsWidthNumber(e._tableElementRef,i,!1);t.style.width=`${r.number}px`}else t.style.width=`${e._tableDimensions.newColumnWidth}px`}static createCellElement(t,r,n,i){var a,s,o;const{_defaultColumnsSettings:{cellStyle:l,headerStyles:c},_columnsDetails:d}=t,u=d[n],p=null==(o=null==(s=null==(a=t._defaultColumnsSettings.columnDropdown)?void 0:a.displaySettings)?void 0:s.openMethod)?void 0:o.cellClick,h=e.createDataCell(i,l,i?null==c?void 0:c.default:{},p),{settings:f}=u;ColumnSettingsStyleUtils.applySettingsStyleOnCell(f,h,i),ColumnSettingsBorderUtils.overwriteSideBorderIfSiblingsHaveSettings(u,[h]);const m=i?!p&&f.isHeaderTextEditable:f.isCellTextEditable;return e.prepContentEditable(h,!!m,p),i&&e.setColumnWidth(t,h,f,t._defaultColumnsSettings),e.setNewText(t,h,r,!0,!1),h}};_CellElement.CELL_CLASS="cell",_CellElement.HEADER_CELL_CLASS="header-cell",_CellElement.HEADER_TAG="TH",_CellElement.DATA_TAG="TD";let CellElement=_CellElement;const _FilterViaWebWorkers=class e{static processOtherColumnsIfPresent(t,r,n,i){FilterInternalUtils.ACTIVE_WORKERS-=1,n.length>1&&i.length>0?e.execute(t,r,n.slice(1),i):0===FilterInternalUtils.ACTIVE_WORKERS&&t()}static createWorkerBlobURL(){const t=new Blob([e.CODE],{type:"application/javascript"});return URL.createObjectURL(t)}static hideRows(t,r,n,i){const{colCells:a}=n[0],{matchingIndexes:s,notMatchingIndexes:o}=i.data;o.forEach((e=>{a[e].parentElement.classList.add(FilterInternalUtils.HIDDEN_ROW_CLASS)})),e.processOtherColumnsIfPresent(t,r,n,s)}static toggleRows(t,r,n,i){const a=[],{colCells:s}=n[0];i.data.forEach(((e,t)=>{const r=s[t].parentElement;e?(r.classList.remove(FilterInternalUtils.HIDDEN_ROW_CLASS),a.push(t)):r.classList.add(FilterInternalUtils.HIDDEN_ROW_CLASS)})),e.processOtherColumnsIfPresent(t,r,n,a)}static execute(t,r,n,i){const a=new Worker(r);FilterInternalUtils.ACTIVE_WORKERS+=1,a.onmessage=i?e.hideRows.bind(this,t,r,n):e.toggleRows.bind(this,t,r,n);const s=n[0];a.postMessage({chunk:s.colCells.map((e=>CellElement.getText(e))),filterText:s.filterText,isCaseSensitive:s.isCaseSensitive,indexArray:i})}};_FilterViaWebWorkers.TRAVERSE_CHUNK="\n    const result = chunk.map((text) => (isCaseSensitive ? text : text.toLocaleLowerCase()).includes(filterText));\n    self.postMessage(result);\n  ",_FilterViaWebWorkers.TRAVERSE_MATCHING_INDEXES="\n    const matchingIndexes = [];\n    const notMatchingIndexes = [];\n    indexArray.forEach((index) => {\n      const text = chunk[index];\n      const isMatching = (isCaseSensitive ? text : text.toLocaleLowerCase()).includes(filterText);\n      if (isMatching) {\n        matchingIndexes.push(index);\n      } else {\n        notMatchingIndexes.push(index);\n      }\n    });\n    self.postMessage({matchingIndexes, notMatchingIndexes});\n  ",_FilterViaWebWorkers.CODE=`\n    self.onmessage = function (event) {\n      const {chunk, indexArray, filterText, isCaseSensitive} = event.data;\n      if (indexArray) {\n        ${_FilterViaWebWorkers.TRAVERSE_MATCHING_INDEXES}\n      } else {\n        ${_FilterViaWebWorkers.TRAVERSE_CHUNK}\n      }\n    };\n  `;let FilterViaWebWorkers=_FilterViaWebWorkers;class FilterViaTimeouts{static processOtherColumnsIfPresent(e,t,r){FilterInternalUtils.ACTIVE_WORKERS-=1,t.length>1&&r.length>0?FilterViaTimeouts.processOtherColumns(e,t.slice(1),r):0===FilterInternalUtils.ACTIVE_WORKERS&&e()}static toggleRow(e,t,r,n){const i=CellElement.getText(e),a=(t.isCaseSensitive?i:i.toLocaleLowerCase()).includes(t.filterText),s=e.parentElement;a?(s.classList.remove(FilterInternalUtils.HIDDEN_ROW_CLASS),r.push(n)):s.classList.add(FilterInternalUtils.HIDDEN_ROW_CLASS)}static processOtherColumns(e,t,r){setTimeout((()=>{FilterInternalUtils.ACTIVE_WORKERS+=1;const n=[],i=t[0];r.forEach((e=>{const t=i.chunk[e];FilterViaTimeouts.toggleRow(t,i,n,e)})),FilterViaTimeouts.processOtherColumnsIfPresent(e,t,n)}))}static execute(e,t){FilterInternalUtils.ACTIVE_WORKERS+=1,setTimeout((()=>{const r=[],n=t[0];n.chunk.forEach(((e,t)=>{FilterViaTimeouts.toggleRow(e,n,r,t)})),FilterViaTimeouts.processOtherColumnsIfPresent(e,t,r)}))}}const _FilterInternalUtils=class e{static finishFiltering(e){e.pagination&&(PageButtonContainerElement.repopulateButtons(e),PaginationUtils.displayRowsForDifferentButton(e,1))}static getFilterFunc(t){const r=e.finishFiltering.bind(this,t);return window.Worker?FilterViaWebWorkers.execute.bind(this,r,FilterViaWebWorkers.createWorkerBlobURL()):FilterViaTimeouts.execute.bind(this,r)}static generateDefaultHeaderName(e,t){var r,n,i;return t&&(null==(r=e[0])?void 0:r.find((e=>e===t)))?t:void 0!==(null==(n=e[0])?void 0:n[0])?String(null==(i=e[0])?void 0:i[0]):""}static addConfig(t,r){var n;const{placeholderTemplate:i,defaultColumnHeaderName:a}=r,s={isCaseSensitive:!1,placeholderTemplate:i,defaultColumnHeaderName:a||e.generateDefaultHeaderName(t.data)};return(n=t._visiblityInternal).filters??(n.filters=[]),t._visiblityInternal.filters.push(s),s}static assignElements(e,t){var r;const{data:n,_columnsDetails:i}=e;if(0!==n.length)if(t.defaultColumnHeaderName){const e=n[0].findIndex((e=>e===t.defaultColumnHeaderName));t.elements=i[-1===e?0:e].elements,delete t.defaultColumnHeaderName}else t.elements&&(null==(r=e.shadowRoot)||!r.contains(t.elements[0]))&&(t.elements=i[0].elements)}static resetInput(t,r){const{_visiblityInternal:{filters:n}}=t;if(e.assignElements(t,r),!r.elements||!n)return;const i=CellElement.getText(r.elements[0]);r.lastRegisteredHeaderName=i,FilterInputElement.setPlaceholder(r.inputElement,i,r.placeholderTemplate),FilterInputEvents.setEvents(t,r,n)}static unsetFilter(e){""!==e.value&&(e.value="",e.dispatchEvent(new Event("input")))}static unsetAllFilters(e){var t,r;let n=!1;const{data:i,_visiblityInternal:a,_tableBodyElementRef:s}=e;return i[0]&&0!==i[0].length&&s&&(null==(t=a.filters)||t.forEach((e=>{""!==e.inputElement.value&&(e.inputElement.value="",n=!0)})),n&&(null==(r=a.filters)||r[0].inputElement.dispatchEvent(new Event("input")))),n}static resetAllInputs(t){const{data:r,_visiblityInternal:{filters:n}}=t;if(!r[0]||0===r[0].length||!n)return FilterInputEvents.unsetEvents(n);n.forEach((r=>e.resetInput(t,r))),e.unsetAllFilters(t)}static completeReset(t){const r=t._visiblityInternal.filters;r&&(Array.isArray(t.filter)?t.filter.forEach(((e,t)=>{r[t].defaultColumnHeaderName=e.defaultColumnHeaderName})):"object"==typeof t.filter&&(r[0].defaultColumnHeaderName=t.filter.defaultColumnHeaderName),e.resetAllInputs(t))}static isContainerRequired(e,t){let r=!1;if(Array.isArray(e))r=!!e.find((e=>{const r=(e.position||FilterElements.DEFAULT_INPUT_POSITION).indexOf(t);return void 0!==r&&r>=0}));else if("object"==typeof e){const n=(e.position||FilterElements.DEFAULT_INPUT_POSITION).indexOf(t);r=void 0!==n&&n>=0}else if("boolean"==typeof e){const e=FilterElements.DEFAULT_INPUT_POSITION.indexOf(t);r=void 0!==e&&e>=0}return r}static extractUnfilteredRows(t,r){return Array.from(t.children).slice(0,r).filter((t=>!t.classList.contains(e.HIDDEN_ROW_CLASS)))}static wasHeaderChanged(e,t,r,n){const i=e[r].elements,a=t.find((e=>i===e.elements));return a&&(a.lastRegisteredHeaderName!==CellElement.getText(i[0])||n)}};_FilterInternalUtils.ACTIVE_WORKERS=0,_FilterInternalUtils.CHUNK_SIZE=2,_FilterInternalUtils.HIDDEN_ROW_CLASS="filter-hidden-row";let FilterInternalUtils=_FilterInternalUtils;class FileImportInputElement{static create(e){const t=document.createElement("input");return t.type="file",t.hidden=!0,setTimeout((()=>{var r;null==(r=e._tableElementRef)||r.appendChild(t)})),t}}class FilesUtils{static processStyles(e){const t={default:{},hover:{backgroundColor:"#f0f0f0"},click:{backgroundColor:"#e4e4e4"}};return e&&(Object.assign(t.default,e.default),Object.assign(t.hover,e.hover),Object.assign(t.click,e.click)),t}static createDefault(e){return{inputElementRef:FileImportInputElement.create(e)}}}FilesUtils.DEFAULT_BUTTON_POSITION="bottom-left";const _OuterContainerElements=class e{static getColumnContentContainer(e){return e.children[0].children[0]}static setContainerHeightBasedOnMiddleColumn(t){if(0===t.getBoundingClientRect().height){const r=e.getColumnContentContainer(t.children[1]);t.style.height=`${r.getBoundingClientRect().height}px`}}static setHeightsWhenOnlyMiddleColumns(t){setTimeout((()=>{t.top&&e.setContainerHeightBasedOnMiddleColumn(t.top),t.bottom&&e.setContainerHeightBasedOnMiddleColumn(t.bottom)}))}static appendChildToColumn(t,r){e.getColumnContentContainer(t).appendChild(r)}static addToContainer(t,r,n){const i=t.indexOf("top")>=0?r.top:r.bottom;t.indexOf("left")>=0?e.appendChildToColumn(i.children[0],n):t.indexOf("center")>=0?e.appendChildToColumn(i.children[1],n):e.appendChildToColumn(i.children[2],n)}static createContainerColumn(t,r){const n=document.createElement("div");n.classList.add(e.COLUMN_CLASS,t);const i=document.createElement("div");i.classList.add(e.COLUMN_INNER_CLASS);const a=document.createElement("div");return a.classList.add(e.COLUMN_CONTENT_CLASS),i.appendChild(a),n.appendChild(i),n.style.gridColumn=r,n}static createContainerElement(){const t=document.createElement("div");t.classList.add(e.CONTAINER_CLASS);const r=e.createContainerColumn(e.LEFT_COLUMN_CLASS,"1");t.appendChild(r);const n=e.createContainerColumn(e.CENTER_COLUMN_CLASS,"2");t.appendChild(n);const i=e.createContainerColumn(e.RIGHT_COLUMN_CLASS,"3");return t.appendChild(i),t}static addContainer(t,r,n){const i=e.createContainerElement();i.id=r,null!=n&&n.style.fontFamily&&(i.style.fontFamily=n.style.fontFamily);const a=r===e.TOP_CONTAINER_ID?"beforebegin":"afterend";return t.insertAdjacentElement(a,i),i}static isRequired(e,t){return!!Object.keys(e).find((r=>{const{position:n}=e[r];return n.indexOf(t)>=0}))}static isContainerRequired(t,r){var n;let i=!1;return t.pagination&&(i=e.isRequired(t._pagination.positions,r)),!i&&null!=(n=t.files)&&n.buttons&&(i=!!t.files.buttons.find((e=>(e.position||FilesUtils.DEFAULT_BUTTON_POSITION).indexOf(r)>=0))),!i&&t.filter&&(i=FilterInternalUtils.isContainerRequired(t.filter,r)),i}static create(t){var r;const n={},i=e.isContainerRequired(t,"top"),a=e.isContainerRequired(t,"bottom"),{_tableElementRef:s}=t,o=(null==(r=t._overflow)?void 0:r.overflowContainer)||s;if(!o)return n;if(i){const t=e.addContainer(o,e.TOP_CONTAINER_ID,s);n.top=t}if(a){const t=e.addContainer(o,e.BOTTOM_CONTAINER_ID,s);n.bottom=t}return e.setHeightsWhenOnlyMiddleColumns(n),n}};_OuterContainerElements.ABSOULUTE_FULL_TABLE_CLASS="absolute-container",_OuterContainerElements.CONTAINER_CLASS="outer-container",_OuterContainerElements.TOP_CONTAINER_ID="outer-top-container",_OuterContainerElements.BOTTOM_CONTAINER_ID="outer-bottom-container",_OuterContainerElements.COLUMN_CLASS="outer-container-column",_OuterContainerElements.COLUMN_INNER_CLASS="outer-container-column-inner",_OuterContainerElements.COLUMN_CONTENT_CLASS="outer-container-column-content",_OuterContainerElements.LEFT_COLUMN_CLASS="outer-container-left-column",_OuterContainerElements.CENTER_COLUMN_CLASS="outer-container-center-column",_OuterContainerElements.RIGHT_COLUMN_CLASS="outer-container-right-column";let OuterContainerElements=_OuterContainerElements;const _OuterDropdownButtonUtils=class e{static processStatefulStyle(e){e.hover??(e.hover=e.default),e.click??(e.click=e.hover)}static processAndApplyDefaultStyle(t,r){r&&(e.processStatefulStyle(r),Object.assign(t.style,r.default))}static createArrow(t,r){const n=document.createElement("div");n.classList.add(e.ARROW_CONTAINER_CLASS,GenericElementUtils.NOT_SELECTABLE_CLASS),t&&n.classList.add(...t);const i=SVGIconUtils.createSVGElement(ARROW_DOWN_SVG_STRING);return i.classList.add(e.ARROW_ICON_CLASS),r&&i.classList.add(...r),n.appendChild(i),n}};_OuterDropdownButtonUtils.ARROW_CONTAINER_CLASS="outer-dropdown-button-arrow-container",_OuterDropdownButtonUtils.ARROW_ICON_CLASS="outer-dropdown-button-arrow-icon";let OuterDropdownButtonUtils=_OuterDropdownButtonUtils;class RowsPerPageSelectButtonEvents{static mouseDown(e,t){var r,n,i,a,s,o;Object.assign(t.style,null==(n=null==(r=e.styles.rowsPerPageSelect)?void 0:r.button)?void 0:n.click);const l=t.children[0];Object.assign(l.style,null==(a=null==(i=e.styles.rowsPerPageSelect)?void 0:i.buttonText)?void 0:a.click);const c=t.children[1];Object.assign(c.style,null==(o=null==(s=e.styles.rowsPerPageSelect)?void 0:s.buttonArrow)?void 0:o.click)}static mouseLeave(e,t){RowsPerPageSelectButtonElement.applyStylesOnElements(t,"default",e.rowsPerPageSelect)}static mouseEnter(e,t){RowsPerPageSelectButtonElement.applyStylesOnElements(t,"hover",e.rowsPerPageSelect)}static setEvents(e,t){t.onmouseenter=RowsPerPageSelectButtonEvents.mouseEnter.bind(this,e._pagination.styles,t),t.onmouseleave=RowsPerPageSelectButtonEvents.mouseLeave.bind(this,e._pagination.styles,t),t.onmousedown=RowsPerPageSelectButtonEvents.mouseDown.bind(this,e._pagination,t),t.onmouseup=RowsPerPageSelectButtonEvents.mouseEnter.bind(this,e._pagination.styles,t)}}const _RowsPerPageSelectButtonElement=class e{static applyStylesOnElements(e,t,r){if(!r)return;const{button:n,buttonText:i,buttonArrow:a}=r;if(n&&StatefulCSSEvents.apply(n,n[t],e),i){const r=e.children[0];StatefulCSSEvents.apply(i,i[t],r)}if(a){const r=e.children[1];StatefulCSSEvents.apply(a,a[t],r)}}static createButtonArrow(e){var t;const r=OuterDropdownButtonUtils.createArrow();return OuterDropdownButtonUtils.processAndApplyDefaultStyle(r,null==(t=e.styles.rowsPerPageSelect)?void 0:t.buttonArrow),r}static updateButtonText(e,t){e.children[0].innerText=t}static createButtonText(t){var r;const{isAllRowsOptionSelected:n,rowsPerPageOptionsItemText:i,rowsPerPage:a,styles:s}=t,o=document.createElement("div");return o.id=e.TEXT_ID,o.classList.add(GenericElementUtils.NOT_SELECTABLE_CLASS),OuterDropdownButtonUtils.processAndApplyDefaultStyle(o,null==(r=s.rowsPerPageSelect)?void 0:r.buttonText),o.innerText=n?i[0]:String(a),o}static createOptionsButton(t){var r;const n=document.createElement("div");return n.id=e.BUTTON_ID,OuterDropdownButtonUtils.processAndApplyDefaultStyle(n,null==(r=t.styles.rowsPerPageSelect)?void 0:r.button),n}static create(t){const r=e.createOptionsButton(t._pagination);return r.appendChild(e.createButtonText(t._pagination)),r.appendChild(e.createButtonArrow(t._pagination)),setTimeout((()=>RowsPerPageSelectButtonEvents.setEvents(t,r))),r}};_RowsPerPageSelectButtonElement.BUTTON_ID="rows-per-page-select-button",_RowsPerPageSelectButtonElement.TEXT_ID="rows-per-page-select-button-text";let RowsPerPageSelectButtonElement=_RowsPerPageSelectButtonElement;class RowsPerPageDropdown{static getLeftPropertyToCenterDropdown(e,t){return e.offsetLeft+e.offsetWidth/2-t/2+"px"}static display(e,t,r){const{dropdownWidth:n}=t._pagination,{element:i}=r;i.style.left=RowsPerPageDropdown.getLeftPropertyToCenterDropdown(e,n),OuterDropdownSimpleUtils.display(e,t,r)}static setWidth(e,t){const r=8*t.rowsPerPageOptionsItemText.reduce(((e,t)=>isNaN(Number(t))?e:Math.max(e,t.length)),1);t.dropdownWidth=t.dropdownWidth+r,e.style.width=`${t.dropdownWidth}px`}static create(e,t){const r=OuterDropdownSimpleUtils.hide.bind(this,e._activeOverlayElements),n=RowsPerPageDropdown.display.bind(this,t),i=OuterDropdownElement.create(e,t,"bottom-center",{},[],r,n);return RowsPerPageDropdownItem.populate(e,i.element,t),RowsPerPageDropdown.setWidth(i.element,e._pagination),i}}const _RowsPerPageSelectElement=class e{static createText(t){var r;const n=document.createElement("div");return n.id=e.TEXT_ID,n.style.marginRight="8px",Object.assign(n.style,null==(r=t.styles.rowsPerPageSelect)?void 0:r.prefixText),n.innerText=t.rowsPerPageSelect.prefixText,n}static createContainer(t){var r;const n=document.createElement("div");return n.id=e.ID,n.classList.add(PaginationElements.PAGINATION_TEXT_COMPONENT_CLASS),n.style.order=String(t.positions.rowsPerPageSelect.order),Object.assign(n.style,null==(r=t.styles.rowsPerPageSelect)?void 0:r.container),n}static create(t,r){const n=e.createContainer(t._pagination);n.appendChild(e.createText(t._pagination));const i=RowsPerPageSelectButtonElement.create(t),a=RowsPerPageDropdown.create(t,i);return n.appendChild(i),n.appendChild(a.element),OuterContainerElements.addToContainer(t._pagination.positions.rowsPerPageSelect.position,r,n),n}};_RowsPerPageSelectElement.ID="pagination-number-of-rows-select",_RowsPerPageSelectElement.TEXT_ID="pagination-number-of-rows-select-text";let RowsPerPageSelectElement=_RowsPerPageSelectElement;class PaginationElements{static create(e,t){e._pagination.buttonContainer=PageButtonContainerElement.create(e),PageButtonContainerElement.addInitialElements(e,t),e._pagination.rowsPerPageOptionsItemText&&RowsPerPageSelectElement.create(e,t),e._pagination.displayNumberOfVisibleRows&&(e._pagination.numberOfVisibleRowsElement=NumberOfVisibleRowsElement.create(e,t))}}PaginationElements.PAGINATION_TEXT_COMPONENT_CLASS="pagination-text-component";const _NumberOfVisibleRowsElement=class e{static updateForRelativeRowNumber(e,t){const{activePageNumber:r,rowsPerPage:n,numberOfVisibleRowsElement:i}=e,a=r*n,s=t<1?0:Math.max(a-n+1,1),o=Math.min(t,a);i.innerText=`${s}-${o} of ${t}`}static updateForAllRows(e,t){e.innerText=`${Math.min(t,1)}-${t} of ${t}`}static update(t){var r,n;const{_pagination:i,data:a,dataStartsAtHeader:s}=t,{numberOfVisibleRowsElement:o,isAllRowsOptionSelected:l}=i;if(!o)return;const c=(null==(n=null==(r=t._pagination)?void 0:r.asyncStartData)?void 0:n.totalDataRows)||Math.max(s?a.length:a.length-1,0);l?e.updateForAllRows(o,c):e.updateForRelativeRowNumber(t._pagination,c)}static create(t,r){const n=document.createElement("div");n.id=e.ID,n.classList.add(PaginationElements.PAGINATION_TEXT_COMPONENT_CLASS);const{styles:i,positions:a}=t._pagination;return n.style.order=String(a.numberOfVisibleRows.order),Object.assign(n.style,i.numberOfVisibleRows),OuterContainerElements.addToContainer(a.numberOfVisibleRows.position,r,n),setTimeout((()=>e.update(t))),n}};_NumberOfVisibleRowsElement.ID="pagination-number-of-visible-rows";let NumberOfVisibleRowsElement=_NumberOfVisibleRowsElement;class PageNumberButtonEvents{static markClick(e){e.clickedPageNumberButton=!0,setTimeout((()=>e.clickedPageNumberButton=!1))}static buttonMouseUp(e,t){PageNumberButtonEvents.markClick(this._pagination);const r=t.target,{pageButtons:n}=this._pagination.styles;this._pagination.activePageNumber===e||PaginationUtils.getAndApplyDataOnButtonClick(this,e),PageButtonStyle.mouseEnter(r,n,!1)}static setEvents(e,t,r){r.onmouseup=PageNumberButtonEvents.buttonMouseUp.bind(e,t)}}class PageNumberButtonElement{static create(e,t){const r=PageButtonElement.create(e._pagination.styles.pageButtons,!1);return r.innerHTML=String(t),setTimeout((()=>PageNumberButtonEvents.setEvents(e,t,r))),r}}class PaginationUpdatePageButtons{static removeLastNumberButton(e,t){t[t.length-1].remove();const r=t[0],n=Number(r.innerText);if(n>1){const t=PageNumberButtonElement.create(e,n-1);r.insertAdjacentElement("beforebegin",t)}}static updateOnRowRemove(e){const t=PaginationUtils.getPageNumberButtons(e._pagination),r=t[t.length-1];Number(r.innerText)>PaginationUtils.getLastPossiblePageNumber(e)?t.length>1&&PaginationUpdatePageButtons.removeLastNumberButton(e,t):e.data.length<(e.dataStartsAtHeader?1:2)&&PageButtonElement.setDisabled(e._pagination)}static addNewNumberButtonAtEndIfNeeded(e,t){const r=t[t.length-1],n=PaginationUtils.getLastPossiblePageNumber(e,!0);if(Number(r.innerText)<n){const t=PageNumberButtonElement.create(e,n);r.insertAdjacentElement("afterend",t)}}static updateOnRowInsert(e){const t=e.dataStartsAtHeader?0:1;if(e.data.length===t)PageButtonElement.unsetDisabled(e._pagination);else{const t=PaginationUtils.getPageNumberButtons(e._pagination);t.length<e._pagination.maxNumberOfVisiblePageButtons&&PaginationUpdatePageButtons.addNewNumberButtonAtEndIfNeeded(e,t)}}static shiftLeftwards(e,t,r){const{activePageNumber:n}=e._pagination,i=t[0],a=Number(i.innerText);let s=n<=t.length/2?a-1:r-n,o=a;s>t.length&&(s=t.length,o=t.length+1);for(let t=s-1;t>=0;t-=1){const r=PageNumberButtonElement.create(e,o-t-1);i.insertAdjacentElement("beforebegin",r)}t.slice(t.length-s).forEach((e=>e.remove()))}static shiftRightwards(e,t,r,n){const{activePageNumber:i}=e._pagination,a=PaginationUtils.getLastPossiblePageNumber(e);let s=i>a-t.length/2?a-r:i-n,o=r;s>t.length&&(s=t.length,o=i-t.length);const l=t[t.length-1];for(let t=s-1;t>=0;t-=1){const r=PageNumberButtonElement.create(e,t+o+1);l.insertAdjacentElement("afterend",r)}t.slice(0,s).forEach((e=>e.remove()))}static updateOnNewActive(e){const t=PaginationUtils.getPageNumberButtons(e._pagination),{activePageNumber:r,maxNumberOfVisiblePageButtons:n}=e._pagination;if(t.length<n)return;const i=Number(t[t.length-1].innerText),a=Math.floor(i-t.length/2)+1;if(r>a)PaginationUpdatePageButtons.shiftRightwards(e,t,i,a);else{const n=Math.ceil(i-t.length/2);r<n&&PaginationUpdatePageButtons.shiftLeftwards(e,t,n)}}}const _LoadingElement=class e{static createSpinner(e){const t=document.createElement("span");return t.className="loading-spinner",Object.assign(t.style,e),t}static applyTableStyles(e,t,r){e.forEach((e=>{t[e]&&(r.style[e]=t[e])}))}static removeTableStyles(e,t){e.forEach((e=>{delete t.style[e]}))}static processCustom(e,t){return"none"===e.style.display&&(e.style.display="block"),Object.assign(e.style,null==t?void 0:t.container),e}static createContainer(t,r){const n=document.createElement("div");return r&&e.applyTableStyles(["width","minWidth","maxHeight","height","minHeight","maxHeight","border","borderColor","borderWidth"],r,n),Object.assign(n.style,null==t?void 0:t.container),n}static createNew(t,r){const n=e.createContainer(t,r);n.classList.add(e.DEFAULT_LOADING_CONTAINER_CLASS);const i=e.createSpinner(null==t?void 0:t.spinner);return n.appendChild(i),n}static processInitial(t){const{loadingStyles:r,tableStyle:n}=t,i=t.children[0];return i?e.processCustom(i,r):e.createNew(r,n)}static addInitial(t){var r;t._activeOverlayElements.loading=e.processInitial(t),null==(r=t.shadowRoot)||r.appendChild(t._activeOverlayElements.loading)}static update(t,r,n){t.classList.contains(e.DEFAULT_LOADING_CONTAINER_CLASS)&&r&&(e.removeTableStyles(["width","minWidth","maxHeight","height","minHeight","maxHeight","border","borderColor","borderWidth"],t),Object.assign(t.style,null==n?void 0:n.container)),null!=n&&n.loadingBackgroundColor&&(t.style.backgroundColor=null==n?void 0:n.loadingBackgroundColor)}static addActive(t){var r;const{loading:n}=t._activeOverlayElements;n&&(n.classList.contains(OuterContainerElements.ABSOULUTE_FULL_TABLE_CLASS)||(n.classList.add(OuterContainerElements.ABSOULUTE_FULL_TABLE_CLASS),e.update(n,t.tableStyle,t.loadingStyles)),null==(r=t._tableElementRef)||r.appendChild(n))}};_LoadingElement.DEFAULT_LOADING_CONTAINER_CLASS="default-loading-container";let LoadingElement=_LoadingElement;class ErrorElement{static create(){const e=document.createElement("div");e.id="error-container",e.classList.add(OuterContainerElements.ABSOULUTE_FULL_TABLE_CLASS);const t=document.createElement("div");return t.id="error-text",t.innerHTML="Error retrieving data",e.appendChild(t),e}static display(e){const{error:t}=e._activeOverlayElements;t&&e._tableElementRef&&e._tableElementRef.appendChild(t)}static remove(e){var t;null==(t=e._activeOverlayElements.error)||t.remove()}}class PaginationAsyncUtils{static displayError(e,t){ErrorElement.display(t),console.error(e),console.error("Error fetching page information")}static setNewElementText(e,t,r,n,i){CellEvents.updateCell(e,t,i,n,{element:r,processText:!1,updateCellEvent:!1,updateTableEvent:!1}),ColumnTypesUtils.updateDataElements(e,i,n,r)}static insertData(e,t,r){const n=10*(r-1)+(e.dataStartsAtHeader?0:1);t.length>e._pagination.rowsPerPage&&(t=t.slice(0,e._pagination.rowsPerPage)),n+t.length>e.data.length&&(t=t.slice(0,t.length-(n+t.length-e.data.length))),t.forEach(((t,r)=>{t.forEach(((t,i)=>{const a=n+r,s=e._columnsDetails[i].elements[a];PaginationAsyncUtils.setNewElementText(e,t,s,i,a)}))})),UpdateIndexColumnWidth.update(e)}static async getAndApplyNewData(e,t,r,n){var i;const a=n||r;e._pagination.asyncGetId=a,ErrorElement.remove(e),LoadingElement.addActive(e),PageButtonElement.setActive(e,r);let s=[[]];try{if(s=await t.getPageData(r,e._pagination.rowsPerPage),e._pagination.asyncGetId!==a)return}catch(t){PaginationAsyncUtils.displayError(t,e)}PaginationAsyncUtils.insertData(e,s,r),null==(i=e._activeOverlayElements.loading)||i.remove(),PaginationUtils.displayRowsForDifferentButton(e,r)}static isAsyncPagination(e){return"object"==typeof e&&e.async}static removeLoadingOverlay(e){var t;PaginationAsyncUtils.isAsyncPagination(e.pagination)&&(null==(t=e._activeOverlayElements.loading)||t.remove())}static preprocessTablePropertiesIfAsync(e){var t;PaginationAsyncUtils.isAsyncPagination(e.pagination)&&(e.displayAddNewRow=!1,e.displayAddNewColumn=!1,e.rowDropdown.displaySettings.isAvailable=!1,e.columnDropdown={displaySettings:{isAvailable:!1}},e.files??(e.files={}),e.files.buttons=null==(t=e.files.buttons)?void 0:t.filter((e=>!e.import)),e.files.dragAndDrop=!1)}}const _PaginationUtils=class e{static getLastPossiblePageNumber(e,t=!1){const{_pagination:r,dataStartsAtHeader:n}=e;if(r.isAllRowsOptionSelected)return 1;const i=PaginationInternalUtils.getTotalNumberOfRows(e),a=n?i+1:i,s=t?a:a-1;return Math.max(Math.ceil(s/r.rowsPerPage),1)}static getPageNumberButtons(e){const{buttonContainer:t,numberOfActionButtons:r}=e,n=Array.from(t.children),i=r/2;return n.slice(i,n.length-i)}static hideRow(t){var r;(null==(r=t.children[0])?void 0:r.tagName)===CellElement.HEADER_TAG?t.classList.add(e.HIDDEN_ROW_CLASS):t.style.display="none"}static displayRow(t,r){t.children[0].tagName===CellElement.HEADER_TAG?t.classList.remove(e.HIDDEN_ROW_CLASS):t.style.display="",r.push(t)}static updateOnRowMove(t,r){const{activePageNumber:n}=t._pagination;PaginationRowIndexes.getMaxVisibleRowIndex(t)<=r?e.displayRowsForDifferentButton(t,n+1):r>0&&t._tableBodyElementRef&&r<PaginationRowIndexes.getVisibleRowRealIndex(t._tableBodyElementRef,t._pagination,0)&&e.displayRowsForDifferentButton(t,n-1)}static getSiblingVisibleRow(t,r){const n=null==t?void 0:t[r];if(n&&!AddNewRowElement.isAddNewRowRow(n))return n.classList.contains(FilterInternalUtils.HIDDEN_ROW_CLASS)?e.getSiblingVisibleRow(n,r):n}static updateRowsOnRemoval(t,r){const{visibleRows:n,activePageNumber:i}=t._pagination;if(1!==i||-1!==r)if(n.splice(r,1),n.length>0){const t=n[n.length-1],r=e.getSiblingVisibleRow(t,"nextSibling");r&&e.displayRow(r,n)}else i>1&&(e.displayRowsForDifferentButton(t,i-1),t._visiblityInternal.filters&&e.getLastPossiblePageNumber(t)!==i-1&&e.displayRowsForDifferentButton(t,i))}static hideLastVisibleRow(t){const{visibleRows:r}=t;if(0===r.length)return;const n=r[r.length-1];e.hideRow(n),t.visibleRows.splice(t.visibleRows.length-1,1)}static updateRowsOnNewInsert(t,r,n){const{rowsPerPage:i,visibleRows:a,activePageNumber:s,isAllRowsOptionSelected:o}=t._pagination;if(PaginationRowIndexes.getMaxVisibleRowIndex(t)>r&&t._tableBodyElementRef){a.length===i&&!o&&e.hideLastVisibleRow(t._pagination);const s=PaginationRowIndexes.getVisibleRowIndex(t._tableBodyElementRef,t._pagination,r);a.splice(-1===s?a.length:s,0,n)}else e.hideRow(n),setTimeout((()=>{const r=e.getLastPossiblePageNumber(t),n=s+1;r<n?e.setCorrectRowsAsVisible(t,r):e.displayRowsForDifferentButton(t,n)}))}static updateOnRowChange(t,r,n){const{dataStartsAtHeader:i,_pagination:a}=t;!i&&0===r&&0===PaginationInternalUtils.getTotalNumberOfRows(t)||(PaginationVisibleButtonsUtils.unsetStateAndStyles(a),n?(PaginationUpdatePageButtons.updateOnRowInsert(t),e.updateRowsOnNewInsert(t,r,n)):(PaginationUpdatePageButtons.updateOnRowRemove(t),e.updateRowsOnRemoval(t,r)),PaginationPageActionButtonUtils.toggleActionButtons(t),PaginationVisibleButtonsUtils.setStateAndStyles(t),setTimeout((()=>NumberOfVisibleRowsElement.update(t))))}static initialRowUpdates(t,r,n){const i=t.dataStartsAtHeader?r+1:r;i>t._pagination.rowsPerPage?e.hideRow(n):i>0&&t._pagination.visibleRows.push(n)}static updateAddRowRow(t){if(t._stripedRows&&t._tableBodyElementRef&&t._addRowCellElementRef){const r=t._addRowCellElementRef.parentElement,n=Array.from(t._tableBodyElementRef.children).length-1,i=e.getLastPossiblePageNumber(t)!==t._pagination.activePageNumber;CustomRowProperties.updateRow(t,r,n,i,n)}}static setCorrectRowsAsVisible(t,r){const{_pagination:{rowsPerPage:n,visibleRows:i},_tableBodyElementRef:a,data:s,_visiblityInternal:o}=t,l=null!=o&&o.filters?FilterInternalUtils.extractUnfilteredRows(a,s.length):ExtractElements.textRowsArrFromTBody(a,s);let c=n*(r-1);t.dataStartsAtHeader||(c+=1),l.slice(c,c+n).forEach((t=>{e.displayRow(t,i)}))}static hideAllRows(t){t.visibleRows.forEach((t=>e.hideRow(t))),t.visibleRows=[]}static displayRowsForDifferentButton(t,r){e.hideAllRows(t._pagination),e.setCorrectRowsAsVisible(t,r),PageButtonElement.setActive(t,r),NumberOfVisibleRowsElement.update(t),t._frameComponents.displayAddNewRow&&e.updateAddRowRow(t)}static getFirstVisibleRow(e){return e.find((e=>!e.classList.contains(FilterInternalUtils.HIDDEN_ROW_CLASS)))}static async getAndApplyDataOnButtonClick(t,r,n){t._pagination.async?PaginationAsyncUtils.getAndApplyNewData(t,t._pagination.async,r,n):e.displayRowsForDifferentButton(t,r)}};_PaginationUtils.HIDDEN_ROW_CLASS="hidden-row";let PaginationUtils=_PaginationUtils;class PaginationPageActionButtonUtils{static setButtonAsEnabled(e,t){PageButtonStyle.setDefault(e,t,!0),e.classList.remove(PageButtonElement.DISABLED_PAGINATION_BUTTON_CLASS)}static setButtonAsDisabled(e,t){PageButtonStyle.setDisabled(e,t,!0),e.classList.add(PageButtonElement.DISABLED_PAGINATION_BUTTON_CLASS)}static toggleRightButtons(e,t,r){const{activePageNumber:n,styles:i}=e._pagination,a=n===PaginationUtils.getLastPossiblePageNumber(e)?PaginationPageActionButtonUtils.setButtonAsDisabled:PaginationPageActionButtonUtils.setButtonAsEnabled;t.slice(t.length-r).forEach((e=>a(e,i.pageButtons)))}static toggleLeftButtons(e,t,r,n){const i=1===t?PaginationPageActionButtonUtils.setButtonAsDisabled:PaginationPageActionButtonUtils.setButtonAsEnabled;e.slice(0,r).forEach((e=>i(e,n.pageButtons)))}static toggleActionButtons(e){const{activePageNumber:t,styles:r,numberOfActionButtons:n,buttonContainer:i}=e._pagination,a=Array.from(i.children),s=n/2;PaginationPageActionButtonUtils.toggleLeftButtons(a,t,s,r),PaginationPageActionButtonUtils.toggleRightButtons(e,a,s)}}class PageButtonEvents{static buttonMouseLeave(e,t,r){const n=r.target;PageButtonStyle.mouseLeave(n,e,t)}static buttonMouseEnter(e,t,r){const n=r.target;PageButtonStyle.mouseEnter(n,e,t)}static buttonMouseDown(e,t,r){const n=r.target;PageButtonStyle.mouseDown(n,e,t)}static setEvents(e,t,r){e.onmousedown=PageButtonEvents.buttonMouseDown.bind(this,t,r),e.onmouseenter=PageButtonEvents.buttonMouseEnter.bind(this,t,r),e.onmouseleave=PageButtonEvents.buttonMouseLeave.bind(this,t,r)}}const _PageButtonElement=class e{static unsetDisabled(t){const r=PaginationUtils.getPageNumberButtons(t)[0],{pageButtons:n}=t.styles;PageButtonStyle.setActive(r,n),r.classList.replace(e.DISABLED_PAGINATION_BUTTON_CLASS,n.activeButtonClass)}static setDisabled(t){const{buttonContainer:r,styles:n,numberOfActionButtons:i}=t,a=Array.from(r.children);for(let e=0;e<i/2;e+=1)PageButtonStyle.setDisabled(a[e],n.pageButtons,!0),PageButtonStyle.setDisabled(a[a.length-1-e],n.pageButtons,!0);const s=PaginationUtils.getPageNumberButtons(t)[0];PageButtonStyle.setDisabled(s,n.pageButtons,!1),s.classList.remove(n.pageButtons.activeButtonClass),a.forEach((t=>{t.classList.add(e.DISABLED_PAGINATION_BUTTON_CLASS)}))}static programmaticMouseEnterTrigger(e,t,r){const n=e[r],{pageButtons:i}=t.styles;n&&!n.classList.contains(i.activeButtonClass)&&(PageButtonStyle.mouseEnter(n,i,!1),t.programaticallyHoveredPageNumberButton=n,setTimeout((()=>delete t.programaticallyHoveredPageNumberButton)))}static setNewActive(e,t){const r=PaginationUtils.getPageNumberButtons(e),n=Number(r[r.length-1].innerText),i=r[r.length-(n-t)-1];return i.classList.add(e.styles.pageButtons.activeButtonClass),{newActiveButton:i,numberButtons:r}}static unsetPreviousActive(e,t){const r=PaginationUtils.getPageNumberButtons(e),n=Number(r[r.length-1].innerText),i=r[r.length-(n-e.activePageNumber)-1],a=r.length-(n-t)-1;return i?(i.classList.remove(e.styles.pageButtons.activeButtonClass),{previousActiveButton:i,previousLocationOfNewIndex:a}):{previousLocationOfNewIndex:a}}static setActive(t,r){const{_pagination:n}=t,{styles:{pageButtons:i},clickedPageNumberButton:a}=n,{previousActiveButton:s,previousLocationOfNewIndex:o}=e.unsetPreviousActive(n,r);PaginationVisibleButtonsUtils.unsetStateAndStyles(t._pagination),n.activePageNumber=r,PaginationUpdatePageButtons.updateOnNewActive(t);const{newActiveButton:l,numberButtons:c}=e.setNewActive(n,r);PageButtonStyle.setActive(l,i,s),PaginationPageActionButtonUtils.toggleActionButtons(t),PaginationVisibleButtonsUtils.setStateAndStyles(t),a&&e.programmaticMouseEnterTrigger(c,n,o)}static create(t,r){const n=document.createElement("div");return n.classList.add(e.PAGINATION_BUTTON_CLASS,PaginationElements.PAGINATION_TEXT_COMPONENT_CLASS,GenericElementUtils.NOT_SELECTABLE_CLASS),PageButtonStyle.setDefault(n,t,r),setTimeout((()=>PageButtonEvents.setEvents(n,t,r))),n}};_PageButtonElement.PAGINATION_BUTTON_CLASS="pagination-button",_PageButtonElement.DISABLED_PAGINATION_BUTTON_CLASS="pagination-button-disabled",_PageButtonElement.ACTIVE_PAGINATION_BUTTON_CLASS="pagination-button-active",_PageButtonElement.PRECEDENCE_ACTIVE_PAGINATION_BUTTON_CLASS="pagination-button-active-precedence";let PageButtonElement=_PageButtonElement;const _PaginationVisibleButtonsUtils=class e{static getRightBorderWidthInStyleOverride(e){return e.borderRightWidth?Number.parseInt(e.borderRightWidth):e.borderRight?Number.parseInt(e.borderRight.split(" ")[0]):-1}static setBorderPaddingForLastPrecedence(t,r){const n=e.getRightBorderWidthInStyleOverride(r);if(isNaN(n)||0===n)return;const i=Number.parseInt(getComputedStyle(t).borderRightWidth);i>0?t.style.borderRightWidth=`${i+n}px`:t.style.borderRight=`${n}px solid #fafafa01`}static setStyle(t,r,n,i){if(!i)return;const a=new Set(Object.keys(i)),s=t.classList.contains(PageButtonElement.PRECEDENCE_ACTIVE_PAGINATION_BUTTON_CLASS);s&&r.forEach((e=>a.delete(e))),a.forEach((e=>{ElementStyle.setStyle(t,e,i[e])})),n&&s&&e.setBorderPaddingForLastPrecedence(t,i)}static overrideOnMouseEvent(t,r){const{firstVisibleButtonOverride:n,lastVisibleButtonOverride:i}=r;t.classList.contains(e.FIRST_VISIBLE_CLASS)&&e.setStyle(t,e.FIRST_PRECEDENCE_VALUES,!1,n),t.classList.contains(e.LAST_VISIBLE_CLASS)&&e.setStyle(t,e.LAST_PRECEDENCE_VALUES,!0,i)}static unsetStateAndStyles(t){const{styles:{pageButtons:{firstVisibleButtonOverride:r,lastVisibleButtonOverride:n}},visibleEdgeButtons:i}=t;0!==i.length&&(r&&ElementStyle.unsetStyle(i[0],r),i[0].classList.remove(e.FIRST_VISIBLE_CLASS),n&&ElementStyle.unsetStyle(i[1],n),i[1].classList.remove(e.LAST_VISIBLE_CLASS),t.visibleEdgeButtons=[])}static isButtonVisible(e){return e.clientWidth>0&&"hidden"!==e.style.visibility}static set(t,r,n){const{styles:{pageButtons:{firstVisibleButtonOverride:i,lastVisibleButtonOverride:a}}}=n,s=t[r];if(!s)return;s.classList.contains(e.FIRST_VISIBLE_CLASS)||(e.setStyle(s,e.FIRST_PRECEDENCE_VALUES,!1,i),s.classList.add(e.FIRST_VISIBLE_CLASS));const o=t.findLastIndex(e.isButtonVisible),l=t[o];l.classList.contains(e.LAST_VISIBLE_CLASS)||(e.setStyle(l,e.LAST_PRECEDENCE_VALUES,!0,a),l.classList.add(e.LAST_VISIBLE_CLASS)),n.visibleEdgeButtons=[s,l]}static setStateAndStyles(t){const{_pagination:r,displayAddNewRow:n}=t,i=Array.from(r.buttonContainer.children),a=i.findIndex(e.isButtonVisible);-1===a?setTimeout((()=>{const t=i.findIndex(e.isButtonVisible);e.set(i,t,r)})):e.set(i,a,r),n||RowElement.toggleLastRowClass(t)}};_PaginationVisibleButtonsUtils.FIRST_VISIBLE_CLASS="pagination-first-visible-button",_PaginationVisibleButtonsUtils.LAST_VISIBLE_CLASS="pagination-last-visible-button",_PaginationVisibleButtonsUtils.FIRST_PRECEDENCE_VALUES=["borderLeft","borderLeftWidth","borderLeftColor"],_PaginationVisibleButtonsUtils.LAST_PRECEDENCE_VALUES=["borderRight","borderRightWidth","borderRightColor"];let PaginationVisibleButtonsUtils=_PaginationVisibleButtonsUtils;function buildIcon$1(e){return`<?xml version="1.0" encoding="utf-8"?>\n    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="transform: ${e}">\n      <path d="M5.5 5L11.7929 11.2929C12.1834 11.6834 12.1834 12.3166 11.7929 12.7071L5.5 19" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n    </svg>`}const PREVIOUS_PAGE_ICON_SVG_STRING=buildIcon$1("rotate(180deg)"),NEXT_PAGE_ICON_SVG_STRING=buildIcon$1("");class PreviousPageButtonEvents{static buttonMouseUp(e){const{activePageNumber:t,styles:r}=this._pagination;if(1===t)return;PaginationUtils.getAndApplyDataOnButtonClick(this,t-1);const n=e.target;PageButtonStyle.mouseEnter(n,r.pageButtons,!0)}static setEvents(e,t){t.onmouseup=PreviousPageButtonEvents.buttonMouseUp.bind(e)}}class PreviousPageButtonElement{static populate(e,t){if(t)e.innerHTML=String(t);else{const t=SVGIconUtils.createSVGElement(PREVIOUS_PAGE_ICON_SVG_STRING);t.classList.add("pagination-prev-next-button"),e.appendChild(t)}}static create(e){const{pageButtons:t}=e._pagination.styles,r=PageButtonElement.create(t,!0);return PreviousPageButtonElement.populate(r,t.actionButtons.previousText),setTimeout((()=>PreviousPageButtonEvents.setEvents(e,r))),r}}function buildIcon(e){return`<?xml version="1.0" encoding="utf-8"?>\n    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="transform: ${e}">\n      <path d="M5.5 5L11.7929 11.2929C12.1834 11.6834 12.1834 12.3166 11.7929 12.7071L5.5 19" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n      <path d="M13.5 5L19.7929 11.2929C20.1834 11.6834 20.1834 12.3166 19.7929 12.7071L13.5 19" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n    </svg>`}const FIRST_PAGE_ICON_SVG_STRING=buildIcon("rotate(180deg)"),LAST_PAGE_ICON_SVG_STRING=buildIcon("");class FirstPageButtonEvents{static buttonMouseUp(e){const t=e.target;PageButtonStyle.mouseEnter(t,this._pagination.styles.pageButtons,!0),1!==this._pagination.activePageNumber&&PaginationUtils.getAndApplyDataOnButtonClick(this,1)}static setEvents(e,t){t.onmouseup=FirstPageButtonEvents.buttonMouseUp.bind(e)}}class FirstPageButtonElement{static populate(e,t){if(t)e.innerHTML=String(t);else{const t=SVGIconUtils.createSVGElement(FIRST_PAGE_ICON_SVG_STRING);t.classList.add("pagination-first-last-button"),e.appendChild(t)}}static create(e){const{pageButtons:t}=e._pagination.styles,r=PageButtonElement.create(t,!0);return FirstPageButtonElement.populate(r,t.actionButtons.firstText),setTimeout((()=>FirstPageButtonEvents.setEvents(e,r))),r}}class LastPageButtonEvents{static buttonMouseUp(e){const t=e.target,{activePageNumber:r,styles:n}=this._pagination;PageButtonStyle.mouseEnter(t,n.pageButtons,!0);const i=PaginationUtils.getLastPossiblePageNumber(this);i<=r||PaginationUtils.getAndApplyDataOnButtonClick(this,i)}static setEvents(e,t){t.onmouseup=LastPageButtonEvents.buttonMouseUp.bind(e)}}class LastPageButtonElement{static populate(e,t){if(t)e.innerHTML=String(t);else{const t=SVGIconUtils.createSVGElement(LAST_PAGE_ICON_SVG_STRING);t.classList.add("pagination-first-last-button"),e.appendChild(t)}}static create(e){const{pageButtons:t}=e._pagination.styles,r=PageButtonElement.create(t,!0);return LastPageButtonElement.populate(r,t.actionButtons.lastText),setTimeout((()=>LastPageButtonEvents.setEvents(e,r))),r}}class NextPageButtonEvents{static buttonMouseUp(e){const{activePageNumber:t,styles:r}=this._pagination;if(PaginationUtils.getLastPossiblePageNumber(this)<=t)return;PaginationUtils.getAndApplyDataOnButtonClick(this,t+1);const n=e.target;PageButtonStyle.mouseEnter(n,r.pageButtons,!0)}static setEvents(e,t){t.onmouseup=NextPageButtonEvents.buttonMouseUp.bind(e)}}class NextPageButtonElement{static populate(e,t){if(t)e.innerHTML=String(t);else{const t=SVGIconUtils.createSVGElement(NEXT_PAGE_ICON_SVG_STRING);t.classList.add("pagination-prev-next-button"),e.appendChild(t)}}static create(e){const{pageButtons:t}=e._pagination.styles,r=PageButtonElement.create(t,!0);return NextPageButtonElement.populate(r,t.actionButtons.nextText),setTimeout((()=>NextPageButtonEvents.setEvents(e,r))),r}}class PageButtonContainerEvents{static containerMouseLeave(e){const{clickedPageNumberButton:t,programaticallyHoveredPageNumberButton:r,styles:n}=e;t&&r&&PageButtonStyle.mouseLeave(r,n.pageButtons,!1)}static setEvents(e,t){e.onmouseleave=PageButtonContainerEvents.containerMouseLeave.bind(this,t)}}const _PageButtonContainerElement=class e{static shouldButtonsBeActive(e){const t=e.dataStartsAtHeader?1:2;return e.data.length>=t}static setStyle(t,r){e.shouldButtonsBeActive(t)?PageButtonElement.setActive(t,r??1):PageButtonElement.setDisabled(t._pagination)}static addNumberButtons(e){const t=PaginationUtils.getLastPossiblePageNumber(e),{maxNumberOfVisiblePageButtons:r,buttonContainer:n}=e._pagination;for(let i=0;i<Math.min(t,r);i+=1){const t=PageNumberButtonElement.create(e,i+1);n.appendChild(t)}}static addButton(e,t){e.buttonContainer.appendChild(t),e.numberOfActionButtons+=1}static addButtons(t){const{displayPrevNext:r,displayFirstLast:n}=t._pagination;n&&e.addButton(t._pagination,FirstPageButtonElement.create(t)),r&&e.addButton(t._pagination,PreviousPageButtonElement.create(t)),e.addNumberButtons(t),r&&e.addButton(t._pagination,NextPageButtonElement.create(t)),n&&e.addButton(t._pagination,LastPageButtonElement.create(t))}static resetState(e){e.activePageNumber=1,e.numberOfActionButtons=0,e.visibleEdgeButtons=[]}static repopulateButtons(t){e.resetState(t._pagination),t._pagination.buttonContainer.replaceChildren(),e.addButtons(t),e.setStyle(t)}static addInitialElements(t,r){e.repopulateButtons(t),PaginationVisibleButtonsUtils.setStateAndStyles(t);const{positions:n,buttonContainer:i}=t._pagination;OuterContainerElements.addToContainer(n.pageButtons.position,r,i)}static create(t){const r=document.createElement("div");r.id=e.PAGINATION_BUTTON_CONTAINER_ID;const{styles:n,positions:i}=t._pagination;return r.style.order=String(i.pageButtons.order),Object.assign(r.style,n.pageButtons.container),PageButtonContainerEvents.setEvents(r,t._pagination),r}};_PageButtonContainerElement.PAGINATION_BUTTON_CONTAINER_ID="pagination-button-container";let PageButtonContainerElement=_PageButtonContainerElement;class InitialDataProcessing{static cleanupDataThatDidNotGetAdded(e,t){var r;(null==(r=e[0])?void 0:r.length)-t.length>0&&e.forEach((e=>e.splice(t.length))),0===t.length?e.splice(0,e.length):e.length>t[0].elements.length&&e.splice(t[0].elements.length)}static postProcess(e,t){setTimeout((()=>InitialDataProcessing.cleanupDataThatDidNotGetAdded(e,t)))}static fillRow(e,t){const r=new Array(t-e.length).fill(EMPTY_STRING);e.splice(e.length,t-e.length,...r)}static processRowDataByLength(e,t){0===t&&e.splice(0,e.length),e.forEach((e=>{e.length<t&&InitialDataProcessing.fillRow(e,t)}))}static getMaxRowLength(e){return e.reduce(((e,t)=>Math.max(e,t.length)),0)}static removeRowsExceedingLimit(e,t){void 0!==t&&t>0&&e.length>t&&e.splice(t,e.length-1)}static removeDuplicateHeaders(e,t){const r=e[0];r.reduce(((e,n,i)=>(e.has(n)?r[i]=t||"":e.add(n),e)),new Set)}static preProcess(e,t){const{maxRows:r,allowDuplicateHeaders:n,_defaultColumnsSettings:i}=e;InitialDataProcessing.removeRowsExceedingLimit(t,r);const a=InitialDataProcessing.getMaxRowLength(t);InitialDataProcessing.processRowDataByLength(t,a),!n&&t.length>0&&InitialDataProcessing.removeDuplicateHeaders(t,i.defaultText)}}class PaginationAsyncStartData{static fillTotalDataRows(e,t){var r;const{totalDataRows:n,data:i,failed:a}=t;if(e.data.length<n||a){const t=Math.max((null==(r=e.data[0])?void 0:r.length)||0,InitialDataProcessing.getMaxRowLength(i)),a=+!e.dataStartsAtHeader,s=new Array(n-e.data.length+a).fill(new Array(t).fill(EMPTY_STRING)),o=e.data.length;e.data.splice(e.data.length,0,...s),s.forEach(((t,r)=>{const n=InsertNewRow.insertNewRow(e,o+r,!1,t);setTimeout((()=>{UpdateCellsForRows.updateRowCells(e,n,o+r,CELL_UPDATE_TYPE.UPDATE,!1)}))})),PageButtonContainerElement.repopulateButtons(e)}}static populate(e,t){const{data:r,totalDataRows:n,failed:i}=t;r.length>0&&n>0&&(e.data.length>0||InitialDataProcessing.getMaxRowLength(r)>0)&&(PaginationAsyncStartData.fillTotalDataRows(e,t),i||PaginationAsyncUtils.insertData(e,r,1))}static async get(e,t,r){const{async:n,rowsPerPage:i}=t;if(!n)return;const{rowsPerPage:a}=r,s="number"==typeof i?i:a;try{const[e,t]=await Promise.all([n.getTotalRows(),n.getPageData(1,s)]);return{totalDataRows:e,data:t}}catch(t){return setTimeout((()=>PaginationAsyncUtils.displayError(t,e))),{totalDataRows:0,data:[["",""]],failed:!0}}}}class FrameComponentsElements{static addFrameBodyElements(e){var t,r;null==(r=e._tableBodyElementRef)||r.appendChild(null==(t=e._addRowCellElementRef)?void 0:t.parentElement),ToggleAdditionElements.update(e,!0,AddNewRowElement.toggle)}}const _SheetJSInternalUtils=class e{static async execFuncWithExtractorModule(t){const r=window.XLSX;r?t(r):console.error(e.MODULE_NOT_FOUND_ERROR)}};_SheetJSInternalUtils.MODULE_NOT_FOUND_ERROR="xlsx module was not found";let SheetJSInternalUtils=_SheetJSInternalUtils;class UpdateAllTableData{static toggleAdditionalElements(e){FilterInternalUtils.completeReset(e),ToggleAdditionElements.update(e,!0,AddNewRowElement.toggle),setTimeout((()=>{e._pagination&&1!==e._pagination.activePageNumber&&PaginationUtils.displayRowsForDifferentButton(e,1)}))}static insertData(e,t,r){InsertMatrix.insert(e,t,r,0,!0),0===r&&RootCellElement.convertFromRootCell(e)}static changeTableData(e,t,r,n){for(let t=e.data.length-1;t>=r;t-=1)RemoveRow.remove(e,t);InitialDataProcessing.preProcess(e,t),e._isPopulatingTable=!0,n?(UpdateAllTableData.insertData(e,t,r),UpdateAllTableData.toggleAdditionalElements(e),e._isPopulatingTable=!0):(setTimeout((()=>{UpdateAllTableData.insertData(e,t,r)})),setTimeout((()=>{UpdateAllTableData.toggleAdditionalElements(e),e._isPopulatingTable=!0}),6))}static update(e,t,r,n=!1){if(!Array.isArray(t))return;let i=!1;e._visiblityInternal.filters&&(i=FilterInternalUtils.unsetAllFilters(e)),!n&&i?setTimeout((()=>UpdateAllTableData.changeTableData(e,t,r,n)),40):UpdateAllTableData.changeTableData(e,t,r,n)}}class CSVImport{static getPaddedArray(e,t){return e.map((e=>e.concat(Array(t).fill("")).slice(0,t)))}static splitRow(e){const t=[];return e.replace(/("[^"]*"|[^,]+)(,|$)/g,((e,r)=>(t.push(r),""))),t}static parseDataFromRow(e,t,r){const n=CSVImport.splitRow(e);return n.length>0&&(t.push(n),n.length>r&&(r=n.length)),r}static parseCSV(e){try{const t=e.split(/\r\n|\n/),r=[];let n=0;return t.forEach((e=>{n=CSVImport.parseDataFromRow(e,r,n)})),CSVImport.getPaddedArray(r,n)}catch{return console.error("Incorrect format"),null}}static getStartRowIndex(e,t){return t&&"number"==typeof t.tableRowStartIndex?t.tableRowStartIndex<0||t.tableRowStartIndex>e?e:t.tableRowStartIndex:0}static processFile(e,t,r){const n=CSVImport.parseCSV(t);if(n&&r&&"number"==typeof r.importRowStartIndex&&n.splice(0,r.importRowStartIndex),!n||0===n.length)return;const i=CSVImport.getStartRowIndex(e.data.length,r);UpdateAllTableData.update(e,n,i)}static import(e,t,r){const n=new FileReader;n.readAsText(t),n.onload=t=>{var n;return CSVImport.processFile(e,null==(n=t.target)?void 0:n.result,r)}}}class SheetJSImport{static import(e,t,r){const n=new FileReader;n.readAsBinaryString(t),n.onload=t=>{var n;const i=r.read(null==(n=t.target)?void 0:n.result,{type:"binary"});i.SheetNames.forEach((t=>{const n=r.utils.sheet_to_csv(i.Sheets[t]);CSVImport.processFile(e,n)}))}}}const ACCEPTED_FILE_FORMATS=["csv","xls","xlsx","ods","txt"],DEFAULT_FILE_FORMATS=["csv"];class FileImportButtonEvents{static importFile(e,t,r,n){r.find((e=>t.name.endsWith(e)))&&(t.name.endsWith(".csv")?CSVImport.import(e,t,n):SheetJSInternalUtils.execFuncWithExtractorModule(SheetJSImport.import.bind(this,e,t)))}static inputChange(e,t,r){var n;const i=r.target,a=null==(n=i.files)?void 0:n[0];FileImportButtonEvents.importFile(e,a,ACCEPTED_FILE_FORMATS,t),i.value=""}static getAcceptedFormats(e){return null!=e&&e.formats&&e.formats.length>0?e.formats:DEFAULT_FILE_FORMATS}static triggerImportPrompt(e,t){const r=e._files.inputElementRef,n=FileImportButtonEvents.getAcceptedFormats(t);r.accept=n.map((e=>`.${e}`)).join(","),r.onchange=FileImportButtonEvents.inputChange.bind(this,e,null==t?void 0:t.overwriteOptions),r.click()}static setEvents(e,t,r){t.onclick=FileImportButtonEvents.triggerImportPrompt.bind(this,e,r)}}class DragAndDropEvents{static async uploadFile(e,t,r){var n,i,a;const s=null==(i=null==(n=r.dataTransfer)?void 0:n.files)?void 0:i[0],o="object"==typeof(null==(a=e.files)?void 0:a.dragAndDrop)?e.files.dragAndDrop.overwriteOptions:void 0;FileImportButtonEvents.importFile(e,s,t,o)}static toggleOverlayElement(e,t){e.style.display=t?"block":"none"}static getAcceptedFileFormats(e){var t;if("object"==typeof(null==e?void 0:e.dragAndDrop)&&e.dragAndDrop.formats)return e.dragAndDrop.formats;const r=null==(t=null==e?void 0:e.buttons)?void 0:t.filter((e=>e.import)).map((e=>"object"==typeof e.import&&e.import.formats?e.import.formats:DEFAULT_FILE_FORMATS)).flat(1);return r&&r.length>0?Array.from(new Set(r)):DEFAULT_FILE_FORMATS}static setEvents(e,t,r){const n=DragAndDropEvents.getAcceptedFileFormats(e.files);t.ondragenter=e=>{e.preventDefault(),DragAndDropEvents.toggleOverlayElement(r,!0)},r.ondragleave=e=>{e.preventDefault(),DragAndDropEvents.toggleOverlayElement(r,!1)},r.ondragover=e=>{e.preventDefault()},r.ondrop=t=>{t.preventDefault(),DragAndDropEvents.uploadFile(e,n,t),DragAndDropEvents.toggleOverlayElement(r,!1)}}}class DragAndDropElement{static createOverlayElement(e){const t=document.createElement("div");return t.id="drag-and-drop-overlay","object"==typeof e.dragAndDrop&&Object.assign(t.style,e.dragAndDrop.overlayStyle),t}static append(e,t){const r=DragAndDropElement.createOverlayElement(e.files);DragAndDropEvents.setEvents(e,t,r),t.appendChild(r)}static isEnabled(e){var t;return void 0!==(null==e?void 0:e.dragAndDrop)?!!e.dragAndDrop:!(null==(t=null==e?void 0:e.buttons)||!t.find((e=>e.import)))}}const _StickyPropsUtils=class e{static process(e){var t;"boolean"==typeof e.stickyHeader?e._stickyProps.header=e.stickyHeader:null!=(t=e.overflow)&&t.maxHeight&&(e._stickyProps.header=!0)}static moveTopBorderToHeaderCells(t){const{_tableElementRef:r,_tableBodyElementRef:n}=t;!r||!n||(n.classList.add(e.NO_OVERFLOW_STICKY_HEADER_BODY_CLASS),r.style.border&&(n.style.borderTop=r.style.border),r.style.borderColor&&(n.style.borderTopColor=r.style.borderColor),ElementStyle.moveStyles(r,n,"borderTop","borderTopColor","borderTopWidth","borderTopStyle"),r.style.borderTop="unset")}};_StickyPropsUtils.NO_OVERFLOW_STICKY_HEADER_BODY_CLASS="no-overflow-sticky-header-body";let StickyPropsUtils=_StickyPropsUtils;class ColumnSizerSetWidth{static getWidthDelta(e,t){return e<t.left?t.left:e>t.right?t.right:e}static getNewColumnWidth(e,t){const{moveLimits:r,mouseMoveOffset:n,initialOffset:i}=e,a=ColumnSizerSetWidth.getWidthDelta(n,r)-i;return Math.max(0,Number.parseFloat(t.style.width)+a)}static setColumnWidth(e,t){const r=ColumnSizerSetWidth.getNewColumnWidth(e,t);t.style.width=`${r}px`}static correctWidths(e,t,r,n){if(t.offsetWidth!==Math.round(Number.parseFloat(t.style.width))){const i=`${t.offsetWidth}px`,a=n-t.offsetWidth+"px";t.style.width=i,r.style.width=a,e.wasAutoresized=!0,setTimeout((()=>e.wasAutoresized=!1))}}static setWidths(e,t,r,n){const i=ColumnSizerSetWidth.getNewColumnWidth(e,t),a=Math.max(0,n-i);t.style.width=`${i}px`,r.style.width=`${a}px`}static setColumnsWidths(e,t,r){const n=Number.parseFloat(t.style.width),i=Number.parseFloat(r.style.width),a=n+i;ColumnSizerSetWidth.setWidths(e,t,r,a),i>n?ColumnSizerSetWidth.correctWidths(e,t,r,a):ColumnSizerSetWidth.correctWidths(e,r,t,a)}static set(e,t,r,n,i){i&&StaticTable.isStaticTableWidth(t,r)?ColumnSizerSetWidth.setColumnsWidths(e,n,i):ColumnSizerSetWidth.setColumnWidth(e,n),setTimeout((()=>e.fireColumnsUpdate()))}}class ColumnSizerExtrinsicEvents{static moveMovableElement(e,t,r){const{columnSizer:n}=ColumnSizerGenericUtils.getSizerDetailsViaElementId(e.id,t);n.movableElement.style.left=`${r}px`}static windowMouseMove(e,t){const{_activeOverlayElements:{selectedColumnSizer:r},_columnsDetails:n}=e;if(r){const{moveLimits:e,element:i}=r;r.mouseMoveOffset+=t,r.mouseMoveOffset>=e.left&&r.mouseMoveOffset<=e.right&&ColumnSizerExtrinsicEvents.moveMovableElement(i,n,r.mouseMoveOffset)}}static setWidth(e,t,r,n,i){ColumnSizerElement.unsetTransitionTime(e.element),ColumnSizerSetWidth.set(e,t,r,n,i)}static mouseUp(e){var t;const{_activeOverlayElements:r,_columnsDetails:n,_tableDimensions:i,_tableElementRef:a}=e,s=r.selectedColumnSizer,{columnSizer:o,headerCell:l,sizerNumber:c}=ColumnSizerGenericUtils.getSizerDetailsViaElementId(s.element.id,n);ColumnSizerExtrinsicEvents.setWidth(s,a,i,l,ColumnSizerGenericUtils.findNextResizableColumnHeader(n,c)),MovableColumnSizerElement.hide(o.movableElement),UpdateRowElement.updateHeaderRowHeight(null==(t=o.element.parentElement)?void 0:t.parentElement)}static setSizerStyleToHoverNoAnimation(e,t){const{width:r}=e.styles.hover;ColumnSizerElement.setHoverStyle(e,r,!1,t),ColumnSizerElement.unsetBackgroundImage(e.element)}static mouseUpNotOnSizer(e){const{element:t,styles:r,movableElement:n}=e;ColumnSizerExtrinsicEvents.setSizerStyleToHoverNoAnimation(e,n.style.backgroundColor),setTimeout((()=>{ColumnSizerElement.setTransitionTime(t),ColumnSizerElement.unsetElementsToDefault(t,r.default.width,!1),ColumnSizerElement.hideWhenCellNotHovered(e,!0)})),setTimeout((()=>{ColumnSizerElement.setBackgroundImage(t,r.default.backgroundImage),ColumnSizerElement.setBackgroundColor(t,SEMI_TRANSPARENT_COLOR)}),ColumnSizerElement.TRANSITION_TIME_ML)}static windowMouseUp(e){const{columnSizer:t}=ColumnSizerGenericUtils.getSizerDetailsViaElementId(e._activeOverlayElements.selectedColumnSizer.element.id,e._columnsDetails);ColumnSizerExtrinsicEvents.mouseUp(e),ColumnSizerExtrinsicEvents.mouseUpNotOnSizer(t),delete e._activeOverlayElements.selectedColumnSizer}static mouseUpOnSizer(e){ColumnSizerExtrinsicEvents.setSizerStyleToHoverNoAnimation(e),e.isMouseUpOnSizer=!0,setTimeout((()=>{e.isMouseUpOnSizer=!1,ColumnSizerElement.setTransitionTime(e.element)}))}static tableMouseUp(e,t){const r=e._activeOverlayElements.selectedColumnSizer,{columnSizer:n}=ColumnSizerGenericUtils.getSizerDetailsViaElementId(r.element.id,e._columnsDetails);ColumnSizerExtrinsicEvents.mouseUp(e),MovableColumnSizerElement.isMovableColumnSizer(t)&&!r.wasAutoresized?ColumnSizerExtrinsicEvents.mouseUpOnSizer(n):ColumnSizerExtrinsicEvents.mouseUpNotOnSizer(n),delete e._activeOverlayElements.selectedColumnSizer}}class TableEvents{static closeDatePicker(e,t){e.datePickerCell&&(e.datePickerCell!==CellElement.getCellElement(t)&&DateCellInputElement.toggle(e.datePickerCell,!1),delete e.datePickerCell)}static closeCellDropdown(e,t){const{_focusedElements:r}=e;r.cellDropdown&&!Dropdown.isPartOfDropdownElement(t)&&!t.classList.contains(OptionColorButton.COLOR_BUTTON_CLASS)&&r.cell.element!==CellElement.getCellElement(t)&&CellWithTextEvents.programmaticBlur(e)}static onMouseDown(e){const t=e.target;UserKeyEventsStateUtils.temporarilyIndicateEvent(this._userKeyEventsState,MOUSE_EVENT.DOWN),TableEvents.closeCellDropdown(this,t),TableEvents.closeDatePicker(this._activeOverlayElements,e.target)}static onMouseUp(e){this._activeOverlayElements.selectedColumnSizer&&ColumnSizerExtrinsicEvents.tableMouseUp(this,e.target)}}class TableElement{static changeStaticWidthTotal(e,t){e.staticWidth+=t}static setStaticWidthContentTotal(e){const{_frameComponents:{displayAddNewColumn:t,displayIndexColumn:r},_tableDimensions:n}=e;n.staticWidth=n.border.leftWidth+n.border.rightWidth,t&&(n.staticWidth+=AddNewColumnElement.DEFAULT_WIDTH),r&&(n.staticWidth+=IndexColumn.DEFAULT_WIDTH)}static addOverlayElements(e,t,r){var n;const i=FullTableOverlayElement.create(e);r.fullTableOverlay=i;const a=(null==(n=e._overflow)?void 0:n.overflowContainer)||t;a.appendChild(i),DragAndDropElement.isEnabled(e.files)&&DragAndDropElement.append(e,a);const s=ColumnDropdown.create(e);if(t.appendChild(s),r.columnDropdown=s,e.rowDropdown.displaySettings.isAvailable){const n=RowDropdown.create(e);t.appendChild(n),r.rowDropdown=n}}static addCells(e){MaximumColumns.canAddMore(e)&&(StaticTableWidthUtils.toggleWidthUsingMaxWidth(e,!0),e.data.map(((t,r)=>InsertNewRow.insert(e,r,!1,t))),e._pagination.asyncStartData&&PaginationAsyncStartData.populate(e,e._pagination.asyncStartData),StaticTableWidthUtils.toggleWidthUsingMaxWidth(e,!1))}static postProcessColumns(e){StaticTableWidthUtils.changeWidthsBasedOnColumnInsertRemove(e,!0),InitialDataProcessing.postProcess(e.data,e._columnsDetails),setTimeout((()=>{FireEvents.onColumnsUpdate(e),InsertRemoveColumnSizer.cleanUpCustomColumnSizers(e,e._columnsDetails.length-1)}))}static populateBody(e){var t;null==(t=e._tableBodyElementRef)||t.replaceChildren(),StaticTableWidthUtils.setTableWidth(e),TableElement.addCells(e),TableElement.postProcessColumns(e),FrameComponentsElements.addFrameBodyElements(e),e._frameComponents.displayIndexColumn&&UpdateIndexColumnWidth.update(e),ToggleAdditionElements.update(e,!0,AddNewColumnElement.toggle),CustomRowProperties.update(e)}static createTableBody(e){const t=document.createElement("tbody");return e&&t.classList.add("sticky-header-body"),t}static createTableElement(e){var t;const r=document.createElement("table");r.classList.add("table-controlled-width");const n=StringDimensionUtils.removeAllDimensions(JSON.parse(JSON.stringify(e.tableStyle)));return Object.assign(r.style,n),(t=r.style).fontFamily||(t.fontFamily="Inter, sans-serif, Avenir, Helvetica, Arial"),r.onmousedown=TableEvents.onMouseDown.bind(e),r.onmouseup=TableEvents.onMouseUp.bind(e),r}static createInfrastructureElements(e){return FrameComponentsColors.setEventColors(e),e._tableElementRef=TableElement.createTableElement(e),e._tableBodyElementRef=TableElement.createTableBody(e._stickyProps.header),e._addRowCellElementRef=AddNewRowElement.create(e),e._tableElementRef.appendChild(e._tableBodyElementRef),e._cellDropdownContainer=CellDropdown.createContainerElement(),e._tableElementRef.appendChild(e._cellDropdownContainer),!e.overflow&&e._stickyProps.header&&StickyPropsUtils.moveTopBorderToHeaderCells(e),e._tableDimensions.border=TableBorderDimensionsUtils.generateUsingElement(e._tableElementRef),e._tableElementRef}}const _OverflowUtils=class e{static isOverflowElement(t){return(null==t?void 0:t.id)===e.ID}static unsetBorderDimensions(e,t){t.number-=e.border.leftWidth+e.border.rightWidth,TableElement.changeStaticWidthTotal(e,-e.border.leftWidth),TableElement.changeStaticWidthTotal(e,-e.border.rightWidth),e.border.leftWidth=0,e.border.rightWidth=0,e.border.topWidth=0,e.border.bottomWidth=0}static processNumberDimension(t,r){e.unsetBorderDimensions(t,r),r.number-=e.SCROLLBAR_WIDTH}static moveBorderToOverflowContainer(e,t){ElementStyle.moveStyles(t,e,"borderRight","borderLeft","borderTop","borderBottom","borderRadius","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"),t.style.border="unset"}static adjustStyleForScrollbarWidth(t){(Browser.IS_SAFARI||Browser.IS_FIREFOX)&&t.maxHeight&&!t.maxWidth&&(t.overflowContainer.style.paddingRight=`${e.SCROLLBAR_WIDTH}px`)}static setDimensions(e,{width:t,height:r}){t&&(e.style.overflowX="auto",e.style.maxWidth=`${t}px`),r&&(e.style.overflowY="auto",e.style.maxHeight=`${r}px`)}static getDimensions(e,t){const r=StringDimensionUtils.generateNumberDimensionFromClientString(e.parentElement,t,"maxWidth",!0);r.number-=e._tableDimensions.border.leftWidth+e._tableDimensions.border.rightWidth,r.isPercentage&&(t.isWidthPercentage=!0);const n=StringDimensionUtils.generateNumberDimensionFromClientString(e.parentElement,t,"maxHeight",!1);return n.number-=e._tableDimensions.border.topWidth+e._tableDimensions.border.bottomWidth,n.isPercentage&&(t.isHeightPercentage=!0),{width:r.number,height:n.number}}static applyDimensions(t){const{_overflow:r}=t;if(!r)return;const n=e.getDimensions(t,r);e.setDimensions(r.overflowContainer,n),e.adjustStyleForScrollbarWidth(r)}static setupContainer(t,r){const n=document.createElement("div");t._overflow={overflowContainer:n,...t.overflow},n.id=e.ID,e.moveBorderToOverflowContainer(n,r),n.appendChild(r)}};_OverflowUtils.ID="overflow-container",_OverflowUtils.SCROLLBAR_WIDTH=15;let OverflowUtils=_OverflowUtils;class ElementVisibility{static getDetailsInWindow(e,t,r=!0){const{topWidth:n,leftWidth:i}=r?t:{topWidth:0,leftWidth:0},a=e.getBoundingClientRect(),s=(Browser.IS_CHROMIUM?a.top-n:a.top)+window.scrollY,o=(Browser.IS_CHROMIUM?a.left-i:a.left)+window.scrollX,l=e.offsetWidth,c=e.offsetHeight,d=document.body,u=new Set;s<window.pageYOffset&&u.add(SIDE.TOP);const p=d.clientWidth<d.scrollWidth?OverflowUtils.SCROLLBAR_WIDTH:0;s+c+n>window.pageYOffset+window.innerHeight-p&&u.add(SIDE.BOTTOM),o<window.pageXOffset&&u.add(SIDE.LEFT);const h=d.clientHeight<d.scrollHeight?OverflowUtils.SCROLLBAR_WIDTH:0;return o+l+i>window.pageXOffset+window.innerWidth-h&&u.add(SIDE.RIGHT),u.size>0?{isFullyVisible:!1,blockingSides:u}:{isFullyVisible:!0}}static isVerticallyVisibleInsideParent(e,t){const r=e.parentElement||t,n=r.scrollTop,i=n+r.clientHeight,a=e.offsetTop,s=a+e.clientHeight;return a<n?{isFullyVisible:!1,blockingSides:new Set([SIDE.TOP])}:s>i?{isFullyVisible:!1,blockingSides:new Set([SIDE.BOTTOM])}:{isFullyVisible:!0}}}class OuterDropdownEvents{static windowOnMouseDown(e){e._activeOverlayElements.outerContainerDropdown&&e._activeOverlayElements.outerContainerDropdown.hide()}static focusSiblingItem(e,t,r){const n=null==t?void 0:t[r];if(n)DropdownItemNavigation.focusSiblingItem(n,e,!0,!0);else if("nextSibling"===r){const t=e.children[0];t&&DropdownItemNavigation.focusSiblingItem(t,e,!0,!0)}else{const t=e.children[e.children.length-1];t&&DropdownItemNavigation.focusSiblingItem(t,e,!1,!0)}}static windowOnKeyDownNavigation(e,t){const r=e.getElementsByClassName(DropdownItem.ACTIVE_ITEM_CLASS)[0];t===KEYBOARD_KEY.TAB||t===KEYBOARD_KEY.ARROW_DOWN?r?OuterDropdownEvents.focusSiblingItem(e,r,"nextSibling"):DropdownItemNavigation.focusSiblingItem(e.children[0],e,!0,!0):t===KEYBOARD_KEY.ARROW_UP&&(r?OuterDropdownEvents.focusSiblingItem(e,r,"previousSibling"):DropdownItemNavigation.focusSiblingItem(e.children[e.children.length-1],e,!1,!0))}static windowOnKeyDown(e,t){const{shadowRoot:r,_activeOverlayElements:{outerContainerDropdown:n}}=e;if(!n)return;t.preventDefault();const{element:i,hide:a}=n;t.key===KEYBOARD_KEY.ENTER||t.key===KEYBOARD_KEY.ESCAPE?a():null!=r&&r.activeElement||OuterDropdownEvents.windowOnKeyDownNavigation(i,t.key)}static dropdownOnKeyDown(e,t){t.preventDefault(),t.key===KEYBOARD_KEY.ENTER?t.target.dispatchEvent(new MouseEvent("mousedown")):t.key===KEYBOARD_KEY.ESCAPE&&e.hide(),DropdownEvents.itemKeyNavigation(this.shadowRoot,e.element,t)}static set(e,t){t.element.onkeydown=OuterDropdownEvents.dropdownOnKeyDown.bind(e,t)}}const _OuterDropdownElement=class e{static hide(e,t){const r=e.outerContainerDropdown;r&&(Dropdown.hide(r.element),r.button.classList.contains(ToggleableElement.AUTO_STYLING_CLASS)&&ToggleableElement.unsetActive(r.button,t),delete e.outerContainerDropdown,DropdownItemHighlightUtils.fadeCurrentlyHighlighted(e))}static display(e,t){t.button.classList.contains(ToggleableElement.AUTO_STYLING_CLASS)&&ToggleableElement.setActive(t.button,t.activeButtonStyle),Dropdown.display(t.element),e._activeOverlayElements.outerContainerDropdown=t}static displayReactToBottomVisibility(t,r){r.element.classList.remove(e.DROPUP_CLASS),e.display(t,r);const n=ElementVisibility.getDetailsInWindow(r.element,t._tableDimensions.border,!1);!n.isFullyVisible&&n.blockingSides.has(SIDE.BOTTOM)&&r.element.classList.add(e.DROPUP_CLASS)}static setOrientation(e,t){t.endsWith("right")&&(e.style.right="0px")}static createElement(e){const t=Dropdown.createBase();return t.style.width="",t.classList.add("outer-container-dropdown"),e&&t.classList.add(...e),t}static create(t,r,n,i,a,s,o){const l=e.createElement(a),c={element:l,hide:s,button:r,activeButtonStyle:i};return e.setOrientation(l,n),OuterDropdownButtonEvents.set(t,r,n,c,o),OuterDropdownEvents.set(t,c),c}};_OuterDropdownElement.DROPUP_CLASS="active-table-dropup";let OuterDropdownElement=_OuterDropdownElement;class OuterDropdownSimpleUtils{static hide(e,t){var r;OuterDropdownElement.hide(e,{});const n=null==(r=e.outerContainerDropdown)?void 0:r.element;if(n){const e=t||Array.from(n.children);OuterDropdownItem.unsetHoverColors(e)}}static getDropdownTopPosition(e){return`${e.offsetTop+e.offsetHeight}px`}static display(e,t,r){const{element:n}=r;n.style.bottom="",n.style.top=OuterDropdownSimpleUtils.getDropdownTopPosition(e),OuterDropdownElement.displayReactToBottomVisibility(t,r)}}class RowsPerPageDropdownItemUtil{static updateRowsAndPaginationComponents(e,t,r){RowsPerPageSelectButtonElement.updateButtonText(t,r),PageButtonContainerElement.shouldButtonsBeActive(e)&&(PageButtonContainerElement.repopulateButtons(e),PaginationUtils.getAndApplyDataOnButtonClick(e,1,r))}static getNewRowsPerPage(e,t){const{_pagination:r,data:n,dataStartsAtHeader:i}=e;return r.isAllRowsOptionSelected?i?n.length:n.length-1:Number(t)}static setNewRowsPerPage(e,t,r){e._pagination.isAllRowsOptionSelected=r.toLocaleLowerCase()===RowsPerPageDropdownItem.ALL_ITEM_TEXT,e._pagination.rowsPerPage=RowsPerPageDropdownItemUtil.getNewRowsPerPage(e,r),RowsPerPageDropdownItemUtil.updateRowsAndPaginationComponents(e,t,r)}}class RowsPerPageDropdownItemEvents{static action(e,t,r,n){e.rowsPerPage!==Number(n)&&RowsPerPageDropdownItemUtil.setNewRowsPerPage(r,t,n)}static setEvents(e,t,r){const n=RowsPerPageDropdownItemEvents.action.bind(this,e._pagination,r),i=OuterDropdownSimpleUtils.hide;t.onmousedown=OuterDropdownItemEvents.itemMouseDownCommon.bind(e,n,i)}}const _RowsPerPageDropdownItem=class e{static populate(t,r,n){t._pagination.rowsPerPageOptionsItemText.forEach((i=>{const a={text:String(i)},s=DropdownItem.addButtonItem(t,r,a,e.ITEM_CLASS);RowsPerPageDropdownItemEvents.setEvents(t,s,n)}));const i=String(t._pagination.rowsPerPage);OuterDropdownItem.setActive(Array.from(r.children),i)}};_RowsPerPageDropdownItem.ITEM_CLASS="number-of-rows-dropdown-item",_RowsPerPageDropdownItem.ALL_ITEM_TEXT="all";let RowsPerPageDropdownItem=_RowsPerPageDropdownItem;const _PaginationInternalUtils=class e{static getTotalNumberOfRows(e){const{data:t,_visiblityInternal:r,_tableBodyElementRef:n}=e;return null!=r&&r.filters?FilterInternalUtils.extractUnfilteredRows(n,t.length).length:t.length}static insertNewRowsPerPageOption(e,t){let r=t.findIndex((t=>{const r=Number.parseInt(t);return isNaN(r)||e<r}));-1===r&&(r=0),t.splice(r,0,String(e))}static setFirstOptionAsRowsPerPage(t){const{_pagination:r,dataStartsAtHeader:n}=t,i=r.rowsPerPageOptionsItemText[0];if(i.toLocaleLowerCase()===RowsPerPageDropdownItem.ALL_ITEM_TEXT){r.isAllRowsOptionSelected=!0;const i=e.getTotalNumberOfRows(t);r.rowsPerPage=n?i:i-1}else r.rowsPerPage=Number(i)}static processRowsPerPage(t,r){const{rowsPerPageSelect:n}=r;if(t._pagination.rowsPerPage=Number.parseInt(String(t._pagination.rowsPerPage)),n||void 0===n){const{rowsPerPageOptionsItemText:r,rowsPerPage:n}=t._pagination;if(!r.find((e=>e===String(n)))){const i=Number.parseInt(String(n));isNaN(i)?e.setFirstOptionAsRowsPerPage(t):e.insertNewRowsPerPageOption(i,r)}}}static processOptionsItemText(e){const t=Number(e);return!isNaN(t)&&t<1?"2":String(e)}static changeOptionNumberToEven(e){return e.map((e=>{const t=Number(e);return Number.isNaN(t)?e:t%2==1?t+1:t}))}static setRowsPerPageOptionsText(t){const r=t.pagination,{rowsPerPageSelect:n}=r;if(n||void 0===n){const r=t._pagination.rowsPerPageSelect.options;let i=void 0!==n&&!0!==n&&n.options&&0!==n.options.length?n.options:r;t.stripedRows&&(i=e.changeOptionNumberToEven(i)),t._pagination.rowsPerPageOptionsItemText=i.map((t=>e.processOptionsItemText(t)))}}static processRowsPerPageOptions(t){const r=t.pagination,{rowsPerPageSelect:n}=r;void 0!==n&&"boolean"!=typeof n&&n.prefixText&&(t._pagination.rowsPerPageSelect.prefixText=n.prefixText),e.setRowsPerPageOptionsText(t),delete r.rowsPerPageSelect}static setDefaultBackgroundColors(e,t){var r,n,i;const{def:a,hover:s,click:o}=t;(r=e.click).backgroundColor??(r.backgroundColor=e.hover.backgroundColor||e.default.backgroundColor||o),(n=e.hover).backgroundColor??(n.backgroundColor=e.default.backgroundColor||s),(i=e.default).backgroundColor??(i.backgroundColor=a),["click","hover","default"].forEach((t=>{void 0===e[t].backgroundColor&&delete e[t].backgroundColor}))}static setStatefulCSS(e,t){var r,n,i;e[t]??(e[t]={}),(r=e[t]).click??(r.click=JSON.parse(JSON.stringify(e[t].hover||e[t].default||{}))),(n=e[t]).hover??(n.hover=JSON.parse(JSON.stringify(e[t].default||{}))),(i=e[t]).default??(i.default={})}static setRowsPerPageOptionsStyle(t){var r;e.setStatefulCSS(t.rowsPerPageSelect,"button"),e.setDefaultBackgroundColors(null==(r=t.rowsPerPageSelect)?void 0:r.button,{def:"",hover:"#f5f5f5",click:"#f5f5f5"})}static mergeButtonsStyleWithActiveStyle(e){const{buttons:t,actionButtons:r,activeButton:n}=e,i=JSON.parse(JSON.stringify(t));return i.default.backgroundColor="#e8e8e8",i.hover.backgroundColor="#d6d6d6",i.click.backgroundColor="#c8c8c8",n&&(Object.assign(i.default,n.default),i.hover=n.hover,i.click=n.click),i}static mergeButtonsStylesWithActionStyles(e){e.actionButtons??(e.actionButtons={});const{buttons:t,actionButtons:r}=e,n=JSON.parse(JSON.stringify(t));return Object.assign(n.default,r.default),Object.assign(n.hover,r.hover),Object.assign(n.click,r.click),n.previousText=r.previousText,n.nextText=r.nextText,n.firstText=r.firstText,n.lastText=r.lastText,n}static processPageButtonStyles(t){var r,n,i,a;(r=t.styles).pageButtons??(r.pageButtons={});const s=t.styles.pageButtons;e.setStatefulCSS(s,"buttons"),e.setDefaultBackgroundColors(t.styles.pageButtons.buttons,{def:"white",hover:"#f5f5f5",click:"#c8c8c8"}),e.setStatefulCSS(s,"actionButtons"),e.setDefaultBackgroundColors(t.styles.pageButtons.actionButtons,{});const o=e.mergeButtonsStylesWithActionStyles(s);t.styles.pageButtons.actionButtons=o;const l=e.mergeButtonsStyleWithActiveStyle(s);t.styles.pageButtons.activeButton=l,(n=t.styles.pageButtons).disabledButtons??(n.disabledButtons={backgroundColor:"#f9f9f9",color:"#9d9d9d",stroke:"#9d9d9d"}),(i=t.styles.pageButtons).firstVisibleButtonOverride??(i.firstVisibleButtonOverride={borderLeft:"1px solid #0000004d",borderTopLeftRadius:"2px",borderBottomLeftRadius:"2px"}),(a=t.styles.pageButtons).lastVisibleButtonOverride??(a.lastVisibleButtonOverride={borderRight:"1px solid #0000004d",borderTopRightRadius:"2px",borderBottomRightRadius:"2px"}),t.styles.pageButtons.activeButtonClass=t.styles.pageButtons.activeButtonPrecedence?PageButtonElement.PRECEDENCE_ACTIVE_PAGINATION_BUTTON_CLASS:PageButtonElement.ACTIVE_PAGINATION_BUTTON_CLASS}static processStyle(t,r){var n,i;t.styles&&Object.assign(r.styles,t.styles),e.processPageButtonStyles(r),!1!==t.rowsPerPageSelect&&((n=r.styles).rowsPerPageSelect??(n.rowsPerPageSelect={}),e.setRowsPerPageOptionsStyle(r.styles)),(i=r.styles).numberOfVisibleRows??(i.numberOfVisibleRows={}),delete t.styles}static processPositions(t){Object.keys(t).forEach((r=>{const n=t[r];e.POSITIONS.has(n.position)||(n.position=e.DEFAULT_POSITION)}))}static processPosition(t,r){t.positions&&Object.assign(r.positions,t.positions),e.processPositions(r.positions),delete t.positions}static async process(t){const{_pagination:r,_activeOverlayElements:n}=t;if(!t.pagination)return;const i="boolean"==typeof t.pagination?{}:t.pagination;i.async&&(LoadingElement.addInitial(t),n.error=ErrorElement.create(),r.asyncStartData=await PaginationAsyncStartData.get(t,i,r)),void 0!==i.maxNumberOfVisiblePageButtons&&i.maxNumberOfVisiblePageButtons<1&&(i.maxNumberOfVisiblePageButtons=1),e.processPosition(i,r),e.processStyle(i,r),!1!==i.rowsPerPageSelect&&e.processRowsPerPageOptions(t),Object.assign(r,i),!1!==i.displayNumberOfVisibleRows&&e.processRowsPerPage(t,i)}static getDefault(){return{rowsPerPage:10,rowsPerPageSelect:{options:[10,25,50,"All"],prefixText:"Rows per page:"},maxNumberOfVisiblePageButtons:8,displayPrevNext:!0,displayFirstLast:!0,displayNumberOfVisibleRows:!0,styles:{},visibleEdgeButtons:[],numberOfActionButtons:0,dropdownWidth:24,positions:{pageButtons:{position:e.DEFAULT_POSITION,order:3},numberOfVisibleRows:{position:e.DEFAULT_POSITION,order:2},rowsPerPageSelect:{position:e.DEFAULT_POSITION,order:1}},visibleRows:[],activePageNumber:1,isAllRowsOptionSelected:!1}}};_PaginationInternalUtils.DEFAULT_POSITION="bottom-right",_PaginationInternalUtils.POSITIONS=new Set(["top-left","top-center","top-right","bottom-left","bottom-center",_PaginationInternalUtils.DEFAULT_POSITION]);let PaginationInternalUtils=_PaginationInternalUtils;class ActiveOverlayElementsUtils{static createNew(){return{}}}class ProgrammaticStructureUpdate{static processData(e,t){if(t)return e>t.length?t.concat(DataUtils.createEmptyStringDataArray(e-t.length)):e<t.length?t.slice(0,e):t}static processIndex(e,t,r){return e=(e=e>-1?e:r)>r?r:e,t||e!==r?e:r-1}static updateColumn(e,t,r,n){var i;r=ProgrammaticStructureUpdate.processIndex(r,t,(null==(i=e.data[0])?void 0:i.length)||0),0===e.data.length?n&&UpdateAllTableData.update(e,n.map((e=>[e])),0,!0):t?(n=ProgrammaticStructureUpdate.processData(e.data.length||0,n),InsertNewColumn.insert(e,r,n)):e.data.length>0&&RemoveColumn.remove(e,r)}static updatePaginationAsync(e,t){setTimeout((()=>{var r;if(e._pagination){const n=null==(r=e._pagination)?void 0:r.activePageNumber;t!==n?PaginationUtils.displayRowsForDifferentButton(e,t):1!==t&&(PaginationUtils.displayRowsForDifferentButton(e,1),PaginationUtils.displayRowsForDifferentButton(e,t))}}))}static updateRow(e,t,r,n){var i,a;if(r=ProgrammaticStructureUpdate.processIndex(r,t,e.data.length),0===e.data.length)n&&UpdateAllTableData.update(e,[n],0,!0);else if(t){const t=null==(i=e._pagination)?void 0:i.activePageNumber;n=ProgrammaticStructureUpdate.processData((null==(a=e.data[0])?void 0:a.length)||0,n),InsertNewRow.insert(e,r,!0,n),setTimeout((()=>ProgrammaticStructureUpdate.updatePaginationAsync(e,t)))}else RemoveRow.remove(e,r)}static update(e,t){const{structure:r,isInsert:n,index:i,data:a}=t;"boolean"!=typeof n||"number"!=typeof i||("row"===r?ProgrammaticStructureUpdate.updateRow(e,n,i,a):"column"===r&&ProgrammaticStructureUpdate.updateColumn(e,n,i,a))}}class FrameComponentsInternalUtils{static set(e){const{frameComponentsStyles:t,_frameComponents:r}=e;r.displayAddNewColumn=e.displayAddNewColumn,r.displayAddNewRow=e.displayAddNewRow,r.displayIndexColumn=e.displayIndexColumn,r.styles=t.styles,r.inheritHeaderColors=t.inheritHeaderColors??!0}static getDefault(){return{displayAddNewColumn:!0,displayAddNewRow:!0,displayIndexColumn:!0,cellColors:FrameComponentsColors.getDefaultCellColors()}}}class RowDropdownSettingsUtil{static postprocessOpenMethod(e,t){var r,n;!t.displayIndexColumn&&null!=(r=e.displaySettings.openMethod)&&r.cellClick&&(null==(n=e.displaySettings.openMethod)||delete n.cellClick,e.displaySettings.openMethod.overlayClick=!0)}static preprocessOpenMethod(e,t){t&&(void 0===e.displaySettings.openMethod||0===Object.keys(e.displaySettings.openMethod).length)&&t.openMethod&&(e.displaySettings.openMethod=JSON.parse(JSON.stringify(t.openMethod)))}static process(e){var t;const{rowDropdown:r,_frameComponents:n,_defaultColumnsSettings:i}=e;r.isInsertUpAvailable??(r.isInsertUpAvailable=!0),r.isInsertDownAvailable??(r.isInsertDownAvailable=!0),r.isMoveAvailable??(r.isMoveAvailable=!0),r.canEditHeaderRow??(r.canEditHeaderRow=!0),r.isDeleteAvailable??(r.isDeleteAvailable=!0),r.displaySettings??(r.displaySettings={}),RowDropdownSettingsUtil.preprocessOpenMethod(r,null==(t=i.columnDropdown)?void 0:t.displaySettings),DropdownDisplaySettingsUtil.process(r.displaySettings),RowDropdownSettingsUtil.postprocessOpenMethod(r,n)}}class ProgrammaticCellUpdate{static updateText(e,t){var r;const{newText:n,rowIndex:i,columnIndex:a}=t;if(!ObjectUtils.areValuesFullyDefined(n,i,a)||"string"!=typeof n&&"number"!=typeof n)return;const s=null==(r=e._columnsDetails[a])?void 0:r.elements[i];!s||n===CellElement.getText(s)||(CellEvents.updateCell(e,n,i,a,{element:s,processText:i>0}),ColumnTypesUtils.updateDataElements(e,i,a,s),0===i&&(Dropdown.isDisplayed(e._activeOverlayElements.columnDropdown)&&ColumnDropdown.processTextAndHide(e),HeaderText.onAttemptChange(e,s,a)))}}class SheetJSExport{static getFileName(e,t){return t?t.endsWith(`.${e}`)?t:`${t}.${e}`:`table_data.${e}`}static export(e,t,r,n){const i=n.utils.book_new(),a=n.utils.aoa_to_sheet(e.data);n.utils.book_append_sheet(i,a,"Sheet");const s=SheetJSExport.getFileName(t,r);n.writeFile(i,s,{bookType:t})}}class CSVExport{static export(e,t){const r="data:text/csv;charset=utf-8,"+e.data.map((e=>e.join(","))).join("\n"),n=encodeURI(r),i=document.createElement("a");i.setAttribute("href",n),i.setAttribute("download",t||"table_data.csv"),document.body.appendChild(i),i.click()}}class FileExportEvents{static export(e,t){const r=(null==t?void 0:t.format)||"csv";if(ACCEPTED_FILE_FORMATS.find((e=>r===e))){const n=null==t?void 0:t.fileName;"csv"===r?CSVExport.export(e,n):SheetJSInternalUtils.execFuncWithExtractorModule(SheetJSExport.export.bind(this,e,r,n))}}static setEvents(e,t,r){var n;const i=r?{format:null==(n=r.formats)?void 0:n[0],fileName:r.fileName}:void 0;t.onclick=FileExportEvents.export.bind(this,e,i)}}class FileExportDropdownItemEvents{static action(e,t){const r=t.toLowerCase();FileExportEvents.export(e,{format:r})}static setEvents(e,t){const r=FileExportDropdownItemEvents.action,n=OuterDropdownSimpleUtils.hide;t.onmousedown=OuterDropdownItemEvents.itemMouseDownCommon.bind(e,r,n)}}const _FileExportDropdownItem=class e{static populate(t,r,n){n.forEach((n=>{const i={text:n.toUpperCase()},a=DropdownItem.addButtonItem(t,r,i,e.ITEM_CLASS,StaticDropdown.ITEM_CLASS);FileExportDropdownItemEvents.setEvents(t,a)}))}};_FileExportDropdownItem.ITEM_CLASS="export-formats-dropdown-item";let FileExportDropdownItem=_FileExportDropdownItem;class FileExportDropdown{static create(e,t,r){const n=OuterDropdownSimpleUtils.hide.bind(this,e._activeOverlayElements),i=OuterDropdownSimpleUtils.display.bind(this,t),a=OuterDropdownElement.create(e,t,"bottom-right",{},[],n,i);return a.element.classList.add(StaticDropdown.DROPDOWN_CLASS),FileExportDropdownItem.populate(e,a.element,r),a}}const _FileExportButtonElement=class e{static createButtonArrow(t,r){const n=OuterDropdownButtonUtils.createArrow([e.ARROW_CONTAINER_CLASS],[e.ARROW_ICON_CLASS]),i="object"==typeof r&&r.formats&&r.buttonArrowStyles;return i&&(OuterDropdownButtonUtils.processAndApplyDefaultStyle(n,i),setTimeout((()=>StatefulCSSEvents.setEvents(t,i,void 0,n)))),n}static getDropdownFormats(t){if("object"==typeof t&&t.formats){const{formats:r}=t,n=r.filter((t=>e.VALID_FORMATS[t.toLocaleLowerCase()]));if(n.length>1)return n}}static applyDropdown(t,r,n,i,a){const s=FileExportDropdown.create(t,r,i);n.appendChild(s.element),r.appendChild(e.createButtonArrow(r,a))}};_FileExportButtonElement.ARROW_CONTAINER_CLASS="file-button-arrow-container",_FileExportButtonElement.ARROW_ICON_CLASS="file-button-arrow-container-icon",_FileExportButtonElement.VALID_FORMATS=["csv","xls","xlsx","ods","txt"].reduce(((e,t)=>(e[t]=!0,e)),{});let FileExportButtonElement=_FileExportButtonElement;const _FileButtonElements=class e{static setEvents(e,t,r){t.import?FileImportButtonEvents.setEvents(e,r,"object"==typeof t.import?t.import:void 0):t.export&&FileExportEvents.setEvents(e,r,"object"==typeof t.export?t.export:void 0)}static wrapInRelativeContainer(t){const r=document.createElement("div");return r.classList.add(e.BUTTON_CONTAINER_CLASS),r.appendChild(t),r}static createElement(t,r){const{text:n,order:i,styles:a}=t,s=document.createElement("div");s.classList.add(e.BUTTON_CLASS),s.textContent=n||r,s.style.order=String(i||0);const o=FilesUtils.processStyles(a);return Object.assign(s.style,o.default),setTimeout((()=>StatefulCSSEvents.setEvents(s,o))),s}static create(t,r){var n,i;null==(i=null==(n=t.files)?void 0:n.buttons)||i.forEach((n=>{if(!n.export&&!n.import)return;const i=e.createElement(n,n.import?"Import":"Export"),a=e.wrapInRelativeContainer(i),s=n.export&&FileExportButtonElement.getDropdownFormats(n.export);s?FileExportButtonElement.applyDropdown(t,i,a,s,n.export):setTimeout((()=>e.setEvents(t,n,i)));const o=n.position||FilesUtils.DEFAULT_BUTTON_POSITION;OuterContainerElements.addToContainer(o,r,a)}))}};_FileButtonElements.BUTTON_CLASS="file-button",_FileButtonElements.BUTTON_CONTAINER_CLASS="file-button-container";let FileButtonElements=_FileButtonElements;class OuterTableComponents{static create(e){const t=OuterContainerElements.create(e);e.pagination&&PaginationElements.create(e,t),e.files&&FileButtonElements.create(e,t),e.filter&&FilterElements.create(e,t)}}class WebComponentStyleUtils{static add(e,t){if(t&&e)try{WebComponentStyleUtils.addStyleSheet(e,t)}catch{WebComponentStyleUtils.addStyleElement(e,t)}}static addStyleSheet(e,t){const r=new CSSStyleSheet;r.replaceSync(e),t.adoptedStyleSheets.push(r)}static addStyleElement(e,t){const r=document.createElement("style");r.innerHTML=e,t.appendChild(r)}}class FocusedElementsUtils{static createEmpty(){return{cell:FocusedCellUtils.createEmpty()}}}const t$2=e=>(t,r)=>{void 0!==r?r.addInitializer((()=>{customElements.define(e,t)})):customElements.define(e,t)},t$1=globalThis,e$2=t$1.ShadowRoot&&(void 0===t$1.ShadyCSS||t$1.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s$2=Symbol(),o$3=new WeakMap;let n$3=class{constructor(e,t,r){if(this._$cssResult$=!0,r!==s$2)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(e$2&&void 0===e){const r=void 0!==t&&1===t.length;r&&(e=o$3.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&o$3.set(t,e))}return e}toString(){return this.cssText}};const r$5=e=>new n$3("string"==typeof e?e:e+"",void 0,s$2),i$2=(e,...t)=>{const r=1===e.length?e[0]:t.reduce(((t,r,n)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(r)+e[n+1]),e[0]);return new n$3(r,e,s$2)},S$1=(e,t)=>{if(e$2)e.adoptedStyleSheets=t.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet));else for(const r of t){const t=document.createElement("style"),n=t$1.litNonce;void 0!==n&&t.setAttribute("nonce",n),t.textContent=r.cssText,e.appendChild(t)}},c$2=e$2?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const r of e.cssRules)t+=r.cssText;return r$5(t)})(e):e,{is:i$1,defineProperty:e$1,getOwnPropertyDescriptor:r$4,getOwnPropertyNames:h$1,getOwnPropertySymbols:o$2,getPrototypeOf:n$2}=Object,a$1=globalThis,c$1=a$1.trustedTypes,l$1=c$1?c$1.emptyScript:"",p$1=a$1.reactiveElementPolyfillSupport,d$1=(e,t)=>e,u$1={toAttribute(e,t){switch(t){case Boolean:e=e?l$1:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let r=e;switch(t){case Boolean:r=null!==e;break;case Number:r=null===e?null:Number(e);break;case Object:case Array:try{r=JSON.parse(e)}catch{r=null}}return r}},f$1=(e,t)=>!i$1(e,t),y={attribute:!0,type:String,converter:u$1,reflect:!1,hasChanged:f$1};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),a$1.litPropertyMetadata??(a$1.litPropertyMetadata=new WeakMap);class b extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=y){if(t.state&&(t.attribute=!1),this._$Ei(),this.elementProperties.set(e,t),!t.noAccessor){const r=Symbol(),n=this.getPropertyDescriptor(e,r,t);void 0!==n&&e$1(this.prototype,e,n)}}static getPropertyDescriptor(e,t,r){const{get:n,set:i}=r$4(this.prototype,e)??{get(){return this[t]},set(e){this[t]=e}};return{get(){return null==n?void 0:n.call(this)},set(t){const a=null==n?void 0:n.call(this);i.call(this,t),this.requestUpdate(e,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??y}static _$Ei(){if(this.hasOwnProperty(d$1("elementProperties")))return;const e=n$2(this);e.finalize(),void 0!==e.l&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(d$1("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(d$1("properties"))){const e=this.properties,t=[...h$1(e),...o$2(e)];for(const r of t)this.createProperty(r,e[r])}const e=this[Symbol.metadata];if(null!==e){const t=litPropertyMetadata.get(e);if(void 0!==t)for(const[e,r]of t)this.elementProperties.set(e,r)}this._$Eh=new Map;for(const[e,t]of this.elementProperties){const r=this._$Eu(e,t);void 0!==r&&this._$Eh.set(r,e)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const e of r)t.unshift(c$2(e))}else void 0!==e&&t.push(c$2(e));return t}static _$Eu(e,t){const r=t.attribute;return!1===r?void 0:"string"==typeof r?r:"string"==typeof e?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$E_(),this.requestUpdate(),null==(e=this.constructor.l)||e.forEach((e=>e(this)))}addController(e){var t;(this._$EO??(this._$EO=new Set)).add(e),void 0!==this.renderRoot&&this.isConnected&&(null==(t=e.hostConnected)||t.call(e))}removeController(e){var t;null==(t=this._$EO)||t.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const r of t.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return S$1(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null==(e=this._$EO)||e.forEach((e=>{var t;return null==(t=e.hostConnected)?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null==(e=this._$EO)||e.forEach((e=>{var t;return null==(t=e.hostDisconnected)?void 0:t.call(e)}))}attributeChangedCallback(e,t,r){this._$AK(e,r)}_$EC(e,t){var r;const n=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,n);if(void 0!==i&&!0===n.reflect){const a=(void 0!==(null==(r=n.converter)?void 0:r.toAttribute)?n.converter:u$1).toAttribute(t,n.type);this._$Em=e,null==a?this.removeAttribute(i):this.setAttribute(i,a),this._$Em=null}}_$AK(e,t){var r;const n=this.constructor,i=n._$Eh.get(e);if(void 0!==i&&this._$Em!==i){const e=n.getPropertyOptions(i),a="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null==(r=e.converter)?void 0:r.fromAttribute)?e.converter:u$1;this._$Em=i,this[i]=a.fromAttribute(t,e.type),this._$Em=null}}requestUpdate(e,t,r){if(void 0!==e){if(r??(r=this.constructor.getPropertyOptions(e)),!(r.hasChanged??f$1)(this[e],t))return;this.P(e,t,r)}!1===this.isUpdatePending&&(this._$ES=this._$ET())}P(e,t,r){this._$AL.has(e)||this._$AL.set(e,t),!0===r.reflect&&this._$Em!==e&&(this._$Ej??(this._$Ej=new Set)).add(e)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[e,t]of this._$Ep)this[e]=t;this._$Ep=void 0}const e=this.constructor.elementProperties;if(e.size>0)for(const[t,r]of e)!0!==r.wrapped||this._$AL.has(t)||void 0===this[t]||this.P(t,this[t],r)}let t=!1;const r=this._$AL;try{t=this.shouldUpdate(r),t?(this.willUpdate(r),null==(e=this._$EO)||e.forEach((e=>{var t;return null==(t=e.hostUpdate)?void 0:t.call(e)})),this.update(r)):this._$EU()}catch(e){throw t=!1,this._$EU(),e}t&&this._$AE(r)}willUpdate(e){}_$AE(e){var t;null==(t=this._$EO)||t.forEach((e=>{var t;return null==(t=e.hostUpdated)?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Ej&&(this._$Ej=this._$Ej.forEach((e=>this._$EC(e,this[e])))),this._$EU()}updated(e){}firstUpdated(e){}}b.elementStyles=[],b.shadowRootOptions={mode:"open"},b[d$1("elementProperties")]=new Map,b[d$1("finalized")]=new Map,null==p$1||p$1({ReactiveElement:b}),(a$1.reactiveElementVersions??(a$1.reactiveElementVersions=[])).push("2.0.4");const o$1={attribute:!0,type:String,converter:u$1,reflect:!1,hasChanged:f$1},r$3=(e=o$1,t,r)=>{const{kind:n,metadata:i}=r;let a=globalThis.litPropertyMetadata.get(i);if(void 0===a&&globalThis.litPropertyMetadata.set(i,a=new Map),a.set(r.name,e),"accessor"===n){const{name:n}=r;return{set(r){const i=t.get.call(this);t.set.call(this,r),this.requestUpdate(n,i,e)},init(t){return void 0!==t&&this.P(n,void 0,e),t}}}if("setter"===n){const{name:n}=r;return function(r){const i=this[n];t.call(this,r),this.requestUpdate(n,i,e)}}throw Error("Unsupported decorator location: "+n)};function n$1(e){return(t,r)=>"object"==typeof r?r$3(e,t,r):((e,t,r)=>{const n=t.hasOwnProperty(r);return t.constructor.createProperty(r,n?{...e,wrapped:!0}:e),n?Object.getOwnPropertyDescriptor(t,r):void 0})(e,t,r)}function r$2(e){return n$1({...e,state:!0,attribute:!1})}class WindowEvents{static onKeyDown(e){var t,r;Dropdown.isDisplayed(null==(t=this._activeOverlayElements.outerContainerDropdown)?void 0:t.element)&&OuterDropdownEvents.windowOnKeyDown(this,e),Dropdown.isDisplayed(this._activeOverlayElements.rowDropdown)&&RowDropdownEvents.windowOnKeyDown(this,e);const{rowIndex:n,columnIndex:i,element:a}=this._focusedElements.cell;if(void 0!==n&&void 0!==i){if(0!==n||Dropdown.isDisplayed(this._activeOverlayElements.columnDropdown)){if(Dropdown.isDisplayed(this._activeOverlayElements.columnDropdown)&&(null==(r=this.shadowRoot)||!r.activeElement))return ColumnDropdownEvents.onKeyDown.bind(this)(this._activeOverlayElements.columnDropdown,e)}else if(e.key===KEYBOARD_KEY.ESCAPE)return HeaderText.onAttemptChange(this,a,i);n>0&&this._columnsDetails[i].activeType.cellDropdownProps&&SelectCellTextBaseEvents.keyDownText(this,n,i,e)}}static onKeyUp(e){e.key===KEYBOARD_KEY.ESCAPE?(OptionColorButtonEvents.windowEventClosePicker(this._columnsDetails,this._focusedElements),DateCellInputEvents.escapeKeyInput(this)):e.key===KEYBOARD_KEY.ENTER&&OptionColorButtonEvents.windowEventClosePicker(this._columnsDetails,this._focusedElements)}static onMouseDown(e){var t;if(OptionColorButtonEvents.windowEventClosePicker(this._columnsDetails,this._focusedElements),Dropdown.isDisplayed(null==(t=this._activeOverlayElements.outerContainerDropdown)?void 0:t.element)&&OuterDropdownEvents.windowOnMouseDown(this),e.target.tagName===ActiveTable._ELEMENT_TAG)return;const{_activeOverlayElements:{columnDropdown:r,rowDropdown:n},_focusedElements:i}=this;Dropdown.isDisplayed(n)&&RowDropdown.hide(this),Dropdown.isDisplayed(r)?ColumnDropdown.processTextAndHide(this):i.cellDropdown?CellWithTextEvents.programmaticBlur(this):this._activeOverlayElements.datePickerCell&&(DateCellInputElement.toggle(this._activeOverlayElements.datePickerCell,!1),delete this._activeOverlayElements.datePickerCell)}static onMouseUp(){this._activeOverlayElements.selectedColumnSizer&&ColumnSizerExtrinsicEvents.windowMouseUp(this),DragColumn.windowMouseUp(this),DragRow.windowMouseUp(this)}static onMouseMove(e){this._activeOverlayElements.selectedColumnSizer&&ColumnSizerExtrinsicEvents.windowMouseMove(this,e.movementX),this._focusedElements.colDragEl&&DragColumn.windowDrag(this,this._focusedElements.colDragEl,e),this._focusedElements.rowDragEl&&DragRow.windowDrag(this,e)}}class Render{static refreshTableState(e){var t;null==(t=e._cellDropdownContainer)||t.replaceChildren(),e._columnsDetails.splice(0,e._columnsDetails.length),e._tableDimensions.indexColumnWidth=IndexColumn.DEFAULT_WIDTH,e._addColumnCellsElementsRef.splice(0,e._addColumnCellsElementsRef.length),e._overflow&&(e._tableDimensions.border=TableBorderDimensionsUtils.generateUsingElement(e._overflow.overflowContainer))}static renderTable(e){e._isRendering=!0,TableDimensionsUtils.record(e),Render.refreshTableState(e),e._overflow&&OverflowUtils.applyDimensions(e),TableElement.setStaticWidthContentTotal(e),TableDimensionsUtils.setTableDimensions(e),TableElement.populateBody(e),setTimeout((()=>e._isRendering=!1))}}class WindowResize{static resize(e){const{_tableDimensions:t}=this;(e.width&&window.innerWidth!==t.recordedWindowWidth||e.height&&window.innerHeight!==t.recordedWindowHeight)&&Render.renderTable(this)}static extractPostfix(e){if("string"==typeof e){if(e.includes(VW))return VW;if(e.includes(VH))return VH}return""}static extractDimensionsToObserve(e){const{tableStyle:t,_overflow:r}=e,n=[t.width,t.maxWidth,null==r?void 0:r.maxHeight,null==r?void 0:r.maxWidth].map((e=>WindowResize.extractPostfix(e)));return{width:!!n.find((e=>e===VW)),height:!!n.find((e=>e===VH))}}static observeIfRequired(e){const t=WindowResize.extractDimensionsToObserve(e);(t.width||t.height)&&window.addEventListener("resize",WindowResize.resize.bind(e,t))}}class WindowElement{static setEvents(e){window.addEventListener("keydown",WindowEvents.onKeyDown.bind(e)),window.addEventListener("keyup",WindowEvents.onKeyUp.bind(e)),window.addEventListener("mousedown",WindowEvents.onMouseDown.bind(e)),window.addEventListener("mouseup",WindowEvents.onMouseUp.bind(e)),window.addEventListener("mousemove",WindowEvents.onMouseMove.bind(e)),WindowResize.observeIfRequired(e)}}const _GoogleFont=class e{static appendStyleSheetToHead(){const t=document.getElementsByTagName("head")[0];if(!Array.from(t.getElementsByTagName("link")).some((t=>t.getAttribute("href")===e.FONT_URL))){const r=document.createElement("link");r.rel="stylesheet",r.href=e.FONT_URL,t.appendChild(r)}}};_GoogleFont.FONT_URL="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap";let GoogleFont=_GoogleFont;class ParentResize{static doesOverflowNeedRerender(e,t){if(!e._overflow)return!1;const{isHeightPercentage:r,isWidthPercentage:n}=e._overflow;return r&&e._tableDimensions.recordedParentHeight!==t.offsetHeight||n&&e._tableDimensions.recordedParentWidth!==t.offsetWidth}static shouldRerenderTable(e){if(!e)return!1;const t=e.parentElement;return!!t&&(!!ParentResize.doesOverflowNeedRerender(e,t)||e._tableDimensions.isPercentage&&e._tableDimensions.recordedParentWidth!==t.offsetWidth&&(void 0===e._tableDimensions.maxWidth||e.offsetWidth>t.offsetWidth))}static resizeCallback(){const e=this;ParentResize.shouldRerenderTable(e)&&(e._tableDimensions.preserveNarrowColumns||(e._tableDimensions.preserveNarrowColumns=!0,setTimeout((()=>e._tableDimensions.preserveNarrowColumns=!1))),Render.renderTable(e))}}const t=globalThis,i=t.trustedTypes,s$1=i?i.createPolicy("lit-html",{createHTML:e=>e}):void 0,e="$lit$",h=`lit$${(Math.random()+"").slice(9)}$`,o="?"+h,n=`<${o}>`,r$1=document,l=()=>r$1.createComment(""),c=e=>null===e||"object"!=typeof e&&"function"!=typeof e,a=Array.isArray,u=e=>a(e)||"function"==typeof(null==e?void 0:e[Symbol.iterator]),d="[ \t\n\f\r]",f=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,v=/-->/g,_=/>/g,m=RegExp(`>|${d}(?:([^\\s"'>=/]+)(${d}*=${d}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),p=/'/g,g=/"/g,$=/^(?:script|style|textarea|title)$/i,w=Symbol.for("lit-noChange"),T=Symbol.for("lit-nothing"),A=new WeakMap,E=r$1.createTreeWalker(r$1,129);function C(e,t){if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==s$1?s$1.createHTML(t):t}const P=(t,r)=>{const i=t.length-1,a=[];let s,o=2===r?"<svg>":"",l=f;for(let r=0;r<i;r++){const i=t[r];let c,d,u=-1,b=0;for(;b<i.length&&(l.lastIndex=b,d=l.exec(i),null!==d);)b=l.lastIndex,l===f?"!--"===d[1]?l=v:void 0!==d[1]?l=_:void 0!==d[2]?($.test(d[2])&&(s=RegExp("</"+d[2],"g")),l=m):void 0!==d[3]&&(l=m):l===m?">"===d[0]?(l=s??f,u=-1):void 0===d[1]?u=-2:(u=l.lastIndex-d[2].length,c=d[1],l=void 0===d[3]?m:'"'===d[3]?g:p):l===g||l===p?l=m:l===v||l===_?l=f:(l=m,s=void 0);const y=l===m&&t[r+1].startsWith("/>")?" ":"";o+=l===f?i+n:u>=0?(a.push(c),i.slice(0,u)+e+i.slice(u)+h+y):i+h+(-2===u?r:y)}return[C(t,o+(t[i]||"<?>")+(2===r?"</svg>":"")),a]};class V{constructor({strings:t,_$litType$:r},n){let a;this.parts=[];let s=0,c=0;const d=t.length-1,u=this.parts,[p,f]=P(t,r);if(this.el=V.createElement(p,n),E.currentNode=this.el.content,2===r){const e=this.el.content.firstChild;e.replaceWith(...e.childNodes)}for(;null!==(a=E.nextNode())&&u.length<d;){if(1===a.nodeType){if(a.hasAttributes())for(const t of a.getAttributeNames())if(t.endsWith(e)){const e=f[c++],r=a.getAttribute(t).split(h),n=/([.?@])?(.*)/.exec(e);u.push({type:1,index:s,name:n[2],strings:r,ctor:"."===n[1]?k:"?"===n[1]?H:"@"===n[1]?I:R}),a.removeAttribute(t)}else t.startsWith(h)&&(u.push({type:6,index:s}),a.removeAttribute(t));if($.test(a.tagName)){const e=a.textContent.split(h),t=e.length-1;if(t>0){a.textContent=i?i.emptyScript:"";for(let r=0;r<t;r++)a.append(e[r],l()),E.nextNode(),u.push({type:2,index:++s});a.append(e[t],l())}}}else if(8===a.nodeType)if(a.data===o)u.push({type:2,index:s});else{let e=-1;for(;-1!==(e=a.data.indexOf(h,e+1));)u.push({type:7,index:s}),e+=h.length-1}s++}}static createElement(e,t){const r=r$1.createElement("template");return r.innerHTML=e,r}}function N(e,t,r=e,n){var i,a;if(t===w)return t;let s=void 0!==n?null==(i=r._$Co)?void 0:i[n]:r._$Cl;const o=c(t)?void 0:t._$litDirective$;return(null==s?void 0:s.constructor)!==o&&(null==(a=null==s?void 0:s._$AO)||a.call(s,!1),void 0===o?s=void 0:(s=new o(e),s._$AT(e,r,n)),void 0!==n?(r._$Co??(r._$Co=[]))[n]=s:r._$Cl=s),void 0!==s&&(t=N(e,s._$AS(e,t.values),s,n)),t}class S{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:r}=this._$AD,n=((null==e?void 0:e.creationScope)??r$1).importNode(t,!0);E.currentNode=n;let i=E.nextNode(),a=0,s=0,o=r[0];for(;void 0!==o;){if(a===o.index){let t;2===o.type?t=new M(i,i.nextSibling,this,e):1===o.type?t=new o.ctor(i,o.name,o.strings,this,e):6===o.type&&(t=new L(i,this,e)),this._$AV.push(t),o=r[++s]}a!==(null==o?void 0:o.index)&&(i=E.nextNode(),a++)}return E.currentNode=r$1,n}p(e){let t=0;for(const r of this._$AV)void 0!==r&&(void 0!==r.strings?(r._$AI(e,r,t),t+=r.strings.length-2):r._$AI(e[t])),t++}}class M{get _$AU(){var e;return(null==(e=this._$AM)?void 0:e._$AU)??this._$Cv}constructor(e,t,r,n){this.type=2,this._$AH=T,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=r,this.options=n,this._$Cv=(null==n?void 0:n.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===(null==e?void 0:e.nodeType)&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=N(this,e,t),c(e)?e===T||null==e||""===e?(this._$AH!==T&&this._$AR(),this._$AH=T):e!==this._$AH&&e!==w&&this._(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):u(e)?this.k(e):this._(e)}S(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.S(e))}_(e){this._$AH!==T&&c(this._$AH)?this._$AA.nextSibling.data=e:this.T(r$1.createTextNode(e)),this._$AH=e}$(e){var t;const{values:r,_$litType$:n}=e,i="number"==typeof n?this._$AC(e):(void 0===n.el&&(n.el=V.createElement(C(n.h,n.h[0]),this.options)),n);if((null==(t=this._$AH)?void 0:t._$AD)===i)this._$AH.p(r);else{const e=new S(i,this),t=e.u(this.options);e.p(r),this.T(t),this._$AH=e}}_$AC(e){let t=A.get(e.strings);return void 0===t&&A.set(e.strings,t=new V(e)),t}k(e){a(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let r,n=0;for(const i of e)n===t.length?t.push(r=new M(this.S(l()),this.S(l()),this,this.options)):r=t[n],r._$AI(i),n++;n<t.length&&(this._$AR(r&&r._$AB.nextSibling,n),t.length=n)}_$AR(e=this._$AA.nextSibling,t){var r;for(null==(r=this._$AP)||r.call(this,!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){var t;void 0===this._$AM&&(this._$Cv=e,null==(t=this._$AP)||t.call(this,e))}}class R{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,r,n,i){this.type=1,this._$AH=T,this._$AN=void 0,this.element=e,this.name=t,this._$AM=n,this.options=i,r.length>2||""!==r[0]||""!==r[1]?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=T}_$AI(e,t=this,r,n){const i=this.strings;let a=!1;if(void 0===i)e=N(this,e,t,0),a=!c(e)||e!==this._$AH&&e!==w,a&&(this._$AH=e);else{const n=e;let s,o;for(e=i[0],s=0;s<i.length-1;s++)o=N(this,n[r+s],t,s),o===w&&(o=this._$AH[s]),a||(a=!c(o)||o!==this._$AH[s]),o===T?e=T:e!==T&&(e+=(o??"")+i[s+1]),this._$AH[s]=o}a&&!n&&this.j(e)}j(e){e===T?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class k extends R{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===T?void 0:e}}class H extends R{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==T)}}class I extends R{constructor(e,t,r,n,i){super(e,t,r,n,i),this.type=5}_$AI(e,t=this){if((e=N(this,e,t,0)??T)===w)return;const r=this._$AH,n=e===T&&r!==T||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,i=e!==T&&(r===T||n);n&&this.element.removeEventListener(this.name,this,r),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;"function"==typeof this._$AH?this._$AH.call((null==(t=this.options)?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}}class L{constructor(e,t,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){N(this,e)}}const Z=t.litHtmlPolyfillSupport;null==Z||Z(V,M),(t.litHtmlVersions??(t.litHtmlVersions=[])).push("3.1.2");const j=(e,t,r)=>{const n=(null==r?void 0:r.renderBefore)??t;let i=n._$litPart$;if(void 0===i){const e=(null==r?void 0:r.renderBefore)??null;n._$litPart$=i=new M(t.insertBefore(l(),e),e,void 0,r??{})}return i._$AI(e),i};class s extends b{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e;const t=super.createRenderRoot();return(e=this.renderOptions).renderBefore??(e.renderBefore=t.firstChild),t}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=j(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null==(e=this._$Do)||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null==(e=this._$Do)||e.setConnected(!1)}render(){return w}}var pt;s._$litElement$=!0,s.finalized=!0,null==(pt=globalThis.litElementHydrateSupport)||pt.call(globalThis,{LitElement:s});const r=globalThis.litElementPolyfillSupport;null==r||r({LitElement:s}),(globalThis.litElementVersions??(globalThis.litElementVersions=[])).push("4.0.4");const activeTableStyle=i$2`
  /* this is used to shrink the width of the active-table element to the shadow-root width */
  :host {
    /* the following property prevents outside styles from affecting this component */
    all: initial;
    /* the following property is used to control the overall component width */
    display: inline-block;
  }

  table {
    border-spacing: 0px;
    position: relative;
    border: 1px solid #00000028;
    background-color: white;
  }

  /* REF-16 */
  .table-controlled-width {
    table-layout: fixed;
    /* fit-content does not work correctly in firefox when there are not enough columns to fit parent */
    width: min-content;
  }

  tbody {
    border-radius: inherit;
  }

  tbody > .row:first-child > *:first-child {
    border-top-left-radius: inherit;
  }

  /* using last-of-type as the last element is a divider which does not help with corner rounding */
  tbody > .row:first-child > .cell:last-of-type {
    border-top-right-radius: inherit;
  }

  #last-visible-row > *:first-child {
    border-bottom-left-radius: inherit;
  }

  #last-visible-row > .cell:last-of-type {
    border-bottom-right-radius: inherit;
  }

  .row {
    color: rgba(0, 0, 0, 0.87);
    font-size: 13px;
    font-weight: 400;
    /* the following is not supported in Firefox (on rows), hence rowHoverStyles will not have the border */
    border-radius: inherit;
  }

  tbody > .row:first-child {
    position: relative;
  }

  .row > *:first-child {
    border-left: none !important;
  }

  .row > .cell:last-of-type {
    border-right: none !important;
  }

  /* REF-25 */
  #last-visible-row > .cell {
    border-bottom: none !important;
  }

  .cell {
    text-align: left;
    padding: 11px 6px 6px;
    font-size: 14px;
    line-height: 17px;
    height: 42.5px;
    box-sizing: border-box;
    outline: none;
    overflow-wrap: anywhere;
    font-size: inherit;
    font-weight: inherit;
    border-bottom-style: solid;
    border-bottom-width: 1px;
    border-bottom-color: rgba(0, 0, 0, 0.12);
    vertical-align: top;
    text-align: left;
    border-right: 1px solid #00000021;
    color: #222222;
  }

  .cell-text-div {
    outline: none;
    overflow-wrap: anywhere;
    border-radius: 4px;
    width: fit-content;
    /* need padding for the cursor to show up */
    padding-left: 1px;
  }

  .select-cell-text {
    float: left;
  }

  .arrow-down-icon-container {
    position: relative;
  }

  .arrow-down-icon {
    position: absolute;
    right: 2px;
    top: 5px;
    text-align: center;
    cursor: pointer;
  }

  .label-cell-text {
    padding-left: 6px;
    padding-right: 6px;
    padding-top: 2px;
    padding-bottom: 2px;
  }

  .cell-divider {
    position: absolute;
    display: flex;
    justify-content: center;
  }

  .cell-divider > * {
    user-select: none;
    /* safari */
    -webkit-user-select: none;
    position: absolute;
    cursor: col-resize;
    justify-content: center;
    height: inherit;
  }

  /* this class needs to be after .cell to have style precendence */
  /* REF-1 */
  .header-cell {
    border-top: none !important;
    cursor: pointer;
    color: #626262;
    padding-top: 12px;
    padding-bottom: 12px;
    font-weight: 500;
  }

  .header-icon-container {
    float: left;
    pointer-events: none;
    /* the height is set to allow the text to be present below the icon when there is not enough space in the cell */
    height: 15px;
  }

  .header-icon-side-text {
    /* cannot use flex as pressing ENTER creates a new div */
    /* cannot use grid as it does not align in Safari */
    display: table-cell;
  }

  .not-selectable {
    user-select: none;
    /* safari */
    -webkit-user-select: none;
  }

  .column-sizer {
    /* need z-index for the sizer to display over header icon */
    z-index: 1;
    background-size: 20px 5px;
    position: absolute;
  }

  .column-sizer-filler {
    height: inherit;
    position: absolute;
    pointer-events: none;
  }

  .column-sizer-overlay {
    background-color: #ff000001;
    z-index: 1;
  }

  .movable-column-sizer {
    z-index: 1;
  }

  .movable-column-sizer-vertical-line {
    width: 1px;
    pointer-events: none;
  }

  #add-new-row-cell {
    padding-top: 8px;
    padding-left: 17px;
    min-height: 28px;
    line-height: 18px;
    font-size: 12px;
    color: #555555;
    vertical-align: middle;
    cursor: pointer;
  }

  .index-cell {
    text-align: center;
    padding: 11px 4px 0px !important;
  }

  .index-cell-overflow {
    overflow: hidden;
    overflow-wrap: normal;
  }

  #temp-invisible-index-number {
    color: #e2e2e200 !important;
  }

  .add-column-cell {
    cursor: pointer;
    text-align: center;
  }

  .header-cell-clone {
    position: absolute;
    cursor: move;
    top: 0px;
  }

  .header-cell-clone-animation {
    transition: 0.25s ease-out;
  }

  .cell-hidden {
    opacity: 0 !important;
  }

  .row-clone {
    position: absolute;
    display: flex;
    opacity: 0.8s;
  }

  .row-clone > * {
    cursor: move !important;
  }

  .row-drag-target-line {
    height: 4px;
    width: 100%;
    position: absolute;
    background-color: #69b0ff;
    pointer-events: none;
  }

  .root-cell {
    text-align: center;
    padding: 0px !important;
    border: none !important;
    // inheriting border radius as when frame components style background is set (add new row component), table border
    // radius is visibly not inherited
    border-radius: inherit;
  }

  .active-table-dropdown {
    position: absolute;
    box-shadow: rgb(15 15 15 / 5%) 0px 0px 0px 1px, rgb(15 15 15 / 10%) 0px 3px 6px, rgb(15 15 15 / 20%) 0px 9px 24px;
    border-radius: 5px;
    background-color: white;
    z-index: 1;
  }

  .active-table-dropup {
    box-shadow: rgba(15, 15, 15, 0.05) 0px 0px 0px 1px, rgba(15, 15, 15, 0.1) 0px 3px 6px,
      rgba(15, 15, 15, 0.2) 0px -2px 24px;
    top: unset !important;
    bottom: 100%;
  }

  .cell-dropdown {
    overflow: auto;
    white-space: nowrap;
  }

  .cell-dropdown::-webkit-scrollbar {
    width: 9px;
    height: 9px;
  }

  .cell-dropdown::-webkit-scrollbar-thumb {
    background-color: #aaaaaa;
    border-radius: 5px;
  }

  .cell-dropdown::-webkit-scrollbar-track {
    background-color: #f2f2f2;
  }

  .dropdown-item {
    padding-top: 3px;
    padding-bottom: 3px;
    padding-right: 5px;
    padding-left: 5px;
    color: #4b4b4b;
    position: relative;
    cursor: pointer;
    /* retaining the outline for dropdown input to make it easier to recognise */
    outline: none;
    font-size: 15px;
  }

  .cell-dropdown > .dropdown-item {
    /* the height of cell dropdown items seem to change depending on monitor size which inconsistently triggers overflow,
    this sets it to be consistent but ideally we should not do this and use a different way to allow any font sizes */
    height: 18px;
  }

  .dropdown-item-icon-container {
    display: flex;
    float: left;
    height: 90%;
    align-items: initial;
    padding-top: 2px;
    /* if items are not aligned in center - change align-items to center and revert changes
      in 0805a911cd5c7921aa05b13ffb9387d3d996c133 */
  }

  .dropdown-title-item {
    cursor: default;
    color: #7c7c7c;
    font-weight: 600;
    font-size: 0.75rem;
    margin-top: 2px;
  }

  .dropdown-input-item {
    text-align: center;
  }

  .dropdown-input {
    width: 92%;
    border: 1px solid grey;
    border-radius: 2px;
    color: #2d2d2d;
    font-size: 14px;
    padding: 3px;
    padding-top: 4px;
  }

  .dropdown-item-divider {
    border-bottom: 1px solid #d4d4d4;
    margin-top: 2px;
    margin-bottom: 2px;
  }

  .dropdown-highlightable-item:hover {
    background-color: #eaeaea;
  }

  .active-dropdown-item {
    background-color: #4a69d4;
    color: white;
  }

  /* using different class as standard dropdowns use above class in their functionality */
  .active-static-dropdown-item {
    background-color: #4a69d4;
    color: white;
  }

  .active-dropdown-item:focus {
    background-color: #2148d5 !important;
    color: white !important;
  }

  /* Do not want to set default height incase user has set a font or a font-family so
    setting a placeholder text and making it invisible */
  .dropdown-item-empty {
    color: #ffffae00 !important;
  }

  .dropdown-disabled-item {
    pointer-events: none;
    color: #9e9e9e8a;
  }

  .cell-dropdown-option-button-container {
    position: absolute;
    width: 100%;
    height: 0px;
    top: 5px;
    left: -5px;
    display: none;
  }

  .cell-dropdown-option-button {
    height: 13px;
    width: 13px;
    position: sticky;
    z-index: 1;
    border-radius: 12px;
    opacity: 0.3;
    background-color: white;
  }

  .cell-dropdown-option-button:hover {
    opacity: 1;
  }

  .cell-dropdown-option-button:active {
    background-color: #f8f8f8;
  }

  .cell-dropdown-option-button > div {
    font-size: 12px;
    height: 11px;
    pointer-events: none;
    color: black;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .cell-dropdown-option-delete-button-icon {
    font-size: 12.5px;
    width: 13px;
  }

  .cell-dropdown-option-color-button-icon {
    width: 12.5px;
  }

  .outer-container-dropdown {
    z-index: 2;
  }

  .color-input {
    width: 0px;
    height: 0px;
    padding: 0px;
    position: absolute;
    outline: none;
    pointer-events: none;
    opacity: 0;
    /* border unset stops color picker panel from appearing in safari */
  }

  .date-input-container {
    position: relative;
    float: right;
    cursor: pointer;
  }

  .date-input {
    top: 17px;
    width: 0px;
    height: 0px;
    border: unset;
    padding: 0px;
    right: 9px;
    position: absolute;
    outline: none;
  }

  .calender-icon-container {
    position: absolute;
    right: 2px;
    top: -4px;
    width: 15px;
    height: 25px;
    text-align: center;
  }

  #full-table-overlay {
    position: absolute;
    top: 0;
    width: 100%;
    height: 100%;
  }

  #drag-and-drop-overlay {
    position: absolute;
    top: 0;
    width: 100%;
    height: 100%;
    height: calc(100% - 10px);
    width: calc(100% - 10px);
    background-color: #70c6ff4d;
    border: 5px dashed #6dafff;
    display: none;
    z-index: 2;
  }

  .filter-hidden-row {
    display: none;
  }

  .dropdown-cell-overlay {
    cursor: pointer;
    background-color: grey;
  }

  .column-dropdown-cell-overlay {
    transition: height 0.2s;
    border-bottom-left-radius: 2px;
    border-bottom-right-radius: 2px;
  }

  .row-dropdown-cell-overlay {
    transition: width 0.2s;
    border-top-right-radius: 2px;
    border-bottom-right-radius: 2px;
  }

  #pagination-button-container {
    right: 0;
    display: flex;
    width: fit-content;
    height: fit-content;
  }

  .pagination-button {
    border: 1px solid #0000004d;
    border-right: unset;
    color: #353535;
    min-width: 31px;
    height: 30.5px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 15.5px;
    /* REF-40 */
    stroke: black;
  }

  .pagination-prev-next-button {
    width: 14.25px;
    padding-left: 4px;
  }

  .pagination-first-last-button {
    width: 13px;
  }

  .pagination-button > * {
    pointer-events: none;
  }

  .pagination-button-disabled {
    pointer-events: none;
    color: #7c7c7c;
    /* REF-40 */
    stroke: #7c7c7c;
  }

  .pagination-button > svg > path {
    /* REF-40 */
    stroke: inherit;
  }

  #pagination-number-of-visible-rows {
    padding-top: 6px;
    color: #252525;
    min-width: 82px;
    text-align: center;
    font-size: 15.5px;
    padding-top: 7.5px;
  }

  #pagination-number-of-rows-select {
    position: relative;
    color: #1d1d1d;
    min-width: max-content;
  }

  #pagination-number-of-rows-select-text {
    font-size: 15.5px;
    float: left;
    margin-top: 6px;
  }

  #rows-per-page-select-button {
    display: inline-block;
    background-color: white;
    border: 1px solid #0000004d;
    border-radius: 4px;
    height: 24px;
    padding-top: 3px;
    padding-bottom: 0.5px;
    padding-left: 6px;
    padding-right: 1px;
    margin-top: 1px;
    cursor: pointer;
  }

  .outer-dropdown-button-arrow-container {
    pointer-events: none;
    color: #353535;
    font-size: 16px;
    float: right;
    margin: 1px;
    margin-left: -1px;
    width: 19px;
  }

  .outer-dropdown-button-arrow-icon {
    width: 16px;
    transform: scale(0.9, 1);
    filter: brightness(0) saturate(100%) invert(11%) sepia(3%) saturate(99%) hue-rotate(157deg) brightness(97%)
      contrast(98%);
    padding-top: 2px;
    padding-left: 2px;
  }

  #rows-per-page-select-button-text {
    display: inline-block;
    pointer-events: none;
    padding-top: 1px;
  }

  .number-of-rows-dropdown-item {
    padding-right: 12.5px;
    text-align: right;
  }

  .file-button-container {
    position: relative;
  }

  .file-button {
    border: 1px solid #00000038;
    border-radius: 3px;
    color: #464646;
    text-align: center;
    cursor: pointer;
    user-select: none;
    background-color: #f8f8f9;
    font-size: 14.5px;
    align-items: center;
    display: flex;
    height: 29px;
    padding: 0px 10px 1px;
  }

  .file-button-arrow-container {
    margin-right: -5px;
  }

  .file-button-arrow-container-icon {
    width: 17px;
    padding-top: 5px;
  }

  .export-formats-dropdown-item {
    padding: 4px 10px;
    font-size: 14.5px;
  }

  .hidden-row {
    line-height: 0px;
    height: 0px !important;
    user-select: none;
    pointer-events: none;
  }

  .hidden-row > * {
    line-height: 0px;
    height: 0px;
    padding: 0px !important;
    font-size: 0px;
    border-bottom-width: 0px !important;
  }

  .hidden-row > th > * {
    display: none;
  }

  .outer-container {
    display: grid;
    position: relative;
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  #outer-top-container > div > div > div > * {
    margin-bottom: 13px;
  }

  #outer-bottom-container > div > div > div > * {
    margin-top: 13px;
  }

  /* REF-38 */
  .outer-container-column {
    display: flex;
    width: 0px;
  }

  .outer-container-column-inner {
    display: flex;
  }

  .outer-container-column-content {
    display: flex;
    /* use -webkit-max-content if the below does not work */
    width: max-content;
  }

  .outer-container-left-column .outer-container-column-content > div {
    margin-right: 10px;
  }

  .outer-container-center-column {
    justify-content: center;
    position: absolute;
  }

  .outer-container-center-column .outer-container-column-content > div {
    margin-left: 5px;
    margin-right: 5px;
  }

  .outer-container-right-column {
    justify-content: end;
  }

  .outer-container-right-column .outer-container-column-content > div {
    margin-left: 10px;
  }

  /* right sibling */
  .pagination-button-active-precedence + div {
    border-left-color: #fafafa01 !important;
  }

  .sticky-header-body > *:first-child {
    top: 0;
    position: sticky !important;
  }

  .sticky-header-body > *:first-child > th {
    background-color: white;
  }

  #overflow-container {
    border: 1px solid #00000026;
  }

  /* REF-37 */
  .no-overflow-sticky-header-body {
    border-top: 1px solid #00000026;
  }

  /* REF-37 */
  .no-overflow-sticky-header-body > *:first-child {
    border-top: inherit;
  }

  /* REF-37 */
  .no-overflow-sticky-header-body > *:first-child > th {
    border-top: inherit !important;
  }

  .filter-rows-container {
    position: relative;
  }

  .filter-rows-input {
    width: 150px;
    height: 20px;
    border: 1px solid #0000002b;
    border-radius: 4px;
    color: rgb(45, 45, 45);
    font-family: inherit;
    padding: 5px 6px;
    font-size: 14px;
  }

  .filter-rows-input::placeholder {
    color: var(--active-table-filter-placeholder-color);
  }

  .filter-rows-dropdown-button {
    position: absolute;
    right: 4px;
    top: 51.6%;
    transform: translateY(-50%);
    cursor: pointer;
    user-select: none;
    filter: brightness(0) saturate(100%) invert(49%) sepia(0%) saturate(974%) hue-rotate(66deg) brightness(97%)
      contrast(96%);
    width: 16px;
    height: 16px;
  }

  .filter-rows-dropdown-button + .filter-rows-case-button {
    right: 15px;
  }

  .filter-rows-case-button + .filter-rows-input {
    padding-right: 30px;
    width: 129px;
  }

  .filter-rows-dropdown-button + .filter-rows-input {
    padding-right: 22px;
    width: 137px;
  }

  .filter-rows-dropdown-button + .filter-rows-case-button + .filter-rows-input {
    padding-right: 45px;
    width: 114px;
  }

  .filter-rows-case-button {
    position: absolute;
    right: 0px;
    top: 49%;
    transform: translate(-50%, -50%);
    color: grey;
    font-size: 13px;
    cursor: pointer;
    user-select: none;
  }

  .filter-rows-dropdown {
    min-width: 100% !important;
    width: max-content !important;
  }

  .filter-rows-dropdown > .dropdown-item {
    padding-left: 8px;
    padding-right: 8px;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .default-loading-container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 400px;
    width: 400px;
    border: 1px solid grey;
  }

  .loading-container-absolute {
    position: absolute;
    top: 0;
    height: 100%;
    width: 100%;
  }

  .absolute-container {
    position: absolute;
    top: 0;
    height: 100%;
    width: 100%;
  }

  .loading-spinner {
    width: 60px;
    height: 60px;
    border: 5px solid #38a4ff;
    border-bottom-color: transparent;
    border-radius: 50%;
    display: inline-block;
    box-sizing: border-box;
    animation: rotation 1s linear infinite;
  }

  #error-container {
    position: absolute;
    top: 0;
    height: 100%;
    width: 100%;
    background-color: #ff000006;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  #error-text {
    font-size: 24px;
    color: red;
  }

  @keyframes rotation {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }
`;var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__decorateClass=(e,t,r,n)=>{for(var i,a=n>1?void 0:n?__getOwnPropDesc(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(a=(n?i(t,r,a):i(a))||a);return n&&a&&__defProp(t,r,a),a};let ActiveTable=class extends s{constructor(){super(),this.getData=()=>JSON.parse(JSON.stringify(this.data)),this.getColumnsDetails=()=>ColumnDetailsUtils.getAllColumnsDetails(this._columnsDetails),this.updateCell=e=>{ProgrammaticCellUpdate.updateText(this,e)},this.updateStructure=e=>{ProgrammaticStructureUpdate.update(this,e)},this.updateData=e=>{UpdateAllTableData.update(this,e,0)},this.importFile=e=>FileImportButtonEvents.triggerImportPrompt(this,e),this.exportFile=e=>FileExportEvents.export(this,e),this.onCellUpdate=()=>{},this.onDataUpdate=()=>{},this.onColumnsUpdate=()=>{},this.onRender=()=>{},this.data=[],this.tableStyle={},this.allowDuplicateHeaders=!0,this.displayHeaderIcons=!0,this.spellCheck=!1,this.customColumnsSettings=[],this.dragRows=!0,this.dragColumns=!0,this.preserveNarrowColumns=!0,this.displayAddNewRow=!0,this.displayAddNewColumn=!0,this.displayIndexColumn={wrapIndexCellText:!1},this.frameComponentsStyles={},this.dataStartsAtHeader=!1,this.columnResizerColors={},this.rowDropdown={displaySettings:{isAvailable:!0,openMethod:{cellClick:!0}}},this.enterKeyMoveDown=!1,this._stickyProps={header:!1},this._defaultColumnsSettings={},this._customColumnsSettings={},this._columnsDetails=[],this._addColumnCellsElementsRef=[],this._focusedElements=FocusedElementsUtils.createEmpty(),this._hoveredElements={},this._activeOverlayElements=ActiveOverlayElementsUtils.createNew(),this._eventFunctions=ElementEvents.getDefault(),this._userKeyEventsState=UserKeyEventsStateUtils.createNew(),this._tableDimensions=TableDimensionsUtils.getDefault(),this._globalItemColors=LabelColorUtils.generateGlobalItemColors(),this._defaultCellHoverColors=CellHighlightUtils.getDefaultHoverProperties(),this._frameComponents=FrameComponentsInternalUtils.getDefault(),this._rowDropdownCellOverlays=[],this._pagination=PaginationInternalUtils.getDefault(),this._files=FilesUtils.createDefault(this),this._visiblityInternal={},this._isRendering=!1,this._isPopulatingTable=!1,GoogleFont.appendStyleSheetToHead()}render(){Render.renderTable(this),this.onDataUpdate(this.data),new ResizeObserver(ParentResize.resizeCallback.bind(this)).observe(this.parentElement),FireEvents.onRender(this)}async update(e){var t,r;PaginationAsyncUtils.preprocessTablePropertiesIfAsync(this),this._isPopulatingTable=!0,StickyPropsUtils.process(this),ColumnSettingsUtils.setUpInternalSettings(this),FrameComponentsInternalUtils.set(this),DefaultColumnTypes.createDropdownItemsForDefaultTypes(),RowDropdownSettingsUtil.process(this),this.pagination&&await PaginationInternalUtils.process(this),this.stripedRows&&StripedRows.process(this),this.rowHoverStyles&&RowHoverEvents.process(this.rowHoverStyles,this._defaultCellHoverColors);const n=TableElement.createInfrastructureElements(this);this.overflow&&OverflowUtils.setupContainer(this,n),TableElement.addOverlayElements(this,n,this._activeOverlayElements),PaginationAsyncUtils.removeLoadingOverlay(this),null==(r=this.shadowRoot)||r.appendChild((null==(t=this._overflow)?void 0:t.overflowContainer)||n),OuterTableComponents.create(this),InitialDataProcessing.preProcess(this,this.data),WindowElement.setEvents(this),this.spellcheck=this.spellCheck,this.auxiliaryStyle&&this.shadowRoot&&WebComponentStyleUtils.add(this.auxiliaryStyle,this.shadowRoot),setTimeout((()=>this._isPopulatingTable=!1),1),super.update(e)}connectedCallback(){Browser.IS_FIREFOX?setTimeout((()=>super.connectedCallback())):super.connectedCallback()}shouldUpdate(){return!this._tableElementRef}};ActiveTable._ELEMENT_TAG="ACTIVE-TABLE",ActiveTable.styles=[activeTableStyle],__decorateClass([n$1({attribute:!1})],ActiveTable.prototype,"getData",2),__decorateClass([n$1({attribute:!1})],ActiveTable.prototype,"getColumnsDetails",2),__decorateClass([n$1({attribute:!1})],ActiveTable.prototype,"updateCell",2),__decorateClass([n$1({attribute:!1})],ActiveTable.prototype,"updateStructure",2),__decorateClass([n$1({attribute:!1})],ActiveTable.prototype,"updateData",2),__decorateClass([n$1({attribute:!1})],ActiveTable.prototype,"importFile",2),__decorateClass([n$1({attribute:!1})],ActiveTable.prototype,"exportFile",2),__decorateClass([n$1({converter:LITElementTypeConverters.convertToFunction})],ActiveTable.prototype,"onCellUpdate",2),__decorateClass([n$1({converter:LITElementTypeConverters.convertToFunction})],ActiveTable.prototype,"onDataUpdate",2),__decorateClass([n$1({converter:LITElementTypeConverters.convertToFunction})],ActiveTable.prototype,"onColumnsUpdate",2),__decorateClass([n$1({converter:LITElementTypeConverters.convertToFunction})],ActiveTable.prototype,"onRender",2),__decorateClass([n$1({type:Array})],ActiveTable.prototype,"data",2),__decorateClass([n$1({type:Object})],ActiveTable.prototype,"tableStyle",2),__decorateClass([n$1({type:Boolean,converter:LITElementTypeConverters.convertToBoolean})],ActiveTable.prototype,"allowDuplicateHeaders",2),__decorateClass([n$1({type:Boolean,converter:LITElementTypeConverters.convertToBoolean})],ActiveTable.prototype,"displayHeaderIcons",2),__decorateClass([n$1({type:Boolean,converter:LITElementTypeConverters.convertToBoolean})],ActiveTable.prototype,"spellCheck",2),__decorateClass([n$1({type:Boolean,converter:LITElementTypeConverters.convertToBoolean})],ActiveTable.prototype,"stickyHeader",2),__decorateClass([n$1({type:Array})],ActiveTable.prototype,"customColumnsSettings",2),__decorateClass([n$1({type:Object})],ActiveTable.prototype,"rowHoverStyles",2),__decorateClass([n$1({type:Boolean,converter:LITElementTypeConverters.convertToBoolean})],ActiveTable.prototype,"dragRows",2),__decorateClass([n$1({type:Boolean,converter:LITElementTypeConverters.convertToBoolean})],ActiveTable.prototype,"dragColumns",2),__decorateClass([n$1({type:Boolean,converter:LITElementTypeConverters.convertToBoolean})],ActiveTable.prototype,"preserveNarrowColumns",2),__decorateClass([n$1({type:Number})],ActiveTable.prototype,"maxColumns",2),__decorateClass([n$1({type:Number})],ActiveTable.prototype,"maxRows",2),__decorateClass([n$1({type:Boolean,converter:LITElementTypeConverters.convertToBoolean})],ActiveTable.prototype,"displayAddNewRow",2),__decorateClass([n$1({type:Boolean,converter:LITElementTypeConverters.convertToBoolean})],ActiveTable.prototype,"displayAddNewColumn",2),__decorateClass([n$1({type:Object})],ActiveTable.prototype,"displayIndexColumn",2),__decorateClass([n$1({type:Object})],ActiveTable.prototype,"frameComponentsStyles",2),__decorateClass([n$1({type:Boolean,converter:LITElementTypeConverters.convertToBoolean})],ActiveTable.prototype,"dataStartsAtHeader",2),__decorateClass([n$1({type:Object})],ActiveTable.prototype,"columnResizerColors",2),__decorateClass([n$1({type:Object})],ActiveTable.prototype,"rowDropdown",2),__decorateClass([n$1({type:Object})],ActiveTable.prototype,"stripedRows",2),__decorateClass([n$1({type:Object})],ActiveTable.prototype,"overflow",2),__decorateClass([n$1({type:String})],ActiveTable.prototype,"defaultText",2),__decorateClass([n$1({type:Boolean,converter:LITElementTypeConverters.convertToBoolean})],ActiveTable.prototype,"isDefaultTextRemovable",2),__decorateClass([n$1({type:Object})],ActiveTable.prototype,"cellStyle",2),__decorateClass([n$1({type:Object})],ActiveTable.prototype,"rootCell",2),__decorateClass([n$1({type:Boolean,converter:LITElementTypeConverters.convertToBoolean})],ActiveTable.prototype,"isCellTextEditable",2),__decorateClass([n$1({type:Object})],ActiveTable.prototype,"headerStyles",2),__decorateClass([n$1({type:Boolean,converter:LITElementTypeConverters.convertToBoolean})],ActiveTable.prototype,"isHeaderTextEditable",2),__decorateClass([n$1({type:Object})],ActiveTable.prototype,"headerIconStyle",2),__decorateClass([n$1({type:Boolean,converter:LITElementTypeConverters.convertToBoolean})],ActiveTable.prototype,"isColumnResizable",2),__decorateClass([n$1({type:Array})],ActiveTable.prototype,"availableDefaultColumnTypes",2),__decorateClass([n$1({type:Array})],ActiveTable.prototype,"customColumnTypes",2),__decorateClass([n$1({type:String})],ActiveTable.prototype,"defaultColumnTypeName",2),__decorateClass([n$1({type:Object})],ActiveTable.prototype,"columnDropdown",2),__decorateClass([n$1({type:Boolean,converter:LITElementTypeConverters.convertToBoolean})],ActiveTable.prototype,"enterKeyMoveDown",2),__decorateClass([n$1({type:Object})],ActiveTable.prototype,"pagination",2),__decorateClass([n$1({type:Object})],ActiveTable.prototype,"loadingStyles",2),__decorateClass([n$1({type:Object})],ActiveTable.prototype,"files",2),__decorateClass([n$1({type:Object})],ActiveTable.prototype,"filter",2),__decorateClass([n$1({type:String})],ActiveTable.prototype,"auxiliaryStyle",2),__decorateClass([r$2()],ActiveTable.prototype,"_stickyProps",2),__decorateClass([r$2()],ActiveTable.prototype,"_defaultColumnsSettings",2),__decorateClass([r$2()],ActiveTable.prototype,"_customColumnsSettings",2),__decorateClass([r$2()],ActiveTable.prototype,"_columnsDetails",2),__decorateClass([r$2()],ActiveTable.prototype,"_tableElementRef",2),__decorateClass([r$2()],ActiveTable.prototype,"_tableBodyElementRef",2),__decorateClass([r$2()],ActiveTable.prototype,"_addRowCellElementRef",2),__decorateClass([r$2()],ActiveTable.prototype,"_addColumnCellsElementsRef",2),__decorateClass([r$2()],ActiveTable.prototype,"_focusedElements",2),__decorateClass([r$2()],ActiveTable.prototype,"_hoveredElements",2),__decorateClass([r$2()],ActiveTable.prototype,"_activeOverlayElements",2),__decorateClass([r$2()],ActiveTable.prototype,"_eventFunctions",2),__decorateClass([r$2()],ActiveTable.prototype,"_userKeyEventsState",2),__decorateClass([r$2()],ActiveTable.prototype,"_tableDimensions",2),__decorateClass([r$2()],ActiveTable.prototype,"_cellDropdownContainer",2),__decorateClass([r$2()],ActiveTable.prototype,"_globalItemColors",2),__decorateClass([r$2()],ActiveTable.prototype,"_defaultCellHoverColors",2),__decorateClass([r$2()],ActiveTable.prototype,"_frameComponents",2),__decorateClass([r$2()],ActiveTable.prototype,"_rowDropdownCellOverlays",2),__decorateClass([r$2()],ActiveTable.prototype,"_stripedRows",2),__decorateClass([r$2()],ActiveTable.prototype,"_overflow",2),__decorateClass([r$2()],ActiveTable.prototype,"_pagination",2),__decorateClass([r$2()],ActiveTable.prototype,"_files",2),__decorateClass([r$2()],ActiveTable.prototype,"_visiblityInternal",2),__decorateClass([r$2({hasChanged:()=>!1})],ActiveTable.prototype,"_isRendering",2),__decorateClass([r$2({hasChanged:()=>!1})],ActiveTable.prototype,"_isPopulatingTable",2),ActiveTable=__decorateClass([t$2("active-table")],ActiveTable)},4789:(e,t,r)=>{var n=r(9995);function i(){n.call(this)}i.prototype=new n,e.exports=i,i.Stream=i,i.prototype.pipe=function(e,t){var r=this;function n(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function i(){r.readable&&r.resume&&r.resume()}r.on("data",n),e.on("drain",i),e._isStdio||t&&!1===t.end||(r.on("end",s),r.on("close",o));var a=!1;function s(){a||(a=!0,e.end())}function o(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function l(e){if(c(),!this.hasListeners("error"))throw e}function c(){r.off("data",n),e.off("drain",i),r.off("end",s),r.off("close",o),r.off("error",l),e.off("error",l),r.off("end",c),r.off("close",c),e.off("end",c),e.off("close",c)}return r.on("error",l),e.on("error",l),r.on("end",c),r.on("close",c),e.on("end",c),e.on("close",c),e.emit("pipe",r),e}},4809:function(e,t){var r,n;r=function e(){var t,r="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r?r:{},n=!r.document&&!!r.postMessage,i=r.IS_PAPA_WORKER||!1,a={},s=0,o={};function l(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=v(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new h(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){var n=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<n){let t=this._config.newline;t||(a=this._config.quoteChar||'"',t=this._handle.guessLineEndings(e,a)),e=[...e.split(t).slice(n)].join(t)}this.isFirstChunk&&w(this._config.beforeFirstChunk)&&void 0!==(a=this._config.beforeFirstChunk(e))&&(e=a),this.isFirstChunk=!1,this._halted=!1,n=this._partialLine+e;var a=(this._partialLine="",this._handle.parse(n,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(e=a.meta.cursor,this._finished||(this._partialLine=n.substring(e-this._baseIndex),this._baseIndex=e),a&&a.data&&(this._rowCount+=a.data.length),n=this._finished||this._config.preview&&this._rowCount>=this._config.preview,i)r.postMessage({results:a,workerId:o.WORKER_ID,finished:n});else if(w(this._config.chunk)&&!t){if(this._config.chunk(a,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=a=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(a.data),this._completeResults.errors=this._completeResults.errors.concat(a.errors),this._completeResults.meta=a.meta),this._completed||!n||!w(this._config.complete)||a&&a.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),n||a&&a.meta.paused||this._nextChunk(),a}this._halted=!0},this._sendError=function(e){w(this._config.error)?this._config.error(e):i&&this._config.error&&r.postMessage({workerId:o.WORKER_ID,error:e,finished:!1})}}function c(e){var t;(e=e||{}).chunkSize||(e.chunkSize=o.RemoteChunkSize),l.call(this,e),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),n||(t.onload=y(this._chunkLoaded,this),t.onerror=y(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var e,r=this._config.downloadRequestHeaders;for(e in r)t.setRequestHeader(e,r[e])}var i;this._config.chunkSize&&(i=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+i));try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}n&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(e=>null!==(e=e.getResponseHeader("Content-Range"))?parseInt(e.substring(e.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){e=t.statusText||e,this._sendError(new Error(e))}}function d(e){(e=e||{}).chunkSize||(e.chunkSize=o.LocalChunkSize),l.call(this,e);var t,r,n="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,r=e.slice||e.webkitSlice||e.mozSlice,n?((t=new FileReader).onload=y(this._chunkLoaded,this),t.onerror=y(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input,i=(this._config.chunkSize&&(i=Math.min(this._start+this._config.chunkSize,this._input.size),e=r.call(e,this._start,i)),t.readAsText(e,this._config.encoding));n||this._chunkLoaded({target:{result:i}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function u(e){var t;l.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){var e,r;if(!this._finished)return e=this._config.chunkSize,t=e?(r=t.substring(0,e),t.substring(e)):(r=t,""),this._finished=!t,this.parseChunk(r)}}function p(e){l.call(this,e=e||{});var t=[],r=!0,n=!1;this.pause=function(){l.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){l.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){n&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=y((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}}),this),this._streamError=y((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=y((function(){this._streamCleanUp(),n=!0,this._streamData("")}),this),this._streamCleanUp=y((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function h(e){var t,r,n,i,a=Math.pow(2,53),s=-a,l=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,c=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,d=this,u=0,p=0,h=!1,g=!1,_=[],b={data:[],errors:[],meta:{}};function y(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function E(){if(b&&n&&(T("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+o.DefaultDelimiter+"'"),n=!1),e.skipEmptyLines&&(b.data=b.data.filter((function(e){return!y(e)}))),S()){if(b)if(Array.isArray(b.data[0])){for(var t=0;S()&&t<b.data.length;t++)b.data[t].forEach(d);b.data.splice(0,1)}else b.data.forEach(d);function d(t,r){w(e.transformHeader)&&(t=e.transformHeader(t,r)),_.push(t)}}function r(t,r){for(var n=e.header?{}:[],i=0;i<t.length;i++){var o=i,d=t[i];d=((t,r)=>(t=>(e.dynamicTypingFunction&&void 0===e.dynamicTyping[t]&&(e.dynamicTyping[t]=e.dynamicTypingFunction(t)),!0===(e.dynamicTyping[t]||e.dynamicTyping)))(t)?"true"===r||"TRUE"===r||"false"!==r&&"FALSE"!==r&&((e=>{if(l.test(e)&&(e=parseFloat(e),s<e&&e<a))return 1})(r)?parseFloat(r):c.test(r)?new Date(r):""===r?null:r):r)(o=e.header?i>=_.length?"__parsed_extra":_[i]:o,d=e.transform?e.transform(d,o):d),"__parsed_extra"===o?(n[o]=n[o]||[],n[o].push(d)):n[o]=d}return e.header&&(i>_.length?T("FieldMismatch","TooManyFields","Too many fields: expected "+_.length+" fields but parsed "+i,p+r):i<_.length&&T("FieldMismatch","TooFewFields","Too few fields: expected "+_.length+" fields but parsed "+i,p+r)),n}var i;b&&(e.header||e.dynamicTyping||e.transform)&&(i=1,!b.data.length||Array.isArray(b.data[0])?(b.data=b.data.map(r),i=b.data.length):b.data=r(b.data,0),e.header&&b.meta&&(b.meta.fields=_),p+=i)}function S(){return e.header&&0===_.length}function T(e,t,r,n){e={type:e,code:t,message:r},void 0!==n&&(e.row=n),b.errors.push(e)}w(e.step)&&(i=e.step,e.step=function(t){b=t,S()?E():(E(),0!==b.data.length&&(u+=t.data.length,e.preview&&u>e.preview?r.abort():(b.data=b.data[0],i(b,d))))}),this.parse=function(i,a,s){var l=e.quoteChar||'"';return e.newline||(e.newline=this.guessLineEndings(i,l)),n=!1,e.delimiter?w(e.delimiter)&&(e.delimiter=e.delimiter(i),b.meta.delimiter=e.delimiter):((l=((t,r,n,i,a)=>{var s,l,c,d;a=a||[",","\t","|",";",o.RECORD_SEP,o.UNIT_SEP];for(var u=0;u<a.length;u++){for(var p,h=a[u],f=0,g=0,_=0,b=(c=void 0,new m({comments:i,delimiter:h,newline:r,preview:10}).parse(t)),v=0;v<b.data.length;v++)n&&y(b.data[v])?_++:(g+=p=b.data[v].length,void 0===c?c=p:0<p&&(f+=Math.abs(p-c),c=p));0<b.data.length&&(g/=b.data.length-_),(void 0===l||f<=l)&&(void 0===d||d<g)&&1.99<g&&(l=f,s=h,d=g)}return{successful:!!(e.delimiter=s),bestDelimiter:s}})(i,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=l.bestDelimiter:(n=!0,e.delimiter=o.DefaultDelimiter),b.meta.delimiter=e.delimiter),l=v(e),e.preview&&e.header&&l.preview++,t=i,r=new m(l),b=r.parse(t,a,s),E(),h?{meta:{paused:!0}}:b||{meta:{paused:!1}}},this.paused=function(){return h},this.pause=function(){h=!0,r.abort(),t=w(e.chunk)?"":t.substring(r.getCharIndex())},this.resume=function(){d.streamer._halted?(h=!1,d.streamer.parseChunk(t,!0)):setTimeout(d.resume,3)},this.aborted=function(){return g},this.abort=function(){g=!0,r.abort(),b.meta.aborted=!0,w(e.complete)&&e.complete(b),t=""},this.guessLineEndings=function(e,t){e=e.substring(0,1048576),t=new RegExp(f(t)+"([^]*?)"+f(t),"gm");var r=(e=e.replace(t,"")).split("\r");if(e=1<(t=e.split("\n")).length&&t[0].length<r[0].length,1===r.length||e)return"\n";for(var n=0,i=0;i<r.length;i++)"\n"===r[i][0]&&n++;return n>=r.length/2?"\r\n":"\r"}}function f(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function m(e){var t=(e=e||{}).delimiter,r=e.newline,n=e.comments,i=e.step,a=e.preview,s=e.fastMode,l=null,c=!1,d=null==e.quoteChar?'"':e.quoteChar,u=d;if(void 0!==e.escapeChar&&(u=e.escapeChar),("string"!=typeof t||-1<o.BAD_DELIMITERS.indexOf(t))&&(t=","),n===t)throw new Error("Comment character same as delimiter");!0===n?n="#":("string"!=typeof n||-1<o.BAD_DELIMITERS.indexOf(n))&&(n=!1),"\n"!==r&&"\r"!==r&&"\r\n"!==r&&(r="\n");var p=0,h=!1;this.parse=function(o,m,g){if("string"!=typeof o)throw new Error("Input must be a string");var _=o.length,b=t.length,v=r.length,y=n.length,E=w(i),S=[],T=[],C=[],x=p=0;if(!o)return U();if(s||!1!==s&&-1===o.indexOf(d)){for(var A=o.split(r),I=0;I<A.length;I++){if(C=A[I],p+=C.length,I!==A.length-1)p+=r.length;else if(g)return U();if(!n||C.substring(0,y)!==n){if(E){if(S=[],R(C.split(t)),M(),h)return U()}else R(C.split(t));if(a&&a<=I)return S=S.slice(0,a),U(!0)}}return U()}for(var D=o.indexOf(t,p),k=o.indexOf(r,p),L=new RegExp(f(u)+f(d),"g"),P=o.indexOf(d,p);;)if(o[p]===d)for(P=p,p++;;){if(-1===(P=o.indexOf(d,P+1)))return g||T.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:S.length,index:p}),B();if(P===_-1)return B(o.substring(p,P).replace(L,d));if(d===u&&o[P+1]===u)P++;else if(d===u||0===P||o[P-1]!==u){-1!==D&&D<P+1&&(D=o.indexOf(t,P+1));var O=N(-1===(k=-1!==k&&k<P+1?o.indexOf(r,P+1):k)?D:Math.min(D,k));if(o.substr(P+1+O,b)===t){C.push(o.substring(p,P).replace(L,d)),o[p=P+1+O+b]!==d&&(P=o.indexOf(d,p)),D=o.indexOf(t,p),k=o.indexOf(r,p);break}if(O=N(k),o.substring(P+1+O,P+1+O+v)===r){if(C.push(o.substring(p,P).replace(L,d)),F(P+1+O+v),D=o.indexOf(t,p),P=o.indexOf(d,p),E&&(M(),h))return U();if(a&&S.length>=a)return U(!0);break}T.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:S.length,index:p}),P++}}else if(n&&0===C.length&&o.substring(p,p+y)===n){if(-1===k)return U();p=k+v,k=o.indexOf(r,p),D=o.indexOf(t,p)}else if(-1!==D&&(D<k||-1===k))C.push(o.substring(p,D)),p=D+b,D=o.indexOf(t,p);else{if(-1===k)break;if(C.push(o.substring(p,k)),F(k+v),E&&(M(),h))return U();if(a&&S.length>=a)return U(!0)}return B();function R(e){S.push(e),x=p}function N(e){return-1!==e&&(e=o.substring(P+1,e))&&""===e.trim()?e.length:0}function B(e){return g||(void 0===e&&(e=o.substring(p)),C.push(e),p=_,R(C),E&&M()),U()}function F(e){p=e,R(C),C=[],k=o.indexOf(r,p)}function U(n){if(e.header&&!m&&S.length&&!c){var i=S[0],a={},s=new Set(i);let t=!1;for(let r=0;r<i.length;r++){let n=i[r];if(a[n=w(e.transformHeader)?e.transformHeader(n,r):n]){let e,o=a[n];for(;e=n+"_"+o,o++,s.has(e););s.add(e),i[r]=e,a[n]++,t=!0,(l=null===l?{}:l)[e]=n}else a[n]=1,i[r]=n;s.add(n)}t&&console.warn("Duplicate headers found and renamed."),c=!0}return{data:S,errors:T,meta:{delimiter:t,linebreak:r,aborted:h,truncated:!!n,cursor:x+(m||0),renamedHeaders:l}}}function M(){i(U()),S=[],T=[]}},this.abort=function(){h=!0},this.getCharIndex=function(){return p}}function g(e){var t=e.data,r=a[t.workerId],n=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){n=!0,_(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:b,resume:b};if(w(r.userStep)){for(var s=0;s<t.results.data.length&&(r.userStep({data:t.results.data[s],errors:t.results.errors,meta:t.results.meta},i),!n);s++);delete t.results}else w(r.userChunk)&&(r.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!n&&_(t.workerId,t.results)}function _(e,t){var r=a[e];w(r.userComplete)&&r.userComplete(t),r.terminate(),delete a[e]}function b(){throw new Error("Not implemented.")}function v(e){if("object"!=typeof e||null===e)return e;var t,r=Array.isArray(e)?[]:{};for(t in e)r[t]=v(e[t]);return r}function y(e,t){return function(){e.apply(t,arguments)}}function w(e){return"function"==typeof e}return o.parse=function(t,n){var i=(n=n||{}).dynamicTyping||!1;if(w(i)&&(n.dynamicTypingFunction=i,i={}),n.dynamicTyping=i,n.transform=!!w(n.transform)&&n.transform,!n.worker||!o.WORKERS_SUPPORTED)return i=null,o.NODE_STREAM_INPUT,"string"==typeof t?(t=(e=>65279!==e.charCodeAt(0)?e:e.slice(1))(t),i=new(n.download?c:u)(n)):!0===t.readable&&w(t.read)&&w(t.on)?i=new p(n):(r.File&&t instanceof File||t instanceof Object)&&(i=new d(n)),i.stream(t);(i=(()=>{var t;return!!o.WORKERS_SUPPORTED&&(t=(()=>{var t=r.URL||r.webkitURL||null,n=e.toString();return o.BLOB_URL||(o.BLOB_URL=t.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",n,")();"],{type:"text/javascript"})))})(),(t=new r.Worker(t)).onmessage=g,t.id=s++,a[t.id]=t)})()).userStep=n.step,i.userChunk=n.chunk,i.userComplete=n.complete,i.userError=n.error,n.step=w(n.step),n.chunk=w(n.chunk),n.complete=w(n.complete),n.error=w(n.error),delete n.worker,i.postMessage({input:t,config:n,workerId:i.id})},o.unparse=function(e,t){var r=!1,n=!0,i=",",a="\r\n",s='"',l=s+s,c=!1,d=null,u=!1,p=((()=>{if("object"==typeof t){if("string"!=typeof t.delimiter||o.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(i=t.delimiter),"boolean"!=typeof t.quotes&&"function"!=typeof t.quotes&&!Array.isArray(t.quotes)||(r=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(c=t.skipEmptyLines),"string"==typeof t.newline&&(a=t.newline),"string"==typeof t.quoteChar&&(s=t.quoteChar),"boolean"==typeof t.header&&(n=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");d=t.columns}void 0!==t.escapeChar&&(l=t.escapeChar+s),t.escapeFormulae instanceof RegExp?u=t.escapeFormulae:"boolean"==typeof t.escapeFormulae&&t.escapeFormulae&&(u=/^[=+\-@\t\r].*$/)}})(),new RegExp(f(s),"g"));if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return h(null,e,c);if("object"==typeof e[0])return h(d||Object.keys(e[0]),e,c)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||d),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),h(e.fields||[],e.data||[],c);throw new Error("Unable to serialize unrecognized input");function h(e,t,r){var s="",o=("string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t)),Array.isArray(e)&&0<e.length),l=!Array.isArray(t[0]);if(o&&n){for(var c=0;c<e.length;c++)0<c&&(s+=i),s+=m(e[c],c);0<t.length&&(s+=a)}for(var d=0;d<t.length;d++){var u=(o?e:t[d]).length,p=!1,h=o?0===Object.keys(t[d]).length:0===t[d].length;if(r&&!o&&(p="greedy"===r?""===t[d].join("").trim():1===t[d].length&&0===t[d][0].length),"greedy"===r&&o){for(var f=[],g=0;g<u;g++){var _=l?e[g]:g;f.push(t[d][_])}p=""===f.join("").trim()}if(!p){for(var b=0;b<u;b++){0<b&&!h&&(s+=i);var v=o&&l?e[b]:b;s+=m(t[d][v],b)}d<t.length-1&&(!r||0<u&&!h)&&(s+=a)}}return s}function m(e,t){var n,a;return null==e?"":e.constructor===Date?JSON.stringify(e).slice(1,25):(a=!1,u&&"string"==typeof e&&u.test(e)&&(e="'"+e,a=!0),n=e.toString().replace(p,l),(a=a||!0===r||"function"==typeof r&&r(e,t)||Array.isArray(r)&&r[t]||((e,t)=>{for(var r=0;r<t.length;r++)if(-1<e.indexOf(t[r]))return!0;return!1})(n,o.BAD_DELIMITERS)||-1<n.indexOf(i)||" "===n.charAt(0)||" "===n.charAt(n.length-1))?s+n+s:n)}},o.RECORD_SEP=String.fromCharCode(30),o.UNIT_SEP=String.fromCharCode(31),o.BYTE_ORDER_MARK="\ufeff",o.BAD_DELIMITERS=["\r","\n",'"',o.BYTE_ORDER_MARK],o.WORKERS_SUPPORTED=!n&&!!r.Worker,o.NODE_STREAM_INPUT=1,o.LocalChunkSize=10485760,o.RemoteChunkSize=5242880,o.DefaultDelimiter=",",o.Parser=m,o.ParserHandle=h,o.NetworkStreamer=c,o.FileStreamer=d,o.StringStreamer=u,o.ReadableStreamStreamer=p,r.jQuery&&((t=r.jQuery).fn.parse=function(e){var n=e.config||{},i=[];return this.each((function(e){if("INPUT"!==t(this).prop("tagName").toUpperCase()||"file"!==t(this).attr("type").toLowerCase()||!r.FileReader||!this.files||0===this.files.length)return!0;for(var a=0;a<this.files.length;a++)i.push({file:this.files[a],inputElem:this,instanceConfig:t.extend({},n)})})),a(),this;function a(){if(0===i.length)w(e.complete)&&e.complete();else{var r,n,a,l=i[0];if(w(e.before)){var c=e.before(l.file,l.inputElem);if("object"==typeof c){if("abort"===c.action)return r=l.file,n=l.inputElem,a=c.reason,void(w(e.error)&&e.error({name:"AbortError"},r,n,a));if("skip"===c.action)return void s();"object"==typeof c.config&&(l.instanceConfig=t.extend(l.instanceConfig,c.config))}else if("skip"===c)return void s()}var d=l.instanceConfig.complete;l.instanceConfig.complete=function(e){w(d)&&d(e,l.file,l.inputElem),s()},o.parse(l.file,l.instanceConfig)}}function s(){i.splice(0,1),a()}}),i&&(r.onmessage=function(e){e=e.data,void 0===o.WORKER_ID&&e&&(o.WORKER_ID=e.workerId),"string"==typeof e.input?r.postMessage({workerId:o.WORKER_ID,results:o.parse(e.input,e.config),finished:!0}):(r.File&&e.input instanceof File||e.input instanceof Object)&&(e=o.parse(e.input,e.config))&&r.postMessage({workerId:o.WORKER_ID,results:e,finished:!0})}),(c.prototype=Object.create(l.prototype)).constructor=c,(d.prototype=Object.create(l.prototype)).constructor=d,(u.prototype=Object.create(u.prototype)).constructor=u,(p.prototype=Object.create(l.prototype)).constructor=p,o},void 0===(n=r.apply(t,[]))||(e.exports=n)},4840:(e,t,r)=>{var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;e.exports=n},4973:e=>{e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2736%27 height=%2712%27%3E%3Cpath fill=%27rgba%2817, 17, 17, 0.9%29%27 d=%27M2.658 0h32.004c-6 0-11.627 12.002-16.002 12.002S8.594 0 2.658 0%27/%3E%3C/svg%3E"},5056:(e,t,r)=>{e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},5059:(e,t,r)=>{r.d(t,{A:()=>n});const n={debug:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];(e=console).debug.apply(e,["%cDebug:","display:inline-block;background-color:purple;color:#fff;font-weight:bold;padding:3px 7px;border-radius:3px",""].concat(r))},error:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];(e=console).error.apply(e,["%cError:","display:inline-block;background-color:#e0005a;color:#fff;font-weight:bold;padding:3px 7px;border-radius:3px",""].concat(r))},info:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];(e=console).info.apply(e,["%cInfo:","display:inline-block;background-color:#46C0FF;color:#000;font-weight:bold;padding:3px 7px;border-radius:3px",""].concat(r))},log:function(){var e;(e=console).log.apply(e,arguments)},warn:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];(e=console).warn.apply(e,["%cWarning:","display:inline-block;background-color:gold;color:#000;font-weight:bold;padding:3px 7px;border-radius:3px",""].concat(r))}}},5072:e=>{var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var a={},s=[],o=0;o<e.length;o++){var l=e[o],c=n.base?l[0]+n.base:l[0],d=a[c]||0,u="".concat(c," ").concat(d);a[c]=d+1;var p=r(u),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(h);else{var f=i(h,n);n.byIndex=o,t.splice(o,0,{identifier:u,updater:f,references:1})}s.push(u)}return s}function i(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,i){var a=n(e=e||[],i=i||{});return function(e){e=e||[];for(var s=0;s<a.length;s++){var o=r(a[s]);t[o].references--}for(var l=n(e,i),c=0;c<a.length;c++){var d=r(a[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}a=l}}},5193:(e,t,r)=>{var n=r(9740).isArray;e.exports={copyOptions:function(e){var t,r={};for(t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);return r},ensureFlagExists:function(e,t){e in t&&"boolean"==typeof t[e]||(t[e]=!1)},ensureSpacesExists:function(e){(!("spaces"in e)||"number"!=typeof e.spaces&&"string"!=typeof e.spaces)&&(e.spaces=0)},ensureAlwaysArrayExists:function(e){"alwaysArray"in e&&("boolean"==typeof e.alwaysArray||n(e.alwaysArray))||(e.alwaysArray=!1)},ensureKeyExists:function(e,t){e+"Key"in t&&"string"==typeof t[e+"Key"]||(t[e+"Key"]=t.compact?"_"+e:e)},checkFnExists:function(e,t){return e+"Fn"in t}}},5439:(e,t,r)=>{r.d(t,{LT:()=>h});var n={};r.r(n),r.d(n,{routingHash:()=>s});var i=r(5716),a=r(2147);function s(){i.appInstance().on("navigate",(function(e){window.location.hash="#"+e.data.locationEncoded})),i.appInstance().navigate(window.location.hash.replace(/^#/,"")),window.onhashchange=function(){i.appInstance().navigate(window.location.hash.replace(/^#/,""))}}var o=r(2530);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t,r){return(t=function(e){var t=function(e){if("object"!=l(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var p={utils:{logger:r(5059).A}},h=d(d(d(d(d({},i),a),n),o),p)},5522:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(1601),i=r.n(n),a=r(6314),s=r.n(a)()(i());s.push([e.id,".uppy-Root{box-sizing:border-box;color:#333;font-family:-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Segoe UI Symbol,Segoe UI Emoji,Apple Color Emoji,Roboto,Helvetica,Arial,sans-serif;line-height:1;position:relative;text-align:left;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.uppy-Root[dir=rtl],[dir=rtl] .uppy-Root{text-align:right}.uppy-Root *,.uppy-Root :after,.uppy-Root :before{box-sizing:inherit}.uppy-Root [hidden]{display:none}.uppy-u-reset{all:initial;-webkit-appearance:none;appearance:none;box-sizing:border-box;font-family:-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Segoe UI Symbol,Segoe UI Emoji,Apple Color Emoji,Roboto,Helvetica,Arial,sans-serif;line-height:1}[dir=rtl] .uppy-u-reset{text-align:right}.uppy-c-textInput{background-color:#fff;border:1px solid #ddd;border-radius:4px;font-family:inherit;font-size:14px;line-height:1.5;padding:6px 8px}.uppy-size--md .uppy-c-textInput{padding:8px 10px}.uppy-c-textInput:focus{border-color:#1269cf99;box-shadow:0 0 0 3px #1269cf26;outline:none}[data-uppy-theme=dark] .uppy-c-textInput{background-color:#333;border-color:#333;color:#eaeaea}[data-uppy-theme=dark] .uppy-c-textInput:focus{border-color:#525252;box-shadow:none}.uppy-c-icon{display:inline-block;max-height:100%;max-width:100%;overflow:hidden;fill:currentColor}.uppy-c-btn{align-items:center;color:inherit;display:inline-flex;font-family:inherit;font-size:inherit;font-weight:500;justify-content:center;line-height:1;transition-duration:.3s;transition-property:background-color,color;-webkit-user-select:none;user-select:none;white-space:nowrap}.uppy-c-btn,[dir=rtl] .uppy-c-btn{text-align:center}.uppy-c-btn:not(:disabled):not(.disabled){cursor:pointer}.uppy-c-btn::-moz-focus-inner{border:0}.uppy-c-btn-primary{background-color:#1269cf;border-radius:4px;color:#fff;font-size:14px;padding:10px 18px}.uppy-c-btn-primary:not(:disabled):hover{background-color:#0e51a0}.uppy-c-btn-primary:focus{box-shadow:0 0 0 3px #1269cf66;outline:none}.uppy-size--md .uppy-c-btn-primary{padding:13px 22px}[data-uppy-theme=dark] .uppy-c-btn-primary{color:#eaeaea}[data-uppy-theme=dark] .uppy-c-btn-primary:focus{outline:none}[data-uppy-theme=dark] .uppy-c-btn-primary::-moz-focus-inner{border:0}[data-uppy-theme=dark] .uppy-c-btn-primary:focus{box-shadow:0 0 0 2px #aae1ffd9}.uppy-c-btn-primary.uppy-c-btn--disabled{background-color:#8eb2db}.uppy-c-btn-link{background-color:initial;border-radius:4px;color:#525252;font-size:14px;line-height:1;padding:10px 15px}.uppy-c-btn-link:hover{color:#333}.uppy-c-btn-link:focus{box-shadow:0 0 0 3px #1269cf40;outline:none}.uppy-size--md .uppy-c-btn-link{padding:13px 18px}[data-uppy-theme=dark] .uppy-c-btn-link{color:#eaeaea}[data-uppy-theme=dark] .uppy-c-btn-link:focus{outline:none}[data-uppy-theme=dark] .uppy-c-btn-link::-moz-focus-inner{border:0}[data-uppy-theme=dark] .uppy-c-btn-link:focus{box-shadow:0 0 0 2px #aae1ffd9}[data-uppy-theme=dark] .uppy-c-btn-link:hover{color:#939393}",""]);const o=s},5606:e=>{var t=-1;function r(e,h,f,m,g){if(e===h)return e?[[0,e]]:[];if(null!=f){var b=function(e,t,r){var n="number"==typeof r?{index:r,length:0}:r.oldRange,i="number"==typeof r?null:r.newRange,a=e.length,s=t.length;if(0===n.length&&(null===i||0===i.length)){var o=n.index,l=e.slice(0,o),c=e.slice(o),d=i?i.index:null,u=o+s-a;if((null===d||d===u)&&!(u<0||u>s)){var p=t.slice(0,u);if((m=t.slice(u))===c){var h=Math.min(o,u);if((b=l.slice(0,h))===(y=p.slice(0,h)))return _(b,l.slice(h),p.slice(h),c)}}if(null===d||d===o){var f=o,m=(p=t.slice(0,f),t.slice(f));if(p===l){var g=Math.min(a-f,s-f);if((v=c.slice(c.length-g))===(w=m.slice(m.length-g)))return _(l,c.slice(0,c.length-g),m.slice(0,m.length-g),v)}}}if(n.length>0&&i&&0===i.length){var b=e.slice(0,n.index),v=e.slice(n.index+n.length);if(!(s<(h=b.length)+(g=v.length))){var y=t.slice(0,h),w=t.slice(s-g);if(b===y&&v===w)return _(b,e.slice(h,a-g),t.slice(h,s-g),v)}}return null}(e,h,f);if(b)return b}var v=i(e,h),y=e.substring(0,v);v=s(e=e.substring(v),h=h.substring(v));var w=e.substring(e.length-v),E=function(e,a){var o;if(!e)return[[1,a]];if(!a)return[[t,e]];var l=e.length>a.length?e:a,c=e.length>a.length?a:e,d=l.indexOf(c);if(-1!==d)return o=[[1,l.substring(0,d)],[0,c],[1,l.substring(d+c.length)]],e.length>a.length&&(o[0][0]=o[2][0]=t),o;if(1===c.length)return[[t,e],[1,a]];var u=function(e,t){var r=e.length>t.length?e:t,n=e.length>t.length?t:e;if(r.length<4||2*n.length<r.length)return null;function a(e,t,r){for(var n,a,o,l,c=e.substring(r,r+Math.floor(e.length/4)),d=-1,u="";-1!==(d=t.indexOf(c,d+1));){var p=i(e.substring(r),t.substring(d)),h=s(e.substring(0,r),t.substring(0,d));u.length<h+p&&(u=t.substring(d-h,d)+t.substring(d,d+p),n=e.substring(0,r-h),a=e.substring(r+p),o=t.substring(0,d-h),l=t.substring(d+p))}return 2*u.length>=e.length?[n,a,o,l,u]:null}var o,l,c,d,u,p=a(r,n,Math.ceil(r.length/4)),h=a(r,n,Math.ceil(r.length/2));return p||h?(o=h?p&&p[4].length>h[4].length?p:h:p,e.length>t.length?(l=o[0],c=o[1],d=o[2],u=o[3]):(d=o[0],u=o[1],l=o[2],c=o[3]),[l,c,d,u,o[4]]):null}(e,a);if(u){var p=u[0],h=u[1],f=u[2],m=u[3],g=u[4],_=r(p,f),b=r(h,m);return _.concat([[0,g]],b)}return function(e,r){for(var i=e.length,a=r.length,s=Math.ceil((i+a)/2),o=s,l=2*s,c=new Array(l),d=new Array(l),u=0;u<l;u++)c[u]=-1,d[u]=-1;c[o+1]=0,d[o+1]=0;for(var p=i-a,h=p%2!=0,f=0,m=0,g=0,_=0,b=0;b<s;b++){for(var v=-b+f;v<=b-m;v+=2){for(var y=o+v,w=(x=v===-b||v!==b&&c[y-1]<c[y+1]?c[y+1]:c[y-1]+1)-v;x<i&&w<a&&e.charAt(x)===r.charAt(w);)x++,w++;if(c[y]=x,x>i)m+=2;else if(w>a)f+=2;else if(h&&(T=o+p-v)>=0&&T<l&&-1!==d[T]&&x>=(S=i-d[T]))return n(e,r,x,w)}for(var E=-b+g;E<=b-_;E+=2){for(var S,T=o+E,C=(S=E===-b||E!==b&&d[T-1]<d[T+1]?d[T+1]:d[T-1]+1)-E;S<i&&C<a&&e.charAt(i-S-1)===r.charAt(a-C-1);)S++,C++;if(d[T]=S,S>i)_+=2;else if(C>a)g+=2;else if(!h){var x;if((y=o+p-E)>=0&&y<l&&-1!==c[y])if(w=o+(x=c[y])-y,x>=(S=i-S))return n(e,r,x,w)}}}return[[t,e],[1,r]]}(e,a)}(e=e.substring(0,e.length-v),h=h.substring(0,h.length-v));return y&&E.unshift([0,y]),w&&E.push([0,w]),p(E,g),m&&function(e){for(var r=!1,n=[],i=0,h=null,f=0,m=0,g=0,_=0,b=0;f<e.length;)0==e[f][0]?(n[i++]=f,m=_,g=b,_=0,b=0,h=e[f][1]):(1==e[f][0]?_+=e[f][1].length:b+=e[f][1].length,h&&h.length<=Math.max(m,g)&&h.length<=Math.max(_,b)&&(e.splice(n[i-1],0,[t,h]),e[n[i-1]+1][0]=1,i--,f=--i>0?n[i-1]:-1,m=0,g=0,_=0,b=0,h=null,r=!0)),f++;for(r&&p(e),function(e){function t(e,t){if(!e||!t)return 6;var r=e.charAt(e.length-1),n=t.charAt(0),i=r.match(o),a=n.match(o),s=i&&r.match(l),p=a&&n.match(l),h=s&&r.match(c),f=p&&n.match(c),m=h&&e.match(d),g=f&&t.match(u);return m||g?5:h||f?4:i&&!s&&p?3:s||p?2:i||a?1:0}for(var r=1;r<e.length-1;){if(0==e[r-1][0]&&0==e[r+1][0]){var n=e[r-1][1],i=e[r][1],a=e[r+1][1],p=s(n,i);if(p){var h=i.substring(i.length-p);n=n.substring(0,n.length-p),i=h+i.substring(0,i.length-p),a=h+a}for(var f=n,m=i,g=a,_=t(n,i)+t(i,a);i.charAt(0)===a.charAt(0);){n+=i.charAt(0),i=i.substring(1)+a.charAt(0),a=a.substring(1);var b=t(n,i)+t(i,a);b>=_&&(_=b,f=n,m=i,g=a)}e[r-1][1]!=f&&(f?e[r-1][1]=f:(e.splice(r-1,1),r--),e[r][1]=m,g?e[r+1][1]=g:(e.splice(r+1,1),r--))}r++}}(e),f=1;f<e.length;){if(e[f-1][0]==t&&1==e[f][0]){var v=e[f-1][1],y=e[f][1],w=a(v,y),E=a(y,v);w>=E?(w>=v.length/2||w>=y.length/2)&&(e.splice(f,0,[0,y.substring(0,w)]),e[f-1][1]=v.substring(0,v.length-w),e[f+1][1]=y.substring(w),f++):(E>=v.length/2||E>=y.length/2)&&(e.splice(f,0,[0,v.substring(0,E)]),e[f-1][0]=1,e[f-1][1]=y.substring(0,y.length-E),e[f+1][0]=t,e[f+1][1]=v.substring(E),f++),f++}f++}}(E),E}function n(e,t,n,i){var a=e.substring(0,n),s=t.substring(0,i),o=e.substring(n),l=t.substring(i),c=r(a,s),d=r(o,l);return c.concat(d)}function i(e,t){if(!e||!t||e.charAt(0)!==t.charAt(0))return 0;for(var r=0,n=Math.min(e.length,t.length),i=n,a=0;r<i;)e.substring(a,i)==t.substring(a,i)?a=r=i:n=i,i=Math.floor((n-r)/2+r);return h(e.charCodeAt(i-1))&&i--,i}function a(e,t){var r=e.length,n=t.length;if(0==r||0==n)return 0;r>n?e=e.substring(r-n):r<n&&(t=t.substring(0,r));var i=Math.min(r,n);if(e==t)return i;for(var a=0,s=1;;){var o=e.substring(i-s),l=t.indexOf(o);if(-1==l)return a;s+=l,0!=l&&e.substring(i-s)!=t.substring(0,s)||(a=s,s++)}}function s(e,t){if(!e||!t||e.slice(-1)!==t.slice(-1))return 0;for(var r=0,n=Math.min(e.length,t.length),i=n,a=0;r<i;)e.substring(e.length-i,e.length-a)==t.substring(t.length-i,t.length-a)?a=r=i:n=i,i=Math.floor((n-r)/2+r);return f(e.charCodeAt(e.length-i))&&i--,i}var o=/[^a-zA-Z0-9]/,l=/\s/,c=/[\r\n]/,d=/\n\r?\n$/,u=/^\r?\n\r?\n/;function p(e,r){e.push([0,""]);for(var n,a=0,o=0,l=0,c="",d="";a<e.length;)if(a<e.length-1&&!e[a][1])e.splice(a,1);else switch(e[a][0]){case 1:l++,d+=e[a][1],a++;break;case t:o++,c+=e[a][1],a++;break;case 0:var u=a-l-o-1;if(r){if(u>=0&&g(e[u][1])){var h=e[u][1].slice(-1);if(e[u][1]=e[u][1].slice(0,-1),c=h+c,d=h+d,!e[u][1]){e.splice(u,1),a--;var f=u-1;e[f]&&1===e[f][0]&&(l++,d=e[f][1]+d,f--),e[f]&&e[f][0]===t&&(o++,c=e[f][1]+c,f--),u=f}}m(e[a][1])&&(h=e[a][1].charAt(0),e[a][1]=e[a][1].slice(1),c+=h,d+=h)}if(a<e.length-1&&!e[a][1]){e.splice(a,1);break}if(c.length>0||d.length>0){c.length>0&&d.length>0&&(0!==(n=i(d,c))&&(u>=0?e[u][1]+=d.substring(0,n):(e.splice(0,0,[0,d.substring(0,n)]),a++),d=d.substring(n),c=c.substring(n)),0!==(n=s(d,c))&&(e[a][1]=d.substring(d.length-n)+e[a][1],d=d.substring(0,d.length-n),c=c.substring(0,c.length-n)));var _=l+o;0===c.length&&0===d.length?(e.splice(a-_,_),a-=_):0===c.length?(e.splice(a-_,_,[1,d]),a=a-_+1):0===d.length?(e.splice(a-_,_,[t,c]),a=a-_+1):(e.splice(a-_,_,[t,c],[1,d]),a=a-_+2)}0!==a&&0===e[a-1][0]?(e[a-1][1]+=e[a][1],e.splice(a,1)):a++,l=0,o=0,c="",d=""}""===e[e.length-1][1]&&e.pop();var b=!1;for(a=1;a<e.length-1;)0===e[a-1][0]&&0===e[a+1][0]&&(e[a][1].substring(e[a][1].length-e[a-1][1].length)===e[a-1][1]?(e[a][1]=e[a-1][1]+e[a][1].substring(0,e[a][1].length-e[a-1][1].length),e[a+1][1]=e[a-1][1]+e[a+1][1],e.splice(a-1,1),b=!0):e[a][1].substring(0,e[a+1][1].length)==e[a+1][1]&&(e[a-1][1]+=e[a+1][1],e[a][1]=e[a][1].substring(e[a+1][1].length)+e[a+1][1],e.splice(a+1,1),b=!0)),a++;b&&p(e,r)}function h(e){return e>=55296&&e<=56319}function f(e){return e>=56320&&e<=57343}function m(e){return f(e.charCodeAt(0))}function g(e){return h(e.charCodeAt(e.length-1))}function _(e,r,n,i){return g(e)||m(i)?null:function(e){for(var t=[],r=0;r<e.length;r++)e[r][1].length>0&&t.push(e[r]);return t}([[0,e],[t,r],[1,n],[0,i]])}function b(e,t,n,i){return r(e,t,n,i,!0)}b.INSERT=1,b.DELETE=t,b.EQUAL=0,e.exports=b},5643:function(e){e.exports=function(){function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function t(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach((function(e){var n,a,s;n=t,a=e,s=i[e],(a=r(a))in n?Object.defineProperty(n,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[a]=s})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function r(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}function a(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var o="undefined"!=typeof window&&void 0!==window.document,l=o?window:{},c=!(!o||!l.document.documentElement)&&"ontouchstart"in l.document.documentElement,d=!!o&&"PointerEvent"in l,u="cropper",p="all",h="crop",f="move",m="zoom",g="e",_="w",b="s",v="n",y="ne",w="nw",E="se",S="sw",T="".concat(u,"-crop"),C="".concat(u,"-disabled"),x="".concat(u,"-hidden"),A="".concat(u,"-hide"),I="".concat(u,"-invisible"),D="".concat(u,"-modal"),k="".concat(u,"-move"),L="".concat(u,"Action"),P="".concat(u,"Preview"),O="crop",R="move",N="none",B="crop",F="cropend",U="cropmove",M="cropstart",q="dblclick",z=d?"pointerdown":c?"touchstart":"mousedown",H=d?"pointermove":c?"touchmove":"mousemove",W=d?"pointerup pointercancel":c?"touchend touchcancel":"mouseup",j="ready",V="resize",$="wheel",G="zoom",X="image/jpeg",K=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,Y=/^data:/,Q=/^data:image\/jpeg;base64,/,Z=/^img|canvas$/i,J={viewMode:0,dragMode:O,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},ee=Number.isNaN||l.isNaN;function te(e){return"number"==typeof e&&!ee(e)}var re=function(e){return e>0&&e<1/0};function ne(e){return void 0===e}function ie(e){return"object"===n(e)&&null!==e}var ae=Object.prototype.hasOwnProperty;function se(e){if(!ie(e))return!1;try{var t=e.constructor,r=t.prototype;return t&&r&&ae.call(r,"isPrototypeOf")}catch(e){return!1}}function oe(e){return"function"==typeof e}var le=Array.prototype.slice;function ce(e){return Array.from?Array.from(e):le.call(e)}function de(e,t){return e&&oe(t)&&(Array.isArray(e)||te(e.length)?ce(e).forEach((function(r,n){t.call(e,r,n,e)})):ie(e)&&Object.keys(e).forEach((function(r){t.call(e,e[r],r,e)}))),e}var ue=Object.assign||function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return ie(e)&&r.length>0&&r.forEach((function(t){ie(t)&&Object.keys(t).forEach((function(r){e[r]=t[r]}))})),e},pe=/\.\d*(?:0|9){12}\d*$/;function he(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return pe.test(e)?Math.round(e*t)/t:e}var fe=/^width|height|left|top|marginLeft|marginTop$/;function me(e,t){var r=e.style;de(t,(function(e,t){fe.test(t)&&te(e)&&(e="".concat(e,"px")),r[t]=e}))}function ge(e,t){if(t)if(te(e.length))de(e,(function(e){ge(e,t)}));else if(e.classList)e.classList.add(t);else{var r=e.className.trim();r?r.indexOf(t)<0&&(e.className="".concat(r," ").concat(t)):e.className=t}}function _e(e,t){t&&(te(e.length)?de(e,(function(e){_e(e,t)})):e.classList?e.classList.remove(t):e.className.indexOf(t)>=0&&(e.className=e.className.replace(t,"")))}function be(e,t,r){t&&(te(e.length)?de(e,(function(e){be(e,t,r)})):r?ge(e,t):_e(e,t))}var ve=/([a-z\d])([A-Z])/g;function ye(e){return e.replace(ve,"$1-$2").toLowerCase()}function we(e,t){return ie(e[t])?e[t]:e.dataset?e.dataset[t]:e.getAttribute("data-".concat(ye(t)))}function Ee(e,t,r){ie(r)?e[t]=r:e.dataset?e.dataset[t]=r:e.setAttribute("data-".concat(ye(t)),r)}var Se=/\s\s*/,Te=function(){var e=!1;if(o){var t=!1,r=function(){},n=Object.defineProperty({},"once",{get:function(){return e=!0,t},set:function(e){t=e}});l.addEventListener("test",r,n),l.removeEventListener("test",r,n)}return e}();function Ce(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r;t.trim().split(Se).forEach((function(t){if(!Te){var a=e.listeners;a&&a[t]&&a[t][r]&&(i=a[t][r],delete a[t][r],0===Object.keys(a[t]).length&&delete a[t],0===Object.keys(a).length&&delete e.listeners)}e.removeEventListener(t,i,n)}))}function xe(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r;t.trim().split(Se).forEach((function(t){if(n.once&&!Te){var a=e.listeners,s=void 0===a?{}:a;i=function(){delete s[t][r],e.removeEventListener(t,i,n);for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];r.apply(e,o)},s[t]||(s[t]={}),s[t][r]&&e.removeEventListener(t,s[t][r],n),s[t][r]=i,e.listeners=s}e.addEventListener(t,i,n)}))}function Ae(e,t,r){var n;return oe(Event)&&oe(CustomEvent)?n=new CustomEvent(t,{detail:r,bubbles:!0,cancelable:!0}):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,r),e.dispatchEvent(n)}function Ie(e){var t=e.getBoundingClientRect();return{left:t.left+(window.pageXOffset-document.documentElement.clientLeft),top:t.top+(window.pageYOffset-document.documentElement.clientTop)}}var De=l.location,ke=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Le(e){var t=e.match(ke);return null!==t&&(t[1]!==De.protocol||t[2]!==De.hostname||t[3]!==De.port)}function Pe(e){var t="timestamp=".concat((new Date).getTime());return e+(-1===e.indexOf("?")?"?":"&")+t}function Oe(e){var t=e.rotate,r=e.scaleX,n=e.scaleY,i=e.translateX,a=e.translateY,s=[];te(i)&&0!==i&&s.push("translateX(".concat(i,"px)")),te(a)&&0!==a&&s.push("translateY(".concat(a,"px)")),te(t)&&0!==t&&s.push("rotate(".concat(t,"deg)")),te(r)&&1!==r&&s.push("scaleX(".concat(r,")")),te(n)&&1!==n&&s.push("scaleY(".concat(n,")"));var o=s.length?s.join(" "):"none";return{WebkitTransform:o,msTransform:o,transform:o}}function Re(e,r){var n=e.pageX,i=e.pageY,a={endX:n,endY:i};return r?a:t({startX:n,startY:i},a)}function Ne(e){var t=e.aspectRatio,r=e.height,n=e.width,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",a=re(n),s=re(r);if(a&&s){var o=r*t;"contain"===i&&o>n||"cover"===i&&o<n?r=n/t:n=r*t}else a?r=n/t:s&&(n=r*t);return{width:n,height:r}}var Be=String.fromCharCode;var Fe=/^data:.*,/;function Ue(e){var t,r=new DataView(e);try{var n,i,a;if(255===r.getUint8(0)&&216===r.getUint8(1))for(var s=r.byteLength,o=2;o+1<s;){if(255===r.getUint8(o)&&225===r.getUint8(o+1)){i=o;break}o+=1}if(i){var l=i+10;if("Exif"===function(e,t,r){var n="";r+=t;for(var i=t;i<r;i+=1)n+=Be(e.getUint8(i));return n}(r,i+4,4)){var c=r.getUint16(l);if(((n=18761===c)||19789===c)&&42===r.getUint16(l+2,n)){var d=r.getUint32(l+4,n);d>=8&&(a=l+d)}}}if(a){var u,p,h=r.getUint16(a,n);for(p=0;p<h;p+=1)if(u=a+12*p+2,274===r.getUint16(u,n)){u+=8,t=r.getUint16(u,n),r.setUint16(u,1,n);break}}}catch(e){t=1}return t}var Me={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,t=this.options,r=this.container,n=this.cropper,i=Number(t.minContainerWidth),a=Number(t.minContainerHeight);ge(n,x),_e(e,x);var s={width:Math.max(r.offsetWidth,i>=0?i:200),height:Math.max(r.offsetHeight,a>=0?a:100)};this.containerData=s,me(n,{width:s.width,height:s.height}),ge(e,x),_e(n,x)},initCanvas:function(){var e=this.containerData,t=this.imageData,r=this.options.viewMode,n=Math.abs(t.rotate)%180==90,i=n?t.naturalHeight:t.naturalWidth,a=n?t.naturalWidth:t.naturalHeight,s=i/a,o=e.width,l=e.height;e.height*s>e.width?3===r?o=e.height*s:l=e.width/s:3===r?l=e.width/s:o=e.height*s;var c={aspectRatio:s,naturalWidth:i,naturalHeight:a,width:o,height:l};this.canvasData=c,this.limited=1===r||2===r,this.limitCanvas(!0,!0),c.width=Math.min(Math.max(c.width,c.minWidth),c.maxWidth),c.height=Math.min(Math.max(c.height,c.minHeight),c.maxHeight),c.left=(e.width-c.width)/2,c.top=(e.height-c.height)/2,c.oldLeft=c.left,c.oldTop=c.top,this.initialCanvasData=ue({},c)},limitCanvas:function(e,t){var r=this.options,n=this.containerData,i=this.canvasData,a=this.cropBoxData,s=r.viewMode,o=i.aspectRatio,l=this.cropped&&a;if(e){var c=Number(r.minCanvasWidth)||0,d=Number(r.minCanvasHeight)||0;s>1?(c=Math.max(c,n.width),d=Math.max(d,n.height),3===s&&(d*o>c?c=d*o:d=c/o)):s>0&&(c?c=Math.max(c,l?a.width:0):d?d=Math.max(d,l?a.height:0):l&&(c=a.width,(d=a.height)*o>c?c=d*o:d=c/o));var u=Ne({aspectRatio:o,width:c,height:d});c=u.width,d=u.height,i.minWidth=c,i.minHeight=d,i.maxWidth=1/0,i.maxHeight=1/0}if(t)if(s>(l?0:1)){var p=n.width-i.width,h=n.height-i.height;i.minLeft=Math.min(0,p),i.minTop=Math.min(0,h),i.maxLeft=Math.max(0,p),i.maxTop=Math.max(0,h),l&&this.limited&&(i.minLeft=Math.min(a.left,a.left+(a.width-i.width)),i.minTop=Math.min(a.top,a.top+(a.height-i.height)),i.maxLeft=a.left,i.maxTop=a.top,2===s&&(i.width>=n.width&&(i.minLeft=Math.min(0,p),i.maxLeft=Math.max(0,p)),i.height>=n.height&&(i.minTop=Math.min(0,h),i.maxTop=Math.max(0,h))))}else i.minLeft=-i.width,i.minTop=-i.height,i.maxLeft=n.width,i.maxTop=n.height},renderCanvas:function(e,t){var r=this.canvasData,n=this.imageData;if(t){var i=function(e){var t=e.width,r=e.height,n=e.degree;if(90==(n=Math.abs(n)%180))return{width:r,height:t};var i=n%90*Math.PI/180,a=Math.sin(i),s=Math.cos(i),o=t*s+r*a,l=t*a+r*s;return n>90?{width:l,height:o}:{width:o,height:l}}({width:n.naturalWidth*Math.abs(n.scaleX||1),height:n.naturalHeight*Math.abs(n.scaleY||1),degree:n.rotate||0}),a=i.width,s=i.height,o=r.width*(a/r.naturalWidth),l=r.height*(s/r.naturalHeight);r.left-=(o-r.width)/2,r.top-=(l-r.height)/2,r.width=o,r.height=l,r.aspectRatio=a/s,r.naturalWidth=a,r.naturalHeight=s,this.limitCanvas(!0,!1)}(r.width>r.maxWidth||r.width<r.minWidth)&&(r.left=r.oldLeft),(r.height>r.maxHeight||r.height<r.minHeight)&&(r.top=r.oldTop),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),this.limitCanvas(!1,!0),r.left=Math.min(Math.max(r.left,r.minLeft),r.maxLeft),r.top=Math.min(Math.max(r.top,r.minTop),r.maxTop),r.oldLeft=r.left,r.oldTop=r.top,me(this.canvas,ue({width:r.width,height:r.height},Oe({translateX:r.left,translateY:r.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var t=this.canvasData,r=this.imageData,n=r.naturalWidth*(t.width/t.naturalWidth),i=r.naturalHeight*(t.height/t.naturalHeight);ue(r,{width:n,height:i,left:(t.width-n)/2,top:(t.height-i)/2}),me(this.image,ue({width:r.width,height:r.height},Oe(ue({translateX:r.left,translateY:r.top},r)))),e&&this.output()},initCropBox:function(){var e=this.options,t=this.canvasData,r=e.aspectRatio||e.initialAspectRatio,n=Number(e.autoCropArea)||.8,i={width:t.width,height:t.height};r&&(t.height*r>t.width?i.height=i.width/r:i.width=i.height*r),this.cropBoxData=i,this.limitCropBox(!0,!0),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),i.width=Math.max(i.minWidth,i.width*n),i.height=Math.max(i.minHeight,i.height*n),i.left=t.left+(t.width-i.width)/2,i.top=t.top+(t.height-i.height)/2,i.oldLeft=i.left,i.oldTop=i.top,this.initialCropBoxData=ue({},i)},limitCropBox:function(e,t){var r=this.options,n=this.containerData,i=this.canvasData,a=this.cropBoxData,s=this.limited,o=r.aspectRatio;if(e){var l=Number(r.minCropBoxWidth)||0,c=Number(r.minCropBoxHeight)||0,d=s?Math.min(n.width,i.width,i.width+i.left,n.width-i.left):n.width,u=s?Math.min(n.height,i.height,i.height+i.top,n.height-i.top):n.height;l=Math.min(l,n.width),c=Math.min(c,n.height),o&&(l&&c?c*o>l?c=l/o:l=c*o:l?c=l/o:c&&(l=c*o),u*o>d?u=d/o:d=u*o),a.minWidth=Math.min(l,d),a.minHeight=Math.min(c,u),a.maxWidth=d,a.maxHeight=u}t&&(s?(a.minLeft=Math.max(0,i.left),a.minTop=Math.max(0,i.top),a.maxLeft=Math.min(n.width,i.left+i.width)-a.width,a.maxTop=Math.min(n.height,i.top+i.height)-a.height):(a.minLeft=0,a.minTop=0,a.maxLeft=n.width-a.width,a.maxTop=n.height-a.height))},renderCropBox:function(){var e=this.options,t=this.containerData,r=this.cropBoxData;(r.width>r.maxWidth||r.width<r.minWidth)&&(r.left=r.oldLeft),(r.height>r.maxHeight||r.height<r.minHeight)&&(r.top=r.oldTop),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),this.limitCropBox(!1,!0),r.left=Math.min(Math.max(r.left,r.minLeft),r.maxLeft),r.top=Math.min(Math.max(r.top,r.minTop),r.maxTop),r.oldLeft=r.left,r.oldTop=r.top,e.movable&&e.cropBoxMovable&&Ee(this.face,L,r.width>=t.width&&r.height>=t.height?f:p),me(this.cropBox,ue({width:r.width,height:r.height},Oe({translateX:r.left,translateY:r.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),Ae(this.element,B,this.getData())}},qe={initPreview:function(){var e=this.element,t=this.crossOrigin,r=this.options.preview,n=t?this.crossOriginUrl:this.url,i=e.alt||"The image to preview",a=document.createElement("img");if(t&&(a.crossOrigin=t),a.src=n,a.alt=i,this.viewBox.appendChild(a),this.viewBoxImage=a,r){var s=r;"string"==typeof r?s=e.ownerDocument.querySelectorAll(r):r.querySelector&&(s=[r]),this.previews=s,de(s,(function(e){var r=document.createElement("img");Ee(e,P,{width:e.offsetWidth,height:e.offsetHeight,html:e.innerHTML}),t&&(r.crossOrigin=t),r.src=n,r.alt=i,r.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',e.innerHTML="",e.appendChild(r)}))}},resetPreview:function(){de(this.previews,(function(e){var t=we(e,P);me(e,{width:t.width,height:t.height}),e.innerHTML=t.html,function(e,t){if(ie(e[t]))try{delete e[t]}catch(r){e[t]=void 0}else if(e.dataset)try{delete e.dataset[t]}catch(r){e.dataset[t]=void 0}else e.removeAttribute("data-".concat(ye(t)))}(e,P)}))},preview:function(){var e=this.imageData,t=this.canvasData,r=this.cropBoxData,n=r.width,i=r.height,a=e.width,s=e.height,o=r.left-t.left-e.left,l=r.top-t.top-e.top;this.cropped&&!this.disabled&&(me(this.viewBoxImage,ue({width:a,height:s},Oe(ue({translateX:-o,translateY:-l},e)))),de(this.previews,(function(t){var r=we(t,P),c=r.width,d=r.height,u=c,p=d,h=1;n&&(p=i*(h=c/n)),i&&p>d&&(u=n*(h=d/i),p=d),me(t,{width:u,height:p}),me(t.getElementsByTagName("img")[0],ue({width:a*h,height:s*h},Oe(ue({translateX:-o*h,translateY:-l*h},e))))})))}},ze={bind:function(){var e=this.element,t=this.options,r=this.cropper;oe(t.cropstart)&&xe(e,M,t.cropstart),oe(t.cropmove)&&xe(e,U,t.cropmove),oe(t.cropend)&&xe(e,F,t.cropend),oe(t.crop)&&xe(e,B,t.crop),oe(t.zoom)&&xe(e,G,t.zoom),xe(r,z,this.onCropStart=this.cropStart.bind(this)),t.zoomable&&t.zoomOnWheel&&xe(r,$,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&xe(r,q,this.onDblclick=this.dblclick.bind(this)),xe(e.ownerDocument,H,this.onCropMove=this.cropMove.bind(this)),xe(e.ownerDocument,W,this.onCropEnd=this.cropEnd.bind(this)),t.responsive&&xe(window,V,this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,t=this.options,r=this.cropper;oe(t.cropstart)&&Ce(e,M,t.cropstart),oe(t.cropmove)&&Ce(e,U,t.cropmove),oe(t.cropend)&&Ce(e,F,t.cropend),oe(t.crop)&&Ce(e,B,t.crop),oe(t.zoom)&&Ce(e,G,t.zoom),Ce(r,z,this.onCropStart),t.zoomable&&t.zoomOnWheel&&Ce(r,$,this.onWheel,{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&Ce(r,q,this.onDblclick),Ce(e.ownerDocument,H,this.onCropMove),Ce(e.ownerDocument,W,this.onCropEnd),t.responsive&&Ce(window,V,this.onResize)}},He={resize:function(){if(!this.disabled){var e,t,r=this.options,n=this.container,i=this.containerData,a=n.offsetWidth/i.width,s=n.offsetHeight/i.height,o=Math.abs(a-1)>Math.abs(s-1)?a:s;1!==o&&(r.restore&&(e=this.getCanvasData(),t=this.getCropBoxData()),this.render(),r.restore&&(this.setCanvasData(de(e,(function(t,r){e[r]=t*o}))),this.setCropBoxData(de(t,(function(e,r){t[r]=e*o})))))}},dblclick:function(){var e,t;this.disabled||this.options.dragMode===N||this.setDragMode((e=this.dragBox,t=T,(e.classList?e.classList.contains(t):e.className.indexOf(t)>-1)?R:O))},wheel:function(e){var t=this,r=Number(this.options.wheelZoomRatio)||.1,n=1;this.disabled||(e.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout((function(){t.wheeling=!1}),50),e.deltaY?n=e.deltaY>0?1:-1:e.wheelDelta?n=-e.wheelDelta/120:e.detail&&(n=e.detail>0?1:-1),this.zoom(-n*r,e)))},cropStart:function(e){var t=e.buttons,r=e.button;if(!(this.disabled||("mousedown"===e.type||"pointerdown"===e.type&&"mouse"===e.pointerType)&&(te(t)&&1!==t||te(r)&&0!==r||e.ctrlKey))){var n,i=this.options,a=this.pointers;e.changedTouches?de(e.changedTouches,(function(e){a[e.identifier]=Re(e)})):a[e.pointerId||0]=Re(e),n=Object.keys(a).length>1&&i.zoomable&&i.zoomOnTouch?m:we(e.target,L),K.test(n)&&!1!==Ae(this.element,M,{originalEvent:e,action:n})&&(e.preventDefault(),this.action=n,this.cropping=!1,n===h&&(this.cropping=!0,ge(this.dragBox,D)))}},cropMove:function(e){var t=this.action;if(!this.disabled&&t){var r=this.pointers;e.preventDefault(),!1!==Ae(this.element,U,{originalEvent:e,action:t})&&(e.changedTouches?de(e.changedTouches,(function(e){ue(r[e.identifier]||{},Re(e,!0))})):ue(r[e.pointerId||0]||{},Re(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var t=this.action,r=this.pointers;e.changedTouches?de(e.changedTouches,(function(e){delete r[e.identifier]})):delete r[e.pointerId||0],t&&(e.preventDefault(),Object.keys(r).length||(this.action=""),this.cropping&&(this.cropping=!1,be(this.dragBox,D,this.cropped&&this.options.modal)),Ae(this.element,F,{originalEvent:e,action:t}))}}},We={change:function(e){var r,n=this.options,i=this.canvasData,a=this.containerData,s=this.cropBoxData,o=this.pointers,l=this.action,c=n.aspectRatio,d=s.left,u=s.top,T=s.width,C=s.height,A=d+T,I=u+C,D=0,k=0,L=a.width,P=a.height,O=!0;!c&&e.shiftKey&&(c=T&&C?T/C:1),this.limited&&(D=s.minLeft,k=s.minTop,L=D+Math.min(a.width,i.width,i.left+i.width),P=k+Math.min(a.height,i.height,i.top+i.height));var R=o[Object.keys(o)[0]],N={x:R.endX-R.startX,y:R.endY-R.startY},B=function(e){switch(e){case g:A+N.x>L&&(N.x=L-A);break;case _:d+N.x<D&&(N.x=D-d);break;case v:u+N.y<k&&(N.y=k-u);break;case b:I+N.y>P&&(N.y=P-I)}};switch(l){case p:d+=N.x,u+=N.y;break;case g:if(N.x>=0&&(A>=L||c&&(u<=k||I>=P))){O=!1;break}B(g),(T+=N.x)<0&&(l=_,d-=T=-T),c&&(C=T/c,u+=(s.height-C)/2);break;case v:if(N.y<=0&&(u<=k||c&&(d<=D||A>=L))){O=!1;break}B(v),C-=N.y,u+=N.y,C<0&&(l=b,u-=C=-C),c&&(T=C*c,d+=(s.width-T)/2);break;case _:if(N.x<=0&&(d<=D||c&&(u<=k||I>=P))){O=!1;break}B(_),T-=N.x,d+=N.x,T<0&&(l=g,d-=T=-T),c&&(C=T/c,u+=(s.height-C)/2);break;case b:if(N.y>=0&&(I>=P||c&&(d<=D||A>=L))){O=!1;break}B(b),(C+=N.y)<0&&(l=v,u-=C=-C),c&&(T=C*c,d+=(s.width-T)/2);break;case y:if(c){if(N.y<=0&&(u<=k||A>=L)){O=!1;break}B(v),C-=N.y,u+=N.y,T=C*c}else B(v),B(g),N.x>=0?A<L?T+=N.x:N.y<=0&&u<=k&&(O=!1):T+=N.x,N.y<=0?u>k&&(C-=N.y,u+=N.y):(C-=N.y,u+=N.y);T<0&&C<0?(l=S,u-=C=-C,d-=T=-T):T<0?(l=w,d-=T=-T):C<0&&(l=E,u-=C=-C);break;case w:if(c){if(N.y<=0&&(u<=k||d<=D)){O=!1;break}B(v),C-=N.y,u+=N.y,T=C*c,d+=s.width-T}else B(v),B(_),N.x<=0?d>D?(T-=N.x,d+=N.x):N.y<=0&&u<=k&&(O=!1):(T-=N.x,d+=N.x),N.y<=0?u>k&&(C-=N.y,u+=N.y):(C-=N.y,u+=N.y);T<0&&C<0?(l=E,u-=C=-C,d-=T=-T):T<0?(l=y,d-=T=-T):C<0&&(l=S,u-=C=-C);break;case S:if(c){if(N.x<=0&&(d<=D||I>=P)){O=!1;break}B(_),T-=N.x,d+=N.x,C=T/c}else B(b),B(_),N.x<=0?d>D?(T-=N.x,d+=N.x):N.y>=0&&I>=P&&(O=!1):(T-=N.x,d+=N.x),N.y>=0?I<P&&(C+=N.y):C+=N.y;T<0&&C<0?(l=y,u-=C=-C,d-=T=-T):T<0?(l=E,d-=T=-T):C<0&&(l=w,u-=C=-C);break;case E:if(c){if(N.x>=0&&(A>=L||I>=P)){O=!1;break}B(g),C=(T+=N.x)/c}else B(b),B(g),N.x>=0?A<L?T+=N.x:N.y>=0&&I>=P&&(O=!1):T+=N.x,N.y>=0?I<P&&(C+=N.y):C+=N.y;T<0&&C<0?(l=w,u-=C=-C,d-=T=-T):T<0?(l=S,d-=T=-T):C<0&&(l=y,u-=C=-C);break;case f:this.move(N.x,N.y),O=!1;break;case m:this.zoom(function(e){var r=t({},e),n=0;return de(e,(function(e,t){delete r[t],de(r,(function(t){var r=Math.abs(e.startX-t.startX),i=Math.abs(e.startY-t.startY),a=Math.abs(e.endX-t.endX),s=Math.abs(e.endY-t.endY),o=Math.sqrt(r*r+i*i),l=(Math.sqrt(a*a+s*s)-o)/o;Math.abs(l)>Math.abs(n)&&(n=l)}))})),n}(o),e),O=!1;break;case h:if(!N.x||!N.y){O=!1;break}r=Ie(this.cropper),d=R.startX-r.left,u=R.startY-r.top,T=s.minWidth,C=s.minHeight,N.x>0?l=N.y>0?E:y:N.x<0&&(d-=T,l=N.y>0?S:w),N.y<0&&(u-=C),this.cropped||(_e(this.cropBox,x),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}O&&(s.width=T,s.height=C,s.left=d,s.top=u,this.action=l,this.renderCropBox()),de(o,(function(e){e.startX=e.endX,e.startY=e.endY}))}},je={crop:function(){return!this.ready||this.cropped||this.disabled||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&ge(this.dragBox,D),_e(this.cropBox,x),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=ue({},this.initialImageData),this.canvasData=ue({},this.initialCanvasData),this.cropBoxData=ue({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(ue(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),_e(this.dragBox,D),ge(this.cropBox,x)),this},replace:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&e&&(this.isImg&&(this.element.src=e),t?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,de(this.previews,(function(t){t.getElementsByTagName("img")[0].src=e})))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,_e(this.cropper,C)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,ge(this.cropper,C)),this},destroy:function(){var e=this.element;return e[u]?(e[u]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=this.canvasData,n=r.left,i=r.top;return this.moveTo(ne(e)?e:n+Number(e),ne(t)?t:i+Number(t))},moveTo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=this.canvasData,n=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.movable&&(te(e)&&(r.left=e,n=!0),te(t)&&(r.top=t,n=!0),n&&this.renderCanvas(!0)),this},zoom:function(e,t){var r=this.canvasData;return e=(e=Number(e))<0?1/(1-e):1+e,this.zoomTo(r.width*e/r.naturalWidth,null,t)},zoomTo:function(e,t,r){var n=this.options,i=this.canvasData,a=i.width,s=i.height,o=i.naturalWidth,l=i.naturalHeight;if((e=Number(e))>=0&&this.ready&&!this.disabled&&n.zoomable){var c=o*e,d=l*e;if(!1===Ae(this.element,G,{ratio:e,oldRatio:a/o,originalEvent:r}))return this;if(r){var u=this.pointers,p=Ie(this.cropper),h=u&&Object.keys(u).length?function(e){var t=0,r=0,n=0;return de(e,(function(e){var i=e.startX,a=e.startY;t+=i,r+=a,n+=1})),{pageX:t/=n,pageY:r/=n}}(u):{pageX:r.pageX,pageY:r.pageY};i.left-=(c-a)*((h.pageX-p.left-i.left)/a),i.top-=(d-s)*((h.pageY-p.top-i.top)/s)}else se(t)&&te(t.x)&&te(t.y)?(i.left-=(c-a)*((t.x-i.left)/a),i.top-=(d-s)*((t.y-i.top)/s)):(i.left-=(c-a)/2,i.top-=(d-s)/2);i.width=c,i.height=d,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return te(e=Number(e))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var t=this.imageData.scaleY;return this.scale(e,te(t)?t:1)},scaleY:function(e){var t=this.imageData.scaleX;return this.scale(te(t)?t:1,e)},scale:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=this.imageData,n=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.scalable&&(te(e)&&(r.scaleX=e,n=!0),te(t)&&(r.scaleY=t,n=!0),n&&this.renderCanvas(!0,!0)),this},getData:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.options,n=this.imageData,i=this.canvasData,a=this.cropBoxData;if(this.ready&&this.cropped){e={x:a.left-i.left,y:a.top-i.top,width:a.width,height:a.height};var s=n.width/n.naturalWidth;if(de(e,(function(t,r){e[r]=t/s})),t){var o=Math.round(e.y+e.height),l=Math.round(e.x+e.width);e.x=Math.round(e.x),e.y=Math.round(e.y),e.width=l-e.x,e.height=o-e.y}}else e={x:0,y:0,width:0,height:0};return r.rotatable&&(e.rotate=n.rotate||0),r.scalable&&(e.scaleX=n.scaleX||1,e.scaleY=n.scaleY||1),e},setData:function(e){var t=this.options,r=this.imageData,n=this.canvasData,i={};if(this.ready&&!this.disabled&&se(e)){var a=!1;t.rotatable&&te(e.rotate)&&e.rotate!==r.rotate&&(r.rotate=e.rotate,a=!0),t.scalable&&(te(e.scaleX)&&e.scaleX!==r.scaleX&&(r.scaleX=e.scaleX,a=!0),te(e.scaleY)&&e.scaleY!==r.scaleY&&(r.scaleY=e.scaleY,a=!0)),a&&this.renderCanvas(!0,!0);var s=r.width/r.naturalWidth;te(e.x)&&(i.left=e.x*s+n.left),te(e.y)&&(i.top=e.y*s+n.top),te(e.width)&&(i.width=e.width*s),te(e.height)&&(i.height=e.height*s),this.setCropBoxData(i)}return this},getContainerData:function(){return this.ready?ue({},this.containerData):{}},getImageData:function(){return this.sized?ue({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,t={};return this.ready&&de(["left","top","width","height","naturalWidth","naturalHeight"],(function(r){t[r]=e[r]})),t},setCanvasData:function(e){var t=this.canvasData,r=t.aspectRatio;return this.ready&&!this.disabled&&se(e)&&(te(e.left)&&(t.left=e.left),te(e.top)&&(t.top=e.top),te(e.width)?(t.width=e.width,t.height=e.width/r):te(e.height)&&(t.height=e.height,t.width=e.height*r),this.renderCanvas(!0)),this},getCropBoxData:function(){var e,t=this.cropBoxData;return this.ready&&this.cropped&&(e={left:t.left,top:t.top,width:t.width,height:t.height}),e||{}},setCropBoxData:function(e){var t,r,n=this.cropBoxData,i=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&se(e)&&(te(e.left)&&(n.left=e.left),te(e.top)&&(n.top=e.top),te(e.width)&&e.width!==n.width&&(t=!0,n.width=e.width),te(e.height)&&e.height!==n.height&&(r=!0,n.height=e.height),i&&(t?n.height=n.width/i:r&&(n.width=n.height*i)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var t=this.canvasData,r=function(e,t,r,n){var i=t.aspectRatio,s=t.naturalWidth,o=t.naturalHeight,l=t.rotate,c=void 0===l?0:l,d=t.scaleX,u=void 0===d?1:d,p=t.scaleY,h=void 0===p?1:p,f=r.aspectRatio,m=r.naturalWidth,g=r.naturalHeight,_=n.fillColor,b=void 0===_?"transparent":_,v=n.imageSmoothingEnabled,y=void 0===v||v,w=n.imageSmoothingQuality,E=void 0===w?"low":w,S=n.maxWidth,T=void 0===S?1/0:S,C=n.maxHeight,x=void 0===C?1/0:C,A=n.minWidth,I=void 0===A?0:A,D=n.minHeight,k=void 0===D?0:D,L=document.createElement("canvas"),P=L.getContext("2d"),O=Ne({aspectRatio:f,width:T,height:x}),R=Ne({aspectRatio:f,width:I,height:k},"cover"),N=Math.min(O.width,Math.max(R.width,m)),B=Math.min(O.height,Math.max(R.height,g)),F=Ne({aspectRatio:i,width:T,height:x}),U=Ne({aspectRatio:i,width:I,height:k},"cover"),M=Math.min(F.width,Math.max(U.width,s)),q=Math.min(F.height,Math.max(U.height,o)),z=[-M/2,-q/2,M,q];return L.width=he(N),L.height=he(B),P.fillStyle=b,P.fillRect(0,0,N,B),P.save(),P.translate(N/2,B/2),P.rotate(c*Math.PI/180),P.scale(u,h),P.imageSmoothingEnabled=y,P.imageSmoothingQuality=E,P.drawImage.apply(P,[e].concat(a(z.map((function(e){return Math.floor(he(e))}))))),P.restore(),L}(this.image,this.imageData,t,e);if(!this.cropped)return r;var n=this.getData(e.rounded),i=n.x,s=n.y,o=n.width,l=n.height,c=r.width/Math.floor(t.naturalWidth);1!==c&&(i*=c,s*=c,o*=c,l*=c);var d=o/l,u=Ne({aspectRatio:d,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),p=Ne({aspectRatio:d,width:e.minWidth||0,height:e.minHeight||0},"cover"),h=Ne({aspectRatio:d,width:e.width||(1!==c?r.width:o),height:e.height||(1!==c?r.height:l)}),f=h.width,m=h.height;f=Math.min(u.width,Math.max(p.width,f)),m=Math.min(u.height,Math.max(p.height,m));var g=document.createElement("canvas"),_=g.getContext("2d");g.width=he(f),g.height=he(m),_.fillStyle=e.fillColor||"transparent",_.fillRect(0,0,f,m);var b=e.imageSmoothingEnabled,v=void 0===b||b,y=e.imageSmoothingQuality;_.imageSmoothingEnabled=v,y&&(_.imageSmoothingQuality=y);var w,E,S,T,C,x,A=r.width,I=r.height,D=i,k=s;D<=-o||D>A?(D=0,w=0,S=0,C=0):D<=0?(S=-D,D=0,C=w=Math.min(A,o+D)):D<=A&&(S=0,C=w=Math.min(o,A-D)),w<=0||k<=-l||k>I?(k=0,E=0,T=0,x=0):k<=0?(T=-k,k=0,x=E=Math.min(I,l+k)):k<=I&&(T=0,x=E=Math.min(l,I-k));var L=[D,k,w,E];if(C>0&&x>0){var P=f/o;L.push(S*P,T*P,C*P,x*P)}return _.drawImage.apply(_,[r].concat(a(L.map((function(e){return Math.floor(he(e))}))))),g},setAspectRatio:function(e){var t=this.options;return this.disabled||ne(e)||(t.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var t=this.options,r=this.dragBox,n=this.face;if(this.ready&&!this.disabled){var i=e===O,a=t.movable&&e===R;e=i||a?e:N,t.dragMode=e,Ee(r,L,e),be(r,T,i),be(r,k,a),t.cropBoxMovable||(Ee(n,L,e),be(n,T,i),be(n,k,a))}return this}},Ve=l.Cropper,$e=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t||!Z.test(t.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=t,this.options=ue({},J,se(r)&&r),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return t=e,r=[{key:"init",value:function(){var e,t=this.element,r=t.tagName.toLowerCase();if(!t[u]){if(t[u]=this,"img"===r){if(this.isImg=!0,e=t.getAttribute("src")||"",this.originalUrl=e,!e)return;e=t.src}else"canvas"===r&&window.HTMLCanvasElement&&(e=t.toDataURL());this.load(e)}}},{key:"load",value:function(e){var t,r,n,i,a=this;if(e){this.url=e,this.imageData={};var s=this.element,o=this.options;if(o.rotatable||o.scalable||(o.checkOrientation=!1),o.checkOrientation&&window.ArrayBuffer)if(Y.test(e))Q.test(e)?this.read((t=e.replace(Fe,""),r=atob(t),n=new ArrayBuffer(r.length),de(i=new Uint8Array(n),(function(e,t){i[t]=r.charCodeAt(t)})),n)):this.clone();else{var l=new XMLHttpRequest,c=this.clone.bind(this);this.reloading=!0,this.xhr=l,l.onabort=c,l.onerror=c,l.ontimeout=c,l.onprogress=function(){l.getResponseHeader("content-type")!==X&&l.abort()},l.onload=function(){a.read(l.response)},l.onloadend=function(){a.reloading=!1,a.xhr=null},o.checkCrossOrigin&&Le(e)&&s.crossOrigin&&(e=Pe(e)),l.open("GET",e,!0),l.responseType="arraybuffer",l.withCredentials="use-credentials"===s.crossOrigin,l.send()}else this.clone()}}},{key:"read",value:function(e){var t=this.options,r=this.imageData,n=Ue(e),i=0,a=1,s=1;if(n>1){this.url=function(e,t){for(var r=[],n=new Uint8Array(e);n.length>0;)r.push(Be.apply(null,ce(n.subarray(0,8192)))),n=n.subarray(8192);return"data:".concat(t,";base64,").concat(btoa(r.join("")))}(e,X);var o=function(e){var t=0,r=1,n=1;switch(e){case 2:r=-1;break;case 3:t=-180;break;case 4:n=-1;break;case 5:t=90,n=-1;break;case 6:t=90;break;case 7:t=90,r=-1;break;case 8:t=-90}return{rotate:t,scaleX:r,scaleY:n}}(n);i=o.rotate,a=o.scaleX,s=o.scaleY}t.rotatable&&(r.rotate=i),t.scalable&&(r.scaleX=a,r.scaleY=s),this.clone()}},{key:"clone",value:function(){var e=this.element,t=this.url,r=e.crossOrigin,n=t;this.options.checkCrossOrigin&&Le(t)&&(r||(r="anonymous"),n=Pe(t)),this.crossOrigin=r,this.crossOriginUrl=n;var i=document.createElement("img");r&&(i.crossOrigin=r),i.src=n||t,i.alt=e.alt||"The image to crop",this.image=i,i.onload=this.start.bind(this),i.onerror=this.stop.bind(this),ge(i,A),e.parentNode.insertBefore(i,e.nextSibling)}},{key:"start",value:function(){var e=this,t=this.image;t.onload=null,t.onerror=null,this.sizing=!0;var r=l.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(l.navigator.userAgent),n=function(t,r){ue(e.imageData,{naturalWidth:t,naturalHeight:r,aspectRatio:t/r}),e.initialImageData=ue({},e.imageData),e.sizing=!1,e.sized=!0,e.build()};if(!t.naturalWidth||r){var i=document.createElement("img"),a=document.body||document.documentElement;this.sizingImage=i,i.onload=function(){n(i.width,i.height),r||a.removeChild(i)},i.src=t.src,r||(i.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",a.appendChild(i))}else n(t.naturalWidth,t.naturalHeight)}},{key:"stop",value:function(){var e=this.image;e.onload=null,e.onerror=null,e.parentNode.removeChild(e),this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var e=this.element,t=this.options,r=this.image,n=e.parentNode,i=document.createElement("div");i.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var a=i.querySelector(".".concat(u,"-container")),s=a.querySelector(".".concat(u,"-canvas")),o=a.querySelector(".".concat(u,"-drag-box")),l=a.querySelector(".".concat(u,"-crop-box")),c=l.querySelector(".".concat(u,"-face"));this.container=n,this.cropper=a,this.canvas=s,this.dragBox=o,this.cropBox=l,this.viewBox=a.querySelector(".".concat(u,"-view-box")),this.face=c,s.appendChild(r),ge(e,x),n.insertBefore(a,e.nextSibling),_e(r,A),this.initPreview(),this.bind(),t.initialAspectRatio=Math.max(0,t.initialAspectRatio)||NaN,t.aspectRatio=Math.max(0,t.aspectRatio)||NaN,t.viewMode=Math.max(0,Math.min(3,Math.round(t.viewMode)))||0,ge(l,x),t.guides||ge(l.getElementsByClassName("".concat(u,"-dashed")),x),t.center||ge(l.getElementsByClassName("".concat(u,"-center")),x),t.background&&ge(a,"".concat(u,"-bg")),t.highlight||ge(c,I),t.cropBoxMovable&&(ge(c,k),Ee(c,L,p)),t.cropBoxResizable||(ge(l.getElementsByClassName("".concat(u,"-line")),x),ge(l.getElementsByClassName("".concat(u,"-point")),x)),this.render(),this.ready=!0,this.setDragMode(t.dragMode),t.autoCrop&&this.crop(),this.setData(t.data),oe(t.ready)&&xe(e,j,t.ready,{once:!0}),Ae(e,j)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var e=this.cropper.parentNode;e&&e.removeChild(this.cropper),_e(this.element,x)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],n=[{key:"noConflict",value:function(){return window.Cropper=Ve,e}},{key:"setDefaults",value:function(e){ue(J,se(e)&&e)}}],r&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n}();return ue($e.prototype,Me,qe,ze,He,We,je),$e}()},5716:(e,t,r)=>{r.r(t),r.d(t,{appInstance:()=>s,init:()=>a,questionEditorApp:()=>o});var n=r(2147),i={};function a(e){i.app=e,i.app.on("all",n.handleEvent),["widgetedit:editor:ready","widgetedit:widget:ready","widgetedit:preview:changed","widgetedit:widget:changed"].forEach((function(e){return i.app.on(e,(function(){return(0,n.handleEvent)(e)}))}))}function s(){return i.app}function o(){return void 0!==s().editorApp()?s().editorApp():null}},5759:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.length=function(e){return"number"==typeof e.delete?e.delete:"number"==typeof e.retain?e.retain:"object"==typeof e.retain&&null!==e.retain?1:"string"==typeof e.insert?e.insert.length:1}}(r||(r={})),t.default=r},5969:(e,t,r)=>{var n=r(6100).isArray;e.exports={copyOptions:function(e){var t,r={};for(t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);return r},ensureFlagExists:function(e,t){e in t&&"boolean"==typeof t[e]||(t[e]=!1)},ensureSpacesExists:function(e){(!("spaces"in e)||"number"!=typeof e.spaces&&"string"!=typeof e.spaces)&&(e.spaces=0)},ensureAlwaysArrayExists:function(e){"alwaysArray"in e&&("boolean"==typeof e.alwaysArray||n(e.alwaysArray))||(e.alwaysArray=!1)},ensureKeyExists:function(e,t){e+"Key"in t&&"string"==typeof t[e+"Key"]||(t[e+"Key"]=t.compact?"_"+e:e)},checkFnExists:function(e,t){return e+"Fn"in t}}},6100:e=>{e.exports={isArray:function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}}},6314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,i,a){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(n)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(s[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);n&&s[d[0]]||(void 0!==a&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=a),r&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=r):d[2]=r),i&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=i):d[4]="".concat(i)),t.push(d))}},t}},6538:(e,t,r)=>{var n,i,a=r(4043),s=r(5193),o=r(9740).isArray;function l(e){var t=Number(e);if(!isNaN(t))return t;var r=e.toLowerCase();return"true"===r||"false"!==r&&e}function c(e,t){var r;if(n.compact){if(!i[n[e+"Key"]]&&(o(n.alwaysArray)?-1!==n.alwaysArray.indexOf(n[e+"Key"]):n.alwaysArray)&&(i[n[e+"Key"]]=[]),i[n[e+"Key"]]&&!o(i[n[e+"Key"]])&&(i[n[e+"Key"]]=[i[n[e+"Key"]]]),e+"Fn"in n&&"string"==typeof t&&(t=n[e+"Fn"](t,i)),"instruction"===e&&("instructionFn"in n||"instructionNameFn"in n))for(r in t)if(t.hasOwnProperty(r))if("instructionFn"in n)t[r]=n.instructionFn(t[r],r,i);else{var a=t[r];delete t[r],t[n.instructionNameFn(r,a,i)]=a}o(i[n[e+"Key"]])?i[n[e+"Key"]].push(t):i[n[e+"Key"]]=t}else{i[n.elementsKey]||(i[n.elementsKey]=[]);var s={};if(s[n.typeKey]=e,"instruction"===e){for(r in t)if(t.hasOwnProperty(r))break;s[n.nameKey]="instructionNameFn"in n?n.instructionNameFn(r,t,i):r,n.instructionHasAttributes?(s[n.attributesKey]=t[r][n.attributesKey],"instructionFn"in n&&(s[n.attributesKey]=n.instructionFn(s[n.attributesKey],r,i))):("instructionFn"in n&&(t[r]=n.instructionFn(t[r],r,i)),s[n.instructionKey]=t[r])}else e+"Fn"in n&&(t=n[e+"Fn"](t,i)),s[n[e+"Key"]]=t;n.addParent&&(s[n.parentKey]=i),i[n.elementsKey].push(s)}}function d(e){var t;if("attributesFn"in n&&e&&(e=n.attributesFn(e,i)),(n.trim||"attributeValueFn"in n||"attributeNameFn"in n||n.nativeTypeAttributes)&&e)for(t in e)if(e.hasOwnProperty(t)&&(n.trim&&(e[t]=e[t].trim()),n.nativeTypeAttributes&&(e[t]=l(e[t])),"attributeValueFn"in n&&(e[t]=n.attributeValueFn(e[t],t,i)),"attributeNameFn"in n)){var r=e[t];delete e[t],e[n.attributeNameFn(t,e[t],i)]=r}return e}function u(e){var t={};if(e.body&&("xml"===e.name.toLowerCase()||n.instructionHasAttributes)){for(var r,a=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g;null!==(r=a.exec(e.body));)t[r[1]]=r[2]||r[3]||r[4];t=d(t)}if("xml"===e.name.toLowerCase()){if(n.ignoreDeclaration)return;i[n.declarationKey]={},Object.keys(t).length&&(i[n.declarationKey][n.attributesKey]=t),n.addParent&&(i[n.declarationKey][n.parentKey]=i)}else{if(n.ignoreInstruction)return;n.trim&&(e.body=e.body.trim());var s={};n.instructionHasAttributes&&Object.keys(t).length?(s[e.name]={},s[e.name][n.attributesKey]=t):s[e.name]=e.body,c("instruction",s)}}function p(e,t){var r;if("object"==typeof e&&(t=e.attributes,e=e.name),t=d(t),"elementNameFn"in n&&(e=n.elementNameFn(e,i)),n.compact){var a;if(r={},!n.ignoreAttributes&&t&&Object.keys(t).length)for(a in r[n.attributesKey]={},t)t.hasOwnProperty(a)&&(r[n.attributesKey][a]=t[a]);!(e in i)&&(o(n.alwaysArray)?-1!==n.alwaysArray.indexOf(e):n.alwaysArray)&&(i[e]=[]),i[e]&&!o(i[e])&&(i[e]=[i[e]]),o(i[e])?i[e].push(r):i[e]=r}else i[n.elementsKey]||(i[n.elementsKey]=[]),(r={})[n.typeKey]="element",r[n.nameKey]=e,!n.ignoreAttributes&&t&&Object.keys(t).length&&(r[n.attributesKey]=t),n.alwaysChildren&&(r[n.elementsKey]=[]),i[n.elementsKey].push(r);r[n.parentKey]=i,i=r}function h(e){n.ignoreText||(e.trim()||n.captureSpacesBetweenElements)&&(n.trim&&(e=e.trim()),n.nativeType&&(e=l(e)),n.sanitize&&(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),c("text",e))}function f(e){n.ignoreComment||(n.trim&&(e=e.trim()),c("comment",e))}function m(e){var t=i[n.parentKey];n.addParent||delete i[n.parentKey],i=t}function g(e){n.ignoreCdata||(n.trim&&(e=e.trim()),c("cdata",e))}function _(e){n.ignoreDoctype||(e=e.replace(/^ /,""),n.trim&&(e=e.trim()),c("doctype",e))}function b(e){e.note=e}e.exports=function(e,t){var r=a.parser(!0,{}),o={};if(i=o,n=function(e){return n=s.copyOptions(e),s.ensureFlagExists("ignoreDeclaration",n),s.ensureFlagExists("ignoreInstruction",n),s.ensureFlagExists("ignoreAttributes",n),s.ensureFlagExists("ignoreText",n),s.ensureFlagExists("ignoreComment",n),s.ensureFlagExists("ignoreCdata",n),s.ensureFlagExists("ignoreDoctype",n),s.ensureFlagExists("compact",n),s.ensureFlagExists("alwaysChildren",n),s.ensureFlagExists("addParent",n),s.ensureFlagExists("trim",n),s.ensureFlagExists("nativeType",n),s.ensureFlagExists("nativeTypeAttributes",n),s.ensureFlagExists("sanitize",n),s.ensureFlagExists("instructionHasAttributes",n),s.ensureFlagExists("captureSpacesBetweenElements",n),s.ensureAlwaysArrayExists(n),s.ensureKeyExists("declaration",n),s.ensureKeyExists("instruction",n),s.ensureKeyExists("attributes",n),s.ensureKeyExists("text",n),s.ensureKeyExists("comment",n),s.ensureKeyExists("cdata",n),s.ensureKeyExists("doctype",n),s.ensureKeyExists("type",n),s.ensureKeyExists("name",n),s.ensureKeyExists("elements",n),s.ensureKeyExists("parent",n),s.checkFnExists("doctype",n),s.checkFnExists("instruction",n),s.checkFnExists("cdata",n),s.checkFnExists("comment",n),s.checkFnExists("text",n),s.checkFnExists("instructionName",n),s.checkFnExists("elementName",n),s.checkFnExists("attributeName",n),s.checkFnExists("attributeValue",n),s.checkFnExists("attributes",n),n}(t),r.opt={strictEntities:!0},r.onopentag=p,r.ontext=h,r.oncomment=f,r.onclosetag=m,r.onerror=b,r.oncdata=g,r.ondoctype=_,r.onprocessinginstruction=u,r.write(e).close(),o[n.elementsKey]){var l=o[n.elementsKey];delete o[n.elementsKey],o[n.elementsKey]=l,delete o.text}return o}},6690:(e,t,r)=>{var n,i,a=r(4043),s=r(5969),o=r(6100).isArray;function l(e){var t=Number(e);if(!isNaN(t))return t;var r=e.toLowerCase();return"true"===r||"false"!==r&&e}function c(e,t){var r;if(n.compact){if(!i[n[e+"Key"]]&&(o(n.alwaysArray)?-1!==n.alwaysArray.indexOf(n[e+"Key"]):n.alwaysArray)&&(i[n[e+"Key"]]=[]),i[n[e+"Key"]]&&!o(i[n[e+"Key"]])&&(i[n[e+"Key"]]=[i[n[e+"Key"]]]),e+"Fn"in n&&"string"==typeof t&&(t=n[e+"Fn"](t,i)),"instruction"===e&&("instructionFn"in n||"instructionNameFn"in n))for(r in t)if(t.hasOwnProperty(r))if("instructionFn"in n)t[r]=n.instructionFn(t[r],r,i);else{var a=t[r];delete t[r],t[n.instructionNameFn(r,a,i)]=a}o(i[n[e+"Key"]])?i[n[e+"Key"]].push(t):i[n[e+"Key"]]=t}else{i[n.elementsKey]||(i[n.elementsKey]=[]);var s={};if(s[n.typeKey]=e,"instruction"===e){for(r in t)if(t.hasOwnProperty(r))break;s[n.nameKey]="instructionNameFn"in n?n.instructionNameFn(r,t,i):r,n.instructionHasAttributes?(s[n.attributesKey]=t[r][n.attributesKey],"instructionFn"in n&&(s[n.attributesKey]=n.instructionFn(s[n.attributesKey],r,i))):("instructionFn"in n&&(t[r]=n.instructionFn(t[r],r,i)),s[n.instructionKey]=t[r])}else e+"Fn"in n&&(t=n[e+"Fn"](t,i)),s[n[e+"Key"]]=t;n.addParent&&(s[n.parentKey]=i),i[n.elementsKey].push(s)}}function d(e){var t;if("attributesFn"in n&&e&&(e=n.attributesFn(e,i)),(n.trim||"attributeValueFn"in n||"attributeNameFn"in n||n.nativeTypeAttributes)&&e)for(t in e)if(e.hasOwnProperty(t)&&(n.trim&&(e[t]=e[t].trim()),n.nativeTypeAttributes&&(e[t]=l(e[t])),"attributeValueFn"in n&&(e[t]=n.attributeValueFn(e[t],t,i)),"attributeNameFn"in n)){var r=e[t];delete e[t],e[n.attributeNameFn(t,e[t],i)]=r}return e}function u(e){var t={};if(e.body&&("xml"===e.name.toLowerCase()||n.instructionHasAttributes)){for(var r,a=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g;null!==(r=a.exec(e.body));)t[r[1]]=r[2]||r[3]||r[4];t=d(t)}if("xml"===e.name.toLowerCase()){if(n.ignoreDeclaration)return;i[n.declarationKey]={},Object.keys(t).length&&(i[n.declarationKey][n.attributesKey]=t),n.addParent&&(i[n.declarationKey][n.parentKey]=i)}else{if(n.ignoreInstruction)return;n.trim&&(e.body=e.body.trim());var s={};n.instructionHasAttributes&&Object.keys(t).length?(s[e.name]={},s[e.name][n.attributesKey]=t):s[e.name]=e.body,c("instruction",s)}}function p(e,t){var r;if("object"==typeof e&&(t=e.attributes,e=e.name),t=d(t),"elementNameFn"in n&&(e=n.elementNameFn(e,i)),n.compact){var a;if(r={},!n.ignoreAttributes&&t&&Object.keys(t).length)for(a in r[n.attributesKey]={},t)t.hasOwnProperty(a)&&(r[n.attributesKey][a]=t[a]);!(e in i)&&(o(n.alwaysArray)?-1!==n.alwaysArray.indexOf(e):n.alwaysArray)&&(i[e]=[]),i[e]&&!o(i[e])&&(i[e]=[i[e]]),o(i[e])?i[e].push(r):i[e]=r}else i[n.elementsKey]||(i[n.elementsKey]=[]),(r={})[n.typeKey]="element",r[n.nameKey]=e,!n.ignoreAttributes&&t&&Object.keys(t).length&&(r[n.attributesKey]=t),n.alwaysChildren&&(r[n.elementsKey]=[]),i[n.elementsKey].push(r);r[n.parentKey]=i,i=r}function h(e){n.ignoreText||(e.trim()||n.captureSpacesBetweenElements)&&(n.trim&&(e=e.trim()),n.nativeType&&(e=l(e)),n.sanitize&&(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),c("text",e))}function f(e){n.ignoreComment||(n.trim&&(e=e.trim()),c("comment",e))}function m(e){var t=i[n.parentKey];n.addParent||delete i[n.parentKey],i=t}function g(e){n.ignoreCdata||(n.trim&&(e=e.trim()),c("cdata",e))}function _(e){n.ignoreDoctype||(e=e.replace(/^ /,""),n.trim&&(e=e.trim()),c("doctype",e))}function b(e){e.note=e}e.exports=function(e,t){var r=a.parser(!0,{}),o={};if(i=o,n=function(e){return n=s.copyOptions(e),s.ensureFlagExists("ignoreDeclaration",n),s.ensureFlagExists("ignoreInstruction",n),s.ensureFlagExists("ignoreAttributes",n),s.ensureFlagExists("ignoreText",n),s.ensureFlagExists("ignoreComment",n),s.ensureFlagExists("ignoreCdata",n),s.ensureFlagExists("ignoreDoctype",n),s.ensureFlagExists("compact",n),s.ensureFlagExists("alwaysChildren",n),s.ensureFlagExists("addParent",n),s.ensureFlagExists("trim",n),s.ensureFlagExists("nativeType",n),s.ensureFlagExists("nativeTypeAttributes",n),s.ensureFlagExists("sanitize",n),s.ensureFlagExists("instructionHasAttributes",n),s.ensureFlagExists("captureSpacesBetweenElements",n),s.ensureAlwaysArrayExists(n),s.ensureKeyExists("declaration",n),s.ensureKeyExists("instruction",n),s.ensureKeyExists("attributes",n),s.ensureKeyExists("text",n),s.ensureKeyExists("comment",n),s.ensureKeyExists("cdata",n),s.ensureKeyExists("doctype",n),s.ensureKeyExists("type",n),s.ensureKeyExists("name",n),s.ensureKeyExists("elements",n),s.ensureKeyExists("parent",n),s.checkFnExists("doctype",n),s.checkFnExists("instruction",n),s.checkFnExists("cdata",n),s.checkFnExists("comment",n),s.checkFnExists("text",n),s.checkFnExists("instructionName",n),s.checkFnExists("elementName",n),s.checkFnExists("attributeName",n),s.checkFnExists("attributeValue",n),s.checkFnExists("attributes",n),n}(t),r.opt={strictEntities:!0},r.onopentag=p,r.ontext=h,r.oncomment=f,r.onclosetag=m,r.onerror=b,r.oncdata=g,r.ondoctype=_,r.onprocessinginstruction=u,r.write(e).close(),o[n.elementsKey]){var l=o[n.elementsKey];delete o[n.elementsKey],o[n.elementsKey]=l,delete o.text}return o}},6867:(e,t,r)=>{r.d(t,{A:()=>T});var n=r(1601),i=r.n(n),a=r(6314),s=r.n(a),o=r(4417),l=r.n(o),c=new URL(r(4973),r.b),d=new URL(r(1026),r.b),u=new URL(r(3803),r.b),p=new URL(r(8626),r.b),h=new URL(r(7838),r.b),f=new URL(r(3167),r.b),m=new URL(r(7283),r.b),g=s()(i()),_=l()(c),b=l()(d),v=l()(u),y=l()(p),w=l()(h),E=l()(f),S=l()(m);g.push([e.id,`@charset "UTF-8";.uppy-Informer{bottom:60px;left:0;position:absolute;right:0;text-align:center;z-index:1005}.uppy-Informer span>div{margin-bottom:6px}.uppy-Informer-animated{opacity:0;transform:translateY(350%);transition:all .3s ease-in;z-index:-1000}.uppy-Informer p{background-color:#757575;border-radius:18px;color:#fff;display:inline-block;font-size:12px;font-weight:400;line-height:1.4;margin:0;max-width:90%;padding:6px 15px}.uppy-size--md .uppy-Informer p{font-size:14px;line-height:1.3;max-width:500px;padding:10px 20px}[data-uppy-theme=dark] .uppy-Informer p{background-color:#333}[dir=ltr] .uppy-Informer p span{left:3px}[dir=rtl] .uppy-Informer p span{right:3px}[dir=ltr] .uppy-Informer p span{margin-left:-1px}[dir=rtl] .uppy-Informer p span{margin-right:-1px}.uppy-Informer p span{background-color:#fff;border-radius:50%;color:#525252;display:inline-block;font-size:10px;height:13px;line-height:12px;position:relative;top:-1px;vertical-align:middle;width:13px}.uppy-Informer p span:hover{cursor:help}.uppy-Informer p span:after{line-height:1.3;word-wrap:break-word}.uppy-Root [aria-label][role~=tooltip]{position:relative}.uppy-Root [aria-label][role~=tooltip]:after,.uppy-Root [aria-label][role~=tooltip]:before{-webkit-backface-visibility:hidden;backface-visibility:hidden;box-sizing:border-box;opacity:0;pointer-events:none;position:absolute;transform:translateZ(0);transform-origin:top;transition:all var(--microtip-transition-duration,.18s) var(--microtip-transition-easing,ease-in-out) var(--microtip-transition-delay,0s);will-change:transform;z-index:10}.uppy-Root [aria-label][role~=tooltip]:before{background-size:100% auto!important;content:""}.uppy-Root [aria-label][role~=tooltip]:after{background:#111111e6;border-radius:4px;box-sizing:initial;color:#fff;content:attr(aria-label);font-size:var(--microtip-font-size,13px);font-weight:var(--microtip-font-weight,normal);padding:.5em 1em;text-transform:var(--microtip-text-transform,none);white-space:nowrap}.uppy-Root [aria-label][role~=tooltip]:focus:after,.uppy-Root [aria-label][role~=tooltip]:focus:before,.uppy-Root [aria-label][role~=tooltip]:hover:after,.uppy-Root [aria-label][role~=tooltip]:hover:before{opacity:1;pointer-events:auto}.uppy-Root [role~=tooltip][data-microtip-position|=top]:before{background:url(${_}) no-repeat;bottom:100%;height:6px;left:50%;margin-bottom:5px;transform:translate3d(-50%,0,0);width:18px}.uppy-Root [role~=tooltip][data-microtip-position|=top]:after{bottom:100%;left:50%;margin-bottom:11px;transform:translate3d(-50%,0,0)}.uppy-Root [role~=tooltip][data-microtip-position=top]:hover:after,.uppy-Root [role~=tooltip][data-microtip-position|=top]:hover:before{transform:translate3d(-50%,-5px,0)}.uppy-Root [role~=tooltip][data-microtip-position=top-left]:after{bottom:100%;transform:translate3d(calc(-100% + 16px),0,0)}.uppy-Root [role~=tooltip][data-microtip-position=top-left]:hover:after{transform:translate3d(calc(-100% + 16px),-5px,0)}.uppy-Root [role~=tooltip][data-microtip-position=top-right]:after{bottom:100%;transform:translate3d(-16px,0,0)}.uppy-Root [role~=tooltip][data-microtip-position=top-right]:hover:after{transform:translate3d(-16px,-5px,0)}.uppy-Root [role~=tooltip][data-microtip-position|=bottom]:before{background:url(${b}) no-repeat;bottom:auto;height:6px;left:50%;margin-bottom:0;margin-top:5px;top:100%;transform:translate3d(-50%,-10px,0);width:18px}.uppy-Root [role~=tooltip][data-microtip-position|=bottom]:after{left:50%;margin-top:11px;top:100%;transform:translate3d(-50%,-10px,0)}.uppy-Root [role~=tooltip][data-microtip-position=bottom]:hover:after,.uppy-Root [role~=tooltip][data-microtip-position|=bottom]:hover:before{transform:translate3d(-50%,0,0)}.uppy-Root [role~=tooltip][data-microtip-position=bottom-left]:after{top:100%;transform:translate3d(calc(-100% + 16px),-10px,0)}.uppy-Root [role~=tooltip][data-microtip-position=bottom-left]:hover:after{transform:translate3d(calc(-100% + 16px),0,0)}.uppy-Root [role~=tooltip][data-microtip-position=bottom-right]:after{top:100%;transform:translate3d(-16px,-10px,0)}.uppy-Root [role~=tooltip][data-microtip-position=bottom-right]:hover:after{transform:translate3d(-16px,0,0)}.uppy-Root [role~=tooltip][data-microtip-position=left]:after,.uppy-Root [role~=tooltip][data-microtip-position=left]:before{bottom:auto;left:auto;right:100%;top:50%;transform:translate3d(10px,-50%,0)}.uppy-Root [role~=tooltip][data-microtip-position=left]:before{background:url(${v}) no-repeat;height:18px;margin-bottom:0;margin-right:5px;width:6px}.uppy-Root [role~=tooltip][data-microtip-position=left]:after{margin-right:11px}.uppy-Root [role~=tooltip][data-microtip-position=left]:hover:after,.uppy-Root [role~=tooltip][data-microtip-position=left]:hover:before{transform:translate3d(0,-50%,0)}.uppy-Root [role~=tooltip][data-microtip-position=right]:after,.uppy-Root [role~=tooltip][data-microtip-position=right]:before{bottom:auto;left:100%;top:50%;transform:translate3d(-10px,-50%,0)}.uppy-Root [role~=tooltip][data-microtip-position=right]:before{background:url(${y}) no-repeat;height:18px;margin-bottom:0;margin-left:5px;width:6px}.uppy-Root [role~=tooltip][data-microtip-position=right]:after{margin-left:11px}.uppy-Root [role~=tooltip][data-microtip-position=right]:hover:after,.uppy-Root [role~=tooltip][data-microtip-position=right]:hover:before{transform:translate3d(0,-50%,0)}.uppy-Root [role~=tooltip][data-microtip-size=small]:after{white-space:normal;width:80px}.uppy-Root [role~=tooltip][data-microtip-size=medium]:after{white-space:normal;width:150px}.uppy-Root [role~=tooltip][data-microtip-size=large]:after{white-space:normal;width:260px}.uppy-StatusBar{background-color:#fff;color:#fff;display:flex;font-size:12px;font-weight:400;height:46px;line-height:40px;position:relative;transition:height .2s;z-index:1001}[data-uppy-theme=dark] .uppy-StatusBar{background-color:#1f1f1f}.uppy-StatusBar:before{background-color:#eaeaea;bottom:0;content:"";height:2px;left:0;position:absolute;right:0;top:0;width:100%}[data-uppy-theme=dark] .uppy-StatusBar:before{background-color:#757575}.uppy-StatusBar[aria-hidden=true]{height:0;overflow-y:hidden}.uppy-StatusBar.is-complete .uppy-StatusBar-progress{background-color:#1bb240}.uppy-StatusBar.is-error .uppy-StatusBar-progress{background-color:#e32437}.uppy-StatusBar.is-complete .uppy-StatusBar-statusIndicator{color:#1bb240}.uppy-StatusBar.is-error .uppy-StatusBar-statusIndicator{color:#e32437}.uppy-StatusBar:not([aria-hidden=true]).is-waiting{background-color:#fff;border-top:1px solid #eaeaea;height:65px}[data-uppy-theme=dark] .uppy-StatusBar:not([aria-hidden=true]).is-waiting{background-color:#1f1f1f;border-top:1px solid #333}.uppy-StatusBar-progress{background-color:#1269cf;height:2px;position:absolute;transition:background-color,width .3s ease-out;z-index:1001}.uppy-StatusBar-progress.is-indeterminate{animation:uppy-StatusBar-ProgressStripes 1s linear infinite;background-image:linear-gradient(45deg,#0000004d 25%,#0000 0,#0000 50%,#0000004d 0,#0000004d 75%,#0000 0,#0000);background-size:64px 64px}@keyframes uppy-StatusBar-ProgressStripes{0%{background-position:0 0}to{background-position:64px 0}}.uppy-StatusBar.is-postprocessing .uppy-StatusBar-progress,.uppy-StatusBar.is-preprocessing .uppy-StatusBar-progress{background-color:#f6a623}.uppy-StatusBar.is-waiting .uppy-StatusBar-progress{display:none}[dir=ltr] .uppy-StatusBar-content{padding-left:10px}[dir=rtl] .uppy-StatusBar-content{padding-right:10px}.uppy-StatusBar-content{align-items:center;color:#333;display:flex;height:100%;position:relative;text-overflow:ellipsis;white-space:nowrap;z-index:1002}[dir=ltr] .uppy-size--md .uppy-StatusBar-content{padding-left:15px}[dir=rtl] .uppy-size--md .uppy-StatusBar-content{padding-right:15px}[data-uppy-theme=dark] .uppy-StatusBar-content{color:#eaeaea}[dir=ltr] .uppy-StatusBar-status{padding-right:.3em}[dir=rtl] .uppy-StatusBar-status{padding-left:.3em}.uppy-StatusBar-status{display:flex;flex-direction:column;font-weight:400;justify-content:center;line-height:1.4}.uppy-StatusBar-statusPrimary{display:flex;font-weight:500;line-height:1}.uppy-StatusBar-statusPrimary button.uppy-StatusBar-details{margin-left:5px}[data-uppy-theme=dark] .uppy-StatusBar-statusPrimary{color:#eaeaea}.uppy-StatusBar-statusSecondary{color:#757575;display:inline-block;font-size:11px;line-height:1.2;margin-top:1px;white-space:nowrap}[data-uppy-theme=dark] .uppy-StatusBar-statusSecondary{color:#bbb}[dir=ltr] .uppy-StatusBar-statusSecondaryHint{margin-right:5px}[dir=rtl] .uppy-StatusBar-statusSecondaryHint{margin-left:5px}.uppy-StatusBar-statusSecondaryHint{display:inline-block;line-height:1;vertical-align:middle}[dir=ltr] .uppy-size--md .uppy-StatusBar-statusSecondaryHint{margin-right:8px}[dir=rtl] .uppy-size--md .uppy-StatusBar-statusSecondaryHint{margin-left:8px}[dir=ltr] .uppy-StatusBar-statusIndicator{margin-right:7px}[dir=rtl] .uppy-StatusBar-statusIndicator{margin-left:7px}.uppy-StatusBar-statusIndicator{color:#525252;position:relative;top:1px}.uppy-StatusBar-statusIndicator svg{vertical-align:text-bottom}[dir=ltr] .uppy-StatusBar-actions{right:10px}[dir=rtl] .uppy-StatusBar-actions{left:10px}.uppy-StatusBar-actions{align-items:center;bottom:0;display:flex;position:absolute;top:0;z-index:1004}.uppy-StatusBar.is-waiting .uppy-StatusBar-actions{background-color:#fafafa;height:100%;padding:0 15px;position:static;width:100%}[data-uppy-theme=dark] .uppy-StatusBar.is-waiting .uppy-StatusBar-actions{background-color:#1f1f1f}.uppy-StatusBar:not([aria-hidden=true]).is-waiting.has-ghosts{flex-direction:column;height:90px}.uppy-size--md .uppy-StatusBar:not([aria-hidden=true]).is-waiting.has-ghosts{flex-direction:row;height:65px}.uppy-StatusBar:not([aria-hidden=true]).is-waiting.has-ghosts .uppy-StatusBar-actions{flex-direction:column;justify-content:center}.uppy-size--md .uppy-StatusBar:not([aria-hidden=true]).is-waiting.has-ghosts .uppy-StatusBar-actions{flex-direction:row;justify-content:normal}.uppy-StatusBar-actionCircleBtn{cursor:pointer;line-height:1;margin:3px;opacity:.9}.uppy-StatusBar-actionCircleBtn:focus{outline:none}.uppy-StatusBar-actionCircleBtn::-moz-focus-inner{border:0}.uppy-StatusBar-actionCircleBtn:focus{box-shadow:0 0 0 3px #1269cf80}[data-uppy-theme=dark] .uppy-StatusBar-actionCircleBtn:focus{outline:none}[data-uppy-theme=dark] .uppy-StatusBar-actionCircleBtn::-moz-focus-inner{border:0}[data-uppy-theme=dark] .uppy-StatusBar-actionCircleBtn:focus{box-shadow:0 0 0 2px #aae1ffd9}.uppy-StatusBar-actionCircleBtn:hover{opacity:1}.uppy-StatusBar-actionCircleBtn:focus{border-radius:50%}.uppy-StatusBar-actionCircleBtn svg{vertical-align:bottom}.uppy-StatusBar-actionBtn{color:#1269cf;display:inline-block;font-size:10px;line-height:inherit;vertical-align:middle}.uppy-size--md .uppy-StatusBar-actionBtn{font-size:11px}.uppy-StatusBar-actionBtn--disabled{opacity:.4}[data-uppy-theme=dark] .uppy-StatusBar-actionBtn--disabled{opacity:.7}[dir=ltr] .uppy-StatusBar-actionBtn--retry{margin-right:6px}[dir=rtl] .uppy-StatusBar-actionBtn--retry{margin-left:6px}.uppy-StatusBar-actionBtn--retry{background-color:#ff4b23;border-radius:8px;color:#fff;height:16px;line-height:1;padding:1px 6px 3px 18px;position:relative}.uppy-StatusBar-actionBtn--retry:focus{outline:none}.uppy-StatusBar-actionBtn--retry::-moz-focus-inner{border:0}.uppy-StatusBar-actionBtn--retry:focus{box-shadow:0 0 0 3px #1269cf80}[data-uppy-theme=dark] .uppy-StatusBar-actionBtn--retry:focus{outline:none}[data-uppy-theme=dark] .uppy-StatusBar-actionBtn--retry::-moz-focus-inner{border:0}[data-uppy-theme=dark] .uppy-StatusBar-actionBtn--retry:focus{box-shadow:0 0 0 2px #aae1ffd9}.uppy-StatusBar-actionBtn--retry:hover{background-color:#f92d00}[dir=ltr] .uppy-StatusBar-actionBtn--retry svg{left:6px}[dir=rtl] .uppy-StatusBar-actionBtn--retry svg{right:6px}.uppy-StatusBar-actionBtn--retry svg{position:absolute;top:3px}.uppy-StatusBar.is-waiting .uppy-StatusBar-actionBtn--upload{background-color:#1bb240;color:#fff;font-size:14px;line-height:1;padding:15px 10px;width:100%}.uppy-StatusBar.is-waiting .uppy-StatusBar-actionBtn--upload:hover{background-color:#189c38}[data-uppy-theme=dark] .uppy-StatusBar.is-waiting .uppy-StatusBar-actionBtn--upload{background-color:#1c8b37}[data-uppy-theme=dark] .uppy-StatusBar.is-waiting .uppy-StatusBar-actionBtn--upload:hover{background-color:#18762f}.uppy-size--md .uppy-StatusBar.is-waiting .uppy-StatusBar-actionBtn--upload{padding:13px 22px;width:auto}.uppy-StatusBar.is-waiting .uppy-StatusBar-actionBtn--upload.uppy-StatusBar-actionBtn--disabled:hover{background-color:#1bb240;cursor:not-allowed}[data-uppy-theme=dark] .uppy-StatusBar.is-waiting .uppy-StatusBar-actionBtn--upload.uppy-StatusBar-actionBtn--disabled:hover{background-color:#1c8b37}.uppy-StatusBar:not(.is-waiting) .uppy-StatusBar-actionBtn--upload{background-color:initial;color:#1269cf}[dir=ltr] .uppy-StatusBar-actionBtn--uploadNewlyAdded{padding-right:3px}[dir=ltr] .uppy-StatusBar-actionBtn--uploadNewlyAdded,[dir=rtl] .uppy-StatusBar-actionBtn--uploadNewlyAdded{padding-left:3px}[dir=rtl] .uppy-StatusBar-actionBtn--uploadNewlyAdded{padding-right:3px}.uppy-StatusBar-actionBtn--uploadNewlyAdded{border-radius:3px;padding-bottom:1px}.uppy-StatusBar-actionBtn--uploadNewlyAdded:focus{outline:none}.uppy-StatusBar-actionBtn--uploadNewlyAdded::-moz-focus-inner{border:0}.uppy-StatusBar-actionBtn--uploadNewlyAdded:focus{box-shadow:0 0 0 3px #1269cf80}[data-uppy-theme=dark] .uppy-StatusBar-actionBtn--uploadNewlyAdded:focus{outline:none}[data-uppy-theme=dark] .uppy-StatusBar-actionBtn--uploadNewlyAdded::-moz-focus-inner{border:0}[data-uppy-theme=dark] .uppy-StatusBar-actionBtn--uploadNewlyAdded:focus{box-shadow:0 0 0 2px #aae1ffd9}.uppy-StatusBar.is-postprocessing .uppy-StatusBar-actionBtn--uploadNewlyAdded,.uppy-StatusBar.is-preprocessing .uppy-StatusBar-actionBtn--uploadNewlyAdded{display:none}.uppy-StatusBar-actionBtn--done{border-radius:3px;line-height:1;padding:7px 8px}.uppy-StatusBar-actionBtn--done:focus{outline:none}.uppy-StatusBar-actionBtn--done::-moz-focus-inner{border:0}.uppy-StatusBar-actionBtn--done:hover{color:#0e51a0}.uppy-StatusBar-actionBtn--done:focus{background-color:#dfe6f1}[data-uppy-theme=dark] .uppy-StatusBar-actionBtn--done:focus{background-color:#333}[data-uppy-theme=dark] .uppy-StatusBar-actionBtn--done{color:#02baf2}.uppy-size--md .uppy-StatusBar-actionBtn--done{font-size:14px}.uppy-StatusBar-serviceMsg{color:#000;font-size:11px;line-height:1.1;padding-left:10px}.uppy-size--md .uppy-StatusBar-serviceMsg{font-size:14px;padding-left:15px}[data-uppy-theme=dark] .uppy-StatusBar-serviceMsg{color:#eaeaea}.uppy-StatusBar-serviceMsg-ghostsIcon{left:6px;opacity:.5;position:relative;top:2px;vertical-align:text-bottom;width:10px}.uppy-size--md .uppy-StatusBar-serviceMsg-ghostsIcon{left:10px;top:1px;width:15px}[dir=ltr] .uppy-StatusBar-details{left:2px}[dir=rtl] .uppy-StatusBar-details{right:2px}.uppy-StatusBar-details{-webkit-appearance:none;appearance:none;background-color:#939393;border-radius:50%;color:#fff;cursor:help;display:inline-block;font-size:10px;font-weight:600;height:13px;line-height:12px;position:relative;text-align:center;top:0;vertical-align:middle;width:13px}.uppy-StatusBar-details:after{line-height:1.3;word-wrap:break-word}[dir=ltr] .uppy-StatusBar-spinner{margin-right:10px}[dir=rtl] .uppy-StatusBar-spinner{margin-left:10px}.uppy-StatusBar-spinner{animation-duration:1s;animation-iteration-count:infinite;animation-name:uppy-StatusBar-spinnerAnimation;animation-timing-function:linear;fill:#1269cf}.uppy-StatusBar.is-postprocessing .uppy-StatusBar-spinner,.uppy-StatusBar.is-preprocessing .uppy-StatusBar-spinner{fill:#f6a623}@keyframes uppy-StatusBar-spinnerAnimation{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.uppy-ProviderBrowser-viewType--grid ul.uppy-ProviderBrowser-list,.uppy-ProviderBrowser-viewType--unsplash ul.uppy-ProviderBrowser-list{align-items:flex-start;display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-between;padding:6px}.uppy-ProviderBrowser-viewType--grid ul.uppy-ProviderBrowser-list:after,.uppy-ProviderBrowser-viewType--unsplash ul.uppy-ProviderBrowser-list:after{content:"";flex:auto}.uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem,.uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem{margin:0;position:relative;width:50%}.uppy-size--md .uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem,.uppy-size--md .uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem{width:33.3333%}.uppy-size--lg .uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem,.uppy-size--lg .uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem{width:25%}.uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem:before,.uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem:before{content:"";display:block;padding-top:100%}.uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem--selected img,.uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem--selected svg,.uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem--selected img,.uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem--selected svg{opacity:.85}.uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem--disabled,.uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem--disabled{opacity:.5}.uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem--noPreview .uppy-ProviderBrowserItem-inner,.uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem--noPreview .uppy-ProviderBrowserItem-inner{background-color:#93939333}[data-uppy-theme=dark] .uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem--noPreview .uppy-ProviderBrowserItem-inner,[data-uppy-theme=dark] .uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem--noPreview .uppy-ProviderBrowserItem-inner{background-color:#eaeaea33}.uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem--noPreview svg,.uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem--noPreview svg{height:30%;width:30%;fill:#000000b3}[data-uppy-theme=dark] .uppy-ProviderBrowser-viewType--grid li.uppy-ProviderBrowserItem--noPreview svg,[data-uppy-theme=dark] .uppy-ProviderBrowser-viewType--unsplash li.uppy-ProviderBrowserItem--noPreview svg{fill:#fffc}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-inner,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-inner{border-radius:4px;bottom:7px;height:calc(100% - 14px);left:7px;overflow:hidden;position:absolute;right:7px;text-align:center;top:7px;width:calc(100% - 14px)}@media (hover:none){.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-inner .uppy-ProviderBrowserItem-author,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-inner .uppy-ProviderBrowserItem-author{display:block}}[data-uppy-theme=dark] .uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-inner,[data-uppy-theme=dark] .uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-inner{box-shadow:0 0 0 3px #aae1ffb3}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-inner img,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-inner img{border-radius:4px;height:100%;object-fit:cover;width:100%}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-author,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-author{background:#0000004d;bottom:0;color:#fff;display:none;font-size:12px;font-weight:500;left:0;margin:0;padding:5px;position:absolute;text-decoration:none;width:100%}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-author:hover,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-author:hover{background:#0006;text-decoration:underline}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox{background-color:#1269cf;border-radius:50%;height:26px;opacity:0;position:absolute;right:16px;top:16px;width:26px;z-index:1002}[dir=ltr] .uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox:after,[dir=ltr] .uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox:after{left:7px}[dir=rtl] .uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox:after,[dir=rtl] .uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox:after{right:7px}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox:after,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox:after{height:7px;top:8px;width:12px}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem--is-checked .uppy-ProviderBrowserItem-checkbox,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem--is-checked .uppy-ProviderBrowserItem-checkbox{opacity:1}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox--grid:focus+label .uppy-ProviderBrowserItem-author,.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox--grid:hover+label .uppy-ProviderBrowserItem-author,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox--grid:focus+label .uppy-ProviderBrowserItem-author,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox--grid:hover+label .uppy-ProviderBrowserItem-author{display:block}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox--grid:focus+label,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox--grid:focus+label{box-shadow:0 0 0 3px #1269cf80}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox--grid:focus+label:focus,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox--grid:focus+label:focus{outline:none}.uppy-ProviderBrowser-viewType--grid .uppy-ProviderBrowserItem-checkbox--grid:focus+label::-moz-focus-inner,.uppy-ProviderBrowser-viewType--unsplash .uppy-ProviderBrowserItem-checkbox--grid:focus+label::-moz-focus-inner{border:0}.uppy-ProviderBrowser-viewType--list{background-color:#fff}[data-uppy-theme=dark] .uppy-ProviderBrowser-viewType--list{background-color:#1f1f1f}.uppy-ProviderBrowser-viewType--list li.uppy-ProviderBrowserItem{align-items:center;display:flex;margin:0;padding:7px 15px}[data-uppy-theme=dark] .uppy-ProviderBrowser-viewType--list li.uppy-ProviderBrowserItem{color:#eaeaea}.uppy-ProviderBrowser-viewType--list li.uppy-ProviderBrowserItem--disabled{opacity:.6}[dir=ltr] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-checkbox{margin-right:15px}[dir=rtl] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-checkbox{margin-left:15px}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-checkbox{background-color:#fff;border:1px solid #cfcfcf;border-radius:3px;height:17px;width:17px}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-checkbox:focus{border:1px solid #1269cf;box-shadow:0 0 0 3px #1269cf40;outline:none}[dir=ltr] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-checkbox:after{left:3px}[dir=rtl] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-checkbox:after{right:3px}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-checkbox:after{height:5px;opacity:0;top:4px;width:9px}[data-uppy-theme=dark] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-checkbox:focus{border-color:#02baf2b3;box-shadow:0 0 0 3px #02baf233}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem--is-checked .uppy-ProviderBrowserItem-checkbox,.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem--is-partial .uppy-ProviderBrowserItem-checkbox{background-color:#1269cf;border-color:#1269cf}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem--is-checked .uppy-ProviderBrowserItem-checkbox:after,.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem--is-partial .uppy-ProviderBrowserItem-checkbox:after{opacity:1}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-inner{align-items:center;color:inherit;display:flex;font-family:-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Segoe UI Symbol,Segoe UI Emoji,Apple Color Emoji,Roboto,Helvetica,Arial,sans-serif;overflow:hidden;padding:2px;text-overflow:ellipsis;white-space:nowrap}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-inner:focus{outline:none;text-decoration:underline}[dir=ltr] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-inner img,[dir=ltr] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-inner svg{margin-right:8px}[dir=rtl] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-inner img,[dir=rtl] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-inner svg{margin-left:8px}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-inner span{line-height:1.2;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem--disabled .uppy-ProviderBrowserItem-inner{cursor:default}[dir=ltr] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-iconWrap{margin-right:7px}[dir=rtl] .uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-iconWrap{margin-left:7px}.uppy-ProviderBrowser-viewType--list .uppy-ProviderBrowserItem-iconWrap{width:20px}.uppy-ProviderBrowserItem-checkbox{cursor:pointer;flex-shrink:0;position:relative}.uppy-ProviderBrowserItem-checkbox:disabled,.uppy-ProviderBrowserItem-checkbox:disabled:after{cursor:default}[data-uppy-theme=dark] .uppy-ProviderBrowserItem-checkbox{background-color:#1f1f1f;border-color:#939393}[data-uppy-theme=dark] .uppy-ProviderBrowserItem--is-checked .uppy-ProviderBrowserItem-checkbox{background-color:#333}.uppy-ProviderBrowserItem--is-checked .uppy-ProviderBrowserItem-checkbox:after{border-bottom:2px solid #eaeaea;border-left:2px solid #eaeaea;content:"";cursor:pointer;position:absolute;transform:rotate(-45deg)}.uppy-ProviderBrowserItem--is-partial .uppy-ProviderBrowserItem-checkbox:after{background-color:#eaeaea!important;content:""!important;height:2px!important;left:20%!important;position:absolute!important;right:20%!important;top:50%!important;transform:translateY(-50%)!important}.uppy-SearchProvider{align-items:center;display:flex;flex:1;flex-direction:column;height:100%;justify-content:center;width:100%}[data-uppy-theme=dark] .uppy-SearchProvider{background-color:#1f1f1f}.uppy-SearchProvider-input{margin-bottom:15px;max-width:650px;width:90%}.uppy-size--md .uppy-SearchProvider-input{margin-bottom:20px}.uppy-SearchProvider-input::-webkit-search-cancel-button{display:none}.uppy-SearchProvider-searchButton{padding:13px 25px}.uppy-size--md .uppy-SearchProvider-searchButton{padding:13px 30px}.uppy-DashboardContent-panelBody{align-items:center;display:flex;flex:1;justify-content:center}[data-uppy-theme=dark] .uppy-DashboardContent-panelBody{background-color:#1f1f1f}.uppy-Provider-auth,.uppy-Provider-empty,.uppy-Provider-error,.uppy-Provider-loading{align-items:center;color:#939393;display:flex;flex:1;flex-flow:column wrap;justify-content:center}.uppy-Provider-empty{color:#939393}.uppy-Provider-authIcon svg{height:75px;width:100px}.uppy-Provider-authTitle{color:#757575;font-size:17px;font-weight:400;line-height:1.4;margin-bottom:30px;max-width:500px;padding:0 15px;text-align:center}.uppy-size--md .uppy-Provider-authTitle{font-size:20px}[data-uppy-theme=dark] .uppy-Provider-authTitle{color:#cfcfcf}.uppy-Provider-btn-google{align-items:center;background:#4285f4;display:flex;padding:8px 12px!important}.uppy-Provider-btn-google:hover{background-color:#1266f1}.uppy-Provider-btn-google:focus{box-shadow:0 0 0 3px #4285f466;outline:none}.uppy-Provider-btn-google svg{margin-right:8px}[dir=ltr] .uppy-Provider-breadcrumbs{text-align:left}[dir=rtl] .uppy-Provider-breadcrumbs{text-align:right}.uppy-Provider-breadcrumbs{color:#525252;flex:1;font-size:12px;margin-bottom:10px}.uppy-size--md .uppy-Provider-breadcrumbs{margin-bottom:0}[data-uppy-theme=dark] .uppy-Provider-breadcrumbs{color:#eaeaea}[dir=ltr] .uppy-Provider-breadcrumbsIcon{margin-right:4px}[dir=rtl] .uppy-Provider-breadcrumbsIcon{margin-left:4px}.uppy-Provider-breadcrumbsIcon{color:#525252;display:inline-block;line-height:1;vertical-align:middle}.uppy-Provider-breadcrumbsIcon svg{height:13px;width:13px;fill:#525252}.uppy-Provider-breadcrumbs button{border-radius:3px;display:inline-block;line-height:inherit;padding:4px}.uppy-Provider-breadcrumbs button:focus{outline:none}.uppy-Provider-breadcrumbs button::-moz-focus-inner{border:0}.uppy-Provider-breadcrumbs button:hover{color:#0e51a0}.uppy-Provider-breadcrumbs button:focus{background-color:#dfe6f1}[data-uppy-theme=dark] .uppy-Provider-breadcrumbs button:focus{background-color:#333}.uppy-Provider-breadcrumbs button:not(:last-of-type){text-decoration:underline}.uppy-Provider-breadcrumbs button:last-of-type{color:#333;cursor:normal;font-weight:500;pointer-events:none}.uppy-Provider-breadcrumbs button:hover{cursor:pointer}[data-uppy-theme=dark] .uppy-Provider-breadcrumbs button{color:#eaeaea}.uppy-ProviderBrowser{display:flex;flex:1;flex-direction:column;font-size:14px;font-weight:400;height:100%}.uppy-ProviderBrowser-user{color:#333;font-weight:500;margin:0 8px 0 0}[data-uppy-theme=dark] .uppy-ProviderBrowser-user{color:#eaeaea}[dir=ltr] .uppy-ProviderBrowser-user:after{left:4px}[dir=rtl] .uppy-ProviderBrowser-user:after{right:4px}.uppy-ProviderBrowser-user:after{color:#939393;content:"Â·";font-weight:400;position:relative}.uppy-ProviderBrowser-header{border-bottom:1px solid #eaeaea;position:relative;z-index:1001}[data-uppy-theme=dark] .uppy-ProviderBrowser-header{border-bottom:1px solid #333}.uppy-ProviderBrowser-headerBar{background-color:#fafafa;color:#757575;font-size:12px;line-height:1.4;padding:7px 15px;z-index:1001}.uppy-size--md .uppy-ProviderBrowser-headerBar{align-items:center;display:flex}[data-uppy-theme=dark] .uppy-ProviderBrowser-headerBar{background-color:#1f1f1f}.uppy-ProviderBrowser-headerBar--simple{display:block;justify-content:center;text-align:center}.uppy-ProviderBrowser-headerBar--simple .uppy-Provider-breadcrumbsWrap{display:inline-block;flex:none;vertical-align:middle}.uppy-ProviderBrowser-searchFilter{align-items:center;display:flex;height:30px;margin-bottom:15px;margin-top:15px;padding-left:8px;padding-right:8px;position:relative;width:100%}[dir=ltr] .uppy-ProviderBrowser-searchFilterInput{padding-left:30px}[dir=ltr] .uppy-ProviderBrowser-searchFilterInput,[dir=rtl] .uppy-ProviderBrowser-searchFilterInput{padding-right:30px}[dir=rtl] .uppy-ProviderBrowser-searchFilterInput{padding-left:30px}.uppy-ProviderBrowser-searchFilterInput{background-color:#eaeaea;border:0;border-radius:4px;color:#333;font-family:-apple-system,system-ui,BlinkMacSystemFont,Segoe UI,Segoe UI Symbol,Segoe UI Emoji,Apple Color Emoji,Roboto,Helvetica,Arial,sans-serif;font-size:13px;height:30px;line-height:1.4;outline:0;width:100%;z-index:1001}.uppy-ProviderBrowser-searchFilterInput::-webkit-search-cancel-button{display:none}[data-uppy-theme=dark] .uppy-ProviderBrowser-searchFilterInput{background-color:#1f1f1f;color:#eaeaea}.uppy-ProviderBrowser-searchFilterInput:focus{background-color:#cfcfcf;border:0}[data-uppy-theme=dark] .uppy-ProviderBrowser-searchFilterInput:focus{background-color:#333}[dir=ltr] .uppy-ProviderBrowser-searchFilterIcon{left:16px}[dir=rtl] .uppy-ProviderBrowser-searchFilterIcon{right:16px}.uppy-ProviderBrowser-searchFilterIcon{color:#757575;height:12px;position:absolute;width:12px;z-index:1002}.uppy-ProviderBrowser-searchFilterInput::placeholder{color:#939393;opacity:1}[dir=ltr] .uppy-ProviderBrowser-searchFilterReset{right:16px}[dir=rtl] .uppy-ProviderBrowser-searchFilterReset{left:16px}.uppy-ProviderBrowser-searchFilterReset{border-radius:3px;color:#939393;cursor:pointer;height:22px;padding:6px;position:absolute;width:22px;z-index:1002}.uppy-ProviderBrowser-searchFilterReset:focus{outline:none}.uppy-ProviderBrowser-searchFilterReset::-moz-focus-inner{border:0}.uppy-ProviderBrowser-searchFilterReset:focus{box-shadow:0 0 0 3px #1269cf80}.uppy-ProviderBrowser-searchFilterReset:hover{color:#757575}.uppy-ProviderBrowser-searchFilterReset svg{vertical-align:text-top}.uppy-ProviderBrowser-userLogout{border-radius:3px;color:#1269cf;cursor:pointer;line-height:inherit;padding:4px}.uppy-ProviderBrowser-userLogout:focus{outline:none}.uppy-ProviderBrowser-userLogout::-moz-focus-inner{border:0}.uppy-ProviderBrowser-userLogout:hover{color:#0e51a0}.uppy-ProviderBrowser-userLogout:focus{background-color:#dfe6f1}[data-uppy-theme=dark] .uppy-ProviderBrowser-userLogout:focus{background-color:#333}.uppy-ProviderBrowser-userLogout:hover{text-decoration:underline}[data-uppy-theme=dark] .uppy-ProviderBrowser-userLogout{color:#eaeaea}.uppy-ProviderBrowser-body{flex:1;position:relative}.uppy-ProviderBrowser-list{background-color:#fff;border-spacing:0;bottom:0;display:block;flex:1;height:100%;left:0;list-style:none;margin:0;overflow-x:hidden;overflow-y:auto;padding:0;position:absolute;right:0;top:0;width:100%;-webkit-overflow-scrolling:touch}[data-uppy-theme=dark] .uppy-ProviderBrowser-list{background-color:#1f1f1f}.uppy-ProviderBrowser-list:focus{outline:none}.uppy-ProviderBrowserItem-inner{cursor:pointer;font-size:13px;font-weight:500}.uppy-ProviderBrowser-footer{align-items:center;background-color:#fff;border-top:1px solid #eaeaea;display:flex;justify-content:space-between;padding:15px}[dir=ltr] .uppy-ProviderBrowser-footer button{margin-right:8px}[dir=rtl] .uppy-ProviderBrowser-footer button{margin-left:8px}[data-uppy-theme=dark] .uppy-ProviderBrowser-footer{background-color:#1f1f1f;border-top:1px solid #333}.uppy-ProviderBrowser-footer-buttons{flex-shrink:0}.uppy-ProviderBrowser-footer-error{color:#e32437;line-height:18px}@media (max-width:426px){.uppy-ProviderBrowser-footer{align-items:stretch;flex-direction:column-reverse}.uppy-ProviderBrowser-footer-error{padding-bottom:10px}}.picker-dialog-bg{z-index:20000!important}.picker-dialog{z-index:20001!important}.uppy-Dashboard-Item-previewInnerWrap{align-items:center;border-radius:3px;box-shadow:0 0 2px 0 #0006;display:flex;flex-direction:column;height:100%;justify-content:center;overflow:hidden;position:relative;width:100%}.uppy-size--md .uppy-Dashboard-Item-previewInnerWrap{box-shadow:0 1px 2px #00000026}.uppy-Dashboard--singleFile .uppy-Dashboard-Item-previewInnerWrap{box-shadow:none}.uppy-Dashboard-Item-previewInnerWrap:after{background-color:#000000a6;bottom:0;content:"";display:none;left:0;position:absolute;right:0;top:0;z-index:1001}.uppy-Dashboard-Item-previewLink{bottom:0;left:0;position:absolute;right:0;top:0;z-index:1002}.uppy-Dashboard-Item-previewLink:focus{box-shadow:inset 0 0 0 3px #579df0}[data-uppy-theme=dark] .uppy-Dashboard-Item-previewLink:focus{box-shadow:inset 0 0 0 3px #016c8d}.uppy-Dashboard-Item-preview img.uppy-Dashboard-Item-previewImg{border-radius:3px;height:100%;object-fit:cover;transform:translateZ(0);width:100%}.uppy-Dashboard--singleFile .uppy-Dashboard-Item-preview img.uppy-Dashboard-Item-previewImg{height:auto;max-height:100%;max-width:100%;object-fit:contain;padding:10px;width:auto}.uppy-Dashboard-Item-progress{color:#fff;left:50%;position:absolute;text-align:center;top:50%;transform:translate(-50%,-50%);transition:all .35 ease;width:120px;z-index:1002}.uppy-Dashboard-Item-progressIndicator{color:#fff;display:inline-block;height:38px;opacity:.9;width:38px}.uppy-size--md .uppy-Dashboard-Item-progressIndicator{height:55px;width:55px}button.uppy-Dashboard-Item-progressIndicator{cursor:pointer}button.uppy-Dashboard-Item-progressIndicator:focus{outline:none}button.uppy-Dashboard-Item-progressIndicator::-moz-focus-inner{border:0}button.uppy-Dashboard-Item-progressIndicator:focus .uppy-Dashboard-Item-progressIcon--bg,button.uppy-Dashboard-Item-progressIndicator:focus .uppy-Dashboard-Item-progressIcon--retry{fill:#579df0}.uppy-Dashboard-Item-progressIcon--circle{height:100%;width:100%}.uppy-Dashboard-Item-progressIcon--bg{stroke:#fff6}.uppy-Dashboard-Item-progressIcon--progress{transition:stroke-dashoffset .5s ease-out;stroke:#fff}.uppy-Dashboard-Item-progressIcon--play{transition:all .2s;fill:#fff;stroke:#fff}.uppy-Dashboard-Item-progressIcon--cancel{transition:all .2s;fill:#fff}.uppy-Dashboard-Item-progressIcon--pause{transition:all .2s;fill:#fff;stroke:#fff}.uppy-Dashboard-Item-progressIcon--check{transition:all .2s;fill:#fff}.uppy-Dashboard-Item-progressIcon--retry{fill:#fff}[dir=ltr] .uppy-Dashboard-Item.is-complete .uppy-Dashboard-Item-progress{right:-8px}[dir=rtl] .uppy-Dashboard-Item.is-complete .uppy-Dashboard-Item-progress{left:-8px}[dir=ltr] .uppy-Dashboard-Item.is-complete .uppy-Dashboard-Item-progress{left:auto}[dir=rtl] .uppy-Dashboard-Item.is-complete .uppy-Dashboard-Item-progress{right:auto}.uppy-Dashboard-Item.is-complete .uppy-Dashboard-Item-progress{top:-9px;transform:none;width:auto}.uppy-Dashboard-Item.is-error .uppy-Dashboard-Item-progressIndicator{height:18px;width:18px}.uppy-size--md .uppy-Dashboard-Item.is-error .uppy-Dashboard-Item-progressIndicator{height:28px;width:28px}.uppy-Dashboard-Item.is-complete .uppy-Dashboard-Item-progressIndicator{height:18px;opacity:1;width:18px}.uppy-size--md .uppy-Dashboard-Item.is-complete .uppy-Dashboard-Item-progressIndicator{height:22px;width:22px}.uppy-Dashboard-Item.is-processing .uppy-Dashboard-Item-progress{opacity:0}[dir=ltr] .uppy-Dashboard-Item-fileInfo{padding-right:5px}[dir=rtl] .uppy-Dashboard-Item-fileInfo{padding-left:5px}[dir=ltr] .uppy-Dashboard--singleFile .uppy-Dashboard-Item-fileInfo{padding-right:10px}[dir=rtl] .uppy-Dashboard--singleFile .uppy-Dashboard-Item-fileInfo{padding-left:10px}[dir=ltr] .uppy-size--md.uppy-Dashboard--singleFile .uppy-Dashboard-Item-fileInfo{padding-right:15px}[dir=rtl] .uppy-size--md.uppy-Dashboard--singleFile .uppy-Dashboard-Item-fileInfo{padding-left:15px}.uppy-Dashboard-Item-name{font-size:12px;font-weight:500;line-height:1.3;margin-bottom:5px;word-wrap:anywhere;word-break:break-all}[data-uppy-theme=dark] .uppy-Dashboard-Item-name{color:#eaeaea}.uppy-size--md.uppy-Dashboard--singleFile .uppy-Dashboard-Item-name{font-size:14px;line-height:1.4}.uppy-Dashboard-Item-fileName{align-items:baseline;display:flex}.uppy-Dashboard-Item-fileName button{margin-left:5px}.uppy-Dashboard-Item-author{color:#757575;display:inline-block;font-size:11px;font-weight:400;line-height:1;margin-bottom:5px;vertical-align:bottom}.uppy-Dashboard-Item-author a{color:#757575}.uppy-Dashboard-Item-status{color:#757575;font-size:11px;font-weight:400;line-height:1}[data-uppy-theme=dark] .uppy-Dashboard-Item-status{color:#bbb}.uppy-Dashboard-Item-statusSize{display:inline-block;margin-bottom:5px;text-transform:uppercase;vertical-align:bottom}.uppy-Dashboard-Item-reSelect{color:#1269cf;font-family:inherit;font-size:inherit;font-weight:600}.uppy-Dashboard-Item-errorMessage{background-color:#fdeff1;color:#a51523;font-size:11px;font-weight:500;line-height:1.3;padding:5px 6px}.uppy-Dashboard-Item-errorMessageBtn{color:#a51523;cursor:pointer;font-size:11px;font-weight:500;text-decoration:underline}.uppy-Dashboard-Item-preview .uppy-Dashboard-Item-errorMessage{display:none}.uppy-size--md .uppy-Dashboard-Item-preview .uppy-Dashboard-Item-errorMessage{border-bottom-left-radius:3px;border-bottom-right-radius:3px;border-top:1px solid #f7c2c8;bottom:0;display:block;left:0;line-height:1.4;padding:6px 8px;position:absolute;right:0}.uppy-Dashboard-Item-fileInfo .uppy-Dashboard-Item-errorMessage{border:1px solid #f7c2c8;border-radius:3px;display:inline-block;position:static}.uppy-size--md .uppy-Dashboard-Item-fileInfo .uppy-Dashboard-Item-errorMessage{display:none}.uppy-Dashboard-Item-action{color:#939393;cursor:pointer}.uppy-Dashboard-Item-action:focus{outline:none}.uppy-Dashboard-Item-action::-moz-focus-inner{border:0}.uppy-Dashboard-Item-action:focus{box-shadow:0 0 0 3px #1269cf80}.uppy-Dashboard-Item-action:hover{color:#1f1f1f;opacity:1}[data-uppy-theme=dark] .uppy-Dashboard-Item-action{color:#cfcfcf}[data-uppy-theme=dark] .uppy-Dashboard-Item-action:focus{outline:none}[data-uppy-theme=dark] .uppy-Dashboard-Item-action::-moz-focus-inner{border:0}[data-uppy-theme=dark] .uppy-Dashboard-Item-action:focus{box-shadow:0 0 0 2px #aae1ffd9}[data-uppy-theme=dark] .uppy-Dashboard-Item-action:hover{color:#eaeaea}.uppy-Dashboard-Item-action--remove{color:#1f1f1f;opacity:.95}.uppy-Dashboard-Item-action--remove:hover{color:#000;opacity:1}[dir=ltr] .uppy-size--md .uppy-Dashboard-Item-action--remove{right:-8px}[dir=rtl] .uppy-size--md .uppy-Dashboard-Item-action--remove{left:-8px}.uppy-size--md .uppy-Dashboard-Item-action--remove{height:18px;padding:0;position:absolute;top:-8px;width:18px;z-index:1002}.uppy-size--md .uppy-Dashboard-Item-action--remove:focus{border-radius:50%}[dir=ltr] .uppy-Dashboard--singleFile.uppy-size--height-md .uppy-Dashboard-Item-action--remove{right:8px}[dir=rtl] .uppy-Dashboard--singleFile.uppy-size--height-md .uppy-Dashboard-Item-action--remove{left:8px}.uppy-Dashboard--singleFile.uppy-size--height-md .uppy-Dashboard-Item-action--remove{position:absolute;top:8px}[data-uppy-theme=dark] .uppy-Dashboard-Item-action--remove{color:#525252}[data-uppy-theme=dark] .uppy-Dashboard-Item-action--remove:hover{color:#333}.uppy-Dashboard:not(.uppy-size--md):not(.uppy-Dashboard--singleFile.uppy-size--height-md) .uppy-Dashboard-Item-actionWrapper{align-items:center;display:flex}.uppy-Dashboard:not(.uppy-size--md):not(.uppy-Dashboard--singleFile.uppy-size--height-md) .uppy-Dashboard-Item-action{height:22px;margin-left:3px;padding:3px;width:22px}.uppy-Dashboard:not(.uppy-size--md):not(.uppy-Dashboard--singleFile.uppy-size--height-md) .uppy-Dashboard-Item-action:focus{border-radius:3px}.uppy-size--md .uppy-Dashboard-Item-action--copyLink,.uppy-size--md .uppy-Dashboard-Item-action--edit{height:16px;padding:0;width:16px}.uppy-size--md .uppy-Dashboard-Item-action--copyLink:focus,.uppy-size--md .uppy-Dashboard-Item-action--edit:focus{border-radius:3px}.uppy-Dashboard-Item{align-items:center;border-bottom:1px solid #eaeaea;display:flex;padding:10px}[dir=ltr] .uppy-Dashboard:not(.uppy-Dashboard--singleFile) .uppy-Dashboard-Item{padding-right:0}[dir=rtl] .uppy-Dashboard:not(.uppy-Dashboard--singleFile) .uppy-Dashboard-Item{padding-left:0}[data-uppy-theme=dark] .uppy-Dashboard-Item{border-bottom:1px solid #333}[dir=ltr] .uppy-size--md .uppy-Dashboard-Item{float:left}[dir=rtl] .uppy-size--md .uppy-Dashboard-Item{float:right}.uppy-size--md .uppy-Dashboard-Item{border-bottom:0;display:block;height:215px;margin:5px 15px;padding:0;position:relative;width:calc(33.333% - 30px)}.uppy-size--lg .uppy-Dashboard-Item{height:190px;margin:5px 15px;padding:0;width:calc(25% - 30px)}.uppy-size--xl .uppy-Dashboard-Item{height:210px;padding:0;width:calc(20% - 30px)}.uppy-Dashboard--singleFile .uppy-Dashboard-Item{border-bottom:0;display:flex;flex-direction:column;height:100%;max-width:400px;padding:15px;position:relative;width:100%}.uppy-Dashboard-Item.is-ghost .uppy-Dashboard-Item-previewInnerWrap{opacity:.2}.uppy-Dashboard-Item.is-ghost .uppy-Dashboard-Item-name{opacity:.7}.uppy-Dashboard-Item.is-ghost .uppy-Dashboard-Item-preview:before{background-image:url(${w});background-position:50% 10px;background-repeat:no-repeat;background-size:25px;bottom:0;content:"";left:0;opacity:.5;position:absolute;right:0;top:0;z-index:1005}.uppy-size--md .uppy-Dashboard-Item.is-ghost .uppy-Dashboard-Item-preview:before{background-position:50% 50%;background-size:40px}.uppy-Dashboard--singleFile .uppy-Dashboard-Item.is-ghost .uppy-Dashboard-Item-preview:before{background-position:50% 50%;background-size:30%}.uppy-Dashboard-Item-preview{flex-grow:0;flex-shrink:0;height:50px;position:relative;width:50px}.uppy-size--md .uppy-Dashboard-Item-preview{height:140px;width:100%}.uppy-size--lg .uppy-Dashboard-Item-preview{height:120px}.uppy-size--xl .uppy-Dashboard-Item-preview{height:140px}.uppy-Dashboard--singleFile .uppy-Dashboard-Item-preview{flex-grow:1;max-height:75%;width:100%}.uppy-Dashboard--singleFile.uppy-size--md .uppy-Dashboard-Item-preview{max-height:100%}[dir=ltr] .uppy-Dashboard-Item-fileInfoAndButtons{padding-right:8px}[dir=rtl] .uppy-Dashboard-Item-fileInfoAndButtons{padding-left:8px}[dir=ltr] .uppy-Dashboard-Item-fileInfoAndButtons{padding-left:12px}[dir=rtl] .uppy-Dashboard-Item-fileInfoAndButtons{padding-right:12px}.uppy-Dashboard-Item-fileInfoAndButtons{align-items:center;display:flex;flex-grow:1;justify-content:space-between}.uppy-Dashboard--singleFile .uppy-Dashboard-Item-fileInfoAndButtons,.uppy-size--md .uppy-Dashboard-Item-fileInfoAndButtons{align-items:flex-start;padding:9px 0 0}.uppy-Dashboard--singleFile .uppy-Dashboard-Item-fileInfoAndButtons{flex-grow:0;width:100%}.uppy-Dashboard-Item-fileInfo{flex-grow:1;flex-shrink:1}.uppy-Dashboard-Item-actionWrapper{flex-grow:0;flex-shrink:0}.uppy-Dashboard-Item.is-error .uppy-Dashboard-Item-previewInnerWrap:after,.uppy-Dashboard-Item.is-inprogress .uppy-Dashboard-Item-previewInnerWrap:after{display:block}[dir=ltr] .uppy-Dashboard-Item-errorDetails{left:2px}[dir=rtl] .uppy-Dashboard-Item-errorDetails{right:2px}.uppy-Dashboard-Item-errorDetails{-webkit-appearance:none;appearance:none;background-color:#939393;border:none;border-radius:50%;color:#fff;cursor:help;flex-shrink:0;font-size:10px;font-weight:600;height:13px;line-height:12px;position:relative;text-align:center;top:0;width:13px}.uppy-Dashboard-Item-errorDetails:after{line-height:1.3;word-wrap:break-word}.uppy-Dashboard-FileCard{background-color:#fff;border-radius:5px;bottom:0;box-shadow:0 0 10px 4px #0000001a;display:flex;flex-direction:column;height:100%;left:0;position:absolute;right:0;top:0;width:100%;z-index:1005}.uppy-Dashboard-FileCard .uppy-DashboardContent-bar{border-top-left-radius:5px;border-top-right-radius:5px}.uppy-Dashboard-FileCard .uppy-Dashboard-FileCard-actions{border-bottom-left-radius:5px;border-bottom-right-radius:5px}.uppy-Dashboard-FileCard-inner{display:flex;flex-direction:column;flex-grow:1;flex-shrink:1;height:100%;min-height:0}.uppy-Dashboard-FileCard-preview{align-items:center;border-bottom:1px solid #eaeaea;display:flex;flex-grow:0;flex-shrink:1;height:60%;justify-content:center;min-height:0;position:relative}[data-uppy-theme=dark] .uppy-Dashboard-FileCard-preview{background-color:#333;border-bottom:0}.uppy-Dashboard-FileCard-preview img.uppy-Dashboard-Item-previewImg{border-radius:3px;box-shadow:0 3px 20px #00000026;flex:0 0 auto;max-height:90%;max-width:90%;object-fit:cover}[dir=ltr] .uppy-Dashboard-FileCard-edit{right:10px}[dir=rtl] .uppy-Dashboard-FileCard-edit{left:10px}.uppy-Dashboard-FileCard-edit{background-color:#00000080;border-radius:50px;color:#fff;font-size:13px;padding:7px 15px;position:absolute;top:10px}.uppy-Dashboard-FileCard-edit:focus{outline:none}.uppy-Dashboard-FileCard-edit::-moz-focus-inner{border:0}.uppy-Dashboard-FileCard-edit:focus{box-shadow:0 0 0 3px #1269cf80}.uppy-Dashboard-FileCard-edit:hover{background-color:#000c}.uppy-Dashboard-FileCard-info{flex-grow:0;flex-shrink:0;height:40%;overflow-y:auto;padding:30px 20px 20px;-webkit-overflow-scrolling:touch}[data-uppy-theme=dark] .uppy-Dashboard-FileCard-info{background-color:#1f1f1f}.uppy-Dashboard-FileCard-fieldset{border:0;font-size:0;margin:auto auto 12px;max-width:640px;padding:0}.uppy-Dashboard-FileCard-label{color:#525252;display:inline-block;font-size:12px;vertical-align:middle;width:22%}.uppy-size--md .uppy-Dashboard-FileCard-label{font-size:14px}[data-uppy-theme=dark] .uppy-Dashboard-FileCard-label{color:#eaeaea}.uppy-Dashboard-FileCard-input{display:inline-block;vertical-align:middle;width:78%}.uppy-Dashboard-FileCard-actions{align-items:center;background-color:#fafafa;border-top:1px solid #eaeaea;display:flex;flex-grow:0;flex-shrink:0;height:55px;padding:0 15px}.uppy-size--md .uppy-Dashboard-FileCard-actions{height:65px}[data-uppy-theme=dark] .uppy-Dashboard-FileCard-actions{background-color:#1f1f1f;border-top:1px solid #333}[dir=ltr] .uppy-Dashboard-FileCard-actionsBtn{margin-right:10px}[dir=rtl] .uppy-Dashboard-FileCard-actionsBtn{margin-left:10px}.uppy-transition-slideDownUp-enter{opacity:.01;transform:translate3d(0,-105%,0);transition:transform .25s ease-in-out,opacity .25s ease-in-out}.uppy-transition-slideDownUp-enter.uppy-transition-slideDownUp-enter-active{opacity:1;transform:translateZ(0)}.uppy-transition-slideDownUp-leave{opacity:1;transform:translateZ(0);transition:transform .25s ease-in-out,opacity .25s ease-in-out}.uppy-transition-slideDownUp-leave.uppy-transition-slideDownUp-leave-active{opacity:.01;transform:translate3d(0,-105%,0)}@keyframes uppy-Dashboard-fadeIn{0%{opacity:0}to{opacity:1}}@keyframes uppy-Dashboard-fadeOut{0%{opacity:1}to{opacity:0}}@keyframes uppy-Dashboard-slideDownAndFadeIn{0%{opacity:0;transform:translate3d(-50%,-70%,0)}to{opacity:1;transform:translate3d(-50%,-50%,0)}}@keyframes uppy-Dashboard-slideDownAndFadeIn--small{0%{opacity:0;transform:translate3d(0,-20%,0)}to{opacity:1;transform:translateZ(0)}}@keyframes uppy-Dashboard-slideUpFadeOut{0%{opacity:1;transform:translate3d(-50%,-50%,0)}to{opacity:0;transform:translate3d(-50%,-70%,0)}}@keyframes uppy-Dashboard-slideUpFadeOut--small{0%{opacity:1;transform:translateZ(0)}to{opacity:0;transform:translate3d(0,-20%,0)}}.uppy-Dashboard--modal{z-index:1001}.uppy-Dashboard--modal[aria-hidden=true]{display:none}.uppy-Dashboard--modal.uppy-Dashboard--animateOpenClose>.uppy-Dashboard-inner{animation:uppy-Dashboard-slideDownAndFadeIn--small .3s cubic-bezier(0,0,.2,1)}@media only screen and (min-width:820px){.uppy-Dashboard--modal.uppy-Dashboard--animateOpenClose>.uppy-Dashboard-inner{animation:uppy-Dashboard-slideDownAndFadeIn .3s cubic-bezier(0,0,.2,1)}}.uppy-Dashboard--modal.uppy-Dashboard--animateOpenClose>.uppy-Dashboard-overlay{animation:uppy-Dashboard-fadeIn .3s cubic-bezier(0,0,.2,1)}.uppy-Dashboard--modal.uppy-Dashboard--animateOpenClose.uppy-Dashboard--isClosing>.uppy-Dashboard-inner{animation:uppy-Dashboard-slideUpFadeOut--small .3s cubic-bezier(0,0,.2,1)}@media only screen and (min-width:820px){.uppy-Dashboard--modal.uppy-Dashboard--animateOpenClose.uppy-Dashboard--isClosing>.uppy-Dashboard-inner{animation:uppy-Dashboard-slideUpFadeOut .3s cubic-bezier(0,0,.2,1)}}.uppy-Dashboard--modal.uppy-Dashboard--animateOpenClose.uppy-Dashboard--isClosing>.uppy-Dashboard-overlay{animation:uppy-Dashboard-fadeOut .3s cubic-bezier(0,0,.2,1)}.uppy-Dashboard-isFixed{height:100vh;overflow:hidden}.uppy-Dashboard--modal .uppy-Dashboard-overlay{background-color:#00000080;bottom:0;left:0;position:fixed;right:0;top:0;z-index:1001}.uppy-Dashboard-inner{background-color:#f4f4f4;border:1px solid #eaeaea;border-radius:5px;max-height:100%;max-width:100%;outline:none;position:relative}.uppy-size--md .uppy-Dashboard-inner{min-height:auto}@media only screen and (min-width:820px){.uppy-Dashboard-inner{height:500px;width:650px}}.uppy-Dashboard--modal .uppy-Dashboard-inner{z-index:1002}[data-uppy-theme=dark] .uppy-Dashboard-inner{background-color:#1f1f1f}.uppy-Dashboard--isDisabled .uppy-Dashboard-inner{cursor:not-allowed}.uppy-Dashboard-innerWrap{border-radius:5px;display:flex;flex-direction:column;height:100%;opacity:0;overflow:hidden;position:relative}.uppy-Dashboard--isInnerWrapVisible .uppy-Dashboard-innerWrap{opacity:1}.uppy-Dashboard--isDisabled .uppy-Dashboard-innerWrap{cursor:not-allowed;filter:grayscale(100%);opacity:.6;-webkit-user-select:none;user-select:none}.uppy-Dashboard--isDisabled .uppy-ProviderIconBg{fill:#9f9f9f}.uppy-Dashboard--isDisabled [aria-disabled],.uppy-Dashboard--isDisabled [disabled]{cursor:not-allowed;pointer-events:none}.uppy-Dashboard--modal .uppy-Dashboard-inner{border:none;bottom:15px;left:15px;position:fixed;right:15px;top:35px}@media only screen and (min-width:820px){.uppy-Dashboard--modal .uppy-Dashboard-inner{box-shadow:0 5px 15px 4px #00000026;left:50%;right:auto;top:50%;transform:translate(-50%,-50%)}}[dir=ltr] .uppy-Dashboard-close{right:-2px}[dir=rtl] .uppy-Dashboard-close{left:-2px}.uppy-Dashboard-close{color:#ffffffe6;cursor:pointer;display:block;font-size:27px;position:absolute;top:-33px;z-index:1005}.uppy-Dashboard-close:focus{outline:none}.uppy-Dashboard-close::-moz-focus-inner{border:0}.uppy-Dashboard-close:focus{color:#6eabf2}@media only screen and (min-width:820px){[dir=ltr] .uppy-Dashboard-close{right:-35px}[dir=rtl] .uppy-Dashboard-close{left:-35px}.uppy-Dashboard-close{font-size:35px;top:-10px}}.uppy-Dashboard-serviceMsg{background-color:#fffbf7;border-bottom:1px solid #edd4b9;border-top:1px solid #edd4b9;font-size:12px;font-weight:500;line-height:1.3;padding:12px 0;position:relative;top:-1px;z-index:1004}.uppy-size--md .uppy-Dashboard-serviceMsg{font-size:14px;line-height:1.4}[data-uppy-theme=dark] .uppy-Dashboard-serviceMsg{background-color:#1f1f1f;border-bottom:1px solid #333;border-top:1px solid #333;color:#eaeaea}.uppy-Dashboard-serviceMsg-title{display:block;line-height:1;margin-bottom:4px;padding-left:42px}.uppy-Dashboard-serviceMsg-text{padding:0 15px}.uppy-Dashboard-serviceMsg-actionBtn{color:#1269cf;font-size:inherit;font-weight:inherit;vertical-align:initial}[data-uppy-theme=dark] .uppy-Dashboard-serviceMsg-actionBtn{color:#02baf2e6}.uppy-Dashboard-serviceMsg-icon{left:15px;position:absolute;top:10px}.uppy-Dashboard-AddFiles{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;position:relative;text-align:center}[data-uppy-drag-drop-supported=true] .uppy-Dashboard-AddFiles{border:1px dashed #dfdfdf;border-radius:3px;height:calc(100% - 14px);margin:7px}.uppy-Dashboard-AddFilesPanel .uppy-Dashboard-AddFiles{border:none;height:calc(100% - 54px)}.uppy-Dashboard--modal .uppy-Dashboard-AddFiles{border-color:#cfcfcf}[data-uppy-theme=dark] .uppy-Dashboard-AddFiles{border-color:#757575}.uppy-Dashboard-AddFiles-info{display:none;margin-top:auto;padding-bottom:15px;padding-top:15px}.uppy-size--height-md .uppy-Dashboard-AddFiles-info{display:block}.uppy-size--md .uppy-Dashboard-AddFiles-info{bottom:25px;left:0;padding-bottom:0;padding-top:30px;position:absolute;right:0}[data-uppy-num-acquirers="0"] .uppy-Dashboard-AddFiles-info{margin-top:0}.uppy-Dashboard-browse{color:#1269cf;cursor:pointer}.uppy-Dashboard-browse:focus{outline:none}.uppy-Dashboard-browse::-moz-focus-inner{border:0}.uppy-Dashboard-browse:focus,.uppy-Dashboard-browse:hover{border-bottom:1px solid #1269cf}[data-uppy-theme=dark] .uppy-Dashboard-browse{color:#02baf2e6}[data-uppy-theme=dark] .uppy-Dashboard-browse:focus,[data-uppy-theme=dark] .uppy-Dashboard-browse:hover{border-bottom:1px solid #02baf2}.uppy-Dashboard-browseBtn{display:block;font-size:14px;font-weight:500;margin-bottom:5px;margin-top:8px;width:100%}.uppy-size--md .uppy-Dashboard-browseBtn{font-size:15px;margin:15px auto;padding:13px 44px;width:auto}.uppy-Dashboard-AddFiles-list{display:flex;flex:1;flex-direction:column;margin-top:2px;overflow-y:auto;padding:2px 0;width:100%;-webkit-overflow-scrolling:touch}.uppy-size--md .uppy-Dashboard-AddFiles-list{flex:none;flex-direction:row;flex-wrap:wrap;justify-content:center;margin-top:15px;max-width:600px;overflow-y:visible;padding-top:0}.uppy-DashboardTab{border-bottom:1px solid #eaeaea;text-align:center;width:100%}[data-uppy-theme=dark] .uppy-DashboardTab{border-bottom:1px solid #333}.uppy-size--md .uppy-DashboardTab{border-bottom:none;display:inline-block;margin-bottom:10px;width:auto}.uppy-DashboardTab-btn{align-items:center;-webkit-appearance:none;appearance:none;background-color:initial;color:#525252;cursor:pointer;flex-direction:row;height:100%;justify-content:left;padding:12px 15px;width:100%}.uppy-DashboardTab-btn:focus{outline:none}[dir=ltr] .uppy-size--md .uppy-DashboardTab-btn{margin-right:1px}[dir=rtl] .uppy-size--md .uppy-DashboardTab-btn{margin-left:1px}.uppy-size--md .uppy-DashboardTab-btn{border-radius:5px;flex-direction:column;padding:10px 3px;width:86px}[data-uppy-theme=dark] .uppy-DashboardTab-btn{color:#eaeaea}.uppy-DashboardTab-btn::-moz-focus-inner{border:0}.uppy-DashboardTab-btn:hover{background-color:#e9ecef}[data-uppy-theme=dark] .uppy-DashboardTab-btn:hover{background-color:#333}.uppy-DashboardTab-btn:active,.uppy-DashboardTab-btn:focus{background-color:#dfe6f1}[data-uppy-theme=dark] .uppy-DashboardTab-btn:active,[data-uppy-theme=dark] .uppy-DashboardTab-btn:focus{background-color:#525252}.uppy-DashboardTab-btn svg{display:inline-block;max-height:100%;max-width:100%;overflow:hidden;transition:transform .15s ease-in-out;vertical-align:text-top}[dir=ltr] .uppy-DashboardTab-inner{margin-right:10px}[dir=rtl] .uppy-DashboardTab-inner{margin-left:10px}.uppy-DashboardTab-inner{align-items:center;background-color:#fff;border-radius:8px;box-shadow:0 1px 1px 0 #0000001a,0 1px 2px 0 #0000001a,0 2px 3px 0 #00000005;display:flex;height:32px;justify-content:center;width:32px}[dir=ltr] .uppy-size--md .uppy-DashboardTab-inner{margin-right:0}[dir=rtl] .uppy-size--md .uppy-DashboardTab-inner{margin-left:0}[data-uppy-theme=dark] .uppy-DashboardTab-inner{background-color:#323232;box-shadow:0 1px 1px 0 #0003,0 1px 2px 0 #0003,0 2px 3px 0 #00000014}.uppy-DashboardTab-name{font-size:14px;font-weight:400}.uppy-size--md .uppy-DashboardTab-name{font-size:12px;line-height:15px;margin-bottom:0;margin-top:8px}.uppy-DashboardTab-iconMyDevice{color:#1269cf}[data-uppy-theme=dark] .uppy-DashboardTab-iconMyDevice{color:#02baf2}.uppy-DashboardTab-iconBox{color:#0061d5}[data-uppy-theme=dark] .uppy-DashboardTab-iconBox{color:#eaeaea}.uppy-DashboardTab-iconDropbox{color:#0061fe}[data-uppy-theme=dark] .uppy-DashboardTab-iconDropbox{color:#eaeaea}.uppy-DashboardTab-iconUnsplash{color:#111}[data-uppy-theme=dark] .uppy-DashboardTab-iconUnsplash{color:#eaeaea}.uppy-DashboardTab-iconWebdav{color:#111}[data-uppy-theme=dark] .uppy-DashboardTab-iconWebdav{color:#eaeaea}.uppy-DashboardTab-iconScreenRec{color:#2c3e50}[data-uppy-theme=dark] .uppy-DashboardTab-iconScreenRec{color:#eaeaea}.uppy-DashboardTab-iconAudio{color:#8030a3}[data-uppy-theme=dark] .uppy-DashboardTab-iconAudio{color:#bf6ee3}.uppy-Dashboard-input{height:.1px;opacity:0;overflow:hidden;position:absolute;width:.1px;z-index:-1}.uppy-DashboardContent-bar{align-items:center;background-color:#fafafa;border-bottom:1px solid #eaeaea;display:flex;flex-shrink:0;height:40px;justify-content:space-between;padding:0 10px;position:relative;width:100%;z-index:1004}.uppy-size--md .uppy-DashboardContent-bar{height:50px;padding:0 15px}[data-uppy-theme=dark] .uppy-DashboardContent-bar{background-color:#1f1f1f;border-bottom:1px solid #333}.uppy-DashboardContent-title{font-size:12px;font-weight:500;left:0;line-height:40px;margin:auto;max-width:170px;overflow-x:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0;white-space:nowrap;width:100%}.uppy-size--md .uppy-DashboardContent-title{font-size:14px;line-height:50px;max-width:300px}[data-uppy-theme=dark] .uppy-DashboardContent-title{color:#eaeaea}[dir=ltr] .uppy-DashboardContent-back,[dir=ltr] .uppy-DashboardContent-save{margin-left:-6px}[dir=rtl] .uppy-DashboardContent-back,[dir=rtl] .uppy-DashboardContent-save{margin-right:-6px}.uppy-DashboardContent-back,.uppy-DashboardContent-save{-webkit-appearance:none;background:none;border:0;border-radius:3px;color:inherit;color:#1269cf;cursor:pointer;font-family:inherit;font-size:inherit;font-size:12px;font-weight:400;line-height:1;margin:0;padding:7px 6px}.uppy-DashboardContent-back:focus,.uppy-DashboardContent-save:focus{outline:none}.uppy-DashboardContent-back::-moz-focus-inner,.uppy-DashboardContent-save::-moz-focus-inner{border:0}.uppy-DashboardContent-back:hover,.uppy-DashboardContent-save:hover{color:#0e51a0}.uppy-DashboardContent-back:focus,.uppy-DashboardContent-save:focus{background-color:#dfe6f1}[data-uppy-theme=dark] .uppy-DashboardContent-back:focus,[data-uppy-theme=dark] .uppy-DashboardContent-save:focus{background-color:#333}.uppy-size--md .uppy-DashboardContent-back,.uppy-size--md .uppy-DashboardContent-save{font-size:14px}[data-uppy-theme=dark] .uppy-DashboardContent-back,[data-uppy-theme=dark] .uppy-DashboardContent-save{color:#02baf2}[dir=ltr] .uppy-DashboardContent-addMore{margin-right:-5px}[dir=rtl] .uppy-DashboardContent-addMore{margin-left:-5px}.uppy-DashboardContent-addMore{-webkit-appearance:none;background:none;border:0;border-radius:3px;color:inherit;color:#1269cf;cursor:pointer;font-family:inherit;font-size:inherit;font-weight:500;height:29px;line-height:1;margin:0;padding:7px 8px;width:29px}.uppy-DashboardContent-addMore:focus{outline:none}.uppy-DashboardContent-addMore::-moz-focus-inner{border:0}.uppy-DashboardContent-addMore:hover{color:#0e51a0}.uppy-DashboardContent-addMore:focus{background-color:#dfe6f1}[data-uppy-theme=dark] .uppy-DashboardContent-addMore:focus{background-color:#333}[dir=ltr] .uppy-size--md .uppy-DashboardContent-addMore{margin-right:-8px}[dir=rtl] .uppy-size--md .uppy-DashboardContent-addMore{margin-left:-8px}.uppy-size--md .uppy-DashboardContent-addMore{font-size:14px;height:auto;width:auto}[data-uppy-theme=dark] .uppy-DashboardContent-addMore{color:#02baf2}[dir=ltr] .uppy-DashboardContent-addMore svg{margin-right:4px}[dir=rtl] .uppy-DashboardContent-addMore svg{margin-left:4px}.uppy-DashboardContent-addMore svg{vertical-align:initial}.uppy-size--md .uppy-DashboardContent-addMore svg{height:11px;width:11px}.uppy-DashboardContent-addMoreCaption{display:none}.uppy-size--md .uppy-DashboardContent-addMoreCaption{display:inline}.uppy-DashboardContent-panel{background-color:#f5f5f5;flex:1}.uppy-Dashboard-AddFilesPanel,.uppy-DashboardContent-panel{border-radius:5px;bottom:0;display:flex;flex-direction:column;left:0;overflow:hidden;position:absolute;right:0;top:0;z-index:1005}.uppy-Dashboard-AddFilesPanel{background:#fafafa;background:linear-gradient(0deg,#fafafa 35%,#fafafad9);box-shadow:0 0 10px 5px #00000026}[data-uppy-theme=dark] .uppy-Dashboard-AddFilesPanel{background-color:#333;background-image:linear-gradient(0deg,#1f1f1f 35%,#1f1f1fd9)}.uppy-Dashboard--isAddFilesPanelVisible .uppy-Dashboard-files{filter:blur(2px)}.uppy-Dashboard-progress{bottom:0;height:12%;left:0;position:absolute;width:100%}.uppy-Dashboard-progressBarContainer.is-active{height:100%;left:0;position:absolute;top:0;width:100%;z-index:1004}.uppy-Dashboard-filesContainer{flex:1;margin:0;overflow-y:hidden;position:relative}.uppy-Dashboard-filesContainer:after{clear:both;content:"";display:table}.uppy-Dashboard-files{flex:1;margin:0;overflow-y:auto;padding:0 0 10px;-webkit-overflow-scrolling:touch}.uppy-size--md .uppy-Dashboard-files{padding-top:10px}.uppy-Dashboard--singleFile .uppy-Dashboard-filesInner{align-items:center;display:flex;height:100%;justify-content:center}.uppy-Dashboard-dropFilesHereHint{align-items:center;background-image:url(${E});background-position:50% 50%;background-repeat:no-repeat;border:1px dashed #1269cf;border-radius:3px;bottom:7px;color:#757575;display:flex;font-size:16px;justify-content:center;left:7px;padding-top:90px;position:absolute;right:7px;text-align:center;top:7px;visibility:hidden;z-index:2000}[data-uppy-theme=dark] .uppy-Dashboard-dropFilesHereHint{background-image:url(${S});border-color:#02baf2;color:#bbb}.uppy-Dashboard.uppy-Dashboard--isDraggingOver .uppy-Dashboard-dropFilesHereHint{pointer-events:none;visibility:visible}.uppy-Dashboard.uppy-Dashboard--isDraggingOver .uppy-Dashboard-files,.uppy-Dashboard.uppy-Dashboard--isDraggingOver .uppy-Dashboard-progressindicators,.uppy-Dashboard.uppy-Dashboard--isDraggingOver .uppy-Dashboard-serviceMsg,.uppy-Dashboard.uppy-Dashboard--isDraggingOver .uppy-DashboardContent-bar{opacity:.15}.uppy-Dashboard.uppy-Dashboard--isDraggingOver .uppy-Dashboard-AddFiles{opacity:.03}.uppy-Dashboard-AddFiles-title{color:#000;font-size:17px;font-weight:500;line-height:1.35;margin-bottom:5px;margin-top:15px;padding:0 15px;text-align:inline-start;width:100%}.uppy-size--md .uppy-Dashboard-AddFiles-title{font-size:21px;font-weight:400;margin-top:5px;max-width:480px;padding:0 35px;text-align:center}[data-uppy-num-acquirers="0"] .uppy-Dashboard-AddFiles-title{text-align:center}[data-uppy-theme=dark] .uppy-Dashboard-AddFiles-title{color:#eaeaea}.uppy-Dashboard-AddFiles-title button{font-weight:500}.uppy-size--md .uppy-Dashboard-AddFiles-title button{font-weight:400}.uppy-Dashboard-note{color:#757575;font-size:14px;line-height:1.25;margin:auto;max-width:350px;padding:0 15px;text-align:center}.uppy-size--md .uppy-Dashboard-note{line-height:1.35;max-width:600px}[data-uppy-theme=dark] .uppy-Dashboard-note{color:#cfcfcf}a.uppy-Dashboard-poweredBy{color:#939393;display:inline-block;font-size:11px;margin-top:8px;text-align:center;text-decoration:none}.uppy-Dashboard-poweredByIcon{margin-left:1px;margin-right:1px;opacity:.9;position:relative;top:1px;vertical-align:text-top;fill:none;stroke:#939393}.uppy-Dashboard-Item-previewIcon{height:25px;left:50%;position:absolute;top:50%;transform:translate(-50%,-50%);width:25px;z-index:100}.uppy-size--md .uppy-Dashboard-Item-previewIcon{height:38px;width:38px}.uppy-Dashboard-Item-previewIcon svg{height:100%;width:100%}.uppy-Dashboard--singleFile .uppy-Dashboard-Item-previewIcon{height:100%;max-height:60%;max-width:60%;width:100%}.uppy-Dashboard-Item-previewIconWrap{height:76px;max-height:75%;position:relative}.uppy-Dashboard--singleFile .uppy-Dashboard-Item-previewIconWrap{height:100%;width:100%}.uppy-Dashboard-Item-previewIconBg{filter:drop-shadow(rgba(0,0,0,.1) 0 1px 1px);height:100%;width:100%}.uppy-Dashboard-upload{height:50px;position:relative;width:50px}.uppy-size--md .uppy-Dashboard-upload{height:60px;width:60px}.uppy-Dashboard-upload .uppy-c-icon{position:relative;top:1px;width:50%}[dir=ltr] .uppy-Dashboard-uploadCount{right:-12px}[dir=rtl] .uppy-Dashboard-uploadCount{left:-12px}.uppy-Dashboard-uploadCount{background-color:#1bb240;border-radius:50%;color:#fff;font-size:8px;height:16px;line-height:16px;position:absolute;top:-12px;width:16px}.uppy-size--md .uppy-Dashboard-uploadCount{font-size:9px;height:18px;line-height:18px;width:18px}`,""]);const T=g},6878:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(1601),i=r.n(n),a=r(6314),s=r.n(a)()(i());s.push([e.id,"/*!\n * Quill Editor v2.0.3\n * https://quilljs.com\n * Copyright (c) 2017-2024, Slab\n * Copyright (c) 2014, Jason Chen\n * Copyright (c) 2013, salesforce.com\n */\n.ql-container{box-sizing:border-box;font-family:Helvetica,Arial,sans-serif;font-size:13px;height:100%;margin:0;position:relative}.ql-container.ql-disabled .ql-tooltip{visibility:hidden}.ql-container:not(.ql-disabled) li[data-list=checked] > .ql-ui,.ql-container:not(.ql-disabled) li[data-list=unchecked] > .ql-ui{cursor:pointer}.ql-clipboard{left:-100000px;height:1px;overflow-y:hidden;position:absolute;top:50%}.ql-clipboard p{margin:0;padding:0}.ql-editor{box-sizing:border-box;counter-reset:list-0 list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9;line-height:1.42;height:100%;outline:none;overflow-y:auto;padding:12px 15px;tab-size:4;-moz-tab-size:4;text-align:left;white-space:pre-wrap;word-wrap:break-word}.ql-editor > *{cursor:text}.ql-editor p,.ql-editor ol,.ql-editor pre,.ql-editor blockquote,.ql-editor h1,.ql-editor h2,.ql-editor h3,.ql-editor h4,.ql-editor h5,.ql-editor h6{margin:0;padding:0}@supports (counter-set:none){.ql-editor p,.ql-editor h1,.ql-editor h2,.ql-editor h3,.ql-editor h4,.ql-editor h5,.ql-editor h6{counter-set:list-0 list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor p,.ql-editor h1,.ql-editor h2,.ql-editor h3,.ql-editor h4,.ql-editor h5,.ql-editor h6{counter-reset:list-0 list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor table{border-collapse:collapse}.ql-editor td{border:1px solid #000;padding:2px 5px}.ql-editor ol{padding-left:1.5em}.ql-editor li{list-style-type:none;padding-left:1.5em;position:relative}.ql-editor li > .ql-ui:before{display:inline-block;margin-left:-1.5em;margin-right:.3em;text-align:right;white-space:nowrap;width:1.2em}.ql-editor li[data-list=checked] > .ql-ui,.ql-editor li[data-list=unchecked] > .ql-ui{color:#777}.ql-editor li[data-list=bullet] > .ql-ui:before{content:'\\2022'}.ql-editor li[data-list=checked] > .ql-ui:before{content:'\\2611'}.ql-editor li[data-list=unchecked] > .ql-ui:before{content:'\\2610'}@supports (counter-set:none){.ql-editor li[data-list]{counter-set:list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list]{counter-reset:list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered]{counter-increment:list-0}.ql-editor li[data-list=ordered] > .ql-ui:before{content:counter(list-0, decimal) '. '}.ql-editor li[data-list=ordered].ql-indent-1{counter-increment:list-1}.ql-editor li[data-list=ordered].ql-indent-1 > .ql-ui:before{content:counter(list-1, lower-alpha) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-1{counter-set:list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-1{counter-reset:list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-2{counter-increment:list-2}.ql-editor li[data-list=ordered].ql-indent-2 > .ql-ui:before{content:counter(list-2, lower-roman) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-2{counter-set:list-3 list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-2{counter-reset:list-3 list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-3{counter-increment:list-3}.ql-editor li[data-list=ordered].ql-indent-3 > .ql-ui:before{content:counter(list-3, decimal) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-3{counter-set:list-4 list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-3{counter-reset:list-4 list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-4{counter-increment:list-4}.ql-editor li[data-list=ordered].ql-indent-4 > .ql-ui:before{content:counter(list-4, lower-alpha) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-4{counter-set:list-5 list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-4{counter-reset:list-5 list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-5{counter-increment:list-5}.ql-editor li[data-list=ordered].ql-indent-5 > .ql-ui:before{content:counter(list-5, lower-roman) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-5{counter-set:list-6 list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-5{counter-reset:list-6 list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-6{counter-increment:list-6}.ql-editor li[data-list=ordered].ql-indent-6 > .ql-ui:before{content:counter(list-6, decimal) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-6{counter-set:list-7 list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-6{counter-reset:list-7 list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-7{counter-increment:list-7}.ql-editor li[data-list=ordered].ql-indent-7 > .ql-ui:before{content:counter(list-7, lower-alpha) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-7{counter-set:list-8 list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-7{counter-reset:list-8 list-9}}.ql-editor li[data-list=ordered].ql-indent-8{counter-increment:list-8}.ql-editor li[data-list=ordered].ql-indent-8 > .ql-ui:before{content:counter(list-8, lower-roman) '. '}@supports (counter-set:none){.ql-editor li[data-list].ql-indent-8{counter-set:list-9}}@supports not (counter-set:none){.ql-editor li[data-list].ql-indent-8{counter-reset:list-9}}.ql-editor li[data-list=ordered].ql-indent-9{counter-increment:list-9}.ql-editor li[data-list=ordered].ql-indent-9 > .ql-ui:before{content:counter(list-9, decimal) '. '}.ql-editor .ql-indent-1:not(.ql-direction-rtl){padding-left:3em}.ql-editor li.ql-indent-1:not(.ql-direction-rtl){padding-left:4.5em}.ql-editor .ql-indent-1.ql-direction-rtl.ql-align-right{padding-right:3em}.ql-editor li.ql-indent-1.ql-direction-rtl.ql-align-right{padding-right:4.5em}.ql-editor .ql-indent-2:not(.ql-direction-rtl){padding-left:6em}.ql-editor li.ql-indent-2:not(.ql-direction-rtl){padding-left:7.5em}.ql-editor .ql-indent-2.ql-direction-rtl.ql-align-right{padding-right:6em}.ql-editor li.ql-indent-2.ql-direction-rtl.ql-align-right{padding-right:7.5em}.ql-editor .ql-indent-3:not(.ql-direction-rtl){padding-left:9em}.ql-editor li.ql-indent-3:not(.ql-direction-rtl){padding-left:10.5em}.ql-editor .ql-indent-3.ql-direction-rtl.ql-align-right{padding-right:9em}.ql-editor li.ql-indent-3.ql-direction-rtl.ql-align-right{padding-right:10.5em}.ql-editor .ql-indent-4:not(.ql-direction-rtl){padding-left:12em}.ql-editor li.ql-indent-4:not(.ql-direction-rtl){padding-left:13.5em}.ql-editor .ql-indent-4.ql-direction-rtl.ql-align-right{padding-right:12em}.ql-editor li.ql-indent-4.ql-direction-rtl.ql-align-right{padding-right:13.5em}.ql-editor .ql-indent-5:not(.ql-direction-rtl){padding-left:15em}.ql-editor li.ql-indent-5:not(.ql-direction-rtl){padding-left:16.5em}.ql-editor .ql-indent-5.ql-direction-rtl.ql-align-right{padding-right:15em}.ql-editor li.ql-indent-5.ql-direction-rtl.ql-align-right{padding-right:16.5em}.ql-editor .ql-indent-6:not(.ql-direction-rtl){padding-left:18em}.ql-editor li.ql-indent-6:not(.ql-direction-rtl){padding-left:19.5em}.ql-editor .ql-indent-6.ql-direction-rtl.ql-align-right{padding-right:18em}.ql-editor li.ql-indent-6.ql-direction-rtl.ql-align-right{padding-right:19.5em}.ql-editor .ql-indent-7:not(.ql-direction-rtl){padding-left:21em}.ql-editor li.ql-indent-7:not(.ql-direction-rtl){padding-left:22.5em}.ql-editor .ql-indent-7.ql-direction-rtl.ql-align-right{padding-right:21em}.ql-editor li.ql-indent-7.ql-direction-rtl.ql-align-right{padding-right:22.5em}.ql-editor .ql-indent-8:not(.ql-direction-rtl){padding-left:24em}.ql-editor li.ql-indent-8:not(.ql-direction-rtl){padding-left:25.5em}.ql-editor .ql-indent-8.ql-direction-rtl.ql-align-right{padding-right:24em}.ql-editor li.ql-indent-8.ql-direction-rtl.ql-align-right{padding-right:25.5em}.ql-editor .ql-indent-9:not(.ql-direction-rtl){padding-left:27em}.ql-editor li.ql-indent-9:not(.ql-direction-rtl){padding-left:28.5em}.ql-editor .ql-indent-9.ql-direction-rtl.ql-align-right{padding-right:27em}.ql-editor li.ql-indent-9.ql-direction-rtl.ql-align-right{padding-right:28.5em}.ql-editor li.ql-direction-rtl{padding-right:1.5em}.ql-editor li.ql-direction-rtl > .ql-ui:before{margin-left:.3em;margin-right:-1.5em;text-align:left}.ql-editor table{table-layout:fixed;width:100%}.ql-editor table td{outline:none}.ql-editor .ql-code-block-container{font-family:monospace}.ql-editor .ql-video{display:block;max-width:100%}.ql-editor .ql-video.ql-align-center{margin:0 auto}.ql-editor .ql-video.ql-align-right{margin:0 0 0 auto}.ql-editor .ql-bg-black{background-color:#000}.ql-editor .ql-bg-red{background-color:#e60000}.ql-editor .ql-bg-orange{background-color:#f90}.ql-editor .ql-bg-yellow{background-color:#ff0}.ql-editor .ql-bg-green{background-color:#008a00}.ql-editor .ql-bg-blue{background-color:#06c}.ql-editor .ql-bg-purple{background-color:#93f}.ql-editor .ql-color-white{color:#fff}.ql-editor .ql-color-red{color:#e60000}.ql-editor .ql-color-orange{color:#f90}.ql-editor .ql-color-yellow{color:#ff0}.ql-editor .ql-color-green{color:#008a00}.ql-editor .ql-color-blue{color:#06c}.ql-editor .ql-color-purple{color:#93f}.ql-editor .ql-font-serif{font-family:Georgia,Times New Roman,serif}.ql-editor .ql-font-monospace{font-family:Monaco,Courier New,monospace}.ql-editor .ql-size-small{font-size:.75em}.ql-editor .ql-size-large{font-size:1.5em}.ql-editor .ql-size-huge{font-size:2.5em}.ql-editor .ql-direction-rtl{direction:rtl;text-align:inherit}.ql-editor .ql-align-center{text-align:center}.ql-editor .ql-align-justify{text-align:justify}.ql-editor .ql-align-right{text-align:right}.ql-editor .ql-ui{position:absolute}.ql-editor.ql-blank::before{color:rgba(0,0,0,0.6);content:attr(data-placeholder);font-style:italic;left:15px;pointer-events:none;position:absolute;right:15px}.ql-snow.ql-toolbar:after,.ql-snow .ql-toolbar:after{clear:both;content:'';display:table}.ql-snow.ql-toolbar button,.ql-snow .ql-toolbar button{background:none;border:none;cursor:pointer;display:inline-block;float:left;height:24px;padding:3px 5px;width:28px}.ql-snow.ql-toolbar button svg,.ql-snow .ql-toolbar button svg{float:left;height:100%}.ql-snow.ql-toolbar button:active:hover,.ql-snow .ql-toolbar button:active:hover{outline:none}.ql-snow.ql-toolbar input.ql-image[type=file],.ql-snow .ql-toolbar input.ql-image[type=file]{display:none}.ql-snow.ql-toolbar button:hover,.ql-snow .ql-toolbar button:hover,.ql-snow.ql-toolbar button:focus,.ql-snow .ql-toolbar button:focus,.ql-snow.ql-toolbar button.ql-active,.ql-snow .ql-toolbar button.ql-active,.ql-snow.ql-toolbar .ql-picker-label:hover,.ql-snow .ql-toolbar .ql-picker-label:hover,.ql-snow.ql-toolbar .ql-picker-label.ql-active,.ql-snow .ql-toolbar .ql-picker-label.ql-active,.ql-snow.ql-toolbar .ql-picker-item:hover,.ql-snow .ql-toolbar .ql-picker-item:hover,.ql-snow.ql-toolbar .ql-picker-item.ql-selected,.ql-snow .ql-toolbar .ql-picker-item.ql-selected{color:#06c}.ql-snow.ql-toolbar button:hover .ql-fill,.ql-snow .ql-toolbar button:hover .ql-fill,.ql-snow.ql-toolbar button:focus .ql-fill,.ql-snow .ql-toolbar button:focus .ql-fill,.ql-snow.ql-toolbar button.ql-active .ql-fill,.ql-snow .ql-toolbar button.ql-active .ql-fill,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-fill,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-fill,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-fill,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-fill,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-fill,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-fill,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-fill,.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-fill,.ql-snow.ql-toolbar button:hover .ql-stroke.ql-fill,.ql-snow .ql-toolbar button:hover .ql-stroke.ql-fill,.ql-snow.ql-toolbar button:focus .ql-stroke.ql-fill,.ql-snow .ql-toolbar button:focus .ql-stroke.ql-fill,.ql-snow.ql-toolbar button.ql-active .ql-stroke.ql-fill,.ql-snow .ql-toolbar button.ql-active .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke.ql-fill,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke.ql-fill,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-stroke.ql-fill,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-stroke.ql-fill,.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-stroke.ql-fill{fill:#06c}.ql-snow.ql-toolbar button:hover .ql-stroke,.ql-snow .ql-toolbar button:hover .ql-stroke,.ql-snow.ql-toolbar button:focus .ql-stroke,.ql-snow .ql-toolbar button:focus .ql-stroke,.ql-snow.ql-toolbar button.ql-active .ql-stroke,.ql-snow .ql-toolbar button.ql-active .ql-stroke,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-stroke,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-stroke,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-stroke,.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-stroke,.ql-snow.ql-toolbar button:hover .ql-stroke-miter,.ql-snow .ql-toolbar button:hover .ql-stroke-miter,.ql-snow.ql-toolbar button:focus .ql-stroke-miter,.ql-snow .ql-toolbar button:focus .ql-stroke-miter,.ql-snow.ql-toolbar button.ql-active .ql-stroke-miter,.ql-snow .ql-toolbar button.ql-active .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke-miter,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke-miter,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-stroke-miter,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-stroke-miter,.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-stroke-miter{stroke:#06c}@media (pointer:coarse){.ql-snow.ql-toolbar button:hover:not(.ql-active),.ql-snow .ql-toolbar button:hover:not(.ql-active){color:#444}.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-fill,.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-fill,.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-stroke.ql-fill,.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-stroke.ql-fill{fill:#444}.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-stroke,.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-stroke,.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-stroke-miter,.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-stroke-miter{stroke:#444}}.ql-snow{box-sizing:border-box}.ql-snow *{box-sizing:border-box}.ql-snow .ql-hidden{display:none}.ql-snow .ql-out-bottom,.ql-snow .ql-out-top{visibility:hidden}.ql-snow .ql-tooltip{position:absolute;transform:translateY(10px)}.ql-snow .ql-tooltip a{cursor:pointer;text-decoration:none}.ql-snow .ql-tooltip.ql-flip{transform:translateY(-10px)}.ql-snow .ql-formats{display:inline-block;vertical-align:middle}.ql-snow .ql-formats:after{clear:both;content:'';display:table}.ql-snow .ql-stroke{fill:none;stroke:#444;stroke-linecap:round;stroke-linejoin:round;stroke-width:2}.ql-snow .ql-stroke-miter{fill:none;stroke:#444;stroke-miterlimit:10;stroke-width:2}.ql-snow .ql-fill,.ql-snow .ql-stroke.ql-fill{fill:#444}.ql-snow .ql-empty{fill:none}.ql-snow .ql-even{fill-rule:evenodd}.ql-snow .ql-thin,.ql-snow .ql-stroke.ql-thin{stroke-width:1}.ql-snow .ql-transparent{opacity:.4}.ql-snow .ql-direction svg:last-child{display:none}.ql-snow .ql-direction.ql-active svg:last-child{display:inline}.ql-snow .ql-direction.ql-active svg:first-child{display:none}.ql-snow .ql-editor h1{font-size:2em}.ql-snow .ql-editor h2{font-size:1.5em}.ql-snow .ql-editor h3{font-size:1.17em}.ql-snow .ql-editor h4{font-size:1em}.ql-snow .ql-editor h5{font-size:.83em}.ql-snow .ql-editor h6{font-size:.67em}.ql-snow .ql-editor a{text-decoration:underline}.ql-snow .ql-editor blockquote{border-left:4px solid #ccc;margin-bottom:5px;margin-top:5px;padding-left:16px}.ql-snow .ql-editor code,.ql-snow .ql-editor .ql-code-block-container{background-color:#f0f0f0;border-radius:3px}.ql-snow .ql-editor .ql-code-block-container{margin-bottom:5px;margin-top:5px;padding:5px 10px}.ql-snow .ql-editor code{font-size:85%;padding:2px 4px}.ql-snow .ql-editor .ql-code-block-container{background-color:#23241f;color:#f8f8f2;overflow:visible}.ql-snow .ql-editor img{max-width:100%}.ql-snow .ql-picker{color:#444;display:inline-block;float:left;font-size:14px;font-weight:500;height:24px;position:relative;vertical-align:middle}.ql-snow .ql-picker-label{cursor:pointer;display:inline-block;height:100%;padding-left:8px;padding-right:2px;position:relative;width:100%}.ql-snow .ql-picker-label::before{display:inline-block;line-height:22px}.ql-snow .ql-picker-options{background-color:#fff;display:none;min-width:100%;padding:4px 8px;position:absolute;white-space:nowrap}.ql-snow .ql-picker-options .ql-picker-item{cursor:pointer;display:block;padding-bottom:5px;padding-top:5px}.ql-snow .ql-picker.ql-expanded .ql-picker-label{color:#ccc;z-index:2}.ql-snow .ql-picker.ql-expanded .ql-picker-label .ql-fill{fill:#ccc}.ql-snow .ql-picker.ql-expanded .ql-picker-label .ql-stroke{stroke:#ccc}.ql-snow .ql-picker.ql-expanded .ql-picker-options{display:block;margin-top:-1px;top:100%;z-index:1}.ql-snow .ql-color-picker,.ql-snow .ql-icon-picker{width:28px}.ql-snow .ql-color-picker .ql-picker-label,.ql-snow .ql-icon-picker .ql-picker-label{padding:2px 4px}.ql-snow .ql-color-picker .ql-picker-label svg,.ql-snow .ql-icon-picker .ql-picker-label svg{right:4px}.ql-snow .ql-icon-picker .ql-picker-options{padding:4px 0}.ql-snow .ql-icon-picker .ql-picker-item{height:24px;width:24px;padding:2px 4px}.ql-snow .ql-color-picker .ql-picker-options{padding:3px 5px;width:152px}.ql-snow .ql-color-picker .ql-picker-item{border:1px solid transparent;float:left;height:16px;margin:2px;padding:0;width:16px}.ql-snow .ql-picker:not(.ql-color-picker):not(.ql-icon-picker) svg{position:absolute;margin-top:-9px;right:0;top:50%;width:18px}.ql-snow .ql-picker.ql-header .ql-picker-label[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-font .ql-picker-label[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-size .ql-picker-label[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-font .ql-picker-item[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-size .ql-picker-item[data-label]:not([data-label=''])::before{content:attr(data-label)}.ql-snow .ql-picker.ql-header{width:98px}.ql-snow .ql-picker.ql-header .ql-picker-label::before,.ql-snow .ql-picker.ql-header .ql-picker-item::before{content:'Normal'}.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"1\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"1\"]::before{content:'Heading 1'}.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"2\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"2\"]::before{content:'Heading 2'}.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"3\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"3\"]::before{content:'Heading 3'}.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"4\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"4\"]::before{content:'Heading 4'}.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"5\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"5\"]::before{content:'Heading 5'}.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"6\"]::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"6\"]::before{content:'Heading 6'}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"1\"]::before{font-size:2em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"2\"]::before{font-size:1.5em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"3\"]::before{font-size:1.17em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"4\"]::before{font-size:1em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"5\"]::before{font-size:.83em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"6\"]::before{font-size:.67em}.ql-snow .ql-picker.ql-font{width:108px}.ql-snow .ql-picker.ql-font .ql-picker-label::before,.ql-snow .ql-picker.ql-font .ql-picker-item::before{content:'Sans Serif'}.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=serif]::before,.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=serif]::before{content:'Serif'}.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=monospace]::before,.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=monospace]::before{content:'Monospace'}.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=serif]::before{font-family:Georgia,Times New Roman,serif}.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=monospace]::before{font-family:Monaco,Courier New,monospace}.ql-snow .ql-picker.ql-size{width:98px}.ql-snow .ql-picker.ql-size .ql-picker-label::before,.ql-snow .ql-picker.ql-size .ql-picker-item::before{content:'Normal'}.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=small]::before,.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=small]::before{content:'Small'}.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=large]::before,.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=large]::before{content:'Large'}.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=huge]::before,.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=huge]::before{content:'Huge'}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=small]::before{font-size:10px}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=large]::before{font-size:18px}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=huge]::before{font-size:32px}.ql-snow .ql-color-picker.ql-background .ql-picker-item{background-color:#fff}.ql-snow .ql-color-picker.ql-color .ql-picker-item{background-color:#000}.ql-code-block-container{position:relative}.ql-code-block-container .ql-ui{right:5px;top:5px}.ql-toolbar.ql-snow{border:1px solid #ccc;box-sizing:border-box;font-family:'Helvetica Neue','Helvetica','Arial',sans-serif;padding:8px}.ql-toolbar.ql-snow .ql-formats{margin-right:15px}.ql-toolbar.ql-snow .ql-picker-label{border:1px solid transparent}.ql-toolbar.ql-snow .ql-picker-options{border:1px solid transparent;box-shadow:rgba(0,0,0,0.2) 0 2px 8px}.ql-toolbar.ql-snow .ql-picker.ql-expanded .ql-picker-label{border-color:#ccc}.ql-toolbar.ql-snow .ql-picker.ql-expanded .ql-picker-options{border-color:#ccc}.ql-toolbar.ql-snow .ql-color-picker .ql-picker-item.ql-selected,.ql-toolbar.ql-snow .ql-color-picker .ql-picker-item:hover{border-color:#000}.ql-toolbar.ql-snow + .ql-container.ql-snow{border-top:0}.ql-snow .ql-tooltip{background-color:#fff;border:1px solid #ccc;box-shadow:0 0 5px #ddd;color:#444;padding:5px 12px;white-space:nowrap}.ql-snow .ql-tooltip::before{content:\"Visit URL:\";line-height:26px;margin-right:8px}.ql-snow .ql-tooltip input[type=text]{display:none;border:1px solid #ccc;font-size:13px;height:26px;margin:0;padding:3px 5px;width:170px}.ql-snow .ql-tooltip a.ql-preview{display:inline-block;max-width:200px;overflow-x:hidden;text-overflow:ellipsis;vertical-align:top}.ql-snow .ql-tooltip a.ql-action::after{border-right:1px solid #ccc;content:'Edit';margin-left:16px;padding-right:8px}.ql-snow .ql-tooltip a.ql-remove::before{content:'Remove';margin-left:8px}.ql-snow .ql-tooltip a{line-height:26px}.ql-snow .ql-tooltip.ql-editing a.ql-preview,.ql-snow .ql-tooltip.ql-editing a.ql-remove{display:none}.ql-snow .ql-tooltip.ql-editing input[type=text]{display:inline-block}.ql-snow .ql-tooltip.ql-editing a.ql-action::after{border-right:0;content:'Save';padding-right:0}.ql-snow .ql-tooltip[data-mode=link]::before{content:\"Enter link:\"}.ql-snow .ql-tooltip[data-mode=formula]::before{content:\"Enter formula:\"}.ql-snow .ql-tooltip[data-mode=video]::before{content:\"Enter video:\"}.ql-snow a{color:#06c}.ql-container.ql-snow{border:1px solid #ccc}",""]);const o=s},6907:(e,t,r)=>{var n=r(5969),i=r(6690);e.exports=function(e,t){var r,a,s,o;return r=function(e){var t=n.copyOptions(e);return n.ensureSpacesExists(t),t}(t),a=i(e,r),o="compact"in r&&r.compact?"_parent":"parent",s="addParent"in r&&r.addParent?JSON.stringify(a,(function(e,t){return e===o?"_":t}),r.spaces):JSON.stringify(a,null,r.spaces),s.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}},6942:(e,t)=>{var r;!function(){var n={}.hasOwnProperty;function i(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];r&&(e=s(e,a(r)))}return e}function a(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return i.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var r in e)n.call(e,r)&&e[r]&&(t=s(t,r));return t}function s(e,t){return t?e?e+" "+t:e+t:e}e.exports?(i.default=i,e.exports=i):void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()},7057:(e,t,r)=>{var n=r(7163),i=/[\/\+\.]/;e.exports=function(e,t){function r(t){var r=n(t,e,i);return r&&r.length>=2}return t?r(t.split(";")[0]):r}},7163:e=>{function t(e,t){this.text=e=e||"",this.hasWild=~e.indexOf("*"),this.separator=t,this.parts=e.split(t)}t.prototype.match=function(e){var t,r,n=!0,i=this.parts,a=i.length;if("string"==typeof e||e instanceof String)if(this.hasWild||this.text==e){for(r=(e||"").split(this.separator),t=0;n&&t<a;t++)"*"!==i[t]&&(n=t<r.length&&i[t]===r[t]);n=n&&r}else n=!1;else if("function"==typeof e.splice)for(n=[],t=e.length;t--;)this.match(e[t])&&(n[n.length]=e[t]);else if("object"==typeof e)for(var s in n={},e)this.match(s)&&(n[s]=e[s]);return n},e.exports=function(e,r,n){var i=new t(e,n||/[\/\.]/);return void 0!==r?i.match(r):i}},7193:(e,t,r)=>{e=r.nmd(e);var n="__lodash_hash_undefined__",i=9007199254740991,a="[object Arguments]",s="[object Boolean]",o="[object Date]",l="[object Function]",c="[object GeneratorFunction]",d="[object Map]",u="[object Number]",p="[object Object]",h="[object Promise]",f="[object RegExp]",m="[object Set]",g="[object String]",_="[object Symbol]",b="[object WeakMap]",v="[object ArrayBuffer]",y="[object DataView]",w="[object Float32Array]",E="[object Float64Array]",S="[object Int8Array]",T="[object Int16Array]",C="[object Int32Array]",x="[object Uint8Array]",A="[object Uint8ClampedArray]",I="[object Uint16Array]",D="[object Uint32Array]",k=/\w*$/,L=/^\[object .+?Constructor\]$/,P=/^(?:0|[1-9]\d*)$/,O={};O[a]=O["[object Array]"]=O[v]=O[y]=O[s]=O[o]=O[w]=O[E]=O[S]=O[T]=O[C]=O[d]=O[u]=O[p]=O[f]=O[m]=O[g]=O[_]=O[x]=O[A]=O[I]=O[D]=!0,O["[object Error]"]=O[l]=O[b]=!1;var R="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,N="object"==typeof self&&self&&self.Object===Object&&self,B=R||N||Function("return this")(),F=t&&!t.nodeType&&t,U=F&&e&&!e.nodeType&&e,M=U&&U.exports===F;function q(e,t){return e.set(t[0],t[1]),e}function z(e,t){return e.add(t),e}function H(e,t,r,n){var i=-1,a=e?e.length:0;for(n&&a&&(r=e[++i]);++i<a;)r=t(r,e[i],i,e);return r}function W(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function j(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function V(e,t){return function(r){return e(t(r))}}function $(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var G,X=Array.prototype,K=Function.prototype,Y=Object.prototype,Q=B["__core-js_shared__"],Z=(G=/[^.]+$/.exec(Q&&Q.keys&&Q.keys.IE_PROTO||""))?"Symbol(src)_1."+G:"",J=K.toString,ee=Y.hasOwnProperty,te=Y.toString,re=RegExp("^"+J.call(ee).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ne=M?B.Buffer:void 0,ie=B.Symbol,ae=B.Uint8Array,se=V(Object.getPrototypeOf,Object),oe=Object.create,le=Y.propertyIsEnumerable,ce=X.splice,de=Object.getOwnPropertySymbols,ue=ne?ne.isBuffer:void 0,pe=V(Object.keys,Object),he=Be(B,"DataView"),fe=Be(B,"Map"),me=Be(B,"Promise"),ge=Be(B,"Set"),_e=Be(B,"WeakMap"),be=Be(Object,"create"),ve=ze(he),ye=ze(fe),we=ze(me),Ee=ze(ge),Se=ze(_e),Te=ie?ie.prototype:void 0,Ce=Te?Te.valueOf:void 0;function xe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ae(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ie(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function De(e){this.__data__=new Ae(e)}function ke(e,t,r){var n=e[t];ee.call(e,t)&&He(n,r)&&(void 0!==r||t in e)||(e[t]=r)}function Le(e,t){for(var r=e.length;r--;)if(He(e[r][0],t))return r;return-1}function Pe(e,t,r,n,i,h,b){var L;if(n&&(L=h?n(e,i,h,b):n(e)),void 0!==L)return L;if(!Ge(e))return e;var P=We(e);if(P){if(L=function(e){var t=e.length,r=e.constructor(t);return t&&"string"==typeof e[0]&&ee.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(e),!t)return function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}(e,L)}else{var R=Ue(e),N=R==l||R==c;if(Ve(e))return function(e,t){if(t)return e.slice();var r=new e.constructor(e.length);return e.copy(r),r}(e,t);if(R==p||R==a||N&&!h){if(W(e))return h?e:{};if(L=function(e){return"function"!=typeof e.constructor||qe(e)?{}:Ge(t=se(e))?oe(t):{};var t}(N?{}:e),!t)return function(e,t){return Re(e,Fe(e),t)}(e,function(e,t){return e&&Re(t,Xe(t),e)}(L,e))}else{if(!O[R])return h?e:{};L=function(e,t,r,n){var i,a=e.constructor;switch(t){case v:return Oe(e);case s:case o:return new a(+e);case y:return function(e,t){var r=t?Oe(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,n);case w:case E:case S:case T:case C:case x:case A:case I:case D:return function(e,t){var r=t?Oe(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}(e,n);case d:return function(e,t,r){return H(t?r(j(e),!0):j(e),q,new e.constructor)}(e,n,r);case u:case g:return new a(e);case f:return function(e){var t=new e.constructor(e.source,k.exec(e));return t.lastIndex=e.lastIndex,t}(e);case m:return function(e,t,r){return H(t?r($(e),!0):$(e),z,new e.constructor)}(e,n,r);case _:return i=e,Ce?Object(Ce.call(i)):{}}}(e,R,Pe,t)}}b||(b=new De);var B=b.get(e);if(B)return B;if(b.set(e,L),!P)var F=r?function(e){return function(e,t,r){var n=t(e);return We(e)?n:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(n,r(e))}(e,Xe,Fe)}(e):Xe(e);return function(e,t){for(var r=-1,n=e?e.length:0;++r<n&&!1!==t(e[r],r););}(F||e,(function(i,a){F&&(i=e[a=i]),ke(L,a,Pe(i,t,r,n,a,e,b))})),L}function Oe(e){var t=new e.constructor(e.byteLength);return new ae(t).set(new ae(e)),t}function Re(e,t,r,n){r||(r={});for(var i=-1,a=t.length;++i<a;){var s=t[i],o=n?n(r[s],e[s],s,r,e):void 0;ke(r,s,void 0===o?e[s]:o)}return r}function Ne(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function Be(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!Ge(e)||(t=e,Z&&Z in t))&&($e(e)||W(e)?re:L).test(ze(e));var t}(r)?r:void 0}xe.prototype.clear=function(){this.__data__=be?be(null):{}},xe.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},xe.prototype.get=function(e){var t=this.__data__;if(be){var r=t[e];return r===n?void 0:r}return ee.call(t,e)?t[e]:void 0},xe.prototype.has=function(e){var t=this.__data__;return be?void 0!==t[e]:ee.call(t,e)},xe.prototype.set=function(e,t){return this.__data__[e]=be&&void 0===t?n:t,this},Ae.prototype.clear=function(){this.__data__=[]},Ae.prototype.delete=function(e){var t=this.__data__,r=Le(t,e);return!(r<0||(r==t.length-1?t.pop():ce.call(t,r,1),0))},Ae.prototype.get=function(e){var t=this.__data__,r=Le(t,e);return r<0?void 0:t[r][1]},Ae.prototype.has=function(e){return Le(this.__data__,e)>-1},Ae.prototype.set=function(e,t){var r=this.__data__,n=Le(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},Ie.prototype.clear=function(){this.__data__={hash:new xe,map:new(fe||Ae),string:new xe}},Ie.prototype.delete=function(e){return Ne(this,e).delete(e)},Ie.prototype.get=function(e){return Ne(this,e).get(e)},Ie.prototype.has=function(e){return Ne(this,e).has(e)},Ie.prototype.set=function(e,t){return Ne(this,e).set(e,t),this},De.prototype.clear=function(){this.__data__=new Ae},De.prototype.delete=function(e){return this.__data__.delete(e)},De.prototype.get=function(e){return this.__data__.get(e)},De.prototype.has=function(e){return this.__data__.has(e)},De.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Ae){var n=r.__data__;if(!fe||n.length<199)return n.push([e,t]),this;r=this.__data__=new Ie(n)}return r.set(e,t),this};var Fe=de?V(de,Object):function(){return[]},Ue=function(e){return te.call(e)};function Me(e,t){return!!(t=null==t?i:t)&&("number"==typeof e||P.test(e))&&e>-1&&e%1==0&&e<t}function qe(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Y)}function ze(e){if(null!=e){try{return J.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function He(e,t){return e===t||e!=e&&t!=t}(he&&Ue(new he(new ArrayBuffer(1)))!=y||fe&&Ue(new fe)!=d||me&&Ue(me.resolve())!=h||ge&&Ue(new ge)!=m||_e&&Ue(new _e)!=b)&&(Ue=function(e){var t=te.call(e),r=t==p?e.constructor:void 0,n=r?ze(r):void 0;if(n)switch(n){case ve:return y;case ye:return d;case we:return h;case Ee:return m;case Se:return b}return t});var We=Array.isArray;function je(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}(e.length)&&!$e(e)}var Ve=ue||function(){return!1};function $e(e){var t=Ge(e)?te.call(e):"";return t==l||t==c}function Ge(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Xe(e){return je(e)?function(e,t){var r=We(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&je(e)}(e)&&ee.call(e,"callee")&&(!le.call(e,"callee")||te.call(e)==a)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,i=!!n;for(var s in e)!t&&!ee.call(e,s)||i&&("length"==s||Me(s,n))||r.push(s);return r}(e):function(e){if(!qe(e))return pe(e);var t=[];for(var r in Object(e))ee.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)}e.exports=function(e){return Pe(e,!0,!0)}},7204:(e,t,r)=>{r.d(t,{A:()=>p});var n=r(1601),i=r.n(n),a=r(6314),s=r.n(a),o=r(4417),l=r.n(o),c=new URL(r(4107),r.b),d=s()(i()),u=l()(c);d.push([e.id,`.uppy-ImageCropper-range{-webkit-appearance:none;background:#0000;margin:8px 0;width:100%}.uppy-ImageCropper-range::-moz-focus-outer{border:0}.uppy-ImageCropper-range:focus{outline:0}.uppy-ImageCropper-range:focus::-webkit-slider-runnable-track{background:#fff3}.uppy-ImageCropper-range:focus::-ms-fill-lower,.uppy-ImageCropper-range:focus::-ms-fill-upper{background:#fff3}.uppy-ImageCropper-range::-webkit-slider-runnable-track{background:#fff3;border:0 solid #0000;border-radius:5px;box-shadow:0 0 0 #0000,0 0 0 #0d0d0d00;cursor:default;height:4px;-webkit-transition:all .2s ease;transition:all .2s ease;width:100%}.uppy-ImageCropper-range::-webkit-slider-thumb{-webkit-appearance:none;background:#fff;border:0 solid #0000;border-radius:9px;box-shadow:0 0 4px #0003,0 0 0 #0d0d0d33;box-sizing:border-box;cursor:default;height:16px;margin-top:-6px;width:16px}.uppy-ImageCropper-range::-moz-range-track{background:#fff3;border:0 solid #0000;border-radius:5px;box-shadow:0 0 0 #0000,0 0 0 #0d0d0d00;cursor:default;height:2px;-moz-transition:all .2s ease;transition:all .2s ease;width:100%}.uppy-ImageCropper-range::-moz-range-thumb{background:#fff;border:0 solid #0000;border-radius:9px;box-shadow:0 0 4px #0003,0 0 0 #0d0d0d33;box-sizing:border-box;cursor:default;height:16px;width:16px}.uppy-ImageCropper-range::-ms-track{background:#0000;border-color:#0000;border-width:8px 0;color:#0000;cursor:default;height:4px;-ms-transition:all .2s ease;transition:all .2s ease;width:100%}.uppy-ImageCropper-range::-ms-fill-lower{background:#f2f2f233;border:0 solid #0000;border-radius:10px;box-shadow:0 0 0 #0000,0 0 0 #0d0d0d00}.uppy-ImageCropper-range::-ms-fill-upper{background:#fff3;border:0 solid #0000;border-radius:10px;box-shadow:0 0 0 #0000,0 0 0 #0d0d0d00}.uppy-ImageCropper-range::-ms-thumb{background:#fff;border:0 solid #0000;border-radius:9px;box-shadow:0 0 4px #0003,0 0 0 #0d0d0d33;box-sizing:border-box;cursor:default;height:16px;margin-top:1px;width:16px}.uppy-ImageCropper-range:disabled::-moz-range-thumb,.uppy-ImageCropper-range:disabled::-ms-fill-lower,.uppy-ImageCropper-range:disabled::-ms-fill-upper,.uppy-ImageCropper-range:disabled::-ms-thumb,.uppy-ImageCropper-range:disabled::-webkit-slider-runnable-track,.uppy-ImageCropper-range:disabled::-webkit-slider-thumb{cursor:not-allowed}\n\n/*!\n * Cropper.js v1.5.6\n * https://fengyuanchen.github.io/cropperjs\n *\n * Copyright 2015-present Chen Fengyuan\n * Released under the MIT license\n *\n * Date: 2019-10-04T04:33:44.164Z\n */.cropper-container{direction:ltr;font-size:0;line-height:0;position:relative;touch-action:none;-webkit-user-select:none;user-select:none}.cropper-container img{display:block;height:100%;image-orientation:0deg;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;width:100%}.cropper-canvas,.cropper-crop-box,.cropper-drag-box,.cropper-modal,.cropper-wrap-box{bottom:0;left:0;position:absolute;right:0;top:0}.cropper-canvas,.cropper-wrap-box{overflow:hidden}.cropper-drag-box{background-color:#fff;opacity:0}.cropper-modal{background-color:#000;opacity:.5}.cropper-view-box{display:block;height:100%;outline:1px solid #39f;outline-color:#3399ffbf;overflow:hidden;width:100%}.cropper-dashed{border:0 dashed #eee;display:block;opacity:.5;position:absolute}.cropper-dashed.dashed-h{border-bottom-width:1px;border-top-width:1px;height:33.3333333333%;left:0;top:33.3333333333%;width:100%}.cropper-dashed.dashed-v{border-left-width:1px;border-right-width:1px;height:100%;left:33.3333333333%;top:0;width:33.3333333333%}.cropper-center{display:block;height:0;left:50%;opacity:.75;position:absolute;top:50%;width:0}.cropper-center:after,.cropper-center:before{background-color:#eee;content:" ";display:block;position:absolute}.cropper-center:before{height:1px;left:-3px;top:0;width:7px}.cropper-center:after{height:7px;left:0;top:-3px;width:1px}.cropper-face,.cropper-line,.cropper-point{display:block;height:100%;opacity:.1;position:absolute;width:100%}.cropper-face{background-color:#fff;left:0;top:0}.cropper-line{background-color:#39f}.cropper-line.line-e{cursor:ew-resize;right:-3px;top:0;width:5px}.cropper-line.line-n{cursor:ns-resize;height:5px;left:0;top:-3px}.cropper-line.line-w{cursor:ew-resize;left:-3px;top:0;width:5px}.cropper-line.line-s{bottom:-3px;cursor:ns-resize;height:5px;left:0}.cropper-point{background-color:#39f;height:5px;opacity:.75;width:5px}.cropper-point.point-e{cursor:ew-resize;margin-top:-3px;right:-3px;top:50%}.cropper-point.point-n{cursor:ns-resize;left:50%;margin-left:-3px;top:-3px}.cropper-point.point-w{cursor:ew-resize;left:-3px;margin-top:-3px;top:50%}.cropper-point.point-s{bottom:-3px;cursor:s-resize;left:50%;margin-left:-3px}.cropper-point.point-ne{cursor:nesw-resize;right:-3px;top:-3px}.cropper-point.point-nw{cursor:nwse-resize;left:-3px;top:-3px}.cropper-point.point-sw{bottom:-3px;cursor:nesw-resize;left:-3px}.cropper-point.point-se{bottom:-3px;cursor:nwse-resize;height:20px;opacity:1;right:-3px;width:20px}@media (min-width:768px){.cropper-point.point-se{height:15px;width:15px}}@media (min-width:992px){.cropper-point.point-se{height:10px;width:10px}}@media (min-width:1200px){.cropper-point.point-se{height:5px;opacity:.75;width:5px}}.cropper-point.point-se:before{background-color:#39f;bottom:-50%;content:" ";display:block;height:200%;opacity:0;position:absolute;right:-50%;width:200%}.cropper-invisible{opacity:0}.cropper-bg{background-image:url(${u})}.cropper-hide{display:block;height:0;position:absolute;width:0}.cropper-hidden{display:none!important}.cropper-move{cursor:move}.cropper-crop{cursor:crosshair}.cropper-disabled .cropper-drag-box,.cropper-disabled .cropper-face,.cropper-disabled .cropper-line,.cropper-disabled .cropper-point{cursor:not-allowed}.uppy-ImageCropper{display:flex;flex-direction:column;height:100%;width:100%}.uppy-ImageCropper-container{flex-grow:1}.uppy-ImageCropper-image{display:block;max-height:400px;max-width:100%}.uppy-ImageCropper-controls{align-items:center;background-color:#0009;border-radius:5px;bottom:15px;color:#fff;display:flex;justify-content:center;left:50%;padding-top:38px;position:absolute;transform:translateX(-50%)}.uppy-size--md .uppy-ImageCropper-controls{padding-top:0}.uppy-ImageCropper-controls button{border-radius:5px;height:35px;width:35px}.uppy-ImageCropper-controls button svg{padding:3px}.uppy-size--md .uppy-ImageCropper-controls button{height:40px;width:40px}.uppy-size--md .uppy-ImageCropper-controls button svg{padding:1px}.uppy-ImageCropper-controls button:hover{background-color:#ffffff80}.uppy-ImageCropper-controls button:focus{background-color:#ffffff80;outline:none}.uppy-Dashboard:not(.uppy-size--md) .uppy-ImageCropper-rangeWrapper{height:38px;left:10px;position:absolute!important;right:10px;top:0}.uppy-size--md .uppy-ImageCropper-range{margin-left:5px;margin-right:5px;width:180px}.uppy-ImageCropper .cropper-point{height:8px;width:8px}.uppy-ImageCropper .cropper-view-box{background:repeating-conic-gradient(#bdbdbd33 0 25%,#fff 0 50%) 50%/16px 16px;outline:2px solid #39f}[data-uppy-theme=dark] .uppy-ImageCropper .cropper-view-box{background:repeating-conic-gradient(#2b2a2a 0 25%,#000 0 50%) 50%/16px 16px}.uppy-ImageCropper .cropper-modal{background-color:#fff;opacity:.9}[data-uppy-theme=dark] .uppy-ImageCropper .cropper-modal{background-color:#000;opacity:.7}.uppy-ImageCropper .cropper-face{opacity:0}.uppy-ImageCropper-range::-moz-range-track{height:4px}.uppy-ImageCropper-range:focus::-webkit-slider-runnable-track,.uppy-ImageCropper-range:hover::-webkit-slider-runnable-track{background:#ffffff80}.uppy-ImageCropper-range:focus::-ms-fill-lower,.uppy-ImageCropper-range:focus::-ms-fill-upper,.uppy-ImageCropper-range:hover::-ms-fill-lower,.uppy-ImageCropper-range:hover::-ms-fill-upper{background:#ffffff80}.uppy-ImageCropper-range:focus::-moz-range-track,.uppy-ImageCropper-range:hover::-moz-range-track{background:#ffffff80}`,""]);const p=d},7283:e=>{e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2748%27 height=%2748%27%3E%3Cpath fill=%27%2302BAF2%27 d=%27M24 1v1C11.85 2 2 11.85 2 24s9.85 22 22 22 22-9.85 22-22S36.15 2 24 2zm0 0V0c13.254 0 24 10.746 24 24S37.254 48 24 48 0 37.254 0 24 10.746 0 24 0zm7.707 19.293a.999.999 0 1 1-1.414 1.414L25 16.414V34a1 1 0 1 1-2 0V16.414l-5.293 5.293a.999.999 0 1 1-1.414-1.414l7-7a1 1 0 0 1 1.414 0z%27/%3E%3C/svg%3E"},7348:(e,t,r)=>{var n,i,a=r(5193),s=r(9740).isArray;function o(e,t,r){return(!r&&e.spaces?"\n":"")+Array(t+1).join(e.spaces)}function l(e,t,r){if(t.ignoreAttributes)return"";"attributesFn"in t&&(e=t.attributesFn(e,i,n));var a,s,l,c,d=[];for(a in e)e.hasOwnProperty(a)&&null!==e[a]&&void 0!==e[a]&&(c=t.noQuotesForNativeAttributes&&"string"!=typeof e[a]?"":'"',s=(s=""+e[a]).replace(/"/g,"&quot;"),l="attributeNameFn"in t?t.attributeNameFn(a,s,i,n):a,d.push(t.spaces&&t.indentAttributes?o(t,r+1,!1):" "),d.push(l+"="+c+("attributeValueFn"in t?t.attributeValueFn(s,a,i,n):s)+c));return e&&Object.keys(e).length&&t.spaces&&t.indentAttributes&&d.push(o(t,r,!1)),d.join("")}function c(e,t,r){return n=e,i="xml",t.ignoreDeclaration?"":"<?xml"+l(e[t.attributesKey],t,r)+"?>"}function d(e,t,r){if(t.ignoreInstruction)return"";var a;for(a in e)if(e.hasOwnProperty(a))break;var s="instructionNameFn"in t?t.instructionNameFn(a,e[a],i,n):a;if("object"==typeof e[a])return n=e,i=s,"<?"+s+l(e[a][t.attributesKey],t,r)+"?>";var o=e[a]?e[a]:"";return"instructionFn"in t&&(o=t.instructionFn(o,a,i,n)),"<?"+s+(o?" "+o:"")+"?>"}function u(e,t){return t.ignoreComment?"":"\x3c!--"+("commentFn"in t?t.commentFn(e,i,n):e)+"--\x3e"}function p(e,t){return t.ignoreCdata?"":"<![CDATA["+("cdataFn"in t?t.cdataFn(e,i,n):e.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function h(e,t){return t.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in t?t.doctypeFn(e,i,n):e)+">"}function f(e,t){return t.ignoreText?"":(e=(e=(e=""+e).replace(/&amp;/g,"&")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in t?t.textFn(e,i,n):e)}function m(e,t,r,a){return e.reduce((function(e,s){var c=o(t,r,a&&!e);switch(s.type){case"element":return e+c+function(e,t,r){n=e,i=e.name;var a=[],s="elementNameFn"in t?t.elementNameFn(e.name,e):e.name;a.push("<"+s),e[t.attributesKey]&&a.push(l(e[t.attributesKey],t,r));var o=e[t.elementsKey]&&e[t.elementsKey].length||e[t.attributesKey]&&"preserve"===e[t.attributesKey]["xml:space"];return o||(o="fullTagEmptyElementFn"in t?t.fullTagEmptyElementFn(e.name,e):t.fullTagEmptyElement),o?(a.push(">"),e[t.elementsKey]&&e[t.elementsKey].length&&(a.push(m(e[t.elementsKey],t,r+1)),n=e,i=e.name),a.push(t.spaces&&function(e,t){var r;if(e.elements&&e.elements.length)for(r=0;r<e.elements.length;++r)switch(e.elements[r][t.typeKey]){case"text":if(t.indentText)return!0;break;case"cdata":if(t.indentCdata)return!0;break;case"instruction":if(t.indentInstruction)return!0;break;default:return!0}return!1}(e,t)?"\n"+Array(r+1).join(t.spaces):""),a.push("</"+s+">")):a.push("/>"),a.join("")}(s,t,r);case"comment":return e+c+u(s[t.commentKey],t);case"doctype":return e+c+h(s[t.doctypeKey],t);case"cdata":return e+(t.indentCdata?c:"")+p(s[t.cdataKey],t);case"text":return e+(t.indentText?c:"")+f(s[t.textKey],t);case"instruction":var g={};return g[s[t.nameKey]]=s[t.attributesKey]?s:s[t.instructionKey],e+(t.indentInstruction?c:"")+d(g,t,r)}}),"")}function g(e,t,r){var n;for(n in e)if(e.hasOwnProperty(n))switch(n){case t.parentKey:case t.attributesKey:break;case t.textKey:if(t.indentText||r)return!0;break;case t.cdataKey:if(t.indentCdata||r)return!0;break;case t.instructionKey:if(t.indentInstruction||r)return!0;break;case t.doctypeKey:case t.commentKey:default:return!0}return!1}function _(e,t,r,a,s){n=e,i=t;var c="elementNameFn"in r?r.elementNameFn(t,e):t;if(null==e||""===e)return"fullTagEmptyElementFn"in r&&r.fullTagEmptyElementFn(t,e)||r.fullTagEmptyElement?"<"+c+"></"+c+">":"<"+c+"/>";var d=[];if(t){if(d.push("<"+c),"object"!=typeof e)return d.push(">"+f(e,r)+"</"+c+">"),d.join("");e[r.attributesKey]&&d.push(l(e[r.attributesKey],r,a));var u=g(e,r,!0)||e[r.attributesKey]&&"preserve"===e[r.attributesKey]["xml:space"];if(u||(u="fullTagEmptyElementFn"in r?r.fullTagEmptyElementFn(t,e):r.fullTagEmptyElement),!u)return d.push("/>"),d.join("");d.push(">")}return d.push(b(e,r,a+1,!1)),n=e,i=t,t&&d.push((s?o(r,a,!1):"")+"</"+c+">"),d.join("")}function b(e,t,r,n){var i,a,l,m=[];for(a in e)if(e.hasOwnProperty(a))for(l=s(e[a])?e[a]:[e[a]],i=0;i<l.length;++i){switch(a){case t.declarationKey:m.push(c(l[i],t,r));break;case t.instructionKey:m.push((t.indentInstruction?o(t,r,n):"")+d(l[i],t,r));break;case t.attributesKey:case t.parentKey:break;case t.textKey:m.push((t.indentText?o(t,r,n):"")+f(l[i],t));break;case t.cdataKey:m.push((t.indentCdata?o(t,r,n):"")+p(l[i],t));break;case t.doctypeKey:m.push(o(t,r,n)+h(l[i],t));break;case t.commentKey:m.push(o(t,r,n)+u(l[i],t));break;default:m.push(o(t,r,n)+_(l[i],a,t,r,g(l[i],t)))}n=n&&!m.length}return m.join("")}e.exports=function(e,t){t=function(e){var t=a.copyOptions(e);return a.ensureFlagExists("ignoreDeclaration",t),a.ensureFlagExists("ignoreInstruction",t),a.ensureFlagExists("ignoreAttributes",t),a.ensureFlagExists("ignoreText",t),a.ensureFlagExists("ignoreComment",t),a.ensureFlagExists("ignoreCdata",t),a.ensureFlagExists("ignoreDoctype",t),a.ensureFlagExists("compact",t),a.ensureFlagExists("indentText",t),a.ensureFlagExists("indentCdata",t),a.ensureFlagExists("indentAttributes",t),a.ensureFlagExists("indentInstruction",t),a.ensureFlagExists("fullTagEmptyElement",t),a.ensureFlagExists("noQuotesForNativeAttributes",t),a.ensureSpacesExists(t),"number"==typeof t.spaces&&(t.spaces=Array(t.spaces+1).join(" ")),a.ensureKeyExists("declaration",t),a.ensureKeyExists("instruction",t),a.ensureKeyExists("attributes",t),a.ensureKeyExists("text",t),a.ensureKeyExists("comment",t),a.ensureKeyExists("cdata",t),a.ensureKeyExists("doctype",t),a.ensureKeyExists("type",t),a.ensureKeyExists("name",t),a.ensureKeyExists("elements",t),a.checkFnExists("doctype",t),a.checkFnExists("instruction",t),a.checkFnExists("cdata",t),a.checkFnExists("comment",t),a.checkFnExists("text",t),a.checkFnExists("instructionName",t),a.checkFnExists("elementName",t),a.checkFnExists("attributeName",t),a.checkFnExists("attributeValue",t),a.checkFnExists("attributes",t),a.checkFnExists("fullTagEmptyElement",t),t}(t);var r=[];return n=e,i="_root_",t.compact?r.push(b(e,t,0,!0)):(e[t.declarationKey]&&r.push(c(e[t.declarationKey],t,0)),e[t.elementsKey]&&e[t.elementsKey].length&&r.push(m(e[t.elementsKey],t,0,!r.length))),r.join("")}},7350:(e,t,r)=>{var n=r(8221),i=r(3805);e.exports=function(e,t,r){var a=!0,s=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return i(r)&&(a="leading"in r?!!r.leading:a,s="trailing"in r?!!r.trailing:s),n(e,t,{leading:a,maxWait:t,trailing:s})}},7526:(e,t)=>{t.byteLength=function(e){var t=o(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,a=o(e),s=a[0],l=a[1],c=new i(function(e,t,r){return 3*(t+r)/4-r}(0,s,l)),d=0,u=l>0?s-4:s;for(r=0;r<u;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],c[d++]=t>>16&255,c[d++]=t>>8&255,c[d++]=255&t;return 2===l&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,c[d++]=255&t),1===l&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,c[d++]=t>>8&255,c[d++]=255&t),c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,a=[],s=16383,o=0,c=n-i;o<c;o+=s)a.push(l(e,o,o+s>c?c:o+s));return 1===i?(t=e[n-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),a.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)r[s]=a[s],n[a.charCodeAt(s)]=s;function o(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function l(e,t,n){for(var i,a,s=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},7659:e=>{var t={};e.exports=function(e,r){var n=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},7825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var i=void 0!==r.layer;i&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,i&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var a=r.sourceMap;a&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},7838:e=>{e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2735%27 height=%2739%27 viewBox=%270 0 35 39%27%3E%3Cpath fill=%27%2523000%27 d=%27M1.708 38.66c1.709 0 3.417-3.417 6.834-3.417s5.125 3.417 8.61 3.417c3.348 0 5.056-3.417 8.473-3.417 4.305 0 5.125 3.417 6.833 3.417.889 0 1.709-.889 1.709-1.709v-19.68C34.167-5.757 0-5.757 0 17.271v19.68c0 .82.888 1.709 1.708 1.709m8.542-17.084a3.383 3.383 0 0 1-3.417-3.416 3.383 3.383 0 0 1 3.417-3.417 3.383 3.383 0 0 1 3.417 3.417 3.383 3.383 0 0 1-3.417 3.416m13.667 0A3.383 3.383 0 0 1 20.5 18.16a3.383 3.383 0 0 1 3.417-3.417 3.383 3.383 0 0 1 3.416 3.417 3.383 3.383 0 0 1-3.416 3.416%27/%3E%3C/svg%3E"},8003:(e,t,r)=>{var n=r(5193),i=r(6538);e.exports=function(e,t){var r,a,s,o;return r=function(e){var t=n.copyOptions(e);return n.ensureSpacesExists(t),t}(t),a=i(e,r),o="compact"in r&&r.compact?"_parent":"parent",s="addParent"in r&&r.addParent?JSON.stringify(a,(function(e,t){return e===o?"_":t}),r.spaces):JSON.stringify(a,null,r.spaces),s.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}},8142:(e,t,r)=>{e=r.nmd(e);var n="__lodash_hash_undefined__",i=9007199254740991,a="[object Arguments]",s="[object Array]",o="[object Boolean]",l="[object Date]",c="[object Error]",d="[object Function]",u="[object Map]",p="[object Number]",h="[object Object]",f="[object Promise]",m="[object RegExp]",g="[object Set]",_="[object String]",b="[object WeakMap]",v="[object ArrayBuffer]",y="[object DataView]",w=/^\[object .+?Constructor\]$/,E=/^(?:0|[1-9]\d*)$/,S={};S["[object Float32Array]"]=S["[object Float64Array]"]=S["[object Int8Array]"]=S["[object Int16Array]"]=S["[object Int32Array]"]=S["[object Uint8Array]"]=S["[object Uint8ClampedArray]"]=S["[object Uint16Array]"]=S["[object Uint32Array]"]=!0,S[a]=S[s]=S[v]=S[o]=S[y]=S[l]=S[c]=S[d]=S[u]=S[p]=S[h]=S[m]=S[g]=S[_]=S[b]=!1;var T="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,C="object"==typeof self&&self&&self.Object===Object&&self,x=T||C||Function("return this")(),A=t&&!t.nodeType&&t,I=A&&e&&!e.nodeType&&e,D=I&&I.exports===A,k=D&&T.process,L=function(){try{return k&&k.binding&&k.binding("util")}catch(e){}}(),P=L&&L.isTypedArray;function O(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function R(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function N(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var B,F,U,M=Array.prototype,q=Function.prototype,z=Object.prototype,H=x["__core-js_shared__"],W=q.toString,j=z.hasOwnProperty,V=(B=/[^.]+$/.exec(H&&H.keys&&H.keys.IE_PROTO||""))?"Symbol(src)_1."+B:"",$=z.toString,G=RegExp("^"+W.call(j).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),X=D?x.Buffer:void 0,K=x.Symbol,Y=x.Uint8Array,Q=z.propertyIsEnumerable,Z=M.splice,J=K?K.toStringTag:void 0,ee=Object.getOwnPropertySymbols,te=X?X.isBuffer:void 0,re=(F=Object.keys,U=Object,function(e){return F(U(e))}),ne=Ie(x,"DataView"),ie=Ie(x,"Map"),ae=Ie(x,"Promise"),se=Ie(x,"Set"),oe=Ie(x,"WeakMap"),le=Ie(Object,"create"),ce=Pe(ne),de=Pe(ie),ue=Pe(ae),pe=Pe(se),he=Pe(oe),fe=K?K.prototype:void 0,me=fe?fe.valueOf:void 0;function ge(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function _e(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function be(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ve(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new be;++t<r;)this.add(e[t])}function ye(e){var t=this.__data__=new _e(e);this.size=t.size}function we(e,t){for(var r=e.length;r--;)if(Oe(e[r][0],t))return r;return-1}function Ee(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":J&&J in Object(e)?function(e){var t=j.call(e,J),r=e[J];try{e[J]=void 0;var n=!0}catch(e){}var i=$.call(e);return n&&(t?e[J]=r:delete e[J]),i}(e):function(e){return $.call(e)}(e)}function Se(e){return qe(e)&&Ee(e)==a}function Te(e,t,r,n,i){return e===t||(null==e||null==t||!qe(e)&&!qe(t)?e!=e&&t!=t:function(e,t,r,n,i,d){var f=Ne(e),b=Ne(t),w=f?s:ke(e),E=b?s:ke(t),S=(w=w==a?h:w)==h,T=(E=E==a?h:E)==h,C=w==E;if(C&&Be(e)){if(!Be(t))return!1;f=!0,S=!1}if(C&&!S)return d||(d=new ye),f||ze(e)?Ce(e,t,r,n,i,d):function(e,t,r,n,i,a,s){switch(r){case y:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case v:return!(e.byteLength!=t.byteLength||!a(new Y(e),new Y(t)));case o:case l:case p:return Oe(+e,+t);case c:return e.name==t.name&&e.message==t.message;case m:case _:return e==t+"";case u:var d=R;case g:var h=1&n;if(d||(d=N),e.size!=t.size&&!h)return!1;var f=s.get(e);if(f)return f==t;n|=2,s.set(e,t);var b=Ce(d(e),d(t),n,i,a,s);return s.delete(e),b;case"[object Symbol]":if(me)return me.call(e)==me.call(t)}return!1}(e,t,w,r,n,i,d);if(!(1&r)){var x=S&&j.call(e,"__wrapped__"),A=T&&j.call(t,"__wrapped__");if(x||A){var I=x?e.value():e,D=A?t.value():t;return d||(d=new ye),i(I,D,r,n,d)}}return!!C&&(d||(d=new ye),function(e,t,r,n,i,a){var s=1&r,o=xe(e),l=o.length;if(l!=xe(t).length&&!s)return!1;for(var c=l;c--;){var d=o[c];if(!(s?d in t:j.call(t,d)))return!1}var u=a.get(e);if(u&&a.get(t))return u==t;var p=!0;a.set(e,t),a.set(t,e);for(var h=s;++c<l;){var f=e[d=o[c]],m=t[d];if(n)var g=s?n(m,f,d,t,e,a):n(f,m,d,e,t,a);if(!(void 0===g?f===m||i(f,m,r,n,a):g)){p=!1;break}h||(h="constructor"==d)}if(p&&!h){var _=e.constructor,b=t.constructor;_==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof b&&b instanceof b||(p=!1)}return a.delete(e),a.delete(t),p}(e,t,r,n,i,d))}(e,t,r,n,Te,i))}function Ce(e,t,r,n,i,a){var s=1&r,o=e.length,l=t.length;if(o!=l&&!(s&&l>o))return!1;var c=a.get(e);if(c&&a.get(t))return c==t;var d=-1,u=!0,p=2&r?new ve:void 0;for(a.set(e,t),a.set(t,e);++d<o;){var h=e[d],f=t[d];if(n)var m=s?n(f,h,d,t,e,a):n(h,f,d,e,t,a);if(void 0!==m){if(m)continue;u=!1;break}if(p){if(!O(t,(function(e,t){if(s=t,!p.has(s)&&(h===e||i(h,e,r,n,a)))return p.push(t);var s}))){u=!1;break}}else if(h!==f&&!i(h,f,r,n,a)){u=!1;break}}return a.delete(e),a.delete(t),u}function xe(e){return function(e,t,r){var n=t(e);return Ne(e)?n:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(n,r(e))}(e,He,De)}function Ae(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function Ie(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!Me(e)||function(e){return!!V&&V in e}(e))&&(Fe(e)?G:w).test(Pe(e))}(r)?r:void 0}ge.prototype.clear=function(){this.__data__=le?le(null):{},this.size=0},ge.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ge.prototype.get=function(e){var t=this.__data__;if(le){var r=t[e];return r===n?void 0:r}return j.call(t,e)?t[e]:void 0},ge.prototype.has=function(e){var t=this.__data__;return le?void 0!==t[e]:j.call(t,e)},ge.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=le&&void 0===t?n:t,this},_e.prototype.clear=function(){this.__data__=[],this.size=0},_e.prototype.delete=function(e){var t=this.__data__,r=we(t,e);return!(r<0||(r==t.length-1?t.pop():Z.call(t,r,1),--this.size,0))},_e.prototype.get=function(e){var t=this.__data__,r=we(t,e);return r<0?void 0:t[r][1]},_e.prototype.has=function(e){return we(this.__data__,e)>-1},_e.prototype.set=function(e,t){var r=this.__data__,n=we(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},be.prototype.clear=function(){this.size=0,this.__data__={hash:new ge,map:new(ie||_e),string:new ge}},be.prototype.delete=function(e){var t=Ae(this,e).delete(e);return this.size-=t?1:0,t},be.prototype.get=function(e){return Ae(this,e).get(e)},be.prototype.has=function(e){return Ae(this,e).has(e)},be.prototype.set=function(e,t){var r=Ae(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},ve.prototype.add=ve.prototype.push=function(e){return this.__data__.set(e,n),this},ve.prototype.has=function(e){return this.__data__.has(e)},ye.prototype.clear=function(){this.__data__=new _e,this.size=0},ye.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},ye.prototype.get=function(e){return this.__data__.get(e)},ye.prototype.has=function(e){return this.__data__.has(e)},ye.prototype.set=function(e,t){var r=this.__data__;if(r instanceof _e){var n=r.__data__;if(!ie||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new be(n)}return r.set(e,t),this.size=r.size,this};var De=ee?function(e){return null==e?[]:(e=Object(e),function(t){for(var r=-1,n=null==t?0:t.length,i=0,a=[];++r<n;){var s=t[r];o=s,Q.call(e,o)&&(a[i++]=s)}var o;return a}(ee(e)))}:function(){return[]},ke=Ee;function Le(e,t){return!!(t=null==t?i:t)&&("number"==typeof e||E.test(e))&&e>-1&&e%1==0&&e<t}function Pe(e){if(null!=e){try{return W.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Oe(e,t){return e===t||e!=e&&t!=t}(ne&&ke(new ne(new ArrayBuffer(1)))!=y||ie&&ke(new ie)!=u||ae&&ke(ae.resolve())!=f||se&&ke(new se)!=g||oe&&ke(new oe)!=b)&&(ke=function(e){var t=Ee(e),r=t==h?e.constructor:void 0,n=r?Pe(r):"";if(n)switch(n){case ce:return y;case de:return u;case ue:return f;case pe:return g;case he:return b}return t});var Re=Se(function(){return arguments}())?Se:function(e){return qe(e)&&j.call(e,"callee")&&!Q.call(e,"callee")},Ne=Array.isArray,Be=te||function(){return!1};function Fe(e){if(!Me(e))return!1;var t=Ee(e);return t==d||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Ue(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}function Me(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function qe(e){return null!=e&&"object"==typeof e}var ze=P?function(e){return function(t){return e(t)}}(P):function(e){return qe(e)&&Ue(e.length)&&!!S[Ee(e)]};function He(e){return null!=(t=e)&&Ue(t.length)&&!Fe(t)?function(e,t){var r=Ne(e),n=!r&&Re(e),i=!r&&!n&&Be(e),a=!r&&!n&&!i&&ze(e),s=r||n||i||a,o=s?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],l=o.length;for(var c in e)!t&&!j.call(e,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Le(c,l))||o.push(c);return o}(e):function(e){if(r=(t=e)&&t.constructor,t!==("function"==typeof r&&r.prototype||z))return re(e);var t,r,n=[];for(var i in Object(e))j.call(e,i)&&"constructor"!=i&&n.push(i);return n}(e);var t}e.exports=function(e,t){return Te(e,t)}},8221:(e,t,r)=>{var n=r(3805),i=r(124),a=r(9374),s=Math.max,o=Math.min;e.exports=function(e,t,r){var l,c,d,u,p,h,f=0,m=!1,g=!1,_=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function b(t){var r=l,n=c;return l=c=void 0,f=t,u=e.apply(n,r)}function v(e){var r=e-h;return void 0===h||r>=t||r<0||g&&e-f>=d}function y(){var e=i();if(v(e))return w(e);p=setTimeout(y,function(e){var r=t-(e-h);return g?o(r,d-(e-f)):r}(e))}function w(e){return p=void 0,_&&l?b(e):(l=c=void 0,u)}function E(){var e=i(),r=v(e);if(l=arguments,c=this,h=e,r){if(void 0===p)return function(e){return f=e,p=setTimeout(y,t),m?b(e):u}(h);if(g)return clearTimeout(p),p=setTimeout(y,t),b(h)}return void 0===p&&(p=setTimeout(y,t)),u}return t=a(t)||0,n(r)&&(m=!!r.leading,d=(g="maxWait"in r)?s(a(r.maxWait)||0,t):d,_="trailing"in r?!!r.trailing:_),E.cancel=function(){void 0!==p&&clearTimeout(p),f=0,l=h=c=p=void 0},E.flush=function(){return void 0===p?u:w(i())},E}},8287:(e,t,r)=>{const n=r(7526),i=r(251),a="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50;const s=2147483647;function o(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return c(e,t,r)}function c(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|m(e,t);let n=o(r);const i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(K(e,Uint8Array)){const t=new Uint8Array(e);return h(t.buffer,t.byteOffset,t.byteLength)}return p(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(K(e,ArrayBuffer)||e&&K(e.buffer,ArrayBuffer))return h(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(K(e,SharedArrayBuffer)||e&&K(e.buffer,SharedArrayBuffer)))return h(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return l.from(n,t,r);const i=function(e){if(l.isBuffer(e)){const t=0|f(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||Y(e.length)?o(0):p(e):"Buffer"===e.type&&Array.isArray(e.data)?p(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return d(e),o(e<0?0:0|f(e))}function p(e){const t=e.length<0?0:0|f(e.length),r=o(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function h(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,l.prototype),n}function f(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function m(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||K(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return $(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(e).length;default:if(i)return n?-1:$(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,r);case"utf8":case"utf-8":return x(this,t,r);case"ascii":return I(this,t,r);case"latin1":case"binary":return D(this,t,r);case"base64":return C(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function _(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function b(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Y(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=l.from(t,n)),l.isBuffer(t))return 0===t.length?-1:v(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):v(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,r,n,i){let a,s=1,o=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,o/=2,l/=2,r/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){let n=-1;for(a=r;a<o;a++)if(c(e,a)===c(t,-1===n?0:a-n)){if(-1===n&&(n=a),a-n+1===l)return n*s}else-1!==n&&(a-=a-n),n=-1}else for(r+l>o&&(r=o-l),a=r;a>=0;a--){let r=!0;for(let n=0;n<l;n++)if(c(e,a+n)!==c(t,n)){r=!1;break}if(r)return a}return-1}function y(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const a=t.length;let s;for(n>a/2&&(n=a/2),s=0;s<n;++s){const n=parseInt(t.substr(2*s,2),16);if(Y(n))return s;e[r+s]=n}return s}function w(e,t,r,n){return X($(t,e.length-r),e,r,n)}function E(e,t,r,n){return X(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function S(e,t,r,n){return X(G(t),e,r,n)}function T(e,t,r,n){return X(function(e,t){let r,n,i;const a=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,i=r%256,a.push(i),a.push(n);return a}(t,e.length-r),e,r,n)}function C(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function x(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let a=null,s=t>239?4:t>223?3:t>191?2:1;if(i+s<=r){let r,n,o,l;switch(s){case 1:t<128&&(a=t);break;case 2:r=e[i+1],128==(192&r)&&(l=(31&t)<<6|63&r,l>127&&(a=l));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(l=(15&t)<<12|(63&r)<<6|63&n,l>2047&&(l<55296||l>57343)&&(a=l));break;case 4:r=e[i+1],n=e[i+2],o=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&o)&&(l=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&o,l>65535&&l<1114112&&(a=l))}}null===a?(a=65533,s=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=s}return function(e){const t=e.length;if(t<=A)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=A));return r}(n)}t.kMaxLength=s,l.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,r){return c(e,t,r)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,r){return function(e,t,r){return d(e),e<=0?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)}(e,t,r)},l.allocUnsafe=function(e){return u(e)},l.allocUnsafeSlow=function(e){return u(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(K(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),K(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,a=Math.min(r,n);i<a;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=l.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if(K(t,Uint8Array))i+t.length>n.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!l.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},l.byteLength=m,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)_(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)_(this,t,t+3),_(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)_(this,t,t+7),_(this,t+1,t+6),_(this,t+2,t+5),_(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?x(this,0,e):g.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},a&&(l.prototype[a]=l.prototype.inspect),l.prototype.compare=function(e,t,r,n,i){if(K(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let a=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0);const o=Math.min(a,s),c=this.slice(n,i),d=e.slice(t,r);for(let e=0;e<o;++e)if(c[e]!==d[e]){a=c[e],s=d[e];break}return a<s?-1:s<a?1:0},l.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},l.prototype.indexOf=function(e,t,r){return b(this,e,t,r,!0)},l.prototype.lastIndexOf=function(e,t,r){return b(this,e,t,r,!1)},l.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let a=!1;for(;;)switch(n){case"hex":return y(this,e,t,r);case"utf8":case"utf-8":return w(this,e,t,r);case"ascii":case"latin1":case"binary":return E(this,e,t,r);case"base64":return S(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,r);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const A=4096;function I(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function D(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function k(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=Q[e[n]];return i}function L(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function P(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function O(e,t,r,n,i,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function R(e,t,r,n,i){H(t,n,i,e,r,7);let a=Number(t&BigInt(4294967295));e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,r}function N(e,t,r,n,i){H(t,n,i,e,r,7);let a=Number(t&BigInt(4294967295));e[r+7]=a,a>>=8,e[r+6]=a,a>>=8,e[r+5]=a,a>>=8,e[r+4]=a;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=s,s>>=8,e[r+2]=s,s>>=8,e[r+1]=s,s>>=8,e[r]=s,r+8}function B(e,t,r,n,i,a){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function F(e,t,r,n,a){return t=+t,r>>>=0,a||B(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function U(e,t,r,n,a){return t=+t,r>>>=0,a||B(e,0,r,8),i.write(e,t,r,n,52,8),r+8}l.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,l.prototype),n},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);let n=this[e],i=1,a=0;for(;++a<t&&(i*=256);)n+=this[e+a]*i;return n},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=Z((function(e){W(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||j(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),l.prototype.readBigUInt64BE=Z((function(e){W(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||j(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),l.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);let n=this[e],i=1,a=0;for(;++a<t&&(i*=256);)n+=this[e+a]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);let n=t,i=1,a=this[e+--n];for(;n>0&&(i*=256);)a+=this[e+--n]*i;return i*=128,a>=i&&(a-=Math.pow(2,8*t)),a},l.prototype.readInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||P(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt16BE=function(e,t){e>>>=0,t||P(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=Z((function(e){W(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||j(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),l.prototype.readBigInt64BE=Z((function(e){W(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||j(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||P(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||P(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||P(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||P(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||O(this,e,t,r,Math.pow(2,8*r)-1,0);let i=1,a=0;for(this[t]=255&e;++a<r&&(i*=256);)this[t+a]=e/i&255;return t+r},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||O(this,e,t,r,Math.pow(2,8*r)-1,0);let i=r-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+r},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=Z((function(e,t=0){return R(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=Z((function(e,t=0){return N(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);O(this,e,t,r,n-1,-n)}let i=0,a=1,s=0;for(this[t]=255&e;++i<r&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a|0)-s&255;return t+r},l.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);O(this,e,t,r,n-1,-n)}let i=r-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a|0)-s&255;return t+r},l.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=Z((function(e,t=0){return R(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=Z((function(e,t=0){return N(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(e,t,r){return F(this,e,t,!0,r)},l.prototype.writeFloatBE=function(e,t,r){return F(this,e,t,!1,r)},l.prototype.writeDoubleLE=function(e,t,r){return U(this,e,t,!0,r)},l.prototype.writeDoubleBE=function(e,t,r){return U(this,e,t,!1,r)},l.prototype.copy=function(e,t,r,n){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},l.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const a=l.isBuffer(e)?e:l.from(e,n),s=a.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=a[i%s]}return this};const M={};function q(e,t,r){M[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function z(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function H(e,t,r,n,i,a){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=a>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(a+1)}${n}`:`>= -(2${n} ** ${8*(a+1)-1}${n}) and < 2 ** ${8*(a+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new M.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){W(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||j(t,e.length-(r+1))}(n,i,a)}function W(e,t){if("number"!=typeof e)throw new M.ERR_INVALID_ARG_TYPE(t,"number",e)}function j(e,t,r){if(Math.floor(e)!==e)throw W(e,r),new M.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new M.ERR_BUFFER_OUT_OF_BOUNDS;throw new M.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}q("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),q("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),q("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=z(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=z(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n}),RangeError);const V=/[^+/0-9A-Za-z-_]/g;function $(e,t){let r;t=t||1/0;const n=e.length;let i=null;const a=[];for(let s=0;s<n;++s){if(r=e.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&a.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&a.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function G(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(V,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function X(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function K(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Y(e){return e!=e}const Q=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function Z(e){return"undefined"==typeof BigInt?J:e}function J(){throw new Error("BigInt not supported")}},8317:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(5759);t.default=class{constructor(e){this.ops=e,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(e){e||(e=1/0);const t=this.ops[this.index];if(t){const r=this.offset,i=n.default.length(t);if(e>=i-r?(e=i-r,this.index+=1,this.offset=0):this.offset+=e,"number"==typeof t.delete)return{delete:e};{const n={};return t.attributes&&(n.attributes=t.attributes),"number"==typeof t.retain?n.retain=e:"object"==typeof t.retain&&null!==t.retain?n.retain=t.retain:"string"==typeof t.insert?n.insert=t.insert.substr(r,e):n.insert=t.insert,n}}return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?n.default.length(this.ops[this.index])-this.offset:1/0}peekType(){const e=this.ops[this.index];return e?"number"==typeof e.delete?"delete":"number"==typeof e.retain||"object"==typeof e.retain&&null!==e.retain?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(0===this.offset)return this.ops.slice(this.index);{const e=this.offset,t=this.index,r=this.next(),n=this.ops.slice(this.index);return this.offset=e,this.index=t,[r].concat(n)}}return[]}}},8433:(e,t,r)=>{var n=r(7348);e.exports=function(e,t){e instanceof Buffer&&(e=e.toString());var r=null;if("string"==typeof e)try{r=JSON.parse(e)}catch(e){throw new Error("The JSON structure is invalid")}else r=e;return n(r,t)}},8505:e=>{e.exports=function(e){if("number"!=typeof e||Number.isNaN(e))throw new TypeError("Expected a number, got "+typeof e);const t=e<0;let r=Math.abs(e);if(t&&(r=-r),0===r)return"0 B";const n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.min(Math.floor(Math.log(r)/Math.log(1024)),n.length-1),a=Number(r/1024**i),s=n[i];return`${a>=10||a%1==0?Math.round(a):a.toFixed(1)} ${s}`}},8626:e=>{e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2712%27 height=%2736%27%3E%3Cpath fill=%27rgba%2817, 17, 17, 0.9%29%27 d=%27M12 2.658v32.004c0-6-12.002-11.627-12.002-16.002S12 8.594 12 2.658%27/%3E%3C/svg%3E"},8990:(e,t,r)=>{var n=r(6538),i=r(8003),a=r(7348),s=r(8433);e.exports={xml2js:n,xml2json:i,js2xml:a,json2xml:s}},9106:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(7193),i=r(8142);var a;!function(e){e.compose=function(e={},t={},r=!1){"object"!=typeof e&&(e={}),"object"!=typeof t&&(t={});let i=n(t);r||(i=Object.keys(i).reduce(((e,t)=>(null!=i[t]&&(e[t]=i[t]),e)),{}));for(const r in e)void 0!==e[r]&&void 0===t[r]&&(i[r]=e[r]);return Object.keys(i).length>0?i:void 0},e.diff=function(e={},t={}){"object"!=typeof e&&(e={}),"object"!=typeof t&&(t={});const r=Object.keys(e).concat(Object.keys(t)).reduce(((r,n)=>(i(e[n],t[n])||(r[n]=void 0===t[n]?null:t[n]),r)),{});return Object.keys(r).length>0?r:void 0},e.invert=function(e={},t={}){e=e||{};const r=Object.keys(t).reduce(((r,n)=>(t[n]!==e[n]&&void 0!==e[n]&&(r[n]=t[n]),r)),{});return Object.keys(e).reduce(((r,n)=>(e[n]!==t[n]&&void 0===t[n]&&(r[n]=null),r)),r)},e.transform=function(e,t,r=!1){if("object"!=typeof e)return t;if("object"!=typeof t)return;if(!r)return t;const n=Object.keys(t).reduce(((r,n)=>(void 0===e[n]&&(r[n]=t[n]),r)),{});return Object.keys(n).length>0?n:void 0}}(a||(a={})),t.default=a},9233:(e,t,r)=>{r(8287).Buffer;const n=r(4598),i=r(1701);function a(e,t,r){let n,i,s,o=r;if("element"===t.type){const n=new RegExp(`<\\s?${t.name}`),i=e.substring(r).match(n);o=i?r+i.index:-1,o>-1&&(t.position=o,o+=t.name.length+1)}if(t.elements)for(i=o,n=0;n<t.elements.length;n++)s=a(e,t.elements[n],i),s>-1&&(i=s);return o}function s(e,t){a(e,t,0)}function o(e){let t=[];return"audio"===e.name&&e.attributes.src&&t.push(e.attributes.src),e.elements&&e.elements.forEach((e=>{t=t.concat(o(e))})),t}function l(e,t,r,n){let i=n,a=!1;if("audio"===r.name&&r.attributes.src&&(i<5?i++:(e.splice(t,1),a=!0)),r.elements){let e,t;for(e=0;e<r.elements.length;e++)t=l(r.elements,e,r.elements[e],i),i=t.total,t.removed&&e--}return{total:i,removed:a}}function c(e){l(null,0,e,0)}function d(e,t,r,n,a,s,o){let l;if(n.name){const c=["audio","break","emphasis","lang","mark","p","phoneme","prosody","s","say-as","speak","sub"].filter((e=>!o.includes(e))),d=["amazon:auto-breaths","amazon:breath","amazon:effect","amazon:emotion","amazon:domain","voice","w","alexa:name"].filter((e=>!o.includes(e))),u=["par","seq","media","desc","voice"].filter((e=>!o.includes(e)));if(-1!==c.indexOf(n.name)||"amazon"===a&&-1!==d.indexOf(n.name)||"google"===a&&-1!==u.indexOf(n.name)){const o="check_"+n.name.replace(/:|-/g,"_");l=i[o](e,t,r,n,a,s)}else{const i={type:"tag",tag:n.name};void 0!==n.position&&(i.position=n.position),r.push(i),n.elements?e.elements.splice(t,1,...n.elements):e.elements.splice(t,1),l=!0}}if(n.elements){let e,t;for(e=0;e<n.elements.length;e++)t=d(n,e,r,n.elements[e],a,s,o),t&&e--}return l}function u(e,t,r,n,i){d(t,0,e,t.elements[0],r,n,i)}function p(e,t,r){let i=[];try{let a;const l=t||{};if(l.platform=l.platform||"all",l.unsupportedTags=l.unsupportedTags||[],-1===["all","amazon","google"].indexOf(l.platform))return i.push({type:"invalid platform"}),Promise.resolve({errors:i});try{a=JSON.parse(n.xml2json(e,{compact:!1}))}catch(t){try{let t=e;t=t.replace(/&/g,"&amp;"),a=JSON.parse(n.xml2json(t,{compact:!1})),i.push({type:"Invalid & character"})}catch(e){i.push({type:"Can't parse SSML",message:e.message})}if(!a||!r)return Promise.resolve({errors:i})}if(l.getPositions&&s(e,a),!a.elements||1!==a.elements.length||"speak"!==a.elements[0].name)return i.push({type:"tag",tag:"speak"}),Promise.resolve({errors:i});if(u(i,a,l.platform,l.locale,l.unsupportedTags),"google"!==l.platform&&o(a.elements[0]).length>5){const t={type:"Too many audio files"};if(l.getPositions){const r=[...e.matchAll(/<\s?audio/g)];t.position=r[5].index}i.push(t),r&&c(a.elements[0])}return Promise.resolve({json:a,errors:i.length?i:void 0})}catch(e){i.push({type:"unknown error",message:e.message})}return Promise.resolve({errors:i.length?i:void 0})}e.exports={check:function(e,t){return p(e,t).then((e=>e.errors))},verifyAndFix:function(e,t){return p(e,t,!0).then((e=>{let t;return e.json&&e.errors&&(t=n.json2xml(e.json,{compact:!1})),{fixedSSML:t,errors:e.errors}}))}}},9325:(e,t,r)=>{var n=r(4840),i="object"==typeof self&&self&&self.Object===Object&&self,a=n||i||Function("return this")();e.exports=a},9350:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},9374:(e,t,r)=>{var n=r(4128),i=r(3805),a=r(4394),s=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(a(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=o.test(e);return r||l.test(e)?c(e.slice(2),r?2:8):s.test(e)?NaN:+e}},9740:e=>{e.exports={isArray:function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}}},9995:e=>{function t(e){if(e)return function(e){for(var r in t.prototype)e[r]=t.prototype[r];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},t.prototype.once=function(e,t){var r=this;function n(){r.off(e,n),t.apply(this,arguments)}return this._callbacks=this._callbacks||{},n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var i=0;i<n.length;i++)if((r=n[i])===t||r.fn===t){n.splice(i,1);break}return this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),r=this._callbacks[e];if(r)for(var n=0,i=(r=r.slice(0)).length;n<i;++n)r[n].apply(this,t);return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.loaded=!0,r.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),__webpack_require__.b=new URL("../",import.meta.url),__webpack_require__.nc=void 0;var __webpack_exports__={};__webpack_require__.d(__webpack_exports__,{LT:()=>LT});var ui_contentTabs_namespaceObject={};__webpack_require__.r(ui_contentTabs_namespaceObject),__webpack_require__.d(ui_contentTabs_namespaceObject,{addContentTabs:()=>addContentTabs,run:()=>contentTabs_run});var createTags_namespaceObject={};__webpack_require__.r(createTags_namespaceObject),__webpack_require__.d(createTags_namespaceObject,{run:()=>createTags_run});var xlsx_namespaceObject={};__webpack_require__.r(xlsx_namespaceObject),__webpack_require__.d(xlsx_namespaceObject,{CFB:()=>CFB,SSF:()=>SSF,default:()=>xlsx,parse_xlscfb:()=>parse_xlscfb,parse_zip:()=>parse_zip,read:()=>readSync,readFile:()=>readFileSync,readFileSync:()=>readFileSync,set_cptable:()=>set_cptable,set_fs:()=>set_fs,stream:()=>__stream,utils:()=>utils,version:()=>xlsx_version,write:()=>writeSync,writeFile:()=>writeFileSync,writeFileAsync:()=>writeFileAsync,writeFileSync:()=>writeFileSync,writeFileXLSX:()=>writeFileSyncXLSX,writeXLSX:()=>writeSyncXLSX});var dynamicContent_namespaceObject={};__webpack_require__.r(dynamicContent_namespaceObject),__webpack_require__.d(dynamicContent_namespaceObject,{run:()=>dynamicContent_run,setup:()=>dynamicContent_setup,updateAPIDataTable:()=>updateAPIDataTable,validateOptions:()=>dynamicContent_validateOptions});var essayMaxLength_namespaceObject={};__webpack_require__.r(essayMaxLength_namespaceObject),__webpack_require__.d(essayMaxLength_namespaceObject,{run:()=>essayMaxLength_run});var imageUploader_namespaceObject={};__webpack_require__.r(imageUploader_namespaceObject),__webpack_require__.d(imageUploader_namespaceObject,{run:()=>imageUploader_run});var languageTextDirection_namespaceObject={};__webpack_require__.r(languageTextDirection_namespaceObject),__webpack_require__.d(languageTextDirection_namespaceObject,{addLanguageAttribute:()=>addLanguageAttribute,run:()=>languageTextDirection_run});var nativeTabs_namespaceObject={};__webpack_require__.r(nativeTabs_namespaceObject),__webpack_require__.d(nativeTabs_namespaceObject,{run:()=>nativeTabs_run});var renderPDF_namespaceObject={};__webpack_require__.r(renderPDF_namespaceObject),__webpack_require__.d(renderPDF_namespaceObject,{run:()=>renderPDF_run});var singleQuestion_namespaceObject={};__webpack_require__.r(singleQuestion_namespaceObject),__webpack_require__.d(singleQuestion_namespaceObject,{run:()=>singleQuestion_run});var parchment_namespaceObject={};__webpack_require__.r(parchment_namespaceObject),__webpack_require__.d(parchment_namespaceObject,{Attributor:()=>Attributor,AttributorStore:()=>AttributorStore$1,BlockBlot:()=>BlockBlot$1,ClassAttributor:()=>ClassAttributor$1,ContainerBlot:()=>ContainerBlot$1,EmbedBlot:()=>EmbedBlot$1,InlineBlot:()=>InlineBlot$1,LeafBlot:()=>LeafBlot$1,ParentBlot:()=>ParentBlot$1,Registry:()=>Registry,Scope:()=>Scope,ScrollBlot:()=>ScrollBlot$1,StyleAttributor:()=>StyleAttributor$1,TextBlot:()=>TextBlot$1});var src_namespaceObject={};__webpack_require__.r(src_namespaceObject),__webpack_require__.d(src_namespaceObject,{run:()=>src_run});var ssmlEditor_namespaceObject={};__webpack_require__.r(ssmlEditor_namespaceObject),__webpack_require__.d(ssmlEditor_namespaceObject,{launchSsmlEditor:()=>launchSsmlEditor,run:()=>ssmlEditor_run});var core=__webpack_require__(5439),core_app=__webpack_require__(5716),utils_logger=__webpack_require__(5059);function hasCheckAnswer(e){var t;if(!isAutoScorable(e))return!1;var r=(null===(t=activity())||void 0===t||null===(t=t.config)||void 0===t||null===(t=t.questions_api_init_options)||void 0===t?void 0:t.attribute_overrides)&&activity().config.questions_api_init_options.attribute_overrides.hasOwnProperty("instant_feedback")&&"boolean"==typeof activity().config.questions_api_init_options.attribute_overrides.instant_feedback,n=question(e);return r?activity().config.questions_api_init_options.attribute_overrides.instant_feedback:!(!n.hasOwnProperty("instant_feedback")||"boolean"!=typeof n.instant_feedback)&&n.instant_feedback}function isAutoScorable(e){return questionInstance(e).checkValidation().has_validation}function question(e){var t=e||questions_questionResponseIds()[0];return t?app.appInstance().question(t).getQuestion():(logger.error("Question not found (index ".concat(t,")")),{})}function questionInstance(e){var t=e||questions_questionResponseIds()[0];return t?app.appInstance().question(t):{}}function questions_questions(){return items.item().questions}function questionResponse(e){var t=e||questions_questionResponseIds()[0];return t?response(t):{}}function questions_questionResponseIds(){return questions_questions().map((function(e){return e.response_id}))}function questionScore(e){var t=e||questions_questionResponseIds()[0];return t&&app.appInstance().getScores()[t]||{}}function response(e){return app.appInstance().question(e)?app.appInstance().question(e).getResponse():void logger.error("Response not found ".concat(e))}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function dynamic(){var e=itemReference();return app.assessApp().item(e).dynamic||{}}function flag(){var e=itemReference();app.assessApp().item(e).flag()}function isDynamicItem(){var e;return null===(e=item())||void 0===e?void 0:e.source.hasOwnProperty("data_table_seed")}function isFirstItem(){return activity.hasSections()?("object"===_typeof(sections.sections()[0].items[0])?sections.sections()[0].items[0].reference:sections.sections()[0].items[0])===item().reference:("object"===_typeof(activity.activity().items[0])?activity.activity().items[0].reference:activity.activity().items[0])===item().reference}function isLastItem(){return item().is_last_item}function isFlagged(){return item().user_flagged}function isItemFullyAttempted(e){var t,r,n;if(t=e?app.appInstance().getItems()[e].questions:questions.questions(),Array.isArray(t)&&t.length)for(var i=0;i<t.length;i++){var a=t[i];if(!(n=questions.questionResponse(a.response_id)))return!1;if(a.hasOwnProperty("metadata")&&a.metadata.hasOwnProperty("valid_response_count")&&Array.isArray(n.value)){var s=n.value.filter((function(e){return void 0===e}));if(s.length)return!1;var o=n.value.filter((function(e){return null===e}));if(o.length)return!1}r=!0}else r=!0;return r}function isMaskingEnabled(){return Boolean(document.querySelector(".lrn-masking"))}function item(e){return e?app.appInstance().getItems()[e]:app.appInstance().getCurrentItem()}function itemAttemptStatus(){return app.appInstance().getCurrentItem().attempt_status}function itemByResponseId(e){var t,r=app.appInstance().getItems();for(var n in r)if(r[n].response_ids.includes(e)){t=r[n];break}return t}function itemElement(){return document.querySelector("div[data-reference='".concat(itemReference(),"']"))}function itemPosition(){return app.appInstance().assessApp().getItemPosition(itemReference())+1}function itemReference(){return app.appInstance().getCurrentItem().reference}function itemTags(e){return app.appInstance().getTags()[e||itemReference()]||[]}function isFirstItemInSection(){return 1===sectionItemPosition()}function isLastItemInSection(){return sectionItemPosition()===totalItemsInSection()}function section(){if(activity.hasSections()){for(var e=items.itemReference(),t=sections_sections(),r=-1,n=!1,i=0;i<t.length&&!n;i++){++r;for(var a=0;a<t[i].items.length;a++)if(e===t[i].items[a].reference){n=!0;break}}return sections_sections()[r]}return{}}function sectionHasShuffledItems(){var e;return Boolean(null===(e=section())||void 0===e||null===(e=e.config)||void 0===e||null===(e=e.configuration)||void 0===e?void 0:e.shuffle_items)}function sectionIndex(){if(activity.hasSections()){for(var e=items.itemReference(),t=t(),r=0,n=!1,i=0;i<t.length&&!n;i++){++r;for(var a=0;a<t[i].items.length;a++)if(e===t[i].items[a].reference){n=!0;break}}return r}return 0}function sectionItemPosition(){var e=items.itemReference(),t=section(),r=0;if(!Object.keys(t).length)return null;for(var n=0;n<t.items.length&&(++r,e!==t.items[n].reference);n++);return r}function sections_sections(){return activity.hasSections()?activity.activity().sections:[]}function totalItemsInSection(){var e;return(null===(e=section())||void 0===e||null===(e=e.items)||void 0===e?void 0:e.length)||null}function activity_activity(){return app.appInstance().getActivity()}function activityId(){return activity_activity().activity_id}function activityTemplateId(){return activity_activity().activity_template_id}function activityTitle(){return activity_activity().config.title}function activitySubTitle(){return activity_activity().config.subtitle}function activityTags(){return app.appInstance().getTags()}function adaptiveType(){return isAdaptive()&&activity_activity().adaptive.hasOwnProperty("type")?activity_activity().adaptive.type:""}function annotationsConfig(){var e;return hasAnnotations()&&null!==(e=activity_activity())&&void 0!==e&&null!==(e=e.config)&&void 0!==e&&e.annotations_api_init_options?activity_activity().config.annotations_api_init_options:{}}function autoSaveConfig(){var e,t=activity_activity();return null!=t&&null!==(e=t.config)&&void 0!==e&&null!==(e=e.navigation)&&void 0!==e&&e.auto_save?t.config.navigation.auto_save:{}}function elapsedTime(){return app.appInstance().getTime()}function hasActivityTemplate(){return activity_activity().hasOwnProperty("activity_template_id")}function hasAnnotations(){var e,t,r=activity_activity();return Boolean(!0===(null==r||null===(e=r.config)||void 0===e?void 0:e.annotations)||(null==r||null===(t=r.config)||void 0===t?void 0:t.annotations_api_init_options))}function hasAnswerMasking(){return!!document.querySelector(".test-answer-masking")}function hasAutoSave(){var e=activity_activity();return e.hasOwnProperty("config")&&e.config.hasOwnProperty("navigation")&&e.config.navigation.hasOwnProperty("auto_save")&&!1!==e.config.navigation.auto_save}function hasShuffledItems(){var e;return Boolean(null===(e=activity_activity())||void 0===e||null===(e=e.config)||void 0===e||null===(e=e.configuration)||void 0===e?void 0:e.shuffle_items)}function hasEvents(){var e=activity_activity();return e.hasOwnProperty("events")&&!1!==e.events}function hasItemPool(){return activity_activity().hasOwnProperty("item_pool_id")}function hasLineReader(){return!!document.querySelector(".lrn_linereader-toggle")}function hasResourceItems(){var e;return Boolean(null===(e=activity_activity())||void 0===e||null===(e=e.config)||void 0===e||null===(e=e.navigation)||void 0===e?void 0:e.resource_items)}function hasSections(){return activity_activity().hasOwnProperty("sections")}function hasTryAgain(){var e;return null===(e=activity_activity())||void 0===e?void 0:e.dynamic_items.hasOwnProperty("try_again")}function isAdaptive(){return activity_activity().hasOwnProperty("adaptive")}function isResuming(){return activity_activity().existing_session}function itemBank(){var e;return null===(e=activity_activity())||void 0===e?void 0:e.organisation_id}function itemPool(){var e;return null===(e=activity_activity())||void 0===e?void 0:e.item_pool_id}function maxTime(){var e;return null!==(e=activity_activity())&&void 0!==e&&null!==(e=e.config)&&void 0!==e&&null!==(e=e.time)&&void 0!==e&&e.max_time?activity_activity().config.time.max_time:0}function region(){var e;return null===(e=activity_activity())||void 0===e||null===(e=e.config)||void 0===e?void 0:e.regions}function resourceItems(){var e;return null===(e=activity_activity())||void 0===e||null===(e=e.config)||void 0===e||null===(e=e.navigation)||void 0===e?void 0:e.resource_items}function sessionId(){var e;return null===(e=activity_activity())||void 0===e?void 0:e.session_id}function state(){var e;return void 0===(null===(e=activity_activity())||void 0===e?void 0:e.state)?"initial":activity_activity().state}function timeRemaining(){return 0===maxTime()?null:maxTime()-elapsedTime()}function totalItems(){if(hasSections()){for(var e=0,t=sections.sections(),r=0;r<t.length;r++)e+=t[r].items.length;return e}return isAdaptive()?activity_activity().hasOwnProperty("items")?activity_activity().items.length:(logger.info("This is an adaptive session, no items array found"),0):activity_activity().items.length}function userId(){var e;return null===(e=activity_activity())||void 0===e?void 0:e.user_id}var diagnostics_state={events:{broadcast:!1,listenFor:"item"}};function diagnostics(){var e=window.LearnosityApp?LearnosityApp.versions:{};return{apps:{annotations:{app:app.annotationsApp(),config:activity.annotationsConfig(),enabled:activity.hasAnnotations()},assess:{app:app.assessApp()},events:{app:app.eventsApp(),enabled:activity.hasEvents()},items:{app:app.appInstance(),metadata:activity.activity().config.metadata},questions:{app:app.questionsApp()}},activity:{activity:activity.activityId(),activityTemplate:activity.activityTemplateId(),autoSave:{config:activity.autoSaveConfig(),enabled:activity.hasAutoSave()},itemBank:activity.itemBank(),itemPool:activity.itemPool(),session:activity.sessionId(),state:activity.state(),type:activity.activity().type,user:activity.userId()},LT:{version},versions:e}}function filterEvent(e){/^[a-zA-Z:*]*$/.test(e)?diagnostics_state.events.listenFor=e:logger.warn("Invalid event type")}function diagnostics_handleEvent(e){if(diagnostics_state.events.broadcast){var t=diagnostics_state.events.listenFor,r=t.replaceAll("*","");1===t.length&&"*"===t||"all"===t?logger.info(e):t.startsWith("*")&&!t.endsWith("*")?e.endsWith(r)&&logger.info(e):t.endsWith("*")&&!t.startsWith("*")?e.startsWith(r)&&logger.info(e):t.startsWith("*")&&t.endsWith("*")?e.includes(r)&&logger.info(e):e.startsWith(r)&&logger.info(e)}}function listen(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];diagnostics_state.events.broadcast=Boolean(e),Boolean(e)?logger.info("ðŸ‘‚ listening for '".concat(diagnostics_state.events.listenFor,"'")):logger.info("ðŸš«ðŸ‘‚ not listening")}var app_state={};function init(e){app_state.app=e,setupListeners()}function appInstance(){return app_state.app}function annotationsApp(){return void 0!==appInstance().annotationsApp()?appInstance().annotationsApp():null}function assessApp(){return appInstance().assessApp()}function eventsApp(){return appInstance().eventsApp()}function questionsApp(){return appInstance().questionsApp()}function setupListeners(){app_state.app.on("all",(function(e){handleEvent(e)})),app_state.app.on("item:load",(function(){questionResponseIds().forEach((function(e){var t=app_state.app.question(e);["changed","beforeValidate","rendered","validated"].forEach((function(e){t.on(e,(function(){return handleEvent(e)}))}))}))}))}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==contentTabs_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=contentTabs_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=contentTabs_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function contentTabs_typeof(e){return contentTabs_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},contentTabs_typeof(e)}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var contentTabs_state={options:{theme:"api-column-tabs"},renderedCss:!1,visitedItems:new Set};function run(e){contentTabs_state.options=validateOptions(e),contentTabs_state.renderedCss||injectCSS(),app.appInstance().on("item:load",(function(){var e=items.itemReference();if(!contentTabs_state.visitedItems.has(e)){var t=document.querySelector('div[data-reference="'.concat(e,'"]')).querySelectorAll("ul.lt__nav-tabs");if(t){var r,n=_createForOfIteratorHelper(t);try{for(n.s();!(r=n.n()).done;){var i=r.value;i.querySelectorAll("li[role=tab]").forEach((function(e,t){0===t?e.classList.add("active"):e.classList.remove("active")})),i.querySelectorAll("a[data-tab-target]").forEach((function(e){if(!e.hasAttribute("title")||""===e.getAttribute("title")){var t=escapeHTML(e.textContent.trim());e.setAttribute("title",t)}}))}}catch(e){n.e(e)}finally{n.f()}}contentTabs_state.visitedItems.add(e)}}))}function escapeHTML(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function validateOptions(e){var t=e||{};return e&&"object"===contentTabs_typeof(e)?(t=_objectSpread(_objectSpread({},contentTabs_state.options),e),["rounded","api-column-tabs"].includes(t.theme)||(t.theme="api-column-tabs")):t=_objectSpread({},contentTabs_state.options),t}function injectCSS(){var e=document.createElement("style");e.textContent="/* Learnosity content tab styles */".concat("\n",getTabsTheme(contentTabs_state.options.theme)),document.head.append(e),contentTabs_state.renderedCss=!0}function getTabsTheme(e){var t="",r="";switch(e||contentTabs_state.options.theme){case"default":case"api-column-tabs":r="\n            /* API column tabs theme */\n            :root {\n                --tab-border: #d9d9d9;\n                --tab-color: #333333;\n            }",t='\n            .lrn.lrn-assess .lt__tabs {\n                .lt__nav-tabs {\n                    overflow: initial;\n\n                    li {\n                        border: none;\n\n                        a {\n                            text-decoration: none;\n                            font-weight: normal;\n                        }\n                    }\n                }\n\n                .nav-tabs {\n                    -webkit-box-shadow: 0 4px 2px -2px rgba(0, 0, 0, .2);\n                    box-shadow: 0 4px 2px -2px rgba(0, 0, 0, .2);\n                    text-align: center;\n                }\n\n                .nav-tabs>li:after, .nav-tabs .nav-tab:after {\n                    background: #1877b1;\n                    border: none;\n                    content: "";\n                    display: block;\n                    height: 2px;\n                    outline: none;\n                    transition: all .2s ease-in-out;\n                    width: 100%;\n                }\n\n                .nav-tabs>li:focus-within {\n                    outline: none;\n                }\n\n                .lt__tab-content {\n                    border: none;\n                    padding: 15px;\n                    margin-top: -1px;\n                }\n            }';break;case"rounded":r="\n            /* Rounded tabs theme */\n            :root {\n                --color-active: #333333;\n                --customer-bg-blue: #e6f1ff;\n                --bg-grey: #f0f0f0;\n                --tab-bg-active: #ffffff;\n                --tab-border: #d9d9d9;\n                --tab-border-bottom: #eeeeee;\n                --tab-color: inherit;\n                --input-border: #898989;\n            }"}return r.concat("\n","/* Base tabs styles */\n        .lrn.lrn-assess .lt__tabs,\n        .lrn-author-item-content-wrapper .lt__tabs {\n            container-type: inline-size;\n\n            .lt__nav-tabs {\n                display: flex;\n                box-shadow: none;\n                flex-wrap: nowrap;\n                overflow: hidden;\n                padding-top: 1px;\n\n                li {\n                    flex: 0 1 auto; /* don't grow, but shrink if needed */\n                    border: 1px solid var(--tab-border);\n                    border-top-left-radius: 10px;\n                    border-top-right-radius: 10px;\n                    margin-right: 6px;\n                    background-color: var(--bg-grey);\n                    box-shadow: none;\n                    min-width: 0;\n\n                    a {\n                        text-decoration: none;\n                        font-weight: bold;\n                        color: var(--tab-color);\n                        text-overflow: ellipsis;\n                        white-space: nowrap;\n                        display: block;\n                        overflow: hidden;\n                    }\n                }\n\n                li.active {\n                    border-bottom: none;\n                    background: var(--tab-bg-active);\n                    color: var(--color-active);\n                    border-bottom: none;\n                }\n\n                > li:after,\n                .nav-tabs:after {\n                    background: none;\n                }\n            }\n\n            .lt__tab-content {\n                border: 1px solid var(--tab-border);\n                padding: 15px;\n                margin-top: -1px; /* Fix for the tabs bottom border */\n\n                .lt__guard {\n                    user-select: none;\n                    width: 0;\n                    height: 0;\n                    margin: 0;\n                }\n\n                .lt__tab-pane p:last-child {\n                    margin-bottom: 0;\n                }\n            }\n\n            .tab-content>.active {\n                padding-top: 0;\n            }\n        }\n\n        .lrn-author-item-content-wrapper .lt__tabs .lt__tab-pane {\n            padding-top: 10px;\n        }\n    ","\n",t)}var ui_contentTabs_state={events:{keydownRegistered:!1},options:{theme:"default",maxTabs:5},renderedCss:!1};function contentTabs_run(e){ui_contentTabs_state.options=validateOptions(e),ui_contentTabs_state.renderedCss||contentTabs_injectCSS(),document.querySelector(".lrn-author").classList.add("lt__contenttabs"),core_app.appInstance().on("widgetedit:editor:ready",(function(){document.removeEventListener("keydown",handleKeydown),ui_contentTabs_state.events.keydownRegistered=!1})),core_app.appInstance().on("widgetedit:preview:changed",preventDOMBreaking)}function addContentTabs(e,t){var r='\n    <div class="lrn-qe lrn-qe-modal" style="display: block;" id="lt__addTabs">\n        <div class="lrn-qe-ui">\n            <div class="lrn-qe-modal-dialog">\n                <div class="lrn-qe-modal-dialog-inner">\n                    <div class="lrn-qe-modal-header">\n                        <div class="lrn-qe-form-label lrn-qe-h4 lrn-qe-section-header">\n                            <h4 class="lrn-qe-heading"><label class="lrn-qe-label lrn-qe-form-label-name">Choose number of tabs</label></h4>\n                        </div>\n                        <button type="button" class="lrn-qe-btn lrn-qe-modal-btn-close" aria-label="Close" tabindex="0">\n                            <span class="lrn-qe-sr-only">Close</span>\n                            <span aria-role="presentation" class="lrn-qe-i-cross"></span>\n                        </button>\n                    </div>\n                    <div data-lrn-qe-selector="modal-outlet">\n                        <div class="lrn-qe-modal-content" data-lrn-qe-modal-section="content">\n                            <div class="lrn-qe-edit-aria-label">\n                                <div class="lrn-qe-form-group-wrapper">\n                                    <label class="lrn-qe-label lrn-qe-form-label" for="numtabs">Number of tabs</label>\n                                    <input class="lrn-qe-input lrn-qe-form-control" type="number" id="numtabs" value="2" min="1" max="'.concat(ui_contentTabs_state.options.maxTabs,'" required>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="lrn-qe-modal-footer">\n                            <ul class="lrn-qe-ul">\n                                <li class="lrn-qe-li lrn-qe-modal-footer-item">\n                                    <button type="button" class="lrn-qe-btn lrn-qe-btn-default"><span>Cancel</span></button>\n                                </li>&nbsp;\n                                <li class="lrn-qe-li lrn-qe-modal-footer-item">\n                                    <button type="button" class="lrn-qe-btn lrn-qe-btn-primary" data-lrn-qe-modal-action="confirm"><span>Add tabs</span></button>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    ');document.querySelector(".learnosity-question-editor").insertAdjacentHTML("beforeEnd",r);var n=[];n.push(document.querySelector("#lt__addTabs .lrn-qe-btn-default")),n.push(document.querySelector("#lt__addTabs .lrn-qe-modal-btn-close"));for(var i=0;i<n.length;i++)n[i].addEventListener("click",(function(){return removeElement("lt__addTabs"),t("")}));document.querySelector("#lt__addTabs .lrn-qe-btn-primary").addEventListener("click",(function(){var e=document.getElementById("numtabs").value;return removeElement("lt__addTabs"),t(getTabsTemplate(e))}))}function preventDOMBreaking(){document.querySelectorAll(".lrn-qe-col-edit-inner .lt__nav-tabs li a").forEach((function(e){e.setAttribute("title",""),e.setAttribute("contenteditable","false"),e.addEventListener("focus",(function(e){return e.target.blur()})),e.addEventListener("dblclick",(function(t){t.preventDefault();var r=window.prompt("Edit tab label:",e.textContent);null!==r&&(e.textContent=r)}))}));var e=document.querySelector(".lrn-qe-col-edit-inner .lt__tab-content");e&&(e.querySelectorAll(".lrn-qe-col-edit-inner .lt__tab-pane").forEach((function(e){if(!e.querySelector(".lt__guard")){var t=document.createElement("p");t.className="lt__guard",t.setAttribute("contenteditable","false"),t.setAttribute("aria-hidden","true"),t.setAttribute("tabindex","-1"),t.innerHTML="&#8204;",e.insertBefore(t,e.firstChild)}})),ui_contentTabs_state.events.keydownRegistered||(document.addEventListener("keydown",handleKeydown),ui_contentTabs_state.events.keydownRegistered=!0))}function handleKeydown(e){var t;if("Backspace"===e.key&&null!==(t=getCkeEditableContainer())&&void 0!==t&&t.querySelector(".lt__tabs")){var r=document.querySelector(".lrn-qe-col-edit-inner .lt__tab-content"),n=getCaretCharOffset(),i=r.querySelector(".lt__tab-pane.active");if(0===n){var a=window.getSelection();if((a.isCollapsed||!(a.toString().length>0))&&(e.preventDefault(),i.firstChild)){var s=document.createTextNode("â€‹");i.appendChild(s);var o=document.createRange();o.setStart(s,s.textContent.length),o.collapse(!0);var l=window.getSelection();l.removeAllRanges(),l.addRange(o)}}}}function getCaretCharOffset(){var e=window.getSelection();if(!e.rangeCount)return 0;var t=e.getRangeAt(0),r=t.startContainer.nodeType===Node.TEXT_NODE?t.startContainer:t.startContainer.firstChild;if(!r)return 0;for(var n=t.startOffset;r&&r.previousSibling;)n+=(r=r.previousSibling).textContent.length;return n}function getCkeEditableContainer(){var e=window.getSelection();if(!e.rangeCount)return null;var t=e.getRangeAt(0).startContainer;return t.nodeType!==Node.ELEMENT_NODE&&(t=t.parentElement),t.closest(".cke_editable")}function getTabsTemplate(e){for(var t='<div class="tabs lt__tabs"><ul class="nav nav-tabs lt__nav-tabs" role="tablist">',r=' class="active"',n=" active",i="_"+generateRandomString(),a=1;a<=e;a++)t+='<li role="presentation"'.concat(r,' aria-controls="').concat(a).concat(i,'"><a role="tab" data-tab-target="[data-tab-id=\'').concat(a).concat(i,'\']" data-toggle="tab" href="#">Tab ').concat(a,"</a></li>"),1===a&&(r="");t+='</ul><div class="tab-content lt__tab-content">';for(var s=1;s<=e;s++)t+='<div class="tab-pane lt__tab-pane'.concat(n,'" data-tab-id="').concat(s).concat(i,'" id="').concat(s).concat(i,'"><p>Tab ').concat(s," content</p></div>"),1===s&&(n="");return t+"</div></div>"}function generateRandomString(){return Math.floor(Math.random()*Date.now()).toString(36)}function removeElement(e){document.getElementById(e).remove()}function contentTabs_injectCSS(){var e=document.createElement("style"),t=getTabsTheme(ui_contentTabs_state.options.theme).concat("\n",'/* Learnosity content tab authoring styles */\n        .lrn.lrn-author .lrn-author-item-content-wrapper .lrn-qe-col-edit-inner {\n            .lt__tabs.nav-tabs>li>a,\n            .lt__tabs.nav-tabs>li>a:focus,\n            .lt__tabs.nav-tabs>li.active>a,\n            .lt__tabs.nav-tabs>li.active>a:hover,\n            .lt__tabs.nav-tabs>li.active>a:focus {\n                cursor: pointer;\n            }\n\n            .lrn-qe-form-el-wrapper .lt__tabs.nav-tabs>li>a {\n                position: relative; /* Needed so that the pseudo-element is positioned relative to the <a> */\n                cursor: pointer;\n            }\n\n            .lt__tabs .lt__nav-tabs {\n                overflow: visible;\n                border-bottom: 1px solid transparent;\n\n                > li > a {\n                    overflow: visible;\n                }\n            }\n\n            /* Tooltip text */\n            .lt__nav-tabs.nav-tabs > li > a::after {\n                content: "Doubleâ€‘click to edit label";\n                position: absolute;\n                bottom: 65%;\n                left: 110%;\n                transform: translateX(-50%);\n                background-color: rgba(0, 0, 0, 0.8);\n                color: #fff;\n                padding: 4px 8px;\n                border-radius: 4px;\n                font-size: 12px;\n                white-space: nowrap;\n                opacity: 0;\n                visibility: hidden;\n                transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out;\n                pointer-events: none;\n                z-index: 100;\n                display: block; /* Ensure block-level display */\n            }\n\n            /* Tooltip arrow */\n            .lt__nav-tabs.nav-tabs > li > a::before {\n                content: "";\n                position: absolute;\n                display: block; /* Ensure it shows up */\n                bottom: calc(120% - 5px); /* Adjust so the arrow is just below the tooltip */\n                left: 85%;\n                bottom: calc(65% - 5px);\n                transform: translateX(-50%);\n                width: 0;\n                height: 0;\n                border-left: 5px solid transparent;\n                border-right: 5px solid transparent;\n                border-top: 5px solid rgba(0, 0, 0, 0.8);\n                opacity: 0;\n                visibility: hidden;\n                transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out;\n                pointer-events: none;\n                z-index: 100;\n            }\n\n            /* Show tooltip on hover */\n            .lt__nav-tabs.nav-tabs > li > a:hover::after,\n            .lt__nav-tabs.nav-tabs > li > a:hover::before {\n                opacity: 1;\n                visibility: visible;\n            }\n        }\n    ');e.textContent=t,document.head.append(e),ui_contentTabs_state.renderedCss=!0}function isObject(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}const lodash_es_isObject=isObject;var freeGlobal="object"==typeof global&&global&&global.Object===Object&&global;const _freeGlobal=freeGlobal;var freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=_freeGlobal||freeSelf||Function("return this")();const _root=root;var now=function(){return _root.Date.now()};const lodash_es_now=now;var reWhitespace=/\s/;function trimmedEndIndex(e){for(var t=e.length;t--&&reWhitespace.test(e.charAt(t)););return t}const _trimmedEndIndex=trimmedEndIndex;var reTrimStart=/^\s+/;function baseTrim(e){return e?e.slice(0,_trimmedEndIndex(e)+1).replace(reTrimStart,""):e}const _baseTrim=baseTrim;var _Symbol_Symbol=_root.Symbol;const _Symbol=_Symbol_Symbol;var objectProto=Object.prototype,_getRawTag_hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=_Symbol?_Symbol.toStringTag:void 0;function getRawTag(e){var t=_getRawTag_hasOwnProperty.call(e,symToStringTag),r=e[symToStringTag];try{e[symToStringTag]=void 0;var n=!0}catch(e){}var i=nativeObjectToString.call(e);return n&&(t?e[symToStringTag]=r:delete e[symToStringTag]),i}const _getRawTag=getRawTag;var _objectToString_objectProto=Object.prototype,_objectToString_nativeObjectToString=_objectToString_objectProto.toString;function objectToString(e){return _objectToString_nativeObjectToString.call(e)}const _objectToString=objectToString;var nullTag="[object Null]",undefinedTag="[object Undefined]",_baseGetTag_symToStringTag=_Symbol?_Symbol.toStringTag:void 0;function baseGetTag(e){return null==e?void 0===e?undefinedTag:nullTag:_baseGetTag_symToStringTag&&_baseGetTag_symToStringTag in Object(e)?_getRawTag(e):_objectToString(e)}const _baseGetTag=baseGetTag;function isObjectLike(e){return null!=e&&"object"==typeof e}const lodash_es_isObjectLike=isObjectLike;var symbolTag="[object Symbol]";function isSymbol(e){return"symbol"==typeof e||lodash_es_isObjectLike(e)&&_baseGetTag(e)==symbolTag}const lodash_es_isSymbol=isSymbol;var NAN=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(e){if("number"==typeof e)return e;if(lodash_es_isSymbol(e))return NAN;if(lodash_es_isObject(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=lodash_es_isObject(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=_baseTrim(e);var r=reIsBinary.test(e);return r||reIsOctal.test(e)?freeParseInt(e.slice(2),r?2:8):reIsBadHex.test(e)?NAN:+e}const lodash_es_toNumber=toNumber;var FUNC_ERROR_TEXT="Expected a function",nativeMax=Math.max,nativeMin=Math.min;function debounce(e,t,r){var n,i,a,s,o,l,c=0,d=!1,u=!1,p=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT);function h(t){var r=n,a=i;return n=i=void 0,c=t,s=e.apply(a,r)}function f(e){var r=e-l;return void 0===l||r>=t||r<0||u&&e-c>=a}function m(){var e=lodash_es_now();if(f(e))return g(e);o=setTimeout(m,function(e){var r=t-(e-l);return u?nativeMin(r,a-(e-c)):r}(e))}function g(e){return o=void 0,p&&n?h(e):(n=i=void 0,s)}function _(){var e=lodash_es_now(),r=f(e);if(n=arguments,i=this,l=e,r){if(void 0===o)return function(e){return c=e,o=setTimeout(m,t),d?h(e):s}(l);if(u)return clearTimeout(o),o=setTimeout(m,t),h(l)}return void 0===o&&(o=setTimeout(m,t)),s}return t=lodash_es_toNumber(t)||0,lodash_es_isObject(r)&&(d=!!r.leading,a=(u="maxWait"in r)?nativeMax(lodash_es_toNumber(r.maxWait)||0,t):a,p="trailing"in r?!!r.trailing:p),_.cancel=function(){void 0!==o&&clearTimeout(o),c=0,n=l=i=o=void 0},_.flush=function(){return void 0===o?s:g(lodash_es_now())},_}const lodash_es_debounce=debounce;var createTags_state={renderedCss:!1};function createTags_run(){function e(){setTimeout((function(){"items/:reference/settings/:tab"===core_app.appInstance().getLocation().route&&setup()}),300)}createTags_state.renderedCss||createTags_injectCSS(),setTimeout((function(){e()}),1500),core_app.appInstance().on("navigate",e)}function setup(){var e=document.querySelector('[data-authorapi-selector="tag-search-input"]'),t=document.querySelector(".lrn-author-tag-suggestion-list");e&&e.addEventListener("input",lodash_es_debounce((function(){var e=t.querySelector("li.lrn-author-tag-no-suggestions");e&&showCreateTagsUI(e)}),750))}function showCreateTagsUI(e){var t=e.querySelector(".lt__createTagsContainer"),r=document.querySelector(".lt__error");t||e.insertAdjacentHTML("beforeend",'\n        <div class="lt__createTagsContainer">\n            <span class="lt__error hidden">\n                <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 24 24">\n                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 13V8m0 8h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>\n                </svg>\n                <span class="lt__errorMessage">Invalid format. Use [type]:[name]</span>\n            </span>\n            <button type="button" id="lt__createTagsBtn" class="lt__btn lrn-author-btn lrn-author-btn-primary lds-btn lds-btn-primary lds-btn-sm">Create</button>\n        </div>\n\n    '),r&&r.classList.add("hidden"),document.getElementById("lt__createTagsBtn").addEventListener("click",createTag)}function createTag(){var e=document.querySelector('[data-authorapi-selector="tag-search-input"]'),t=document.querySelector(".lt__error"),r=core_app.appInstance().getItemTags(),n=e.value;if(checkTagSyntax(n)){var i=n.split(":").map((function(e){return e.trim()}));validateTag(r,{type:i[0],name:i[1]})?(r.push({type:i[0],name:i[1]}),core_app.appInstance().setItemTags(r)):(t.querySelector(".lt__errorMessage").textContent="Tag already exists",t.classList.remove("hidden"))}else t.classList.remove("hidden")}function validateTag(e,t){var r=e.length&&e.some((function(e){return JSON.stringify(e)===JSON.stringify(t)}));return Boolean(!r)}function checkTagSyntax(e){return/^[^:\s]+:\s*\S+$/.test(e)}function createTags_injectCSS(){var e=document.createElement("style");e.textContent="\n/* Learnosity create tags styles */\n.lt__createTagsContainer {\n    position: relative;\n    top: -21px;\n    float: right;\n    font-size: 85%;\n    height: 1px;\n}\n:is(#lds, body) .lds-btn.lt__btn {\n    font-size: 115%;\n}\n.lt__error {\n    color: #dd002f;\n    padding-right: 2px;\n\n    svg {\n        vertical-align: middle;\n    }\n}\n.lrn.lrn-author .lrn-author-api-react-container .lrn-author-settings-tag-search span.lt__errorMessage {\n    margin-left: 0;\n}\n",document.head.append(e),createTags_state.renderedCss=!0}function dom_typeof(e){return dom_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dom_typeof(e)}function dom_createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=dom_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw a}}}}function dom_unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return dom_arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dom_arrayLikeToArray(e,t):void 0}}function dom_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function dom_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function dom_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?dom_ownKeys(Object(r),!0).forEach((function(t){dom_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dom_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function dom_defineProperty(e,t,r){return(t=dom_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dom_toPropertyKey(e){var t=dom_toPrimitive(e,"string");return"symbol"==dom_typeof(t)?t:t+""}function dom_toPrimitive(e,t){if("object"!=dom_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=dom_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function waitForElement(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,n=document.getElementById(e);n?t(n):r>0?setTimeout((function(){return waitForElement(e,t,r-1)}),10):console.warn('Element with ID "'.concat(e,'" not found after ').concat(r," attempts."))}function setObserver(e,t,r){var n=r.dispatchEvent||!1,i=r.name||"lt:datatable",a=r.root||document.body,s=r.state||{activeObservers:new Set},o=dom_objectSpread({childList:!0,subtree:!0},r.observeConfig);if(s.activeObservers.has(e))return utils_logger.A.debug("".concat(s.logPrefix,"Already observing"),e),function(){};var l=a.querySelector(e);if(l)return utils_logger.A.debug("".concat(s.logPrefix,"Element already in DOM"),e),t(l),function(){};s.activeObservers.add(e);var c=new MutationObserver((function(r,o){var l,c=dom_createForOfIteratorHelper(r);try{for(c.s();!(l=c.n()).done;){var d=l.value;if("childList"===d.type){var u,p=dom_createForOfIteratorHelper(d.addedNodes);try{for(p.s();!(u=p.n()).done;){var h=u.value;if(1===h.nodeType){if(utils_logger.A.debug("".concat(s.logPrefix,"Observing changes: "),a,h),h.matches&&h.matches(e))return o.disconnect(),utils_logger.A.debug("".concat(s.logPrefix,"Disconnecting ").concat(e)),s.activeObservers.delete(e),dispatchCustomEvent(e,i,n),void t(h);if(h.querySelector){var f=h.querySelector(e);if(f)return o.disconnect(),utils_logger.A.debug("".concat(s.logPrefix,"Disconnecting ").concat(e)),s.activeObservers.delete(e),dispatchCustomEvent(e,i,n),void t(f)}}}}catch(e){p.e(e)}finally{p.f()}}}}catch(e){c.e(e)}finally{c.f()}}));utils_logger.A.debug("".concat(s.logPrefix,"Observing for ").concat(e)),c.observe(a,o)}function dispatchCustomEvent(e,t,r){if(r){var n=new CustomEvent(t);document.dispatchEvent(n)}}var activeTable=__webpack_require__(4730),papaparse_min=__webpack_require__(4809),papaparse_min_default=__webpack_require__.n(papaparse_min),XLSX={version:"0.20.3"},current_codepage=1200,current_ansi=1252,$cptable,VALID_ANSI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],CS2CP={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},set_ansi=function(e){-1!=VALID_ANSI.indexOf(e)&&(current_ansi=CS2CP[0]=e)};function reset_ansi(){set_ansi(1252)}var set_cp=function(e){current_codepage=e,set_ansi(e)};function reset_cp(){set_cp(1200),reset_ansi()}function char_codes(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function utf16leread(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function utf16lereadu(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e[2*r]+(e[2*r+1]<<8));return t.join("")}function utf16beread(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var debom=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return 255==t&&254==r?utf16leread(e.slice(2)):254==t&&255==r?utf16beread(e.slice(2)):65279==t?e.slice(1):e},_getchar=function(e){return String.fromCharCode(e)},_getansi=function(e){return String.fromCharCode(e)};function set_cptable(e){$cptable=e,set_cp=function(e){current_codepage=e,set_ansi(e)},debom=function(e){return 255===e.charCodeAt(0)&&254===e.charCodeAt(1)?$cptable.utils.decode(1200,char_codes(e.slice(2))):e},_getchar=function(e){return 1200===current_codepage?String.fromCharCode(e):$cptable.utils.decode(current_codepage,[255&e,e>>8])[0]},_getansi=function(e){return $cptable.utils.decode(current_ansi,[e])[0]},cpdoit()}var DENSE=null,DIF_XL=!0,Base64_map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Base64_encode(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0,l=0,c=0;c<e.length;)a=(r=e.charCodeAt(c++))>>2,s=(3&r)<<4|(n=e.charCodeAt(c++))>>4,o=(15&n)<<2|(i=e.charCodeAt(c++))>>6,l=63&i,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=Base64_map.charAt(a)+Base64_map.charAt(s)+Base64_map.charAt(o)+Base64_map.charAt(l);return t}function Base64_encode_pass(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0,l=0,c=0;c<e.length;)(r=e.charCodeAt(c++))>255&&(r=95),a=r>>2,(n=e.charCodeAt(c++))>255&&(n=95),s=(3&r)<<4|n>>4,(i=e.charCodeAt(c++))>255&&(i=95),o=(15&n)<<2|i>>6,l=63&i,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=Base64_map.charAt(a)+Base64_map.charAt(s)+Base64_map.charAt(o)+Base64_map.charAt(l);return t}function Base64_encode_arr(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0,l=0,c=0;c<e.length;)a=(r=e[c++])>>2,s=(3&r)<<4|(n=e[c++])>>4,o=(15&n)<<2|(i=e[c++])>>6,l=63&i,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=Base64_map.charAt(a)+Base64_map.charAt(s)+Base64_map.charAt(o)+Base64_map.charAt(l);return t}function Base64_decode(e){var t="",r=0,n=0,i=0,a=0,s=0,o=0;"data:"==e.slice(0,5)&&(l=e.slice(0,1024).indexOf(";base64,"))>-1&&(e=e.slice(l+8)),e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)r=Base64_map.indexOf(e.charAt(l++))<<2|(a=Base64_map.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(r),n=(15&a)<<4|(s=Base64_map.indexOf(e.charAt(l++)))>>2,64!==s&&(t+=String.fromCharCode(n)),i=(3&s)<<6|(o=Base64_map.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(i));return t}var has_buf=function(){return"undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node}(),Buffer_from=function(){if("undefined"!=typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}(),buf_utf16le=function(){if("undefined"==typeof Buffer)return!1;var e=Buffer_from([65,0]);return!!e&&1==e.toString("utf16le").length}();function new_raw_buf(e){return has_buf?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function new_unsafe_buf(e){return has_buf?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var s2a=function(e){return has_buf?Buffer_from(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function s2ab(e){if("undefined"==typeof ArrayBuffer)return s2a(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=255&e.charCodeAt(n);return t}function a2s(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function a2u(e){if("undefined"==typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}function ab2a(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ab2a(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var bconcat=has_buf?function(e){return Buffer.concat(e.map((function(e){return Buffer.isBuffer(e)?e:Buffer_from(e)})))}:function(e){if("undefined"!=typeof Uint8Array){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)i=e[t].length,e[t]instanceof Uint8Array?n.set(e[t],r):"string"==typeof e[t]?n.set(new Uint8Array(s2a(e[t])),r):n.set(new Uint8Array(e[t]),r);return n}return[].concat.apply([],e.map((function(e){return Array.isArray(e)?e:[].slice.call(e)})))};function utf8decode(e){for(var t=[],r=0,n=e.length+250,i=new_raw_buf(e.length+255),a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s<128)i[r++]=s;else if(s<2048)i[r++]=192|s>>6&31,i[r++]=128|63&s;else if(s>=55296&&s<57344){s=64+(1023&s);var o=1023&e.charCodeAt(++a);i[r++]=240|s>>8&7,i[r++]=128|s>>2&63,i[r++]=128|o>>6&15|(3&s)<<4,i[r++]=128|63&o}else i[r++]=224|s>>12&15,i[r++]=128|s>>6&63,i[r++]=128|63&s;r>n&&(t.push(i.slice(0,r)),r=0,i=new_raw_buf(65535),n=65530)}return t.push(i.slice(0,r)),bconcat(t)}var chr0=/\u0000/g,chr1=/[\u0001-\u0006]/g;function _strrev(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function pad0(e,t){var r=""+e;return r.length>=t?r:fill("0",t-r.length)+r}function pad_(e,t){var r=""+e;return r.length>=t?r:fill(" ",t-r.length)+r}function rpad_(e,t){var r=""+e;return r.length>=t?r:r+fill(" ",t-r.length)}function pad0r1(e,t){var r=""+Math.round(e);return r.length>=t?r:fill("0",t-r.length)+r}function pad0r2(e,t){var r=""+e;return r.length>=t?r:fill("0",t-r.length)+r}var p2_32=Math.pow(2,32);function pad0r(e,t){return e>p2_32||e<-p2_32?pad0r1(e,t):pad0r2(Math.round(e),t)}function SSF_isgeneral(e,t){return t=t||0,e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SSF_init_table(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "',e}var table_fmt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "'},SSF_default_map={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SSF_default_str={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function SSF_frac(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,s=1,o=0,l=1,c=0,d=0,u=Math.floor(i);c<t&&(o=(u=Math.floor(i))*s+a,d=u*c+l,!(i-u<5e-8));)i=1/(i-u),a=s,s=o,l=c,c=d;if(d>t&&(c>t?(d=l,o=a):(d=c,o=s)),!r)return[0,n*o,d];var p=Math.floor(n*o/d);return[p,n*o-p*d,d]}function SSF_normalize_xl_unsafe(e){var t=e.toPrecision(16);if(t.indexOf("e")>-1){var r=t.slice(0,t.indexOf("e"));return(r=r.indexOf(".")>-1?r.slice(0,"0."==r.slice(0,2)?17:16):r.slice(0,15)+fill("0",r.length-15))+t.slice(t.indexOf("e"))}var n=t.indexOf(".")>-1?t.slice(0,"0."==t.slice(0,2)?17:16):t.slice(0,15)+fill("0",t.length-15);return Number(n)}function SSF_parse_date_code(e,t,r){if(e>2958465||e<0)return null;var n=0|(e=SSF_normalize_xl_unsafe(e)),i=Math.floor(86400*(e-n)),a=0,s=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,86400==++i&&(o.T=i=0,++n,++o.D)),60===n)s=r?[1317,10,29]:[1900,2,29],a=3;else if(0===n)s=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=SSF_fix_hijri(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=a,o}function SSF_strip_decimal(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SSF_normalize_exp(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SSF_small_exp(e){var t=e<0?12:11,r=SSF_strip_decimal(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}function SSF_large_exp(e){var t=SSF_strip_decimal(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}function SSF_general_num(e){if(!isFinite(e))return isNaN(e)?"#NUM!":"#DIV/0!";var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return SSF_strip_decimal(SSF_normalize_exp((t>=-4&&t<=-1?e.toPrecision(10+t):Math.abs(t)<=9?SSF_small_exp(e):10===t?e.toFixed(10).substr(0,12):SSF_large_exp(e)).toUpperCase()))}function SSF_general(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):SSF_general_num(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return SSF_format(14,datenum(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function SSF_fix_hijri(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function SSF_write_date(e,t,r,n){var i,a="",s=0,o=0,l=r.y,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:i=l%100,c=2;break;default:i=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:i=r.m,c=t.length;break;case 3:return months[r.m-1][1];case 5:return months[r.m-1][0];default:return months[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:i=r.d,c=t.length;break;case 3:return days[r.q][0];default:return days[r.q][1]}break;case 104:switch(t.length){case 1:case 2:i=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:i=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:i=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(o=n>=2?3===n?1e3:100:1===n?10:1,(s=Math.round(o*(r.S+r.u)))>=60*o&&(s=0),"s"===t?0===s?"0":""+s/o:(a=pad0(s,2+n),"ss"===t?a.substr(0,2):"."+a.substr(2,t.length-1))):pad0(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":i=24*r.D+r.H;break;case"[m]":case"[mm]":i=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":i=60*(60*(24*r.D+r.H)+r.M)+(0==n?Math.round(r.S+r.u):r.S);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:i=l,c=1}return c>0?pad0(i,c):""}function commaify(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}var pct1=/%/g;function write_num_pct(e,t,r){var n=t.replace(pct1,""),i=t.length-n.length;return write_num(e,n,r*Math.pow(10,2*i))+fill("%",i)}function write_num_cm(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return write_num(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function write_num_exp(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+write_num_exp(e,-t);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),-1===(r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i)).indexOf("e")){var s=Math.floor(Math.log(t)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,n){return t+r+n.substr(0,(i+a)%i)+"."+n.substr(a)+"E"}))}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),s=i-a*n,o=n;return r+(0===a?"":""+a)+" "+(0===s?fill(" ",e[1].length+1+e[4].length):pad_(s,e[1].length)+e[2]+"/"+e[3]+pad0(o,e[4].length))}function write_num_f2(e,t,r){return r+(0===t?"":""+t)+fill(" ",e[1].length+2+e[4].length)}var dec1=/^#*0*\.([0#]+)/,closeparen=/\)[^)]*[0#]/,phone=/\(###\) ###\\?-####/;function hashq(e){for(var t,r="",n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function rnd(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function dec(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function carry(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function flr(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}function write_num_flt(e,t,r){if(40===e.charCodeAt(0)&&!t.match(closeparen)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?write_num_flt("n",n,r):"("+write_num_flt("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return write_num_cm(e,t,r);if(-1!==t.indexOf("%"))return write_num_pct(e,t,r);if(-1!==t.indexOf("E"))return write_num_exp(t,r);if(36===t.charCodeAt(0))return"$"+write_num_flt(e,t.substr(" "==t.charAt(1)?2:1),r);var i,a,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+pad0r(l,t.length);if(t.match(/^[#?]+$/))return"0"===(i=pad0r(r,0))&&(i=""),i.length>t.length?i:hashq(t.substr(0,t.length-i.length))+i;if(a=t.match(frac1))return write_num_f1(a,l,c);if(t.match(/^#+0+$/))return c+pad0r(l,t.length-t.indexOf("0"));if(a=t.match(dec1))return i=rnd(r,a[1].length).replace(/^([^\.]+)$/,"$1."+hashq(a[1])).replace(/\.$/,"."+hashq(a[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+fill("0",hashq(a[1]).length-t.length)})),-1!==t.indexOf("0.")?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+rnd(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+commaify(pad0r(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+write_num_flt(e,t,-r):commaify(""+(Math.floor(r)+carry(r,a[1].length)))+"."+pad0(dec(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return write_num_flt(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=_strrev(write_num_flt(e,t.replace(/[\\-]/g,""),r)),s=0,_strrev(_strrev(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return s<i.length?i.charAt(s++):"0"===e?"0":""})));if(t.match(phone))return"("+(i=write_num_flt(e,"##########",r)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=SSF_frac(l,Math.pow(10,s)-1,!1),i=""+c," "==(d=write_num("n",a[1],o[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],(d=rpad_(o[2],s)).length<a[4].length&&(d=hashq(a[4].substr(a[4].length-d.length))+d),i+=d;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),c+((o=SSF_frac(l,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?pad_(o[1],s)+a[2]+"/"+a[3]+rpad_(o[2],s):fill(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=pad0r(r,0),t.length<=i.length?i:hashq(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var u=t.indexOf(".")-s,p=t.length-i.length-u;return hashq(t.substr(0,u)+i+t.substr(t.length-p))}if(a=t.match(/^00,000\.([#0]*0)$/))return s=dec(r,a[1].length),r<0?"-"+write_num_flt(e,t,-r):commaify(flr(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?pad0(0,3-e.length):"")+e}))+"."+pad0(s,a[1].length);switch(t){case"###,##0.00":return write_num_flt(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=commaify(pad0r(l,0));return"0"!==h?c+h:"";case"###,###.00":return write_num_flt(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return write_num_flt(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function write_num_cm2(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return write_num(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function write_num_pct2(e,t,r){var n=t.replace(pct1,""),i=t.length-n.length;return write_num(e,n,r*Math.pow(10,2*i))+fill("%",i)}function write_num_exp2(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+write_num_exp2(e,-t);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),!(r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i)).match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,n){return t+r+n.substr(0,(i+a)%i)+"."+n.substr(a)+"E"}))}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function write_num_int(e,t,r){if(40===e.charCodeAt(0)&&!t.match(closeparen)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?write_num_int("n",n,r):"("+write_num_int("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return write_num_cm2(e,t,r);if(-1!==t.indexOf("%"))return write_num_pct2(e,t,r);if(-1!==t.indexOf("E"))return write_num_exp2(t,r);if(36===t.charCodeAt(0))return"$"+write_num_int(e,t.substr(" "==t.charAt(1)?2:1),r);var i,a,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+pad0(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,0===r&&(i=""),i.length>t.length?i:hashq(t.substr(0,t.length-i.length))+i;if(a=t.match(frac1))return write_num_f2(a,l,c);if(t.match(/^#+0+$/))return c+pad0(l,t.length-t.indexOf("0"));if(a=t.match(dec1))return i=(i=(""+r).replace(/^([^\.]+)$/,"$1."+hashq(a[1])).replace(/\.$/,"."+hashq(a[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+fill("0",hashq(a[1]).length-t.length)})),-1!==t.indexOf("0.")?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+commaify(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+write_num_int(e,t,-r):commaify(""+r)+"."+fill("0",a[1].length);if(a=t.match(/^#,#*,#0/))return write_num_int(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=_strrev(write_num_int(e,t.replace(/[\\-]/g,""),r)),s=0,_strrev(_strrev(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return s<i.length?i.charAt(s++):"0"===e?"0":""})));if(t.match(phone))return"("+(i=write_num_int(e,"##########",r)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=SSF_frac(l,Math.pow(10,s)-1,!1),i=""+c," "==(d=write_num("n",a[1],o[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],(d=rpad_(o[2],s)).length<a[4].length&&(d=hashq(a[4].substr(a[4].length-d.length))+d),i+=d;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),c+((o=SSF_frac(l,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?pad_(o[1],s)+a[2]+"/"+a[3]+rpad_(o[2],s):fill(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:hashq(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var u=t.indexOf(".")-s,p=t.length-i.length-u;return hashq(t.substr(0,u)+i+t.substr(t.length-p))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+write_num_int(e,t,-r):commaify(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?pad0(0,3-e.length):"")+e}))+"."+pad0(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=commaify(""+l);return"0"!==h?c+h:"";default:if(t.match(/\.[0#?]*$/))return write_num_int(e,t.slice(0,t.lastIndexOf(".")),r)+hashq(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function write_num(e,t,r){return(0|r)===r?write_num_int(e,t,r):write_num_flt(e,t,r)}function SSF_split_fmt(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}var SSF_abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":SSF_isgeneral(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸Š":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("ä¸Šåˆ/ä¸‹åˆ"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(n=r;"]"!==e.charAt(t++)&&t<e.length;)n+=e.charAt(t);if(n.match(SSF_abstime))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}function eval_fmt(e,t,r,n){for(var i,a,s,o=[],l="",c=0,d="",u="t",p="H";c<e.length;)switch(d=e.charAt(c)){case"G":if(!SSF_isgeneral(e,c))throw new Error("unrecognized character "+d+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(s=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(s);o[o.length]={t:"t",v:l},++c;break;case"\\":var h=e.charAt(++c),f="("===h||")"===h?h:"t";o[o.length]={t:f,v:h},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==i&&null==(i=SSF_parse_date_code(t,r,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},u=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==i&&null==(i=SSF_parse_date_code(t,r)))return"";for(l=d;++c<e.length&&e.charAt(c).toLowerCase()===d;)l+=d;"m"===d&&"h"===u.toLowerCase()&&(d="M"),"h"===d&&(d=p),o[o.length]={t:d,v:l},u=d;break;case"A":case"a":case"ä¸Š":var m={t:d,v:d};if(null==i&&(i=SSF_parse_date_code(t,r)),"A/P"===e.substr(c,3).toUpperCase()?(null!=i&&(m.v=i.H>=12?e.charAt(c+2):d),m.t="T",p="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=i&&(m.v=i.H>=12?"PM":"AM"),m.t="T",c+=5,p="h"):"ä¸Šåˆ/ä¸‹åˆ"===e.substr(c,5).toUpperCase()?(null!=i&&(m.v=i.H>=12?"ä¸‹åˆ":"ä¸Šåˆ"),m.t="T",c+=5,p="h"):(m.t="t",++c),null==i&&"T"===m.t)return"";o[o.length]=m,u=d;break;case"[":for(l=d;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(SSF_abstime)){if(null==i&&null==(i=SSF_parse_date_code(t,r)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},u=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",fmt_is_date(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=i){for(l=d;++c<e.length&&"0"===(d=e.charAt(c));)l+=d;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=d;++c<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(c))>-1;)l+=d;o[o.length]={t:"n",v:l};break;case"?":for(l=d;e.charAt(++c)===d;)l+=d;o[o.length]={t:d,v:l},u=d;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===n?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=d;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:d,v:d},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=â‚¬acfijklopqrtuvwxzP".indexOf(d))throw new Error("unrecognized character "+d+" in "+e);o[o.length]={t:"t",v:d},++c}var g,_,b=0,v=0;for(c=o.length-1,u="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=p,u="h",b<1&&(b=1);break;case"s":(g=o[c].v.match(/\.0+$/))&&(v=Math.max(v,g[0].length-1),b=4),b<3&&(b=3);case"d":case"y":case"e":u=o[c].t;break;case"M":u=o[c].t,b<2&&(b=2);break;case"m":"s"===u&&(o[c].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&o[c].v.match(/[Hh]/)&&(b=1),b<2&&o[c].v.match(/[Mm]/)&&(b=2),b<3&&o[c].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:case 2:case 3:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M),i.M>=60&&(i.M=0,++i.H),i.H>=24&&(i.H=0,++i.D,(_=SSF_parse_date_code(i.D)).u=i.u,_.S=i.S,_.M=i.M,_.H=i.H,i=_);break;case 4:switch(v){case 1:i.u=Math.round(10*i.u)/10;break;case 2:i.u=Math.round(100*i.u)/100;break;case 3:i.u=Math.round(1e3*i.u)/1e3}i.u>=1&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M),i.M>=60&&(i.M=0,++i.H),i.H>=24&&(i.H=0,++i.D,(_=SSF_parse_date_code(i.D)).u=i.u,_.S=i.S,_.M=i.M,_.H=i.H,i=_)}var y,w="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=SSF_write_date(o[c].t.charCodeAt(0),o[c].v,i,v),o[c].t="t";break;case"n":case"?":for(y=c+1;null!=o[y]&&("?"===(d=o[y].t)||"D"===d||(" "===d||"t"===d)&&null!=o[y+1]&&("?"===o[y+1].t||"t"===o[y+1].t&&"/"===o[y+1].v)||"("===o[c].t&&(" "===d||"n"===d||")"===d)||"t"===d&&("/"===o[y].v||" "===o[y].v&&null!=o[y+1]&&"?"==o[y+1].t));)o[c].v+=o[y].v,o[y]={v:"",t:";"},++y;w+=o[c].v,c=y-1;break;case"G":o[c].t="t",o[c].v=SSF_general(t,r)}var E,S,T="";if(w.length>0){40==w.charCodeAt(0)?(E=t<0&&45===w.charCodeAt(0)?-t:t,S=write_num("n",w,E)):(S=write_num("n",w,E=t<0&&n>1?-t:t),E<0&&o[0]&&"t"==o[0].t&&(S=S.substr(1),o[0].v="-"+o[0].v)),y=S.length-1;var C=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){C=c;break}var x=o.length;if(C===o.length&&-1===S.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(y>=o[c].v.length-1?(y-=o[c].v.length,o[c].v=S.substr(y+1,o[c].v.length)):y<0?o[c].v="":(o[c].v=S.substr(0,y+1),y=-1),o[c].t="t",x=c);y>=0&&x<o.length&&(o[x].v=S.substr(0,y+1)+o[x].v)}else if(C!==o.length&&-1===S.indexOf("E")){for(y=S.indexOf(".")-1,c=C;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(a=o[c].v.indexOf(".")>-1&&c===C?o[c].v.indexOf(".")-1:o[c].v.length-1,T=o[c].v.substr(a+1);a>=0;--a)y>=0&&("0"===o[c].v.charAt(a)||"#"===o[c].v.charAt(a))&&(T=S.charAt(y--)+T);o[c].v=T,o[c].t="t",x=c}for(y>=0&&x<o.length&&(o[x].v=S.substr(0,y+1)+o[x].v),y=S.indexOf(".")+1,c=C;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===C)){for(a=o[c].v.indexOf(".")>-1&&c===C?o[c].v.indexOf(".")+1:0,T=o[c].v.substr(0,a);a<o[c].v.length;++a)y<S.length&&(T+=S.charAt(y++));o[c].v=T,o[c].t="t",x=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(E=n>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=write_num(o[c].t,o[c].v,E),o[c].t="t");var A="";for(c=0;c!==o.length;++c)null!=o[c]&&(A+=o[c].v);return A}var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function choose_fmt(e,t){var r=SSF_split_fmt(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!=typeof t)return[4,4===r.length||i>-1?r[r.length-1]:"@"];switch("number"!=typeof t||isFinite(t)||(t=0),r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var a=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[n,a];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var s=r[0].match(cfregex2),o=r[1].match(cfregex2);return chkcond(t,s)?[n,r[0]]:chkcond(t,o)?[n,r[1]]:[n,r[null!=s&&null!=o?2:1]]}return[n,a]}function SSF_format(e,t,r){null==r&&(r={});var n="";switch(typeof e){case"string":n="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(n=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:table_fmt)[e])&&(n=r.table&&r.table[SSF_default_map[e]]||table_fmt[SSF_default_map[e]]),null==n&&(n=SSF_default_str[e]||"General")}if(SSF_isgeneral(n,0))return SSF_general(t,r);t instanceof Date&&(t=datenum(t,r.date1904));var i=choose_fmt(n,t);if(SSF_isgeneral(i[1]))return SSF_general(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else{if(""===t||null==t)return"";if(isNaN(t)&&i[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(t)&&i[1].indexOf("0")>-1)return"#DIV/0!"}return eval_fmt(i[1],t,r,i[0])}function SSF_load(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(null!=table_fmt[r]){if(table_fmt[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return table_fmt[t]=e,t}function SSF_load_table(e){for(var t=0;392!=t;++t)void 0!==e[t]&&SSF_load(e[t],t)}function make_ssf(){table_fmt=SSF_init_table()}var SSF={format:SSF_format,load:SSF_load,_table:table_fmt,load_table:SSF_load_table,parse_date_code:SSF_parse_date_code,is_date:fmt_is_date,get_table:function(){return SSF._table=table_fmt}},SSFImplicit={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dateNFregex=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dateNF_regex(e){var t="number"==typeof e?table_fmt[e]:e;return t=t.replace(dateNFregex,"(\\d+)"),dateNFregex.lastIndex=0,new RegExp("^"+t+"$")}function dateNF_fix(e,t,r){var n=-1,i=-1,a=-1,s=-1,o=-1,l=-1;(t.match(dateNFregex)||[]).forEach((function(e,t){var c=parseInt(r[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":n=c;break;case"d":a=c;break;case"h":s=c;break;case"s":l=c;break;case"m":s>=0?o=c:i=c}})),dateNFregex.lastIndex=0,l>=0&&-1==o&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==s&&-1==o&&-1==l?c:-1==n&&-1==i&&-1==a?d:c+"T"+d}var bad_formats={"d.m":"d\\.m"};function SSF__load(e,t){return SSF_load(bad_formats[e]||e,t)}var CRC32=function(){var e={version:"1.2.0"},t=function(){for(var e=0,t=new Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[r]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}(),r=function(e){var t=0,r=0,n=0,i="undefined"!=typeof Int32Array?new Int32Array(4096):new Array(4096);for(n=0;256!=n;++n)i[n]=e[n];for(n=0;256!=n;++n)for(r=e[n],t=256+n;t<4096;t+=256)r=i[t]=r>>>8^e[255&r];var a=[];for(n=1;16!=n;++n)a[n-1]="undefined"!=typeof Int32Array&&"function"==typeof i.subarray?i.subarray(256*n,256*n+256):i.slice(256*n,256*n+256);return a}(t),n=r[0],i=r[1],a=r[2],s=r[3],o=r[4],l=r[5],c=r[6],d=r[7],u=r[8],p=r[9],h=r[10],f=r[11],m=r[12],g=r[13],_=r[14];return e.table=t,e.bstr=function(e,r){for(var n=~r,i=0,a=e.length;i<a;)n=n>>>8^t[255&(n^e.charCodeAt(i++))];return~n},e.buf=function(e,r){for(var b=~r,v=e.length-15,y=0;y<v;)b=_[e[y++]^255&b]^g[e[y++]^b>>8&255]^m[e[y++]^b>>16&255]^f[e[y++]^b>>>24]^h[e[y++]]^p[e[y++]]^u[e[y++]]^d[e[y++]]^c[e[y++]]^l[e[y++]]^o[e[y++]]^s[e[y++]]^a[e[y++]]^i[e[y++]]^n[e[y++]]^t[e[y++]];for(v+=15;y<v;)b=b>>>8^t[255&(b^e[y++])];return~b},e.str=function(e,r){for(var n=~r,i=0,a=e.length,s=0,o=0;i<a;)(s=e.charCodeAt(i++))<128?n=n>>>8^t[255&(n^s)]:s<2048?n=(n=n>>>8^t[255&(n^(192|s>>6&31))])>>>8^t[255&(n^(128|63&s))]:s>=55296&&s<57344?(s=64+(1023&s),o=1023&e.charCodeAt(i++),n=(n=(n=(n=n>>>8^t[255&(n^(240|s>>8&7))])>>>8^t[255&(n^(128|s>>2&63))])>>>8^t[255&(n^(128|o>>6&15|(3&s)<<4))])>>>8^t[255&(n^(128|63&o))]):n=(n=(n=n>>>8^t[255&(n^(224|s>>12&15))])>>>8^t[255&(n^(128|s>>6&63))])>>>8^t[255&(n^(128|63&s))];return~n},e}(),CFB=function(){var e,t={};function r(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function n(e){if("/"==e.charAt(e.length-1))return n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function i(e,t){"string"==typeof t&&(t=new Date(t));var r=t.getHours();r=(r=r<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,r);var n=t.getFullYear()-1980;n=(n=n<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,n)}function a(e){prep_blob(e,0);for(var t={},r=0;e.l<=e.length-4;){var n=e.read_shift(2),i=e.read_shift(2),a=e.l+i,s={};switch(n){case 21589:1&(r=e.read_shift(1))&&(s.mtime=e.read_shift(4)),i>5&&(2&r&&(s.atime=e.read_shift(4)),4&r&&(s.ctime=e.read_shift(4))),s.mtime&&(s.mt=new Date(1e3*s.mtime));break;case 1:var o=e.read_shift(4),l=e.read_shift(4);s.usz=l*Math.pow(2,32)+o,o=e.read_shift(4),l=e.read_shift(4),s.csz=l*Math.pow(2,32)+o}e.l=a,t[n]=s}return t}function s(){return e||(e=_fs)}function o(e,t){if(80==e[0]&&75==e[1])return re(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=E(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var r=t&&t.root||"",n=(has_buf&&Buffer.isBuffer(e)?e.toString("binary"):E(e)).split("\r\n"),i=0,a="";for(i=0;i<n.length;++i)if(a=n[i],/^Content-Location:/i.test(a)&&(a=a.slice(a.indexOf("file")),r||(r=a.slice(0,a.lastIndexOf("/")+1)),a.slice(0,r.length)!=r))for(;r.length>0&&(r=(r=r.slice(0,r.length-1)).slice(0,r.lastIndexOf("/")+1),a.slice(0,r.length)!=r););var s=(n[1]||"").match(/boundary="(.*?)"/);if(!s)throw new Error("MAD cannot find boundary");var o="--"+(s[1]||""),l={FileIndex:[],FullPaths:[]};p(l);var c,d=0;for(i=0;i<n.length;++i){var u=n[i];u!==o&&u!==o+"--"||(d++&&le(l,n.slice(c,i),r),c=i)}return l}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var r,n,i,a,s,o,h=512,f=[],m=e.slice(0,512);prep_blob(m,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(b,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(m);switch(r=g[0]){case 3:h=512;break;case 4:h=4096;break;case 0:if(0==g[1])return re(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+r)}512!==h&&prep_blob(m=e.slice(0,h),28);var v=e.slice(0,h);!function(e,t){var r;switch(e.l+=2,r=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+r);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+r);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+r)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(m,r);var y=m.read_shift(4,"i");if(3===r&&0!==y)throw new Error("# Directory Sectors: Expected 0 saw "+y);m.l+=4,a=m.read_shift(4,"i"),m.l+=4,m.chk("00100000","Mini Stream Cutoff Size: "),s=m.read_shift(4,"i"),n=m.read_shift(4,"i"),o=m.read_shift(4,"i"),i=m.read_shift(4,"i");for(var w=-1,S=0;S<109&&!((w=m.read_shift(4,"i"))<0);++S)f[S]=w;var T=function(e,t){for(var r=Math.ceil(e.length/t)-1,n=[],i=1;i<r;++i)n[i-1]=e.slice(i*t,(i+1)*t);return n[r-1]=e.slice(r*t),n}(e,h);c(o,i,T,h,f);var C=function(e,t,r,n){var i=e.length,a=[],s=[],o=[],l=[],c=n-1,d=0,u=0,p=0,h=0;for(d=0;d<i;++d)if(o=[],(p=d+t)>=i&&(p-=i),!s[p]){l=[];var f=[];for(u=p;u>=0;){f[u]=!0,s[u]=!0,o[o.length]=u,l.push(e[u]);var m=r[Math.floor(4*u/n)];if(n<4+(h=4*u&c))throw new Error("FAT boundary crossed: "+u+" 4 "+n);if(!e[m])break;if(f[u=__readInt32LE(e[m],h)])break}a[p]={nodes:o,data:__toBuffer([l])}}return a}(T,a,f,h);a<C.length&&(C[a].name="!Directory"),n>0&&s!==_&&(C[s].name="!MiniFAT"),C[f[0]].name="!FAT",C.fat_addrs=f,C.ssz=h;var x=[],A=[],I=[];!function(e,t,r,n,i,a,s,o){for(var c,p=0,h=n.length?2:0,f=t[e].data,m=0,g=0;m<f.length;m+=128){var b=f.slice(m,m+128);prep_blob(b,64),g=b.read_shift(2),c=__utf16le(b,0,g-h),n.push(c);var v={name:c,type:b.read_shift(1),color:b.read_shift(1),L:b.read_shift(4,"i"),R:b.read_shift(4,"i"),C:b.read_shift(4,"i"),clsid:b.read_shift(16),state:b.read_shift(4,"i"),start:0,size:0};0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(v.ct=u(b,b.l-8)),0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(v.mt=u(b,b.l-8)),v.start=b.read_shift(4,"i"),v.size=b.read_shift(4,"i"),v.size<0&&v.start<0&&(v.size=v.type=0,v.start=_,v.name=""),5===v.type?(p=v.start,i>0&&p!==_&&(t[p].name="!StreamData")):v.size>=4096?(v.storage="fat",void 0===t[v.start]&&(t[v.start]=d(r,v.start,t.fat_addrs,t.ssz)),t[v.start].name=v.name,v.content=t[v.start].data.slice(0,v.size)):(v.storage="minifat",v.size<0?v.size=0:p!==_&&v.start!==_&&t[p]&&(v.content=l(v,t[p].data,(t[o]||{}).data))),v.content&&prep_blob(v.content,0),a[c]=v,s.push(v)}}(a,C,T,x,n,{},A,s),function(e,t,r){for(var n=0,i=0,a=0,s=0,o=0,l=r.length,c=[],d=[];n<l;++n)c[n]=d[n]=n,t[n]=r[n];for(;o<d.length;++o)i=e[n=d[o]].L,a=e[n].R,s=e[n].C,c[n]===n&&(-1!==i&&c[i]!==i&&(c[n]=c[i]),-1!==a&&c[a]!==a&&(c[n]=c[a])),-1!==s&&(c[s]=n),-1!==i&&n!=c[n]&&(c[i]=c[n],d.lastIndexOf(i)<o&&d.push(i)),-1!==a&&n!=c[n]&&(c[a]=c[n],d.lastIndexOf(a)<o&&d.push(a));for(n=1;n<l;++n)c[n]===n&&(-1!==a&&c[a]!==a?c[n]=c[a]:-1!==i&&c[i]!==i&&(c[n]=c[i]));for(n=1;n<l;++n)if(0!==e[n].type){if((o=n)!=c[o])do{o=c[o],t[n]=t[o]+"/"+t[n]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[n]=-1}for(t[0]+="/",n=1;n<l;++n)2!==e[n].type&&(t[n]+="/")}(A,I,x),x.shift();var D={FileIndex:A,FullPaths:I};return t&&t.raw&&(D.raw={header:v,sectors:T}),D}function l(e,t,r){for(var n=e.start,i=e.size,a=[],s=n;r&&i>0&&s>=0;)a.push(t.slice(s*g,s*g+g)),i-=g,s=__readInt32LE(r,4*s);return 0===a.length?new_buf(0):bconcat(a).slice(0,e.size)}function c(e,t,r,n,i){var a=_;if(e===_){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var s=r[e],o=(n>>>2)-1;if(!s)return;for(var l=0;l<o&&(a=__readInt32LE(s,4*l))!==_;++l)i.push(a);t>=1&&c(__readInt32LE(s,n-4),t-1,r,n,i)}}function d(e,t,r,n,i){var a=[],s=[];i||(i=[]);var o=n-1,l=0,c=0;for(l=t;l>=0;){i[l]=!0,a[a.length]=l,s.push(e[l]);var d=r[Math.floor(4*l/n)];if(n<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+n);if(!e[d])break;l=__readInt32LE(e[d],c)}return{nodes:a,data:__toBuffer([s])}}function u(e,t){return new Date(1e3*(__readUInt32LE(e,t+4)/1e7*Math.pow(2,32)+__readUInt32LE(e,t)/1e7-11644473600))}function p(e,t){var r=t||{},n=r.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=n+"/",e.FileIndex[0]={name:n,type:5}),r.CLSID&&(e.FileIndex[0].clsid=r.CLSID),function(e){var t="Sh33tJ5";if(!CFB.find(e,"/"+t)){var r=new_buf(4);r[0]=55,r[1]=r[3]=50,r[2]=54,e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),h(e)}}(e)}function h(e,t){p(e);for(var i=!1,a=!1,s=e.FullPaths.length-1;s>=0;--s){var o=e.FileIndex[s];switch(o.type){case 0:a?i=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:a=!0,isNaN(o.R*o.L*o.C)&&(i=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(i=!0);break;default:i=!0}}if(i||t){var l=new Date(1987,1,19),c=0,d=Object.create?Object.create(null):{},u=[];for(s=0;s<e.FullPaths.length;++s)d[e.FullPaths[s]]=!0,0!==e.FileIndex[s].type&&u.push([e.FullPaths[s],e.FileIndex[s]]);for(s=0;s<u.length;++s){var h=r(u[s][0]);for(a=d[h];!a;){for(;r(h)&&!d[r(h)];)h=r(h);u.push([h,{name:n(h).replace("/",""),type:1,clsid:y,ct:l,mt:l,content:null}]),d[h]=!0,a=d[h=r(u[s][0])]}}for(u.sort((function(e,t){return function(e,t){for(var r=e.split("/"),n=t.split("/"),i=0,a=0,s=Math.min(r.length,n.length);i<s;++i){if(a=r[i].length-n[i].length)return a;if(r[i]!=n[i])return r[i]<n[i]?-1:1}return r.length-n.length}(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],s=0;s<u.length;++s)e.FullPaths[s]=u[s][0],e.FileIndex[s]=u[s][1];for(s=0;s<u.length;++s){var f=e.FileIndex[s],m=e.FullPaths[s];if(f.name=n(m).replace("/",""),f.L=f.R=f.C=-(f.color=1),f.size=f.content?f.content.length:0,f.start=0,f.clsid=f.clsid||y,0===s)f.C=u.length>1?1:-1,f.size=0,f.type=5;else if("/"==m.slice(-1)){for(c=s+1;c<u.length&&r(e.FullPaths[c])!=m;++c);for(f.C=c>=u.length?-1:c,c=s+1;c<u.length&&r(e.FullPaths[c])!=r(m);++c);f.R=c>=u.length?-1:c,f.type=1}else r(e.FullPaths[s+1]||"")==r(m)&&(f.R=s+1),f.type=2}}}function f(e,t){var r=t||{};if("mad"==r.fileType)return function(e,t){for(var r=t||{},n=r.boundary||"SheetJS",i=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(n="------="+n).slice(2)+'"',"","",""],a=e.FullPaths[0],s=a,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(s=e.FullPaths[l].slice(a.length),(o=e.FileIndex[l]).size&&o.content&&"Sh33tJ5"!=s){s=s.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"}));for(var c=o.content,d=has_buf&&Buffer.isBuffer(c)?c.toString("binary"):E(c),u=0,p=Math.min(1024,d.length),h=0,f=0;f<=p;++f)(h=d.charCodeAt(f))>=32&&h<128&&++u;var m=u>=4*p/5;i.push(n),i.push("Content-Location: "+(r.root||"file:///C:/SheetJS/")+s),i.push("Content-Transfer-Encoding: "+(m?"quoted-printable":"base64")),i.push("Content-Type: "+ae(o,s)),i.push(""),i.push(m?oe(d):se(d))}return i.push(n+"--\r\n"),i.join("\r\n")}(e,r);if(h(e),"zip"===r.fileType)return function(e,t){var r,n=t||{},a=[],s=[],o=new_buf(1),l=n.compression?8:0,c=0,d=0,u=0,p=0,h=e.FullPaths[0],f=h,g=e.FileIndex[0],_=[],b=0;for(c=1;c<e.FullPaths.length;++c)if(f=e.FullPaths[c].slice(h.length),(g=e.FileIndex[c]).size&&g.content&&(!Array.isArray(g.content)||0!=g.content.length)&&"Sh33tJ5"!=f){var v=u,y=new_buf(f.length);for(d=0;d<f.length;++d)y.write_shift(1,127&f.charCodeAt(d));y=y.slice(0,y.l),_[p]="string"==typeof g.content?CRC32.bstr(g.content,0):CRC32.buf(g.content,0);var w="string"==typeof g.content?s2a(g.content):g.content;8==l&&(r=w,w=m?m.deflateRawSync(r):G(r)),(o=new_buf(30)).write_shift(4,67324752),o.write_shift(2,20),o.write_shift(2,0),o.write_shift(2,l),g.mt?i(o,g.mt):o.write_shift(4,0),o.write_shift(-4,_[p]),o.write_shift(4,w.length),o.write_shift(4,g.content.length),o.write_shift(2,y.length),o.write_shift(2,0),u+=o.length,a.push(o),u+=y.length,a.push(y),u+=w.length,a.push(w),(o=new_buf(46)).write_shift(4,33639248),o.write_shift(2,0),o.write_shift(2,20),o.write_shift(2,0),o.write_shift(2,l),o.write_shift(4,0),o.write_shift(-4,_[p]),o.write_shift(4,w.length),o.write_shift(4,g.content.length),o.write_shift(2,y.length),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(4,0),o.write_shift(4,v),b+=o.l,s.push(o),b+=y.length,s.push(y),++p}return(o=new_buf(22)).write_shift(4,101010256),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,p),o.write_shift(2,p),o.write_shift(4,b),o.write_shift(4,u),o.write_shift(2,0),bconcat([bconcat(a),bconcat(s),o])}(e,r);var n=function(e){for(var t=0,r=0,n=0;n<e.FileIndex.length;++n){var i=e.FileIndex[n];if(i.content){var a=i.content.length;a>0&&(a<4096?t+=a+63>>6:r+=a+511>>9)}}for(var s=e.FullPaths.length+3>>2,o=t+127>>7,l=(t+7>>3)+r+s+o,c=l+127>>7,d=c<=109?0:Math.ceil((c-109)/127);l+c+d+127>>7>c;)d=++c<=109?0:Math.ceil((c-109)/127);var u=[1,d,c,o,s,r,t,0];return e.FileIndex[0].size=t<<6,u[7]=(e.FileIndex[0].start=u[0]+u[1]+u[2]+u[3]+u[4]+u[5])+(u[6]+7>>3),u}(e),a=new_buf(n[7]<<9),s=0,o=0;for(s=0;s<8;++s)a.write_shift(1,v[s]);for(s=0;s<8;++s)a.write_shift(2,0);for(a.write_shift(2,62),a.write_shift(2,3),a.write_shift(2,65534),a.write_shift(2,9),a.write_shift(2,6),s=0;s<3;++s)a.write_shift(2,0);for(a.write_shift(4,0),a.write_shift(4,n[2]),a.write_shift(4,n[0]+n[1]+n[2]+n[3]-1),a.write_shift(4,0),a.write_shift(4,4096),a.write_shift(4,n[3]?n[0]+n[1]+n[2]-1:_),a.write_shift(4,n[3]),a.write_shift(-4,n[1]?n[0]-1:_),a.write_shift(4,n[1]),s=0;s<109;++s)a.write_shift(-4,s<n[2]?n[1]+s:-1);if(n[1])for(o=0;o<n[1];++o){for(;s<236+127*o;++s)a.write_shift(-4,s<n[2]?n[1]+s:-1);a.write_shift(-4,o===n[1]-1?_:o+1)}var l=function(e){for(o+=e;s<o-1;++s)a.write_shift(-4,s+1);e&&(++s,a.write_shift(-4,_))};for(o=s=0,o+=n[1];s<o;++s)a.write_shift(-4,w.DIFSECT);for(o+=n[2];s<o;++s)a.write_shift(-4,w.FATSECT);l(n[3]),l(n[4]);for(var c=0,d=0,u=e.FileIndex[0];c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&((d=u.content.length)<4096||(u.start=o,l(d+511>>9)));for(l(n[6]+7>>3);511&a.l;)a.write_shift(-4,w.ENDOFCHAIN);for(o=s=0,c=0;c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&(!(d=u.content.length)||d>=4096||(u.start=o,l(d+63>>6)));for(;511&a.l;)a.write_shift(-4,w.ENDOFCHAIN);for(s=0;s<n[4]<<2;++s){var p=e.FullPaths[s];if(p&&0!==p.length){u=e.FileIndex[s],0===s&&(u.start=u.size?u.start-1:_);var f=0===s&&r.root||u.name;if(f.length>31&&(console.error("Name "+f+" will be truncated to "+f.slice(0,31)),f=f.slice(0,31)),d=2*(f.length+1),a.write_shift(64,f,"utf16le"),a.write_shift(2,d),a.write_shift(1,u.type),a.write_shift(1,u.color),a.write_shift(-4,u.L),a.write_shift(-4,u.R),a.write_shift(-4,u.C),u.clsid)a.write_shift(16,u.clsid,"hex");else for(c=0;c<4;++c)a.write_shift(4,0);a.write_shift(4,u.state||0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,u.start),a.write_shift(4,u.size),a.write_shift(4,0)}else{for(c=0;c<17;++c)a.write_shift(4,0);for(c=0;c<3;++c)a.write_shift(4,-1);for(c=0;c<12;++c)a.write_shift(4,0)}}for(s=1;s<e.FileIndex.length;++s)if((u=e.FileIndex[s]).size>=4096)if(a.l=u.start+1<<9,has_buf&&Buffer.isBuffer(u.content))u.content.copy(a,a.l,0,u.size),a.l+=u.size+511&-512;else{for(c=0;c<u.size;++c)a.write_shift(1,u.content[c]);for(;511&c;++c)a.write_shift(1,0)}for(s=1;s<e.FileIndex.length;++s)if((u=e.FileIndex[s]).size>0&&u.size<4096)if(has_buf&&Buffer.isBuffer(u.content))u.content.copy(a,a.l,0,u.size),a.l+=u.size+63&-64;else{for(c=0;c<u.size;++c)a.write_shift(1,u.content[c]);for(;63&c;++c)a.write_shift(1,0)}if(has_buf)a.l=a.length;else for(;a.l<a.length;)a.write_shift(1,0);return a}t.version="1.2.2";var m,g=64,_=-2,b="d0cf11e0a1b11ae1",v=[208,207,17,224,161,177,26,225],y="00000000000000000000000000000000",w={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:_,FREESECT:-1,HEADER_SIGNATURE:b,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function E(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}var S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],T=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],C=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function x(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var A="undefined"!=typeof Uint8Array,I=A?new Uint8Array(256):[],D=0;D<256;++D)I[D]=x(D);function k(e,t){var r=I[255&e];return t<=8?r>>>8-t:(r=r<<8|I[e>>8&255],t<=16?r>>>16-t:(r=r<<8|I[e>>16&255])>>>24-t)}function L(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=6?0:e[n+1]<<8))>>>r&3}function P(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=5?0:e[n+1]<<8))>>>r&7}function O(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=3?0:e[n+1]<<8))>>>r&31}function R(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=1?0:e[n+1]<<8))>>>r&127}function N(e,t,r){var n=7&t,i=t>>>3,a=(1<<r)-1,s=e[i]>>>n;return r<8-n?s&a:(s|=e[i+1]<<8-n,r<16-n?s&a:(s|=e[i+2]<<16-n,r<24-n?s&a:(s|=e[i+3]<<24-n)&a))}function B(e,t,r){var n=7&t,i=t>>>3;return n<=5?e[i]|=(7&r)<<n:(e[i]|=r<<n&255,e[i+1]=(7&r)>>8-n),t+3}function F(e,t,r){return r=(1&r)<<(7&t),e[t>>>3]|=r,t+1}function U(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=r,t+8}function M(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=255&r,e[n+2]=r>>>8,t+16}function q(e,t){var r=e.length,n=2*r>t?2*r:t+5,i=0;if(r>=t)return e;if(has_buf){var a=new_unsafe_buf(n);if(e.copy)e.copy(a);else for(;i<e.length;++i)a[i]=e[i];return a}if(A){var s=new Uint8Array(n);if(s.set)s.set(e);else for(;i<r;++i)s[i]=e[i];return s}return e.length=n,e}function z(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function H(e,t,r){var n=1,i=0,a=0,s=0,o=0,l=e.length,c=A?new Uint16Array(32):z(32);for(a=0;a<32;++a)c[a]=0;for(a=l;a<r;++a)e[a]=0;l=e.length;var d=A?new Uint16Array(l):z(l);for(a=0;a<l;++a)c[i=e[a]]++,n<i&&(n=i),d[a]=0;for(c[0]=0,a=1;a<=n;++a)c[a+16]=o=o+c[a-1]<<1;for(a=0;a<l;++a)0!=(o=e[a])&&(d[a]=c[o+16]++);var u=0;for(a=0;a<l;++a)if(0!=(u=e[a]))for(o=k(d[a],n)>>n-u,s=(1<<n+4-u)-1;s>=0;--s)t[o|s<<u]=15&u|a<<4;return n}var W=A?new Uint16Array(512):z(512),j=A?new Uint16Array(32):z(32);if(!A){for(var V=0;V<512;++V)W[V]=0;for(V=0;V<32;++V)j[V]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);H(e,j,32);var r=[];for(t=0;t<=143;t++)r.push(8);for(;t<=255;t++)r.push(9);for(;t<=279;t++)r.push(7);for(;t<=287;t++)r.push(8);H(r,W,288)}();var $=function(){for(var e=A?new Uint8Array(32768):[],t=0,r=0;t<C.length-1;++t)for(;r<C[t+1];++r)e[r]=t;for(;r<32768;++r)e[r]=29;var n=A?new Uint8Array(259):[];for(t=0,r=0;t<T.length-1;++t)for(;r<T[t+1];++r)n[r]=t;return function(t,r){return t.length<8?function(e,t){for(var r=0;r<e.length;){var n=Math.min(65535,e.length-r),i=r+n==e.length;for(t.write_shift(1,+i),t.write_shift(2,n),t.write_shift(2,65535&~n);n-- >0;)t[t.l++]=e[r++]}return t.l}(t,r):function(t,r){for(var i=0,a=0,s=A?new Uint16Array(32768):[];a<t.length;){var o=Math.min(65535,t.length-a);if(o<10){for(7&(i=B(r,i,+!(a+o!=t.length)))&&(i+=8-(7&i)),r.l=i/8|0,r.write_shift(2,o),r.write_shift(2,65535&~o);o-- >0;)r[r.l++]=t[a++];i=8*r.l}else{i=B(r,i,+!(a+o!=t.length)+2);for(var l=0;o-- >0;){var c=t[a],d=-1,u=0;if((d=s[l=32767&(l<<5^c)])&&((d|=-32768&a)>a&&(d-=32768),d<a))for(;t[d+u]==t[a+u]&&u<250;)++u;if(u>2){(c=n[u])<=22?i=U(r,i,I[c+1]>>1)-1:(U(r,i,3),U(r,i+=5,I[c-23]>>5),i+=3);var p=c<8?0:c-4>>2;p>0&&(M(r,i,u-T[c]),i+=p),c=e[a-d],i=U(r,i,I[c]>>3),i-=3;var h=c<4?0:c-2>>1;h>0&&(M(r,i,a-d-C[c]),i+=h);for(var f=0;f<u;++f)s[l]=32767&a,l=32767&(l<<5^t[a]),++a;o-=u-1}else c<=143?c+=48:i=F(r,i,1),i=U(r,i,I[c]),s[l]=32767&a,++a}i=U(r,i,0)-1}}return r.l=(i+7)/8|0,r.l}(t,r)}}();function G(e){var t=new_buf(50+Math.floor(1.1*e.length)),r=$(e,t);return t.slice(0,r)}var X=A?new Uint16Array(32768):z(32768),K=A?new Uint16Array(32768):z(32768),Y=A?new Uint16Array(128):z(128),Q=1,Z=1;function J(e,t){var r=O(e,t)+257,n=O(e,t+=5)+1,i=function(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=4?0:e[n+1]<<8))>>>r&15}(e,t+=5)+4;t+=4;for(var a=0,s=A?new Uint8Array(19):z(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=A?new Uint8Array(8):z(8),d=A?new Uint8Array(8):z(8),u=s.length,p=0;p<i;++p)s[S[p]]=a=P(e,t),l<a&&(l=a),c[a]++,t+=3;var h=0;for(c[0]=0,p=1;p<=l;++p)d[p]=h=h+c[p-1]<<1;for(p=0;p<u;++p)0!=(h=s[p])&&(o[p]=d[h]++);var f=0;for(p=0;p<u;++p)if(0!=(f=s[p])){h=I[o[p]]>>8-f;for(var m=(1<<7-f)-1;m>=0;--m)Y[h|m<<f]=7&f|p<<3}var g=[];for(l=1;g.length<r+n;)switch(t+=7&(h=Y[R(e,t)]),h>>>=3){case 16:for(a=3+L(e,t),t+=2,h=g[g.length-1];a-- >0;)g.push(h);break;case 17:for(a=3+P(e,t),t+=3;a-- >0;)g.push(0);break;case 18:for(a=11+R(e,t),t+=7;a-- >0;)g.push(0);break;default:g.push(h),l<h&&(l=h)}var _=g.slice(0,r),b=g.slice(r);for(p=r;p<286;++p)_[p]=0;for(p=n;p<30;++p)b[p]=0;return Q=H(_,X,286),Z=H(b,K,30),t}function ee(e,t){var r=function(e,t){if(3==e[0]&&!(3&e[1]))return[new_raw_buf(t),2];for(var r=0,n=0,i=new_unsafe_buf(t||1<<18),a=0,s=i.length>>>0,o=0,l=0;!(1&n);)if(n=P(e,r),r+=3,n>>>1!=0)for(n>>1==1?(o=9,l=5):(r=J(e,r),o=Q,l=Z);;){!t&&s<a+32767&&(s=(i=q(i,a+32767)).length);var c=N(e,r,o),d=n>>>1==1?W[c]:X[c];if(r+=15&d,(d>>>=4)>>>8&255){if(256==d)break;var u=(d-=257)<8?0:d-4>>2;u>5&&(u=0);var p=a+T[d];u>0&&(p+=N(e,r,u),r+=u),c=N(e,r,l),r+=15&(d=n>>>1==1?j[c]:K[c]);var h=(d>>>=4)<4?0:d-2>>1,f=C[d];for(h>0&&(f+=N(e,r,h),r+=h),!t&&s<p&&(s=(i=q(i,p+100)).length);a<p;)i[a]=i[a-f],++a}else i[a++]=d}else{7&r&&(r+=8-(7&r));var m=e[r>>>3]|e[1+(r>>>3)]<<8;if(r+=32,m>0)for(!t&&s<a+m&&(s=(i=q(i,a+m)).length);m-- >0;)i[a++]=e[r>>>3],r+=8}return t?[i,r+7>>>3]:[i.slice(0,a),r+7>>>3]}(e.slice(e.l||0),t);return e.l+=r[1],r[0]}function te(e,t){if(!e)throw new Error(t);"undefined"!=typeof console&&console.error(t)}function re(e,t){var r=e;prep_blob(r,0);var n={FileIndex:[],FullPaths:[]};p(n,{root:t.root});for(var i=r.length-4;(80!=r[i]||75!=r[i+1]||5!=r[i+2]||6!=r[i+3])&&i>=0;)--i;r.l=i+4,r.l+=4;var s=r.read_shift(2);r.l+=6;var o=r.read_shift(4);for(r.l=o,i=0;i<s;++i){r.l+=20;var l=r.read_shift(4),c=r.read_shift(4),d=r.read_shift(2),u=r.read_shift(2),h=r.read_shift(2);r.l+=8;var f=r.read_shift(4),m=a(r.slice(r.l+d,r.l+d+u));r.l+=d+u+h;var g=r.l;r.l=f+4,m&&m[1]&&((m[1]||{}).usz&&(c=m[1].usz),(m[1]||{}).csz&&(l=m[1].csz)),ne(r,l,c,n,m),r.l=g}return n}function ne(e,t,r,n,i){e.l+=2;var s=e.read_shift(2),o=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),r=65535&e.read_shift(2),n=new Date,i=31&r,a=15&(r>>>=5);r>>>=4,n.setMilliseconds(0),n.setFullYear(r+1980),n.setMonth(a-1),n.setDate(i);var s=31&t,o=63&(t>>>=5);return t>>>=6,n.setHours(t),n.setMinutes(o),n.setSeconds(s<<1),n}(e);if(8257&s)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),d=e.read_shift(4),u=e.read_shift(2),p=e.read_shift(2),h="",f=0;f<u;++f)h+=String.fromCharCode(e[e.l++]);if(p){var g=a(e.slice(e.l,e.l+p));(g[21589]||{}).mt&&(l=g[21589].mt),(g[1]||{}).usz&&(d=g[1].usz),(g[1]||{}).csz&&(c=g[1].csz),i&&((i[21589]||{}).mt&&(l=i[21589].mt),(i[1]||{}).usz&&(d=i[1].usz),(i[1]||{}).csz&&(c=i[1].csz))}e.l+=p;var _=e.slice(e.l,e.l+c);switch(o){case 8:_=function(e,t){if(!m)return ee(e,t);var r=new(0,m.InflateRaw),n=r._processChunk(e.slice(e.l),r._finishFlushFlag);return e.l+=r.bytesRead,n}(e,d);break;case 0:e.l+=c;break;default:throw new Error("Unsupported ZIP Compression method "+o)}var b=!1;8&s&&(134695760==e.read_shift(4)&&(e.read_shift(4),b=!0),c=e.read_shift(4),d=e.read_shift(4)),c!=t&&te(b,"Bad compressed size: "+t+" != "+c),d!=r&&te(b,"Bad uncompressed size: "+r+" != "+d),ce(n,h,_,{unsafe:!0,mt:l})}var ie={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ae(e,t){if(e.ctype)return e.ctype;var r=e.name||"",n=r.match(/\.([^\.]+)$/);return n&&ie[n[1]]||t&&(n=(r=t).match(/[\.\\]([^\.\\])+$/))&&ie[n[1]]?ie[n[1]]:"application/octet-stream"}function se(e){for(var t=Base64_encode(e),r=[],n=0;n<t.length;n+=76)r.push(t.slice(n,n+76));return r.join("\r\n")+"\r\n"}function oe(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)}));"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var r=[],n=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),i=0;i<n.length;++i){var a=n[i];if(0!=a.length)for(var s=0;s<a.length;){var o=76,l=a.slice(s,s+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=a.slice(s,s+o),(s+=o)<a.length&&(l+="="),r.push(l)}else r.push("")}return r.join("\r\n")}function le(e,t,r){for(var n,i="",a="",s="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^([^:]*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":i=c[2].trim();break;case"content-type":s=c[2].trim();break;case"content-transfer-encoding":a=c[2].trim()}}switch(++o,a.toLowerCase()){case"base64":n=s2a(Base64_decode(t.slice(o).join("")));break;case"quoted-printable":n=function(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r];r<=e.length&&"="==n.charAt(n.length-1);)n=n.slice(0,n.length-1)+e[++r];t.push(n)}for(var i=0;i<t.length;++i)t[i]=t[i].replace(/[=][0-9A-Fa-f]{2}/g,(function(e){return String.fromCharCode(parseInt(e.slice(1),16))}));return s2a(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+a)}var d=ce(e,i.slice(r.length),n,{unsafe:!0});s&&(d.ctype=s)}function ce(e,t,r,i){var a=i&&i.unsafe;a||p(e);var s=!a&&CFB.find(e,t);if(!s){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),s={name:n(t),type:2},e.FileIndex.push(s),e.FullPaths.push(o),a||CFB.utils.cfb_gc(e)}return s.content=r,s.size=r?r.length:0,i&&(i.CLSID&&(s.clsid=i.CLSID),i.mt&&(s.mt=i.mt),i.ct&&(s.ct=i.ct)),s}return t.find=function(e,t){var r=e.FullPaths.map((function(e){return e.toUpperCase()})),n=r.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),i=!1;47===t.charCodeAt(0)?(i=!0,t=r[0].slice(0,-1)+t):i=-1!==t.indexOf("/");var a=t.toUpperCase(),s=!0===i?r.indexOf(a):n.indexOf(a);if(-1!==s)return e.FileIndex[s];var o=!a.match(chr1);for(a=a.replace(chr0,""),o&&(a=a.replace(chr1,"!")),s=0;s<r.length;++s){if((o?r[s].replace(chr1,"!"):r[s]).replace(chr0,"")==a)return e.FileIndex[s];if((o?n[s].replace(chr1,"!"):n[s]).replace(chr0,"")==a)return e.FileIndex[s]}return null},t.read=function(t,r){var n=r&&r.type;switch(n||has_buf&&Buffer.isBuffer(t)&&(n="buffer"),n||"base64"){case"file":return function(t,r){return s(),o(e.readFileSync(t),r)}(t,r);case"base64":return o(s2a(Base64_decode(t)),r);case"binary":return o(s2a(t),r)}return o(t,r)},t.parse=o,t.write=function(t,r){var n=f(t,r);switch(r&&r.type||"buffer"){case"file":return s(),e.writeFileSync(r.filename,n),n;case"binary":return"string"==typeof n?n:E(n);case"base64":return Base64_encode("string"==typeof n?n:E(n));case"buffer":if(has_buf)return Buffer.isBuffer(n)?n:Buffer_from(n);case"array":return"string"==typeof n?s2a(n):n}return n},t.writeFile=function(t,r,n){s();var i=f(t,n);e.writeFileSync(r,i)},t.utils={cfb_new:function(e){var t={};return p(t,e),t},cfb_add:ce,cfb_del:function(e,t){p(e);var r=CFB.find(e,t);if(r)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==r)return e.FileIndex.splice(n,1),e.FullPaths.splice(n,1),!0;return!1},cfb_mov:function(e,t,r){p(e);var i=CFB.find(e,t);if(i)for(var a=0;a<e.FileIndex.length;++a)if(e.FileIndex[a]==i)return e.FileIndex[a].name=n(r),e.FullPaths[a]=r,!0;return!1},cfb_gc:function(e){h(e,!0)},ReadShift,CheckField,prep_blob,bconcat,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");m=e}catch(e){console.error("cannot use native zlib: "+(e.message||e))}},_deflateRaw:G,_inflateRaw:ee,consts:w},t}(),_fs;function set_fs(e){_fs=e}function blobify(e){return"string"==typeof e?s2ab(e):Array.isArray(e)?a2u(e):e}function write_dl(e,t,r){if(void 0!==_fs&&_fs.writeFileSync)return r?_fs.writeFileSync(e,t,r):_fs.writeFileSync(e,t);if("undefined"!=typeof Deno){if(r&&"string"==typeof t)switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=s2ab(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n="utf8"==r?utf8write(t):t;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(n,e);if("undefined"!=typeof Blob){var i=new Blob([blobify(n)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if("undefined"!=typeof saveAs)return saveAs(i,e);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(a)}),6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var s=document.createElement("a");if(null!=s.download)return s.download=e,s.href=a,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(a)}),6e4),a}else if("undefined"!=typeof URL&&!URL.createObjectURL&&"object"==typeof chrome){var o="data:application/octet-stream;base64,"+Base64_encode_arr(new Uint8Array(blobify(n)));return chrome.downloads.download({url:o,filename:e,saveAs:!0})}}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=a2s(t)),l.write(t),l.close(),t}catch(e){if(!e.message||-1==e.message.indexOf("onstruct"))throw e}throw new Error("cannot save file "+e)}function read_binary(e){if(void 0!==_fs)return _fs.readFileSync(e);if("undefined"!=typeof Deno)return Deno.readFileSync(e);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(e){if(!e.message||-1==e.message.indexOf("onstruct"))throw e}throw new Error("Cannot access file "+e)}function keys(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function evert_key(e,t){for(var r=[],n=keys(e),i=0;i!==n.length;++i)null==r[e[n[i]][t]]&&(r[e[n[i]][t]]=n[i]);return r}function evert(e){for(var t=[],r=keys(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function evert_num(e){for(var t=[],r=keys(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function evert_arr(e){for(var t=[],r=keys(e),n=0;n!==r.length;++n)null==t[e[r[n]]]&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var dnthresh=Date.UTC(1899,11,30,0,0,0),dnthresh1=Date.UTC(1899,11,31,0,0,0),dnthresh2=Date.UTC(1904,0,1,0,0,0);function datenum(e,t){var r=(e.getTime()-dnthresh)/864e5;return t?(r-=1462)<-1402?r-1:r:r<60?r-1:r}function numdate(e){if(e>=60&&e<61)return e;var t=new Date;return t.setTime(24*(e>60?e:e+1)*60*60*1e3+dnthresh),t}function parse_isodur(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(!n)throw new Error("Unsupported ISO Duration Field: M");r*=60}t+=r*parseInt(i[a],10)}return t}var pdre1=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,pdre2=/^(\d+)-(\d+)-(\d+)$/,pdre3=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function parseDate(e,t){if(e instanceof Date)return e;var r=e.match(pdre1);return r?new Date((t?dnthresh2:dnthresh1)+1e3*(60*(60*parseInt(r[1],10)+parseInt(r[2],10))+(r[3]?parseInt(r[3].slice(1),10):0))+(r[4]?parseInt((r[4]+"000").slice(1,4),10):0)):(r=e.match(pdre2))?new Date(Date.UTC(+r[1],+r[2]-1,+r[3],0,0,0,0)):(r=e.match(pdre3))?new Date(Date.UTC(+r[1],+r[2]-1,+r[3],+r[4],+r[5],r[6]&&parseInt(r[6].slice(1),10)||0,r[7]&&parseInt((r[7]+"0000").slice(1,4),10)||0)):new Date(e)}function cc2str(e,t){if(has_buf&&Buffer.isBuffer(e)){if(t&&buf_utf16le){if(255==e[0]&&254==e[1])return utf8write(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return utf8write(utf16beread(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return utf8write(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return utf8write(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"â‚¬":"Â€","â€š":"Â‚",Æ’:"Âƒ","â€ž":"Â„","â€¦":"Â…","â€ ":"Â†","â€¡":"Â‡",Ë†:"Âˆ","â€°":"Â‰",Å :"ÂŠ","â€¹":"Â‹",Å’:"ÂŒ",Å½:"ÂŽ","â€˜":"Â‘","â€™":"Â’","â€œ":"Â“","â€":"Â”","â€¢":"Â•","â€“":"Â–","â€”":"Â—","Ëœ":"Â˜","â„¢":"Â™",Å¡:"Âš","â€º":"Â›",Å“:"Âœ",Å¾:"Âž",Å¸:"ÂŸ"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[â‚¬â€šÆ’â€žâ€¦â€ â€¡Ë†â€°Å â€¹Å’Å½â€˜â€™â€œâ€â€¢â€“â€”Ëœâ„¢Å¡â€ºÅ“Å¾Å¸]/g,(function(e){return r[e]||e}))}catch(e){}var n=[],i=0;try{for(i=0;i<e.length-65536;i+=65536)n.push(String.fromCharCode.apply(0,e.slice(i,i+65536)));n.push(String.fromCharCode.apply(0,e.slice(i)))}catch(t){try{for(;i<e.length-16384;i+=16384)n.push(String.fromCharCode.apply(0,e.slice(i,i+16384)));n.push(String.fromCharCode.apply(0,e.slice(i)))}catch(t){for(;i!=e.length;++i)n.push(String.fromCharCode(e[i]))}}return n.join("")}function dup(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=dup(e[r]));return t}function fill(e,t){for(var r="";r.length<t;)r+=e;return r}function fuzzynum(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return r*=100,""}));return isNaN(t=Number(n))?(n=n.replace(/[(]([^()]*)[)]/,(function(e,t){return r=-r,t})),isNaN(t=Number(n))?t:t/r):t/r}var FDRE1=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,FDRE2=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,FDISO=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,utc_append_works=-177984e5==new Date("6/9/69 00:00 UTC").valueOf();function fuzzytime1(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),+e[2],+e[4],1e3*parseFloat(e[3]))):new Date(Date.UTC(1899,11,31,"p"==e[7]?12:0,+e[1],+e[2],1e3*parseFloat(e[3]))):e[5]?new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),+e[2],+e[5],e[6]?1e3*parseFloat(e[6]):0)):new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),0,0,0))}function fuzzytime2(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[4],1e3*parseFloat(e[3]))):new Date(Date.UTC(1899,11,31,0,+e[1],+e[2],1e3*parseFloat(e[3]))):e[5]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[5],e[6]?1e3*parseFloat(e[6]):0)):new Date(Date.UTC(1899,11,31,+e[1],+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1],0,0,0))}var lower_months=["january","february","march","april","may","june","july","august","september","october","november","december"];function fuzzydate(e){if(FDISO.test(e))return-1==e.indexOf("Z")?local_to_utc(new Date(e)):new Date(e);var t=e.toLowerCase(),r=t.replace(/\s+/g," ").trim(),n=r.match(FDRE1);if(n)return fuzzytime1(n);if(n=r.match(FDRE2))return fuzzytime2(n);if(n=r.match(pdre3))return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],n[6]&&parseInt(n[6].slice(1),10)||0,n[7]&&parseInt((n[7]+"0000").slice(1,4),10)||0));var i=new Date(utc_append_works&&-1==e.indexOf("UTC")?e+" UTC":e),a=new Date(NaN),s=i.getYear(),o=(i.getMonth(),i.getDate());if(isNaN(o))return a;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==lower_months.indexOf(t))return a}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return a;return s<0||s>8099||e.match(/[^-0-9:,\/\\\ ]/)?a:i}var split_regex=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,r,n){if(e||"string"==typeof r)return t.split(r);for(var i=t.split(r),a=[i[0]],s=1;s<i.length;++s)a.push(n),a.push(i[s]);return a}}();function utc_to_local(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function local_to_utc(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))}function remove_doctype(e){var t=e.slice(0,1024).indexOf("<!DOCTYPE");if(-1==t)return e;var r=e.match(/<[\w]/);return r?e.slice(0,t)+e.slice(r.index):e}function str_match_ng(e,t,r){for(var n=[],i=e.indexOf(t);i>-1;){var a=e.indexOf(r,i+t.length);if(-1==a)break;n.push(e.slice(i,a+r.length)),i=e.indexOf(t,a+r.length)}return n.length>0?n:null}function str_remove_ng(e,t,r){var n=[],i=0,a=e.indexOf(t);if(-1==a)return e;for(;a>-1;){n.push(e.slice(i,a));var s=e.indexOf(r,a+t.length);if(-1==s)break;-1==(a=e.indexOf(t,i=s+r.length))&&n.push(e.slice(i))}return n.join("")}var xml_boundary={" ":1,"\t":1,"\r":1,"\n":1,">":1};function str_match_xml(e,t){for(var r=e.indexOf("<"+t),n=t.length+1,i=e.length;r>=0&&r<=i-n&&!xml_boundary[e.charAt(r+n)];)r=e.indexOf("<"+t,r+1);if(-1===r)return null;var a=e.indexOf(">",r+t.length);if(-1===a)return null;var s="</"+t+">",o=e.indexOf(s,a);return-1==o?null:[e.slice(r,o+s.length),e.slice(a+1,o)]}var str_match_xml_ns=function(){var e={};return function(t,r){var n=e[r];n||(e[r]=n=[new RegExp("<(?:\\w+:)?"+r+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+r+">","g")]),n[0].lastIndex=n[1].lastIndex=0;var i=n[0].exec(t);if(!i)return null;var a=i.index,s=n[0].lastIndex;if(n[1].lastIndex=n[0].lastIndex,!(i=n[1].exec(t)))return null;var o=i.index,l=n[1].lastIndex;return[t.slice(a,l),t.slice(s,o)]}}(),str_match_xml_ns_g=function(){var e={};return function(t,r){var n,i=[],a=e[r];for(a||(e[r]=a=[new RegExp("<(?:\\w+:)?"+r+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+r+">","g")]),a[0].lastIndex=a[1].lastIndex=0;n=a[0].exec(t);){var s=n.index;if(a[1].lastIndex=a[0].lastIndex,!(n=a[1].exec(t)))return null;var o=a[1].lastIndex;i.push(t.slice(s,o)),a[0].lastIndex=a[1].lastIndex}return 0==i.length?null:i}}(),str_remove_xml_ns_g=function(){var e={};return function(t,r){var n,i=[],a=e[r];a||(e[r]=a=[new RegExp("<(?:\\w+:)?"+r+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+r+">","g")]),a[0].lastIndex=a[1].lastIndex=0;for(var s=0,o=0;n=a[0].exec(t);){if(s=n.index,i.push(t.slice(o,s)),o=s,a[1].lastIndex=a[0].lastIndex,!(n=a[1].exec(t)))return null;o=a[1].lastIndex,a[0].lastIndex=a[1].lastIndex}return i.push(t.slice(o)),0==i.length?"":i.join("")}}(),str_match_xml_ig=function(){var e={};return function(t,r){var n,i=[],a=e[r];for(a||(e[r]=a=[new RegExp("<"+r+"\\b[^<>]*>","ig"),new RegExp("</"+r+">","ig")]),a[0].lastIndex=a[1].lastIndex=0;n=a[0].exec(t);){var s=n.index;if(a[1].lastIndex=a[0].lastIndex,!(n=a[1].exec(t)))return null;var o=a[1].lastIndex;i.push(t.slice(s,o)),a[0].lastIndex=a[1].lastIndex}return 0==i.length?null:i}}();function getdatastr(e){return e?e.content&&e.type?cc2str(e.content,!0):e.data?debom(e.data):e.asNodeBuffer&&has_buf?debom(e.asNodeBuffer().toString("binary")):e.asBinary?debom(e.asBinary()):e._data&&e._data.getContent?debom(cc2str(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function getdatabin(e){if(!e)return null;if(e.data)return char_codes(e.data);if(e.asNodeBuffer&&has_buf)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?char_codes(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function getdata(e){return e&&".bin"===e.name.slice(-4)?getdatabin(e):getdatastr(e)}function safegetzipfile(e,t){for(var r=e.FullPaths||keys(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var s=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||i==s)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function getzipfile(e,t){var r=safegetzipfile(e,t);if(null==r)throw new Error("Cannot find file "+t+" in zip");return r}function getzipdata(e,t,r){if(!r)return getdata(getzipfile(e,t));if(!t)return null;try{return getzipdata(e,t)}catch(e){return null}}function getzipstr(e,t,r){if(!r)return getdatastr(getzipfile(e,t));if(!t)return null;try{return getzipstr(e,t)}catch(e){return null}}function getzipbin(e,t,r){if(!r)return getdatabin(getzipfile(e,t));if(!t)return null;try{return getzipbin(e,t)}catch(e){return null}}function zipentries(e){for(var t=e.FullPaths||keys(e.files),r=[],n=0;n<t.length;++n)"/"!=t[n].slice(-1)&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function zip_add_file(e,t,r){if(e.FullPaths){var n;if(Array.isArray(r)&&"string"==typeof r[0]&&(r=r.join("")),"string"==typeof r)return n=has_buf?Buffer_from(r):utf8decode(r),CFB.utils.cfb_add(e,t,n);CFB.utils.cfb_add(e,t,r)}else e.file(t,r)}function zip_new(){return CFB.utils.cfb_new()}function zip_read(e,t){switch(t.type){case"base64":return CFB.read(e,{type:"base64"});case"binary":return CFB.read(e,{type:"binary"});case"buffer":case"array":return CFB.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function resolve_path(e,t){if("/"==e.charAt(0))return e.slice(1);var r=t.split("/");"/"!=t.slice(-1)&&r.pop();for(var n=e.split("/");0!==n.length;){var i=n.shift();".."===i?r.pop():"."!==i&&r.push(i)}return r.join("/")}var XML_HEADER='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',attregexg=/\s([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,tagregex1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?<>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'"<>\s=]+))*\s*[\/\?]?>/gm,tagregex2=/<[^<>]*>/g,tagregex=XML_HEADER.match(tagregex1)?tagregex1:tagregex2,nsregex=/<\w*:/,nsregex2=/<(\/?)\w+:/;function parsexmltag(e,t,r){for(var n={},i=0,a=0;i!==e.length&&32!==(a=e.charCodeAt(i))&&10!==a&&13!==a;++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var s=e.match(attregexg),o=0,l="",c=0,d="",u="",p=1;if(s)for(c=0;c!=s.length;++c){for(u=s[c].slice(1),a=0;a!=u.length&&61!==u.charCodeAt(a);++a);for(d=u.slice(0,a).trim();32==u.charCodeAt(a+1);)++a;for(p=34==(i=u.charCodeAt(a+1))||39==i?1:0,l=u.slice(a+1+p,u.length-p),o=0;o!=d.length&&58!==d.charCodeAt(o);++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,r||(n[d.toLowerCase()]=l);else{var h=(5===o&&"xmlns"===d.slice(0,5)?"xmlns":"")+d.slice(o+1);if(n[h]&&"ext"==d.slice(o-3,o))continue;n[h]=l,r||(n[h.toLowerCase()]=l)}}return n}function parsexmltagraw(e,t,r){for(var n={},i=0,a=0;i!==e.length&&32!==(a=e.charCodeAt(i))&&10!==a&&13!==a;++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var s=e.match(attregexg),o="",l=0,c="",d="",u=1;if(s)for(l=0;l!=s.length;++l){for(d=s[l].slice(1),a=0;a!=d.length&&61!==d.charCodeAt(a);++a);for(c=d.slice(0,a).trim();32==d.charCodeAt(a+1);)++a;u=34==(i=d.charCodeAt(a+1))||39==i?1:0,o=d.slice(a+1+u,d.length-u),c.indexOf("_")>0&&(c=c.slice(0,c.indexOf("_"))),n[c]=o,r||(n[c.toLowerCase()]=o)}return n}function strip_ns(e){return e.replace(nsregex2,"<$1")}var encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rencoding=evert(encodings),unescapexml=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(-1==a)return i.replace(e,(function(e,t){return encodings[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e})).replace(t,(function(e,t){return String.fromCharCode(parseInt(t,16))}));var s=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,s)+r(i.slice(s+3))}return function(e,t){var n=r(e);return t?n.replace(/\r\n/g,"\n"):n}}(),decregex=/[&<>'"]/g,charegex=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function escapexml(e){return(e+"").replace(decregex,(function(e){return rencoding[e]})).replace(charegex,(function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"}))}function escapexmltag(e){return escapexml(e).replace(/ /g,"_x0020_")}var htmlcharegex=/[\u0000-\u001f]/g;function escapehtml(e){return(e+"").replace(decregex,(function(e){return rencoding[e]})).replace(/\n/g,"<br/>").replace(htmlcharegex,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}function escapexlml(e){return(e+"").replace(decregex,(function(e){return rencoding[e]})).replace(htmlcharegex,(function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"}))}var xlml_fixstr=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(r){return r.replace(e,t)}}();function xlml_unfixstr(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function parsexmlbool(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function utf8reada(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0;r<e.length;)(n=e.charCodeAt(r++))<128?t+=String.fromCharCode(n):(i=e.charCodeAt(r++),n>191&&n<224?(s=(31&n)<<6,s|=63&i,t+=String.fromCharCode(s)):(a=e.charCodeAt(r++),n<240?t+=String.fromCharCode((15&n)<<12|(63&i)<<6|63&a):(o=((7&n)<<18|(63&i)<<12|(63&a)<<6|63&(s=e.charCodeAt(r++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function utf8readb(e){var t,r,n,i=new_raw_buf(2*e.length),a=1,s=0,o=0;for(r=0;r<e.length;r+=a)a=1,(n=e.charCodeAt(r))<128?t=n:n<224?(t=64*(31&n)+(63&e.charCodeAt(r+1)),a=2):n<240?(t=4096*(15&n)+64*(63&e.charCodeAt(r+1))+(63&e.charCodeAt(r+2)),a=3):(a=4,t=262144*(7&n)+4096*(63&e.charCodeAt(r+1))+64*(63&e.charCodeAt(r+2))+(63&e.charCodeAt(r+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(i[s++]=255&o,i[s++]=o>>>8,o=0),i[s++]=t%256,i[s++]=t>>>8;return i.slice(0,s).toString("ucs2")}function utf8readc(e){return Buffer_from(e,"binary").toString("utf8")}var utf8corpus="foo bar bazÃ¢Â˜ÂƒÃ°ÂŸÂÂ£",utf8read=has_buf&&(utf8readc(utf8corpus)==utf8reada(utf8corpus)&&utf8readc||utf8readb(utf8corpus)==utf8reada(utf8corpus)&&utf8readb)||utf8reada,utf8write=has_buf?function(e){return Buffer_from(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(63&n)));break;case n>=55296&&n<57344:n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(63&i)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)))}return t.join("")},htmldecode=function(){var e=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}));return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^<>]*>/g,""),n=0;n<e.length;++n)r=r.replace(e[n][0],e[n][1]);return r}}(),vtvregex=/<\/?(?:vt:)?variant>/g,vtmregex=/<(?:vt:)([^<"'>]*)>([\s\S]*)</;function parseVector(e,t){var r=parsexmltag(e),n=str_match_xml_ns_g(e,r.baseType)||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach((function(e){var t=e.replace(vtvregex,"").match(vtmregex);t&&i.push({v:utf8read(t[2]),t:t[1]})})),i}var wtregex=/(^\s|\s$|\n)/;function writetag(e,t){return"<"+e+(t.match(wtregex)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function wxt_helper(e){return keys(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}function writextag(e,t,r){return"<"+e+(null!=r?wxt_helper(r):"")+(null!=t?(t.match(wtregex)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function write_w3cdtf(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function write_vt(e,t){switch(typeof e){case"string":var r=writextag("vt:lpwstr",escapexml(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return writextag((0|e)==e?"vt:i4":"vt:r8",escapexml(String(e)));case"boolean":return writextag("vt:bool",e?"true":"false")}if(e instanceof Date)return writextag("vt:filetime",write_w3cdtf(e));throw new Error("Unable to serialize "+e)}function xlml_normalize(e){if(has_buf&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array)return utf8read(a2s(ab2a(e)));throw new Error("Bad input format: expected Buffer or string")}var xlmlregex=/<([\/]?)([^\s?><!\/:"]*:|)([^\s?<>:\/"]+)(?:\s+[^<>=?"'\s]+="[^"]*?")*\s*[\/]?>/gm,XMLNS={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},XMLNS_main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],XLMLNS={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function read_double_le(e,t){for(var r=1-2*(e[t+7]>>>7),n=((127&e[t+7])<<4)+(e[t+6]>>>4&15),i=15&e[t+6],a=5;a>=0;--a)i=256*i+e[t+a];return 2047==n?0==i?r*(1/0):NaN:(0==n?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function write_double_le(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,s=n?-t:t;isFinite(s)?0==s?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=255&a;e[r+6]=(15&i)<<4|15&a,e[r+7]=i>>4|n}var ___toBuffer=function(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var n=0,i=e[0][r].length;n<i;n+=10240)t.push.apply(t,e[0][r].slice(n,n+10240));return t},__toBuffer=has_buf?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map((function(e){return Buffer.isBuffer(e)?e:Buffer_from(e)}))):___toBuffer(e)}:___toBuffer,___utf16le=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(__readUInt16LE(e,i)));return n.join("").replace(chr0,"")},__utf16le=has_buf?function(e,t,r){return Buffer.isBuffer(e)&&buf_utf16le?e.toString("utf16le",t,r).replace(chr0,""):___utf16le(e,t,r)}:___utf16le,___hexlify=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},__hexlify=has_buf?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):___hexlify(e,t,r)}:___hexlify,___utf8=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(__readUInt8(e,i)));return n.join("")},__utf8=has_buf?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):___utf8(e,t,r)}:___utf8,___lpstr=function(e,t){var r=__readUInt32LE(e,t);return r>0?__utf8(e,t+4,t+4+r-1):""},__lpstr=___lpstr,___cpstr=function(e,t){var r=__readUInt32LE(e,t);return r>0?__utf8(e,t+4,t+4+r-1):""},__cpstr=___cpstr,___lpwstr=function(e,t){var r=2*__readUInt32LE(e,t);return r>0?__utf8(e,t+4,t+4+r-1):""},__lpwstr=___lpwstr,___lpp4=function(e,t){var r=__readUInt32LE(e,t);return r>0?__utf16le(e,t+4,t+4+r):""},__lpp4=___lpp4,___8lpp4=function(e,t){var r=__readUInt32LE(e,t);return r>0?__utf8(e,t+4,t+4+r):""},__8lpp4=___8lpp4,___double=function(e,t){return read_double_le(e,t)},__double=___double,is_buf=function(e){return Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array};function cpdoit(){__utf16le=function(e,t,r){return $cptable.utils.decode(1200,e.slice(t,r)).replace(chr0,"")},__utf8=function(e,t,r){return $cptable.utils.decode(65001,e.slice(t,r))},__lpstr=function(e,t){var r=__readUInt32LE(e,t);return r>0?$cptable.utils.decode(current_ansi,e.slice(t+4,t+4+r-1)):""},__cpstr=function(e,t){var r=__readUInt32LE(e,t);return r>0?$cptable.utils.decode(current_codepage,e.slice(t+4,t+4+r-1)):""},__lpwstr=function(e,t){var r=2*__readUInt32LE(e,t);return r>0?$cptable.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},__lpp4=function(e,t){var r=__readUInt32LE(e,t);return r>0?$cptable.utils.decode(1200,e.slice(t+4,t+4+r)):""},__8lpp4=function(e,t){var r=__readUInt32LE(e,t);return r>0?$cptable.utils.decode(65001,e.slice(t+4,t+4+r)):""}}has_buf&&(__lpstr=function(e,t){if(!Buffer.isBuffer(e))return ___lpstr(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},__cpstr=function(e,t){if(!Buffer.isBuffer(e))return ___cpstr(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},__lpwstr=function(e,t){if(!Buffer.isBuffer(e)||!buf_utf16le)return ___lpwstr(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},__lpp4=function(e,t){if(!Buffer.isBuffer(e)||!buf_utf16le)return ___lpp4(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},__8lpp4=function(e,t){if(!Buffer.isBuffer(e))return ___8lpp4(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},__double=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):___double(e,t)},is_buf=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array}),void 0!==$cptable&&cpdoit();var __readUInt8=function(e,t){return e[t]},__readUInt16LE=function(e,t){return 256*e[t+1]+e[t]},__readInt16LE=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-1*(65535-r+1)},__readUInt32LE=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},__readInt32LE=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},__readInt32BE=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ReadShift(e,t){var r,n,i,a,s,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,has_buf&&Buffer.isBuffer(this)&&buf_utf16le)l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)l+=String.fromCharCode(__readUInt16LE(this,o)),o+=2;e*=2;break;case"utf8":l=__utf8(this,this.l,this.l+e);break;case"utf16le":e*=2,l=__utf16le(this,this.l,this.l+e);break;case"wstr":if(void 0===$cptable)return ReadShift.call(this,e,"dbcs");l=$cptable.utils.decode(current_codepage,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=__lpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpstr-cp":l=__cpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpwstr":l=__lpwstr(this,this.l),e=4+2*__readUInt32LE(this,this.l);break;case"lpp4":e=4+__readUInt32LE(this,this.l),l=__lpp4(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+__readUInt32LE(this,this.l),l=__8lpp4(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(i=__readUInt8(this,this.l+e++));)c.push(_getchar(i));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(i=__readUInt16LE(this,this.l+e));)c.push(_getchar(i)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,s=0;s<e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return i=__readUInt8(this,o),this.l=o+1,a=ReadShift.call(this,e-s,i?"dbcs-cont":"sbcs-cont"),c.join("")+a;c.push(_getchar(__readUInt16LE(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if(void 0!==$cptable){l=$cptable.utils.decode(current_codepage,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",o=this.l,s=0;s!=e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return i=__readUInt8(this,o),this.l=o+1,a=ReadShift.call(this,e-s,i?"dbcs-cont":"sbcs-cont"),c.join("")+a;c.push(_getchar(__readUInt8(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return r=__readUInt8(this,this.l),this.l++,r;case 2:return r=("i"===t?__readInt16LE:__readUInt16LE)(this,this.l),this.l+=2,r;case 4:case-4:return"i"!==t&&128&this[this.l+3]?(n=__readUInt32LE(this,this.l),this.l+=4,n):(r=(e>0?__readInt32LE:__readInt32BE)(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return n=8==e?__double(this,this.l):__double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:l=__hexlify(this,this.l,e)}}return this.l+=e,l}var __writeUInt32LE=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},__writeInt32LE=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},__writeUInt16LE=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function WriteShift(e,t,r){var n=0,i=0;if("dbcs"===r){for(i=0;i!=t.length;++i)__writeUInt16LE(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if("sbcs"===r||"cpstr"==r)if(void 0!==$cptable&&874==current_ansi){for(i=0;i!=t.length;++i){var a=$cptable.utils.encode(current_ansi,t.charAt(i));this[this.l+i]=a[0]}n=t.length}else if(void 0!==$cptable&&"cpstr"==r){if((a=$cptable.utils.encode(current_codepage,t)).length==t.length)for(i=0;i<t.length;++i)0==a[i]&&0!=t.charCodeAt(i)&&(a[i]=95);if(a.length==2*t.length)for(i=0;i<t.length;++i)0==a[2*i]&&0==a[2*i+1]&&0!=t.charCodeAt(i)&&(a[2*i]=95);for(i=0;i<a.length;++i)this[this.l+i]=a[i];n=a.length}else{for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=255&t.charCodeAt(i);n=t.length}else{if("hex"===r){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}if("utf16le"===r){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:n=1,this[this.l]=255&t;break;case 2:n=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:n=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:n=4,__writeUInt32LE(this,t,this.l);break;case 8:if(n=8,"f"===r){write_double_le(this,t,this.l);break}case 16:break;case-4:n=4,__writeInt32LE(this,t,this.l)}}return this.l+=n,this}function CheckField(e,t){var r=__hexlify(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function prep_blob(e,t){e.l=t,e.read_shift=ReadShift,e.chk=CheckField,e.write_shift=WriteShift}function parsenoop(e,t){e.l+=t}function new_buf(e){var t=new_raw_buf(e);return prep_blob(t,0),t}function recordhopper(e,t,r){if(e){var n,i,a;prep_blob(e,e.l||0);for(var s=e.length,o=0,l=0;e.l<s;){128&(o=e.read_shift(1))&&(o=(127&o)+((127&e.read_shift(1))<<7));var c=XLSBRecordEnum[o]||XLSBRecordEnum[65535];for(a=127&(n=e.read_shift(1)),i=1;i<4&&128&n;++i)a+=(127&(n=e.read_shift(1)))<<7*i;l=e.l+a;var d=c.f&&c.f(e,a,r);if(e.l=l,t(d,c,o))return}}}function buf_array(){var e=[],t=has_buf?16384:2048,r=(has_buf&&new_buf(t).copy,function(e){var t=new_buf(e);return prep_blob(t,0),t}),n=r(t),i=function(){n&&(n.l&&(n.length>n.l&&((n=n.slice(0,n.l)).l=n.length),n.length>0&&e.push(n)),n=null)},a=function(e){return n&&e<n.length-n.l?n:(i(),n=r(Math.max(e+1,t)))};return{next:a,push:function(e){i(),null==(n=e).l&&(n.l=n.length),a(t)},end:function(){return i(),bconcat(e)},_bufs:e,end2:function(){return i(),e}}}function write_record(e,t,r,n){var i,a=+t;if(!isNaN(a)){n||(n=XLSBRecordEnum[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,128+(127&a)),s.write_shift(1,a>>7));for(var o=0;4!=o;++o){if(!(n>=128)){s.write_shift(1,n);break}s.write_shift(1,128+(127&n)),n>>=7}n>0&&is_buf(r)&&e.push(r)}}function shift_cell_xls(e,t,r){var n=dup(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function shift_range_xls(e,t,r){var n=dup(e);return n.s=shift_cell_xls(n.s,t.s,r),n.e=shift_cell_xls(n.e,t.s,r),n}function encode_cell_xls(e,t){if(e.cRel&&e.c<0)for(e=dup(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=dup(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=encode_cell(e);return e.cRel||null==e.cRel||(r=fix_col(r)),e.rRel||null==e.rRel||(r=fix_row(r)),r}function encode_range_xls(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?encode_cell_xls(e.s,t.biff)+":"+encode_cell_xls(e.e,t.biff):(e.s.rRel?"":"$")+encode_row(e.s.r)+":"+(e.e.rRel?"":"$")+encode_row(e.e.r):(e.s.cRel?"":"$")+encode_col(e.s.c)+":"+(e.e.cRel?"":"$")+encode_col(e.e.c)}function decode_row(e){return parseInt(unfix_row(e),10)-1}function encode_row(e){return""+(e+1)}function fix_row(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function unfix_row(e){return e.replace(/\$(\d+)$/,"$1")}function decode_col(e){for(var t=unfix_col(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function encode_col(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function fix_col(e){return e.replace(/^([A-Z])/,"$$$1")}function unfix_col(e){return e.replace(/^\$([A-Z])/,"$1")}function split_cell(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function decode_cell(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function encode_cell(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function decode_range(e){var t=e.indexOf(":");return-1==t?{s:decode_cell(e),e:decode_cell(e)}:{s:decode_cell(e.slice(0,t)),e:decode_cell(e.slice(t+1))}}function encode_range(e,t){return void 0===t||"number"==typeof t?encode_range(e.s,e.e):("string"!=typeof e&&(e=encode_cell(e)),"string"!=typeof t&&(t=encode_cell(t)),e==t?e:e+":"+t)}function fix_range(e){var t=decode_range(e);return"$"+encode_col(t.s.c)+"$"+encode_row(t.s.r)+":$"+encode_col(t.e.c)+"$"+encode_row(t.e.r)}function formula_quote_sheet_name(e,t){if(!(e||t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e}function safe_decode_range(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||10!=i)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function safe_format_cell(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=SSF_format(e.z,r?datenum(t):t)}catch(e){}try{return e.w=SSF_format((e.XF||{}).numFmtId||(r?14:0),r?datenum(t):t)}catch(e){return""+t}}function format_cell(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?BErr[e.v]||e.v:safe_format_cell(e,null==t?e.v:t))}function sheet_to_workbook(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function sheet_new(e){var t={};return(e||{}).dense&&(t["!data"]=[]),t}function sheet_add_aoa(e,t,r){var n=r||{},i=e?null!=e["!data"]:n.dense;null!=DENSE&&null==i&&(i=DENSE);var a=e||(i?{"!data":[]}:{});i&&!a["!data"]&&(a["!data"]=[]);var s=0,o=0;if(a&&null!=n.origin)if("number"==typeof n.origin)s=n.origin;else{var l="string"==typeof n.origin?decode_cell(n.origin):n.origin;s=l.r,o=l.c}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=safe_decode_range(a["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),-1==s&&(c.e.r=s=a["!ref"]?d.e.r+1:0)}else c.s.c=c.e.c=c.s.r=c.e.r=0;for(var u=[],p=!1,h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");var f=s+h;i&&(a["!data"][f]||(a["!data"][f]=[]),u=a["!data"][f]);for(var m=t[h],g=0;g!=m.length;++g)if(void 0!==m[g]){var _={v:m[g],t:""},b=o+g;if(c.s.r>f&&(c.s.r=f),c.s.c>b&&(c.s.c=b),c.e.r<f&&(c.e.r=f),c.e.c<b&&(c.e.c=b),p=!0,!m[g]||"object"!=typeof m[g]||Array.isArray(m[g])||m[g]instanceof Date)if(Array.isArray(_.v)&&(_.f=m[g][1],_.v=_.v[0]),null===_.v)if(_.f)_.t="n";else if(n.nullError)_.t="e",_.v=0;else{if(!n.sheetStubs)continue;_.t="z"}else"number"==typeof _.v?isFinite(_.v)?_.t="n":isNaN(_.v)?(_.t="e",_.v=15):(_.t="e",_.v=7):"boolean"==typeof _.v?_.t="b":_.v instanceof Date?(_.z=n.dateNF||table_fmt[14],n.UTC||(_.v=local_to_utc(_.v)),n.cellDates?(_.t="d",_.w=SSF_format(_.z,datenum(_.v,n.date1904))):(_.t="n",_.v=datenum(_.v,n.date1904),_.w=SSF_format(_.z,_.v))):_.t="s";else _=m[g];if(i)u[b]&&u[b].z&&(_.z=u[b].z),u[b]=_;else{var v=encode_col(b)+(f+1);a[v]&&a[v].z&&(_.z=a[v].z),a[v]=_}}}return p&&c.s.c<104e5&&(a["!ref"]=encode_range(c)),a}function aoa_to_sheet(e,t){return sheet_add_aoa(null,e,t)}function parse_Int32LE(e){return e.read_shift(4,"i")}function write_UInt32LE(e,t){return t||(t=new_buf(4)),t.write_shift(4,e),t}function parse_XLWideString(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function write_XLWideString(e,t){var r=!1;return null==t&&(r=!0,t=new_buf(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function parse_StrRun(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function write_StrRun(e,t){return t||(t=new_buf(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0),t}function parse_RichStr(e,t){var r=e.l,n=e.read_shift(1),i=parse_XLWideString(e),a=[],s={t:i,h:i};if(1&n){for(var o=e.read_shift(4),l=0;l!=o;++l)a.push(parse_StrRun(e));s.r=a}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function write_RichStr(e,t){var r=!1;return null==t&&(r=!0,t=new_buf(15+4*e.t.length)),t.write_shift(1,0),write_XLWideString(e.t,t),r?t.slice(0,t.l):t}var parse_BrtCommentText=parse_RichStr;function write_BrtCommentText(e,t){var r=!1;return null==t&&(r=!0,t=new_buf(23+4*e.t.length)),t.write_shift(1,1),write_XLWideString(e.t,t),t.write_shift(4,1),write_StrRun({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function parse_XLSBCell(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function write_XLSBCell(e,t){return null==t&&(t=new_buf(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function parse_XLSBShortCell(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function write_XLSBShortCell(e,t){return null==t&&(t=new_buf(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var parse_XLSBCodeName=parse_XLWideString,write_XLSBCodeName=write_XLWideString;function parse_XLNullableWideString(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function write_XLNullableWideString(e,t){var r=!1;return null==t&&(r=!0,t=new_buf(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var parse_XLNameWideString=parse_XLWideString,parse_RelID=parse_XLNullableWideString,write_RelID=write_XLNullableWideString;function parse_RkNumber(e){var t=e.slice(e.l,e.l+4),r=1&t[0],n=2&t[0];e.l+=4;var i=0===n?__double([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):__readInt32LE(t,0)>>2;return r?i/100:i}function write_RkNumber(e,t){null==t&&(t=new_buf(4));var r=0,n=0,i=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?n=1:i==(0|i)&&i>=-(1<<29)&&i<1<<29&&(n=1,r=1),!n)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((r?i:e)<<2)+(r+2))}function parse_RfX(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function write_RfX(e,t){return t||(t=new_buf(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var parse_UncheckedRfX=parse_RfX,write_UncheckedRfX=write_RfX;function parse_Xnum(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function write_Xnum(e,t){return(t||new_buf(8)).write_shift(8,e,"f")}function parse_BrtColor(e){var t={},r=e.read_shift(1)>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),a=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=n;var l=XLSIcv[n];l&&(t.rgb=rgb2Hex(l));break;case 2:t.rgb=rgb2Hex([a,s,o]);break;case 3:t.theme=n}return 0!=i&&(t.tint=i>0?i/32767:i/32768),t}function write_BrtColor(e,t){if(t||(t=new_buf(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),e.rgb&&null==e.theme){var n=e.rgb||"FFFFFF";"number"==typeof n&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}function parse_FontFlags(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}function write_FontFlags(e,t){t||(t=new_buf(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function parse_ClipboardFormatOrString(e,t){var r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}function parse_ClipboardFormatOrAnsiString(e){return parse_ClipboardFormatOrString(e,1)}function parse_ClipboardFormatOrUnicodeString(e){return parse_ClipboardFormatOrString(e,2)}var VT_I2=2,VT_I4=3,VT_BOOL=11,VT_VARIANT=12,VT_UI4=19,VT_FILETIME=64,VT_BLOB=65,VT_CF=71,VT_VECTOR_VARIANT=4108,VT_VECTOR_LPSTR=4126,VT_STRING=80,VT_USTR=81,VT_CUSTOM=[VT_STRING,VT_USTR],DocSummaryPIDDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Category",t:VT_STRING},3:{n:"PresentationFormat",t:VT_STRING},4:{n:"ByteCount",t:VT_I4},5:{n:"LineCount",t:VT_I4},6:{n:"ParagraphCount",t:VT_I4},7:{n:"SlideCount",t:VT_I4},8:{n:"NoteCount",t:VT_I4},9:{n:"HiddenCount",t:VT_I4},10:{n:"MultimediaClipCount",t:VT_I4},11:{n:"ScaleCrop",t:VT_BOOL},12:{n:"HeadingPairs",t:VT_VECTOR_VARIANT},13:{n:"TitlesOfParts",t:VT_VECTOR_LPSTR},14:{n:"Manager",t:VT_STRING},15:{n:"Company",t:VT_STRING},16:{n:"LinksUpToDate",t:VT_BOOL},17:{n:"CharacterCount",t:VT_I4},19:{n:"SharedDoc",t:VT_BOOL},22:{n:"HyperlinksChanged",t:VT_BOOL},23:{n:"AppVersion",t:VT_I4,p:"version"},24:{n:"DigSig",t:VT_BLOB},26:{n:"ContentType",t:VT_STRING},27:{n:"ContentStatus",t:VT_STRING},28:{n:"Language",t:VT_STRING},29:{n:"Version",t:VT_STRING},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},SummaryPIDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Title",t:VT_STRING},3:{n:"Subject",t:VT_STRING},4:{n:"Author",t:VT_STRING},5:{n:"Keywords",t:VT_STRING},6:{n:"Comments",t:VT_STRING},7:{n:"Template",t:VT_STRING},8:{n:"LastAuthor",t:VT_STRING},9:{n:"RevNumber",t:VT_STRING},10:{n:"EditTime",t:VT_FILETIME},11:{n:"LastPrinted",t:VT_FILETIME},12:{n:"CreatedDate",t:VT_FILETIME},13:{n:"ModifiedDate",t:VT_FILETIME},14:{n:"PageCount",t:VT_I4},15:{n:"WordCount",t:VT_I4},16:{n:"CharCount",t:VT_I4},17:{n:"Thumbnail",t:VT_CF},18:{n:"Application",t:VT_STRING},19:{n:"DocSecurity",t:VT_I4},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},CountryEnum={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XLSFillPattern=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function rgbify(e){return e.map((function(e){return[e>>16&255,e>>8&255,255&e]}))}var _XLSIcv=rgbify([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XLSIcv=dup(_XLSIcv),BErr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RBErr={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},XLSLblBuiltIn=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],ct2type={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},CT_LIST={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function new_ct(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function parse_ct(e){var t=new_ct();if(!e||!e.match)return t;var r={};if((e.match(tagregex)||[]).forEach((function(e){var n=parsexmltag(e);switch(n[0].replace(nsregex,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension.toLowerCase()]=n.ContentType;break;case"<Override":void 0!==t[ct2type[n.ContentType]]&&t[ct2type[n.ContentType]].push(n.PartName)}})),t.xmlns!==XMLNS.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function write_ct(e,t,r){var n,i=evert_arr(ct2type),a=[];r||(a[a.length]=XML_HEADER,a[a.length]=writextag("Types",null,{xmlns:XMLNS.CT,"xmlns:xsd":XMLNS.xsd,"xmlns:xsi":XMLNS.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map((function(e){return writextag("Default",null,{Extension:e[0],ContentType:e[1]})}))));var s=function(r){e[r]&&e[r].length>0&&(n=e[r][0],a[a.length]=writextag("Override",null,{PartName:("/"==n[0]?"":"/")+n,ContentType:CT_LIST[r][t.bookType]||CT_LIST[r].xlsx}))},o=function(r){(e[r]||[]).forEach((function(e){a[a.length]=writextag("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:CT_LIST[r][t.bookType]||CT_LIST[r].xlsx})}))},l=function(t){(e[t]||[]).forEach((function(e){a[a.length]=writextag("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:i[t][0]})}))};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),!r&&a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function get_rels_path(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function parse_rels(e,t){var r={"!id":{}};if(!e)return r;"/"!==t.charAt(0)&&(t="/"+t);var n={};return(e.match(tagregex)||[]).forEach((function(e){var i=parsexmltag(e);if("<Relationship"===i[0]){var a={};a.Type=i.Type,a.Target=unescapexml(i.Target),a.Id=i.Id,i.TargetMode&&(a.TargetMode=i.TargetMode);var s="External"===i.TargetMode?i.Target:resolve_path(i.Target,t);r[s]=a,n[i.Id]=a}})),r["!id"]=n,r}function write_rels(e){var t=[XML_HEADER,writextag("Relationships",null,{xmlns:XMLNS.RELS})];return keys(e["!id"]).forEach((function(r){t[t.length]=writextag("Relationship",null,e["!id"][r])})),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function add_rels(e,t,r,n,i,a){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,a?i.TargetMode=a:[RELS.HLINK,RELS.XPATH,RELS.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var CT_ODS="application/vnd.oasis.opendocument.spreadsheet";function parse_manifest(e,t){for(var r,n,i=xlml_normalize(e);r=xlmlregex.exec(i);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(n=parsexmltag(r[0],!1)).path&&n.type!==CT_ODS)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}function write_manifest(e){var t=[XML_HEADER];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}function write_rdf_type(e,t,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function write_rdf_has(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function write_rdf(e){var t=[XML_HEADER];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var r=0;r!=e.length;++r)t.push(write_rdf_type(e[r][0],e[r][1])),t.push(write_rdf_has("",e[r][0]));return t.push(write_rdf_type("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function write_meta_ods(e,t){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+XLSX.version+"</meta:generator></office:meta></office:document-meta>"}var CORE_PROPS=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function parse_core_props(e){var t={};e=utf8read(e);for(var r=0;r<CORE_PROPS.length;++r){var n=CORE_PROPS[r],i=str_match_xml(e,n[0]);null!=i&&i.length>0&&(t[n[1]]=unescapexml(i[1])),"date"===n[2]&&t[n[1]]&&(t[n[1]]=parseDate(t[n[1]]))}return t}function cp_doit(e,t,r,n,i){null==i[e]&&null!=t&&""!==t&&(i[e]=t,t=escapexml(t),n[n.length]=r?writextag(e,t,r):writetag(e,t))}function write_core_props(e,t){var r=t||{},n=[XML_HEADER,writextag("cp:coreProperties",null,{"xmlns:cp":XMLNS.CORE_PROPS,"xmlns:dc":XMLNS.dc,"xmlns:dcterms":XMLNS.dcterms,"xmlns:dcmitype":XMLNS.dcmitype,"xmlns:xsi":XMLNS.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(null!=e.CreatedDate&&cp_doit("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:write_w3cdtf(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),null!=e.ModifiedDate&&cp_doit("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:write_w3cdtf(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var a=0;a!=CORE_PROPS.length;++a){var s=CORE_PROPS[a],o=r.Props&&null!=r.Props[s[1]]?r.Props[s[1]]:e?e[s[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&cp_doit(s[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],PseudoPropsPairs=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function load_props_pairs(e,t,r,n){var i=[];if("string"==typeof e)i=parseVector(e,n);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map((function(e){return{v:e}})));var s="string"==typeof t?parseVector(t,n).map((function(e){return e.v})):t,o=0,l=0;if(s.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"å·¥ä½œè¡¨":case"Ð›Ð¸ÑÑ‚Ñ‹":case"Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ø¹Ù…Ù„":case"ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆ":case"×’×œ×™×•× ×•×ª ×¢×‘×•×“×”":case"ArbeitsblÃ¤tter":case"Ã‡alÄ±ÅŸma SayfalarÄ±":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cÃ¡lculo":case"Planilhas":case"Regneark":case"Hojas de cÃ¡lculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"åå‰ä»˜ãä¸€è¦§":case"Benannte Bereiche":case"Navngivne omrÃ¥der":r.NamedRanges=l,r.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=s.slice(o,o+l)}o+=l}}function parse_ext_props(e,t,r){var n={};return t||(t={}),e=utf8read(e),EXT_PROPS.forEach((function(r){var i=(str_match_xml_ns(e,r[0])||[])[1];switch(r[2]){case"string":i&&(t[r[1]]=unescapexml(i));break;case"bool":t[r[1]]="true"===i;break;case"raw":var a=str_match_xml(e,r[0]);a&&a.length>0&&(n[r[1]]=a[1])}})),n.HeadingPairs&&n.TitlesOfParts&&load_props_pairs(n.HeadingPairs,n.TitlesOfParts,t,r),t}function write_ext_props(e){var t=[],r=writextag;return e||(e={}),e.Application="SheetJS",t[t.length]=XML_HEADER,t[t.length]=writextag("Properties",null,{xmlns:XMLNS.EXT_PROPS,"xmlns:vt":XMLNS.vt}),EXT_PROPS.forEach((function(n){if(void 0!==e[n[1]]){var i;switch(n[2]){case"string":i=escapexml(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false"}void 0!==i&&(t[t.length]=r(n[0],i))}})),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map((function(e){return"<vt:lpstr>"+escapexml(e)+"</vt:lpstr>"})).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var custregex=/<[^<>]+>[^<]*/g;function parse_cust_props(e,t){var r={},n="",i=e.match(custregex);if(i)for(var a=0;a!=i.length;++a){var s=i[a],o=parsexmltag(s);switch(strip_ns(o[0])){case"<?xml":case"<Properties":break;case"<property":n=unescapexml(o.name);break;case"</property>":n=null;break;default:if(0===s.indexOf("<vt:")){var l=s.split(">"),c=l[0].slice(4),d=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":r[n]=unescapexml(d);break;case"bool":r[n]=parsexmlbool(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=parseDate(d);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!=typeof console&&console.warn("Unexpected",s,c,l)}}else if("</"===s.slice(0,2));else if(t.WTF)throw new Error(s)}}return r}function write_cust_props(e){var t=[XML_HEADER,writextag("Properties",null,{xmlns:XMLNS.CUST_PROPS,"xmlns:vt":XMLNS.vt})];if(!e)return t.join("");var r=1;return keys(e).forEach((function(n){++r,t[t.length]=writextag("property",write_vt(e[n],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:escapexml(n)})})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var XLMLDocPropsMap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},evert_XLMLDPM;function xlml_set_prop(e,t,r){evert_XLMLDPM||(evert_XLMLDPM=evert(XLMLDocPropsMap)),e[t=evert_XLMLDPM[t]||t]=r}function xlml_write_docprops(e,t){var r=[];return keys(XLMLDocPropsMap).map((function(e){for(var t=0;t<CORE_PROPS.length;++t)if(CORE_PROPS[t][1]==e)return CORE_PROPS[t];for(t=0;t<EXT_PROPS.length;++t)if(EXT_PROPS[t][1]==e)return EXT_PROPS[t];throw e})).forEach((function(n){if(null!=e[n[1]]){var i=t&&t.Props&&null!=t.Props[n[1]]?t.Props[n[1]]:e[n[1]];"date"===n[2]&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof i?i=String(i):!0===i||!1===i?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(writetag(XLMLDocPropsMap[n[1]]||n[1],i))}})),writextag("DocumentProperties",r.join(""),{xmlns:XLMLNS.o})}function xlml_write_custprops(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&keys(e).forEach((function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var n=0;n<CORE_PROPS.length;++n)if(t==CORE_PROPS[n][1])return;for(n=0;n<EXT_PROPS.length;++n)if(t==EXT_PROPS[n][1])return;for(n=0;n<r.length;++n)if(t==r[n])return;var a=e[t],s="string";"number"==typeof a?(s="float",a=String(a)):!0===a||!1===a?(s="boolean",a=a?"1":"0"):a=String(a),i.push(writextag(escapexmltag(t),a,{"dt:dt":s}))}})),t&&keys(t).forEach((function(r){if(Object.prototype.hasOwnProperty.call(t,r)&&(!e||!Object.prototype.hasOwnProperty.call(e,r))){var n=t[r],a="string";"number"==typeof n?(a="float",n=String(n)):!0===n||!1===n?(a="boolean",n=n?"1":"0"):n instanceof Date?(a="dateTime.tz",n=n.toISOString()):n=String(n),i.push(writextag(escapexmltag(r),n,{"dt:dt":a}))}})),"<"+n+' xmlns="'+XLMLNS.o+'">'+i.join("")+"</"+n+">"}function parse_FILETIME(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date(1e3*(r/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function write_FILETIME(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,r=t%Math.pow(2,32),n=(t-r)/Math.pow(2,32);n*=1e7;var i=(r*=1e7)/Math.pow(2,32)|0;i>0&&(r%=Math.pow(2,32),n+=i);var a=new_buf(8);return a.write_shift(4,r),a.write_shift(4,n),a}function parse_lpstr(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function parse_lpwstr(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function parse_VtStringBase(e,t,r){return 31===t?parse_lpwstr(e):parse_lpstr(e,t,r)}function parse_VtString(e,t,r){return parse_VtStringBase(e,t,!1===r?0:4)}function parse_VtUnalignedString(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return parse_VtStringBase(e,t,0)}function parse_VtVecLpwstrValue(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(chr0,""),e.l-i&2&&(e.l+=2)}return r}function parse_VtVecUnalignedLpstrValue(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(chr0,"");return r}function parse_VtHeadingPair(e){var t=e.l,r=parse_TypedPropertyValue(e,VT_USTR);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[r,parse_TypedPropertyValue(e,VT_I4)]}function parse_VtVecHeadingPairValue(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(parse_VtHeadingPair(e));return r}function parse_dictionary(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var a=e.read_shift(4),s=e.read_shift(4);n[a]=e.read_shift(s,1200===t?"utf16le":"utf8").replace(chr0,"").replace(chr1,"!"),1200===t&&s%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),n}function parse_BLOB(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),r}function parse_ClipboardData(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function parse_TypedPropertyValue(e,t,r){var n,i=e.read_shift(2),a=r||{};if(e.l+=2,t!==VT_VARIANT&&i!==t&&-1===VT_CUSTOM.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&i)))throw new Error("Expected type "+t+" saw "+i);switch(t===VT_VARIANT?i:t){case 2:return n=e.read_shift(2,"i"),a.raw||(e.l+=2),n;case 3:return e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return e.read_shift(4);case 30:case 31:e.l+=4,val=parse_VtString(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 64:return parse_FILETIME(e);case 65:return parse_BLOB(e);case 71:return parse_ClipboardData(e);case 80:return parse_VtString(e,i,!a.raw).replace(chr0,"");case 81:return parse_VtUnalignedString(e,i).replace(chr0,"");case 4108:return parse_VtVecHeadingPairValue(e);case 4126:case 4127:return 4127==i?parse_VtVecLpwstrValue(e):parse_VtVecUnalignedLpstrValue(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+i)}}function write_TypedPropertyValue(e,t){var r=new_buf(4),n=new_buf(4);switch(r.write_shift(4,80==e?31:e),e){case 3:n.write_shift(-4,t);break;case 5:(n=new_buf(8)).write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=write_FILETIME(t);break;case 31:case 80:for((n=new_buf(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return bconcat([r,n])}function parse_PropertySet(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),a=[],s=0,o=0,l=-1,c={};for(s=0;s!=i;++s){var d=e.read_shift(4),u=e.read_shift(4);a[s]=[d,u+r]}a.sort((function(e,t){return e[1]-t[1]}));var p={};for(s=0;s!=i;++s){if(e.l!==a[s][1]){var h=!0;if(s>0&&t)switch(t[a[s-1][0]].t){case 2:e.l+2===a[s][1]&&(e.l+=2,h=!1);break;case 80:case 4108:e.l<=a[s][1]&&(e.l=a[s][1],h=!1)}if((!t||0==s)&&e.l<=a[s][1]&&(h=!1,e.l=a[s][1]),h)throw new Error("Read Error: Expected address "+a[s][1]+" at "+e.l+" :"+s)}if(t){if(0==a[s][0]&&a.length>s+1&&a[s][1]==a[s+1][1])continue;var f=t[a[s][0]];if(p[f.n]=parse_TypedPropertyValue(e,f.t,{raw:!0}),"version"===f.p&&(p[f.n]=String(p[f.n]>>16)+"."+("0000"+String(65535&p[f.n])).slice(-4)),"CodePage"==f.n)switch(p[f.n]){case 0:p[f.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:set_cp(o=p[f.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[f.n])}}else if(1===a[s][0]){if(o=p.CodePage=parse_TypedPropertyValue(e,VT_I2),set_cp(o),-1!==l){var m=e.l;e.l=a[l][1],c=parse_dictionary(e,o),e.l=m}}else if(0===a[s][0]){if(0===o){l=s,e.l=a[s+1][1];continue}c=parse_dictionary(e,o)}else{var g,_=c[a[s][0]];switch(e[e.l]){case 65:e.l+=4,g=parse_BLOB(e);break;case 30:case 31:e.l+=4,g=parse_VtString(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=parsebool(e,4);break;case 64:e.l+=4,g=parseDate(parse_FILETIME(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[_]=g}}return e.l=r+n,p}var XLSPSSkip=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function guess_property_type(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function write_PropertySet(e,t,r){var n=new_buf(8),i=[],a=[],s=8,o=0,l=new_buf(8),c=new_buf(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),a.push(l),i.push(c),s+=8+l.length,!t){(c=new_buf(8)).write_shift(4,0),i.unshift(c);var d=[new_buf(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var u=e[o][0];for((l=new_buf(8+2*(u.length+1)+(u.length%2?0:2))).write_shift(4,o+2),l.write_shift(4,u.length+1),l.write_shift(0,u,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=bconcat(d),a.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if((!t||t[e[o][0]])&&!(XLSPSSkip.indexOf(e[o][0])>-1||PseudoPropsPairs.indexOf(e[o][0])>-1)&&null!=e[o][1]){var p=e[o][1],h=0;if(t){var f=r[h=+t[e[o][0]]];if("version"==f.p&&"string"==typeof p){var m=p.split(".");p=(+m[0]<<16)+(+m[1]||0)}l=write_TypedPropertyValue(f.t,p)}else{var g=guess_property_type(p);-1==g&&(g=31,p=String(p)),l=write_TypedPropertyValue(g,p)}a.push(l),(c=new_buf(8)).write_shift(4,t?h:2+o),i.push(c),s+=8+l.length}var _=8*(a.length+1);for(o=0;o<a.length;++o)i[o].write_shift(4,_),_+=a[o].length;return n.write_shift(4,s),n.write_shift(4,a.length),bconcat([n].concat(i).concat(a))}function parse_PropertySetStream(e,t,r){var n=e.content;if(!n)return{};prep_blob(n,0);var i,a,s,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),d=n.read_shift(16);if(d!==CFB.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(1!==(i=n.read_shift(4))&&2!==i)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),o=n.read_shift(4),1===i&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);2===i&&(s=n.read_shift(16),l=n.read_shift(4));var u,p=parse_PropertySet(n,t),h={SystemIdentifier:c};for(var f in p)h[f]=p[f];if(h.FMTID=a,1===i)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);try{u=parse_PropertySet(n,null)}catch(e){}for(f in u)h[f]=u[f];return h.FMTID=[a,s],h}function write_PropertySetStream(e,t,r,n,i,a){var s=new_buf(i?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,CFB.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,i?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,i?68:48);var l=write_PropertySet(e,r,n);if(o.push(l),i){var c=write_PropertySet(i,null,null);s.write_shift(16,a,"hex"),s.write_shift(4,68+l.length),o.push(c)}return bconcat(o)}function parsenoop2(e,t){return e.read_shift(t),null}function writezeroes(e,t){t||(t=new_buf(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function parslurp(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function parsebool(e,t){return 1===e.read_shift(t)}function writebool(e,t){return t||(t=new_buf(2)),t.write_shift(2,+!!e),t}function parseuint16(e){return e.read_shift(2,"u")}function writeuint16(e,t){return t||(t=new_buf(2)),t.write_shift(2,e),t}function parseuint16a(e,t){return parslurp(e,t,parseuint16)}function parse_Bes(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}function write_Bes(e,t,r){return r||(r=new_buf(2)),r.write_shift(1,"e"==t?+e:+!!e),r.write_shift(1,"e"==t?1:0),r}function parse_ShortXLUnicodeString(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont",a=current_codepage;r&&r.biff>=8&&(current_codepage=1200),r&&8!=r.biff?12==r.biff&&(i="wstr"):e.read_shift(1)&&(i="dbcs-cont"),r.biff>=2&&r.biff<=5&&(i="cpstr");var s=n?e.read_shift(n,i):"";return current_codepage=a,s}function parse_XLUnicodeRichExtendedString(e){var t=current_codepage;current_codepage=1200;var r,n=e.read_shift(2),i=e.read_shift(1),a=4&i,s=8&i,o=1+(1&i),l=0,c={};s&&(l=e.read_shift(2)),a&&(r=e.read_shift(4));var d=2==o?"dbcs-cont":"sbcs-cont",u=0===n?"":e.read_shift(n,d);return s&&(e.l+=4*l),a&&(e.l+=r),c.t=u,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),current_codepage=t,c}function write_XLUnicodeRichExtendedString(e){var t=e.t||"",r=new_buf(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=new_buf(2*t.length);return n.write_shift(2*t.length,t,"utf16le"),bconcat([r,n])}function parse_XLUnicodeStringNoCch(e,t,r){if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function parse_XLUnicodeString(e,t,r){var n=e.read_shift(r&&2==r.biff?1:2);return 0===n?(e.l++,""):parse_XLUnicodeStringNoCch(e,n,r)}function parse_XLUnicodeString2(e,t,r){if(r.biff>5)return parse_XLUnicodeString(e,t,r);var n=e.read_shift(1);return 0===n?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function write_XLUnicodeString(e,t,r){return r||(r=new_buf(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function parse_ControlInfo(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function parse_URLMoniker(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(chr0,"");return n&&(e.l+=24),i}function parse_FileMoniker(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return r+e.read_shift(i>>1,"utf16le").replace(chr0,"")}function parse_HyperlinkMoniker(e,t){var r=e.read_shift(16);switch(t-=16,r){case"e0c9ea79f9bace118c8200aa004ba90b":return parse_URLMoniker(e,t);case"0303000000000000c000000000000046":return parse_FileMoniker(e,t);default:throw new Error("Unsupported Moniker "+r)}}function parse_HyperlinkString(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(chr0,""):""}function write_HyperlinkString(e,t){t||(t=new_buf(6+2*e.length)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function parse_Hyperlink(e,t){var r=e.l+t,n=e.read_shift(4);if(2!==n)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var a,s,o,l,c,d,u="";16&i&&(a=parse_HyperlinkString(e,r-e.l)),128&i&&(s=parse_HyperlinkString(e,r-e.l)),257&~i||(o=parse_HyperlinkString(e,r-e.l)),1==(257&i)&&(l=parse_HyperlinkMoniker(e,r-e.l)),8&i&&(u=parse_HyperlinkString(e,r-e.l)),32&i&&(c=e.read_shift(16)),64&i&&(d=parse_FILETIME(e)),e.l=r;var p=s||o||l||"";p&&u&&(p+="#"+u),p||(p="#"+u),2&i&&"/"==p.charAt(0)&&"/"!=p.charAt(1)&&(p="file://"+p);var h={Target:p};return c&&(h.guid=c),d&&(h.time=d),a&&(h.Tooltip=a),h}function write_Hyperlink(e){var t=new_buf(512),r=0,n=e.Target;"file://"==n.slice(0,7)&&(n=n.slice(7));var i=n.indexOf("#"),a=i>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3}t.write_shift(4,2),t.write_shift(4,a);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(28==a)write_HyperlinkString(n=n.slice(1),t);else if(2&a){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),8&a&&write_HyperlinkString(i>-1?n.slice(i+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var l=0;"../"==n.slice(3*l,3*l+3)||"..\\"==n.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,255&n.charCodeAt(r+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function parse_LongRGBA(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function parse_LongRGB(e,t){var r=parse_LongRGBA(e,t);return r[3]=0,r}function parse_XLSCell(e,t,r){var n={r:e.read_shift(2),c:e.read_shift(2),ixfe:0};if(r&&2==r.biff||7==t){var i=e.read_shift(1);n.ixfe=63&i,e.l+=2}else n.ixfe=e.read_shift(2);return n}function write_XLSCell(e,t,r,n){return n||(n=new_buf(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function parse_frtHeader(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function parse_OptXLUnicodeString(e,t,r){return 0===t?"":parse_XLUnicodeString2(e,t,r)}function parse_XTI(e,t,r){var n=r.biff>8?4:2;return[e.read_shift(n),e.read_shift(n,"i"),e.read_shift(n,"i")]}function parse_RkRec(e){return[e.read_shift(2),parse_RkNumber(e)]}function parse_AddinUdf(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=parse_ShortXLUnicodeString(e,t,r),a=e.read_shift(2);if(a!==(n-=e.l))throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,i}function parse_Ref8U(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r}}}function write_Ref8U(e,t){return t||(t=new_buf(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function parse_RefU(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r}}}var parse_Ref=parse_RefU;function parse_FtCmo(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function parse_FtNts(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function parse_FtCf(e){return e.l+=4,e.cf=e.read_shift(2),{}}function parse_FtSkip(e){e.l+=2,e.l+=e.read_shift(2)}var FtTab={0:parse_FtSkip,4:parse_FtSkip,5:parse_FtSkip,6:parse_FtSkip,7:parse_FtCf,8:parse_FtSkip,9:parse_FtSkip,10:parse_FtSkip,11:parse_FtSkip,12:parse_FtSkip,13:parse_FtNts,14:parse_FtSkip,15:parse_FtSkip,16:parse_FtSkip,17:parse_FtSkip,18:parse_FtSkip,19:parse_FtSkip,20:parse_FtSkip,21:parse_FtCmo};function parse_FtArray(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n[i]=FtTab[i](e,r-e.l)}catch(t){return e.l=r,n}}return e.l!=r&&(e.l=r),n}function parse_BOF(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),(t-=2)>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function write_BOF(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":case"xla":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;default:throw new Error("unsupported BIFF version")}var a=new_buf(i);return a.write_shift(2,n),a.write_shift(2,t),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function parse_InterfaceHdr(e,t){return 0===t||e.read_shift(2),1200}function parse_WriteAccess(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=parse_XLUnicodeString2(e,0,r);return e.read_shift(t+n-e.l),i}function write_WriteAccess(e,t){var r=!t||8==t.biff,n=new_buf(r?112:54);for(n.write_shift(8==t.biff?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function parse_WsBool(e,t,r){var n=r&&8==r.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&n,fBelow:64&n,fRight:128&n}}function parse_BoundSheet8(e,t,r){var n="";if(4==r.biff)return 0===(n=parse_ShortXLUnicodeString(e,0,r)).length&&(n="Sheet1"),{name:n};var i=e.read_shift(4),a=3&e.read_shift(1),s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule"}return 0===(n=parse_ShortXLUnicodeString(e,0,r)).length&&(n="Sheet1"),{pos:i,hs:a,dt:s,name:n}}function write_BoundSheet8(e,t){var r=!t||t.biff>=8?2:1,n=new_buf(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function parse_SST(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),a=[],s=0;s!=i&&e.l<r;++s)a.push(parse_XLUnicodeRichExtendedString(e));return a.Count=n,a.Unique=i,a}function write_SST(e,t){var r=new_buf(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=write_XLUnicodeRichExtendedString(e[i],t);var a=bconcat([r].concat(n));return a.parts=[r.length].concat(n.map((function(e){return e.length}))),a}function parse_ExtSST(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function parse_Row(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,7&n&&(t.level=7&n),32&n&&(t.hidden=!0),64&n&&(t.hpt=r/20),t}function parse_ForceFullCalculation(e){var t=parse_frtHeader(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}function parse_RecalcId(e){return e.read_shift(2),e.read_shift(4)}function parse_DefaultRowHeight(e,t,r){var n=0;r&&2==r.biff||(n=e.read_shift(2));var i=e.read_shift(2);return r&&2==r.biff&&(n=1-(i>>15),i&=32767),[{Unsynced:1&n,DyZero:(2&n)>>1,ExAsc:(4&n)>>2,ExDsc:(8&n)>>3},i]}function parse_Window1(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}function write_Window1(){var e=new_buf(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function parse_Window2(e,t,r){return r&&r.biff>=2&&r.biff<5?{}:{RTL:64&e.read_shift(2)}}function write_Window2(e){var t=new_buf(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function parse_Pane(){}function parse_Font(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return n.name=parse_ShortXLUnicodeString(e,0,r),n}function write_Font(e,t){var r=e.name||"Arial",n=t&&5==t.biff,i=new_buf(n?15+r.length:16+2*r.length);return i.write_shift(2,20*(e.sz||12)),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function parse_LabelSst(e,t,r){var n=parse_XLSCell(e,t,r);return n.isst=e.read_shift(4),n}function write_LabelSst(e,t,r,n){var i=new_buf(10);return write_XLSCell(e,t,n,i),i.write_shift(4,r),i}function parse_Label(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5);var n=e.l+t,i=parse_XLSCell(e,t,r),a=parse_XLUnicodeString(e,n-e.l,r);return i.val=a,i}function write_Label(e,t,r,n,i){var a=!i||8==i.biff,s=new_buf(+a+8+(1+a)*r.length);return write_XLSCell(e,t,n,s),s.write_shift(2,r.length),a&&s.write_shift(1,1),s.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),s}function parse_Format(e,t,r){return[e.read_shift(2),parse_XLUnicodeString2(e,0,r)]}function write_Format(e,t,r,n){var i=r&&5==r.biff;n||(n=new_buf(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return null==a.l&&(a.l=a.length),a}var parse_BIFF2Format=parse_XLUnicodeString2;function write_BIFF2Format(e){var t=new_buf(1+e.length);return t.write_shift(1,e.length),t.write_shift(e.length,e,"sbcs"),t}function write_BIFF4Format(e){var t=new_buf(3+e.length);return t.l+=2,t.write_shift(1,e.length),t.write_shift(e.length,e,"sbcs"),t}function parse_Dimensions(e,t,r){var n=e.l+t,i=8!=r.biff&&r.biff?2:4,a=e.read_shift(i),s=e.read_shift(i),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:s,c:l}}}function write_Dimensions(e,t){var r=8!=t.biff&&t.biff?2:4,n=new_buf(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function parse_RK(e){var t=e.read_shift(2),r=e.read_shift(2),n=parse_RkRec(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function parse_MulRk(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(parse_RkRec(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(a.length!=s-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:s,rkrec:a}}function parse_MulBlank(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(a.length!=s-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:s,ixfe:a}}function parse_CellStyleXF(e,t,r,n){var i={},a=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return i.patternType=XLSFillPattern[o>>26],n.cellStyles?(i.alc=7&a,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=15&s,i.dgRight=s>>4&15,i.dgTop=s>>8&15,i.dgBottom=s>>12&15,i.icvLeft=s>>16&127,i.icvRight=s>>23&127,i.grbitDiag=s>>30&3,i.icvTop=127&o,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=127&l,i.icvBack=l>>7&127,i.fsxButton=l>>14&1,i):i}function parse_XF(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=parse_CellStyleXF(e,t,n.fStyle,r),n}function write_XF(e,t,r,n){var i=r&&5==r.biff;n||(n=new_buf(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&i&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function parse_BIFF2XF(e){var t={};return t.ifnt=e.read_shift(1),e.l++,t.flags=e.read_shift(1),t.numFmtId=63&t.flags,t.flags>>=6,t.fStyle=0,t.data={},t}function write_BIFF2XF(e){var t=new_buf(4);return t.l+=2,t.write_shift(1,e.numFmtId),t.l++,t}function write_BIFF3XF(e){var t=new_buf(12);return t.l++,t.write_shift(1,e.numFmtId),t.l+=10,t}var write_BIFF4XF=write_BIFF3XF;function parse_BIFF3XF(e){var t={};return t.ifnt=e.read_shift(1),t.numFmtId=e.read_shift(1),t.flags=e.read_shift(2),t.fStyle=t.flags>>2&1,t.data={},t}function parse_BIFF4XF(e){var t={};return t.ifnt=e.read_shift(1),t.numFmtId=e.read_shift(1),t.flags=e.read_shift(2),t.fStyle=t.flags>>2&1,t.data={},t}function parse_Guts(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function write_Guts(e){var t=new_buf(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}function parse_BoolErr(e,t,r){var n=parse_XLSCell(e,6,r),i=parse_Bes(e,2);return n.val=i,n.t=!0===i||!1===i?"b":"e",n}function write_BoolErr(e,t,r,n,i,a){var s=new_buf(8);return write_XLSCell(e,t,n,s),write_Bes(r,a,s),s}function parse_Number(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5);var n=parse_XLSCell(e,6,r),i=parse_Xnum(e,8);return n.val=i,n}function write_Number(e,t,r,n){var i=new_buf(14);return write_XLSCell(e,t,n,i),write_Xnum(r,i),i}var parse_XLHeaderFooter=parse_OptXLUnicodeString;function parse_SupBook(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,1025==a||14849==a)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var s=parse_XLUnicodeStringNoCch(e,a),o=[];n>e.l;)o.push(parse_XLUnicodeString(e));return[a,i,s,o]}function parse_ExternName(e,t,r){var n,i=e.read_shift(2),a={fBuiltIn:1&i,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return 14849===r.sbcch&&(n=parse_AddinUdf(e,t-2,r)),a.body=n||e.read_shift(t-2),"string"==typeof n&&(a.Name=n),a}function parse_Lbl(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&2==r.biff?1:2),l=0;(!r||r.biff>=5)&&(5!=r.biff&&(e.l+=2),l=e.read_shift(2),5==r.biff&&(e.l+=2),e.l+=4);var c=parse_XLUnicodeStringNoCch(e,s,r);32&i&&(c=XLSLblBuiltIn[c.charCodeAt(0)]);var d=n-e.l;return r&&2==r.biff&&--d,{chKey:a,Name:c,itab:l,rgce:n!=e.l&&0!==o&&d>0?parse_NameParsedFormula(e,d,r,o):[]}}function parse_ExternSheet(e,t,r){if(r.biff<8)return parse_BIFF5ExternSheet(e,t,r);if(!(r.biff>8)&&t==e[e.l]+(3==e[e.l+1]?1:0)+1)return parse_BIFF5ExternSheet(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);0!=a--;)n.push(parse_XTI(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function parse_BIFF5ExternSheet(e,t,r){3==e[e.l+1]&&e[e.l]++;var n=parse_ShortXLUnicodeString(e,t,r);return 3==n.charCodeAt(0)?n.slice(1):n}function parse_NameCmt(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2);return[parse_XLUnicodeStringNoCch(e,n,r),parse_XLUnicodeStringNoCch(e,i,r)]}e.l+=t}function parse_ShrFmla(e,t,r){var n=parse_RefU(e,6);e.l++;var i=e.read_shift(1);return[parse_SharedParsedFormula(e,t-=8,r),i,n]}function parse_Array(e,t,r){var n=parse_Ref(e,6);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,parse_ArrayParsedFormula(e,t,r,n)]}function parse_MTRSettings(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]}function parse_NoteSh(e,t,r){var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return[{r:n,c:i},parse_XLUnicodeString2(e,0,r),s,a]}function parse_Note(e,t,r){if(r&&r.biff<8){var n=e.read_shift(2),i=e.read_shift(2);if(65535==n||-1==n)return;var a=e.read_shift(2);return[{r:n,c:i},e.read_shift(Math.min(a,2048),"cpstr")]}return parse_NoteSh(e,t,r)}function write_NOTE_BIFF2(e,t,r,n){var i=new_buf(6+(n||e.length));return i.write_shift(2,t),i.write_shift(2,r),i.write_shift(2,n||e.length),i.write_shift(e.length,e,"sbcs"),i}function parse_MergeCells(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(parse_Ref8U(e,t));return r}function write_MergeCells(e){var t=new_buf(2+8*e.length);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)write_Ref8U(e[r],t);return t}function parse_Obj(e,t,r){if(r&&r.biff<8)return parse_BIFF5Obj(e,t,r);var n=parse_FtCmo(e,22);return{cmo:n,ft:parse_FtArray(e,t-22,n[1])}}var parse_BIFF5OT={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function parse_BIFF5Obj(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((parse_BIFF5OT[n]||parsenoop)(e,t,r)),{cmo:[i,n,a],ft:s}}function parse_TxO(e,t,r){var n=e.l,i="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(a)?e.l+=6:parse_ControlInfo(e,6,r);var s=e.read_shift(2);e.read_shift(2),parseuint16(e,2);var o=e.read_shift(2);e.l+=o;for(var l=1;l<e.lens.length-1;++l){if(e.l-n!=e.lens[l])throw new Error("TxO: bad continue record");var c=e[e.l];if((i+=parse_XLUnicodeStringNoCch(e,e.lens[l+1]-e.lens[l]-1)).length>=(c?s:2*s))break}if(i.length!==s&&i.length!==2*s)throw new Error("cchText: "+s+" != "+i.length);return e.l=n+t,{t:i}}catch(r){return e.l=n+t,{t:i}}}function parse_HLink(e,t){var r=parse_Ref8U(e,8);return e.l+=16,[r,parse_Hyperlink(e,t-24)]}function write_HLink(e){var t=new_buf(24),r=decode_cell(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return bconcat([t,write_Hyperlink(e[1])])}function parse_HLinkTooltip(e,t){e.read_shift(2);var r=parse_Ref8U(e,8),n=e.read_shift((t-10)/2,"dbcs-cont");return[r,n=n.replace(chr0,"")]}function write_HLinkTooltip(e){var t=e[1].Tooltip,r=new_buf(10+2*(t.length+1));r.write_shift(2,2048);var n=decode_cell(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function parse_Country(e){var t,r=[0,0];return t=e.read_shift(2),r[0]=CountryEnum[t]||t,t=e.read_shift(2),r[1]=CountryEnum[t]||t,r}function write_Country(e){return e||(e=new_buf(4)),e.write_shift(2,1),e.write_shift(2,1),e}function parse_ClrtClient(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(parse_LongRGB(e,8));return r}function parse_Palette(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(parse_LongRGB(e,8));return r}function parse_XFCRC(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function parse_ColInfo(e,t,r){if(!r.cellStyles)return parsenoop(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);2==n&&(e.l+=2);var c={s:i,e:a,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function write_ColInfo(e,t){var r=new_buf(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,256*e.width),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function parse_Setup(e,t){var r={};return t<32||(e.l+=16,r.header=parse_Xnum(e,8),r.footer=parse_Xnum(e,8),e.l+=2),r}function parse_ShtProps(e,t,r){var n={area:!1};if(5!=r.biff)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,16&i&&(n.area=!0),n}function write_RRTabId(e){for(var t=new_buf(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var parse_Blank=parse_XLSCell,parse_Scl=parseuint16a,parse_String=parse_XLUnicodeString;function parse_ImData(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function write_BIFF2Cell(e,t,r,n,i){return e||(e=new_buf(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(1,n||0),e.write_shift(1,i||0),e.write_shift(1,0),e}function parse_BIFF2STR(e,t,r){r.biffguess&&5==r.biff&&(r.biff=2);var n=parse_XLSCell(e,7,r),i=parse_XLUnicodeString2(e,t-7,r);return n.t="str",n.val=i,n}function parse_BIFF2NUM(e,t,r){var n=parse_XLSCell(e,7,r),i=parse_Xnum(e,8);return n.t="n",n.val=i,n}function write_BIFF2NUM(e,t,r,n,i){var a=new_buf(15);return write_BIFF2Cell(a,e,t,n||0,i||0),a.write_shift(8,r,"f"),a}function parse_BIFF2INT(e,t,r){var n=parse_XLSCell(e,7,r),i=e.read_shift(2);return n.t="n",n.val=i,n}function write_BIFF2INT(e,t,r,n,i){var a=new_buf(9);return write_BIFF2Cell(a,e,t,n||0,i||0),a.write_shift(2,r),a}function parse_BIFF2STRING(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}function parse_BIFF2BOOLERR(e,t,r){var n=e.l+7,i=parse_XLSCell(e,6,r);e.l=n;var a=parse_Bes(e,2);return i.val=a,i.t=!0===a||!1===a?"b":"e",i}function parse_BIFF2FONTXTRA(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function parse_RString(e,t,r){var n=e.l+t,i=parse_XLSCell(e,6,r),a=e.read_shift(2),s=parse_XLUnicodeStringNoCch(e,a,r);return e.l=n,i.t="str",i.val=s,i}function parse_BIFF4SheetInfo(e){var t=e.read_shift(4),r=e.read_shift(1),n=e.read_shift(r,"sbcs");return 0===n.length&&(n="Sheet1"),{flags:t,name:n}}var DBF_SUPPORTED_VERSIONS=[2,3,48,49,131,139,140,245],DBF=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=evert({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,r){var n=r||{};n.dateNF||(n.dateNF="yyyymmdd");var i=aoa_to_sheet(function(t,r){var n=[],i=new_raw_buf(1);switch(r.type){case"base64":i=s2a(Base64_decode(t));break;case"binary":i=s2a(t);break;case"buffer":case"array":i=t}prep_blob(i,0);var a=i.read_shift(1),s=!!(136&a),o=!1,l=!1;switch(a){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,s=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+a.toString(16))}var c=0,d=521;2==a&&(c=i.read_shift(2)),i.l+=3,2!=a&&(c=i.read_shift(4)),c>1048576&&(c=1e6),2!=a&&(d=i.read_shift(2));var u=i.read_shift(2),p=r.codepage||1252;2!=a&&(i.l+=16,i.read_shift(1),0!==i[i.l]&&(p=e[i[i.l]]),i.l+=1,i.l+=2),l&&(i.l+=36);for(var h=[],f={},m=Math.min(i.length,2==a?521:d-10-(o?264:0)),g=l?32:11;i.l<m&&13!=i[i.l];)switch((f={}).name=(void 0!==$cptable?$cptable.utils.decode(p,i.slice(i.l,i.l+g)):a2s(i.slice(i.l,i.l+g))).replace(/[\u0000\r\n][\S\s]*$/g,""),i.l+=g,f.type=String.fromCharCode(i.read_shift(1)),2==a||l||(f.offset=i.read_shift(4)),f.len=i.read_shift(1),2==a&&(f.offset=i.read_shift(2)),f.dec=i.read_shift(1),f.name.length&&h.push(f),2!=a&&(i.l+=l?13:14),f.type){case"B":o&&8==f.len||!r.WTF||console.log("Skipping "+f.name+":"+f.type);break;case"G":case"P":r.WTF&&console.log("Skipping "+f.name+":"+f.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+f.type)}if(13!==i[i.l]&&(i.l=d-1),13!==i.read_shift(1))throw new Error("DBF Terminator not found "+i.l+" "+i[i.l]);i.l=d;var _=0,b=0;for(n[0]=[],b=0;b!=h.length;++b)n[0][b]=h[b].name;for(;c-- >0;)if(42!==i[i.l])for(++i.l,n[++_]=[],b=0,b=0;b!=h.length;++b){var v=i.slice(i.l,i.l+h[b].len);i.l+=h[b].len,prep_blob(v,0);var y=void 0!==$cptable?$cptable.utils.decode(p,v):a2s(v);switch(h[b].type){case"C":y.trim().length&&(n[_][b]=y.replace(/([^\s])\s+$/,"$1"));break;case"D":8===y.length?(n[_][b]=new Date(Date.UTC(+y.slice(0,4),+y.slice(4,6)-1,+y.slice(6,8),0,0,0,0)),r&&r.UTC||(n[_][b]=utc_to_local(n[_][b]))):n[_][b]=y;break;case"F":n[_][b]=parseFloat(y.trim());break;case"+":case"I":n[_][b]=l?2147483648^v.read_shift(-4,"i"):v.read_shift(4,"i");break;case"L":switch(y.trim().toUpperCase()){case"Y":case"T":n[_][b]=!0;break;case"N":case"F":n[_][b]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+y+"|")}break;case"M":if(!s)throw new Error("DBF Unexpected MEMO for type "+a.toString(16));n[_][b]="##MEMO##"+(l?parseInt(y.trim(),10):v.read_shift(4));break;case"N":(y=y.replace(/\u0000/g,"").trim())&&"."!=y&&(n[_][b]=+y||0);break;case"@":n[_][b]=new Date(v.read_shift(-8,"f")-621356832e5);break;case"T":var w=v.read_shift(4),E=v.read_shift(4);if(0==w&&0==E)break;n[_][b]=new Date(864e5*(w-2440588)+E),r&&r.UTC||(n[_][b]=utc_to_local(n[_][b]));break;case"Y":n[_][b]=v.read_shift(4,"i")/1e4+v.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":n[_][b]=-v.read_shift(-8,"f");break;case"B":if(o&&8==h[b].len){n[_][b]=v.read_shift(8,"f");break}case"G":case"P":v.l+=h[b].len;break;case"0":if("_NullFlags"===h[b].name)break;default:throw new Error("DBF Unsupported data type "+h[b].type)}}else i.l+=u;if(2!=a&&i.l<i.length&&26!=i[i.l++])throw new Error("DBF EOF Marker missing "+(i.l-1)+" of "+i.length+" "+i[i.l-1].toString(16));return r&&r.sheetRows&&(n=n.slice(0,r.sheetRows)),r.DBF=h,n}(t,n),n);return i["!cols"]=n.DBF.map((function(e){return{wch:e.len,DBF:e}})),delete n.DBF,i}var n={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{var n=sheet_to_workbook(r(e,t),t);return n.bookType="dbf",n}catch(e){if(t&&t.WTF)throw e}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function(r,i){if(!r["!ref"])throw new Error("Cannot export empty sheet to DBF");var a=i||{},s=current_codepage;if(+a.codepage>=0&&set_cp(+a.codepage),"string"==a.type)throw new Error("Cannot write DBF to JS string");var o=buf_array(),l=sheet_to_json(r,{header:1,raw:!0,cellDates:!0}),c=l[0],d=l.slice(1),u=r["!cols"]||[],p=0,h=0,f=0,m=1;for(p=0;p<c.length;++p)if(((u[p]||{}).DBF||{}).name)c[p]=u[p].DBF.name,++f;else if(null!=c[p]){if(++f,"number"==typeof c[p]&&(c[p]=c[p].toString(10)),"string"!=typeof c[p])throw new Error("DBF Invalid column name "+c[p]+" |"+typeof c[p]+"|");if(c.indexOf(c[p])!==p)for(h=0;h<1024;++h)if(-1==c.indexOf(c[p]+"_"+h)){c[p]+="_"+h;break}}var g=safe_decode_range(r["!ref"]),_=[],b=[],v=[];for(p=0;p<=g.e.c-g.s.c;++p){var y="",w="",E=0,S=[];for(h=0;h<d.length;++h)null!=d[h][p]&&S.push(d[h][p]);if(0!=S.length&&null!=c[p]){for(h=0;h<S.length;++h){switch(typeof S[h]){case"number":w="B";break;case"string":default:w="C";break;case"boolean":w="L";break;case"object":w=S[h]instanceof Date?"D":"C"}E=Math.max(E,(void 0!==$cptable&&"string"==typeof S[h]?$cptable.utils.encode(current_ansi,S[h]):String(S[h])).length),y=y&&y!=w?"C":w}E>250&&(E=250),"C"==(w=((u[p]||{}).DBF||{}).type)&&u[p].DBF.len>E&&(E=u[p].DBF.len),"B"==y&&"N"==w&&(y="N",v[p]=u[p].DBF.dec,E=u[p].DBF.len),b[p]="C"==y||"N"==w?E:n[y]||0,m+=b[p],_[p]=y}else _[p]="?"}var T=o.next(32);for(T.write_shift(4,318902576),T.write_shift(4,d.length),T.write_shift(2,296+32*f),T.write_shift(2,m),p=0;p<4;++p)T.write_shift(4,0);var C=+t[current_codepage]||3;for(T.write_shift(4,C<<8),e[C]!=+a.codepage&&(a.codepage&&console.error("DBF Unsupported codepage "+current_codepage+", using 1252"),current_codepage=1252),p=0,h=0;p<c.length;++p)if(null!=c[p]){var x=o.next(32),A=(c[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);x.write_shift(1,A,"sbcs"),x.write_shift(1,"?"==_[p]?"C":_[p],"sbcs"),x.write_shift(4,h),x.write_shift(1,b[p]||n[_[p]]||0),x.write_shift(1,v[p]||0),x.write_shift(1,2),x.write_shift(4,0),x.write_shift(1,0),x.write_shift(4,0),x.write_shift(4,0),h+=b[p]||n[_[p]]||0}var I=o.next(264);for(I.write_shift(4,13),p=0;p<65;++p)I.write_shift(4,0);for(p=0;p<d.length;++p){var D=o.next(m);for(D.write_shift(1,0),h=0;h<c.length;++h)if(null!=c[h])switch(_[h]){case"L":D.write_shift(1,null==d[p][h]?63:d[p][h]?84:70);break;case"B":D.write_shift(8,d[p][h]||0,"f");break;case"N":var k="0";for("number"==typeof d[p][h]&&(k=d[p][h].toFixed(v[h]||0)),k.length>b[h]&&(k=k.slice(0,b[h])),f=0;f<b[h]-k.length;++f)D.write_shift(1,32);D.write_shift(1,k,"sbcs");break;case"D":d[p][h]?(D.write_shift(4,("0000"+d[p][h].getFullYear()).slice(-4),"sbcs"),D.write_shift(2,("00"+(d[p][h].getMonth()+1)).slice(-2),"sbcs"),D.write_shift(2,("00"+d[p][h].getDate()).slice(-2),"sbcs")):D.write_shift(8,"00000000","sbcs");break;case"C":var L=D.l,P=String(null!=d[p][h]?d[p][h]:"").slice(0,b[h]);for(D.write_shift(1,P,"cpstr"),L+=b[h]-D.l,f=0;f<L;++f)D.write_shift(1,32)}}return current_codepage=s,o.next(1).write_shift(1,26),o.end()}}}(),SYLK=function(){var e={AA:"Ã€",BA:"Ã",CA:"Ã‚",DA:195,HA:"Ã„",JA:197,AE:"Ãˆ",BE:"Ã‰",CE:"ÃŠ",HE:"Ã‹",AI:"ÃŒ",BI:"Ã",CI:"ÃŽ",HI:"Ã",AO:"Ã’",BO:"Ã“",CO:"Ã”",DO:213,HO:"Ã–",AU:"Ã™",BU:"Ãš",CU:"Ã›",HU:"Ãœ",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã‡",Kc:"Ã§",q:"Ã¦",z:"Å“",a:"Ã†",j:"Å’",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("N("+keys(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{t=new RegExp("N("+keys(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch(e){}var r=function(t,r){var n=e[r];return"number"==typeof n?_getansi(n):n},n=function(e,t,r){var n=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==n?e:_getansi(n)};function i(e,i){var a,s=e.split(/[\n\r]+/),o=-1,l=-1,c=0,d=0,u=[],p=[],h=null,f={},m=[],g=[],_=[],b=0,v={Workbook:{WBProps:{},Names:[]}};for(+i.codepage>=0&&set_cp(+i.codepage);c!==s.length;++c){b=0;var y,w=s[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),E=w.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),S=E[0];if(w.length>0)switch(S){case"ID":case"E":case"B":case"W":break;case"O":for(d=1;d<E.length;++d)if("V"===E[d].charAt(0)){var T=parseInt(E[d].slice(1),10);T>=1&&T<=4&&(v.Workbook.WBProps.date1904=!0)}break;case"P":"P"===E[1].charAt(0)&&p.push(w.slice(3).replace(/;;/g,";"));break;case"NN":var C={Sheet:0};for(d=1;d<E.length;++d)switch(E[d].charAt(0)){case"N":C.Name=E[d].slice(1);break;case"E":C.Ref=(i&&i.sheet||"Sheet1")+"!"+rc_to_a1(E[d].slice(1))}v.Workbook.Names.push(C);break;case"C":var x=!1,A=!1,I=!1,D=!1,k=-1,L=-1,P="",O="z",R="";for(d=1;d<E.length;++d)switch(E[d].charAt(0)){case"A":R=E[d].slice(1);break;case"X":l=parseInt(E[d].slice(1),10)-1,A=!0;break;case"Y":for(o=parseInt(E[d].slice(1),10)-1,A||(l=0),a=u.length;a<=o;++a)u[a]=[];break;case"K":'"'===(y=E[d].slice(1)).charAt(0)?(y=y.slice(1,y.length-1),O="s"):"TRUE"===y||"FALSE"===y?(y="TRUE"===y,O="b"):"#"==y.charAt(0)&&null!=RBErr[y]?(O="e",y=RBErr[y]):isNaN(fuzzynum(y))||(y=fuzzynum(y),O="n",null!==h&&fmt_is_date(h)&&i.cellDates&&(O="number"==typeof(y=numdate(v.Workbook.WBProps.date1904?y+1462:y))?"n":"d")),void 0!==$cptable&&"string"==typeof y&&"string"!=(i||{}).type&&(i||{}).codepage&&(y=$cptable.utils.decode(i.codepage,y)),x=!0;break;case"E":D=!0,P=rc_to_a1(E[d].slice(1),{r:o,c:l});break;case"S":I=!0;break;case"G":break;case"R":k=parseInt(E[d].slice(1),10)-1;break;case"C":L=parseInt(E[d].slice(1),10)-1;break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+w)}if(x&&(u[o][l]?(u[o][l].t=O,u[o][l].v=y):u[o][l]={t:O,v:y},h&&(u[o][l].z=h),!1!==i.cellText&&h&&(u[o][l].w=SSF_format(u[o][l].z,u[o][l].v,{date1904:v.Workbook.WBProps.date1904})),h=null),I){if(D)throw new Error("SYLK shared formula cannot have own formula");var N=k>-1&&u[k][L];if(!N||!N[1])throw new Error("SYLK shared formula cannot find base");P=shift_formula_str(N[1],{r:o-k,c:l-L})}P&&(u[o][l]?u[o][l].f=P:u[o][l]={t:"n",f:P}),R&&(u[o][l]||(u[o][l]={t:"z"}),u[o][l].c=[{a:"SheetJSYLK",t:R}]);break;case"F":var B=0;for(d=1;d<E.length;++d)switch(E[d].charAt(0)){case"X":l=parseInt(E[d].slice(1),10)-1,++B;break;case"Y":for(o=parseInt(E[d].slice(1),10)-1,a=u.length;a<=o;++a)u[a]=[];break;case"M":b=parseInt(E[d].slice(1),10)/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":h=p[parseInt(E[d].slice(1),10)];break;case"W":for(_=E[d].slice(1).split(" "),a=parseInt(_[0],10);a<=parseInt(_[1],10);++a)b=parseInt(_[2],10),g[a-1]=0===b?{hidden:!0}:{wch:b};break;case"C":g[l=parseInt(E[d].slice(1),10)-1]||(g[l]={});break;case"R":m[o=parseInt(E[d].slice(1),10)-1]||(m[o]={}),b>0?(m[o].hpt=b,m[o].hpx=pt2px(b)):0===b&&(m[o].hidden=!0);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+w)}B<1&&(h=null);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+w)}}return m.length>0&&(f["!rows"]=m),g.length>0&&(f["!cols"]=g),g.forEach((function(e){process_col(e)})),i&&i.sheetRows&&(u=u.slice(0,i.sheetRows)),[u,f,v]}function a(e,t,r,n,i,a){var s="C;Y"+(r+1)+";X"+(n+1)+";K";switch(e.t){case"n":s+=isFinite(e.v)?e.v||0:BErr[isNaN(e.v)?36:7],e.f&&!e.F&&(s+=";E"+a1_to_rc(e.f,{r,c:n}));break;case"b":s+=e.v?"TRUE":"FALSE";break;case"e":s+=e.w||BErr[e.v]||e.v;break;case"d":s+=datenum(parseDate(e.v,a),a);break;case"s":s+='"'+(null==e.v?"":String(e.v)).replace(/"/g,"").replace(/;/g,";;")+'"'}return s}function s(e,t,r){var n,i="C;Y"+(t+1)+";X"+(r+1)+";A";return i+=(n=e.map((function(e){return e.t})).join(""),n.replace(/\n/g," :").replace(/\r/g," =")),i}return e["|"]=254,{to_workbook:function(e,t){var r=function(e,t){switch(t.type){case"base64":return i(Base64_decode(e),t);case"binary":return i(e,t);case"buffer":return i(has_buf&&Buffer.isBuffer(e)?e.toString("binary"):a2s(e),t);case"array":return i(cc2str(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),n=r[0],a=r[1],s=r[2],o=dup(t);o.date1904=(((s||{}).Workbook||{}).WBProps||{}).date1904;var l=aoa_to_sheet(n,o);keys(a).forEach((function(e){l[e]=a[e]}));var c=sheet_to_workbook(l,t);return keys(s).forEach((function(e){c[e]=s[e]})),c.bookType="sylk",c},from_sheet:function(e,t,r){t||(t={}),t._formats=["General"];var n,i=["ID;PSheetJS;N;E"],o=[],l=safe_decode_range(e["!ref"]||"A1"),c=null!=e["!data"],d="\r\n",u=(((r||{}).Workbook||{}).WBProps||{}).date1904;i.push("P;PGeneral");var p,h=l.s.r,f=l.s.c,m=[];if(e["!ref"])for(h=l.s.r;h<=l.e.r;++h)if(!c||e["!data"][h]){for(m=[],f=l.s.c;f<=l.e.c;++f)(n=c?e["!data"][h][f]:e[encode_col(f)+encode_row(h)])&&n.c&&m.push(s(n.c,h,f));m.length&&o.push(m.join(d))}if(e["!ref"])for(h=l.s.r;h<=l.e.r;++h)if(!c||e["!data"][h]){for(m=[],f=l.s.c;f<=l.e.c;++f)if((n=c?e["!data"][h][f]:e[encode_col(f)+encode_row(h)])&&(null!=n.v||n.f&&!n.F)){if("General"!=(n.z||("d"==n.t?table_fmt[14]:"General"))){var g=t._formats.indexOf(n.z);-1==g&&(t._formats.push(n.z),g=t._formats.length-1,i.push("P;P"+n.z.replace(/;/g,";;"))),m.push("F;P"+g+";Y"+(h+1)+";X"+(f+1))}m.push(a(n,0,h,f,0,u))}o.push(m.join(d))}return i.push("F;P0;DG0G8;M255"),e["!cols"]&&(p=i,e["!cols"].forEach((function(e,t){var r="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?r+="0":("number"!=typeof e.width||e.wpx||(e.wpx=width2px(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=px2char(e.wpx)),"number"==typeof e.wch&&(r+=Math.round(e.wch)))," "!=r.charAt(r.length-1)&&p.push(r)}))),e["!rows"]&&function(e,t){t.forEach((function(t,r){var n="F;";t.hidden?n+="M0;":t.hpt?n+="M"+20*t.hpt+";":t.hpx&&(n+="M"+20*px2pt(t.hpx)+";"),n.length>2&&e.push(n+"R"+(r+1))}))}(i,e["!rows"]),e["!ref"]&&i.push("B;Y"+(l.e.r-l.s.r+1)+";X"+(l.e.c-l.s.c+1)+";D"+[l.s.c,l.s.r,l.e.c,l.e.r].join(" ")),i.push("O;L;D;B"+(u?";V4":"")+";K47;G100 0.001"),delete t._formats,i.join(d)+d+o.join(d)+d+"E"+d}}}(),DIF=function(){function e(e,t){for(var r=e.split("\n"),n=-1,i=-1,a=0,s=[];a!==r.length;++a)if("BOT"!==r[a].trim()){if(!(n<0)){for(var o=r[a].trim().split(","),l=o[0],c=o[1],d=r[++a]||"";1&(d.match(/["]/g)||[]).length&&a<r.length-1;)d+="\n"+r[++a];switch(d=d.trim(),+l){case-1:if("BOT"===d){s[++n]=[],i=0;continue}if("EOD"!==d)throw new Error("Unrecognized DIF special command "+d);break;case 0:"TRUE"===d?s[n][i]=!0:"FALSE"===d?s[n][i]=!1:isNaN(fuzzynum(c))?isNaN(fuzzydate(c).getDate())?s[n][i]=c:(s[n][i]=parseDate(c),t&&t.UTC||(s[n][i]=utc_to_local(s[n][i]))):s[n][i]=fuzzynum(c),++i;break;case 1:d=(d=d.slice(1,d.length-1)).replace(/""/g,'"'),DIF_XL&&d&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),s[n][i++]=""!==d?d:null}if("EOD"===d)break}}else s[++n]=[],i=0;return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}function t(t,r){return aoa_to_sheet(function(t,r){switch(r.type){case"base64":return e(Base64_decode(t),r);case"binary":return e(t,r);case"buffer":return e(has_buf&&Buffer.isBuffer(t)?t.toString("binary"):a2s(t),r);case"array":return e(cc2str(t),r)}throw new Error("Unrecognized type "+r.type)}(t,r),r)}function r(e,t){return"0,"+String(e)+"\r\n"+t}function n(e){return'1,0\r\n"'+e.replace(/"/g,'""')+'"'}return{to_workbook:function(e,r){var n=sheet_to_workbook(t(e,r),r);return n.bookType="dif",n},to_sheet:t,from_sheet:function(e){var t=DIF_XL;if(!e["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var i=safe_decode_range(e["!ref"]),a=null!=e["!data"],s=['TABLE\r\n0,1\r\n"sheetjs"\r\n',"VECTORS\r\n0,"+(i.e.r-i.s.r+1)+'\r\n""\r\n',"TUPLES\r\n0,"+(i.e.c-i.s.c+1)+'\r\n""\r\n','DATA\r\n0,0\r\n""\r\n'],o=i.s.r;o<=i.e.r;++o){for(var l=a?e["!data"][o]:[],c="-1,0\r\nBOT\r\n",d=i.s.c;d<=i.e.c;++d){var u=a?l&&l[d]:e[encode_cell({r:o,c:d})];if(null!=u){switch(u.t){case"n":t?null!=u.w?c+="0,"+u.w+"\r\nV":null!=u.v?c+=r(u.v,"V"):null==u.f||u.F?c+='1,0\r\n""':c+=n("="+u.f):null==u.v?c+='1,0\r\n""':c+=r(u.v,"V");break;case"b":c+=u.v?r(1,"TRUE"):r(0,"FALSE");break;case"s":c+=n(!t||isNaN(+u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=SSF_format(u.z||table_fmt[14],datenum(parseDate(u.v)))),c+=t?r(u.w,"V"):n(u.w);break;default:c+='1,0\r\n""'}c+="\r\n"}else c+='1,0\r\n""\r\n'}s.push(c)}return s.join("")+"-1,0\r\nEOD"}}}(),ETH=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(t,r){return aoa_to_sheet(function(t,r){for(var n=t.split("\n"),i=-1,a=-1,s=0,o=[];s!==n.length;++s){var l=n[s].trim().split(":");if("cell"===l[0]){var c=decode_cell(l[1]);if(o.length<=c.r)for(i=o.length;i<=c.r;++i)o[i]||(o[i]=[]);switch(i=c.r,a=c.c,l[2]){case"t":o[i][a]=e(l[3]);break;case"v":o[i][a]=+l[3];break;case"vtf":var d=l[l.length-1];case"vtc":"nl"===l[3]?o[i][a]=!!+l[4]:o[i][a]="#"==l[l.length-1].charAt(0)?{t:"e",v:RBErr[l[l.length-1]]}:+l[4],"vtf"==l[2]&&(o[i][a]=[o[i][a],d])}}}return r&&r.sheetRows&&(o=o.slice(0,r.sheetRows)),o}(t,r),r)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),s="--SocialCalcSpreadsheetControlSave--";function o(e){if(!e||!e["!ref"])return"";for(var r,n=[],i=[],a="",s=decode_range(e["!ref"]),o=null!=e["!data"],l=s.s.r;l<=s.e.r;++l)for(var c=s.s.c;c<=s.e.c;++c)if(a=encode_cell({r:l,c}),(r=o?(e["!data"][l]||[])[c]:e[a])&&null!=r.v&&"z"!==r.t){switch(i=["cell",a,"t"],r.t){case"s":i.push(t(r.v));break;case"b":i[2]="vt"+(r.f?"f":"c"),i[3]="nl",i[4]=r.v?"1":"0",i[5]=t(r.f||(r.v?"TRUE":"FALSE"));break;case"d":var d=datenum(parseDate(r.v));i[2]="vtc",i[3]="nd",i[4]=""+d,i[5]=r.w||SSF_format(r.z||table_fmt[14],d);break;case"n":isFinite(r.v)?r.f?(i[2]="vtf",i[3]="n",i[4]=r.v,i[5]=t(r.f)):(i[2]="v",i[3]=r.v):(i[2]="vt"+(r.f?"f":"c"),i[3]="e"+BErr[isNaN(r.v)?36:7],i[4]="0",i[5]=r.f||i[3].slice(1),i[6]="e",i[7]=i[3].slice(1));break;case"e":continue}n.push(i.join(":"))}return n.push("sheet:c:"+(s.e.c-s.s.c+1)+":r:"+(s.e.r-s.s.r+1)+":tvf:1"),n.push("valueformat:1:text-wiki"),n.join("\n")}return{to_workbook:function(e,t){return sheet_to_workbook(r(e,t),t)},to_sheet:r,from_sheet:function(e){return[n,i,a,i,o(e),s].join("\n")}}}(),PRN=function(){function e(e,t,r,n,i){i.raw?t[r][n]=e:""===e||("TRUE"===e?t[r][n]=!0:"FALSE"===e?t[r][n]=!1:isNaN(fuzzynum(e))?isNaN(fuzzydate(e).getDate())?35==e.charCodeAt(0)&&null!=RBErr[e]?t[r][n]={t:"e",v:RBErr[e],w:e}:t[r][n]=e:t[r][n]=parseDate(e):t[r][n]=fuzzynum(e))}var t={44:",",9:"\t",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function n(e){for(var n={},i=!1,a=0,s=0;a<e.length;++a)34==(s=e.charCodeAt(a))?i=!i:!i&&s in t&&(n[s]=(n[s]||0)+1);for(a in s=[],n)Object.prototype.hasOwnProperty.call(n,a)&&s.push([n[a],a]);if(!s.length)for(a in n=r)Object.prototype.hasOwnProperty.call(n,a)&&s.push([n[a],a]);return s.sort((function(e,t){return e[0]-t[0]||r[e[1]]-r[t[1]]})),t[s.pop()[1]]||44}function i(e,t){var r=t||{},i="";null!=DENSE&&null==r.dense&&(r.dense=DENSE);var a={};r.dense&&(a["!data"]=[]);var s={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(i=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(i=e.charAt(4),e=e.slice(6)):i=n(e.slice(0,1024)):i=r&&r.FS?r.FS:n(e.slice(0,1024));var o=0,l=0,c=0,d=0,u=0,p=i.charCodeAt(0),h=!1,f=0,m=e.charCodeAt(0),g=null!=r.dateNF?dateNF_regex(r.dateNF):null;function _(){var t=e.slice(d,u);"\r"==t.slice(-1)&&(t=t.slice(0,-1));var n={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),!1!==r.cellText&&(n.w=t),0===t.length)n.t="z";else if(r.raw)n.t="s",n.v=t;else if(0===t.trim().length)n.t="s",n.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(n.t="s",n.v=t.slice(2,-1).replace(/""/g,'"')):fuzzyfmla(t)?(n.t="s",n.f=t.slice(1),n.v=t):(n.t="s",n.v=t);else if("TRUE"==t)n.t="b",n.v=!0;else if("FALSE"==t)n.t="b",n.v=!1;else if(isNaN(c=fuzzynum(t)))if(!isNaN((c=fuzzydate(t)).getDate())||g&&t.match(g)){if(n.z=r.dateNF||table_fmt[14],g&&t.match(g)){var i=dateNF_fix(t,r.dateNF,t.match(g)||[]);c=parseDate(i),r&&!1===r.UTC&&(c=utc_to_local(c))}else r&&!1===r.UTC?c=utc_to_local(c):!1!==r.cellText&&r.dateNF&&(n.w=SSF_format(n.z,c));r.cellDates?(n.t="d",n.v=c):(n.t="n",n.v=datenum(c)),r.cellNF||delete n.z}else 35==t.charCodeAt(0)&&null!=RBErr[t]?(n.t="e",n.w=t,n.v=RBErr[t]):(n.t="s",n.v=t);else n.t="n",n.v=c;if("z"==n.t||(r.dense?(a["!data"][o]||(a["!data"][o]=[]),a["!data"][o][l]=n):a[encode_cell({c:l,r:o})]=n),d=u+1,m=e.charCodeAt(d),s.e.c<l&&(s.e.c=l),s.e.r<o&&(s.e.r=o),f==p)++l;else if(l=0,++o,r.sheetRows&&r.sheetRows<=o)return!0}e:for(;u<e.length;++u)switch(f=e.charCodeAt(u)){case 34:34===m&&(h=!h);break;case 13:if(h)break;10==e.charCodeAt(u+1)&&++u;case p:case 10:if(!h&&_())break e}return u-d>0&&_(),a["!ref"]=encode_range(s),a}function a(t,r){var n="",a="string"==r.type?[0,0,0,0]:firstbyte(t,r);switch(r.type){case"base64":n=Base64_decode(t);break;case"binary":case"string":n=t;break;case"buffer":n=65001==r.codepage?t.toString("utf8"):r.codepage&&void 0!==$cptable?$cptable.utils.decode(r.codepage,t):has_buf&&Buffer.isBuffer(t)?t.toString("binary"):a2s(t);break;case"array":n=cc2str(t);break;default:throw new Error("Unrecognized type "+r.type)}return 239==a[0]&&187==a[1]&&191==a[2]?n=utf8read(n.slice(3)):"string"!=r.type&&"buffer"!=r.type&&65001==r.codepage?n=utf8read(n):"binary"==r.type&&void 0!==$cptable&&r.codepage&&(n=$cptable.utils.decode(r.codepage,$cptable.utils.encode(28591,n))),"socialcalc:version:"==n.slice(0,19)?ETH.to_sheet("string"==r.type?n:utf8read(n),r):function(t,r){return r&&r.PRN?r.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?i(t,r):aoa_to_sheet(function(t,r){var n=r||{},i=[];if(!t||0===t.length)return i;for(var a=t.split(/[\r\n]/),s=a.length-1;s>=0&&0===a[s].length;)--s;for(var o=10,l=0,c=0;c<=s;++c)-1==(l=a[c].indexOf(" "))?l=a[c].length:l++,o=Math.max(o,l);for(c=0;c<=s;++c){i[c]=[];var d=0;for(e(a[c].slice(0,o).trim(),i,c,d,n),d=1;d<=(a[c].length-o)/10+1;++d)e(a[c].slice(o+10*(d-1),o+10*d).trim(),i,c,d,n)}return n.sheetRows&&(i=i.slice(0,n.sheetRows)),i}(t,r),r):i(t,r)}(n,r)}return{to_workbook:function(e,t){return sheet_to_workbook(a(e,t),t)},to_sheet:a,from_sheet:function(e){var t=[];if(!e["!ref"])return"";for(var r,n=safe_decode_range(e["!ref"]),i=null!=e["!data"],a=n.s.r;a<=n.e.r;++a){for(var s=[],o=n.s.c;o<=n.e.c;++o){var l=encode_cell({r:a,c:o});if((r=i?(e["!data"][a]||[])[o]:e[l])&&null!=r.v){for(var c=(r.w||(format_cell(r),r.w)||"").slice(0,10);c.length<10;)c+=" ";s.push(c+(0===o?" ":""))}else s.push("          ")}t.push(s.join(""))}return t.join("\n")}}}();function read_wb_ID(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=SYLK.to_workbook(e,r);return r.WTF=n,i}catch(i){if(r.WTF=n,-1==i.message.indexOf("SYLK bad record ID")&&n)throw i;return PRN.to_workbook(e,t)}}var WK_=function(){function e(e,t,r){if(e){prep_blob(e,e.l||0);for(var n=r.Enum||b;e.l<e.length;){var i=e.read_shift(2),a=n[i]||n[65535],s=e.read_shift(2),o=e.l+s,l=a.f&&a.f(e,s,r);if(e.l=o,t(l,a,i))return}}}var t=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function r(r,n){if(!r)return r;var i=n||{};null!=DENSE&&null==i.dense&&(i.dense=DENSE);var a={},s="Sheet1",o="",l=0,c={},d=[],u=[],p=[];i.dense&&(p=a["!data"]=[]);var h={s:{r:0,c:0},e:{r:0,c:0}},f=i.sheetRows||0,m={};if(81==r[4]&&80==r[5]&&87==r[6])return function(e,t){prep_blob(e,0);var r=t||{};null!=DENSE&&null==r.dense&&(r.dense=DENSE);var n={};r.dense&&(n["!data"]=[]);var i=[],a="",s={s:{r:-1,c:-1},e:{r:-1,c:-1}},o=0,l=0,c=0,d=0,u={SheetNames:[],Sheets:{}},p=[];e:for(;e.l<e.length;){var h=e.read_shift(2),f=e.read_shift(2),m=e.slice(e.l,e.l+f);switch(prep_blob(m,0),h){case 1:if(962023505!=m.read_shift(4))throw"Bad QPW9 BOF!";break;case 2:break e;case 8:case 1025:case 1026:case 1032:default:break;case 10:for(var g=m.read_shift(4),_=(m.length-m.l)/g|0,b=0;b<g;++b){var v=m.l+_,E={};m.l+=2,E.numFmtId=m.read_shift(2),y[E.numFmtId]&&(E.z=y[E.numFmtId]),m.l=v,p.push(E)}break;case 1031:for(m.l+=12;m.l<m.length;)o=m.read_shift(2),l=m.read_shift(1),i.push(m.read_shift(o,"cstr"));break;case 1537:var S=m.read_shift(2);n={},r.dense&&(n["!data"]=[]),s.s.c=m.read_shift(2),s.e.c=m.read_shift(2),s.s.r=m.read_shift(4),s.e.r=m.read_shift(4),m.l+=4,m.l+2<m.length&&(o=m.read_shift(2),l=m.read_shift(1),a=0==o?"":m.read_shift(o,"cstr")),a||(a=encode_col(S));break;case 1538:if(s.s.c>255||s.s.r>999999)break;s.e.c<s.s.c&&(s.e.c=s.s.c),s.e.r<s.s.r&&(s.e.r=s.s.r),n["!ref"]=encode_range(s),book_append_sheet(u,n,a);break;case 2561:c=m.read_shift(2),s.e.c<c&&(s.e.c=c),s.s.c>c&&(s.s.c=c),d=m.read_shift(4),s.s.r>d&&(s.s.r=d),d=m.read_shift(4),s.e.r<d&&(s.e.r=d);break;case 3073:d=m.read_shift(4),o=m.read_shift(4),s.s.r>d&&(s.s.r=d),s.e.r<d+o-1&&(s.e.r=d+o-1);for(var T=encode_col(c);m.l<m.length;){var C={t:"z"},x=m.read_shift(1),A=-1;128&x&&(A=m.read_shift(2));var I=64&x?m.read_shift(2)-1:0;switch(31&x){case 0:case 1:break;case 2:C={t:"n",v:m.read_shift(2)};break;case 3:C={t:"n",v:m.read_shift(2,"i")};break;case 4:C={t:"n",v:parse_RkNumber(m)};break;case 5:C={t:"n",v:m.read_shift(8,"f")};break;case 7:C={t:"s",v:i[l=m.read_shift(4)-1]};break;case 8:C={t:"n",v:m.read_shift(8,"f")},m.l+=2,m.l+=4,isNaN(C.v)&&(C={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(31&x)}-1!=A&&(p[A-1]||{}).z&&(C.z=p[A-1].z);var D=0;if(32&x)switch(31&x){case 2:case 7:D=m.read_shift(2);break;case 3:D=m.read_shift(2,"i");break;default:throw"Unsupported delta for QPW cell type "+(31&x)}if(r.sheetStubs||"z"!=C.t){var k=dup(C);"n"==C.t&&C.z&&fmt_is_date(C.z)&&r.cellDates&&(k.v=numdate(C.v),k.t="number"==typeof k.v?"n":"d"),null!=n["!data"]?(n["!data"][d]||(n["!data"][d]=[]),n["!data"][d][c]=k):n[T+encode_row(d)]=k}for(++d,--o;I-- >0&&o>=0;){if(32&x)switch(31&x){case 2:C={t:"n",v:C.v+D&65535};break;case 3:(C={t:"n",v:C.v+D&65535}).v>32767&&(C.v-=65536);break;case 7:C={t:"s",v:i[l=l+D>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(31&x)}else switch(31&x){case 1:C={t:"z"};break;case 2:C={t:"n",v:m.read_shift(2)};break;case 7:C={t:"s",v:i[l=m.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(31&x)}(r.sheetStubs||"z"!=C.t)&&(null!=n["!data"]?(n["!data"][d]||(n["!data"][d]=[]),n["!data"][d][c]=C):n[T+encode_row(d)]=C),++d,--o}}break;case 3074:c=m.read_shift(2),d=m.read_shift(4);var L=w(m);null!=n["!data"]?(n["!data"][d]||(n["!data"][d]=[]),n["!data"][d][c]={t:"s",v:L}):n[encode_col(c)+encode_row(d)]={t:"s",v:L}}e.l+=f}return u}(r,n);if(0==r[2]&&(8==r[3]||9==r[3])&&r.length>=16&&5==r[14]&&108===r[15])throw new Error("Unsupported Works 3 for Mac file");if(2==r[2])i.Enum=b,e(r,(function(e,r,n){switch(n){case 0:i.vers=e,e>=4096&&(i.qpro=!0);break;case 255:i.vers=e,i.works=!0;break;case 6:h=e;break;case 204:e&&(o=e);break;case 222:o=e;break;case 15:case 51:(!i.qpro&&!i.works||51==n)&&e[1].v.charCodeAt(0)<48&&(e[1].v=e[1].v.slice(1)),(i.works||i.works2)&&(e[1].v=e[1].v.replace(/\r\n/g,"\n"));case 13:case 14:case 16:!(112&~e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=i.dateNF||t[(15&e[2])-1]||table_fmt[14],i.cellDates&&(e[1].v=numdate(e[1].v),e[1].t="number"==typeof e[1].v?"n":"d")),i.qpro&&e[3]>l&&(a["!ref"]=encode_range(h),c[s]=a,d.push(s),a={},i.dense&&(p=a["!data"]=[]),h={s:{r:0,c:0},e:{r:0,c:0}},l=e[3],s=o||"Sheet"+(l+1),o="");var u=i.dense?(p[e[0].r]||[])[e[0].c]:a[encode_cell(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f),m=u;break}i.dense?(p[e[0].r]||(p[e[0].r]=[]),p[e[0].r][e[0].c]=e[1]):a[encode_cell(e[0])]=e[1],m=e[1];break;case 21509:i.works2=!0;break;case 21506:5281==e&&(m.z="hh:mm:ss",i.cellDates&&"n"==m.t&&(m.v=numdate(m.v),m.t="number"==typeof m.v?"n":"d"))}}),i);else{if(26!=r[2]&&14!=r[2])throw new Error("Unrecognized LOTUS BOF "+r[2]);i.Enum=v,14==r[2]&&(i.qpro=!0,r.l=0),e(r,(function(e,t,r){switch(r){case 204:s=e;break;case 22:e[1].v.charCodeAt(0)<48&&(e[1].v=e[1].v.slice(1)),e[1].v=e[1].v.replace(/\x0F./g,(function(e){return String.fromCharCode(e.charCodeAt(1)-32)})).replace(/\r\n/g,"\n");case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>l&&(a["!ref"]=encode_range(h),c[s]=a,d.push(s),a={},i.dense&&(p=a["!data"]=[]),h={s:{r:0,c:0},e:{r:0,c:0}},l=e[3],s="Sheet"+(l+1)),f>0&&e[0].r>=f)break;i.dense?(p[e[0].r]||(p[e[0].r]=[]),p[e[0].r][e[0].c]=e[1]):a[encode_cell(e[0])]=e[1],h.e.c<e[0].c&&(h.e.c=e[0].c),h.e.r<e[0].r&&(h.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==l&&(s=e[1])}}),i)}if(a["!ref"]=encode_range(h),c[o||s]=a,d.push(o||s),!u.length)return{SheetNames:d,Sheets:c};for(var g={},_=[],E=0;E<u.length;++E)c[d[E]]?(_.push(u[E]||d[E]),g[u[E]]=c[u[E]]||c[d[E]]):(_.push(u[E]),g[u[E]]={"!ref":"A1"});return{SheetNames:_,Sheets:g}}function n(e,t,r){var n=[{c:0,r:0},{t:"n",v:0},0,0];return r.qpro&&20768!=r.vers?(n[0].c=e.read_shift(1),n[3]=e.read_shift(1),n[0].r=e.read_shift(2),e.l+=2):r.works?(n[0].c=e.read_shift(2),n[0].r=e.read_shift(2),n[2]=e.read_shift(2)):(n[2]=e.read_shift(1),n[0].c=e.read_shift(2),n[0].r=e.read_shift(2)),n}function i(e){return e.z&&fmt_is_date(e.z)?240|(t.indexOf(e.z)+1||2):255}function a(e,t,r){var n=new_buf(7+r.length);n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(1,39);for(var i=0;i<n.length;++i){var a=r.charCodeAt(i);n.write_shift(1,a>=128?95:a)}return n.write_shift(1,0),n}function s(e,t,r){var n=new_buf(7);return n.write_shift(1,i(r)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r.v,"i"),n}function o(e,t,r){var n=new_buf(13);return n.write_shift(1,i(r)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(8,r.v,"f"),n}function l(e,t,r){var n=32768&t;return t=(n?e:0)+((t&=-32769)>=8192?t-16384:t),(n?"":"$")+(r?encode_col(t):encode_row(t))}var c={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},d=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function p(e,t,r,n){var i=new_buf(6+n.length);i.write_shift(2,e),i.write_shift(1,r),i.write_shift(1,t),i.write_shift(1,39);for(var a=0;a<n.length;++a){var s=n.charCodeAt(a);i.write_shift(1,s>=128?95:s)}return i.write_shift(1,0),i}function h(e,t){var r=u(e),n=e.read_shift(4),i=e.read_shift(4),a=e.read_shift(2);if(65535==a)return 0===n&&3221225472===i?(r[1].t="e",r[1].v=15):0===n&&3489660928===i?(r[1].t="e",r[1].v=42):r[1].v=0,r;var s=32768&a;return a=(32767&a)-16446,r[1].v=(1-2*s)*(i*Math.pow(2,a+32)+n*Math.pow(2,a)),r}function f(e,t,r,n){var i=new_buf(14);if(i.write_shift(2,e),i.write_shift(1,r),i.write_shift(1,t),0==n)return i.write_shift(4,0),i.write_shift(4,0),i.write_shift(2,65535),i;var a,s=0,o=0,l=0;return n<0&&(s=1,n=-n),o=0|Math.log2(n),2147483648&(l=(n/=Math.pow(2,o-31))>>>0)||(++o,l=(n/=2)>>>0),n-=l,l|=2147483648,l>>>=0,a=(n*=Math.pow(2,32))>>>0,i.write_shift(4,a),i.write_shift(4,l),o+=16383+(s?32768:0),i.write_shift(2,o),i}function m(e,t){var r=u(e),n=e.read_shift(8,"f");return r[1].v=n,r}function g(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function _(e,t){var r=new_buf(5+e.length);r.write_shift(2,14e3),r.write_shift(2,t);for(var n=0;n<e.length;++n){var i=e.charCodeAt(n);r[r.l++]=i>127?95:i}return r[r.l++]=0,r}var b={0:{n:"BOF",f:parseuint16},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,r){var n={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&r.qpro?(n.s.c=e.read_shift(1),e.l++,n.s.r=e.read_shift(2),n.e.c=e.read_shift(1),e.l++,n.e.r=e.read_shift(2),n):(n.s.c=e.read_shift(2),n.s.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),n.e.c=e.read_shift(2),n.e.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),65535==n.s.c&&(n.s.c=n.e.c=n.s.r=n.e.r=0),n)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var i=n(e,0,r);return i[1].v=e.read_shift(2,"i"),i}},14:{n:"NUMBER",f:function(e,t,r){var i=n(e,0,r);return i[1].v=e.read_shift(8,"f"),i}},15:{n:"LABEL",f:function(e,t,r){var i=e.l+t,a=n(e,0,r);if(a[1].t="s",20768==(65534&r.vers)){e.l++;var s=e.read_shift(1);return a[1].v=e.read_shift(s,"utf8"),a}return r.qpro&&e.l++,a[1].v=e.read_shift(i-e.l,"cstr"),a}},16:{n:"FORMULA",f:function(e,t,r){var i=e.l+t,a=n(e,0,r);if(a[1].v=e.read_shift(8,"f"),r.qpro)e.l=i;else{var s=e.read_shift(2);!function(e,t){prep_blob(e,0);for(var r=[],n=0,i="",a="",s="",o="";e.l<e.length;){var u=e[e.l++];switch(u){case 0:r.push(e.read_shift(8,"f"));break;case 1:a=l(t[0].c,e.read_shift(2),!0),i=l(t[0].r,e.read_shift(2),!1),r.push(a+i);break;case 2:var p=l(t[0].c,e.read_shift(2),!0),h=l(t[0].r,e.read_shift(2),!1);a=l(t[0].c,e.read_shift(2),!0),i=l(t[0].r,e.read_shift(2),!1),r.push(p+h+":"+a+i);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:r.push("("+r.pop()+")");break;case 5:r.push(e.read_shift(2));break;case 6:for(var f="";u=e[e.l++];)f+=String.fromCharCode(u);r.push('"'+f.replace(/"/g,'""')+'"');break;case 8:r.push("-"+r.pop());break;case 23:r.push("+"+r.pop());break;case 22:r.push("NOT("+r.pop()+")");break;case 20:case 21:o=r.pop(),s=r.pop(),r.push(["AND","OR"][u-20]+"("+s+","+o+")");break;default:if(u<32&&d[u])o=r.pop(),s=r.pop(),r.push(s+d[u]+o);else{if(!c[u])return u<=7?console.error("WK1 invalid opcode "+u.toString(16)):u<=24?console.error("WK1 unsupported op "+u.toString(16)):u<=30?console.error("WK1 invalid opcode "+u.toString(16)):u<=115?console.error("WK1 unsupported function opcode "+u.toString(16)):console.error("WK1 unrecognized opcode "+u.toString(16));if(69==(n=c[u][1])&&(n=e[e.l++]),n>r.length)return void console.error("WK1 bad formula parse 0x"+u.toString(16)+":|"+r.join("|")+"|");var m=r.slice(-n);r.length-=n,r.push(c[u][0]+"("+m.join(",")+")")}}}1==r.length?t[1].f=""+r[0]:console.error("WK1 bad formula parse |"+r.join("|")+"|")}(e.slice(e.l,e.l+s),a),e.l+=s}return a}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:function(e,t,r){var i=e.l+t,a=n(e,0,r);if(a[1].t="s",20768==r.vers){var s=e.read_shift(1);return a[1].v=e.read_shift(s,"utf8"),a}return a[1].v=e.read_shift(i-e.l,"cstr"),a}},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:g},222:{n:"SHEETNAMELP",f:function(e,t){var r=e[e.l++];r>t-1&&(r=t-1);for(var n="";n.length<r;)n+=String.fromCharCode(e[e.l++]);return n}},255:{n:"BOF",f:parseuint16},21506:{n:"WKSNF",f:parseuint16},65535:{n:""}},v={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var r=u(e);return r[1].t="s",r[1].v=e.read_shift(t-4,"cstr"),r}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var r=u(e);r[1].v=e.read_shift(2);var n=r[1].v>>1;if(1&r[1].v)switch(7&n){case 0:n=5e3*(n>>3);break;case 1:n=500*(n>>3);break;case 2:n=(n>>3)/20;break;case 3:n=(n>>3)/200;break;case 4:n=(n>>3)/2e3;break;case 5:n=(n>>3)/2e4;break;case 6:n=(n>>3)/16;break;case 7:n=(n>>3)/64}return r[1].v=n,r}},25:{n:"FORMULA19",f:function(e,t){var r=h(e);return e.l+=t-14,r}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var r={},n=e.l+t;e.l<n;){var i=e.read_shift(2);if(14e3==i){for(r[i]=[0,""],r[i][0]=e.read_shift(2);e[e.l];)r[i][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return r}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var r=u(e),n=e.read_shift(4);return r[1].v=n>>6,r}},38:{n:"??"},39:{n:"NUMBER27",f:m},40:{n:"FORMULA28",f:function(e,t){var r=m(e);return e.l+=t-12,r}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:g},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,r){if(r.qpro&&!(t<21)){var n=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[n,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},y={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function w(e){var t=e.read_shift(2),r=e.read_shift(1);if(0!=r)throw"unsupported QPW string type "+r.toString(16);return e.read_shift(t,"sbcs-cont")}return{sheet_to_wk1:function(e,t){var r=t||{};if(+r.codepage>=0&&set_cp(+r.codepage),"string"==r.type)throw new Error("Cannot write WK1 to JS string");var n=buf_array();if(!e["!ref"])throw new Error("Cannot export empty sheet to WK1");var i,l=safe_decode_range(e["!ref"]),c=null!=e["!data"],d=[];write_biff_rec(n,0,((i=new_buf(2)).write_shift(2,1030),i)),write_biff_rec(n,6,function(e){var t=new_buf(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(l));for(var u=Math.min(l.e.r,8191),p=l.s.c;p<=l.e.c;++p)d[p]=encode_col(p);for(var h=l.s.r;h<=u;++h){var f=encode_row(h);for(p=l.s.c;p<=l.e.c;++p){var m=c?(e["!data"][h]||[])[p]:e[d[p]+f];if(m&&"z"!=m.t)switch(m.t){case"n":(0|m.v)==m.v&&m.v>=-32768&&m.v<=32767?write_biff_rec(n,13,s(h,p,m)):write_biff_rec(n,14,o(h,p,m));break;case"d":var g=datenum(m.v);(0|g)==g&&g>=-32768&&g<=32767?write_biff_rec(n,13,s(h,p,{t:"n",v:g,z:m.z||table_fmt[14]})):write_biff_rec(n,14,o(h,p,{t:"n",v:g,z:m.z||table_fmt[14]}));break;default:write_biff_rec(n,15,a(h,p,format_cell(m).slice(0,239)))}}}return write_biff_rec(n,1),n.end()},book_to_wk3:function(e,t){var r=t||{};if(+r.codepage>=0&&set_cp(+r.codepage),"string"==r.type)throw new Error("Cannot write WK3 to JS string");var n=buf_array();write_biff_rec(n,0,function(e){var t=new_buf(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var r=0,n=0,i=0,a=0;a<e.SheetNames.length;++a){var s=e.SheetNames[a],o=e.Sheets[s];if(o&&o["!ref"]){++i;var l=decode_range(o["!ref"]);r<l.e.r&&(r=l.e.r),n<l.e.c&&(n=l.e.c)}}return r>8191&&(r=8191),t.write_shift(2,r),t.write_shift(1,i),t.write_shift(1,n),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var i=0,a=0;i<e.SheetNames.length;++i)(e.Sheets[e.SheetNames[i]]||{})["!ref"]&&write_biff_rec(n,27,_(e.SheetNames[i],a++));var s=0;for(i=0;i<e.SheetNames.length;++i){var o=e.Sheets[e.SheetNames[i]];if(o&&o["!ref"]){for(var l=safe_decode_range(o["!ref"]),c=null!=o["!data"],d=[],u=Math.min(l.e.r,8191),h=l.s.r;h<=u;++h)for(var m=encode_row(h),g=l.s.c;g<=l.e.c;++g){h===l.s.r&&(d[g]=encode_col(g));var b=d[g]+m,v=c?(o["!data"][h]||[])[g]:o[b];v&&"z"!=v.t&&("n"==v.t?write_biff_rec(n,23,f(h,g,s,v.v)):write_biff_rec(n,22,p(h,g,s,format_cell(v).slice(0,239))))}++s}}return write_biff_rec(n,1),n.end()},to_workbook:function(e,t){switch(t.type){case"base64":return r(s2a(Base64_decode(e)),t);case"binary":return r(s2a(e),t);case"buffer":case"array":return r(e,t)}throw"Unsupported type "+t.type}}}();function parse_rpr(e){var t={},r=e.match(tagregex),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=parsexmltag(r[n]);switch(a[0].replace(/<\w*:/g,"<")){case"<condense":case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==a.val)break;t.cp=CS2CP[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==a.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==a.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(47!==a[0].charCodeAt(1)&&!i)throw new Error("Unrecognized rich format "+a[0])}}return t}var parse_rs=function(){function e(e){var t=str_match_xml_ns(e,"t");if(!t)return{t:"s",v:""};var r={t:"s",v:unescapexml(t[1])},n=str_match_xml_ns(e,"rPr");return n&&(r.s=parse_rpr(n[1])),r}var t=/<(?:\w+:)?r>/g,r=/<\/(?:\w+:)?r>/;return function(n){return n.replace(t,"").split(r).map(e).filter((function(e){return e.v}))}}(),rs_to_html=function(){var e=/(\r\n|\n)/g;function t(t){var r=[[],t.v,[]];return t.v?(t.s&&function(e,t,r){var n=[];e.u&&n.push("text-decoration: underline;"),e.uval&&n.push("text-underline-style:"+e.uval+";"),e.sz&&n.push("font-size:"+e.sz+"pt;"),e.outline&&n.push("text-effect: outline;"),e.shadow&&n.push("text-shadow: auto;"),t.push('<span style="'+n.join("")+'">'),e.b&&(t.push("<b>"),r.push("</b>")),e.i&&(t.push("<i>"),r.push("</i>")),e.strike&&(t.push("<s>"),r.push("</s>"));var i=e.valign||"";"superscript"==i||"super"==i?i="sup":"subscript"==i&&(i="sub"),""!=i&&(t.push("<"+i+">"),r.push("</"+i+">")),r.push("</span>")}(t.s,r[0],r[2]),r[0].join("")+r[1].replace(e,"<br/>")+r[2].join("")):""}return function(e){return e.map(t).join("")}}(),sitregex=/<(?:\w+:)?t\b[^<>]*>([^<]*)<\/(?:\w+:)?t>/g,sirregex=/<(?:\w+:)?r\b[^<>]*>/;function parse_si(e,t){var r=!t||t.cellHTML,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=unescapexml(utf8read(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||""),!0),n.r=utf8read(e),r&&(n.h=escapehtml(n.t))):e.match(sirregex)&&(n.r=utf8read(e),n.t=unescapexml(utf8read((str_remove_xml_ns_g(e,"rPh").match(sitregex)||[]).join("").replace(tagregex,"")),!0),r&&(n.h=rs_to_html(parse_rs(n.r)))),n):{t:""}}var sstr1=/<(?:\w+:)?(?:si|sstItem)>/g,sstr2=/<\/(?:\w+:)?(?:si|sstItem)>/;function parse_sst_xml(e,t){var r=[],n="";if(!e)return r;var i=str_match_xml_ns(e,"sst");if(i){n=i[1].replace(sstr1,"").split(sstr2);for(var a=0;a!=n.length;++a){var s=parse_si(n[a].trim(),t);null!=s&&(r[r.length]=s)}i=parsexmltag(i[0].slice(0,i[0].indexOf(">"))),r.Count=i.count,r.Unique=i.uniqueCount}return r}var straywsregex=/^\s|\s$|[\t\n\r]/;function write_sst_xml(e,t){if(!t.bookSST)return"";var r=[XML_HEADER];r[r.length]=writextag("sst",null,{xmlns:XMLNS_main[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(null!=e[n]){var i=e[n],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),"string"!=typeof i.t&&(i.t=String(i.t)),i.t.match(straywsregex)&&(a+=' xml:space="preserve"'),a+=">"+escapexml(i.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function parse_BrtBeginSst(e){return[e.read_shift(4),e.read_shift(4)]}function parse_sst_bin(e,t){var r=[],n=!1;return recordhopper(e,(function(e,i,a){switch(a){case 159:r.Count=e[0],r.Unique=e[1];break;case 19:r.push(e);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}})),r}function write_BrtBeginSst(e,t){return t||(t=new_buf(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var write_BrtSSTItem=write_RichStr;function write_sst_bin(e){var t=buf_array();write_record(t,159,write_BrtBeginSst(e));for(var r=0;r<e.length;++r)write_record(t,19,write_BrtSSTItem(e[r]));return write_record(t,160),t.end()}function _JS2ANSI(e){if(void 0!==$cptable)return $cptable.utils.encode(current_ansi,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function parse_CRYPTOVersion(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function parse_DataSpaceVersionInfo(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=parse_CRYPTOVersion(e,4),t.U=parse_CRYPTOVersion(e,4),t.W=parse_CRYPTOVersion(e,4),t}function parse_DataSpaceMapEntry(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),a=[];i-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function parse_DataSpaceMap(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(parse_DataSpaceMapEntry(e));return t}function parse_DataSpaceDefinition(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function parse_TransformInfoHeader(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=parse_CRYPTOVersion(e,4),t.U=parse_CRYPTOVersion(e,4),t.W=parse_CRYPTOVersion(e,4),t}function parse_Primary(e){var t=parse_TransformInfoHeader(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function parse_EncryptionHeader(e,t){var r=e.l+t,n={};n.Flags=63&e.read_shift(4),e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=36==n.Flags;break;case 26625:i=4==n.Flags;break;case 0:i=16==n.Flags||4==n.Flags||36==n.Flags;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function parse_EncryptionVerifier(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function parse_EncryptionInfo(e){var t=parse_CRYPTOVersion(e);switch(t.Minor){case 2:return[t.Minor,parse_EncInfoStd(e,t)];case 3:return[t.Minor,parse_EncInfoExt(e,t)];case 4:return[t.Minor,parse_EncInfoAgl(e,t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function parse_EncInfoStd(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:parse_EncryptionHeader(e,t),v:parse_EncryptionVerifier(e,e.length-e.l)}}function parse_EncInfoExt(){throw new Error("File is password-protected: ECMA-376 Extensible")}function parse_EncInfoAgl(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(tagregex,(function(e){var r=parsexmltag(e);switch(strip_ns(r[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach((function(e){n[e]=r[e]}));break;case"<dataIntegrity":n.encryptedHmacKey=r.encryptedHmacKey,n.encryptedHmacValue=r.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"<keyEncryptor":n.uri=r.uri;break;case"<encryptedKey":n.encs.push(r);break;default:throw r[0]}})),n}function parse_RC4CryptoHeader(e,t){var r={},n=r.EncryptionVersionInfo=parse_CRYPTOVersion(e,4);if(t-=4,2!=n.Minor)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=parse_EncryptionHeader(e,i),t-=i,r.EncryptionVerifier=parse_EncryptionVerifier(e,t),r}function parse_RC4Header(e){var t={},r=t.EncryptionVersionInfo=parse_CRYPTOVersion(e,4);if(1!=r.Major||1!=r.Minor)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function crypto_CreatePasswordVerifier_Method1(e){var t,r,n=0,i=_JS2ANSI(e),a=i.length+1;for((t=new_raw_buf(a))[0]=i.length,r=1;r!=a;++r)t[r]=i[r-1];for(r=a-1;r>=0;--r)n=((16384&n?1:0)|n<<1&32767)^t[r];return 52811^n}var crypto_CreateXorArray_Method1=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(e,t){return 255&((r=e^t)/2|128*r);var r};return function(i){for(var a,s,o,l=_JS2ANSI(i),c=function(e){for(var n=t[e.length-1],i=104,a=e.length-1;a>=0;--a)for(var s=e[a],o=0;7!=o;++o)64&s&&(n^=r[i]),s*=2,--i;return n}(l),d=l.length,u=new_raw_buf(16),p=0;16!=p;++p)u[p]=0;for(1&~d||(a=c>>8,u[d]=n(e[0],a),--d,a=255&c,s=l[l.length-1],u[d]=n(s,a));d>0;)a=c>>8,u[--d]=n(l[d],a),a=255&c,u[--d]=n(l[d],a);for(d=15,o=15-l.length;o>0;)a=c>>8,u[d]=n(e[o],a),--o,a=255&c,u[--d]=n(l[d],a),--d,--o;return u}}(),crypto_DecryptData_Method1=function(e,t,r,n,i){var a,s;for(i||(i=t),n||(n=crypto_CreateXorArray_Method1(e)),a=0;a!=t.length;++a)s=t[a],s=255&((s^=n[r])>>5|s<<3),i[a]=s,++r;return[i,r,n]},crypto_MakeXorDecryptor=function(e){var t=0,r=crypto_CreateXorArray_Method1(e);return function(e){var n=crypto_DecryptData_Method1("",e,t,r);return t=n[1],n[0]}};function parse_XORObfuscation(e,t,r,n){var i={key:parseuint16(e),verificationBytes:parseuint16(e)};return r.password&&(i.verifier=crypto_CreatePasswordVerifier_Method1(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=crypto_MakeXorDecryptor(r.password)),i}function parse_FilePassHeader(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,1===n.Info?n.Data=parse_RC4Header(e,t):n.Data=parse_RC4CryptoHeader(e,t),n}function parse_FilePass(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?parse_FilePassHeader(e,t-2,n):parse_XORObfuscation(e,r.biff>=8?t:t-2,r,n),n}function rtf_to_sheet(e,t){switch(t.type){case"base64":return rtf_to_sheet_str(Base64_decode(e),t);case"binary":return rtf_to_sheet_str(e,t);case"buffer":return rtf_to_sheet_str(has_buf&&Buffer.isBuffer(e)?e.toString("binary"):a2s(e),t);case"array":return rtf_to_sheet_str(cc2str(e),t)}throw new Error("Unrecognized type "+t.type)}function rtf_to_sheet_str(e,t){var r=t||{},n={},i=r.dense;i&&(n["!data"]=[]);var a=str_match_ng(e,"\\trowd","\\row");if(!a)throw new Error("RTF missing table");var s={s:{c:0,r:0},e:{c:0,r:a.length-1}},o=[];return a.forEach((function(e,t){i&&(o=n["!data"][t]=[]);for(var a,l=/\\[\w\-]+\b/g,c=0,d=-1,u=[];null!=(a=l.exec(e));){var p=e.slice(c,l.lastIndex-a[0].length);switch(32==p.charCodeAt(0)&&(p=p.slice(1)),p.length&&u.push(p),a[0]){case"\\cell":if(++d,u.length){var h={v:u.join(""),t:"s"};"TRUE"==h.v||"FALSE"==h.v?(h.v="TRUE"==h.v,h.t="b"):isNaN(fuzzynum(h.v))?null!=RBErr[h.v]&&(h.t="e",h.w=h.v,h.v=RBErr[h.v]):(h.t="n",!1!==r.cellText&&(h.w=h.v),h.v=fuzzynum(h.v)),i?o[d]=h:n[encode_cell({r:t,c:d})]=h}u=[];break;case"\\par":u.push("\n")}c=l.lastIndex}d>s.e.c&&(s.e.c=d)})),n["!ref"]=encode_range(s),n}function rtf_to_workbook(e,t){var r=sheet_to_workbook(rtf_to_sheet(e,t),t);return r.bookType="rtf",r}function sheet_to_rtf(e,t){var r=["{\\rtf1\\ansi"];if(!e["!ref"])return r[0]+"}";for(var n,i=safe_decode_range(e["!ref"]),a=null!=e["!data"],s=[],o=i.s.r;o<=i.e.r;++o){r.push("\\trowd\\trautofit1");for(var l=i.s.c;l<=i.e.c;++l)r.push("\\cellx"+(l+1));for(r.push("\\pard\\intbl"),a&&(s=e["!data"][o]||[]),l=i.s.c;l<=i.e.c;++l){var c=encode_cell({r:o,c:l});(n=a?s[l]:e[c])&&(null!=n.v||n.f&&!n.F)?(r.push(" "+(n.w||(format_cell(n),n.w)||"").replace(/[\r\n]/g,"\\par ")),r.push("\\cell")):r.push(" \\cell")}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}function hex2RGB(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function rgb2Hex(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function rgb2HSL(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),a=Math.min(t,r,n),s=i-a;if(0===s)return[0,0,t];var o,l=0,c=i+a;switch(o=s/(c>1?2-c:c),i){case t:l=((r-n)/s+6)%6;break;case r:l=(n-t)/s+2;break;case n:l=(t-r)/s+4}return[l/6,o,c/2]}function hsl2RGB(e){var t,r=e[0],n=e[1],i=e[2],a=2*n*(i<.5?i:1-i),s=i-a/2,o=[s,s,s],l=6*r;if(0!==n)switch(0|l){case 0:case 6:t=a*l,o[0]+=a,o[1]+=t;break;case 1:t=a*(2-l),o[0]+=t,o[1]+=a;break;case 2:t=a*(l-2),o[1]+=a,o[2]+=t;break;case 3:t=a*(4-l),o[1]+=t,o[2]+=a;break;case 4:t=a*(l-4),o[2]+=a,o[0]+=t;break;case 5:t=a*(6-l),o[2]+=t,o[0]+=a}for(var c=0;3!=c;++c)o[c]=Math.round(255*o[c]);return o}function rgb_tint(e,t){if(0===t)return e;var r=rgb2HSL(hex2RGB(e));return r[2]=t<0?r[2]*(1+t):1-(1-r[2])*(1-t),rgb2Hex(hsl2RGB(r))}var DEF_MDW=6,MAX_MDW=15,MIN_MDW=1,MDW=DEF_MDW;function width2px(e){return Math.floor((e+Math.round(128/MDW)/256)*MDW)}function px2char(e){return Math.floor((e-5)/MDW*100+.5)/100}function char2width(e){return Math.round((e*MDW+5)/MDW*256)/256}function cycle_width(e){return char2width(px2char(width2px(e)))}function find_mdw_colw(e){var t=Math.abs(e-cycle_width(e)),r=MDW;if(t>.005)for(MDW=MIN_MDW;MDW<MAX_MDW;++MDW)Math.abs(e-cycle_width(e))<=t&&(t=Math.abs(e-cycle_width(e)),r=MDW);MDW=r}function process_col(e){e.width?(e.wpx=width2px(e.width),e.wch=px2char(e.wpx),e.MDW=MDW):e.wpx?(e.wch=px2char(e.wpx),e.width=char2width(e.wch),e.MDW=MDW):"number"==typeof e.wch&&(e.width=char2width(e.wch),e.wpx=width2px(e.width),e.MDW=MDW),e.customWidth&&delete e.customWidth}var DEF_PPI=96,PPI=DEF_PPI;function px2pt(e){return 96*e/PPI}function pt2px(e){return e*PPI/96}var XLMLPatternTypeMap={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function parse_borders(e,t,r,n){t.Borders=[];var i={},a=!1;(e.match(tagregex)||[]).forEach((function(e){var r=parsexmltag(e);switch(strip_ns(r[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":i={},r.diagonalUp&&(i.diagonalUp=parsexmlbool(r.diagonalUp)),r.diagonalDown&&(i.diagonalDown=parsexmlbool(r.diagonalDown)),t.Borders.push(i);break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+r[0]+" in borders")}}))}function parse_fills(e,t,r,n){t.Fills=[];var i={},a=!1;(e.match(tagregex)||[]).forEach((function(e){var r=parsexmltag(e);switch(strip_ns(r[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":r.patternType&&(i.patternType=r.patternType);break;case"<bgColor":i.bgColor||(i.bgColor={}),r.indexed&&(i.bgColor.indexed=parseInt(r.indexed,10)),r.theme&&(i.bgColor.theme=parseInt(r.theme,10)),r.tint&&(i.bgColor.tint=parseFloat(r.tint)),r.rgb&&(i.bgColor.rgb=r.rgb.slice(-6));break;case"<fgColor":i.fgColor||(i.fgColor={}),r.theme&&(i.fgColor.theme=parseInt(r.theme,10)),r.tint&&(i.fgColor.tint=parseFloat(r.tint)),null!=r.rgb&&(i.fgColor.rgb=r.rgb.slice(-6));break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+r[0]+" in fills")}}))}function parse_fonts(e,t,r,n){t.Fonts=[];var i={},a=!1;(e.match(tagregex)||[]).forEach((function(e){var s=parsexmltag(e);switch(strip_ns(s[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"</b>":case"</b":case"</i>":case"</i":case"</u>":case"</u":case"</strike>":case"</strike":case"</outline>":case"</outline":case"</shadow>":case"</shadow":case"</condense>":case"</condense":case"</extend>":case"</extend":case"<sz/>":case"</sz>":case"</sz":case"<vertAlign/>":case"</vertAlign>":case"</vertAlign":case"<family/>":case"</family>":case"</family":case"<scheme/>":case"</scheme>":case"</scheme":case"<charset/>":case"</charset>":case"</charset":case"<color/>":case"</color>":case"</color":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":s.val&&(i.name=utf8read(s.val));break;case"<b":i.bold=s.val?parsexmlbool(s.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=s.val?parsexmlbool(s.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(s.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=s.val?parsexmlbool(s.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=s.val?parsexmlbool(s.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=s.val?parsexmlbool(s.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=s.val?parsexmlbool(s.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=s.val?parsexmlbool(s.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":s.val&&(i.sz=+s.val);break;case"<vertAlign":s.val&&(i.vertAlign=s.val);break;case"<family":s.val&&(i.family=parseInt(s.val,10));break;case"<scheme":s.val&&(i.scheme=s.val);break;case"<charset":if("1"==s.val)break;s.codepage=CS2CP[parseInt(s.val,10)];break;case"<color":if(i.color||(i.color={}),s.auto&&(i.color.auto=parsexmlbool(s.auto)),s.rgb)i.color.rgb=s.rgb.slice(-6);else if(s.indexed){i.color.index=parseInt(s.indexed,10);var o=XLSIcv[i.color.index];81==i.color.index&&(o=XLSIcv[1]),o||(o=XLSIcv[1]),i.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else s.theme&&(i.color.theme=parseInt(s.theme,10),s.tint&&(i.color.tint=parseFloat(s.tint)),s.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=rgb_tint(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<AlternateContent":case"<ext":a=!0;break;case"</AlternateContent>":case"</AlternateContent":case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+s[0]+" in fonts")}}))}function parse_numFmts(e,t,r){t.NumberFmt=[];for(var n=keys(table_fmt),i=0;i<n.length;++i)t.NumberFmt[n[i]]=table_fmt[n[i]];var a=e.match(tagregex);if(a)for(i=0;i<a.length;++i){var s=parsexmltag(a[i]);switch(strip_ns(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var o=unescapexml(utf8read(s.formatCode)),l=parseInt(s.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=o}SSF__load(o,l)}break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function write_numFmts(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach((function(r){for(var n=r[0];n<=r[1];++n)null!=e[n]&&(t[t.length]=writextag("numFmt",null,{numFmtId:n,formatCode:escapexml(e[n])}))})),1===t.length?"":(t[t.length]="</numFmts>",t[0]=writextag("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var cellXF_uint=["numFmtId","fillId","fontId","borderId","xfId"],cellXF_bool=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function parse_cellXfs(e,t,r){var n;t.CellXf=[];var i=!1;(e.match(tagregex)||[]).forEach((function(e){var a=parsexmltag(e),s=0;switch(strip_ns(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"<protection>":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":case"<xf>":for(delete(n=a)[0],s=0;s<cellXF_uint.length;++s)n[cellXF_uint[s]]&&(n[cellXF_uint[s]]=parseInt(n[cellXF_uint[s]],10));for(s=0;s<cellXF_bool.length;++s)n[cellXF_bool[s]]&&(n[cellXF_bool[s]]=parsexmlbool(n[cellXF_bool[s]]));if(t.NumberFmt&&n.numFmtId>392)for(s=392;s>60;--s)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[s]){n.numFmtId=s;break}t.CellXf.push(n);break;case"<alignment":case"<alignment/>":case"<alignment>":var o={};a.vertical&&(o.vertical=a.vertical),a.horizontal&&(o.horizontal=a.horizontal),null!=a.textRotation&&(o.textRotation=a.textRotation),a.indent&&(o.indent=a.indent),a.wrapText&&(o.wrapText=parsexmlbool(a.wrapText)),n.alignment=o;break;case"<AlternateContent":case"<AlternateContent>":case"<ext":i=!0;break;case"</AlternateContent>":case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}}))}function write_cellXfs(e){var t=[];return t[t.length]=writextag("cellXfs",null),e.forEach((function(e){t[t.length]=writextag("xf",null,e)})),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=writextag("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var parse_sty_xml=function(){return function(e,t,r){var n,i={};return e?(e=remove_doctype(str_remove_ng(e,"\x3c!--","--\x3e")),(n=str_match_xml_ns(e,"numFmts"))&&parse_numFmts(n[0],i,r),(n=str_match_xml_ns(e,"fonts"))&&parse_fonts(n[0],i,t,r),(n=str_match_xml_ns(e,"fills"))&&parse_fills(n[0],i,t,r),(n=str_match_xml_ns(e,"borders"))&&parse_borders(n[0],i,t,r),(n=str_match_xml_ns(e,"cellXfs"))&&parse_cellXfs(n[0],i,r),i):i}}();function write_sty_xml(e,t){var r,n=[XML_HEADER,writextag("styleSheet",null,{xmlns:XMLNS_main[0],"xmlns:vt":XMLNS.vt})];return e.SSF&&null!=(r=write_numFmts(e.SSF))&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=write_cellXfs(t.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function parse_BrtFmt(e,t){return[e.read_shift(2),parse_XLWideString(e,t-2)]}function write_BrtFmt(e,t,r){r||(r=new_buf(6+4*t.length)),r.write_shift(2,e),write_XLWideString(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return null==r.l&&(r.l=r.length),n}function parse_BrtFont(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=parse_FontFlags(e,2,r);switch(i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1),700===e.read_shift(2)&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript"}var a=e.read_shift(1);0!=a&&(n.underline=a);var s=e.read_shift(1);s>0&&(n.family=s);var o=e.read_shift(1);switch(o>0&&(n.charset=o),e.l++,n.color=parse_BrtColor(e,8),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor"}return n.name=parse_XLWideString(e,t-21),n}function write_BrtFont(e,t){t||(t=new_buf(153)),t.write_shift(2,20*e.sz),write_FontFlags(e,t),t.write_shift(2,e.bold?700:400);var r=0;"superscript"==e.vertAlign?r=1:"subscript"==e.vertAlign&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),write_BrtColor(e.color,t);var n=0;return"major"==e.scheme&&(n=1),"minor"==e.scheme&&(n=2),t.write_shift(1,n),write_XLWideString(e.name,t),t.length>t.l?t.slice(0,t.l):t}var XLSBFillPTNames=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rev_XLSBFillPTNames,parse_BrtFill=parsenoop;function write_BrtFill(e,t){t||(t=new_buf(84)),rev_XLSBFillPTNames||(rev_XLSBFillPTNames=evert(XLSBFillPTNames));var r=rev_XLSBFillPTNames[e.patternType];null==r&&(r=40),t.write_shift(4,r);var n=0;if(40!=r)for(write_BrtColor({auto:1},t),write_BrtColor({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function parse_BrtXF(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function write_BrtXF(e,t,r){return r||(r=new_buf(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function write_Blxf(e,t){return t||(t=new_buf(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var parse_BrtBorder=parsenoop;function write_BrtBorder(e,t){return t||(t=new_buf(51)),t.write_shift(1,0),write_Blxf(null,t),write_Blxf(null,t),write_Blxf(null,t),write_Blxf(null,t),write_Blxf(null,t),t.length>t.l?t.slice(0,t.l):t}function write_BrtStyle(e,t){return t||(t=new_buf(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),write_XLNullableWideString(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function write_BrtBeginTableStyles(e,t,r){var n=new_buf(2052);return n.write_shift(4,e),write_XLNullableWideString(t,n),write_XLNullableWideString(r,n),n.length>n.l?n.slice(0,n.l):n}function parse_sty_bin(e,t,r){var n={NumberFmt:[]};for(var i in table_fmt)n.NumberFmt[i]=table_fmt[i];n.CellXf=[],n.Fonts=[];var a=[],s=!1;return recordhopper(e,(function(e,i,o){switch(o){case 44:n.NumberFmt[e[0]]=e[1],SSF__load(e[1],e[0]);break;case 43:n.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=rgb_tint(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==a[a.length-1]&&n.CellXf.push(e);break;case 35:s=!0;break;case 36:s=!1;break;case 37:a.push(o),s=!0;break;case 38:a.pop(),s=!1;break;default:if(i.T>0)a.push(o);else if(i.T<0)a.pop();else if(!s||r.WTF&&37!=a[a.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}})),n}function write_FMTS_bin(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach((function(e){for(var n=e[0];n<=e[1];++n)null!=t[n]&&++r})),0!=r&&(write_record(e,615,write_UInt32LE(r)),[[5,8],[23,26],[41,44],[50,392]].forEach((function(r){for(var n=r[0];n<=r[1];++n)null!=t[n]&&write_record(e,44,write_BrtFmt(n,t[n]))})),write_record(e,616))}}function write_FONTS_bin(e){write_record(e,611,write_UInt32LE(1)),write_record(e,43,write_BrtFont({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),write_record(e,612)}function write_FILLS_bin(e){write_record(e,603,write_UInt32LE(2)),write_record(e,45,write_BrtFill({patternType:"none"})),write_record(e,45,write_BrtFill({patternType:"gray125"})),write_record(e,604)}function write_BORDERS_bin(e){write_record(e,613,write_UInt32LE(1)),write_record(e,46,write_BrtBorder({})),write_record(e,614)}function write_CELLSTYLEXFS_bin(e){write_record(e,626,write_UInt32LE(1)),write_record(e,47,write_BrtXF({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),write_record(e,627)}function write_CELLXFS_bin(e,t){write_record(e,617,write_UInt32LE(t.length)),t.forEach((function(t){write_record(e,47,write_BrtXF(t,0))})),write_record(e,618)}function write_STYLES_bin(e){write_record(e,619,write_UInt32LE(1)),write_record(e,48,write_BrtStyle({xfId:0,builtinId:0,name:"Normal"})),write_record(e,620)}function write_DXFS_bin(e){write_record(e,505,write_UInt32LE(0)),write_record(e,506)}function write_TABLESTYLES_bin(e){write_record(e,508,write_BrtBeginTableStyles(0,"TableStyleMedium9","PivotStyleMedium4")),write_record(e,509)}function write_COLORPALETTE_bin(){}function write_sty_bin(e,t){var r=buf_array();return write_record(r,278),write_FMTS_bin(r,e.SSF),write_FONTS_bin(r,e),write_FILLS_bin(r,e),write_BORDERS_bin(r,e),write_CELLSTYLEXFS_bin(r,e),write_CELLXFS_bin(r,t.cellXfs),write_STYLES_bin(r,e),write_DXFS_bin(r,e),write_TABLESTYLES_bin(r,e),write_COLORPALETTE_bin(r,e),write_record(r,279),r.end()}var XLSXThemeClrScheme=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function parse_clrScheme(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(tagregex)||[]).forEach((function(e){var i=parsexmltag(e);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":case"</a:srgbClr>":case"</a:sysClr>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"</a:dk1>":case"</a:lt1>":case"<a:dk1>":case"<a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===i[0].charAt(1)?(t.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}}))}function parse_fontScheme(){}function parse_fmtScheme(){}function parse_themeElements(e,t,r){var n;if(t.themeElements={},!(n=str_match_xml(e,"a:clrScheme")))throw new Error("clrScheme not found in themeElements");if(parse_clrScheme(n,t,r),!(n=str_match_xml(e,"a:fontScheme")))throw new Error("fontScheme not found in themeElements");if(parse_fontScheme(n,t,r),!(n=str_match_xml(e,"a:fmtScheme")))throw new Error("fmtScheme not found in themeElements");parse_fmtScheme(n,t,r)}function parse_theme_xml(e,t){var r;e&&0!==e.length||(e=write_theme());var n={};if(!(r=str_match_xml(e,"a:themeElements")))throw new Error("themeElements not found in theme");return parse_themeElements(r[0],n,t),n.raw=e,n}function write_theme(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var r=[XML_HEADER];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',r[r.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',r[r.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',r[r.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',r[r.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function parse_Theme(e,t,r){var n=e.l+t;if(124226!==e.read_shift(4))if(r.cellStyles){var i,a=e.slice(e.l);e.l=n;try{i=zip_read(a,{type:"array"})}catch(e){return}var s=getzipstr(i,"theme/theme/theme1.xml",!0);if(s)return parse_theme_xml(s,r)}else e.l=n}function parse_ColorTheme(e){return e.read_shift(4)}function parse_FullColorExt(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=parse_IcvXF(e,4);break;case 2:t.xclrValue=parse_LongRGBA(e,4);break;case 3:t.xclrValue=parse_ColorTheme(e,4)}return e.l+=8,t}function parse_IcvXF(e,t){return parsenoop(e,t)}function parse_XFExtGradient(e,t){return parsenoop(e,t)}function parse_ExtProp(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=parse_FullColorExt(e,r);break;case 6:n[1]=parse_XFExtGradient(e,r);break;case 14:case 15:n[1]=e.read_shift(1===r?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function parse_XFExt(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),a=[];i-- >0;)a.push(parse_ExtProp(e,r-e.l));return{ixfe:n,ext:a}}function update_xfext(e,t){t.forEach((function(e){e[0]}))}function parse_BrtMdtinfo(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:parse_XLWideString(e,t-8)}}function write_BrtMdtinfo(e){var t=new_buf(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),write_XLWideString(e.name,t),t.slice(0,t.l)}function parse_BrtMdb(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function write_BrtMdb(e){var t=new_buf(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function write_BrtBeginEsfmd(e,t){var r=new_buf(8+2*t.length);return r.write_shift(4,e),write_XLWideString(t,r),r.slice(0,r.l)}function parse_BrtBeginEsmdb(e){return e.l+=4,0!=e.read_shift(4)}function write_BrtBeginEsmdb(e,t){var r=new_buf(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}function parse_xlmeta_bin(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],s=!1,o=2;return recordhopper(e,(function(e,t,r){switch(r){case 335:n.Types.push({name:e.name});break;case 51:e.forEach((function(e){1==o?n.Cell.push({type:n.Types[e[0]-1].name,index:e[1]}):0==o&&n.Value.push({type:n.Types[e[0]-1].name,index:e[1]})}));break;case 337:o=e?1:0;break;case 338:o=2;break;case 35:a.push(r),s=!0;break;case 36:a.pop(),s=!1;break;default:if(t.T);else if(!s||i.WTF&&35!=a[a.length-1])throw new Error("Unexpected record 0x"+r.toString(16))}})),n}function write_xlmeta_bin(){var e=buf_array();return write_record(e,332),write_record(e,334,write_UInt32LE(1)),write_record(e,335,write_BrtMdtinfo({name:"XLDAPR",version:12e4,flags:3496657072})),write_record(e,336),write_record(e,339,write_BrtBeginEsfmd(1,"XLDAPR")),write_record(e,52),write_record(e,35,write_UInt32LE(514)),write_record(e,4096,write_UInt32LE(0)),write_record(e,4097,writeuint16(1)),write_record(e,36),write_record(e,53),write_record(e,340),write_record(e,337,write_BrtBeginEsmdb(1,!0)),write_record(e,51,write_BrtMdb([[1,0]])),write_record(e,338),write_record(e,333),e.end()}function parse_xlmeta_xml(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i,a=!1,s=2;return e.replace(tagregex,(function(e){var t=parsexmltag(e);switch(strip_ns(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":n.Types.push({name:t.name});break;case"<futureMetadata":for(var o=0;o<n.Types.length;++o)n.Types[o].name==t.name&&(i=n.Types[o]);break;case"<rc":1==s?n.Cell.push({type:n.Types[t.t-1].name,index:+t.v}):0==s&&n.Value.push({type:n.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":s=1;break;case"</cellMetadata>":case"</valueMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+t.i);break;default:if(!a&&(null==r?void 0:r.WTF))throw new Error("unrecognized "+t[0]+" in metadata")}return e})),n}function write_xlmeta_xml(){var e=[XML_HEADER];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}function parse_cc_xml(e){var t=[];if(!e)return t;var r=1;return(e.match(tagregex)||[]).forEach((function(e){var n=parsexmltag(e);switch(n[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n)}})),t}function parse_BrtCalcChainItem$(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=encode_cell(r);var n=e.read_shift(1);return 2&n&&(t.l="1"),8&n&&(t.a="1"),t}function parse_cc_bin(e,t,r){var n=[];return recordhopper(e,(function(e,t,r){if(63===r)n.push(e);else if(!t.T)throw new Error("Unexpected record 0x"+r.toString(16))})),n}function parse_xlink_xml(){}function parse_xlink_bin(e,t,r,n){if(!e)return e;var i=n||{},a=!1;recordhopper(e,(function(e,t,r){switch(r){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(t.T);else if(!a||i.WTF)throw new Error("Unexpected record 0x"+r.toString(16))}}),i)}function parse_drawing(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^<>]*r:id="([^<>"]*)"/)||["",""])[1];return t["!id"][r].Target}function parse_vml(e,t,r){var n=0;(str_match_xml_ns_g(e,"shape")||[]).forEach((function(e){var i="",a=!0,s=-1,o=-1,l=-1;if(e.replace(tagregex,(function(t,r){var n=parsexmltag(t);switch(strip_ns(n[0])){case"<ClientData":n.ObjectType&&(i=n.ObjectType);break;case"<Visible":case"<Visible/>":a=!1;break;case"<Row":case"<Row>":case"<Column":case"<Column>":s=r+t.length;break;case"</Row>":o=+e.slice(s,r).trim();break;case"</Column>":l=+e.slice(s,r).trim()}return""})),"Note"===i){var c=ws_get_cell_stub(t,o>=0&&l>=0?encode_cell({r:o,c:l}):r[n].ref);c.c&&(c.c.hidden=a),++n}}))}function write_vml(e,t,r){var n=[21600,21600],i=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),a=[writextag("xml",null,{"xmlns:v":XLMLNS.v,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:mv":XLMLNS.mv}).replace(/\/>/,">"),writextag("o:shapelayout",writextag("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"})],s=65536*e,o=t||[];return o.length>0&&a.push(writextag("v:shapetype",[writextag("v:stroke",null,{joinstyle:"miter"}),writextag("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:n.join(","),"o:spt":202,path:i})),o.forEach((function(e){++s,a.push(write_vml_comment(e,s))})),a.push("</xml>"),a.join("")}function write_vml_comment(e,t,r){var n=decode_cell(e[0]),i={color2:"#BEFF82",type:"gradient"};"gradient"==i.type&&(i.angle="-180");var a="gradient"==i.type?writextag("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,s=writextag("v:fill",a,i);return["<v:shape"+wxt_helper({id:"_x0000_s"+t,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",s,writextag("v:shadow",null,{on:"t",obscured:"t"}),writextag("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",writetag("x:Anchor",[n.c+1,0,n.r+1,0,n.c+3,20,n.r+5,20].join(",")),writetag("x:AutoFill","False"),writetag("x:Row",String(n.r)),writetag("x:Column",String(n.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function sheet_insert_comments(e,t,r,n){var i,a=null!=e["!data"];t.forEach((function(t){var s=decode_cell(t.ref);if(!(s.r<0||s.c<0)){if(a?(e["!data"][s.r]||(e["!data"][s.r]=[]),i=e["!data"][s.r][s.c]):i=e[t.ref],!i){i={t:"z"},a?e["!data"][s.r][s.c]=i:e[t.ref]=i;var o=safe_decode_range(e["!ref"]||"BDWGO1000001:A1");o.s.r>s.r&&(o.s.r=s.r),o.e.r<s.r&&(o.e.r=s.r),o.s.c>s.c&&(o.s.c=s.c),o.e.c<s.c&&(o.e.c=s.c);var l=encode_range(o);e["!ref"]=l}i.c||(i.c=[]);var c={a:t.author,t:t.t,r:t.r,T:r};t.h&&(c.h=t.h);for(var d=i.c.length-1;d>=0;--d){if(!r&&i.c[d].T)return;r&&!i.c[d].T&&i.c.splice(d,1)}if(r&&n)for(d=0;d<n.length;++d)if(c.a==n[d].id){c.a=n[d].name||c.a;break}i.c.push(c)}}))}function parse_comments_xml(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=str_match_xml_ns(e,"authors");i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach((function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^<>]*>(.*)/);t&&r.push(t[1])}}));var a=str_match_xml_ns(e,"commentList");return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach((function(e){if(""!==e&&""!==e.trim()){var i=e.match(/<(?:\w+:)?comment[^<>]*>/);if(i){var a=parsexmltag(i[0]),s={author:a.authorId&&r[a.authorId]||"sheetjsghost",ref:a.ref,guid:a.guid},o=decode_cell(a.ref);if(!(t.sheetRows&&t.sheetRows<=o.r)){var l=str_match_xml_ns(e,"text"),c=!!l&&!!l[1]&&parse_si(l[1])||{r:"",t:"",h:""};s.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),s.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(s.h=c.h),n.push(s)}}}})),n}function write_comments_xml(e){var t=[XML_HEADER,writextag("comments",null,{xmlns:XMLNS_main[0]})],r=[];return t.push("<authors>"),e.forEach((function(e){e[1].forEach((function(e){var n=escapexml(e.a);-1==r.indexOf(n)&&(r.push(n),t.push("<author>"+n+"</author>")),e.T&&e.ID&&-1==r.indexOf("tc="+e.ID)&&(r.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))}))})),0==r.length&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach((function(e){var n=0,i=[],a=0;if(e[1][0]&&e[1][0].T&&e[1][0].ID&&(n=r.indexOf("tc="+e[1][0].ID)),e[1].forEach((function(e){e.a&&(n=r.indexOf(escapexml(e.a))),e.T&&++a,i.push(null==e.t?"":escapexml(e.t))})),0===a)e[1].forEach((function(n){t.push('<comment ref="'+e[0]+'" authorId="'+r.indexOf(escapexml(n.a))+'"><text>'),t.push(writetag("t",null==n.t?"":escapexml(n.t))),t.push("</text></comment>")}));else{e[1][0]&&e[1][0].T&&e[1][0].ID&&(n=r.indexOf("tc="+e[1][0].ID)),t.push('<comment ref="'+e[0]+'" authorId="'+n+'"><text>');for(var s="Comment:\n    "+i[0]+"\n",o=1;o<i.length;++o)s+="Reply:\n    "+i[o]+"\n";t.push(writetag("t",escapexml(s))),t.push("</text></comment>")}})),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function parse_tcmnt_xml(e,t){var r=[],n=!1,i={},a=0;return e.replace(tagregex,(function(s,o){var l=parsexmltag(s);switch(strip_ns(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":i={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=i.t&&r.push(i);break;case"<text>":case"<text":a=o+s.length;break;case"</text>":i.t=e.slice(a,o).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":n=!0;break;case"</mentions>":case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s})),r}function write_tcmnt_xml(e,t,r){var n=[XML_HEADER,writextag("ThreadedComments",null,{xmlns:XMLNS.TCMNT}).replace(/[\/]>/,">")];return e.forEach((function(e){var i="";(e[1]||[]).forEach((function(a,s){if(a.T){a.a&&-1==t.indexOf(a.a)&&t.push(a.a);var o={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};0==s?i=o.id:o.parentId=i,a.ID=o.id,a.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(writextag("threadedComment",writetag("text",a.t||""),o))}else delete a.ID}))})),n.push("</ThreadedComments>"),n.join("")}function parse_people_xml(e,t){var r=[],n=!1;return e.replace(tagregex,(function(e){var i=parsexmltag(e);switch(strip_ns(i[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return e})),r}function write_people_xml(e){var t=[XML_HEADER,writextag("personList",null,{xmlns:XMLNS.TCMNT,"xmlns:x":XMLNS_main[0]}).replace(/[\/]>/,">")];return e.forEach((function(e,r){t.push(writextag("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:e,providerId:"None"}))})),t.push("</personList>"),t.join("")}function parse_BrtBeginComment(e){var t={};t.iauthor=e.read_shift(4);var r=parse_UncheckedRfX(e,16);return t.rfx=r.s,t.ref=encode_cell(r.s),e.l+=16,t}function write_BrtBeginComment(e,t){return null==t&&(t=new_buf(36)),t.write_shift(4,e[1].iauthor),write_UncheckedRfX(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var parse_BrtCommentAuthor=parse_XLWideString;function write_BrtCommentAuthor(e){return write_XLWideString(e.slice(0,54))}function parse_comments_bin(e,t){var r=[],n=[],i={},a=!1;return recordhopper(e,(function(e,s,o){switch(o){case 632:n.push(e);break;case 635:i=e;break;case 637:i.t=e.t,i.h=e.h,i.r=e.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:case 37:case 38:break;case 35:a=!0;break;case 36:a=!1;break;default:if(s.T);else if(!a||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}})),r}function write_comments_bin(e){var t=buf_array(),r=[];return write_record(t,628),write_record(t,630),e.forEach((function(e){e[1].forEach((function(e){r.indexOf(e.a)>-1||(r.push(e.a.slice(0,54)),write_record(t,632,write_BrtCommentAuthor(e.a)),e.T&&e.ID&&-1==r.indexOf("tc="+e.ID)&&(r.push("tc="+e.ID),write_record(t,632,write_BrtCommentAuthor("tc="+e.ID))))}))})),write_record(t,631),write_record(t,633),e.forEach((function(e){e[1].forEach((function(n){var i=-1;n.ID&&(i=r.indexOf("tc="+n.ID)),-1==i&&e[1][0].T&&e[1][0].ID&&(i=r.indexOf("tc="+e[1][0].ID)),-1==i&&(i=r.indexOf(n.a)),n.iauthor=i;var a={s:decode_cell(e[0]),e:decode_cell(e[0])};write_record(t,635,write_BrtBeginComment([a,n])),n.t&&n.t.length>0&&write_record(t,637,write_BrtCommentText(n)),write_record(t,636),delete n.iauthor}))})),write_record(t,634),write_record(t,629),t.end()}var CT_VBA="application/vnd.ms-office.vbaProject";function make_vba_xls(e){var t=CFB.utils.cfb_new({root:"R"});return e.FullPaths.forEach((function(r,n){if("/"!==r.slice(-1)&&r.match(/_VBA_PROJECT_CUR/)){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");CFB.utils.cfb_add(t,i,e.FileIndex[n].content)}})),CFB.write(t)}function fill_vba_xls(e,t){t.FullPaths.forEach((function(r,n){if(0!=n){var i=r.replace(/^[\/]*[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==i.slice(-1)&&CFB.utils.cfb_add(e,i,t.FileIndex[n].content)}}))}var VBAFMTS=["xlsb","xlsm","xlam","biff8","xla"];function parse_ds_bin(){return{"!type":"dialog"}}function parse_ds_xml(){return{"!type":"dialog"}}function parse_ms_bin(){return{"!type":"macro"}}function parse_ms_xml(){return{"!type":"macro"}}var rc_to_a1=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(e,r,n,i){var a=!1,s=!1;0==n.length?s=!0:"["==n.charAt(0)&&(s=!0,n=n.slice(1,-1)),0==i.length?a=!0:"["==i.charAt(0)&&(a=!0,i=i.slice(1,-1));var o=n.length>0?0|parseInt(n,10):0,l=i.length>0?0|parseInt(i,10):0;return a?l+=t.c:--l,s?o+=t.r:--o,r+(a?"":"$")+encode_col(l)+(s?"":"$")+encode_row(o)}return function(n,i){return t=i,n.replace(e,r)}}(),crefregex=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{crefregex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch(e){}var a1_to_rc=function(){return function(e,t){return e.replace(crefregex,(function(e,r,n,i,a,s){var o=decode_col(i)-(n?0:t.c),l=decode_row(s)-(a?0:t.r);return r+"R"+("$"==a?l+1:0==l?"":"["+l+"]")+"C"+("$"==n?o+1:0==o?"":"["+o+"]")}))}}();function shift_formula_str(e,t){return e.replace(crefregex,(function(e,r,n,i,a,s){return r+("$"==n?n+i:encode_col(decode_col(i)+t.c))+("$"==a?a+s:encode_row(decode_row(s)+t.r))}))}function shift_formula_xlsx(e,t,r){var n=decode_range(t).s,i=decode_cell(r);return shift_formula_str(e,{r:i.r-n.r,c:i.c-n.c})}function fuzzyfmla(e){return 1!=e.length}function _xlfn(e){return e.replace(/_xlfn\./g,"")}function parseread1(e){e.l+=1}function parse_ColRelU(e,t){var r=e.read_shift(1==t?1:2);return[16383&r,r>>14&1,r>>15&1]}function parse_RgceArea(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return parse_RgceArea_BIFF2(e,t,r);12==r.biff&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),s=parse_ColRelU(e,2),o=parse_ColRelU(e,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function parse_RgceArea_BIFF2(e){var t=parse_ColRelU(e,2),r=parse_ColRelU(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function parse_RgceAreaRel(e,t,r){if(r.biff<8)return parse_RgceArea_BIFF2(e,t,r);var n=e.read_shift(12==r.biff?4:2),i=e.read_shift(12==r.biff?4:2),a=parse_ColRelU(e,2),s=parse_ColRelU(e,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function parse_RgceLoc(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return parse_RgceLoc_BIFF2(e,t,r);var n=e.read_shift(r&&12==r.biff?4:2),i=parse_ColRelU(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function parse_RgceLoc_BIFF2(e){var t=parse_ColRelU(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function parse_RgceElfLoc(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:255&r,fQuoted:!!(16384&r),cRel:r>>15,rRel:r>>15}}function parse_RgceLocRel(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return parse_RgceLocRel_BIFF2(e,t,r);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),s=(16384&a)>>14,o=(32768&a)>>15;if(a&=16383,1==o)for(;i>524287;)i-=1048576;if(1==s)for(;a>8191;)a-=16384;return{r:i,c:a,cRel:s,rRel:o}}function parse_RgceLocRel_BIFF2(e){var t=e.read_shift(2),r=e.read_shift(1),n=(32768&t)>>15,i=(16384&t)>>14;return t&=16383,1==n&&t>=8192&&(t-=16384),1==i&&r>=128&&(r-=256),{r:t,c:r,cRel:i,rRel:n}}function parse_PtgArea(e,t,r){return[(96&e[e.l++])>>5,parse_RgceArea(e,r.biff>=2&&r.biff<=5?6:8,r)]}function parse_PtgArea3d(e,t,r){var n=(96&e[e.l++])>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12}return[n,i,parse_RgceArea(e,a,r)]}function parse_PtgAreaErr(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function parse_PtgAreaErr3d(e,t,r){var n=(96&e[e.l++])>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12}return e.l+=a,[n,i]}function parse_PtgAreaN(e,t,r){return[(96&e[e.l++])>>5,parse_RgceAreaRel(e,t-1,r)]}function parse_PtgArray(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[n]}function parse_PtgAttrBaxcel(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function parse_PtgAttrChoose(e,t,r){e.l+=2;for(var n=e.read_shift(r&&2==r.biff?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&2==r.biff?1:2));return i}function parse_PtgAttrGoto(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}function parse_PtgAttrIf(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}function parse_PtgAttrIfError(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}function parse_PtgAttrSemi(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[n]}function parse_PtgAttrSpaceType(e){return[e.read_shift(1),e.read_shift(1)]}function parse_PtgAttrSpace(e){return e.read_shift(2),parse_PtgAttrSpaceType(e,2)}function parse_PtgAttrSpaceSemi(e){return e.read_shift(2),parse_PtgAttrSpaceType(e,2)}function parse_PtgRef(e,t,r){var n=(96&e[e.l])>>5;return e.l+=1,[n,parse_RgceLoc(e,0,r)]}function parse_PtgRefN(e,t,r){var n=(96&e[e.l])>>5;return e.l+=1,[n,parse_RgceLocRel(e,0,r)]}function parse_PtgRef3d(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var i=e.read_shift(2);return r&&5==r.biff&&(e.l+=12),[n,i,parse_RgceLoc(e,0,r)]}function parse_PtgFunc(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[FtabArgc[i],Ftab[i],n]}function parse_PtgFuncVar(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[88==n?-1:0,e.read_shift(1)]:parsetab(e);return[i,(0===a[0]?Ftab:Cetab)[a[1]]]}function parsetab(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}function parse_PtgAttrSum(e,t,r){e.l+=r&&2==r.biff?3:4}function parse_PtgExp(e,t,r){return e.l++,r&&12==r.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(r&&2==r.biff?1:2)]}function parse_PtgErr(e){return e.l++,BErr[e.read_shift(1)]}function parse_PtgInt(e){return e.l++,e.read_shift(2)}function parse_PtgBool(e){return e.l++,0!==e.read_shift(1)}function parse_PtgNum(e){return e.l++,parse_Xnum(e,8)}function parse_PtgStr(e,t,r){return e.l++,parse_ShortXLUnicodeString(e,t-1,r)}function parse_SerAr(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=parsebool(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=BErr[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=parse_Xnum(e,8);break;case 2:r[1]=parse_XLUnicodeString2(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function parse_PtgExtraMem(e,t,r){for(var n=e.read_shift(12==r.biff?4:2),i=[],a=0;a!=n;++a)i.push((12==r.biff?parse_UncheckedRfX:parse_Ref8U)(e,8));return i}function parse_PtgExtraArray(e,t,r){var n=0,i=0;12==r.biff?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,0==--i&&(i=256));for(var a=0,s=[];a!=n&&(s[a]=[]);++a)for(var o=0;o!=i;++o)s[a][o]=parse_SerAr(e,r.biff);return s}function parse_PtgName(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[n,0,a]}function parse_PtgNameX(e,t,r){return 5==r.biff?parse_PtgNameX_BIFF5(e,t,r):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}function parse_PtgNameX_BIFF5(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function parse_PtgMemArea(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[n,e.read_shift(r&&2==r.biff?1:2)]}function parse_PtgMemFunc(e,t,r){return[e.read_shift(1)>>>5&3,e.read_shift(r&&2==r.biff?1:2)]}function parse_PtgRefErr(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[n]}function parse_PtgRefErr3d(e,t,r){var n=(96&e[e.l++])>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6}return e.l+=a,[n,i]}var parse_PtgMemErr=parsenoop,parse_PtgMemNoMem=parsenoop,parse_PtgTbl=parsenoop;function parse_PtgElfLoc(e,t,r){return e.l+=2,[parse_RgceElfLoc(e,4,r)]}function parse_PtgElfNoop(e){return e.l+=6,[]}var parse_PtgElfCol=parse_PtgElfLoc,parse_PtgElfColS=parse_PtgElfNoop,parse_PtgElfColSV=parse_PtgElfNoop,parse_PtgElfColV=parse_PtgElfLoc;function parse_PtgElfLel(e){return e.l+=2,[parseuint16(e),1&e.read_shift(2)]}var parse_PtgElfRadical=parse_PtgElfLoc,parse_PtgElfRadicalLel=parse_PtgElfLel,parse_PtgElfRadicalS=parse_PtgElfNoop,parse_PtgElfRw=parse_PtgElfLoc,parse_PtgElfRwV=parse_PtgElfLoc,PtgListRT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function parse_PtgList(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2);return{ixti:t,coltype:3&r,rt:PtgListRT[r>>2&31],idx:n,c:i,C:a}}function parse_PtgSxName(e){return e.l+=2,[e.read_shift(4)]}function parse_PtgSheet(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}function parse_PtgEndSheet(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}function parse_PtgMemAreaN(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}function parse_PtgMemNoMemN(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}function parse_PtgAttrNoop(e){return e.l+=4,[0,0]}var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parseread1},4:{n:"PtgSub",f:parseread1},5:{n:"PtgMul",f:parseread1},6:{n:"PtgDiv",f:parseread1},7:{n:"PtgPower",f:parseread1},8:{n:"PtgConcat",f:parseread1},9:{n:"PtgLt",f:parseread1},10:{n:"PtgLe",f:parseread1},11:{n:"PtgEq",f:parseread1},12:{n:"PtgGe",f:parseread1},13:{n:"PtgGt",f:parseread1},14:{n:"PtgNe",f:parseread1},15:{n:"PtgIsect",f:parseread1},16:{n:"PtgUnion",f:parseread1},17:{n:"PtgRange",f:parseread1},18:{n:"PtgUplus",f:parseread1},19:{n:"PtgUminus",f:parseread1},20:{n:"PtgPercent",f:parseread1},21:{n:"PtgParen",f:parseread1},22:{n:"PtgMissArg",f:parseread1},23:{n:"PtgStr",f:parse_PtgStr},26:{n:"PtgSheet",f:parse_PtgSheet},27:{n:"PtgEndSheet",f:parse_PtgEndSheet},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},46:{n:"PtgMemAreaN",f:parse_PtgMemAreaN},47:{n:"PtgMemNoMemN",f:parse_PtgMemNoMemN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}},PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ptg18={1:{n:"PtgElfLel",f:parse_PtgElfLel},2:{n:"PtgElfRw",f:parse_PtgElfRw},3:{n:"PtgElfCol",f:parse_PtgElfCol},6:{n:"PtgElfRwV",f:parse_PtgElfRwV},7:{n:"PtgElfColV",f:parse_PtgElfColV},10:{n:"PtgElfRadical",f:parse_PtgElfRadical},11:{n:"PtgElfRadicalS",f:parse_PtgElfRadicalS},13:{n:"PtgElfColS",f:parse_PtgElfColS},15:{n:"PtgElfColSV",f:parse_PtgElfColSV},16:{n:"PtgElfRadicalLel",f:parse_PtgElfRadicalLel},25:{n:"PtgList",f:parse_PtgList},29:{n:"PtgSxName",f:parse_PtgSxName},255:{}},Ptg19={0:{n:"PtgAttrNoop",f:parse_PtgAttrNoop},1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},33:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},128:{n:"PtgAttrIfError",f:parse_PtgAttrIfError},255:{}};function parse_RgbExtra(e,t,r,n){if(n.biff<8)return parsenoop(e,t);for(var i=e.l+t,a=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=parse_PtgExtraArray(e,0,n),a.push(r[s][1]);break;case"PtgMemArea":r[s][2]=parse_PtgExtraMem(e,r[s][1],n),a.push(r[s][2]);break;case"PtgExp":n&&12==n.biff&&(r[s][1][1]=e.read_shift(4),a.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return 0!=(t=i-e.l)&&a.push(parsenoop(e,t)),a}function parse_Rgce(e,t,r){for(var n,i,a=e.l+t,s=[];a!=e.l;)t=a-e.l,i=e[e.l],n=PtgTypes[i]||PtgTypes[PtgDupes[i]],24!==i&&25!==i||(n=(24===i?Ptg18:Ptg19)[e[e.l+1]]),n&&n.f?s.push([n.n,n.f(e,t,r)]):parsenoop(e,t);return s}function stringify_array(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var s=n[a];s?2===s[0]?i.push('"'+s[1].replace(/"/g,'""')+'"'):i.push(s[1]):i.push("")}t.push(i.join(","))}return t.join(";")}var PtgBinOp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function make_3d_range(e,t){var r=e.lastIndexOf("!"),n=t.lastIndexOf("!");return-1==r&&-1==n?e+":"+t:r>0&&n>0&&e.slice(0,r).toLowerCase()==t.slice(0,n).toLowerCase()?e+":"+t.slice(n+1):(console.error("Cannot hydrate range",e,t),e+":"+t)}function get_ixti_raw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=-1==n[1]?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return null!=r.SID?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=-1==n[1]?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[n[0]][0][3]?(i=-1==n[1]?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function get_ixti(e,t,r){var n=get_ixti_raw(e,t,r);return"#REF"==n?n:formula_quote_sheet_name(n,r)}function stringify_formula(e,t,r,n,i){var a,s,o,l,c=i&&i.biff||8,d={s:{c:0,r:0},e:{c:0,r:0}},u=[],p=0,h=0,f="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",_=0,b=e[0].length;_<b;++_){var v=e[0][_];switch(v[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(a=u.pop(),s=u.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=fill(" ",e[0][m][1][1]);break;case 1:g=fill("\r",e[0][m][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}s+=g,m=-1}u.push(s+PtgBinOp[v[0]]+a);break;case"PtgIsect":a=u.pop(),s=u.pop(),u.push(s+" "+a);break;case"PtgUnion":a=u.pop(),s=u.pop(),u.push(s+","+a);break;case"PtgRange":a=u.pop(),s=u.pop(),u.push(make_3d_range(s,a));break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=shift_cell_xls(v[1][1],d,i),u.push(encode_cell_xls(o,c));break;case"PtgRefN":o=r?shift_cell_xls(v[1][1],r,i):v[1][1],u.push(encode_cell_xls(o,c));break;case"PtgRef3d":p=v[1][1],o=shift_cell_xls(v[1][2],d,i),f=get_ixti(n,p,i),u.push(f+"!"+encode_cell_xls(o,c));break;case"PtgFunc":case"PtgFuncVar":var y=v[1][0],w=v[1][1];y||(y=0);var E=0==(y&=127)?[]:u.slice(-y);u.length-=y,"User"===w&&(w=E.shift()),u.push(w+"("+E.join(",")+")");break;case"PtgBool":u.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":u.push(v[1]);break;case"PtgNum":u.push(String(v[1]));break;case"PtgStr":u.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=shift_range_xls(v[1][1],r?{s:r}:d,i),u.push(encode_range_xls(l,i));break;case"PtgArea":l=shift_range_xls(v[1][1],d,i),u.push(encode_range_xls(l,i));break;case"PtgArea3d":p=v[1][1],l=v[1][2],f=get_ixti(n,p,i),u.push(f+"!"+encode_range_xls(l,i));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgName":h=v[1][2];var S=(n.names||[])[h-1]||(n[0]||[])[h],T=S?S.Name:"SH33TJSNAME"+String(h);T&&"_xlfn."==T.slice(0,6)&&!i.xlfn&&(T=T.slice(6)),u.push(T);break;case"PtgNameX":var C,x=v[1][1];if(h=v[1][2],!(i.biff<=5)){var A="";if(14849==((n[x]||[])[0]||[])[0]||(1025==((n[x]||[])[0]||[])[0]?n[x][h]&&n[x][h].itab>0&&(A=n.SheetNames[n[x][h].itab-1]+"!"):A=n.SheetNames[h-1]+"!"),n[x]&&n[x][h])A+=n[x][h].Name;else if(n[0]&&n[0][h])A+=n[0][h].Name;else{var I=(get_ixti_raw(n,x,i)||"").split(";;");I[h-1]?A=I[h-1]:A+="SH33TJSERRX"}u.push(A);break}x<0&&(x=-x),n[x]&&(C=n[x][h]),C||(C={Name:"SH33TJSERRY"}),u.push(C.Name);break;case"PtgParen":var D="(",k=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:D=fill(" ",e[0][m][1][1])+D;break;case 3:D=fill("\r",e[0][m][1][1])+D;break;case 4:k=fill(" ",e[0][m][1][1])+k;break;case 5:k=fill("\r",e[0][m][1][1])+k;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}u.push(D+u.pop()+k);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":u.push("#REF!");break;case"PtgExp":o={c:v[1][1],r:v[1][0]};var L={c:r.c,r:r.r};if(n.sharedf[encode_cell(o)]){var P=n.sharedf[encode_cell(o)];u.push(stringify_formula(P,d,L,n,i))}else{var O=!1;for(a=0;a!=n.arrayf.length;++a)if(s=n.arrayf[a],!(o.c<s[0].s.c||o.c>s[0].e.c||o.r<s[0].s.r||o.r>s[0].e.r)){u.push(stringify_formula(s[1],d,L,n,i)),O=!0;break}O||u.push(v[1])}break;case"PtgArray":u.push("{"+stringify_array(v[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=_;break;case"PtgMissArg":u.push("");break;case"PtgList":u.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(v))}if(3!=i.biff&&m>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][_][0])){var R=!0;switch((v=e[0][m])[1][0]){case 4:R=!1;case 0:g=fill(" ",v[1][1]);break;case 5:R=!1;case 1:g=fill("\r",v[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}u.push((R?g:"")+u.pop()+(R?"":g)),m=-1}}if(u.length>1&&i.WTF)throw new Error("bad formula stack");return"TRUE"==u[0]||"FALSE"!=u[0]&&u[0]}function parse_ArrayParsedFormula(e,t,r){var n,i=e.l+t,a=2==r.biff?1:2,s=e.read_shift(a);if(65535==s)return[[],parsenoop(e,t-2)];var o=parse_Rgce(e,s,r);return t!==s+a&&(n=parse_RgbExtra(e,t-s-a,o,r)),e.l=i,[o,n]}function parse_XLSCellParsedFormula(e,t,r){var n,i=e.l+t,a=2==r.biff?1:2,s=e.read_shift(a);if(65535==s)return[[],parsenoop(e,t-2)];var o=parse_Rgce(e,s,r);return t!==s+a&&(n=parse_RgbExtra(e,t-s-a,o,r)),e.l=i,[o,n]}function parse_NameParsedFormula(e,t,r,n){var i,a=e.l+t,s=parse_Rgce(e,n,r);return a!==e.l&&(i=parse_RgbExtra(e,a-e.l,s,r)),[s,i]}function parse_SharedParsedFormula(e,t,r){var n,i=e.l+t,a=e.read_shift(2),s=parse_Rgce(e,a,r);return 65535==a?[[],parsenoop(e,t-2)]:(t!==a+2&&(n=parse_RgbExtra(e,i-a-2,s,r)),[s,n])}function parse_FormulaValue(e){var t;if(65535!==__readUInt16LE(e,e.l+6))return[parse_Xnum(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function write_FormulaValue(e){if(null==e){var t=new_buf(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return write_Xnum("number"==typeof e?e:0)}function parse_Formula(e,t,r){var n=e.l+t,i=parse_XLSCell(e,6,r),a=parse_FormulaValue(e,8),s=e.read_shift(1);2!=r.biff&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=parse_XLSCellParsedFormula(e,n-e.l,r);return{cell:i,val:a[0],formula:o,shared:s>>3&1,tt:a[1]}}function write_Formula(e,t,r,n,i){var a=write_XLSCell(t,r,i),s=write_FormulaValue(e.v),o=new_buf(6);o.write_shift(2,33),o.write_shift(4,0);for(var l=new_buf(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return bconcat([a,s,o,l])}function parse_XLSBParsedFormula(e,t,r){var n=e.read_shift(4),i=parse_Rgce(e,n,r),a=e.read_shift(4);return[i,a>0?parse_RgbExtra(e,a,i,r):null]}var parse_XLSBArrayParsedFormula=parse_XLSBParsedFormula,parse_XLSBCellParsedFormula=parse_XLSBParsedFormula,parse_XLSBNameParsedFormula=parse_XLSBParsedFormula,parse_XLSBSharedParsedFormula=parse_XLSBParsedFormula;function write_XLSBFormulaNum(e){if((0|e)==e&&e<Math.pow(2,16)&&e>=0){var t=new_buf(11);return t.write_shift(4,3),t.write_shift(1,30),t.write_shift(2,e),t.write_shift(4,0),t}var r=new_buf(17);return r.write_shift(4,11),r.write_shift(1,31),r.write_shift(8,e),r.write_shift(4,0),r}function write_XLSBFormulaErr(e){var t=new_buf(10);return t.write_shift(4,2),t.write_shift(1,28),t.write_shift(1,e),t.write_shift(4,0),t}function write_XLSBFormulaBool(e){var t=new_buf(10);return t.write_shift(4,2),t.write_shift(1,29),t.write_shift(1,e?1:0),t.write_shift(4,0),t}function write_XLSBFormulaStr(e){var t=new_buf(7);t.write_shift(4,3+2*e.length),t.write_shift(1,23),t.write_shift(2,e.length);var r=new_buf(2*e.length);r.write_shift(2*e.length,e,"utf16le");var n=new_buf(4);return n.write_shift(4,0),bconcat([t,r,n])}function write_XLSBFormulaRef(e){var t=decode_cell(e),r=new_buf(15);return r.write_shift(4,7),r.write_shift(1,36),r.write_shift(4,t.r),r.write_shift(2,t.c|("$"==e.charAt(0)?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),r.write_shift(4,0),r}function write_XLSBFormulaRef3D(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r),i=decode_cell(e=e.slice(r+1));"'"==n.charAt(0)&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=new_buf(17);return a.write_shift(4,9),a.write_shift(1,58),a.write_shift(2,2+t.SheetNames.map((function(e){return e.toLowerCase()})).indexOf(n.toLowerCase())),a.write_shift(4,i.r),a.write_shift(2,i.c|("$"==e.charAt(0)?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),a.write_shift(4,0),a}function write_XLSBFormulaRefErr3D(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),"'"==n.charAt(0)&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=new_buf(17);return i.write_shift(4,9),i.write_shift(1,60),i.write_shift(2,2+t.SheetNames.map((function(e){return e.toLowerCase()})).indexOf(n.toLowerCase())),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(4,0),i}function write_XLSBFormulaRange(e){var t=e.split(":"),r=t[0],n=new_buf(23);n.write_shift(4,15);var i=decode_cell(r=t[0]);return n.write_shift(1,36),n.write_shift(4,i.r),n.write_shift(2,i.c|("$"==r.charAt(0)?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),i=decode_cell(r=t[1]),n.write_shift(1,36),n.write_shift(4,i.r),n.write_shift(2,i.c|("$"==r.charAt(0)?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),n.write_shift(1,17),n.write_shift(4,0),n}function write_XLSBFormulaRangeWS(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),"'"==n.charAt(0)&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=e.split(":"),a=new_buf(27);a.write_shift(4,19);var s=i[0],o=decode_cell(s);return a.write_shift(1,58),a.write_shift(2,2+t.SheetNames.map((function(e){return e.toLowerCase()})).indexOf(n.toLowerCase())),a.write_shift(4,o.r),a.write_shift(2,o.c|("$"==s.charAt(0)?0:1)<<14|(s.match(/\$\d/)?0:1)<<15),o=decode_cell(s=i[1]),a.write_shift(1,58),a.write_shift(2,2+t.SheetNames.map((function(e){return e.toLowerCase()})).indexOf(n.toLowerCase())),a.write_shift(4,o.r),a.write_shift(2,o.c|("$"==s.charAt(0)?0:1)<<14|(s.match(/\$\d/)?0:1)<<15),a.write_shift(1,17),a.write_shift(4,0),a}function write_XLSBFormulaArea3D(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),"'"==n.charAt(0)&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=decode_range(e),a=new_buf(23);return a.write_shift(4,15),a.write_shift(1,59),a.write_shift(2,2+t.SheetNames.map((function(e){return e.toLowerCase()})).indexOf(n.toLowerCase())),a.write_shift(4,i.s.r),a.write_shift(4,i.e.r),a.write_shift(2,i.s.c),a.write_shift(2,i.e.c),a.write_shift(4,0),a}function write_XLSBFormula(e,t){if("number"==typeof e)return write_XLSBFormulaNum(e);if("boolean"==typeof e)return write_XLSBFormulaBool(e);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(e))return write_XLSBFormulaErr(+RBErr[e]);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return write_XLSBFormulaRef(e);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return write_XLSBFormulaRange(e);if(e.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return write_XLSBFormulaArea3D(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return write_XLSBFormulaRef3D(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return write_XLSBFormulaRangeWS(e,t);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(e))return write_XLSBFormulaRefErr3D(e,t);if(/^".*"$/.test(e))return write_XLSBFormulaStr(e);if(/^[+-]\d+$/.test(e))return write_XLSBFormulaNum(parseInt(e,10));throw"Formula |"+e+"| not supported for XLSB"}var write_XLSBNameParsedFormula=write_XLSBFormula,Cetab={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ftab={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FtabArgc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ods_to_csf_formula(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,(function(e,t){return t.replace(/\./g,"")}))).replace(/\$'([^']|'')+'/g,(function(e){return e.slice(1)}))).replace(/\$([^\]\. #$]+)/g,(function(e,t){return t.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?e:t}))).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function csf_to_ods_formula(e){return("of:="+e.replace(crefregex,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function ods_to_csf_3D(e){var t=(e=(e=e.replace(/\$'([^']|'')+'/g,(function(e){return e.slice(1)}))).replace(/\$([^\]\. #$]+)/g,(function(e,t){return t.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?e:t}))).split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function csf_to_ods_3D(e){return e.replace(/!/,".").replace(/:/,":.")}var strs={},_ssfopts={},browser_has_Map="undefined"!=typeof Map;function get_sst_id(e,t,r){var n=0,i=e.length;if(r){if(browser_has_Map?r.has(t):Object.prototype.hasOwnProperty.call(r,t))for(var a=browser_has_Map?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(browser_has_Map?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function col_obj_w(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(MDW=t.MDW),null!=t.width?r.customWidth=1:null!=t.wpx?n=px2char(t.wpx):null!=t.wch&&(n=t.wch),n>-1?(r.width=char2width(n),r.customWidth=1):null!=t.width&&(r.width=t.width),t.hidden&&(r.hidden=!0),null!=t.level&&(r.outlineLevel=r.level=t.level),r}function default_margins(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function get_cell_style(e,t,r){var n=r.revssf[null!=t.z?t.z:"General"],i=60,a=e.length;if(null==n&&r.ssf)for(;i<392;++i)if(null==r.ssf[i]){SSF__load(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}for(i=0;i!=a;++i)if(e[i].numFmtId===n)return i;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function safe_format(e,t,r,n,i,a,s){try{n.cellNF&&(e.z=table_fmt[t])}catch(e){if(n.WTF)throw e}if("z"!==e.t||n.cellStyles){if("d"===e.t&&"string"==typeof e.v&&(e.v=parseDate(e.v)),(!n||!1!==n.cellText)&&"z"!==e.t)try{if(null==table_fmt[t]&&SSF__load(SSFImplicit[t]||"General",t),"e"===e.t)e.w=e.w||BErr[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v);else if("d"===e.t){var o=datenum(e.v,!!s);e.w=(0|o)===o?o.toString(10):SSF_general_num(o)}else{if(void 0===e.v)return"";e.w=SSF_general(e.v,_ssfopts)}else"d"===e.t?e.w=SSF_format(t,datenum(e.v,!!s),_ssfopts):e.w=SSF_format(t,e.v,_ssfopts)}catch(e){if(n.WTF)throw e}if(n.cellStyles&&null!=r)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=rgb_tint(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=rgb_tint(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(e){if(n.WTF&&a.Fills)throw e}}}function check_ws(e,t,r){if(e&&e["!ref"]){var n=safe_decode_range(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function parse_ws_xml_dim(e,t){var r=safe_decode_range(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=encode_range(r))}var mergecregex=/<(?:\w+:)?mergeCell ref=["'][A-Z0-9:]+['"]\s*[\/]?>/g,hlinkregex=/<(?:\w+:)?hyperlink [^<>]*>/gm,dimregex=/"(\w*:\w*)"/,colregex=/<(?:\w+:)?col\b[^<>]*[\/]?>/g,afregex=/<(?:\w+:)?autoFilter[^>]*/g,marginregex=/<(?:\w+:)?pageMargins[^<>]*\/>/g,sheetprregex=/<(?:\w+:)?sheetPr\b[^<>]*?\/>/;function parse_ws_xml(e,t,r,n,i,a,s){if(!e)return e;n||(n={"!id":{}}),null!=DENSE&&null==t.dense&&(t.dense=DENSE);var o={};t.dense&&(o["!data"]=[]);var l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",u=str_match_xml_ns(e,"sheetData");u?(c=e.slice(0,u.index),d=e.slice(u.index+u[0].length)):c=d=e;var p=c.match(sheetprregex);p?parse_ws_xml_sheetpr(p[0],o,i,r):(p=str_match_xml_ns(c,"sheetPr"))&&parse_ws_xml_sheetpr2(p[0],p[1]||"",o,i,r,s,a);var h=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var f=c.slice(h,h+50).match(dimregex);!f||t&&t.nodim||parse_ws_xml_dim(o,f[1])}var m=str_match_xml_ns(c,"sheetViews");m&&m[1]&&parse_ws_xml_sheetviews(m[1],i);var g=[];if(t.cellStyles){var _=c.match(colregex);_&&parse_ws_xml_cols(g,_)}u&&parse_ws_xml_data(u[1],o,t,l,a,s,i);var b=d.match(afregex);b&&(o["!autofilter"]=parse_ws_xml_autofilter(b[0]));var v=[],y=d.match(mergecregex);if(y)for(h=0;h!=y.length;++h)v[h]=safe_decode_range(y[h].slice(y[h].indexOf("=")+2));var w=d.match(hlinkregex);w&&parse_ws_xml_hlinks(o,w,n);var E,S=d.match(marginregex);if(S&&(o["!margins"]=parse_ws_xml_margins(parsexmltag(S[0]))),(E=d.match(/legacyDrawing r:id="(.*?)"/))&&(o["!legrel"]=E[1]),t&&t.nodim&&(l.s.c=l.s.r=0),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=encode_range(l)),t.sheetRows>0&&o["!ref"]){var T=safe_decode_range(o["!ref"]);t.sheetRows<=+T.e.r&&(T.e.r=t.sheetRows-1,T.e.r>l.e.r&&(T.e.r=l.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>l.e.c&&(T.e.c=l.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=encode_range(T))}return g.length>0&&(o["!cols"]=g),v.length>0&&(o["!merges"]=v),n["!id"][o["!legrel"]]&&(o["!legdrawel"]=n["!id"][o["!legrel"]]),o}function write_ws_xml_merges(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+encode_range(e[r])+'"/>';return t+"</mergeCells>"}function parse_ws_xml_sheetpr(e,t,r,n){var i=parsexmltag(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=unescapexml(utf8read(i.codeName)))}function parse_ws_xml_sheetpr2(e,t,r,n,i){parse_ws_xml_sheetpr(e.slice(0,e.indexOf(">")),r,n,i)}function write_ws_xml_sheetpr(e,t,r,n,i){var a=!1,s={},o=null;if("xlsx"!==n.bookType&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch(e){}a=!0,s.codeName=utf8write(escapexml(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+writextag("outlinePr",null,c)}(a||o)&&(i[i.length]=writextag("sheetPr",o,s))}var sheetprot_deffalse=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sheetprot_deftrue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function write_ws_xml_protection(e){var t={sheet:1};return sheetprot_deffalse.forEach((function(r){null!=e[r]&&e[r]&&(t[r]="1")})),sheetprot_deftrue.forEach((function(r){null==e[r]||e[r]||(t[r]="0")})),e.password&&(t.password=crypto_CreatePasswordVerifier_Method1(e.password).toString(16).toUpperCase()),writextag("sheetProtection",null,t)}function parse_ws_xml_hlinks(e,t,r){for(var n=null!=e["!data"],i=0;i!=t.length;++i){var a=parsexmltag(utf8read(t[i]),!0);if(!a.ref)return;var s=((r||{})["!id"]||[])[a.id];s?(a.Target=s.Target,a.location&&(a.Target+="#"+unescapexml(a.location))):(a.Target="#"+unescapexml(a.location),s={Target:a.Target,TargetMode:"Internal"}),a.Rel=s,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=safe_decode_range(a.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var d=encode_col(c)+encode_row(l);n?(e["!data"][l]||(e["!data"][l]=[]),e["!data"][l][c]||(e["!data"][l][c]={t:"z",v:void 0}),e["!data"][l][c].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function parse_ws_xml_margins(e){var t={};return["left","right","top","bottom","header","footer"].forEach((function(r){e[r]&&(t[r]=parseFloat(e[r]))})),t}function write_ws_xml_margins(e){return default_margins(e),writextag("pageMargins",null,e)}function parse_ws_xml_cols(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=parsexmltag(t[n],!0);i.hidden&&(i.hidden=parsexmlbool(i.hidden));var a=parseInt(i.min,10)-1,s=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,find_mdw_colw(i.width)),process_col(i);a<=s;)e[a++]=dup(i)}}function write_ws_xml_cols(e,t){for(var r,n=["<cols>"],i=0;i!=t.length;++i)(r=t[i])&&(n[n.length]=writextag("col",null,col_obj_w(i,r)));return n[n.length]="</cols>",n.join("")}function parse_ws_xml_autofilter(e){return{ref:(e.match(/ref="([^"]*)"/)||[])[1]}}function write_ws_xml_autofilter(e,t,r,n){var i="string"==typeof e.ref?e.ref:encode_range(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,s=decode_range(i);s.s.r==s.e.r&&(s.e.r=decode_range(t["!ref"]).e.r,i=encode_range(s));for(var o=0;o<a.length;++o){var l=a[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==n){l.Ref=formula_quote_sheet_name(r.SheetNames[n])+"!"+fix_range(i);break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),writextag("autoFilter",null,{ref:i})}var sviewregex=/<(?:\w:)?sheetView(?:[^<>a-z][^<>]*)?\/?>/g;function parse_ws_xml_sheetviews(e,t){t.Views||(t.Views=[{}]),(e.match(sviewregex)||[]).forEach((function(e,r){var n=parsexmltag(e);t.Views[r]||(t.Views[r]={}),+n.zoomScale&&(t.Views[r].zoom=+n.zoomScale),n.rightToLeft&&parsexmlbool(n.rightToLeft)&&(t.Views[r].RTL=!0)}))}function write_ws_xml_sheetviews(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),writextag("sheetViews",writextag("sheetView",null,i),{})}function write_ws_xml_cell(e,t,r,n,i,a,s){if(e.c&&r["!comments"].push([t,e.c]),(void 0===e.v||"z"===e.t&&!(n||{}).sheetStubs)&&"string"!=typeof e.f&&void 0===e.z)return"";var o="",l=e.t,c=e.v;if("z"!==e.t)switch(e.t){case"b":o=e.v?"1":"0";break;case"n":isNaN(e.v)?(e.t="e",o=BErr[e.v=36]):isFinite(e.v)?o=""+e.v:(e.t="e",o=BErr[e.v=7]);break;case"e":o=BErr[e.v];break;case"d":if(n&&n.cellDates){var d=parseDate(e.v,s);o=d.toISOString(),d.getUTCFullYear()<1900&&(o=o.slice(o.indexOf("T")+1).replace("Z",""))}else(e=dup(e)).t="n",o=""+(e.v=datenum(parseDate(e.v,s),s));void 0===e.z&&(e.z=table_fmt[14]);break;default:o=e.v}var u="z"==e.t||null==e.v?"":writetag("v",escapexml(o)),p={r:t},h=get_cell_style(n.cellXfs,e,n);switch(0!==h&&(p.s=h),e.t){case"n":case"z":break;case"d":p.t="d";break;case"b":p.t="b";break;case"e":p.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=writetag("v",""+get_sst_id(n.Strings,e.v,n.revStrings)),p.t="s";break}p.t="str"}if(e.t!=l&&(e.t=l,e.v=c),"string"==typeof e.f&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=writextag("f",escapexml(e.f),f)+(null!=e.v?u:"")}return e.l&&(e.l.display=escapexml(o),r["!links"].push([t,e.l])),e.D&&(p.cm=1),writextag("c",u,p)}var parse_ws_xml_data=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/ref=["']([^"']*)["']/;return function(i,a,s,o,l,c,d){for(var u,p,h,f,m,g=0,_="",b=[],v=[],y=0,w=0,E=0,S="",T=0,C=0,x=0,A=0,I=Array.isArray(c.CellXf),D=[],k=[],L=null!=a["!data"],P=[],O={},R=!1,N=!!s.sheetStubs,B=!!((d||{}).WBProps||{}).date1904,F=i.split(t),U=0,M=F.length;U!=M;++U){var q=(_=F[U].trim()).length;if(0!==q){var z=0;e:for(g=0;g<q;++g)switch(_[g]){case">":if("/"!=_[g-1]){++g;break e}if(s&&s.cellStyles){if(T=null!=(p=parsexmltag(_.slice(z,g),!0)).r?parseInt(p.r,10):T+1,C=-1,s.sheetRows&&s.sheetRows<T)continue;O={},R=!1,p.ht&&(R=!0,O.hpt=parseFloat(p.ht),O.hpx=pt2px(O.hpt)),p.hidden&&parsexmlbool(p.hidden)&&(R=!0,O.hidden=!0),null!=p.outlineLevel&&(R=!0,O.level=+p.outlineLevel),R&&(P[T-1]=O)}break;case"<":z=g}if(z>=g)break;if(T=null!=(p=parsexmltag(_.slice(z,g),!0)).r?parseInt(p.r,10):T+1,C=-1,!(s.sheetRows&&s.sheetRows<T)){s.nodim||(o.s.r>T-1&&(o.s.r=T-1),o.e.r<T-1&&(o.e.r=T-1)),s&&s.cellStyles&&(O={},R=!1,p.ht&&(R=!0,O.hpt=parseFloat(p.ht),O.hpx=pt2px(O.hpt)),p.hidden&&parsexmlbool(p.hidden)&&(R=!0,O.hidden=!0),null!=p.outlineLevel&&(R=!0,O.level=+p.outlineLevel),R&&(P[T-1]=O)),b=_.slice(g).split(e);for(var H=0;H!=b.length&&"<"==b[H].trim().charAt(0);++H);for(b=b.slice(H),g=0;g!=b.length;++g)if(0!==(_=b[g].trim()).length){if(v=_.match(r),y=g,w=0,E=0,_="<c "+("<"==_.slice(0,1)?">":"")+_,null!=v&&2===v.length){for(y=0,S=v[1],w=0;w!=S.length&&!((E=S.charCodeAt(w)-64)<1||E>26);++w)y=26*y+E;C=--y}else++C;for(w=0;w!=_.length&&62!==_.charCodeAt(w);++w);if(++w,(p=parsexmltag(_.slice(0,w),!0)).r||(p.r=encode_cell({r:T-1,c:C})),S=_.slice(w),u={t:""},null!=(v=str_match_xml_ns(S,"v"))&&""!==v[1]&&(u.v=unescapexml(v[1])),s.cellFormula){if(null!=(v=str_match_xml_ns(S,"f"))){if(""==v[1])v[0].indexOf('t="shared"')>-1&&k[(f=parsexmltag(v[0])).si]&&(u.f=shift_formula_xlsx(k[f.si][1],k[f.si][2],p.r));else if(u.f=unescapexml(utf8read(v[1]),!0),s.xlfn||(u.f=_xlfn(u.f)),v[0].indexOf('t="array"')>-1)u.F=(S.match(n)||[])[1],u.F.indexOf(":")>-1&&D.push([safe_decode_range(u.F),u.F]);else if(v[0].indexOf('t="shared"')>-1){f=parsexmltag(v[0]);var W=unescapexml(utf8read(v[1]));s.xlfn||(W=_xlfn(W)),k[parseInt(f.si,10)]=[f,W,p.r]}}else(v=S.match(/<f[^<>]*\/>/))&&k[(f=parsexmltag(v[0])).si]&&(u.f=shift_formula_xlsx(k[f.si][1],k[f.si][2],p.r));var j=decode_cell(p.r);for(w=0;w<D.length;++w)j.r>=D[w][0].s.r&&j.r<=D[w][0].e.r&&j.c>=D[w][0].s.c&&j.c<=D[w][0].e.c&&(u.F=D[w][1])}if(null==p.t&&void 0===u.v)if(u.f||u.F)u.v=0,u.t="n";else{if(!N)continue;u.t="z"}else u.t=p.t||"n";switch(o.s.c>C&&(o.s.c=C),o.e.c<C&&(o.e.c=C),u.t){case"n":if(""==u.v||null==u.v){if(!N)continue;u.t="z"}else u.v=parseFloat(u.v);break;case"s":if(void 0===u.v){if(!N)continue;u.t="z"}else h=strs[parseInt(u.v,10)],u.v=h.t,u.r=h.r,s.cellHTML&&(u.h=h.h);break;case"str":u.t="s",u.v=null!=u.v?unescapexml(utf8read(u.v),!0):"",s.cellHTML&&(u.h=escapehtml(u.v));break;case"inlineStr":v=str_match_xml_ns(S,"is"),u.t="s",null!=v&&(h=parse_si(v[1]))?(u.v=h.t,s.cellHTML&&(u.h=h.h)):u.v="";break;case"b":u.v=parsexmlbool(u.v);break;case"d":s.cellDates?u.v=parseDate(u.v,B):(u.v=datenum(parseDate(u.v,B),B),u.t="n");break;case"e":s&&!1===s.cellText||(u.w=u.v),u.v=RBErr[u.v]}if(x=A=0,m=null,I&&void 0!==p.s&&null!=(m=c.CellXf[p.s])&&(null!=m.numFmtId&&(x=m.numFmtId),s.cellStyles&&null!=m.fillId&&(A=m.fillId)),safe_format(u,x,A,s,l,c,B),s.cellDates&&I&&"n"==u.t&&fmt_is_date(table_fmt[x])&&(u.v=numdate(u.v+(B?1462:0)),u.t="number"==typeof u.v?"n":"d"),p.cm&&s.xlmeta){var V=(s.xlmeta.Cell||[])[+p.cm-1];V&&"XLDAPR"==V.type&&(u.D=!0)}var $;s.nodim&&($=decode_cell(p.r),o.s.r>$.r&&(o.s.r=$.r),o.e.r<$.r&&(o.e.r=$.r)),L?($=decode_cell(p.r),a["!data"][$.r]||(a["!data"][$.r]=[]),a["!data"][$.r][$.c]=u):a[p.r]=u}}}}P.length>0&&(a["!rows"]=P)}}();function write_ws_xml_data(e,t,r,n){var i,a,s=[],o=[],l=safe_decode_range(e["!ref"]),c="",d="",u=[],p=0,h=0,f=e["!rows"],m=null!=e["!data"],g=m?e["!data"]:[],_={r:d},b=-1,v=(((n||{}).Workbook||{}).WBProps||{}).date1904;for(h=l.s.c;h<=l.e.c;++h)u[h]=encode_col(h);for(p=l.s.r;p<=l.e.r;++p){o=[],d=encode_row(p);var y=m?g[p]:[];for(h=l.s.c;h<=l.e.c;++h){i=u[h]+d;var w=m?y[h]:e[i];void 0!==w&&null!=(c=write_ws_xml_cell(w,i,e,t,r,n,v))&&o.push(c)}(o.length>0||f&&f[p])&&(_={r:d},f&&f[p]&&((a=f[p]).hidden&&(_.hidden=1),b=-1,a.hpx?b=px2pt(a.hpx):a.hpt&&(b=a.hpt),b>-1&&(_.ht=b,_.customHeight=1),a.level&&(_.outlineLevel=a.level)),s[s.length]=writextag("row",o.join(""),_))}if(f)for(;p<f.length;++p)f&&f[p]&&(_={r:p+1},(a=f[p]).hidden&&(_.hidden=1),b=-1,a.hpx?b=px2pt(a.hpx):a.hpt&&(b=a.hpt),b>-1&&(_.ht=b,_.customHeight=1),a.level&&(_.outlineLevel=a.level),s[s.length]=writextag("row","",_));return s.join("")}function write_ws_xml(e,t,r,n){var i,a=[XML_HEADER,writextag("worksheet",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r})],s=r.SheetNames[e],o="",l=r.Sheets[s];null==l&&(l={});var c=l["!ref"]||"A1",d=safe_decode_range(c);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),c=encode_range(d)}n||(n={}),l["!comments"]=[];var u=[];write_ws_xml_sheetpr(l,r,e,t,a),a[a.length]=writextag("dimension",null,{ref:c}),a[a.length]=write_ws_xml_sheetviews(l,t,e,r),t.sheetFormat&&(a[a.length]=writextag("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(a[a.length]=write_ws_xml_cols(l,l["!cols"])),a[i=a.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(o=write_ws_xml_data(l,t,e,r,n)).length>0&&(a[a.length]=o),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),l["!protect"]&&(a[a.length]=write_ws_xml_protection(l["!protect"])),null!=l["!autofilter"]&&(a[a.length]=write_ws_xml_autofilter(l["!autofilter"],l,r,e)),null!=l["!merges"]&&l["!merges"].length>0&&(a[a.length]=write_ws_xml_merges(l["!merges"]));var p,h=-1,f=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach((function(e){e[1].Target&&(p={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(f=add_rels(n,-1,escapexml(e[1].Target).replace(/#[\s\S]*$/,""),RELS.HLINK),p["r:id"]="rId"+f),(h=e[1].Target.indexOf("#"))>-1&&(p.location=escapexml(e[1].Target.slice(h+1))),e[1].Tooltip&&(p.tooltip=escapexml(e[1].Tooltip)),p.display=e[1].display,a[a.length]=writextag("hyperlink",null,p))})),a[a.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(a[a.length]=write_ws_xml_margins(l["!margins"])),t&&!t.ignoreEC&&null!=t.ignoreEC||(a[a.length]=writetag("ignoredErrors",writextag("ignoredError",null,{numberStoredAsText:1,sqref:c}))),u.length>0&&(f=add_rels(n,-1,"../drawings/drawing"+(e+1)+".xml",RELS.DRAW),a[a.length]=writextag("drawing",null,{"r:id":"rId"+f}),l["!drawing"]=u),l["!comments"].length>0&&(f=add_rels(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",RELS.VML),a[a.length]=writextag("legacyDrawing",null,{"r:id":"rId"+f}),l["!legacy"]=f),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function parse_BrtRowHdr(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,7&a&&(r.level=7&a),16&a&&(r.hidden=!0),32&a&&(r.hpt=i/20),r}function write_BrtRowHdr(e,t,r){var n=new_buf(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;i.hpx?a=20*px2pt(i.hpx):i.hpt&&(a=20*i.hpt),n.write_shift(2,a),n.write_shift(1,0);var s=0;i.level&&(s|=i.level),i.hidden&&(s|=16),(i.hpx||i.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},d=null!=r["!data"],u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var p=-1,h=-1,f=u<<10;f<u+1<<10;++f)c.c=f,(d?(r["!data"][c.r]||[])[c.c]:r[encode_cell(c)])&&(p<0&&(p=f),h=f);p<0||(++o,n.write_shift(4,p),n.write_shift(4,h))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function write_row_header(e,t,r,n){var i=write_BrtRowHdr(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&write_record(e,0,i)}var parse_BrtWsDim=parse_UncheckedRfX,write_BrtWsDim=write_UncheckedRfX;function parse_BrtWsFmtInfo(){}function parse_BrtWsProp(e,t){var r={},n=e[e.l];return++e.l,r.above=!(64&n),r.left=!(128&n),e.l+=18,r.name=parse_XLSBCodeName(e,t-19),r}function write_BrtWsProp(e,t,r){null==r&&(r=new_buf(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return write_BrtColor({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),write_XLSBCodeName(e,r),r.slice(0,r.l)}function parse_BrtCellBlank(e){return[parse_XLSBCell(e)]}function write_BrtCellBlank(e,t,r){return null==r&&(r=new_buf(8)),write_XLSBCell(t,r)}function parse_BrtShortBlank(e){return[parse_XLSBShortCell(e)]}function write_BrtShortBlank(e,t,r){return null==r&&(r=new_buf(4)),write_XLSBShortCell(t,r)}function parse_BrtCellBool(e){return[parse_XLSBCell(e),e.read_shift(1),"b"]}function write_BrtCellBool(e,t,r){return null==r&&(r=new_buf(9)),write_XLSBCell(t,r),r.write_shift(1,e.v?1:0),r}function parse_BrtShortBool(e){return[parse_XLSBShortCell(e),e.read_shift(1),"b"]}function write_BrtShortBool(e,t,r){return null==r&&(r=new_buf(5)),write_XLSBShortCell(t,r),r.write_shift(1,e.v?1:0),r}function parse_BrtCellError(e){return[parse_XLSBCell(e),e.read_shift(1),"e"]}function write_BrtCellError(e,t,r){return null==r&&(r=new_buf(9)),write_XLSBCell(t,r),r.write_shift(1,e.v),r}function parse_BrtShortError(e){return[parse_XLSBShortCell(e),e.read_shift(1),"e"]}function write_BrtShortError(e,t,r){return null==r&&(r=new_buf(8)),write_XLSBShortCell(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function parse_BrtCellIsst(e){return[parse_XLSBCell(e),e.read_shift(4),"s"]}function write_BrtCellIsst(e,t,r){return null==r&&(r=new_buf(12)),write_XLSBCell(t,r),r.write_shift(4,t.v),r}function parse_BrtShortIsst(e){return[parse_XLSBShortCell(e),e.read_shift(4),"s"]}function write_BrtShortIsst(e,t,r){return null==r&&(r=new_buf(8)),write_XLSBShortCell(t,r),r.write_shift(4,t.v),r}function parse_BrtCellReal(e){return[parse_XLSBCell(e),parse_Xnum(e),"n"]}function write_BrtCellReal(e,t,r){return null==r&&(r=new_buf(16)),write_XLSBCell(t,r),write_Xnum(e.v,r),r}function parse_BrtShortReal(e){return[parse_XLSBShortCell(e),parse_Xnum(e),"n"]}function write_BrtShortReal(e,t,r){return null==r&&(r=new_buf(12)),write_XLSBShortCell(t,r),write_Xnum(e.v,r),r}function parse_BrtCellRk(e){return[parse_XLSBCell(e),parse_RkNumber(e),"n"]}function write_BrtCellRk(e,t,r){return null==r&&(r=new_buf(12)),write_XLSBCell(t,r),write_RkNumber(e.v,r),r}function parse_BrtShortRk(e){return[parse_XLSBShortCell(e),parse_RkNumber(e),"n"]}function write_BrtShortRk(e,t,r){return null==r&&(r=new_buf(8)),write_XLSBShortCell(t,r),write_RkNumber(e.v,r),r}function parse_BrtCellRString(e){return[parse_XLSBCell(e),parse_RichStr(e),"is"]}function parse_BrtCellSt(e){return[parse_XLSBCell(e),parse_XLWideString(e),"str"]}function write_BrtCellSt(e,t,r){var n=null==e.v?"":String(e.v);return null==r&&(r=new_buf(12+4*e.v.length)),write_XLSBCell(t,r),write_XLWideString(n,r),r.length>r.l?r.slice(0,r.l):r}function parse_BrtShortSt(e){return[parse_XLSBShortCell(e),parse_XLWideString(e),"str"]}function write_BrtShortSt(e,t,r){var n=null==e.v?"":String(e.v);return null==r&&(r=new_buf(8+4*n.length)),write_XLSBShortCell(t,r),write_XLWideString(n,r),r.length>r.l?r.slice(0,r.l):r}function parse_BrtFmlaBool(e,t,r){var n=e.l+t,i=parse_XLSBCell(e);i.r=r["!row"];var a=[i,e.read_shift(1),"b"];if(r.cellFormula){e.l+=2;var s=parse_XLSBCellParsedFormula(e,n-e.l,r);a[3]=stringify_formula(s,null,i,r.supbooks,r)}else e.l=n;return a}function parse_BrtFmlaError(e,t,r){var n=e.l+t,i=parse_XLSBCell(e);i.r=r["!row"];var a=[i,e.read_shift(1),"e"];if(r.cellFormula){e.l+=2;var s=parse_XLSBCellParsedFormula(e,n-e.l,r);a[3]=stringify_formula(s,null,i,r.supbooks,r)}else e.l=n;return a}function parse_BrtFmlaNum(e,t,r){var n=e.l+t,i=parse_XLSBCell(e);i.r=r["!row"];var a=[i,parse_Xnum(e),"n"];if(r.cellFormula){e.l+=2;var s=parse_XLSBCellParsedFormula(e,n-e.l,r);a[3]=stringify_formula(s,null,i,r.supbooks,r)}else e.l=n;return a}function parse_BrtFmlaString(e,t,r){var n=e.l+t,i=parse_XLSBCell(e);i.r=r["!row"];var a=[i,parse_XLWideString(e),"str"];if(r.cellFormula){e.l+=2;var s=parse_XLSBCellParsedFormula(e,n-e.l,r);a[3]=stringify_formula(s,null,i,r.supbooks,r)}else e.l=n;return a}var parse_BrtMergeCell=parse_UncheckedRfX,write_BrtMergeCell=write_UncheckedRfX;function write_BrtBeginMergeCells(e,t){return null==t&&(t=new_buf(4)),t.write_shift(4,e),t}function parse_BrtHLink(e,t){var r=e.l+t,n=parse_UncheckedRfX(e,16),i=parse_XLNullableWideString(e),a=parse_XLWideString(e),s=parse_XLWideString(e),o=parse_XLWideString(e);e.l=r;var l={rfx:n,relId:i,loc:a,display:o};return s&&(l.Tooltip=s),l}function write_BrtHLink(e,t){var r=new_buf(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));write_UncheckedRfX({s:decode_cell(e[0]),e:decode_cell(e[0])},r),write_RelID("rId"+t,r);var n=e[1].Target.indexOf("#");return write_XLWideString((-1==n?"":e[1].Target.slice(n+1))||"",r),write_XLWideString(e[1].Tooltip||"",r),write_XLWideString("",r),r.slice(0,r.l)}function parse_BrtPane(){}function parse_BrtArrFmla(e,t,r){var n=e.l+t,i=parse_RfX(e,16),a=e.read_shift(1),s=[i];if(s[2]=a,r.cellFormula){var o=parse_XLSBArrayParsedFormula(e,n-e.l,r);s[1]=o}else e.l=n;return s}function parse_BrtShrFmla(e,t,r){var n=e.l+t,i=[parse_UncheckedRfX(e,16)];if(r.cellFormula){var a=parse_XLSBSharedParsedFormula(e,n-e.l,r);i[1]=a,e.l=n}else e.l=n;return i}function write_BrtColInfo(e,t,r){null==r&&(r=new_buf(18));var n=col_obj_w(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,256*(n.width||10)),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),"number"==typeof n.width&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var BrtMarginKeys=["left","right","top","bottom","header","footer"];function parse_BrtMargins(e){var t={};return BrtMarginKeys.forEach((function(r){t[r]=parse_Xnum(e,8)})),t}function write_BrtMargins(e,t){return null==t&&(t=new_buf(48)),default_margins(e),BrtMarginKeys.forEach((function(r){write_Xnum(e[r],t)})),t}function parse_BrtBeginWsView(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}function write_BrtBeginWsView(e,t,r){null==r&&(r=new_buf(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function write_BrtCellIgnoreEC(e){var t=new_buf(24);return t.write_shift(4,4),t.write_shift(4,1),write_UncheckedRfX(e,t),t}function write_BrtSheetProtection(e,t){return null==t&&(t=new_buf(66)),t.write_shift(2,e.password?crypto_CreatePasswordVerifier_Method1(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach((function(r){r[1]?t.write_shift(4,null==e[r[0]]||e[r[0]]?0:1):t.write_shift(4,null!=e[r[0]]&&e[r[0]]?0:1)})),t}function parse_BrtDVal(){}function parse_BrtDVal14(){}function parse_ws_bin(e,t,r,n,i,a,s){if(!e)return e;var o=t||{};n||(n={"!id":{}}),null!=DENSE&&null==o.dense&&(o.dense=DENSE);var l,c={};o.dense&&(c["!data"]=[]);var d,u,p,h,f,m,g,_,b,v={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=[],w=!1,E=!1,S=[];o.biff=12,o["!row"]=0;var T=0,C=!1,x=[],A={},I=o.supbooks||i.supbooks||[[]];if(I.sharedf=A,I.arrayf=x,I.SheetNames=i.SheetNames||i.Sheets.map((function(e){return e.name})),!o.supbooks&&(o.supbooks=I,i.Names))for(var D=0;D<i.Names.length;++D)I[0][D+1]=i.Names[D];var k,L,P=[],O=[],R=!1;XLSBRecordEnum[16]={n:"BrtShortReal",f:parse_BrtShortReal};var N=1462*+!!((i||{}).WBProps||{}).date1904;if(recordhopper(e,(function(e,t,D){if(!E)switch(D){case 148:l=e;break;case 0:d=e,o.sheetRows&&o.sheetRows<=d.r&&(E=!0),_=encode_row(h=d.r),o["!row"]=d.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=pt2px(e.hpt)),O[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(u={t:e[2]},e[2]){case"n":u.v=e[1];break;case"s":g=strs[e[1]],u.v=g.t,u.r=g.r;break;case"b":u.v=!!e[1];break;case"e":u.v=e[1],!1!==o.cellText&&(u.w=BErr[u.v]);break;case"str":u.t="s",u.v=e[1];break;case"is":u.t="s",u.v=e[1].t}if((p=s.CellXf[e[0].iStyleRef])&&safe_format(u,p.numFmtId,null,o,a,s,N>0),f=-1==e[0].c?f+1:e[0].c,o.dense?(c["!data"][h]||(c["!data"][h]=[]),c["!data"][h][f]=u):c[encode_col(f)+_]=u,o.cellFormula){for(C=!1,T=0;T<x.length;++T){var B=x[T];d.r>=B[0].s.r&&d.r<=B[0].e.r&&f>=B[0].s.c&&f<=B[0].e.c&&(u.F=encode_range(B[0]),C=!0)}!C&&e.length>3&&(u.f=e[3])}if(v.s.r>d.r&&(v.s.r=d.r),v.s.c>f&&(v.s.c=f),v.e.r<d.r&&(v.e.r=d.r),v.e.c<f&&(v.e.c=f),o.cellDates&&p&&"n"==u.t&&fmt_is_date(table_fmt[p.numFmtId])){var F=SSF_parse_date_code(u.v+N);F&&(u.t="d",u.v=new Date(Date.UTC(F.y,F.m-1,F.d,F.H,F.M,F.S,F.u)))}k&&("XLDAPR"==k.type&&(u.D=!0),k=void 0),L&&(L=void 0);break;case 1:case 12:if(!o.sheetStubs||w)break;u={t:"z",v:void 0},f=-1==e[0].c?f+1:e[0].c,o.dense?(c["!data"][h]||(c["!data"][h]=[]),c["!data"][h][f]=u):c[encode_col(f)+_]=u,v.s.r>d.r&&(v.s.r=d.r),v.s.c>f&&(v.s.c=f),v.e.r<d.r&&(v.e.r=d.r),v.e.c<f&&(v.e.c=f),k&&("XLDAPR"==k.type&&(u.D=!0),k=void 0),L&&(L=void 0);break;case 176:S.push(e);break;case 49:k=((o.xlmeta||{}).Cell||[])[e-1];break;case 494:var U=n["!id"][e.relId];for(U?(e.Target=U.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=U):""==e.relId&&(e.Target="#"+e.loc),h=e.rfx.s.r;h<=e.rfx.e.r;++h)for(f=e.rfx.s.c;f<=e.rfx.e.c;++f)o.dense?(c["!data"][h]||(c["!data"][h]=[]),c["!data"][h][f]||(c["!data"][h][f]={t:"z",v:void 0}),c["!data"][h][f].l=e):(m=encode_col(f)+encode_row(h),c[m]||(c[m]={t:"z",v:void 0}),c[m].l=e);break;case 426:if(!o.cellFormula)break;x.push(e),(b=o.dense?c["!data"][h][f]:c[encode_col(f)+_]).f=stringify_formula(e[1],v,{r:d.r,c:f},I,o),b.F=encode_range(e[0]);break;case 427:if(!o.cellFormula)break;A[encode_cell(e[0].s)]=e[1],(b=o.dense?c["!data"][h][f]:c[encode_col(f)+_]).f=stringify_formula(e[1],v,{r:d.r,c:f},I,o);break;case 60:if(!o.cellStyles)break;for(;e.e>=e.s;)P[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},R||(R=!0,find_mdw_colw(e.w/256)),process_col(P[e.e+1]);break;case 551:e&&(c["!legrel"]=e);break;case 161:c["!autofilter"]={ref:encode_range(e)};break;case 476:c["!margins"]=e;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),e.name&&(i.Sheets[r].CodeName=e.name),(e.above||e.left)&&(c["!outline"]={above:e.above,left:e.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),e.RTL&&(i.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:w=!0;break;case 36:w=!1;break;case 37:y.push(D),w=!0;break;case 38:y.pop(),w=!1;break;default:if(t.T);else if(!w||o.WTF)throw new Error("Unexpected record 0x"+D.toString(16))}}),o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(v.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=encode_range(l||v)),o.sheetRows&&c["!ref"]){var B=safe_decode_range(c["!ref"]);o.sheetRows<=+B.e.r&&(B.e.r=o.sheetRows-1,B.e.r>v.e.r&&(B.e.r=v.e.r),B.e.r<B.s.r&&(B.s.r=B.e.r),B.e.c>v.e.c&&(B.e.c=v.e.c),B.e.c<B.s.c&&(B.s.c=B.e.c),c["!fullref"]=c["!ref"],c["!ref"]=encode_range(B))}return S.length>0&&(c["!merges"]=S),P.length>0&&(c["!cols"]=P),O.length>0&&(c["!rows"]=O),n["!id"][c["!legrel"]]&&(c["!legdrawel"]=n["!id"][c["!legrel"]]),c}function write_ws_bin_cell(e,t,r,n,i,a,s,o){var l={r,c:n};if(t.c&&a["!comments"].push([encode_cell(l),t.c]),void 0===t.v)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":(t=dup(t)).z=t.z||table_fmt[14],t.v=datenum(parseDate(t.v,o),o),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v}switch(l.s=get_cell_style(i.cellXfs,t,i),t.l&&a["!links"].push([encode_cell(l),t.l]),t.t){case"s":case"str":return i.bookSST?(c=get_sst_id(i.Strings,null==t.v?"":String(t.v),i.revStrings),l.t="s",l.v=c,s?write_record(e,18,write_BrtShortIsst(t,l)):write_record(e,7,write_BrtCellIsst(t,l))):(l.t="str",s?write_record(e,17,write_BrtShortSt(t,l)):write_record(e,6,write_BrtCellSt(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?s?write_record(e,13,write_BrtShortRk(t,l)):write_record(e,2,write_BrtCellRk(t,l)):isFinite(t.v)?s?write_record(e,16,write_BrtShortReal(t,l)):write_record(e,5,write_BrtCellReal(t,l)):(l.t="e",isNaN(t.v)?s?write_record(e,14,write_BrtShortError({t:"e",v:36},l)):write_record(e,3,write_BrtCellError({t:"e",v:36},l)):s?write_record(e,14,write_BrtShortError({t:"e",v:7},l)):write_record(e,3,write_BrtCellError({t:"e",v:7},l))),!0;case"b":return l.t="b",s?write_record(e,15,write_BrtShortBool(t,l)):write_record(e,4,write_BrtCellBool(t,l)),!0;case"e":return l.t="e",s?write_record(e,14,write_BrtShortError(t,l)):write_record(e,3,write_BrtCellError(t,l)),!0}return s?write_record(e,12,write_BrtShortBlank(t,l)):write_record(e,1,write_BrtCellBlank(t,l)),!0}function write_CELLTABLE(e,t,r,n,i){var a=safe_decode_range(t["!ref"]||"A1"),s="",o=[],l=(((i||{}).Workbook||{}).WBProps||{}).date1904;write_record(e,145);var c=null!=t["!data"],d=c?t["!data"][a.s.r]:[],u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var p=a.s.r;p<=u;++p)if(s=encode_row(p),c&&(d=t["!data"][p]),write_row_header(e,t,a,p),!c||d){var h=!1;if(p<=a.e.r)for(var f=a.s.c;f<=a.e.c;++f){p===a.s.r&&(o[f]=encode_col(f));var m=c?d[f]:t[o[f]+s];h=!!m&&write_ws_bin_cell(e,m,p,f,n,t,h,l)}}write_record(e,146)}function write_MERGECELLS(e,t){t&&t["!merges"]&&(write_record(e,177,write_BrtBeginMergeCells(t["!merges"].length)),t["!merges"].forEach((function(t){write_record(e,176,write_BrtMergeCell(t))})),write_record(e,178))}function write_COLINFOS(e,t){t&&t["!cols"]&&(write_record(e,390),t["!cols"].forEach((function(t,r){t&&write_record(e,60,write_BrtColInfo(r,t))})),write_record(e,391))}function write_IGNOREECS(e,t){t&&t["!ref"]&&(write_record(e,648),write_record(e,649,write_BrtCellIgnoreEC(safe_decode_range(t["!ref"]))),write_record(e,650))}function write_HLINKS(e,t,r){t["!links"].forEach((function(t){if(t[1].Target){var n=add_rels(r,-1,t[1].Target.replace(/#[\s\S]*$/,""),RELS.HLINK);write_record(e,494,write_BrtHLink(t,n))}})),delete t["!links"]}function write_LEGACYDRAWING(e,t,r,n){if(t["!comments"].length>0){var i=add_rels(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",RELS.VML);write_record(e,551,write_RelID("rId"+i)),t["!legacy"]=i}}function write_AUTOFILTER(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],a="string"==typeof i.ref?i.ref:encode_range(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=decode_range(a);o.s.r==o.e.r&&(o.e.r=decode_range(t["!ref"]).e.r,a=encode_range(o));for(var l=0;l<s.length;++l){var c=s[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==n){c.Ref=formula_quote_sheet_name(r.SheetNames[n])+"!"+fix_range(a);break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:formula_quote_sheet_name(r.SheetNames[n])+"!"+fix_range(a)}),write_record(e,161,write_UncheckedRfX(safe_decode_range(a))),write_record(e,162)}}function write_WSVIEWS2(e,t,r){write_record(e,133),write_record(e,137,write_BrtBeginWsView(t,r)),write_record(e,138),write_record(e,134)}function write_WSFMTINFO(){}function write_SHEETPROTECT(e,t){t["!protect"]&&write_record(e,535,write_BrtSheetProtection(t["!protect"]))}function write_ws_bin(e,t,r,n){var i=buf_array(),a=r.SheetNames[e],s=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch(e){}var l=safe_decode_range(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],write_record(i,129),(r.vbaraw||s["!outline"])&&write_record(i,147,write_BrtWsProp(o,s["!outline"])),write_record(i,148,write_BrtWsDim(l)),write_WSVIEWS2(i,s,r.Workbook),write_WSFMTINFO(i,s),write_COLINFOS(i,s,e,t,r),write_CELLTABLE(i,s,e,t,r),write_SHEETPROTECT(i,s),write_AUTOFILTER(i,s,r,e),write_MERGECELLS(i,s),write_HLINKS(i,s,n),s["!margins"]&&write_record(i,476,write_BrtMargins(s["!margins"])),t&&!t.ignoreEC&&null!=t.ignoreEC||write_IGNOREECS(i,s),write_LEGACYDRAWING(i,s,e,n),write_record(i,130),i.end()}function parse_Cache(e){var t,r=[],n=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)"[^<>\/]*><c:v>([^<])<\/c:v><\/c:pt>/gm)||[]).forEach((function(e){var t=e.match(/<c:pt idx="(\d*)"[^<>\/]*><c:v>([^<]*)<\/c:v><\/c:pt>/);t&&(r[+t[1]]=n?+t[2]:t[2])}));var i=unescapexml((str_match_xml(e,"c:formatCode")||["","General"])[1]);return(str_match_ng(e,"<c:f>","</c:f>")||[]).forEach((function(e){t=e.replace(/<[^<>]*>/g,"")})),[r,i,t]}function parse_chart(e,t,r,n,i,a){var s=a||{"!type":"chart"};if(!e)return a;var o=0,l=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(str_match_ng(e,"<c:numCache>","</c:numCache>")||[]).forEach((function(e){var t=parse_Cache(e);d.s.r=d.s.c=0,d.e.c=o,c=encode_col(o),t[0].forEach((function(e,r){s["!data"]?(s["!data"][r]||(s["!data"][r]=[]),s["!data"][r][o]={t:"n",v:e,z:t[1]}):s[c+encode_row(r)]={t:"n",v:e,z:t[1]},l=r})),d.e.r<l&&(d.e.r=l),++o})),o>0&&(s["!ref"]=encode_range(d)),s}function parse_cs_xml(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a,s={"!type":"chart","!drawel":null,"!rel":""},o=e.match(sheetprregex);return o&&parse_ws_xml_sheetpr(o[0],s,i,r),(a=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function parse_BrtCsProp(e,t){return e.l+=10,{name:parse_XLWideString(e,t-10)}}function parse_cs_bin(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s=[],o=!1;return recordhopper(e,(function(e,n,l){switch(l){case 550:a["!rel"]=e;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),e.name&&(i.Sheets[r].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(l);break;case 38:s.pop();break;default:if(n.T>0)s.push(l);else if(n.T<0)s.pop();else if(!o||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var WBPropsDef=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],WBViewDef=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SheetDef=[],CalcPrDef=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function push_defaults_array(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var a=t[i];if(null==n[a[0]])n[a[0]]=a[1];else switch(a[2]){case"bool":"string"==typeof n[a[0]]&&(n[a[0]]=parsexmlbool(n[a[0]]));break;case"int":"string"==typeof n[a[0]]&&(n[a[0]]=parseInt(n[a[0]],10))}}}function push_defaults(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(null==e[n[0]])e[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof e[n[0]]&&(e[n[0]]=parsexmlbool(e[n[0]]));break;case"int":"string"==typeof e[n[0]]&&(e[n[0]]=parseInt(e[n[0]],10))}}}function parse_wb_defaults(e){push_defaults(e.WBProps,WBPropsDef),push_defaults(e.CalcPr,CalcPrDef),push_defaults_array(e.WBView,WBViewDef),push_defaults_array(e.Sheets,SheetDef),_ssfopts.date1904=parsexmlbool(e.WBProps.date1904)}function safe1904(e){return e.Workbook&&e.Workbook.WBProps&&parsexmlbool(e.Workbook.WBProps.date1904)?"true":"false"}var badchars=":][*?/\\".split("");function check_ws_name(e,t){try{if(""==e)throw new Error("Sheet name cannot be blank");if(e.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(39==e.charCodeAt(0)||39==e.charCodeAt(e.length-1))throw new Error("Sheet name cannot start or end with apostrophe (')");if("history"==e.toLowerCase())throw new Error("Sheet name cannot be 'History'");badchars.forEach((function(t){if(-1!=e.indexOf(t))throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}))}catch(e){if(t)return!1;throw e}return!0}function check_wb_names(e,t,r){e.forEach((function(n,i){check_ws_name(n);for(var a=0;a<i;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[i]&&t[i].CodeName||n;if(95==s.charCodeAt(0)&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}}))}function check_wb(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];check_wb_names(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)check_ws(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r);e.SheetNames.forEach((function(t,r){var n=e.Sheets[t];if(n&&n["!autofilter"]){var i;e.Workbook||(e.Workbook={}),e.Workbook.Names||(e.Workbook.Names=[]),e.Workbook.Names.forEach((function(e){"_xlnm._FilterDatabase"==e.Name&&e.Sheet==r&&(i=e)}));var a=formula_quote_sheet_name(t)+"!"+fix_range(n["!autofilter"].ref);i?i.Ref=a:e.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:a})}}))}var wbnsregex=/<\w+:workbook/;function parse_wb_xml(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},s=0;if(e.replace(tagregex,(function(o,l){var c=parsexmltag(o);switch(strip_ns(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":o.match(wbnsregex)&&(i="xmlns"+o.match(/<(\w+):/)[1]),r.xmlns=c[i];break;case"<fileVersion":delete c[0],r.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":WBPropsDef.forEach((function(e){if(null!=c[e[0]])switch(e[2]){case"bool":r.WBProps[e[0]]=parsexmlbool(c[e[0]]);break;case"int":r.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:r.WBProps[e[0]]=c[e[0]]}})),c.codeName&&(r.WBProps.CodeName=utf8read(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],r.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=unescapexml(utf8read(c.name)),delete c[0],r.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":n=!1;break;case"<definedName":(a={}).Name=utf8read(c.name),c.comment&&(a.Comment=c.comment),c.localSheetId&&(a.Sheet=+c.localSheetId),parsexmlbool(c.hidden||"0")&&(a.Hidden=!0),s=l+o.length;break;case"</definedName>":a.Ref=unescapexml(utf8read(e.slice(s,l))),r.Names.push(a);break;case"<calcPr":case"<calcPr/>":delete c[0],r.CalcPr=c;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return o})),-1===XMLNS_main.indexOf(r.xmlns))throw new Error("Unknown Namespace: "+r.xmlns);return parse_wb_defaults(r),r}function write_wb_xml(e){var t=[XML_HEADER];t[t.length]=writextag("workbook",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(WBPropsDef.forEach((function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(n[t[0]]=e.Workbook.WBProps[t[0]])})),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=writextag("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&i[a]&&i[a].Hidden;++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var s={name:escapexml(e.SheetNames[a].slice(0,31))};if(s.sheetId=""+(a+1),s["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden"}t[t.length]=writextag("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach((function(e){var r={name:e.Name};e.Comment&&(r.comment=e.Comment),null!=e.Sheet&&(r.localSheetId=""+e.Sheet),e.Hidden&&(r.hidden="1"),e.Ref&&(t[t.length]=writextag("definedName",escapexml(e.Ref),r))})),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function parse_BrtBundleSh(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=parse_RelID(e,t-8),r.name=parse_XLWideString(e),r}function write_BrtBundleSh(e,t){return t||(t=new_buf(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),write_RelID(e.strRelID,t),write_XLWideString(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function parse_BrtWbProp(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?parse_XLWideString(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(65536&n),r.backupFile=!!(64&n),r.checkCompatibility=!!(4096&n),r.date1904=!!(1&n),r.filterPrivacy=!!(8&n),r.hidePivotFieldList=!!(1024&n),r.promptedSolutions=!!(16&n),r.publishItems=!!(2048&n),r.refreshAllConnections=!!(262144&n),r.saveExternalLinkValues=!!(128&n),r.showBorderUnselectedTables=!!(4&n),r.showInkAnnotation=!!(32&n),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(32768&n),r.updateLinks=["userSet","never","always"][n>>8&3],r}function write_BrtWbProp(e,t){t||(t=new_buf(72));var r=0;return e&&(e.date1904&&(r|=1),e.filterPrivacy&&(r|=8)),t.write_shift(4,r),t.write_shift(4,0),write_XLSBCodeName(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function parse_BrtFRTArchID$(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function parse_BrtName(e,t,r){var n=e.l+t,i=e.read_shift(4);e.l+=1;var a,s=e.read_shift(4),o=parse_XLNameWideString(e),l="";try{a=parse_XLSBNameParsedFormula(e,0,r);try{l=parse_XLNullableWideString(e)}catch(e){}}catch(e){console.error("Could not parse defined name "+o)}32&i&&(o="_xlnm."+o),e.l=n;var c={Name:o,Ptg:a,Flags:i};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function write_BrtName(e,t){var r=new_buf(9),n=0,i=e.Name;XLSLblBuiltIn.indexOf(i)>-1&&(n|=32,i=i.slice(6)),r.write_shift(4,n),r.write_shift(1,0),r.write_shift(4,null==e.Sheet?4294967295:e.Sheet);var a=[r,write_XLWideString(i),write_XLSBNameParsedFormula(e.Ref,t)];if(e.Comment)a.push(write_XLNullableWideString(e.Comment));else{var s=new_buf(4);s.write_shift(4,4294967295),a.push(s)}return bconcat(a)}function parse_wb_bin(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var a=[],s=[[]];return s.SheetNames=[],s.XTI=[],XLSBRecordEnum[16]={n:"BrtFRTArchID$",f:parse_BrtFRTArchID$},recordhopper(e,(function(e,o,l){switch(l){case 156:s.SheetNames.push(e.name),r.Sheets.push(e);break;case 153:r.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=e.Ptg?stringify_formula(e.Ptg,null,null,s,t):"#REF!",delete t.SID,delete e.Ptg,a.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:s[0].length?s.push([l,e]):s[0]=[l,e],s[s.length-1].XTI=[];break;case 362:0===s.length&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(e),s.XTI=s.XTI.concat(e);break;case 35:case 37:n.push(l),i=!0;break;case 36:case 38:n.pop(),i=!1;break;default:if(o.T);else if(!i||t.WTF&&37!=n[n.length-1]&&35!=n[n.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}}),t),parse_wb_defaults(r),r.Names=a,r.supbooks=s,r}function write_BUNDLESHS(e,t){write_record(e,143);for(var r=0;r!=t.SheetNames.length;++r)write_record(e,156,write_BrtBundleSh({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]}));write_record(e,144)}function write_BrtFileVersion(e,t){t||(t=new_buf(127));for(var r=0;4!=r;++r)t.write_shift(4,0);return write_XLWideString("SheetJS",t),write_XLWideString(XLSX.version,t),write_XLWideString(XLSX.version,t),write_XLWideString("7262",t),t.length>t.l?t.slice(0,t.l):t}function write_BrtBookView(e,t){return t||(t=new_buf(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e),t.write_shift(1,120),t.length>t.l?t.slice(0,t.l):t}function write_BOOKVIEWS(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var r=t.Workbook.Sheets,n=0,i=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&-1==i?i=n:1==r[n].Hidden&&-1==a&&(a=n);a>i||(write_record(e,135),write_record(e,158,write_BrtBookView(i)),write_record(e,136))}}function write_BRTNAMES(e,t){t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach((function(r){try{if(14&r.Flags)return;write_record(e,39,write_BrtName(r,t))}catch(e){console.error("Could not serialize defined name "+JSON.stringify(r))}}))}function write_SELF_EXTERNS_xlsb(e){var t=e.SheetNames.length,r=new_buf(12*t+28);r.write_shift(4,t+2),r.write_shift(4,0),r.write_shift(4,-2),r.write_shift(4,-2),r.write_shift(4,0),r.write_shift(4,-1),r.write_shift(4,-1);for(var n=0;n<t;++n)r.write_shift(4,0),r.write_shift(4,n),r.write_shift(4,n);return r}function write_EXTERNALS_xlsb(e,t){write_record(e,353),write_record(e,357),write_record(e,362,write_SELF_EXTERNS_xlsb(t,0)),write_record(e,354)}function write_wb_bin(e,t){var r=buf_array();return write_record(r,131),write_record(r,128,write_BrtFileVersion()),write_record(r,153,write_BrtWbProp(e.Workbook&&e.Workbook.WBProps||null)),write_BOOKVIEWS(r,e,t),write_BUNDLESHS(r,e,t),write_EXTERNALS_xlsb(r,e),(e.Workbook||{}).Names&&write_BRTNAMES(r,e),write_record(r,132),r.end()}function parse_wb(e,t,r){return".bin"===t.slice(-4)?parse_wb_bin(e,r):parse_wb_xml(e,r)}function parse_ws(e,t,r,n,i,a,s,o){return".bin"===t.slice(-4)?parse_ws_bin(e,n,r,i,a,s,o):parse_ws_xml(e,n,r,i,a,s,o)}function parse_cs(e,t,r,n,i,a,s,o){return".bin"===t.slice(-4)?parse_cs_bin(e,n,r,i,a,s,o):parse_cs_xml(e,n,r,i,a,s,o)}function parse_ms(e,t,r,n,i,a,s,o){return".bin"===t.slice(-4)?parse_ms_bin(e,n,r,i,a,s,o):parse_ms_xml(e,n,r,i,a,s,o)}function parse_ds(e,t,r,n,i,a,s,o){return".bin"===t.slice(-4)?parse_ds_bin(e,n,r,i,a,s,o):parse_ds_xml(e,n,r,i,a,s,o)}function parse_sty(e,t,r,n){return".bin"===t.slice(-4)?parse_sty_bin(e,r,n):parse_sty_xml(e,r,n)}function parse_sst(e,t,r){return".bin"===t.slice(-4)?parse_sst_bin(e,r):parse_sst_xml(e,r)}function parse_cmnt(e,t,r){return".bin"===t.slice(-4)?parse_comments_bin(e,r):parse_comments_xml(e,r)}function parse_cc(e,t,r){return".bin"===t.slice(-4)?parse_cc_bin(e,t,r):parse_cc_xml(e,t,r)}function parse_xlink(e,t,r,n){return".bin"===r.slice(-4)?parse_xlink_bin(e,t,r,n):parse_xlink_xml(e,t,r,n)}function parse_xlmeta(e,t,r){return".bin"===t.slice(-4)?parse_xlmeta_bin(e,t,r):parse_xlmeta_xml(e,t,r)}var attregexg2=/\b((?:\w+:)?[\w]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,attregex2=/\b((?:\w+:)?[\w]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/,XLMLFormatMap;function xlml_parsexmltag(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),1===r.length)return n;var i,a,s,o=e.match(attregexg2);if(o)for(s=0;s!=o.length;++s)-1===(a=(i=o[s].match(attregex2))[1].indexOf(":"))?n[i[1]]=i[2].slice(1,i[2].length-1):n["xmlns:"===i[1].slice(0,6)?"xmlns"+i[1].slice(6):i[1].slice(a+1)]=i[2].slice(1,i[2].length-1);return n}function xlml_parsexmltagobj(e){var t={};if(1===e.split(/\s+/).length)return t;var r,n,i,a=e.match(attregexg2);if(a)for(i=0;i!=a.length;++i)-1===(n=(r=a[i].match(attregex2))[1].indexOf(":"))?t[r[1]]=r[2].slice(1,r[2].length-1):t["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(n+1)]=r[2].slice(1,r[2].length-1);return t}function xlml_format(e,t,r){var n=XLMLFormatMap[e]||unescapexml(e);return"General"===n?SSF_general(t):SSF_format(n,t,{date1904:!!r})}function xlml_set_custprop(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=parsexmlbool(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=parseDate(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[unescapexml(t)]=i}function safe_format_xlml(e,t,r,n){if("z"!==e.t){if(!r||!1!==r.cellText)try{"e"===e.t?e.w=e.w||BErr[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v):e.w=SSF_general(e.v):e.w=xlml_format(t||"General",e.v,n)}catch(e){if(r.WTF)throw e}try{var i=XLMLFormatMap[t]||t||"General";if(r.cellNF&&(e.z=i),r.cellDates&&"n"==e.t&&fmt_is_date(i)){var a=SSF_parse_date_code(e.v+(n?1462:0));a&&(e.t="d",e.v=new Date(Date.UTC(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u)))}}catch(e){if(r.WTF)throw e}}}function process_style_xlml(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=XLMLPatternTypeMap[n.Pattern]||n.Pattern)}e[t.ID]=t}function parse_xlml_data(e,t,r,n,i,a,s,o,l,c,d){var u="General",p=n.StyleID,h={};c=c||{};var f=[],m=0;for(void 0===p&&o&&(p=o.StyleID),void 0===p&&s&&(p=s.StyleID);void 0!==a[p];){var g=a[p];if(g.nf&&(u=g.nf),g.Interior&&f.push(g.Interior),!g.Parent)break;p=g.Parent}switch(r.Type){case"Boolean":n.t="b",n.v=parsexmlbool(e);break;case"String":n.t="s",n.r=xlml_fixstr(unescapexml(e)),n.v=e.indexOf("<")>-1?unescapexml(t||e).replace(/<[^<>]*>/g,""):n.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),n.v=datenum(parseDate(e,d),d),n.v!=n.v&&(n.v=unescapexml(e)),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===n.v&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=RBErr[e],!1!==c.cellText&&(n.w=e);break;default:""==e&&""==t?n.t="z":(n.t="s",n.v=xlml_fixstr(t||e))}if(safe_format_xlml(n,u,c,d),!1!==c.cellFormula)if(n.Formula){var _=unescapexml(n.Formula);61==_.charCodeAt(0)&&(_=_.slice(1)),n.f=rc_to_a1(_,i),delete n.Formula,"RC"==n.ArrayRange?n.F=rc_to_a1("RC:RC",i):n.ArrayRange&&(n.F=rc_to_a1(n.ArrayRange,i),l.push([safe_decode_range(n.F),n.F]))}else for(m=0;m<l.length;++m)i.r>=l[m][0].s.r&&i.r<=l[m][0].e.r&&i.c>=l[m][0].s.c&&i.c<=l[m][0].e.c&&(n.F=l[m][1]);c.cellStyles&&(f.forEach((function(e){!h.patternType&&e.patternType&&(h.patternType=e.patternType)})),n.s=h),void 0!==n.StyleID&&(n.ixfe=n.StyleID)}function xlml_prefix_dname(e){return XLSLblBuiltIn.indexOf("_xlnm."+e)>-1?"_xlnm."+e:e}function xlml_clean_comment(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function parse_xlml_xml(e,t){var r=t||{};make_ssf();var n=debom(xlml_normalize(e));"binary"!=r.type&&"array"!=r.type&&"base64"!=r.type||(n=void 0!==$cptable?$cptable.utils.decode(65001,char_codes(n)):utf8read(n));var i,a=n.slice(0,1024).toLowerCase(),s=!1;if((1023&(a=a.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&a.indexOf(","),1023&a.indexOf(";"))){var o=dup(r);return o.type="string",PRN.to_workbook(n,o)}if(-1==a.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach((function(e){a.indexOf("<"+e)>=0&&(s=!0)})),s)return html_to_workbook(n,r);XLMLFormatMap={"General Number":"General","General Date":table_fmt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":table_fmt[15],"Short Date":table_fmt[14],"Long Time":table_fmt[19],"Medium Time":table_fmt[18],"Short Time":table_fmt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:table_fmt[2],Standard:table_fmt[4],Percent:table_fmt[10],Scientific:table_fmt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[];null!=DENSE&&null==r.dense&&(r.dense=DENSE);var d={},u=[],p={},h="";r.dense&&(p["!data"]=[]);var f,m={},g={},_=xlml_parsexmltag('<Data ss:Type="String">'),b=0,v=0,y=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},S={},T="",C=0,x=[],A={},I={},D=0,k=[],L=[],P={},O=[],R=!1,N=[],B=[],F={},U=0,M=0,q={Sheets:[],WBProps:{date1904:!1}},z={};xlmlregex.lastIndex=0,n=str_remove_ng(n,"\x3c!--","--\x3e");for(var H="";i=xlmlregex.exec(n);)switch(i[3]=(H=i[3]).toLowerCase()){case"data":if("data"==H){if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==i[0].charAt(i[0].length-2)&&c.push([i[3],!0]);break}if(c[c.length-1][1])break;"/"===i[1]?parse_xlml_data(n.slice(b,i.index),T,_,"comment"==c[c.length-1][0]?P:m,{c:v,r:y},E,O[v],g,N,r,q.WBProps.date1904):(T="",_=xlml_parsexmltag(i[0]),b=i.index+i[0].length);break;case"cell":if("/"===i[1])if(L.length>0&&(m.c=L),(!r.sheetRows||r.sheetRows>y)&&void 0!==m.v&&(r.dense?(p["!data"][y]||(p["!data"][y]=[]),p["!data"][y][v]=m):p[encode_col(v)+encode_row(y)]=m),m.HRef&&(m.l={Target:unescapexml(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(U=v+(0|parseInt(m.MergeAcross,10)),M=y+(0|parseInt(m.MergeDown,10)),(U>v||M>y)&&x.push({s:{c:v,r:y},e:{c:U,r:M}})),r.sheetStubs)if(m.MergeAcross||m.MergeDown){for(var W=v;W<=U;++W)for(var j=y;j<=M;++j)(W>v||j>y)&&(r.dense?(p["!data"][j]||(p["!data"][j]=[]),p["!data"][j][W]={t:"z"}):p[encode_col(W)+encode_row(j)]={t:"z"});v=U+1}else++v;else m.MergeAcross?v=U+1:++v;else(m=xlml_parsexmltagobj(i[0])).Index&&(v=+m.Index-1),v<w.s.c&&(w.s.c=v),v>w.e.c&&(w.e.c=v),"/>"===i[0].slice(-2)&&++v,L=[];break;case"row":"/"===i[1]||"/>"===i[0].slice(-2)?(y<w.s.r&&(w.s.r=y),y>w.e.r&&(w.e.r=y),"/>"===i[0].slice(-2)&&(g=xlml_parsexmltag(i[0])).Index&&(y=+g.Index-1),v=0,++y):((g=xlml_parsexmltag(i[0])).Index&&(y=+g.Index-1),F={},("0"==g.AutoFitHeight||g.Height)&&(F.hpx=parseInt(g.Height,10),F.hpt=px2pt(F.hpx),B[y]=F),"1"==g.Hidden&&(F.hidden=!0,B[y]=F));break;case"worksheet":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"));u.push(h),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(p["!ref"]=encode_range(w),r.sheetRows&&r.sheetRows<=w.e.r&&(p["!fullref"]=p["!ref"],w.e.r=r.sheetRows-1,p["!ref"]=encode_range(w))),x.length&&(p["!merges"]=x),O.length>0&&(p["!cols"]=O),B.length>0&&(p["!rows"]=B),d[h]=p}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=v=0,c.push([i[3],!1]),l=xlml_parsexmltag(i[0]),h=unescapexml(l.Name),p={},r.dense&&(p["!data"]=[]),x=[],N=[],B=[],z={name:h,Hidden:0},q.Sheets.push(z);break;case"table":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==i[0].slice(-2))break;c.push([i[3],!1]),O=[],R=!1}break;case"style":"/"===i[1]?process_style_xlml(E,S,r):S=xlml_parsexmltag(i[0]);break;case"numberformat":S.nf=unescapexml(xlml_parsexmltag(i[0]).Format||"General"),XLMLFormatMap[S.nf]&&(S.nf=XLMLFormatMap[S.nf]);for(var V=0;392!=V&&table_fmt[V]!=S.nf;++V);if(392==V)for(V=57;392!=V;++V)if(null==table_fmt[V]){SSF__load(S.nf,V);break}break;case"column":if("table"!==c[c.length-1][0])break;if("/"===i[1])break;if((f=xlml_parsexmltag(i[0])).Hidden&&(f.hidden=!0,delete f.Hidden),f.Width&&(f.wpx=parseInt(f.Width,10)),!R&&f.wpx>10){R=!0,MDW=DEF_MDW;for(var $=0;$<O.length;++$)O[$]&&process_col(O[$])}R&&process_col(f),O[f.Index-1||O.length]=f;for(var G=0;G<+f.Span;++G)O[O.length]=dup(f);break;case"namedrange":if("/"===i[1])break;q.Names||(q.Names=[]);var X=parsexmltag(i[0]),K={Name:xlml_prefix_dname(X.Name),Ref:rc_to_a1(X.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(K.Sheet=q.Sheets.length-1),q.Names.push(K);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===i[0].slice(-2))break;"/"===i[1]?T+=n.slice(C,i.index):C=i.index+i[0].length;break;case"interior":if(!r.cellStyles)break;S.Interior=xlml_parsexmltag(i[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===i[0].slice(-2))break;"/"===i[1]?xlml_set_prop(A,H,n.slice(D,i.index)):D=i.index+i[0].length;break;case"styles":case"workbook":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else c.push([i[3],!1]);break;case"comment":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"));xlml_clean_comment(P),L.push(P)}else c.push([i[3],!1]),parsexmlbool((l=xlml_parsexmltag(i[0])).ShowAlways||"0")||(L.hidden=!0),P={a:l.Author};break;case"autofilter":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==i[0].charAt(i[0].length-2)){var Y=xlml_parsexmltag(i[0]);p["!autofilter"]={ref:rc_to_a1(Y.Range).replace(/\$/g,"")},c.push([i[3],!0])}break;case"datavalidation":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==i[0].charAt(i[0].length-2)&&c.push([i[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==i[0].charAt(i[0].length-2)&&c.push([i[3],!0]);break;default:if(0==c.length&&"document"==i[3])return parse_fods(n,r);if(0==c.length&&"uof"==i[3])return parse_fods(n,r);var Q=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(i[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:Q=!1}break;case"componentoptions":switch(i[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:Q=!1}break;case"excelworkbook":switch(i[3]){case"date1904":q.WBProps.date1904=!0;break;case"hidehorizontalscrollbar":case"hideverticalscrollbar":case"hideworkbooktabs":case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:Q=!1}break;case"workbookoptions":switch(i[3]){case"owcversion":case"height":case"width":break;default:Q=!1}break;case"worksheetoptions":switch(i[3]){case"visible":if("/>"===i[0].slice(-2));else if("/"===i[1])switch(n.slice(D,i.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2}else D=i.index+i[0].length;break;case"header":p["!margins"]||default_margins(p["!margins"]={},"xlml"),isNaN(+parsexmltag(i[0]).Margin)||(p["!margins"].header=+parsexmltag(i[0]).Margin);break;case"footer":p["!margins"]||default_margins(p["!margins"]={},"xlml"),isNaN(+parsexmltag(i[0]).Margin)||(p["!margins"].footer=+parsexmltag(i[0]).Margin);break;case"pagemargins":var Z=parsexmltag(i[0]);p["!margins"]||default_margins(p["!margins"]={},"xlml"),isNaN(+Z.Top)||(p["!margins"].top=+Z.Top),isNaN(+Z.Left)||(p["!margins"].left=+Z.Left),isNaN(+Z.Right)||(p["!margins"].right=+Z.Right),isNaN(+Z.Bottom)||(p["!margins"].bottom=+Z.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;default:Q=!1}break;case"pivottable":case"pivotcache":switch(i[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:Q=!1}break;case"pagebreaks":switch(i[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:Q=!1}break;case"autofilter":switch(i[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:Q=!1}break;case"querytable":switch(i[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:Q=!1}break;case"datavalidation":switch(i[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:Q=!1}break;case"sorting":case"conditionalformatting":switch(i[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:Q=!1}break;case"mapinfo":case"schema":case"data":switch(i[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:Q=!1}break;case"smarttags":break;default:Q=!1}if(Q)break;if(i[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+i[3]+"|"+c.join("|");if("customdocumentproperties"===c[c.length-1][0]){if("/>"===i[0].slice(-2))break;"/"===i[1]?xlml_set_custprop(I,H,k,n.slice(D,i.index)):(k=i,D=i.index+i[0].length);break}if(r.WTF)throw"Unrecognized tag: "+i[3]+"|"+c.join("|")}var J={};return r.bookSheets||r.bookProps||(J.Sheets=d),J.SheetNames=u,J.Workbook=q,J.SSF=dup(table_fmt),J.Props=A,J.Custprops=I,J.bookType="xlml",J}function parse_xlml(e,t){switch(fix_read_opts(t=t||{}),t.type||"base64"){case"base64":return parse_xlml_xml(Base64_decode(e),t);case"binary":case"buffer":case"file":return parse_xlml_xml(e,t);case"array":return parse_xlml_xml(a2s(e),t)}}function write_props_xlml(e,t){var r=[];return e.Props&&r.push(xlml_write_docprops(e.Props,t)),e.Custprops&&r.push(xlml_write_custprops(e.Props,e.Custprops,t)),r.join("")}function write_wb_xlml(e){return(((e||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function write_sty_xlml(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach((function(e,t){var n=[];n.push(writextag("NumberFormat",null,{"ss:Format":escapexml(table_fmt[e.numFmtId])}));var i={"ss:ID":"s"+(21+t)};r.push(writextag("Style",n.join(""),i))})),writextag("Styles",r.join(""))}function write_name_xlml(e){return writextag("NamedRange",null,{"ss:Name":"_xlnm."==e.Name.slice(0,6)?e.Name.slice(6):e.Name,"ss:RefersTo":"="+a1_to_rc(e.Ref,{r:0,c:0})})}function write_names_xlml(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];null==i.Sheet&&(i.Name.match(/^_xlfn\./)||r.push(write_name_xlml(i)))}return writextag("Names",r.join(""))}function write_ws_xlml_names(e,t,r,n){if(!e)return"";if(!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,a=[],s=0;s<i.length;++s){var o=i[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(write_name_xlml(o)))}return a.join("")}function write_ws_xlml_wsopts(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(writextag("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(writextag("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(writextag("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(writextag("Visible",1==n.Workbook.Sheets[r].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&(!n.Workbook.Sheets[a]||n.Workbook.Sheets[a].Hidden);++a);a==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(writetag("ProtectContents","True")),e["!protect"].objects&&i.push(writetag("ProtectObjects","True")),e["!protect"].scenarios&&i.push(writetag("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||i.push(writetag("EnableSelection","UnlockedCells")):i.push(writetag("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach((function(t){e["!protect"][t[0]]&&i.push("<"+t[1]+"/>")}))),0==i.length?"":writextag("WorksheetOptions",i.join(""),{xmlns:XLMLNS.x})}function write_ws_xlml_comment(e){return e.map((function(t){var r=writextag("ss:Data",xlml_unfixstr(t.t||""),{xmlns:"http://www.w3.org/TR/REC-html40"}),n={};return t.a&&(n["ss:Author"]=t.a),e.hidden||(n["ss:ShowAlways"]="1"),writextag("Comment",r,n)})).join("")}function write_ws_xlml_cell(e,t,r,n,i,a,s){if(!e||null==e.v&&null==e.f)return"";var o={};if(e.f&&(o["ss:Formula"]="="+escapexml(a1_to_rc(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=decode_cell(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=escapexml(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=escapexml(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],d=0;d!=c.length;++d)c[d].s.c==s.c&&c[d].s.r==s.r&&(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var u="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":isFinite(e.v)?(u="Number",p=String(e.v)):(u="Error",p=BErr[isNaN(e.v)?36:7]);break;case"b":u="Boolean",p=e.v?"1":"0";break;case"e":u="Error",p=BErr[e.v];break;case"d":u="DateTime",p=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||table_fmt[14]);break;case"s":u="String",p=escapexlml(e.v||"")}var h=get_cell_style(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=s.c+1;var f=null!=e.v?p:"",m="z"==e.t?"":'<Data ss:Type="'+u+'">'+f+"</Data>";return(e.c||[]).length>0&&(m+=write_ws_xlml_comment(e.c)),writextag("Cell",m,o)}function write_ws_xlml_row(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=pt2px(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function write_ws_xlml_table(e,t,r,n){if(!e["!ref"])return"";var i=safe_decode_range(e["!ref"]),a=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach((function(e,t){process_col(e);var r=!!e.width,n=col_obj_w(t,e),i={"ss:Index":t+1};r&&(i["ss:Width"]=width2px(n.width)),e.hidden&&(i["ss:Hidden"]="1"),o.push(writextag("Column",null,i))}));for(var l=null!=e["!data"],c={r:0,c:0},d=i.s.r;d<=i.e.r;++d){var u=[write_ws_xlml_row(d,(e["!rows"]||[])[d])];c.r=d;for(var p=i.s.c;p<=i.e.c;++p){c.c=p;var h=!1;for(s=0;s!=a.length;++s)if(!(a[s].s.c>p||a[s].s.r>d||a[s].e.c<p||a[s].e.r<d)){a[s].s.c==p&&a[s].s.r==d||(h=!0);break}if(!h){var f=encode_col(p)+encode_row(d),m=l?(e["!data"][d]||[])[p]:e[f];u.push(write_ws_xlml_cell(m,f,e,t,r,n,c))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function write_ws_xlml(e,t,r){var n=[],i=r.SheetNames[e],a=r.Sheets[i],s=a?write_ws_xlml_names(a,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),(s=a?write_ws_xlml_table(a,t,e,r):"").length>0&&n.push("<Table>"+s+"</Table>"),n.push(write_ws_xlml_wsopts(a,t,e,r)),a&&a["!autofilter"]&&n.push('<AutoFilter x:Range="'+a1_to_rc(fix_range(a["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),n.join("")}function write_xlml(e,t){t||(t={}),e.SSF||(e.SSF=dup(table_fmt)),e.SSF&&(make_ssf(),SSF_load_table(e.SSF),t.revssf=evert_num(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],get_cell_style(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(write_props_xlml(e,t)),r.push(write_wb_xlml(e,t)),r.push(""),r.push(write_names_xlml(e,t));for(var n=0;n<e.SheetNames.length;++n)r.push(writextag("Worksheet",write_ws_xlml(n,t,e),{"ss:Name":escapexml(e.SheetNames[n])}));return r[2]=write_sty_xlml(e,t),XML_HEADER+writextag("Workbook",r.join(""),{xmlns:XLMLNS.ss,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:ss":XLMLNS.ss,"xmlns:dt":XLMLNS.dt,"xmlns:html":XLMLNS.html})}function parse_compobj(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=parse_ClipboardFormatOrAnsiString(r),r.length-r.l<=4)return t;var n=r.read_shift(4);return 0==n||n>40?t:(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4||1907505652!==(n=r.read_shift(4))?t:(t.UnicodeClipboardFormat=parse_ClipboardFormatOrUnicodeString(r),0==(n=r.read_shift(4))||n>40?t:(r.l-=4,void(t.Reserved2=r.read_shift(0,"lpwstr")))))}var CONTINUE_RT=[60,1084,2066,2165,2175];function slurp(e,t,r,n,i){var a=n,s=[],o=r.slice(r.l,r.l+a);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:i.enc.insitu(o)}s.push(o),r.l+=a;for(var l=__readUInt16LE(r,r.l),c=XLSRecordEnum[l],d=0;null!=c&&CONTINUE_RT.indexOf(l)>-1;)a=__readUInt16LE(r,r.l+2),d=r.l+4,2066==l?d+=4:2165!=l&&2175!=l||(d+=12),o=r.slice(d,r.l+4+a),s.push(o),r.l+=4+a,c=XLSRecordEnum[l=__readUInt16LE(r,r.l)];var u=bconcat(s);prep_blob(u,0);var p=0;u.lens=[];for(var h=0;h<s.length;++h)u.lens.push(p),p+=s[h].length;if(u.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+n;return t.f(u,u.length,i)}function safe_format_xf(e,t,r){if("z"!==e.t&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&null==e.z&&(e.z=table_fmt[n])}catch(e){if(t.WTF)throw e}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||BErr[e.v]:0===n||"General"==n?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v):e.w=SSF_general(e.v):e.w=SSF_format(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(e){if(t.WTF)throw e}if(t.cellDates&&n&&"n"==e.t&&fmt_is_date(table_fmt[n]||String(n))){var i=SSF_parse_date_code(e.v+(r?1462:0));i&&(e.t="d",e.v=new Date(Date.UTC(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u)))}}}function make_cell(e,t,r){return{v:e,ixfe:t,t:r}}function parse_workbook(e,t){var r={opts:{}},n={};null!=DENSE&&null==t.dense&&(t.dense=DENSE);var i={};t.dense&&(i["!data"]=[]);var a,s,o,l,c,d,u,p,h={},f={},m=null,g=[],_="",b={},v="",y={},w=[],E=[],S=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},C={},x=!1,A=function(e){return e<8?XLSIcv[e]:e<64&&S[e-8]||XLSIcv[e]},I=function(e,t,r){if((x||!(U>1))&&!(r.sheetRows&&e.r>=r.sheetRows)){if(r.cellStyles&&t.XF&&t.XF.data&&function(e,t){var r,n=e.XF.data;n&&n.patternType&&t&&t.cellStyles&&(e.s={},e.s.patternType=n.patternType,(r=rgb2Hex(A(n.icvFore)))&&(e.s.fgColor={rgb:r}),(r=rgb2Hex(A(n.icvBack)))&&(e.s.bgColor={rgb:r}))}(t,r),delete t.ixfe,delete t.XF,a=e,v=encode_cell(e),f&&f.s&&f.e||(f={s:{r:0,c:0},e:{r:0,c:0}}),e.r<f.s.r&&(f.s.r=e.r),e.c<f.s.c&&(f.s.c=e.c),e.r+1>f.e.r&&(f.e.r=e.r+1),e.c+1>f.e.c&&(f.e.c=e.c+1),r.cellFormula&&t.f)for(var n=0;n<w.length;++n)if(!(w[n][0].s.c>e.c||w[n][0].s.r>e.r||w[n][0].e.c<e.c||w[n][0].e.r<e.r)){t.F=encode_range(w[n][0]),w[n][0].s.c==e.c&&w[n][0].s.r==e.r||delete t.f,t.f&&(t.f=""+stringify_formula(w[n][1],f,e,N,D));break}r.dense?(i["!data"][e.r]||(i["!data"][e.r]=[]),i["!data"][e.r][e.c]=t):i[v]=t}},D={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(D.password=t.password);var k=[],L=[],P=[],O=[],R=!1,N=[];N.SheetNames=D.snames,N.sharedf=D.sharedf,N.arrayf=D.arrayf,N.names=[],N.XTI=[];var B,F=0,U=0,M=0,q=[],z=[];D.codepage=1200,set_cp(1200);for(var H=!1;e.l<e.length-1;){var W=e.l,j=e.read_shift(2);if(0===j&&10===F)break;var V=e.l===e.length?0:e.read_shift(2),$=XLSRecordEnum[j];if(0==U&&-1==[9,521,1033,2057].indexOf(j))break;if($&&$.f){if(t.bookSheets&&133===F&&133!==j)break;if(F=j,2===$.r||12==$.r){var G=e.read_shift(2);if(V-=2,!D.enc&&G!==j&&((255&G)<<8|G>>8)!==j)throw new Error("rt mismatch: "+G+"!="+j);12==$.r&&(e.l+=10,V-=10)}var X={};if(X=10===j?$.f(e,V,D):slurp(j,$,e,V,D),0==U&&-1===[9,521,1033,2057].indexOf(F))continue;switch(j){case 34:r.opts.Date1904=T.WBProps.date1904=X;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(e.l=0),D.enc=X,!t.password)throw new Error("File is password-protected");if(null==X.valid)throw new Error("Encryption scheme unsupported");if(!X.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=X;break;case 66:var K=Number(X);switch(K){case 21010:K=1200;break;case 32768:K=1e4;break;case 32769:K=1252}set_cp(D.codepage=K),H=!0;break;case 317:D.rrtabid=X;break;case 25:D.winlocked=X;break;case 439:r.opts.RefreshAll=X;break;case 12:r.opts.CalcCount=X;break;case 16:r.opts.CalcDelta=X;break;case 17:r.opts.CalcIter=X;break;case 13:r.opts.CalcMode=X;break;case 14:r.opts.CalcPrecision=X;break;case 95:r.opts.CalcSaveRecalc=X;break;case 15:D.CalcRefMode=X;break;case 2211:r.opts.FullCalc=X;break;case 129:X.fDialog&&(i["!type"]="dialog"),X.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),X.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 67:case 579:case 1091:case 224:E.push(X);break;case 430:N.push([X]),N[N.length-1].XTI=[];break;case 35:case 547:N[N.length-1].push(X);break;case 24:case 536:B={Name:X.Name,Ref:stringify_formula(X.rgce,f,null,N,D)},X.itab>0&&(B.Sheet=X.itab-1),N.names.push(B),N[0]||(N[0]=[],N[0].XTI=[]),N[N.length-1].push(X),"_xlnm._FilterDatabase"==X.Name&&X.itab>0&&X.rgce&&X.rgce[0]&&X.rgce[0][0]&&"PtgArea3d"==X.rgce[0][0][0]&&(z[X.itab-1]={ref:encode_range(X.rgce[0][0][1][2])});break;case 22:D.ExternCount=X;break;case 23:0==N.length&&(N[0]=[],N[0].XTI=[]),N[N.length-1].XTI=N[N.length-1].XTI.concat(X),N.XTI=N.XTI.concat(X);break;case 2196:if(D.biff<8)break;null!=B&&(B.Comment=X[1]);break;case 18:i["!protect"]=X;break;case 19:0!==X&&D.WTF&&console.error("Password verifier: "+X);break;case 133:h[4==D.biff?D.snames.length:X.pos]=X,D.snames.push(X.name);break;case 10:if(--U?!x:x)break;if(f.e){if(f.e.r>0&&f.e.c>0){if(f.e.r--,f.e.c--,i["!ref"]=encode_range(f),t.sheetRows&&t.sheetRows<=f.e.r){var Y=f.e.r;f.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=encode_range(f),f.e.r=Y}f.e.r++,f.e.c++}k.length>0&&(i["!merges"]=k),L.length>0&&(i["!objects"]=L),P.length>0&&(i["!cols"]=P),O.length>0&&(i["!rows"]=O),T.Sheets.push(C)}""===_?b=i:n[_]=i,i={},t.dense&&(i["!data"]=[]);break;case 9:case 521:case 1033:case 2057:if(8===D.biff&&(D.biff={9:2,521:3,1033:4}[j]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[X.BIFFVer]||8),D.biffguess=0==X.BIFFVer,0==X.BIFFVer&&4096==X.dt&&(D.biff=5,H=!0,set_cp(D.codepage=28591)),4==D.biff&&256&X.dt&&(x=!0),8==D.biff&&0==X.BIFFVer&&16==X.dt&&(D.biff=2),U++&&!x)break;if(i={},t.dense&&(i["!data"]=[]),D.biff<8&&!H&&(H=!0,set_cp(D.codepage=t.codepage||1252)),4==D.biff&&x)_=(h[D.snames.indexOf(_)+1]||{name:""}).name;else if(D.biff<5||0==X.BIFFVer&&4096==X.dt){""===_&&(_="Sheet1"),f={s:{r:0,c:0},e:{r:0,c:0}};var Q={pos:e.l-V,name:_};h[Q.pos]=Q,D.snames.push(_)}else _=(h[W]||{name:""}).name;32==X.dt&&(i["!type"]="chart"),64==X.dt&&(i["!type"]="macro"),k=[],L=[],D.arrayf=w=[],P=[],O=[],R=!1,C={Hidden:(h[W]||{hs:0}).hs,name:_};break;case 515:case 3:case 2:"chart"==i["!type"]&&(t.dense?(i["!data"][X.r]||[])[X.c]:i[encode_col(X.c)+encode_row(X.r)])&&++X.c,d={ixfe:X.ixfe,XF:E[X.ixfe]||{},v:X.val,t:"n"},M>0&&(d.z=d.XF&&d.XF.numFmtId&&q[d.XF.numFmtId]||q[d.ixfe>>8&63]),safe_format_xf(d,t,r.opts.Date1904),I({c:X.c,r:X.r},d,t);break;case 5:case 517:d={ixfe:X.ixfe,XF:E[X.ixfe],v:X.val,t:X.t},M>0&&(d.z=d.XF&&d.XF.numFmtId&&q[d.XF.numFmtId]||q[d.ixfe>>8&63]),safe_format_xf(d,t,r.opts.Date1904),I({c:X.c,r:X.r},d,t);break;case 638:d={ixfe:X.ixfe,XF:E[X.ixfe],v:X.rknum,t:"n"},M>0&&(d.z=d.XF&&d.XF.numFmtId&&q[d.XF.numFmtId]||q[d.ixfe>>8&63]),safe_format_xf(d,t,r.opts.Date1904),I({c:X.c,r:X.r},d,t);break;case 189:for(var Z=X.c;Z<=X.C;++Z){var J=X.rkrec[Z-X.c][0];d={ixfe:J,XF:E[J],v:X.rkrec[Z-X.c][1],t:"n"},M>0&&(d.z=d.XF&&d.XF.numFmtId&&q[d.XF.numFmtId]||q[d.ixfe>>8&63]),safe_format_xf(d,t,r.opts.Date1904),I({c:Z,r:X.r},d,t)}break;case 6:case 518:case 1030:if("String"==X.val){m=X;break}if((d=make_cell(X.val,X.cell.ixfe,X.tt)).XF=E[d.ixfe],t.cellFormula){var ee=X.formula;if(ee&&ee[0]&&ee[0][0]&&"PtgExp"==ee[0][0][0]){var te=ee[0][0][1][0],re=ee[0][0][1][1],ne=encode_cell({r:te,c:re});y[ne]?d.f=""+stringify_formula(X.formula,f,X.cell,N,D):d.F=((t.dense?(i["!data"][te]||[])[re]:i[ne])||{}).F}else d.f=""+stringify_formula(X.formula,f,X.cell,N,D)}M>0&&(d.z=d.XF&&d.XF.numFmtId&&q[d.XF.numFmtId]||q[d.ixfe>>8&63]),safe_format_xf(d,t,r.opts.Date1904),I(X.cell,d,t),m=X;break;case 7:case 519:if(!m)throw new Error("String record expects Formula");m.val=X,(d=make_cell(X,m.cell.ixfe,"s")).XF=E[d.ixfe],t.cellFormula&&(d.f=""+stringify_formula(m.formula,f,m.cell,N,D)),M>0&&(d.z=d.XF&&d.XF.numFmtId&&q[d.XF.numFmtId]||q[d.ixfe>>8&63]),safe_format_xf(d,t,r.opts.Date1904),I(m.cell,d,t),m=null;break;case 33:case 545:w.push(X);var ie=encode_cell(X[0].s);if(s=t.dense?(i["!data"][X[0].s.r]||[])[X[0].s.c]:i[ie],t.cellFormula&&s){if(!m)break;if(!ie||!s)break;s.f=""+stringify_formula(X[1],f,X[0],N,D),s.F=encode_range(X[0])}break;case 1212:if(!t.cellFormula)break;if(v){if(!m)break;y[encode_cell(m.cell)]=X[0],((s=t.dense?(i["!data"][m.cell.r]||[])[m.cell.c]:i[encode_cell(m.cell)])||{}).f=""+stringify_formula(X[0],f,a,N,D)}break;case 253:d=make_cell(g[X.isst].t,X.ixfe,"s"),g[X.isst].h&&(d.h=g[X.isst].h),d.XF=E[d.ixfe],M>0&&(d.z=d.XF&&d.XF.numFmtId&&q[d.XF.numFmtId]||q[d.ixfe>>8&63]),safe_format_xf(d,t,r.opts.Date1904),I({c:X.c,r:X.r},d,t);break;case 513:t.sheetStubs&&(d={ixfe:X.ixfe,XF:E[X.ixfe],t:"z"},M>0&&(d.z=d.XF&&d.XF.numFmtId&&q[d.XF.numFmtId]||q[d.ixfe>>8&63]),safe_format_xf(d,t,r.opts.Date1904),I({c:X.c,r:X.r},d,t));break;case 190:if(t.sheetStubs)for(var ae=X.c;ae<=X.C;++ae){var se=X.ixfe[ae-X.c];d={ixfe:se,XF:E[se],t:"z"},M>0&&(d.z=d.XF&&d.XF.numFmtId&&q[d.XF.numFmtId]||q[d.ixfe>>8&63]),safe_format_xf(d,t,r.opts.Date1904),I({c:ae,r:X.r},d,t)}break;case 214:case 516:case 4:(d=make_cell(X.val,X.ixfe,"s")).XF=E[d.ixfe],M>0&&(d.z=d.XF&&d.XF.numFmtId&&q[d.XF.numFmtId]||q[d.ixfe>>8&63]),safe_format_xf(d,t,r.opts.Date1904),I({c:X.c,r:X.r},d,t);break;case 0:case 512:1===U&&(f=X);break;case 252:g=X;break;case 1054:if(D.biff>=3&&D.biff<=4){q[M++]=X[1];for(var oe=0;oe<M+163&&table_fmt[oe]!=X[1];++oe);oe>=163&&SSF__load(X[1],M+163)}else SSF__load(X[1],X[0]);break;case 30:q[M++]=X;for(var le=0;le<M+163&&table_fmt[le]!=X;++le);le>=163&&SSF__load(X,M+163);break;case 229:k=k.concat(X);break;case 93:L[X.cmo[0]]=D.lastobj=X;break;case 438:D.lastobj.TxO=X;break;case 127:D.lastobj.ImData=X;break;case 440:for(c=X[0].s.r;c<=X[0].e.r;++c)for(l=X[0].s.c;l<=X[0].e.c;++l)(s=t.dense?(i["!data"][c]||[])[l]:i[encode_cell({c:l,r:c})])&&(s.l=X[1]);break;case 2048:for(c=X[0].s.r;c<=X[0].e.r;++c)for(l=X[0].s.c;l<=X[0].e.c;++l)(s=t.dense?(i["!data"][c]||[])[l]:i[encode_cell({c:l,r:c})])&&s.l&&(s.l.Tooltip=X[1]);break;case 28:if((s=t.dense?(i["!data"][X[0].r]||[])[X[0].c]:i[encode_cell(X[0])])||(t.dense?(i["!data"][X[0].r]||(i["!data"][X[0].r]=[]),s=i["!data"][X[0].r][X[0].c]={t:"z"}):s=i[encode_cell(X[0])]={t:"z"},f.e.r=Math.max(f.e.r,X[0].r),f.s.r=Math.min(f.s.r,X[0].r),f.e.c=Math.max(f.e.c,X[0].c),f.s.c=Math.min(f.s.c,X[0].c)),s.c||(s.c=[]),D.biff<=5&&D.biff>=2)o={a:"SheetJ5",t:X[1]};else{var ce=L[X[2]];o={a:X[1],t:ce.TxO.t},null==X[3]||2&X[3]||(s.c.hidden=!0)}s.c.push(o);break;case 2173:update_xfext(E[X.ixfe],X.ext);break;case 125:if(!D.cellStyles)break;for(;X.e>=X.s;)P[X.e--]={width:X.w/256,level:X.level||0,hidden:!!(1&X.flags)},R||(R=!0,find_mdw_colw(X.w/256)),process_col(P[X.e+1]);break;case 520:var de={};null!=X.level&&(O[X.r]=de,de.level=X.level),X.hidden&&(O[X.r]=de,de.hidden=!0),X.hpt&&(O[X.r]=de,de.hpt=X.hpt,de.hpx=pt2px(X.hpt));break;case 38:case 39:case 40:case 41:i["!margins"]||default_margins(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[j]]=X;break;case 161:i["!margins"]||default_margins(i["!margins"]={}),i["!margins"].header=X.header,i["!margins"].footer=X.footer;break;case 574:X.RTL&&(T.Views[0].RTL=!0);break;case 146:S=X;break;case 2198:p=X;break;case 140:u=X;break;case 442:_?C.CodeName=X||C.name:T.WBProps.CodeName=X||"ThisWorkbook"}}else $||console.error("Missing Info for XLS Record 0x"+j.toString(16)),e.l+=V}return r.SheetNames=keys(h).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return h[e].name})),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&b["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=b)):r.Preamble=b,r.Sheets&&z.forEach((function(e,t){r.Sheets[r.SheetNames[t]]["!autofilter"]=e})),r.Strings=g,r.SSF=dup(table_fmt),D.enc&&(r.Encryption=D.enc),p&&(r.Themes=p),r.Metadata={},void 0!==u&&(r.Metadata.Country=u),N.names.length>0&&(T.Names=N.names),r.Workbook=T,r}var PSCLSID={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function parse_xls_props(e,t,r){var n=CFB.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=parse_PropertySetStream(n,DocSummaryPIDDSI,PSCLSID.DSI);for(var a in i)t[a]=i[a]}catch(e){if(r.WTF)throw e}var s=CFB.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=parse_PropertySetStream(s,SummaryPIDSI,PSCLSID.SI);for(var l in o)null==t[l]&&(t[l]=o[l])}catch(e){if(r.WTF)throw e}t.HeadingPairs&&t.TitlesOfParts&&(load_props_pairs(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function write_xls_props(e,t){var r,n=[],i=[],a=[],s=0,o=evert_key(DocSummaryPIDDSI,"n"),l=evert_key(SummaryPIDSI,"n");if(e.Props)for(r=keys(e.Props),s=0;s<r.length;++s)(Object.prototype.hasOwnProperty.call(o,r[s])?n:Object.prototype.hasOwnProperty.call(l,r[s])?i:a).push([r[s],e.Props[r[s]]]);if(e.Custprops)for(r=keys(e.Custprops),s=0;s<r.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},r[s])||(Object.prototype.hasOwnProperty.call(o,r[s])?n:Object.prototype.hasOwnProperty.call(l,r[s])?i:a).push([r[s],e.Custprops[r[s]]]);var c=[];for(s=0;s<a.length;++s)XLSPSSkip.indexOf(a[s][0])>-1||PseudoPropsPairs.indexOf(a[s][0])>-1||null!=a[s][1]&&c.push(a[s]);i.length&&CFB.utils.cfb_add(t,"/SummaryInformation",write_PropertySetStream(i,PSCLSID.SI,l,SummaryPIDSI)),(n.length||c.length)&&CFB.utils.cfb_add(t,"/DocumentSummaryInformation",write_PropertySetStream(n,PSCLSID.DSI,o,DocSummaryPIDDSI,c.length?c:null,PSCLSID.UDI))}function parse_xlscfb(e,t){var r,n,i,a;if(t||(t={}),fix_read_opts(t),reset_cp(),t.codepage&&set_ansi(t.codepage),e.FullPaths){if(CFB.find(e,"/encryption"))throw new Error("File is password-protected");r=CFB.find(e,"!CompObj"),n=CFB.find(e,"/Workbook")||CFB.find(e,"/Book")}else{switch(t.type){case"base64":e=s2a(Base64_decode(e));break;case"binary":e=s2a(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}prep_blob(e,0),n={content:e}}if(r&&parse_compobj(r),t.bookProps&&!t.bookSheets)i={};else{var s=has_buf?"buffer":"array";if(n&&n.content)i=parse_workbook(n.content,t);else if((a=CFB.find(e,"PerfectOffice_MAIN"))&&a.content)i=WK_.to_workbook(a.content,(t.type=s,t));else{if(!(a=CFB.find(e,"NativeContent_MAIN"))||!a.content)throw(a=CFB.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");i=WK_.to_workbook(a.content,(t.type=s,t))}t.bookVBA&&e.FullPaths&&CFB.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=make_vba_xls(e))}var o={};return e.FullPaths&&parse_xls_props(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}function write_xlscfb(e,t){var r=t||{},n=CFB.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return CFB.utils.cfb_add(n,i,write_biff_buf(e,r)),8==r.biff&&(e.Props||e.Custprops)&&write_xls_props(e,n),8==r.biff&&e.vbaraw&&fill_vba_xls(n,CFB.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),n}var XLSBRecordEnum={0:{f:parse_BrtRowHdr},1:{f:parse_BrtCellBlank},2:{f:parse_BrtCellRk},3:{f:parse_BrtCellError},4:{f:parse_BrtCellBool},5:{f:parse_BrtCellReal},6:{f:parse_BrtCellSt},7:{f:parse_BrtCellIsst},8:{f:parse_BrtFmlaString},9:{f:parse_BrtFmlaNum},10:{f:parse_BrtFmlaBool},11:{f:parse_BrtFmlaError},12:{f:parse_BrtShortBlank},13:{f:parse_BrtShortRk},14:{f:parse_BrtShortError},15:{f:parse_BrtShortBool},16:{f:parse_BrtShortReal},17:{f:parse_BrtShortSt},18:{f:parse_BrtShortIsst},19:{f:parse_RichStr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:parse_BrtName},40:{},42:{},43:{f:parse_BrtFont},44:{f:parse_BrtFmt},45:{f:parse_BrtFill},46:{f:parse_BrtBorder},47:{f:parse_BrtXF},48:{},49:{f:parse_Int32LE},50:{},51:{f:parse_BrtMdb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:parse_ColInfo},62:{f:parse_BrtCellRString},63:{f:parse_BrtCalcChainItem$},64:{f:parse_BrtDVal},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:parsenoop,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:parse_BrtBeginWsView},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:parse_BrtWsProp},148:{f:parse_BrtWsDim,p:16},151:{f:parse_BrtPane},152:{},153:{f:parse_BrtWbProp},154:{},155:{},156:{f:parse_BrtBundleSh},157:{},158:{},159:{T:1,f:parse_BrtBeginSst},160:{T:-1},161:{T:1,f:parse_UncheckedRfX},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:parse_BrtMergeCell},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:parse_BrtMdtinfo},336:{T:-1},337:{f:parse_BrtBeginEsmdb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:parse_RelID},357:{},358:{},359:{},360:{T:1},361:{},362:{f:parse_ExternSheet},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:parse_BrtArrFmla},427:{f:parse_BrtShrFmla},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:parse_BrtMargins},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:parse_BrtWsFmtInfo},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:parse_BrtHLink},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:parse_RelID},551:{f:parse_XLNullableWideString},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:parse_BrtCommentAuthor},633:{T:1},634:{T:-1},635:{T:1,f:parse_BrtBeginComment},636:{T:-1},637:{f:parse_BrtCommentText},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:parse_BrtCsProp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:parse_BrtDVal14},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},XLSRecordEnum={6:{f:parse_Formula},10:{f:parsenoop2},12:{f:parseuint16},13:{f:parseuint16},14:{f:parsebool},15:{f:parsebool},16:{f:parse_Xnum},17:{f:parsebool},18:{f:parsebool},19:{f:parseuint16},20:{f:parse_XLHeaderFooter},21:{f:parse_XLHeaderFooter},23:{f:parse_ExternSheet},24:{f:parse_Lbl},25:{f:parsebool},26:{},27:{},28:{f:parse_Note},29:{},34:{f:parsebool},35:{f:parse_ExternName},38:{f:parse_Xnum},39:{f:parse_Xnum},40:{f:parse_Xnum},41:{f:parse_Xnum},42:{f:parsebool},43:{f:parsebool},47:{f:parse_FilePass},49:{f:parse_Font},51:{f:parseuint16},60:{},61:{f:parse_Window1},64:{f:parsebool},65:{f:parse_Pane},66:{f:parseuint16},77:{},80:{},81:{},82:{},85:{f:parseuint16},89:{},90:{},91:{},92:{f:parse_WriteAccess},93:{f:parse_Obj},94:{},95:{f:parsebool},96:{},97:{},99:{f:parsebool},125:{f:parse_ColInfo},128:{f:parse_Guts},129:{f:parse_WsBool},130:{f:parseuint16},131:{f:parsebool},132:{f:parsebool},133:{f:parse_BoundSheet8},134:{},140:{f:parse_Country},141:{f:parseuint16},144:{},146:{f:parse_Palette},151:{},152:{},153:{},154:{},155:{},156:{f:parseuint16},157:{},158:{},160:{f:parse_Scl},161:{f:parse_Setup},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:parse_MulRk},190:{f:parse_MulBlank},193:{f:parsenoop2},197:{},198:{},199:{},200:{},201:{},202:{f:parsebool},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:parseuint16},220:{},221:{f:parsebool},222:{},224:{f:parse_XF},225:{f:parse_InterfaceHdr},226:{f:parsenoop2},227:{},229:{f:parse_MergeCells},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:parse_SST},253:{f:parse_LabelSst},255:{f:parse_ExtSST},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:parseuint16a},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:parsebool},353:{f:parsenoop2},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:parse_SupBook},431:{f:parsebool},432:{},433:{},434:{},437:{},438:{f:parse_TxO},439:{f:parsebool},440:{f:parse_HLink},441:{},442:{f:parse_XLUnicodeString},443:{},444:{f:parseuint16},445:{},446:{},448:{f:parsenoop2},449:{f:parse_RecalcId,r:2},450:{f:parsenoop2},512:{f:parse_Dimensions},513:{f:parse_Blank},515:{f:parse_Number},516:{f:parse_Label},517:{f:parse_BoolErr},519:{f:parse_String},520:{f:parse_Row},523:{},545:{f:parse_Array},549:{f:parse_DefaultRowHeight},566:{},574:{f:parse_Window2},638:{f:parse_RK},659:{},1048:{},1054:{f:parse_Format},1084:{},1212:{f:parse_ShrFmla},2048:{f:parse_HLinkTooltip},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:parse_BOF},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:parsenoop2},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:parse_XFCRC,r:12},2173:{f:parse_XFExt,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:parsebool,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:parse_NameCmt,r:12},2197:{},2198:{f:parse_Theme,r:12},2199:{},2200:{},2201:{},2202:{f:parse_MTRSettings,r:12},2203:{f:parsenoop2},2204:{},2205:{},2206:{},2207:{},2211:{f:parse_ForceFullCalculation},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:parseuint16},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:parse_ShtProps},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:parse_ClrtClient},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:parse_Dimensions},1:{},2:{f:parse_BIFF2INT},3:{f:parse_BIFF2NUM},4:{f:parse_BIFF2STR},5:{f:parse_BIFF2BOOLERR},7:{f:parse_BIFF2STRING},8:{},9:{f:parse_BOF},11:{},22:{f:parseuint16},30:{f:parse_BIFF2Format},31:{},32:{},33:{f:parse_Array},36:{},37:{f:parse_DefaultRowHeight},50:{f:parse_BIFF2FONTXTRA},62:{},52:{},67:{f:parse_BIFF2XF},68:{f:parseuint16},69:{},86:{},126:{},127:{f:parse_ImData},135:{},136:{},137:{},143:{f:parse_BIFF4SheetInfo},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:parse_RString},223:{},234:{},354:{},421:{},518:{f:parse_Formula},521:{f:parse_BOF},536:{f:parse_Lbl},547:{f:parse_ExternName},561:{},579:{f:parse_BIFF3XF},1030:{f:parse_Formula},1033:{f:parse_BOF},1091:{f:parse_BIFF4XF},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},101:{},102:{},105:{},106:{},107:{},109:{},112:{},114:{},29282:{}};function write_biff_rec(e,t,r,n){var i=t;if(!isNaN(i)){var a=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&is_buf(r)&&e.push(r)}}function write_biff_continue(e,t,r,n){var i=n||(r||[]).length||0;if(i<=8224)return write_biff_rec(e,t,r,i);var a=t;if(!isNaN(a)){for(var s=r.parts||[],o=0,l=0,c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<i;){for((d=e.next(4)).write_shift(2,60),c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;d.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function write_BIFF2BERR(e,t,r,n){var i=new_buf(9);return write_BIFF2Cell(i,e,t),write_Bes(r,n||"b",i),i}function write_BIFF2LABEL(e,t,r){var n=new_buf(8+2*r.length);return write_BIFF2Cell(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function write_comments_biff2(e,t){t.forEach((function(t){var r=t[0].map((function(e){return e.t})).join("");if(r.length<=2048)return write_biff_rec(e,28,write_NOTE_BIFF2(r,t[1],t[2]));write_biff_rec(e,28,write_NOTE_BIFF2(r.slice(0,2048),t[1],t[2],r.length));for(var n=2048;n<r.length;n+=2048)write_biff_rec(e,28,write_NOTE_BIFF2(r.slice(n,Math.min(n+2048,r.length)),-1,-1,Math.min(2048,r.length-n)))}))}function write_ws_biff2_cell(e,t,r,n,i,a){var s=0;null!=t.z&&-1==(s=i._BIFF2FmtTable.indexOf(t.z))&&(i._BIFF2FmtTable.push(t.z),s=i._BIFF2FmtTable.length-1);var o=0;if(null!=t.z){for(;o<i.cellXfs.length&&i.cellXfs[o].numFmtId!=s;++o);o==i.cellXfs.length&&i.cellXfs.push({numFmtId:s})}if(null!=t.v)switch(t.t){case"d":case"n":var l="d"==t.t?datenum(parseDate(t.v,a),a):t.v;return void(2==i.biff&&l==(0|l)&&l>=0&&l<65536?write_biff_rec(e,2,write_BIFF2INT(r,n,l,o,s)):isNaN(l)?write_biff_rec(e,5,write_BIFF2BERR(r,n,36,"e")):isFinite(l)?write_biff_rec(e,3,write_BIFF2NUM(r,n,l,o,s)):write_biff_rec(e,5,write_BIFF2BERR(r,n,7,"e")));case"b":case"e":return void write_biff_rec(e,5,write_BIFF2BERR(r,n,t.v,t.t));case"s":case"str":return void write_biff_rec(e,4,write_BIFF2LABEL(r,n,null==t.v?"":String(t.v).slice(0,255)))}write_biff_rec(e,1,write_BIFF2Cell(null,r,n))}function write_ws_biff2(e,t,r,n,i){var a=null!=t["!data"],s=safe_decode_range(t["!ref"]||"A1"),o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.r,16383)}for(var c=(((i||{}).Workbook||{}).WBProps||{}).date1904,d=[],u=[],p=s.s.c;p<=s.e.c;++p)l[p]=encode_col(p);for(var h=s.s.r;h<=s.e.r;++h)for(a&&(d=t["!data"][h]||[]),o=encode_row(h),p=s.s.c;p<=s.e.c;++p){var f=a?d[p]:t[l[p]+o];f&&(write_ws_biff2_cell(e,f,h,p,n,c),f.c&&u.push([f.c,h,p]))}write_comments_biff2(e,u)}function write_biff2_buf(e,t){for(var r=t||{},n=buf_array(),i=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(i=a);if(0==i&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);write_biff_rec(n,4==r.biff?1033:3==r.biff?521:9,write_BOF(e,16,r)),((e.Workbook||{}).WBProps||{}).date1904&&write_biff_rec(n,34,writebool(!0)),r.cellXfs=[{numFmtId:0}],r._BIFF2FmtTable=["General"],r._Fonts=[];var s=buf_array();return write_ws_biff2(s,e.Sheets[e.SheetNames[i]],i,r,e),r._BIFF2FmtTable.forEach((function(e){r.biff<=3?write_biff_rec(n,30,write_BIFF2Format(e)):write_biff_rec(n,1054,write_BIFF4Format(e))})),r.cellXfs.forEach((function(e){switch(r.biff){case 2:write_biff_rec(n,67,write_BIFF2XF(e));break;case 3:write_biff_rec(n,579,write_BIFF3XF(e));break;case 4:write_biff_rec(n,1091,write_BIFF4XF(e))}})),delete r._BIFF2FmtTable,delete r.cellXfs,delete r._Fonts,n.push(s.end()),write_biff_rec(n,10),n.end()}var b8oid=1,b8ocnts=[];function write_MsoDrawingGroup(){var e=new_buf(82+8*b8ocnts.length);e.write_shift(2,15),e.write_shift(2,61440),e.write_shift(4,74+8*b8ocnts.length),e.write_shift(2,0),e.write_shift(2,61446),e.write_shift(4,16+8*b8ocnts.length),e.write_shift(4,b8oid),e.write_shift(4,b8ocnts.length+1);for(var t=0,r=0;r<b8ocnts.length;++r)t+=b8ocnts[r]&&b8ocnts[r][1]||0;return e.write_shift(4,t),e.write_shift(4,b8ocnts.length),b8ocnts.forEach((function(t){e.write_shift(4,t[0]),e.write_shift(4,t[2])})),e.write_shift(2,51),e.write_shift(2,61451),e.write_shift(4,18),e.write_shift(2,191),e.write_shift(4,524296),e.write_shift(2,385),e.write_shift(4,134217793),e.write_shift(2,448),e.write_shift(4,134217792),e.write_shift(2,64),e.write_shift(2,61726),e.write_shift(4,16),e.write_shift(4,134217741),e.write_shift(4,134217740),e.write_shift(4,134217751),e.write_shift(4,268435703),e}function write_comments_biff8(e,t){var r,n=[],i=0,a=buf_array(),s=b8oid;t.forEach((function(e,t){var s="",o=e[0].map((function(e){return e.a&&!s&&(s=e.a),e.t})).join("");++b8oid;var l=new_buf(150);l.write_shift(2,15),l.write_shift(2,61444),l.write_shift(4,150),l.write_shift(2,3234),l.write_shift(2,61450),l.write_shift(4,8),l.write_shift(4,b8oid),l.write_shift(4,2560),l.write_shift(2,227),l.write_shift(2,61451),l.write_shift(4,84),l.write_shift(2,128),l.write_shift(4,0),l.write_shift(2,139),l.write_shift(4,2),l.write_shift(2,191),l.write_shift(4,524296),l.write_shift(2,344),l.l+=4,l.write_shift(2,385),l.write_shift(4,134217808),l.write_shift(2,387),l.write_shift(4,134217808),l.write_shift(2,389),l.write_shift(4,268435700),l.write_shift(2,447),l.write_shift(4,1048592),l.write_shift(2,448),l.write_shift(4,134217809),l.write_shift(2,451),l.write_shift(4,268435700),l.write_shift(2,513),l.write_shift(4,134217809),l.write_shift(2,515),l.write_shift(4,268435700),l.write_shift(2,575),l.write_shift(4,196609),l.write_shift(2,959),l.write_shift(4,131072|(e[0].hidden?2:0)),l.l+=2,l.write_shift(2,61456),l.write_shift(4,18),l.write_shift(2,3),l.write_shift(2,e[2]+2),l.l+=2,l.write_shift(2,e[1]+1),l.l+=2,l.write_shift(2,e[2]+4),l.l+=2,l.write_shift(2,e[1]+5),l.l+=2,l.l+=2,l.write_shift(2,61457),l.l+=4,l.l=150,0==t?r=l:write_biff_rec(a,236,l),i+=150;var c=new_buf(52);c.write_shift(2,21),c.write_shift(2,18),c.write_shift(2,25),c.write_shift(2,b8oid),c.write_shift(2,0),c.l=22,c.write_shift(2,13),c.write_shift(2,22),c.write_shift(4,1651663474),c.write_shift(4,2503426821),c.write_shift(4,2150634280),c.write_shift(4,1768515844+256*b8oid),c.write_shift(2,0),c.write_shift(4,0),c.l+=4,write_biff_rec(a,93,c);var d=new_buf(8);d.l+=2,d.write_shift(2,61453),d.l+=4,write_biff_rec(a,236,d),i+=8;var u=new_buf(18);u.write_shift(2,18),u.l+=8,u.write_shift(2,o.length),u.write_shift(2,16),u.l+=4,write_biff_rec(a,438,u);var p=new_buf(1+o.length);p.write_shift(1,0),p.write_shift(o.length,o,"sbcs"),write_biff_rec(a,60,p);var h=new_buf(16);h.l+=8,h.write_shift(2,o.length),h.l+=6,write_biff_rec(a,60,h);var f=new_buf(12+s.length);f.write_shift(2,e[1]),f.write_shift(2,e[2]),f.write_shift(2,0|(e[0].hidden?0:2)),f.write_shift(2,b8oid),f.write_shift(2,s.length),f.write_shift(1,0),f.write_shift(s.length,s,"sbcs"),f.l++,n.push(f)}));var o=new_buf(80);o.write_shift(2,15),o.write_shift(2,61442),o.write_shift(4,i+o.length-8),o.write_shift(2,16),o.write_shift(2,61448),o.write_shift(4,8),o.write_shift(4,t.length+1),o.write_shift(4,b8oid),o.write_shift(2,15),o.write_shift(2,61443),o.write_shift(4,i+48),o.write_shift(2,15),o.write_shift(2,61444),o.write_shift(4,40),o.write_shift(2,1),o.write_shift(2,61449),o.write_shift(4,16),o.l+=16,o.write_shift(2,2),o.write_shift(2,61450),o.write_shift(4,8),o.write_shift(4,s),o.write_shift(4,5),write_biff_rec(e,236,r?bconcat([o,r]):o),e.push(a.end()),n.forEach((function(t){write_biff_rec(e,28,t)})),b8ocnts.push([s,t.length+1,b8oid]),++b8oid}function write_FONTS_biff8(e,t,r){write_biff_rec(e,49,write_Font({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function write_FMTS_biff8(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach((function(n){for(var i=n[0];i<=n[1];++i)null!=t[i]&&write_biff_rec(e,1054,write_Format(i,t[i],r))}))}function write_FEAT(e,t){var r=new_buf(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),write_biff_rec(e,2151,r),(r=new_buf(39)).write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),write_Ref8U(safe_decode_range(t["!ref"]||"A1"),r),r.write_shift(4,4),write_biff_rec(e,2152,r)}function write_CELLXFS_biff8(e,t){for(var r=0;r<16;++r)write_biff_rec(e,224,write_XF({numFmtId:0,style:!0},0,t));t.cellXfs.forEach((function(r){write_biff_rec(e,224,write_XF(r,0,t))}))}function write_ws_biff8_hlinks(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];write_biff_rec(e,440,write_HLink(n)),n[1].Tooltip&&write_biff_rec(e,2048,write_HLinkTooltip(n))}delete t["!links"]}function write_ws_cols_biff8(e,t){if(t){var r=0;t.forEach((function(t,n){++r<=256&&t&&write_biff_rec(e,125,write_ColInfo(col_obj_w(n,t),n))}))}}function write_ws_biff8_cell(e,t,r,n,i,a){var s=16+get_cell_style(i.cellXfs,t,i);if(null!=t.v||t.bf)if(t.bf)write_biff_rec(e,6,write_Formula(t,r,n,i,s));else switch(t.t){case"d":case"n":var o="d"==t.t?datenum(parseDate(t.v,a),a):t.v;isNaN(o)?write_biff_rec(e,517,write_BoolErr(r,n,36,s,i,"e")):isFinite(o)?write_biff_rec(e,515,write_Number(r,n,o,s,i)):write_biff_rec(e,517,write_BoolErr(r,n,7,s,i,"e"));break;case"b":case"e":write_biff_rec(e,517,write_BoolErr(r,n,t.v,s,i,t.t));break;case"s":case"str":i.bookSST?write_biff_rec(e,253,write_LabelSst(r,n,get_sst_id(i.Strings,null==t.v?"":String(t.v),i.revStrings),s,i)):write_biff_rec(e,516,write_Label(r,n,(null==t.v?"":String(t.v)).slice(0,255),s,i));break;default:write_biff_rec(e,513,write_XLSCell(r,n,s))}else write_biff_rec(e,513,write_XLSCell(r,n,s))}function write_ws_biff8(e,t,r){var n=buf_array(),i=r.SheetNames[e],a=r.Sheets[i]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},l=null!=a["!data"],c=8==t.biff,d="",u=[],p=safe_decode_range(a["!ref"]||"A1"),h=c?65536:16384;if(p.e.c>255||p.e.r>=h){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV"+h);p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.r,h-1)}write_biff_rec(n,2057,write_BOF(r,16,t)),write_biff_rec(n,13,writeuint16(1)),write_biff_rec(n,12,writeuint16(100)),write_biff_rec(n,15,writebool(!0)),write_biff_rec(n,17,writebool(!1)),write_biff_rec(n,16,write_Xnum(.001)),write_biff_rec(n,95,writebool(!0)),write_biff_rec(n,42,writebool(!1)),write_biff_rec(n,43,writebool(!1)),write_biff_rec(n,130,writeuint16(1)),write_biff_rec(n,128,write_Guts([0,0])),write_biff_rec(n,131,writebool(!1)),write_biff_rec(n,132,writebool(!1)),c&&write_ws_cols_biff8(n,a["!cols"]),write_biff_rec(n,512,write_Dimensions(p,t));var f=(((r||{}).Workbook||{}).WBProps||{}).date1904;c&&(a["!links"]=[]);for(var m=p.s.c;m<=p.e.c;++m)u[m]=encode_col(m);for(var g=[],_=[],b=p.s.r;b<=p.e.r;++b)for(l&&(_=a["!data"][b]||[]),d=encode_row(b),m=p.s.c;m<=p.e.c;++m){var v=l?_[m]:a[u[m]+d];v&&(write_ws_biff8_cell(n,v,b,m,t,f),c&&v.l&&a["!links"].push([u[m]+d,v.l]),v.c&&g.push([v.c,b,m]))}var y=o.CodeName||o.name||i;return c?write_comments_biff8(n,g):write_comments_biff2(n,g),c&&write_biff_rec(n,574,write_Window2((s.Views||[])[0])),c&&(a["!merges"]||[]).length&&write_biff_rec(n,229,write_MergeCells(a["!merges"])),c&&write_ws_biff8_hlinks(n,a),write_biff_rec(n,442,write_XLUnicodeString(y,t)),c&&write_FEAT(n,a),write_biff_rec(n,10),n.end()}function write_biff8_global(e,t,r){var n=buf_array(),i=(e||{}).Workbook||{},a=i.Sheets||[],s=i.WBProps||{},o=8==r.biff,l=5==r.biff;write_biff_rec(n,2057,write_BOF(e,5,r)),"xla"==r.bookType&&write_biff_rec(n,135),write_biff_rec(n,225,o?writeuint16(1200):null),write_biff_rec(n,193,writezeroes(2)),l&&write_biff_rec(n,191),l&&write_biff_rec(n,192),write_biff_rec(n,226),write_biff_rec(n,92,write_WriteAccess("SheetJS",r)),write_biff_rec(n,66,writeuint16(o?1200:1252)),o&&write_biff_rec(n,353,writeuint16(0)),o&&write_biff_rec(n,448),write_biff_rec(n,317,write_RRTabId(e.SheetNames.length)),o&&e.vbaraw&&write_biff_rec(n,211),o&&e.vbaraw&&write_biff_rec(n,442,write_XLUnicodeString(s.CodeName||"ThisWorkbook",r)),write_biff_rec(n,156,writeuint16(17)),write_biff_rec(n,25,writebool(!1)),write_biff_rec(n,18,writebool(!1)),write_biff_rec(n,19,writeuint16(0)),o&&write_biff_rec(n,431,writebool(!1)),o&&write_biff_rec(n,444,writeuint16(0)),write_biff_rec(n,61,write_Window1(r)),write_biff_rec(n,64,writebool(!1)),write_biff_rec(n,141,writeuint16(0)),write_biff_rec(n,34,writebool("true"==safe1904(e))),write_biff_rec(n,14,writebool(!0)),o&&write_biff_rec(n,439,writebool(!1)),write_biff_rec(n,218,writeuint16(0)),write_FONTS_biff8(n,e,r),write_FMTS_biff8(n,e.SSF,r),write_CELLXFS_biff8(n,r),o&&write_biff_rec(n,352,writebool(!1));var c=n.end(),d=buf_array();o&&write_biff_rec(d,140,write_Country()),o&&b8ocnts.length&&write_biff_rec(d,235,write_MsoDrawingGroup()),o&&r.Strings&&write_biff_continue(d,252,write_SST(r.Strings,r)),write_biff_rec(d,10);var u=d.end(),p=buf_array(),h=0,f=0;for(f=0;f<e.SheetNames.length;++f)h+=(o?12:11)+(o?2:1)*e.SheetNames[f].length;var m=c.length+h+u.length;for(f=0;f<e.SheetNames.length;++f)write_biff_rec(p,133,write_BoundSheet8({pos:m,hs:(a[f]||{}).Hidden||0,dt:0,name:e.SheetNames[f]},r)),m+=t[f].length;var g=p.end();if(h!=g.length)throw new Error("BS8 "+h+" != "+g.length);var _=[];return c.length&&_.push(c),g.length&&_.push(g),u.length&&_.push(u),bconcat(_)}function write_biff8_buf(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),r.revssf=evert_num(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),b8oid=1,b8ocnts=[],r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,fix_write_opts(r),r.cellXfs=[],get_cell_style(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=write_ws_biff8(i,r,e);return n.unshift(write_biff8_global(e,n,r)),bconcat(n)}function write_biff_buf(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(n&&n["!ref"]){var i=decode_range(n["!ref"]);i.e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost."),i.e.r>65535&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond row 65536.  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return write_biff8_buf(e,t);case 4:case 3:case 2:return write_biff2_buf(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function html_to_sheet(e,t){var r=t||{},n=null!=r.dense?r.dense:DENSE,i={};n&&(i["!data"]=[]);var a=(e=str_remove_ng(e,"\x3c!--","--\x3e")).match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=a.index,l=s&&s.index||e.length,c=split_regex(e.slice(o,l),/(:?<tr[^<>]*>)/i,"<tr>"),d=-1,u=0,p=0,h=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<c.length;++o){var g=c[o].trim(),_=g.slice(0,3).toLowerCase();if("<tr"!=_){if("<td"==_||"<th"==_){var b=g.split(/<\/t[dh]>/i);for(l=0;l<b.length;++l){var v=b[l].trim();if(v.match(/<t[dh]/i)){for(var y=v,w=0;"<"==y.charAt(0)&&(w=y.indexOf(">"))>-1;)y=y.slice(w+1);for(var E=0;E<m.length;++E){var S=m[E];S.s.c==u&&S.s.r<d&&d<=S.e.r&&(u=S.e.c+1,E=-1)}var T=parsexmltag(v.slice(0,v.indexOf(">")));h=T.colspan?+T.colspan:1,((p=+T.rowspan)>1||h>1)&&m.push({s:{r:d,c:u},e:{r:d+(p||1)-1,c:u+h-1}});var C=T.t||T["data-t"]||"";if(y.length)if(y=htmldecode(y),f.s.r>d&&(f.s.r=d),f.e.r<d&&(f.e.r=d),f.s.c>u&&(f.s.c=u),f.e.c<u&&(f.e.c=u),y.length){var x={t:"s",v:y};r.raw||!y.trim().length||"s"==C||("TRUE"===y?x={t:"b",v:!0}:"FALSE"===y?x={t:"b",v:!1}:isNaN(fuzzynum(y))?isNaN(fuzzydate(y).getDate())?35==y.charCodeAt(0)&&null!=RBErr[y]&&(x.t="e",x.w=y,x.v=RBErr[y]):(x={t:"d",v:parseDate(y)},!1===r.UTC&&(x.v=utc_to_local(x.v)),r.cellDates||(x={t:"n",v:datenum(x.v)}),x.z=r.dateNF||table_fmt[14]):x={t:"n",v:fuzzynum(y)}),!1!==x.cellText&&(x.w=y),n?(i["!data"][d]||(i["!data"][d]=[]),i["!data"][d][u]=x):i[encode_cell({r:d,c:u})]=x,u+=h}else u+=h;else u+=h}}}}else{if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}u=0}}return i["!ref"]=encode_range(f),m.length&&(i["!merges"]=m),i}function make_html_row(e,t,r,n){for(var i=e["!merges"]||[],a=[],s={},o=null!=e["!data"],l=t.s.c;l<=t.e.c;++l){for(var c=0,d=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>l||i[u].e.r<r||i[u].e.c<l)){if(i[u].s.r<r||i[u].s.c<l){c=-1;break}c=i[u].e.r-i[u].s.r+1,d=i[u].e.c-i[u].s.c+1;break}if(!(c<0)){var p=encode_col(l)+encode_row(r),h=o?(e["!data"][r]||[])[l]:e[p];h&&"n"==h.t&&null!=h.v&&!isFinite(h.v)&&(h=isNaN(h.v)?{t:"e",v:36,w:BErr[36]}:{t:"e",v:7,w:BErr[7]});var f=h&&null!=h.v&&(h.h||escapehtml(h.w||(format_cell(h),h.w)||""))||"";s={},c>1&&(s.rowspan=c),d>1&&(s.colspan=d),n.editable?f='<span contenteditable="true">'+f+"</span>":h&&(s["data-t"]=h&&h.t||"z",null!=h.v&&(s["data-v"]=escapehtml(h.v instanceof Date?h.v.toISOString():h.v)),null!=h.z&&(s["data-z"]=h.z),h.l&&"#"!=(h.l.Target||"#").charAt(0)&&(f='<a href="'+escapehtml(h.l.Target)+'">'+f+"</a>")),s.id=(n.id||"sjs")+"-"+p,a.push(writextag("td",f,s))}}return"<tr>"+a.join("")+"</tr>"}var HTML_BEGIN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HTML_END="</body></html>";function html_to_workbook(e,t){var r=str_match_xml_ig(e,"table");if(!r||0==r.length)throw new Error("Invalid HTML: could not find <table>");if(1==r.length){var n=sheet_to_workbook(html_to_sheet(r[0],t),t);return n.bookType="html",n}var i=book_new();return r.forEach((function(e,r){book_append_sheet(i,html_to_sheet(e,t),"Sheet"+(r+1))})),i.bookType="html",i}function make_html_preamble(e,t,r){return[].join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function sheet_to_html(e,t){var r=t||{},n=null!=r.header?r.header:HTML_BEGIN,i=null!=r.footer?r.footer:HTML_END,a=[n],s=decode_range(e["!ref"]||"A1");if(a.push(make_html_preamble(e,s,r)),e["!ref"])for(var o=s.s.r;o<=s.e.r;++o)a.push(make_html_row(e,s,o,r));return a.push("</table>"+i),a.join("")}function sheet_add_dom(e,t,r){var n=t.rows;if(!n)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var i=r||{},a=null!=e["!data"],s=0,o=0;if(null!=i.origin)if("number"==typeof i.origin)s=i.origin;else{var l="string"==typeof i.origin?decode_cell(i.origin):i.origin;s=l.r,o=l.c}var c=Math.min(i.sheetRows||1e7,n.length),d={s:{r:0,c:0},e:{r:s,c:o}};if(e["!ref"]){var u=decode_range(e["!ref"]);d.s.r=Math.min(d.s.r,u.s.r),d.s.c=Math.min(d.s.c,u.s.c),d.e.r=Math.max(d.e.r,u.e.r),d.e.c=Math.max(d.e.c,u.e.c),-1==s&&(d.e.r=s=u.e.r+1)}var p=[],h=0,f=e["!rows"]||(e["!rows"]=[]),m=0,g=0,_=0,b=0,v=0,y=0;for(e["!cols"]||(e["!cols"]=[]);m<n.length&&g<c;++m){var w=n[m];if(is_dom_element_hidden(w)){if(i.display)continue;f[g]={hidden:!0}}var E=w.cells;for(_=b=0;_<E.length;++_){var S=E[_];if(!i.display||!is_dom_element_hidden(S)){var T=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):htmldecode(S.innerHTML),C=S.getAttribute("data-z")||S.getAttribute("z");for(h=0;h<p.length;++h){var x=p[h];x.s.c==b+o&&x.s.r<g+s&&g+s<=x.e.r&&(b=x.e.c+1-o,h=-1)}y=+S.getAttribute("colspan")||1,((v=+S.getAttribute("rowspan")||1)>1||y>1)&&p.push({s:{r:g+s,c:b+o},e:{r:g+s+(v||1)-1,c:b+o+(y||1)-1}});var A={t:"s",v:T},I=S.getAttribute("data-t")||S.getAttribute("t")||"";null!=T&&(0==T.length?A.t=I||"z":i.raw||0==T.trim().length||"s"==I||("e"==I&&BErr[+T]?A={t:"e",v:+T,w:BErr[+T]}:"TRUE"===T?A={t:"b",v:!0}:"FALSE"===T?A={t:"b",v:!1}:isNaN(fuzzynum(T))?isNaN(fuzzydate(T).getDate())?35==T.charCodeAt(0)&&null!=RBErr[T]&&(A={t:"e",v:RBErr[T],w:T}):(A={t:"d",v:parseDate(T)},i.UTC&&(A.v=local_to_utc(A.v)),i.cellDates||(A={t:"n",v:datenum(A.v)}),A.z=i.dateNF||table_fmt[14]):A={t:"n",v:fuzzynum(T)})),void 0===A.z&&null!=C&&(A.z=C);var D="",k=S.getElementsByTagName("A");if(k&&k.length)for(var L=0;L<k.length&&(!k[L].hasAttribute("href")||"#"==(D=k[L].getAttribute("href")).charAt(0));++L);D&&"#"!=D.charAt(0)&&"javascript:"!=D.slice(0,11).toLowerCase()&&(A.l={Target:D}),a?(e["!data"][g+s]||(e["!data"][g+s]=[]),e["!data"][g+s][b+o]=A):e[encode_cell({c:b+o,r:g+s})]=A,d.e.c<b+o&&(d.e.c=b+o),b+=y}}++g}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),d.e.r=Math.max(d.e.r,g-1+s),e["!ref"]=encode_range(d),g>=c&&(e["!fullref"]=encode_range((d.e.r=n.length-m+g-1+s,d))),e}function parse_dom_table(e,t){var r={};return(t||{}).dense&&(r["!data"]=[]),sheet_add_dom(r,e,t)}function table_to_book(e,t){return sheet_to_workbook(parse_dom_table(e,t),t)}function is_dom_element_hidden(e){var t="",r=get_get_computed_style_function(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function get_get_computed_style_function(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}function parse_text_p(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,(function(e,t){return Array(parseInt(t,10)+1).join(" ")})).replace(/<text:tab[^<>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[unescapexml(t.replace(/<[^<>]*>/g,""))]}function parse_ods_styles(e,t,r){var n=r||{},i=xlml_normalize(e);xlmlregex.lastIndex=0,i=remove_doctype(str_remove_ng(i,"\x3c!--","--\x3e"));for(var a,s,o,l="",c="",d=0,u=-1,p="";a=xlmlregex.exec(i);)switch(a[3]=a[3].replace(/_[\s\S]*$/,"")){case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":case"text-style":"/"===a[1]?("false"==s["truncate-on-overflow"]&&(l.match(/h/)?l=l.replace(/h+/,"[$&]"):l.match(/m/)?l=l.replace(/m+/,"[$&]"):l.match(/s/)&&(l=l.replace(/s+/,"[$&]"))),n[s.name]=l,l=""):"/"!==a[0].charAt(a[0].length-2)&&(l="",s=parsexmltag(a[0],!1));break;case"boolean-style":"/"===a[1]?(n[s.name]="General",l=""):"/"!==a[0].charAt(a[0].length-2)&&(l="",s=parsexmltag(a[0],!1));break;case"boolean":l+="General";break;case"text":"/"===a[1]?"%"==(p=i.slice(u,xlmlregex.lastIndex-a[0].length))&&"<number:percentage-style"==s[0]?l+="%":l+='"'+p.replace(/"/g,'""')+'"':"/"!==a[0].charAt(a[0].length-2)&&(u=xlmlregex.lastIndex);break;case"day":"short"===(o=parsexmltag(a[0],!1)).style?l+="d":l+="dd";break;case"day-of-week":switch((o=parsexmltag(a[0],!1)).style){case"short":default:l+="ddd";break;case"long":l+="dddd"}break;case"era":"short"===(o=parsexmltag(a[0],!1)).style?l+="ee":l+="eeee";break;case"hours":"short"===(o=parsexmltag(a[0],!1)).style?l+="h":l+="hh";break;case"minutes":"short"===(o=parsexmltag(a[0],!1)).style?l+="m":l+="mm";break;case"month":switch((o=parsexmltag(a[0],!1)).textual&&(l+="mm"),o.style){case"short":default:l+="m";break;case"long":l+="mm"}break;case"seconds":"short"===(o=parsexmltag(a[0],!1)).style?l+="s":l+="ss",o["decimal-places"]&&(l+="."+fill("0",+o["decimal-places"]));break;case"year":switch((o=parsexmltag(a[0],!1)).style){case"short":default:l+="yy";break;case"long":l+="yyyy"}break;case"am-pm":l+="AM/PM";break;case"week-of-year":case"quarter":console.error("Excel does not support ODS format token "+a[3]);break;case"fill-character":"/"===a[1]?l+='"'+(p=i.slice(u,xlmlregex.lastIndex-a[0].length)).replace(/"/g,'""')+'"*':"/"!==a[0].charAt(a[0].length-2)&&(u=xlmlregex.lastIndex);break;case"scientific-number":l+="0."+fill("0",+(o=parsexmltag(a[0],!1))["min-decimal-places"]||+o["decimal-places"]||2)+fill("?",+o["decimal-places"]-+o["min-decimal-places"]||0)+"E"+(parsexmlbool(o["forced-exponent-sign"])?"+":"")+fill("0",+o["min-exponent-digits"]||2);break;case"fraction":+(o=parsexmltag(a[0],!1))["min-integer-digits"]?l+=fill("0",+o["min-integer-digits"]):l+="#",l+=" ",l+=fill("?",+o["min-numerator-digits"]||1),l+="/",+o["denominator-value"]?l+=o["denominator-value"]:l+=fill("?",+o["min-denominator-digits"]||1);break;case"currency-symbol":"/"===a[1]?l+='"'+i.slice(u,xlmlregex.lastIndex-a[0].length).replace(/"/g,'""')+'"':"/"!==a[0].charAt(a[0].length-2)?u=xlmlregex.lastIndex:l+="$";break;case"text-properties":switch(((o=parsexmltag(a[0],!1)).color||"").toLowerCase().replace("#","")){case"ff0000":case"red":l="[Red]"+l}break;case"text-content":l+="@";break;case"map":o=parsexmltag(a[0],!1),"value()>=0"==unescapexml(o.condition)?l=n[o["apply-style-name"]]+";"+l:console.error("ODS number format may be incorrect: "+o.condition);break;case"number":if("/"===a[1])break;c="",c+=fill("0",+(o=parsexmltag(a[0],!1))["min-integer-digits"]||1),parsexmlbool(o.grouping)&&(c=commaify(fill("#",Math.max(0,4-c.length))+c)),(+o["min-decimal-places"]||+o["decimal-places"])&&(c+="."),+o["min-decimal-places"]&&(c+=fill("0",+o["min-decimal-places"]||1)),+o["decimal-places"]-(+o["min-decimal-places"]||0)&&(c+=fill("0",+o["decimal-places"]-(+o["min-decimal-places"]||0))),l+=c;break;case"embedded-text":"/"===a[1]?0==d?l+='"'+i.slice(u,xlmlregex.lastIndex-a[0].length).replace(/"/g,'""')+'"':l=l.slice(0,d)+'"'+i.slice(u,xlmlregex.lastIndex-a[0].length).replace(/"/g,'""')+'"'+l.slice(d):"/"!==a[0].charAt(a[0].length-2)&&(u=xlmlregex.lastIndex,d=-+parsexmltag(a[0],!1).position||0)}return n}function parse_content_xml(e,t,r){var n=t||{};null!=DENSE&&null==n.dense&&(n.dense=DENSE);var i,a,s,o,l,c,d,u=xlml_normalize(e),p=[],h=0,f={},m=[],g={};n.dense&&(g["!data"]=[]);var _,b={value:""},v={},y="",w=0,E="",S=0,T=[],C=[],x=-1,A=-1,I={s:{r:1e6,c:1e7},e:{r:0,c:0}},D=0,k=r||{},L={},P=[],O={},R=0,N=0,B=[],F=1,U=1,M=[],q={Names:[],WBProps:{}},z={},H=["",""],W=[],j={},V="",$=0,G=!1,X=!1,K=0;for(xlmlregex.lastIndex=0,u=remove_doctype(str_remove_ng(u,"\x3c!--","--\x3e"));c=xlmlregex.exec(u);)switch(c[3]=c[3].replace(/_[\s\S]*$/,"")){case"table":case"å·¥ä½œè¡¨":"/"===c[1]?(I.e.c>=I.s.c&&I.e.r>=I.s.r?g["!ref"]=encode_range(I):g["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=I.e.r&&(g["!fullref"]=g["!ref"],I.e.r=n.sheetRows-1,g["!ref"]=encode_range(I)),P.length&&(g["!merges"]=P),B.length&&(g["!rows"]=B),o.name=o["åç§°"]||o.name,"undefined"!=typeof JSON&&JSON.stringify(o),m.push(o.name),f[o.name]=g,X=!1):"/"!==c[0].charAt(c[0].length-2)&&(o=parsexmltag(c[0],!1),x=A=-1,I.s.r=I.s.c=1e7,I.e.r=I.e.c=0,g={},n.dense&&(g["!data"]=[]),P=[],B=[],X=!0);break;case"table-row-group":"/"===c[1]?--D:++D;break;case"table-row":case"è¡Œ":if("/"===c[1]){x+=F,F=1;break}if((l=parsexmltag(c[0],!1))["è¡Œå·"]?x=l["è¡Œå·"]-1:-1==x&&(x=0),(F=+l["number-rows-repeated"]||1)<10)for(K=0;K<F;++K)D>0&&(B[x+K]={level:D});A=-1;break;case"covered-table-cell":if("/"!==c[1])if(++A,b=parsexmltag(c[0],!1),U=parseInt(b["number-columns-repeated"]||"1",10)||1,n.sheetStubs){for(;U-- >0;)n.dense?(g["!data"][x]||(g["!data"][x]=[]),g["!data"][x][A]={t:"z"}):g[encode_cell({r:x,c:A})]={t:"z"},++A;--A}else A+=U-1;y="",T=[];break;case"table-cell":case"æ•°æ®":if("/"===c[0].charAt(c[0].length-2))++A,b=parsexmltag(c[0],!1),U=parseInt(b["number-columns-repeated"]||"1",10)||1,d={t:"z",v:null},b.formula&&0!=n.cellFormula&&(d.f=ods_to_csf_formula(unescapexml(b.formula))),b["style-name"]&&L[b["style-name"]]&&(d.z=L[b["style-name"]]),"string"==(b["æ•°æ®ç±»åž‹"]||b["value-type"])&&(d.t="s",d.v=unescapexml(b["string-value"]||""),n.dense?(g["!data"][x]||(g["!data"][x]=[]),g["!data"][x][A]=d):g[encode_col(A)+encode_row(x)]=d),A+=U-1;else if("/"!==c[1]){y=E="",w=S=0,T=[],C=[],U=1;var Y=F?x+F-1:x;if(++A>I.e.c&&(I.e.c=A),A<I.s.c&&(I.s.c=A),x<I.s.r&&(I.s.r=x),Y>I.e.r&&(I.e.r=Y),b=parsexmltag(c[0],!1),v=parsexmltagraw(c[0],!0),W=[],j={},d={t:b["æ•°æ®ç±»åž‹"]||b["value-type"],v:null},b["style-name"]&&L[b["style-name"]]&&(d.z=L[b["style-name"]]),n.cellFormula)if(b.formula&&(b.formula=unescapexml(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(O={s:{r:x,c:A},e:{r:x+(R=parseInt(b["number-matrix-rows-spanned"],10)||0)-1,c:A+(N=parseInt(b["number-matrix-columns-spanned"],10)||0)-1}},d.F=encode_range(O),M.push([O,d.F])),b.formula)d.f=ods_to_csf_formula(b.formula);else for(K=0;K<M.length;++K)x>=M[K][0].s.r&&x<=M[K][0].e.r&&A>=M[K][0].s.c&&A<=M[K][0].e.c&&(d.F=M[K][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(R=parseInt(b["number-rows-spanned"]||"1",10)||1)*(N=parseInt(b["number-columns-spanned"]||"1",10)||1)>1&&(O={s:{r:x,c:A},e:{r:x+R-1,c:A+N-1}},P.push(O)),b["number-columns-repeated"]&&(U=parseInt(b["number-columns-repeated"],10)),d.t){case"boolean":d.t="b",d.v=parsexmlbool(b["boolean-value"])||+b["boolean-value"]>=1;break;case"float":d.t="n",d.v=parseFloat(b.value),n.cellDates&&d.z&&fmt_is_date(d.z)&&(d.v=numdate(d.v+(q.WBProps.date1904?1462:0)),d.t="number"==typeof d.v?"n":"d");break;case"percentage":case"currency":d.t="n",d.v=parseFloat(b.value);break;case"date":d.t="d",d.v=parseDate(b["date-value"],q.WBProps.date1904),n.cellDates||(d.t="n",d.v=datenum(d.v,q.WBProps.date1904)),d.z||(d.z="m/d/yy");break;case"time":d.t="n",d.v=parse_isodur(b["time-value"])/86400,n.cellDates&&(d.v=numdate(d.v),d.t="number"==typeof d.v?"n":"d"),d.z||(d.z="HH:MM:SS");break;case"number":d.t="n",d.v=parseFloat(b["æ•°æ®æ•°å€¼"]);break;default:if("string"!==d.t&&"text"!==d.t&&d.t)throw new Error("Unsupported value type "+d.t);d.t="s",null!=b["string-value"]&&(y=unescapexml(b["string-value"]),T=[])}}else{if(G=!1,"error"==v["calcext:value-type"]&&null!=RBErr[y]&&(d.t="e",d.w=y,d.v=RBErr[y]),"s"===d.t&&(d.v=y||"",T.length&&(d.R=T),G=0==w),z.Target&&(d.l=z),W.length>0&&(d.c=W,W=[]),y&&!1!==n.cellText&&(d.w=y),G&&(d.t="z",delete d.v),(!G||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=x))for(var Q=0;Q<F;++Q){if(U=parseInt(b["number-columns-repeated"]||"1",10),n.dense)for(g["!data"][x+Q]||(g["!data"][x+Q]=[]),g["!data"][x+Q][A]=0==Q?d:dup(d);--U>0;)g["!data"][x+Q][A+U]=dup(d);else for(g[encode_cell({r:x+Q,c:A})]=d;--U>0;)g[encode_cell({r:x+Q,c:A+U})]=dup(d);I.e.c<=A&&(I.e.c=A)}A+=(U=parseInt(b["number-columns-repeated"]||"1",10))-1,U=0,d={},y="",T=[]}z={};break;case"document":case"document-content":case"ç”µå­è¡¨æ ¼æ–‡æ¡£":case"spreadsheet":case"ä¸»ä½“":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===c[1]){if((i=p.pop())[0]!==c[3])throw"Bad state: "+i}else"/"!==c[0].charAt(c[0].length-2)&&p.push([c[3],!0]);break;case"annotation":if("/"===c[1]){if((i=p.pop())[0]!==c[3])throw"Bad state: "+i;j.t=y,T.length&&(j.R=T),j.a=V,W.push(j),y=E,w=S,T=C}else if("/"!==c[0].charAt(c[0].length-2)){p.push([c[3],!1]);var Z=parsexmltag(c[0],!0);Z.display&&parsexmlbool(Z.display)||(W.hidden=!0),E=y,S=w,C=T,y="",w=0,T=[]}V="",$=0;break;case"creator":"/"===c[1]?V=u.slice($,c.index):$=c.index+c[0].length;break;case"meta":case"å…ƒæ•°æ®":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===c[1]){if((i=p.pop())[0]!==c[3])throw"Bad state: "+i}else"/"!==c[0].charAt(c[0].length-2)&&p.push([c[3],!1]);y="",w=0,T=[];break;case"scientific-number":case"currency-symbol":case"fill-character":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"number":case"fraction":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":case"boolean":case"text-content":case"text-properties":case"embedded-text":case"body":case"ç”µå­è¡¨æ ¼":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"æ ‡é¢˜":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"filter-set-item":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"text-style":case"boolean-style":case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":if("/"===c[1]){var J=xlmlregex.lastIndex;parse_ods_styles(u.slice(s,xlmlregex.lastIndex),t,k),xlmlregex.lastIndex=J}else"/"!==c[0].charAt(c[0].length-2)&&(s=xlmlregex.lastIndex-c[0].length);break;case"style":var ee=parsexmltag(c[0],!1);"table-cell"==ee.family&&k[ee["data-style-name"]]&&(L[ee.name]=k[ee["data-style-name"]]);break;case"text":if("/>"===c[0].slice(-2))break;if("/"===c[1])switch(p[p.length-1][0]){case"number-style":case"date-style":case"time-style":u.slice(h,c.index)}else h=c.index+c[0].length;break;case"named-range":H=ods_to_csf_3D((a=parsexmltag(c[0],!1))["cell-range-address"]);var te={Name:a.name,Ref:H[0]+"!"+H[1]};X&&(te.Sheet=m.length),q.Names.push(te);break;case"null-date":"1904-01-01"===(a=parsexmltag(c[0],!1))["date-value"]&&(q.WBProps.date1904=!0);break;case"p":case"æ–‡æœ¬ä¸²":if(["master-styles"].indexOf(p[p.length-1][0])>-1)break;if("/"!==c[1]||b&&b["string-value"])"/>"==c[0].slice(-2)?y+="\n":(_=parsexmltag(c[0],!1),w=c.index+c[0].length);else{var re=parse_text_p(u.slice(w,c.index),_);y=(y.length>0?y+"\n":"")+re[0]}break;case"database-range":if("/"===c[1])break;try{f[(H=ods_to_csf_3D(parsexmltag(c[0])["target-range-address"]))[0]]["!autofilter"]={ref:H[1]}}catch(e){}break;case"a":if("/"!==c[1]){if(!(z=parsexmltag(c[0],!1)).href)break;z.Target=unescapexml(z.href),delete z.href,"#"==z.Target.charAt(0)&&z.Target.indexOf(".")>-1?(H=ods_to_csf_3D(z.Target.slice(1)),z.Target="#"+H[0]+"!"+H[1]):z.Target.match(/^\.\.[\\\/]/)&&(z.Target=z.Target.slice(3))}break;default:switch(c[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"è¡¨:":case"å­—:":break;default:if(n.WTF)throw new Error(c)}}var ne={Sheets:f,SheetNames:m,Workbook:q};return n.bookSheets&&delete ne.Sheets,ne}function parse_ods(e,t){t=t||{},safegetzipfile(e,"META-INF/manifest.xml")&&parse_manifest(getzipdata(e,"META-INF/manifest.xml"),t);var r=getzipstr(e,"styles.xml"),n=r&&parse_ods_styles(utf8read(r),t),i=getzipstr(e,"content.xml");if(!i)throw new Error("Missing content.xml in ODS / UOF file");var a=parse_content_xml(utf8read(i),t,n);return safegetzipfile(e,"meta.xml")&&(a.Props=parse_core_props(getzipdata(e,"meta.xml"))),a.bookType="ods",a}function parse_fods(e,t){var r=parse_content_xml(e,t);return r.bookType="fods",r}var write_styles_ods=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return XML_HEADER+t}}();function write_number_format_ods(e,t){var r="number",n="",i={"style:name":t},a="",s=0;e:if((e=e.replace(/"[$]"/g,"$")).indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+e),e=e.slice(0,e.indexOf(";"))),"@"!=e){if(e.indexOf(/\$/)>-1&&(r="currency"),'"'==e[s]){for(a="";'"'!=e[++s]||'"'==e[++s];)a+=e[s];"*"==e[1+--s]?(s++,n+="<number:fill-character>"+escapexml(a.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+escapexml(a.replace(/""/g,'"'))+"</number:text>",e=e.slice(s+1),s=0}var o=e.match(/# (\?+)\/(\?+)/);if(o)n+=writextag("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":o[1].length,"number:max-denominator-value":Math.max(+o[1].replace(/./g,"9"),+o[2].replace(/./g,"9"))});else if(o=e.match(/# (\?+)\/(\d+)/))n+=writextag("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":o[1].length,"number:denominator-value":+o[2]});else if(o=e.match(/\b(\d+)(|\.\d+)%/))r="percentage",n+=writextag("number:number",null,{"number:decimal-places":o[2]&&o.length-1||0,"number:min-decimal-places":o[2]&&o.length-1||0,"number:min-integer-digits":o[1].length})+"<number:text>%</number:text>";else{var l=!1;if(["y","m","d"].indexOf(e[0])>-1){r="date";t:for(;s<e.length;++s)switch(a=e[s].toLowerCase()){case"h":case"s":l=!0,--s;break t;case"m":r:for(var c=s+1;c<e.length;++c)switch(e[c]){case"y":case"d":break r;case"h":case"s":l=!0,--s;break t}case"y":case"d":for(;(e[++s]||"").toLowerCase()==a[0];)a+=a[0];switch(--s,a){case"y":case"yy":n+="<number:year/>";break;case"yyy":case"yyyy":n+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":n+='<number:month number:style="'+(a.length%2?"short":"long")+'" number:textual="'+(a.length>=3?"true":"false")+'"/>';break;case"d":case"dd":n+='<number:day number:style="'+(a.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":n+='<number:day-of-week number:style="'+(a.length%2?"short":"long")+'"/>'}break;case'"':for(;'"'!=e[++s]||'"'==e[++s];)a+=e[s];--s,n+="<number:text>"+escapexml(a.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":n+="<number:text>"+escapexml(a=e[++s])+"</number:text>";break;case"/":case":":n+="<number:text>"+escapexml(a)+"</number:text>";break;default:console.error("unrecognized character "+a+" in ODF format "+e)}if(!l)break e;e=e.slice(s+1),s=0}if(e.match(/^\[?[hms]/))for("number"==r&&(r="time"),e.match(/\[/)&&(e=e.replace(/[\[\]]/g,""),i["number:truncate-on-overflow"]="false");s<e.length;++s)switch(a=e[s].toLowerCase()){case"h":case"m":case"s":for(;(e[++s]||"").toLowerCase()==a[0];)a+=a[0];switch(--s,a){case"h":case"hh":n+='<number:hours number:style="'+(a.length%2?"short":"long")+'"/>';break;case"m":case"mm":n+='<number:minutes number:style="'+(a.length%2?"short":"long")+'"/>';break;case"s":case"ss":if("."==e[s+1])do{a+=e[s+1],++s}while("0"==e[s+1]);n+='<number:seconds number:style="'+(a.match("ss")?"long":"short")+'"'+(a.match(/\./)?' number:decimal-places="'+(a.match(/0+/)||[""])[0].length+'"':"")+"/>"}break;case'"':for(;'"'!=e[++s]||'"'==e[++s];)a+=e[s];--s,n+="<number:text>"+escapexml(a.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":n+="<number:text>"+escapexml(a)+"</number:text>";break;case"a":if("a/p"==e.slice(s,s+3).toLowerCase()){n+="<number:am-pm/>",s+=2;break}if("am/pm"==e.slice(s,s+5).toLowerCase()){n+="<number:am-pm/>",s+=4;break}default:console.error("unrecognized character "+a+" in ODF format "+e)}else{if(e.indexOf(/\$/)>-1&&(r="currency"),"$"==e[0]&&(n+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',e=e.slice(1),s=0),'"'==e[s=0]){for(;'"'!=e[++s]||'"'==e[++s];)a+=e[s];"*"==e[1+--s]?(s++,n+="<number:fill-character>"+escapexml(a.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+escapexml(a.replace(/""/g,'"'))+"</number:text>",e=e.slice(s+1),s=0}var d=e.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(d&&d[0]){var u=d[1].replace(/,/g,"");n+="<number:"+(d[3]?"scientific-":"")+'number number:min-integer-digits="'+(-1==u.indexOf("0")?"0":u.length-u.indexOf("0"))+'"'+(d[0].indexOf(",")>-1?' number:grouping="true"':"")+(d[2]&&' number:decimal-places="'+(d[2].length-1)+'"'||' number:decimal-places="0"')+(d[3]&&d[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(d[3]?' number:min-exponent-digits="'+d[3].match(/0+/)[0].length+'"':"")+"></number:"+(d[3]?"scientific-":"")+"number>",s=d.index+d[0].length}else console.error("Could not find numeric part of "+e);if('"'==e[s]){for(a="";'"'!=e[++s]||'"'==e[++s];)a+=e[s];--s,n+="<number:text>"+escapexml(a.replace(/""/g,'"'))+"</number:text>"}}}}else r="text",n="<number:text-content/>";return n?writextag("number:"+r+"-style",n,i):(console.error("Could not generate ODS number format for |"+e+"|"),"")}function write_names_ods(e,t,r){for(var n=[],i=0;i<e.length;++i){var a=e[i];a&&a.Sheet==(-1==r?null:r)&&n.push(a)}return n.length?"      <table:named-expressions>\n"+n.map((function(e){var t=(-1==r?"$":"")+csf_to_ods_3D(e.Ref);return"        "+writextag("table:named-range",null,{"table:name":e.Name,"table:cell-range-address":t,"table:base-cell-address":t.replace(/[\.][^\.]*$/,".$A$1")})})).join("\n")+"\n      </table:named-expressions>\n":""}var write_content_ods=function(){var e=function(e,t){return escapexml(e).replace(/  +/g,(function(e){return'<text:s text:c="'+e.length+'"/>'})).replace(/\t/g,"<text:tab/>").replace(/\n/g,t?"<text:line-break/>":"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",r=function(r,n,i,a,s,o){var l=[];l.push('      <table:table table:name="'+escapexml(n.SheetNames[i])+'" table:style-name="ta1">\n');var c=0,d=0,u=decode_range(r["!ref"]||"A1"),p=r["!merges"]||[],h=0,f=null!=r["!data"];if(r["!cols"])for(d=0;d<=u.e.c;++d)l.push("        <table:table-column"+(r["!cols"][d]?' table:style-name="co'+r["!cols"][d].ods+'"':"")+"></table:table-column>\n");var m="",g=r["!rows"]||[];for(c=0;c<u.s.r;++c)m=g[c]?' table:style-name="ro'+g[c].ods+'"':"",l.push("        <table:table-row"+m+"></table:table-row>\n");for(;c<=u.e.r;++c){for(m=g[c]?' table:style-name="ro'+g[c].ods+'"':"",l.push("        <table:table-row"+m+">\n"),d=0;d<u.s.c;++d)l.push(t);for(;d<=u.e.c;++d){var _=!1,b={},v="";for(h=0;h!=p.length;++h)if(!(p[h].s.c>d||p[h].s.r>c||p[h].e.c<d||p[h].e.r<c)){p[h].s.c==d&&p[h].s.r==c||(_=!0),b["table:number-columns-spanned"]=p[h].e.c-p[h].s.c+1,b["table:number-rows-spanned"]=p[h].e.r-p[h].s.r+1;break}if(_)l.push("          <table:covered-table-cell/>\n");else{var y=encode_cell({r:c,c:d}),w=f?(r["!data"][c]||[])[d]:r[y];if(w&&w.f&&(b["table:formula"]=escapexml(csf_to_ods_formula(w.f)),w.F&&w.F.slice(0,y.length)==y)){var E=decode_range(w.F);b["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,b["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(w){switch(w.t){case"b":v=w.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=w.v?"true":"false";break;case"n":isFinite(w.v)?(v=w.w||String(w.v||0),b["office:value-type"]="float",b["office:value"]=w.v||0):(isNaN(w.v)?(v="#NUM!",b["table:formula"]="of:=#NUM!"):(v="#DIV/0!",b["table:formula"]="of:="+(w.v<0?"-":"")+"1/0"),b["office:string-value"]="",b["office:value-type"]="string",b["calcext:value-type"]="error");break;case"s":case"str":v=null==w.v?"":w.v,b["office:value-type"]="string";break;case"d":v=w.w||parseDate(w.v,o).toISOString(),b["office:value-type"]="date",b["office:date-value"]=parseDate(w.v,o).toISOString(),b["table:style-name"]="ce1";break;default:l.push(t);continue}var S=e(v);if(w.l&&w.l.Target){var T=w.l.Target;"#"==(T="#"==T.charAt(0)?"#"+csf_to_ods_3D(T.slice(1)):T).charAt(0)||T.match(/^\w+:/)||(T="../"+T),S=writextag("text:a",S,{"xlink:href":T.replace(/&/g,"&amp;")})}s[w.z]&&(b["table:style-name"]="ce"+s[w.z].slice(1));var C=writextag("text:p",S,{});if(w.c){for(var x="",A="",I={},D=0;D<w.c.length;++D)!x&&w.c[D].a&&(x=w.c[D].a),A+="<text:p>"+e(w.c[D].t)+"</text:p>";w.c.hidden||(I["office:display"]=!0),C=writextag("office:annotation",A,I)+C}l.push("          "+writextag("table:table-cell",C,b)+"\n")}else l.push(t)}}l.push("        </table:table-row>\n")}return(n.Workbook||{}).Names&&l.push(write_names_ods(n.Workbook.Names,n.SheetNames,i)),l.push("      </table:table>\n"),l.join("")};return function(e,t){var n=[XML_HEADER],i=wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),a=wxt_helper({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(n.push("<office:document"+i+a+">\n"),n.push(write_meta_ods().replace(/<office:document-meta[^<>]*?>/,"").replace(/<\/office:document-meta>/,"")+"\n")):n.push("<office:document-content"+i+">\n");var s=function(e,t){e.push(" <office:automatic-styles>\n");var r=0;t.SheetNames.map((function(e){return t.Sheets[e]})).forEach((function(t){if(t&&t["!cols"])for(var n=0;n<t["!cols"].length;++n)if(t["!cols"][n]){var i=t["!cols"][n];if(null==i.width&&null==i.wpx&&null==i.wch)continue;process_col(i),i.ods=r;var a=t["!cols"][n].wpx+"px";e.push('  <style:style style:name="co'+r+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+a+'"/>\n'),e.push("  </style:style>\n"),++r}}));var n=0;t.SheetNames.map((function(e){return t.Sheets[e]})).forEach((function(t){if(t&&t["!rows"])for(var r=0;r<t["!rows"].length;++r)if(t["!rows"][r]){t["!rows"][r].ods=n;var i=t["!rows"][r].hpx+"px";e.push('  <style:style style:name="ro'+n+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+i+'"/>\n'),e.push("  </style:style>\n"),++n}})),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var i={},a=69;return t.SheetNames.map((function(e){return t.Sheets[e]})).forEach((function(t){if(t){var r=null!=t["!data"];if(t["!ref"])for(var n=decode_range(t["!ref"]),s=0;s<=n.e.r;++s)for(var o=0;o<=n.e.c;++o){var l=r?(t["!data"][s]||[])[o]:t[encode_cell({r:s,c:o})];if(l&&l.z&&"general"!=l.z.toLowerCase()&&!i[l.z]){var c=write_number_format_ods(l.z,"N"+a);c&&(i[l.z]="N"+a,++a,e.push(c+"\n"))}}}})),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),keys(i).forEach((function(t){e.push('<style:style style:name="ce'+i[t].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+i[t]+'"/>\n')})),e.push(" </office:automatic-styles>\n"),i}(n,e);n.push("  <office:body>\n"),n.push("    <office:spreadsheet>\n"),((e.Workbook||{}).WBProps||{}).date1904&&n.push('      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">\n        <table:null-date table:date-value="1904-01-01"/>\n      </table:calculation-settings>\n');for(var o=0;o!=e.SheetNames.length;++o)n.push(r(e.Sheets[e.SheetNames[o]],e,o,0,s,((e.Workbook||{}).WBProps||{}).date1904));return(e.Workbook||{}).Names&&n.push(write_names_ods(e.Workbook.Names,e.SheetNames,-1)),n.push("    </office:spreadsheet>\n"),n.push("  </office:body>\n"),"fods"==t.bookType?n.push("</office:document>"):n.push("</office:document-content>"),n.join("")}}();function write_ods(e,t){if("fods"==t.bookType)return write_content_ods(e,t);var r=zip_new(),n="",i=[],a=[];return zip_add_file(r,n="mimetype","application/vnd.oasis.opendocument.spreadsheet"),zip_add_file(r,n="content.xml",write_content_ods(e,t)),i.push([n,"text/xml"]),a.push([n,"ContentFile"]),zip_add_file(r,n="styles.xml",write_styles_ods(e,t)),i.push([n,"text/xml"]),a.push([n,"StylesFile"]),zip_add_file(r,n="meta.xml",XML_HEADER+write_meta_ods()),i.push([n,"text/xml"]),a.push([n,"MetadataFile"]),zip_add_file(r,n="manifest.rdf",write_rdf(a)),i.push([n,"application/rdf+xml"]),zip_add_file(r,n="META-INF/manifest.xml",write_manifest(i)),r}var subarray=function(){try{return"undefined"==typeof Uint8Array||void 0===Uint8Array.prototype.subarray?"slice":"undefined"!=typeof Buffer?void 0===Buffer.prototype.subarray?"slice":("function"==typeof Buffer.from?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch(e){return"slice"}}();function u8_to_dataview(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function u8str(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):utf8read(a2s(e))}function stru8(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):s2a(utf8write(e))}function u8concat(e){for(var t=0,r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),i=0;for(r=0;r<e.length;++r){var a=e[r],s=a.length;if(s<250)for(var o=0;o<s;++o)n[i++]=a[o];else n.set(a,i),i+=s}return n}function popcnt(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function readDecimal128LE(e,t){for(var r=(127&e[t+15])<<7|e[t+14]>>1,n=1&e[t+14],i=t+13;i>=t;--i)n=256*n+e[i];return(128&e[t+15]?-n:n)*Math.pow(10,r-6176)}function writeDecimal128LE(e,t,r){var n=Math.floor(0==r?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-16,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(127&n)<<1;for(var a=0;i>=1;++a,i/=256)e[t+a]=255&i;e[t+15]|=r>=0?0:128}function parse_varint49(e,t){var r=t.l,n=127&e[r];e:if(e[r++]>=128){if(n|=(127&e[r])<<7,e[r++]<128)break e;if(n|=(127&e[r])<<14,e[r++]<128)break e;if(n|=(127&e[r])<<21,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,28),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,35),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,42),++r,e[r++]<128)break e}return t.l=r,n}function write_varint49(e){var t=new Uint8Array(7);t[0]=127&e;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383)break e;if(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)break e;if(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)break e;if(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)break e;if(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103)break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t[subarray](0,r)}function parse_packed_varints(e){for(var t={l:0},r=[];t.l<e.length;)r.push(parse_varint49(e,t));return r}function write_packed_varints(e){return u8concat(e.map((function(e){return write_varint49(e)})))}function varint_to_i32(e){var t=0,r=127&e[t];return e[t++]<128?r:(r|=(127&e[t])<<7,e[t++]<128?r:(r|=(127&e[t])<<14,e[t++]<128?r:(r|=(127&e[t])<<21,e[t++]<128?r:r|=(15&e[t])<<28)))}function varint_to_u64(e){var t=0,r=127&e[t],n=0;e:if(e[t++]>=128){if(r|=(127&e[t])<<7,e[t++]<128)break e;if(r|=(127&e[t])<<14,e[t++]<128)break e;if(r|=(127&e[t])<<21,e[t++]<128)break e;if(r|=(127&e[t])<<28,n=e[t]>>4&7,e[t++]<128)break e;if(n|=(127&e[t])<<3,e[t++]<128)break e;if(n|=(127&e[t])<<10,e[t++]<128)break e;if(n|=(127&e[t])<<17,e[t++]<128)break e;if(n|=(127&e[t])<<24,e[t++]<128)break e;n|=(127&e[t])<<31}return[r>>>0,n>>>0]}function parse_shallow(e){for(var t=[],r={l:0};r.l<e.length;){var n,i=r.l,a=parse_varint49(e,r),s=7&a;a=a/8|0;var o=r.l;switch(s){case 0:for(;e[o++]>=128;);n=e[subarray](r.l,o),r.l=o;break;case 1:n=e[subarray](o,o+8),r.l=o+8;break;case 2:var l=parse_varint49(e,r);n=e[subarray](r.l,r.l+l),r.l+=l;break;case 5:n=e[subarray](o,o+4),r.l=o+4;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(i))}var c={data:n,type:s};null==t[a]&&(t[a]=[]),t[a].push(c)}return t}function write_shallow(e){var t=[];return e.forEach((function(e,r){0!=r&&e.forEach((function(e){e.data&&(t.push(write_varint49(8*r+e.type)),2==e.type&&t.push(write_varint49(e.data.length)),t.push(e.data))}))})),u8concat(t)}function mappa(e,t){return(null==e?void 0:e.map((function(e){return t(e.data)})))||[]}function parse_iwa_file(e){for(var t,r=[],n={l:0};n.l<e.length;){var i=parse_varint49(e,n),a=parse_shallow(e[subarray](n.l,n.l+i));n.l+=i;var s={id:varint_to_i32(a[1][0].data),messages:[]};a[2].forEach((function(t){var r=parse_shallow(t.data),i=varint_to_i32(r[3][0].data);s.messages.push({meta:r,data:e[subarray](n.l,n.l+i)}),n.l+=i})),(null==(t=a[3])?void 0:t[0])&&(s.merge=varint_to_i32(a[3][0].data)>>>0>0),r.push(s)}return r}function write_iwa_file(e){var t=[];return e.forEach((function(e){var r=[[],[{data:write_varint49(e.id),type:0}],[]];null!=e.merge&&(r[3]=[{data:write_varint49(+!!e.merge),type:0}]);var n=[];e.messages.forEach((function(e){n.push(e.data),e.meta[3]=[{type:0,data:write_varint49(e.data.length)}],r[2].push({data:write_shallow(e.meta),type:2})}));var i=write_shallow(r);t.push(write_varint49(i.length)),t.push(i),n.forEach((function(e){return t.push(e)}))})),u8concat(t)}function parse_snappy_chunk(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r={l:0},n=parse_varint49(t,r),i=[],a=r.l;a<t.length;){var s=3&t[a];if(0!=s){var o=0,l=0;if(1==s?(l=4+(t[a]>>2&7),o=(224&t[a++])<<3,o|=t[a++]):(l=1+(t[a++]>>2),2==s?(o=t[a]|t[a+1]<<8,a+=2):(o=(t[a]|t[a+1]<<8|t[a+2]<<16|t[a+3]<<24)>>>0,a+=4)),0==o)throw new Error("Invalid offset 0");for(var c=i.length-1,d=o;c>=0&&d>=i[c].length;)d-=i[c].length,--c;if(c<0){if(0!=d)throw new Error("Invalid offset beyond length");d=i[c=0].length}if(l<d)i.push(i[c][subarray](i[c].length-d,i[c].length-d+l));else{for(d>0&&(i.push(i[c][subarray](i[c].length-d)),l-=d),++c;l>=i[c].length;)i.push(i[c]),l-=i[c].length,++c;l&&i.push(i[c][subarray](0,l))}i.length>25&&(i=[u8concat(i)])}else{var u=t[a++]>>2;if(u<60)++u;else{var p=u-59;u=t[a],p>1&&(u|=t[a+1]<<8),p>2&&(u|=t[a+2]<<16),p>3&&(u|=t[a+3]<<24),u>>>=0,u++,a+=p}i.push(t[subarray](a,a+u)),a+=u}}for(var h=0,f=0;f<i.length;++f)h+=i[f].length;if(h!=n)throw new Error("Unexpected length: ".concat(h," != ").concat(n));return i}function decompress_iwa_file(e){Array.isArray(e)&&(e=new Uint8Array(e));for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push.apply(t,parse_snappy_chunk(n,e[subarray](r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return 1==t.length?t[0]:u8concat(t)}function compress_iwa_file(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var a=write_varint49(n),s=a.length;t.push(a),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e[subarray](r,r+n)),s+=n,i[0]=0,i[1]=255&s,i[2]=s>>8&255,i[3]=s>>16&255,r+=n}return u8concat(t)}var numbers_lut_new=function(){return{sst:[],rsst:[],ofmt:[],nfmt:[],fmla:[],ferr:[],cmnt:[]}};function numbers_format_cell(e,t,r,n,i){var a,s,o,l,c=255&t,d=t>>8,u=d>=5?i:n;e:if(r&(d>4?8:4)&&"n"==e.t&&7==c){var p=(null==(a=u[7])?void 0:a[0])?varint_to_i32(u[7][0].data):-1;if(-1==p)break e;var h=(null==(s=u[15])?void 0:s[0])?varint_to_i32(u[15][0].data):-1,f=(null==(o=u[16])?void 0:o[0])?varint_to_i32(u[16][0].data):-1,m=(null==(l=u[40])?void 0:l[0])?varint_to_i32(u[40][0].data):-1,g=e.v,_=g;t:if(m){if(0==g){h=f=2;break t}h=g>=604800?1:g>=86400?2:g>=3600?4:g>=60?8:g>=1?16:32,Math.floor(g)!=g?f=32:g%60?f=16:g%3600?f=8:g%86400?f=4:g%604800&&(f=2),f<h&&(f=h)}if(-1==h||-1==f)break e;var b=[],v=[];1==h&&(_=g/604800,1==f?v.push('d"d"'):g-=604800*(_|=0),b.push(_+(2==p?" week"+(1==_?"":"s"):1==p?"w":""))),h<=2&&f>=2&&(_=g/86400,f>2&&(g-=86400*(_|=0)),v.push('d"d"'),b.push(_+(2==p?" day"+(1==_?"":"s"):1==p?"d":""))),h<=4&&f>=4&&(_=g/3600,f>4&&(g-=3600*(_|=0)),v.push((h>=4?"[h]":"h")+'"h"'),b.push(_+(2==p?" hour"+(1==_?"":"s"):1==p?"h":""))),h<=8&&f>=8&&(_=g/60,f>8&&(g-=60*(_|=0)),v.push((h>=8?"[m]":"m")+'"m"'),0==p?b.push((8==h&&8==f||_>=10?"":"0")+_):b.push(_+(2==p?" minute"+(1==_?"":"s"):1==p?"m":""))),h<=16&&f>=16&&(_=g,f>16&&(g-=_|=0),v.push((h>=16?"[s]":"s")+'"s"'),0==p?b.push((16==f&&16==h||_>=10?"":"0")+_):b.push(_+(2==p?" second"+(1==_?"":"s"):1==p?"s":""))),f>=32&&(_=Math.round(1e3*g),h<32&&v.push('.000"ms"'),0==p?b.push((_>=100?"":_>=10?"0":"00")+_):b.push(_+(2==p?" millisecond"+(1==_?"":"s"):1==p?"ms":""))),e.w=b.join(0==p?":":" "),e.z=v.join(0==p?'":"':" "),0==p&&(e.w=e.w.replace(/:(\d\d\d)$/,".$1"))}}function parse_old_storage(e,t,r,n){var i,a=u8_to_dataview(e),s=a.getUint32(4,!0),o=-1,l=-1,c=-1,d=NaN,u=0,p=new Date(Date.UTC(2001,0,1)),h=r>1?12:8;2&s&&(c=a.getUint32(h,!0),h+=4),h+=4*popcnt(s&(r>1?3468:396)),512&s&&(o=a.getUint32(h,!0),h+=4),h+=4*popcnt(s&(r>1?12288:4096)),16&s&&(l=a.getUint32(h,!0),h+=4),32&s&&(d=a.getFloat64(h,!0),h+=8),64&s&&(p.setTime(p.getTime()+1e3*(u=a.getFloat64(h,!0))),h+=8),r>1&&255&(s=a.getUint32(8,!0)>>>16)&&(-1==c&&(c=a.getUint32(h,!0)),h+=4);var f=e[r>=4?1:2];switch(f){case 0:return;case 2:case 7:i={t:"n",v:d};break;case 3:i={t:"s",v:t.sst[l]};break;case 5:i=(null==n?void 0:n.cellDates)?{t:"d",v:p}:{t:"n",v:u/86400+35430,z:table_fmt[14]};break;case 6:i={t:"b",v:d>0};break;case 8:i={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[subarray](0,4)));var m=t.rsst[o];i={t:"s",v:m.v},m.l&&(i.l={Target:m.l});break;default:throw new Error("Unsupported cell type ".concat(e[subarray](0,4)))}return c>-1&&numbers_format_cell(i,f|r<<8,s,t.ofmt[c],t.nfmt[c]),7==f&&(i.v/=86400),i}function parse_new_storage(e,t,r){var n,i=u8_to_dataview(e),a=(i.getUint32(4,!0),i.getUint32(8,!0)),s=12,o=-1,l=-1,c=-1,d=NaN,u=NaN,p=0,h=new Date(Date.UTC(2001,0,1));1&a&&(d=readDecimal128LE(e,s),s+=16),2&a&&(u=i.getFloat64(s,!0),s+=8),4&a&&(h.setTime(h.getTime()+1e3*(p=i.getFloat64(s,!0))),s+=8),8&a&&(l=i.getUint32(s,!0),s+=4),16&a&&(o=i.getUint32(s,!0),s+=4),s+=4*popcnt(480&a),512&a&&(i.getUint32(s,!0),s+=4),s+=4*popcnt(1024&a),2048&a&&(i.getUint32(s,!0),s+=4);var f=e[1];switch(f){case 0:n={t:"z"};break;case 2:case 10:n={t:"n",v:d};break;case 3:n={t:"s",v:t.sst[l]};break;case 5:n=(null==r?void 0:r.cellDates)?{t:"d",v:h}:{t:"n",v:p/86400+35430,z:table_fmt[14]};break;case 6:n={t:"b",v:u>0};break;case 7:n={t:"n",v:u};break;case 8:n={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&a," : ").concat(e[subarray](0,4)));var m=t.rsst[o];n={t:"s",v:m.v},m.l&&(n.l={Target:m.l});break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&a," : ").concat(e[subarray](0,4)))}if(s+=4*popcnt(4096&a),516096&a&&(-1==c&&(c=i.getUint32(s,!0)),s+=4),524288&a){var g=i.getUint32(s,!0);s+=4,t.cmnt[g]&&(n.c=iwa_to_s5s_comment(t.cmnt[g]))}return c>-1&&numbers_format_cell(n,1280|f,a>>13,t.ofmt[c],t.nfmt[c]),7==f&&(n.v/=86400),n}function write_new_storage(e,t){var r=new Uint8Array(32),n=u8_to_dataview(r),i=12,a=0;switch(r[0]=5,e.t){case"n":if(e.z&&fmt_is_date(e.z)){r[1]=5,n.setFloat64(i,(numdate(e.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),a|=4,i+=8;break}r[1]=2,writeDecimal128LE(r,i,e.v),a|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),a|=2,i+=8;break;case"s":var s=null==e.v?"":String(e.v);if(e.l){var o=t.rsst.findIndex((function(t){var r;return t.v==s&&t.l==(null==(r=e.l)?void 0:r.Target)}));-1==o&&(t.rsst[o=t.rsst.length]={v:s,l:e.l.Target}),r[1]=9,n.setUint32(i,o,!0),a|=16,i+=4}else{var l=t.sst.indexOf(s);-1==l&&(t.sst[l=t.sst.length]=s),r[1]=3,n.setUint32(i,l,!0),a|=8,i+=4}break;case"d":r[1]=5,n.setFloat64(i,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),a|=4,i+=8;break;case"z":r[1]=0;break;default:throw"unsupported cell type "+e.t}return e.c&&(t.cmnt.push(s5s_to_iwa_comment(e.c)),n.setUint32(i,t.cmnt.length-1,!0),a|=524288,i+=4),n.setUint32(8,a,!0),r[subarray](0,i)}function write_old_storage(e,t){var r=new Uint8Array(32),n=u8_to_dataview(r),i=12,a=0,s="";switch(r[0]=4,e.t){case"n":case"b":case"d":case"e":case"z":break;case"s":if(s=null==e.v?"":String(e.v),e.l){var o=t.rsst.findIndex((function(t){var r;return t.v==s&&t.l==(null==(r=e.l)?void 0:r.Target)}));-1==o&&(t.rsst[o=t.rsst.length]={v:s,l:e.l.Target}),r[1]=9,n.setUint32(i,o,!0),a|=512,i+=4}break;default:throw"unsupported cell type "+e.t}switch(e.c&&(n.setUint32(i,t.cmnt.length-1,!0),a|=4096,i+=4),e.t){case"n":r[1]=2,n.setFloat64(i,e.v,!0),a|=32,i+=8;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),a|=32,i+=8;break;case"s":if(s=null==e.v?"":String(e.v),e.l);else{var l=t.sst.indexOf(s);-1==l&&(t.sst[l=t.sst.length]=s),r[1]=3,n.setUint32(i,l,!0),a|=16,i+=4}break;case"d":r[1]=5,n.setFloat64(i,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),a|=64,i+=8;break;case"z":r[1]=0;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r[subarray](0,i)}function parse_cell_storage(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:case 4:return parse_old_storage(e,t,e[0],r);case 5:return parse_new_storage(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function parse_TSP_Reference(e){return varint_to_i32(parse_shallow(e)[1][0].data)}function write_TSP_Reference(e){return write_shallow([[],[{type:0,data:write_varint49(e)}]])}function numbers_add_oref(e,t){var r,n=(null==(r=e.messages[0].meta[5])?void 0:r[0])?parse_packed_varints(e.messages[0].meta[5][0].data):[];-1==n.indexOf(t)&&(n.push(t),e.messages[0].meta[5]=[{type:2,data:write_packed_varints(n)}])}function numbers_del_oref(e,t){var r,n=(null==(r=e.messages[0].meta[5])?void 0:r[0])?parse_packed_varints(e.messages[0].meta[5][0].data):[];e.messages[0].meta[5]=[{type:2,data:write_packed_varints(n.filter((function(e){return e!=t})))}]}function parse_TST_TableDataList(e,t){var r=parse_shallow(t.data),n=varint_to_i32(r[1][0].data),i=r[3],a=[];return(i||[]).forEach((function(t){var r,i,s=parse_shallow(t.data);if(s[1]){var o=varint_to_i32(s[1][0].data)>>>0;switch(n){case 1:a[o]=u8str(s[3][0].data);break;case 8:var l=parse_shallow(e[parse_TSP_Reference(s[9][0].data)][0].data),c=e[parse_TSP_Reference(l[1][0].data)][0],d=varint_to_i32(c.meta[1][0].data);if(2001!=d)throw new Error("2000 unexpected reference to ".concat(d));var u=parse_shallow(c.data),p={v:u[3].map((function(e){return u8str(e.data)})).join("")};a[o]=p;e:if(null==(r=null==u?void 0:u[11])?void 0:r[0]){var h=null==(i=parse_shallow(u[11][0].data))?void 0:i[1];if(!h)break e;h.forEach((function(t){var r,n,i,a=parse_shallow(t.data);if(null==(r=a[2])?void 0:r[0]){var s=e[parse_TSP_Reference(null==(n=a[2])?void 0:n[0].data)][0],o=varint_to_i32(s.meta[1][0].data);switch(o){case 2032:var l=parse_shallow(s.data);(null==(i=null==l?void 0:l[2])?void 0:i[0])&&!p.l&&(p.l=u8str(l[2][0].data));break;case 2039:break;default:console.log("unrecognized ObjectAttribute type ".concat(o))}}}))}break;case 2:a[o]=parse_shallow(s[6][0].data);break;case 3:a[o]=parse_shallow(s[5][0].data);break;case 10:var f=e[parse_TSP_Reference(s[10][0].data)][0];a[o]=parse_TSD_CommentStorageArchive(e,f.data);break;default:throw n}}})),a}function parse_TST_TileRowInfo(e,t){var r,n,i,a,s,o,l,c,d,u,p,h,f,m,g,_,b=parse_shallow(e),v=varint_to_i32(b[1][0].data)>>>0,y=varint_to_i32(b[2][0].data)>>>0,w=(null==(n=null==(r=b[8])?void 0:r[0])?void 0:n.data)&&varint_to_i32(b[8][0].data)>0||!1;if((null==(a=null==(i=b[7])?void 0:i[0])?void 0:a.data)&&0!=t)g=null==(o=null==(s=b[7])?void 0:s[0])?void 0:o.data,_=null==(c=null==(l=b[6])?void 0:l[0])?void 0:c.data;else{if(!(null==(u=null==(d=b[4])?void 0:d[0])?void 0:u.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");g=null==(h=null==(p=b[4])?void 0:p[0])?void 0:h.data,_=null==(m=null==(f=b[3])?void 0:f[0])?void 0:m.data}for(var E=w?4:1,S=u8_to_dataview(g),T=[],C=0;C<g.length/2;++C){var x=S.getUint16(2*C,!0);x<65535&&T.push([C,x])}if(T.length!=y)throw"Expected ".concat(y," cells, found ").concat(T.length);var A=[];for(C=0;C<T.length-1;++C)A[T[C][0]]=_[subarray](T[C][1]*E,T[C+1][1]*E);return T.length>=1&&(A[T[T.length-1][0]]=_[subarray](T[T.length-1][1]*E)),{R:v,cells:A}}function parse_TST_Tile(e,t){var r,n=parse_shallow(t.data),i=-1;(null==(r=null==n?void 0:n[7])?void 0:r[0])&&(i=varint_to_i32(n[7][0].data)>>>0?1:0);var a=mappa(n[5],(function(e){return parse_TST_TileRowInfo(e,i)}));return{nrows:varint_to_i32(n[4][0].data)>>>0,data:a.reduce((function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach((function(r,n){if(e[t.R][n])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(n));e[t.R][n]=r})),e}),[])}}function parse_TSD_CommentStorageArchive(e,t){var r,n,i,a,s,o,l,c,d,u,p={t:"",a:""},h=parse_shallow(t);if((null==(n=null==(r=null==h?void 0:h[1])?void 0:r[0])?void 0:n.data)&&(p.t=u8str(null==(a=null==(i=null==h?void 0:h[1])?void 0:i[0])?void 0:a.data)||""),null==(o=null==(s=null==h?void 0:h[3])?void 0:s[0])?void 0:o.data){var f=parse_shallow(e[parse_TSP_Reference(null==(c=null==(l=null==h?void 0:h[3])?void 0:l[0])?void 0:c.data)][0].data);(null==(u=null==(d=f[1])?void 0:d[0])?void 0:u.data)&&(p.a=u8str(f[1][0].data))}return(null==h?void 0:h[4])&&(p.replies=[],h[4].forEach((function(t){var r=e[parse_TSP_Reference(t.data)][0];p.replies.push(parse_TSD_CommentStorageArchive(e,r.data))}))),p}function iwa_to_s5s_comment(e){var t=[];return t.push({t:e.t||"",a:e.a,T:e.replies&&e.replies.length>0}),e.replies&&e.replies.forEach((function(e){t.push({t:e.t||"",a:e.a,T:!0})})),t}function s5s_to_iwa_comment(e){for(var t={a:"",t:"",replies:[]},r=0;r<e.length;++r)0==r?(t.a=e[r].a,t.t=e[r].t):t.replies.push({a:e[r].a,t:e[r].t});return t}function parse_TST_TableModelArchive(e,t,r,n){var i,a,s,o,l,c,d,u,p,h,f,m,g,_,b=parse_shallow(t.data),v={s:{r:0,c:0},e:{r:0,c:0}};if(v.e.r=(varint_to_i32(b[6][0].data)>>>0)-1,v.e.r<0)throw new Error("Invalid row varint ".concat(b[6][0].data));if(v.e.c=(varint_to_i32(b[7][0].data)>>>0)-1,v.e.c<0)throw new Error("Invalid col varint ".concat(b[7][0].data));r["!ref"]=encode_range(v);var y=null!=r["!data"],w=r,E=parse_shallow(b[4][0].data),S=numbers_lut_new();(null==(i=E[4])?void 0:i[0])&&(S.sst=parse_TST_TableDataList(e,e[parse_TSP_Reference(E[4][0].data)][0])),(null==(a=E[6])?void 0:a[0])&&(S.fmla=parse_TST_TableDataList(e,e[parse_TSP_Reference(E[6][0].data)][0])),(null==(s=E[11])?void 0:s[0])&&(S.ofmt=parse_TST_TableDataList(e,e[parse_TSP_Reference(E[11][0].data)][0])),(null==(o=E[12])?void 0:o[0])&&(S.ferr=parse_TST_TableDataList(e,e[parse_TSP_Reference(E[12][0].data)][0])),(null==(l=E[17])?void 0:l[0])&&(S.rsst=parse_TST_TableDataList(e,e[parse_TSP_Reference(E[17][0].data)][0])),(null==(c=E[19])?void 0:c[0])&&(S.cmnt=parse_TST_TableDataList(e,e[parse_TSP_Reference(E[19][0].data)][0])),(null==(d=E[22])?void 0:d[0])&&(S.nfmt=parse_TST_TableDataList(e,e[parse_TSP_Reference(E[22][0].data)][0]));var T=parse_shallow(E[3][0].data),C=0;if(!(null==(u=E[9])?void 0:u[0]))throw"NUMBERS file missing row tree";var x=parse_shallow(E[9][0].data)[1].map((function(e){return parse_shallow(e.data)}));if(x.forEach((function(t){C=varint_to_i32(t[1][0].data);var i=varint_to_i32(t[2][0].data),a=T[1][i];if(!a)throw"NUMBERS missing tile "+i;var s=parse_shallow(a.data),o=e[parse_TSP_Reference(s[2][0].data)][0],l=varint_to_i32(o.meta[1][0].data);if(6002!=l)throw new Error("6001 unexpected reference to ".concat(l));var c=parse_TST_Tile(e,o);c.data.forEach((function(e,t){e.forEach((function(e,i){var a=parse_cell_storage(e,S,n);a&&(y?(w["!data"][C+t]||(w["!data"][C+t]=[]),w["!data"][C+t][i]=a):r[encode_col(i)+encode_row(C+t)]=a)}))})),C+=c.nrows})),null==(p=E[13])?void 0:p[0]){var A=e[parse_TSP_Reference(E[13][0].data)][0],I=varint_to_i32(A.meta[1][0].data);if(6144!=I)throw new Error("Expected merge type 6144, found ".concat(I));r["!merges"]=null==(h=parse_shallow(A.data))?void 0:h[1].map((function(e){var t=parse_shallow(e.data),r=u8_to_dataview(parse_shallow(t[1][0].data)[1][0].data),n=u8_to_dataview(parse_shallow(t[2][0].data)[1][0].data);return{s:{r:r.getUint16(0,!0),c:r.getUint16(2,!0)},e:{r:r.getUint16(0,!0)+n.getUint16(0,!0)-1,c:r.getUint16(2,!0)+n.getUint16(2,!0)-1}}}))}if(!(null==(f=r["!merges"])?void 0:f.length)&&(null==(m=b[47])?void 0:m[0])){var D=parse_shallow(b[47][0].data);if(null==(g=D[2])?void 0:g[0]){var k=parse_shallow(D[2][0].data);(null==(_=k[3])?void 0:_[0])&&(r["!merges"]=mappa(k[3],(function(e){var t,r,n,i,a,s=parse_shallow(e),o=parse_shallow(s[2][0].data),l=parse_shallow(o[1][0].data);if(null==(t=l[1])?void 0:t[0]){var c=parse_shallow(l[1][0].data);if(67==varint_to_i32(c[1][0].data)){var d=parse_shallow(c[40][0].data);if((null==(r=d[3])?void 0:r[0])&&(null==(n=d[4])?void 0:n[0])){var u=parse_shallow(d[3][0].data),p=parse_shallow(d[4][0].data),h=varint_to_i32(u[1][0].data),f=(null==(i=u[2])?void 0:i[0])?varint_to_i32(u[2][0].data):h,m=varint_to_i32(p[1][0].data);return{s:{r:m,c:h},e:{r:(null==(a=p[2])?void 0:a[0])?varint_to_i32(p[2][0].data):m,c:f}}}}}})).filter((function(e){return null!=e})))}}}function parse_TST_TableInfoArchive(e,t,r){var n=parse_shallow(t.data),i={"!ref":"A1"};(null==r?void 0:r.dense)&&(i["!data"]=[]);var a=e[parse_TSP_Reference(n[2][0].data)],s=varint_to_i32(a[0].meta[1][0].data);if(6001!=s)throw new Error("6000 unexpected reference to ".concat(s));return parse_TST_TableModelArchive(e,a[0],i,r),i}function parse_TN_SheetArchive(e,t,r){var n,i=parse_shallow(t.data),a={name:(null==(n=i[1])?void 0:n[0])?u8str(i[1][0].data):"",sheets:[]};return mappa(i[2],parse_TSP_Reference).forEach((function(t){e[t].forEach((function(t){6e3==varint_to_i32(t.meta[1][0].data)&&a.sheets.push(parse_TST_TableInfoArchive(e,t,r))}))})),a}function parse_TN_DocumentArchive(e,t,r){var n,i=book_new();i.Workbook={WBProps:{date1904:!0}};var a=parse_shallow(t.data);if(null==(n=a[2])?void 0:n[0])throw new Error("Keynote presentations are not supported");if(mappa(a[1],parse_TSP_Reference).forEach((function(t){e[t].forEach((function(t){if(2==varint_to_i32(t.meta[1][0].data)){var n=parse_TN_SheetArchive(e,t,r);n.sheets.forEach((function(e,t){book_append_sheet(i,e,0==t?n.name:n.name+"_"+t,!0)}))}}))})),0==i.SheetNames.length)throw new Error("Empty NUMBERS file");return i.bookType="numbers",i}function parse_numbers_iwa(e,t){var r,n,i,a,s,o,l,c={},d=[];if(e.FullPaths.forEach((function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")})),e.FileIndex.forEach((function(e){if(e.name.match(/\.iwa$/)&&0==e.content[0]){var t,r;try{t=decompress_iwa_file(e.content)}catch(t){return console.log("?? "+e.content.length+" "+(t.message||t))}try{r=parse_iwa_file(t)}catch(e){return console.log("## "+(e.message||e))}r.forEach((function(e){c[e.id]=e.messages,d.push(e.id)}))}})),!d.length)throw new Error("File has no messages");if((null==(i=null==(n=null==(r=null==c?void 0:c[1])?void 0:r[0].meta)?void 0:n[1])?void 0:i[0].data)&&1e4==varint_to_i32(c[1][0].meta[1][0].data))throw new Error("Pages documents are not supported");var u=(null==(l=null==(o=null==(s=null==(a=null==c?void 0:c[1])?void 0:a[0])?void 0:s.meta)?void 0:o[1])?void 0:l[0].data)&&1==varint_to_i32(c[1][0].meta[1][0].data)&&c[1][0];if(u||d.forEach((function(e){c[e].forEach((function(e){if(1==varint_to_i32(e.meta[1][0].data)>>>0){if(u)throw new Error("Document has multiple roots");u=e}}))})),!u)throw new Error("Cannot find Document root");return parse_TN_DocumentArchive(c,u,t)}function write_TST_TileRowInfo(e,t,r){var n,i,a,s=[[],[{type:0,data:write_varint49(0)}],[{type:0,data:write_varint49(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},(function(){return 255})))}],[{type:0,data:write_varint49(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},(function(){return 255})))}],[{type:0,data:write_varint49(1)}]];if(!(null==(n=s[6])?void 0:n[0])||!(null==(i=s[7])?void 0:i[0]))throw"Mutation only works on post-BNC storages!";var o=0;if(s[7][0].data.length<2*e.length){var l=new Uint8Array(2*e.length);l.set(s[7][0].data),s[7][0].data=l}if(s[4][0].data.length<2*e.length){var c=new Uint8Array(2*e.length);c.set(s[4][0].data),s[4][0].data=c}for(var d=u8_to_dataview(s[7][0].data),u=0,p=[],h=u8_to_dataview(s[4][0].data),f=0,m=[],g=r?4:1,_=0;_<e.length;++_)if(null==e[_]||"z"==e[_].t&&!(null==(a=e[_].c)?void 0:a.length)||"e"==e[_].t)d.setUint16(2*_,65535,!0),h.setUint16(2*_,65535);else{var b,v;switch(d.setUint16(2*_,u/g,!0),h.setUint16(2*_,f/g,!0),e[_].t){case"d":if(e[_].v instanceof Date){b=write_new_storage(e[_],t),v=write_old_storage(e[_],t);break}b=write_new_storage(e[_],t),v=write_old_storage(e[_],t);break;case"s":case"n":case"b":case"z":b=write_new_storage(e[_],t),v=write_old_storage(e[_],t);break;default:throw new Error("Unsupported value "+e[_])}p.push(b),u+=b.length,m.push(v),f+=v.length,++o}for(s[2][0].data=write_varint49(o),s[5][0].data=write_varint49(5);_<s[7][0].data.length/2;++_)d.setUint16(2*_,65535,!0),h.setUint16(2*_,65535,!0);return s[6][0].data=u8concat(p),s[3][0].data=u8concat(m),s[8]=[{type:0,data:write_varint49(r?1:0)}],s}function write_iwam(e,t){return{meta:[[],[{type:0,data:write_varint49(e)}]],data:t}}function get_unique_msgid(e,t){t.last||(t.last=927262);for(var r=t.last;r<2e6;++r)if(!t[r])return t[t.last=r]=e,r;throw new Error("Too many messages")}function build_numbers_deps(e){var t={},r=[];return e.FileIndex.map((function(t,r){return[t,e.FullPaths[r]]})).forEach((function(e){var n=e[0],i=e[1];2==n.type&&n.name.match(/\.iwa/)&&0==n.content[0]&&parse_iwa_file(decompress_iwa_file(n.content)).forEach((function(e){r.push(e.id),t[e.id]={deps:[],location:i,type:varint_to_i32(e.messages[0].meta[1][0].data)}}))})),e.FileIndex.forEach((function(e){e.name.match(/\.iwa/)&&0==e.content[0]&&parse_iwa_file(decompress_iwa_file(e.content)).forEach((function(e){e.messages.forEach((function(r){[5,6].forEach((function(n){r.meta[n]&&r.meta[n].forEach((function(r){t[e.id].deps.push(varint_to_i32(r.data))}))}))}))}))})),t}function write_TSP_Color_RGB(e,t,r){return write_shallow([[],[{type:0,data:write_varint49(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([e/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([r/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:write_varint49(1)}]])}function get_author_color(e){switch(e){case 0:return write_TSP_Color_RGB(99,222,171);case 1:return write_TSP_Color_RGB(162,197,240);case 2:return write_TSP_Color_RGB(255,189,189)}return write_TSP_Color_RGB(255*Math.random(),255*Math.random(),255*Math.random())}function write_numbers_iwa(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=CFB.read(t.numbers,{type:"base64"}),n=build_numbers_deps(r),i=numbers_iwa_find(r,n,1);if(null==i)throw"Could not find message ".concat(1," in Numbers template");var a=mappa(parse_shallow(i.messages[0].data)[1],parse_TSP_Reference);if(a.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return e.SheetNames.forEach((function(t,s){s>=1&&(numbers_add_ws(r,n,s+1),i=numbers_iwa_find(r,n,1),a=mappa(parse_shallow(i.messages[0].data)[1],parse_TSP_Reference)),write_numbers_ws(r,n,e.Sheets[t],t,s,a[s])})),r}function numbers_iwa_doit(e,t,r,n){var i=CFB.find(e,t[r].location);if(!i)throw"Could not find ".concat(t[r].location," in Numbers template");var a=parse_iwa_file(decompress_iwa_file(i.content));n(a.find((function(e){return e.id==r})),a),i.content=compress_iwa_file(write_iwa_file(a)),i.size=i.content.length}function numbers_iwa_find(e,t,r){var n=CFB.find(e,t[r].location);if(!n)throw"Could not find ".concat(t[r].location," in Numbers template");return parse_iwa_file(decompress_iwa_file(n.content)).find((function(e){return e.id==r}))}function numbers_add_meta(e,t,r){e[3].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(t)}],[{type:2,data:stru8(r.replace(/-[\s\S]*$/,""))}],[{type:2,data:stru8(r)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:write_varint49(0)}],[],[{type:0,data:write_varint49(0)}]])}),e[1]=[{type:0,data:write_varint49(Math.max(t+1,varint_to_i32(e[1][0].data)))}]}function numbers_add_msg(e,t,r,n,i,a){a||(a=get_unique_msgid({deps:[],location:"",type:t},i));var s="".concat(n,"-").concat(a,".iwa");i[a].location="Root Entry"+s,CFB.utils.cfb_add(e,s,compress_iwa_file(write_iwa_file([{id:a,messages:[write_iwam(t,write_shallow(r))]}])));var o=s.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return numbers_iwa_doit(e,i,2,(function(e){var t=parse_shallow(e.messages[0].data);numbers_add_meta(t,a||0,o),e.messages[0].data=write_shallow(t)})),a}function numbers_meta_add_dep(e,t,r,n){var i=t[r].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),a=e[3].findIndex((function(e){var t,r,n=parse_shallow(e.data);return(null==(t=n[3])?void 0:t[0])?u8str(n[3][0].data)==i:!(!(null==(r=n[2])?void 0:r[0])||u8str(n[2][0].data)!=i)})),s=parse_shallow(e[3][a].data);s[6]||(s[6]=[]),(Array.isArray(n)?n:[n]).forEach((function(e){s[6].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(e)}]])})})),e[3][a].data=write_shallow(s)}function numbers_meta_del_dep(e,t,r,n){var i=t[r].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),a=e[3].findIndex((function(e){var t,r,n=parse_shallow(e.data);return(null==(t=n[3])?void 0:t[0])?u8str(n[3][0].data)==i:!(!(null==(r=n[2])?void 0:r[0])||u8str(n[2][0].data)!=i)})),s=parse_shallow(e[3][a].data);s[6]||(s[6]=[]),s[6]=s[6].filter((function(e){return varint_to_i32(parse_shallow(e.data)[1][0].data)!=n})),e[3][a].data=write_shallow(s)}function numbers_add_ws(e,t,r){var n=-1,i=-1,a={};numbers_iwa_doit(e,t,1,(function(r,s){var o=parse_shallow(r.messages[0].data);n=parse_TSP_Reference(parse_shallow(r.messages[0].data)[1][0].data),i=get_unique_msgid({deps:[1],location:t[n].location,type:2},t),a[n]=i,numbers_add_oref(r,i),o[1].push({type:2,data:write_TSP_Reference(i)});var l=numbers_iwa_find(e,t,n);l.id=i,t[1].location==t[i].location?s.push(l):numbers_iwa_doit(e,t,i,(function(e,t){return t.push(l)})),r.messages[0].data=write_shallow(o)}));var s=-1;numbers_iwa_doit(e,t,i,(function(r,n){for(var o=parse_shallow(r.messages[0].data),l=3;l<=69;++l)delete o[l];var c=mappa(o[2],parse_TSP_Reference);c.forEach((function(e){return numbers_del_oref(r,e)})),s=get_unique_msgid({deps:[i],location:t[c[0]].location,type:t[c[0]].type},t),numbers_add_oref(r,s),a[c[0]]=s,o[2]=[{type:2,data:write_TSP_Reference(s)}];var d=numbers_iwa_find(e,t,c[0]);d.id=s,t[c[0]].location==t[i].location?n.push(d):(numbers_iwa_doit(e,t,2,(function(e){var r=parse_shallow(e.messages[0].data);numbers_meta_add_dep(r,t,i,s),e.messages[0].data=write_shallow(r)})),numbers_iwa_doit(e,t,s,(function(e,t){return t.push(d)}))),r.messages[0].data=write_shallow(o)}));var o=-1;numbers_iwa_doit(e,t,s,(function(r,n){for(var i=parse_shallow(r.messages[0].data),l=parse_shallow(i[1][0].data),c=3;c<=69;++c)delete l[c];var d=parse_TSP_Reference(l[2][0].data);l[2][0].data=write_TSP_Reference(a[d]),i[1][0].data=write_shallow(l);var u=parse_TSP_Reference(i[2][0].data);numbers_del_oref(r,u),numbers_add_oref(r,o=get_unique_msgid({deps:[s],location:t[u].location,type:t[u].type},t)),a[u]=o,i[2][0].data=write_TSP_Reference(o);var p=numbers_iwa_find(e,t,u);p.id=o,t[s].location==t[o].location?n.push(p):numbers_iwa_doit(e,t,o,(function(e,t){return t.push(p)})),r.messages[0].data=write_shallow(i)})),numbers_iwa_doit(e,t,o,(function(n,i){var s,l,c=parse_shallow(n.messages[0].data),d=u8str(c[1][0].data).replace(/-[A-Z0-9]*/,"-".concat(("0000"+r.toString(16)).slice(-4)));if(c[1][0].data=stru8(d),[12,13,29,31,32,33,39,44,47,81,82,84].forEach((function(e){return delete c[e]})),c[45]){var u=parse_TSP_Reference(parse_shallow(c[45][0].data)[1][0].data);numbers_del_oref(n,u),delete c[45]}c[70]&&(null==(s=parse_shallow(c[70][0].data)[2])||s.forEach((function(e){var t=parse_shallow(e.data);[2,3].map((function(e){return t[e][0]})).forEach((function(e){var t=parse_shallow(e.data);if(t[8]){var r=parse_TSP_Reference(t[8][0].data);numbers_del_oref(n,r)}}))})),delete c[70]),[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach((function(e){if(c[e]){var t=parse_TSP_Reference(c[e][0].data);delete c[e],numbers_del_oref(n,t)}}));var p=parse_shallow(c[4][0].data);[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach((function(r){var s;if(null==(s=p[r])?void 0:s[0]){var l=parse_TSP_Reference(p[r][0].data),c=get_unique_msgid({deps:[o],location:t[l].location,type:t[l].type},t);numbers_del_oref(n,l),numbers_add_oref(n,c),a[l]=c;var d=numbers_iwa_find(e,t,l);if(d.id=c,t[l].location==t[o].location)i.push(d);else{t[c].location=t[l].location.replace(l.toString(),c.toString()),t[c].location==t[l].location&&(t[c].location=t[c].location.replace(/\.iwa/,"-".concat(c,".iwa"))),CFB.utils.cfb_add(e,t[c].location,compress_iwa_file(write_iwa_file([d])));var u=t[c].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");numbers_iwa_doit(e,t,2,(function(e){var r=parse_shallow(e.messages[0].data);numbers_add_meta(r,c,u),numbers_meta_add_dep(r,t,o,c),e.messages[0].data=write_shallow(r)}))}p[r][0].data=write_TSP_Reference(c)}}));var h=parse_shallow(p[1][0].data);null==(l=h[2])||l.forEach((function(r){var s=parse_TSP_Reference(r.data),l=get_unique_msgid({deps:[o],location:t[s].location,type:t[s].type},t);numbers_del_oref(n,s),numbers_add_oref(n,l),a[s]=l;var c=numbers_iwa_find(e,t,s);if(c.id=l,t[s].location==t[o].location)i.push(c);else{t[l].location=t[s].location.replace(s.toString(),l.toString()),t[l].location==t[s].location&&(t[l].location=t[l].location.replace(/\.iwa/,"-".concat(l,".iwa"))),CFB.utils.cfb_add(e,t[l].location,compress_iwa_file(write_iwa_file([c])));var d=t[l].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");numbers_iwa_doit(e,t,2,(function(e){var r=parse_shallow(e.messages[0].data);numbers_add_meta(r,l,d),numbers_meta_add_dep(r,t,o,l),e.messages[0].data=write_shallow(r)}))}r.data=write_TSP_Reference(l)})),p[1][0].data=write_shallow(h);var f=parse_shallow(p[3][0].data);f[1].forEach((function(r){var i=parse_shallow(r.data),s=parse_TSP_Reference(i[2][0].data),l=a[s];if(!a[s]){l=get_unique_msgid({deps:[o],location:"",type:t[s].type},t),t[l].location="Root Entry/Index/Tables/Tile-".concat(l,".iwa"),a[s]=l;var c=numbers_iwa_find(e,t,s);c.id=l,numbers_del_oref(n,s),numbers_add_oref(n,l),CFB.utils.cfb_add(e,"/Index/Tables/Tile-".concat(l,".iwa"),compress_iwa_file(write_iwa_file([c]))),numbers_iwa_doit(e,t,2,(function(e){var r=parse_shallow(e.messages[0].data);r[3].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(l)}],[{type:2,data:stru8("Tables/Tile")}],[{type:2,data:stru8("Tables/Tile-".concat(l))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:write_varint49(0)}],[],[{type:0,data:write_varint49(0)}]])}),r[1]=[{type:0,data:write_varint49(Math.max(l+1,varint_to_i32(r[1][0].data)))}],numbers_meta_add_dep(r,t,o,l),e.messages[0].data=write_shallow(r)}))}i[2][0].data=write_TSP_Reference(l),r.data=write_shallow(i)})),p[3][0].data=write_shallow(f),c[4][0].data=write_shallow(p),n.messages[0].data=write_shallow(c)}))}function write_numbers_ws(e,t,r,n,i,a){var s=[];numbers_iwa_doit(e,t,a,(function(e){var t=parse_shallow(e.messages[0].data);t[1]=[{type:2,data:stru8(n)}],s=mappa(t[2],parse_TSP_Reference),e.messages[0].data=write_shallow(t)}));var o=parse_TSP_Reference(parse_shallow(numbers_iwa_find(e,t,s[0]).messages[0].data)[2][0].data);numbers_iwa_doit(e,t,o,(function(n,i){return write_numbers_tma(e,t,r,n,i,o)}))}var USE_WIDE_ROWS=!0;function write_numbers_tma(e,t,r,n,i,a){if(!r["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var s=decode_range(r["!ref"]);s.s.r=s.s.c=0;var o=!1;s.e.c>999&&(o=!0,s.e.c=999),s.e.r>999999&&(o=!0,s.e.r=999999),o&&console.error("Truncating to ".concat(encode_range(s)));var l=[];if(r["!data"])l=r["!data"];else{for(var c=[],d=0;d<=s.e.c;++d)c[d]=encode_col(d);for(var u=0;u<=s.e.r;++u){l[u]=[];var p=""+(u+1);for(d=0;d<=s.e.c;++d){var h=r[c[d]+p];h&&(l[u][d]=h)}}}var f={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],ferr:[],fmla:[],nfmt:[],ofmt:[],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},m=parse_shallow(n.messages[0].data);m[6][0].data=write_varint49(s.e.r+1),m[7][0].data=write_varint49(s.e.c+1),delete m[46];var g=parse_shallow(m[4][0].data),_=parse_TSP_Reference(parse_shallow(g[1][0].data)[2][0].data);numbers_iwa_doit(e,t,_,(function(e,t){var r,n=parse_shallow(e.messages[0].data);if(null==(r=null==n?void 0:n[2])?void 0:r[0])for(var i=0;i<l.length;++i){var a=parse_shallow(n[2][0].data);a[1][0].data=write_varint49(i),a[4][0].data=write_varint49(l[i].length),n[2][i]={type:n[2][0].type,data:write_shallow(a)}}e.messages[0].data=write_shallow(n)}));var b=parse_TSP_Reference(g[2][0].data);numbers_iwa_doit(e,t,b,(function(e,t){for(var r=parse_shallow(e.messages[0].data),n=0;n<=s.e.c;++n){var i=parse_shallow(r[2][0].data);i[1][0].data=write_varint49(n),i[4][0].data=write_varint49(s.e.r+1),r[2][n]={type:r[2][0].type,data:write_shallow(i)}}e.messages[0].data=write_shallow(r)}));var v=parse_shallow(g[9][0].data);v[1]=[];var y=parse_shallow(g[3][0].data),w=256;y[2]=[{type:0,data:write_varint49(w)}];var E=parse_TSP_Reference(parse_shallow(y[1][0].data)[2][0].data),S=(O=parse_shallow(numbers_iwa_find(e,t,2).messages[0].data)[3].filter((function(e){return varint_to_i32(parse_shallow(e.data)[1][0].data)==E})),(null==O?void 0:O.length)?varint_to_i32(parse_shallow(O[0].data)[12][0].data):0);CFB.utils.cfb_del(e,t[E].location),numbers_iwa_doit(e,t,2,(function(e){var r=parse_shallow(e.messages[0].data);r[3]=r[3].filter((function(e){return varint_to_i32(parse_shallow(e.data)[1][0].data)!=E})),numbers_meta_del_dep(r,t,a,E),e.messages[0].data=write_shallow(r)})),numbers_del_oref(n,E),y[1]=[];for(var T=Math.ceil((s.e.r+1)/w),C=0;C<T;++C){var x=get_unique_msgid({deps:[],location:"",type:6002},t);t[x].location="Root Entry/Index/Tables/Tile-".concat(x,".iwa");for(var A=[[],[{type:0,data:write_varint49(0)}],[{type:0,data:write_varint49(Math.min(s.e.r+1,(C+1)*w))}],[{type:0,data:write_varint49(0)}],[{type:0,data:write_varint49(Math.min((C+1)*w,s.e.r+1)-C*w)}],[],[{type:0,data:write_varint49(5)}],[{type:0,data:write_varint49(1)}],[{type:0,data:write_varint49(USE_WIDE_ROWS?1:0)}]],I=C*w;I<=Math.min(s.e.r,(C+1)*w-1);++I){var D=write_TST_TileRowInfo(l[I],f,USE_WIDE_ROWS);D[1][0].data=write_varint49(I-C*w),A[5].push({data:write_shallow(D),type:2})}y[1].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(C)}],[{type:2,data:write_TSP_Reference(x)}]])});var k=compress_iwa_file(write_iwa_file([{id:x,messages:[write_iwam(6002,write_shallow(A))]}]));CFB.utils.cfb_add(e,"/Index/Tables/Tile-".concat(x,".iwa"),k),numbers_iwa_doit(e,t,2,(function(e){var r=parse_shallow(e.messages[0].data);r[3].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(x)}],[{type:2,data:stru8("Tables/Tile")}],[{type:2,data:stru8("Tables/Tile-".concat(x))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:write_varint49(0)}],[],[{type:0,data:write_varint49(S)}]])}),r[1]=[{type:0,data:write_varint49(Math.max(x+1,varint_to_i32(r[1][0].data)))}],numbers_meta_add_dep(r,t,a,x),e.messages[0].data=write_shallow(r)})),numbers_add_oref(n,x),v[1].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(C*w)}],[{type:0,data:write_varint49(C)}]])})}if(g[3][0].data=write_shallow(y),g[9][0].data=write_shallow(v),g[10]=[{type:2,data:new Uint8Array([])}],r["!merges"]){var L=get_unique_msgid({type:6144,deps:[a],location:t[a].location},t);i.push({id:L,messages:[write_iwam(6144,write_shallow([[],r["!merges"].map((function(e){return{type:2,data:write_shallow([[],[{type:2,data:write_shallow([[],[{type:5,data:new Uint8Array(new Uint16Array([e.s.r,e.s.c]).buffer)}]])}],[{type:2,data:write_shallow([[],[{type:5,data:new Uint8Array(new Uint16Array([e.e.r-e.s.r+1,e.e.c-e.s.c+1]).buffer)}]])}]])}}))]))]}),g[13]=[{type:2,data:write_TSP_Reference(L)}],numbers_iwa_doit(e,t,2,(function(e){var r=parse_shallow(e.messages[0].data);numbers_meta_add_dep(r,t,a,L),e.messages[0].data=write_shallow(r)})),numbers_add_oref(n,L)}else delete g[13];var P=parse_TSP_Reference(g[4][0].data);numbers_iwa_doit(e,t,P,(function(e){var t=parse_shallow(e.messages[0].data);t[3]=[],f.sst.forEach((function(e,r){0!=r&&t[3].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(r)}],[{type:0,data:write_varint49(1)}],[{type:2,data:stru8(e)}]])})})),e.messages[0].data=write_shallow(t)}));var O,R=parse_TSP_Reference(g[17][0].data);if(numbers_iwa_doit(e,t,R,(function(r){var n=parse_shallow(r.messages[0].data);n[3]=[];var i=[904980,903835,903815,903845];f.rsst.forEach((function(a,s){if(0!=s){var o=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:stru8(a.v)}]];o[10]=[{type:0,data:new Uint8Array([1])}],o[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],o[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],o[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],o[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],o[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],o[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],o[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],o[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var l=get_unique_msgid({deps:[],location:"",type:2001},t),c=[];if(a.l){var d=numbers_add_msg(e,2032,[[],[],[{type:2,data:stru8(a.l)}]],"/Index/Tables/DataList",t);o[11]=[];var u=[[],[]];u[1]||(u[1]=[]),u[1].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(0)}],[{type:2,data:write_TSP_Reference(d)}]])}),o[11][0]={type:2,data:write_shallow(u)},c.push(d)}numbers_add_msg(e,2001,o,"/Index/Tables/DataList",t,l),numbers_iwa_doit(e,t,l,(function(e){i.forEach((function(t){return numbers_add_oref(e,t)})),c.forEach((function(t){return numbers_add_oref(e,t)}))}));var p=numbers_add_msg(e,6218,[[],[{type:2,data:write_TSP_Reference(l)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",t);numbers_iwa_doit(e,t,p,(function(e){return numbers_add_oref(e,l)})),n[3].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(s)}],[{type:0,data:write_varint49(1)}],[],[],[],[],[],[],[{type:2,data:write_TSP_Reference(p)}]])}),numbers_add_oref(r,p),numbers_iwa_doit(e,t,2,(function(e){var r=parse_shallow(e.messages[0].data);numbers_meta_add_dep(r,t,R,p),numbers_meta_add_dep(r,t,p,l),numbers_meta_add_dep(r,t,l,c),numbers_meta_add_dep(r,t,l,i),e.messages[0].data=write_shallow(r)}))}})),r.messages[0].data=write_shallow(n)})),f.cmnt.length>1){var N=parse_TSP_Reference(g[19][0].data),B={},F=0;numbers_iwa_doit(e,t,N,(function(r){var n=parse_shallow(r.messages[0].data);n[3]=[],f.cmnt.forEach((function(i,a){if(0!=a){var s=[];i.replies&&i.replies.forEach((function(r){B[r.a||""]||(B[r.a||""]=numbers_add_msg(e,212,[[],[{type:2,data:stru8(r.a||"")}],[{type:2,data:get_author_color(++F)}],[],[{type:0,data:write_varint49(0)}]],"/Index/Tables/DataList",t));var n=B[r.a||""],i=numbers_add_msg(e,3056,[[],[{type:2,data:stru8(r.t||"")}],[{type:2,data:write_shallow([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:write_TSP_Reference(n)}]],"/Index/Tables/DataList",t);numbers_iwa_doit(e,t,i,(function(e){return numbers_add_oref(e,n)})),s.push(i),numbers_iwa_doit(e,t,2,(function(e){var r=parse_shallow(e.messages[0].data);numbers_meta_add_dep(r,t,i,n),e.messages[0].data=write_shallow(r)}))})),B[i.a||""]||(B[i.a||""]=numbers_add_msg(e,212,[[],[{type:2,data:stru8(i.a||"")}],[{type:2,data:get_author_color(++F)}],[],[{type:0,data:write_varint49(0)}]],"/Index/Tables/DataList",t));var o=B[i.a||""],l=numbers_add_msg(e,3056,[[],[{type:2,data:stru8(i.t||"")}],[{type:2,data:write_shallow([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:write_TSP_Reference(o)}],s.map((function(e){return{type:2,data:write_TSP_Reference(e)}})),[{type:2,data:write_shallow([[],[{type:0,data:write_varint49(a)}],[{type:0,data:write_varint49(0)}]])}]],"/Index/Tables/DataList",t);numbers_iwa_doit(e,t,l,(function(e){numbers_add_oref(e,o),s.forEach((function(t){return numbers_add_oref(e,t)}))})),n[3].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(a)}],[{type:0,data:write_varint49(1)}],[],[],[],[],[],[],[],[{type:2,data:write_TSP_Reference(l)}]])}),numbers_add_oref(r,l),numbers_iwa_doit(e,t,2,(function(e){var r=parse_shallow(e.messages[0].data);numbers_meta_add_dep(r,t,N,l),numbers_meta_add_dep(r,t,l,o),s.length&&numbers_meta_add_dep(r,t,l,s),e.messages[0].data=write_shallow(r)}))}})),n[2][0].data=write_varint49(f.cmnt.length+1),r.messages[0].data=write_shallow(n)}))}m[4][0].data=write_shallow(g),n.messages[0].data=write_shallow(m)}function fix_opts_func(e){return function(t){for(var r=0;r!=e.length;++r){var n=e[r];void 0===t[n[0]]&&(t[n[0]]=n[1]),"n"===n[2]&&(t[n[0]]=Number(t[n[0]]))}}}function fix_read_opts(e){fix_opts_func([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function fix_write_opts(e){fix_opts_func([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function get_sheet_type(e){return RELS.WS.indexOf(e)>-1?"sheet":RELS.CS&&e==RELS.CS?"chart":RELS.DS&&e==RELS.DS?"dialog":RELS.MS&&e==RELS.MS?"macro":e&&e.length?e:"sheet"}function safe_parse_wbrels(e,t){if(!e)return 0;try{e=t.map((function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,get_sheet_type(e["!id"][t.id].Type)]}))}catch(e){return null}return e&&0!==e.length?e:null}function parse_sheet_legacy_drawing(e,t,r,n,i,a,s,o){if(e&&e["!legdrawel"]){var l=getzipstr(r,resolve_path(e["!legdrawel"].Target,n),!0);l&&parse_vml(utf8read(l),e,o||[])}}function safe_parse_sheet(e,t,r,n,i,a,s,o,l,c,d,u){try{a[n]=parse_rels(getzipstr(e,r,!0),t);var p,h=getzipdata(e,t);switch(o){case"sheet":p=parse_ws(h,t,i,l,a[n],c,d,u);break;case"chart":if(!(p=parse_cs(h,t,i,l,a[n],c,d,u))||!p["!drawel"])break;var f=resolve_path(p["!drawel"].Target,t),m=get_rels_path(f),g=resolve_path(parse_drawing(getzipstr(e,f,!0),parse_rels(getzipstr(e,m,!0),f)),f),_=get_rels_path(g);p=parse_chart(getzipstr(e,g,!0),g,l,parse_rels(getzipstr(e,_,!0),g),c,p);break;case"macro":p=parse_ms(h,t,i,l,a[n],c,d,u);break;case"dialog":p=parse_ds(h,t,i,l,a[n],c,d,u);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=p;var b=[],v=[];a&&a[n]&&keys(a[n]).forEach((function(r){var i="";if(a[n][r].Type==RELS.CMNT){if(i=resolve_path(a[n][r].Target,t),!(b=parse_cmnt(getzipdata(e,i,!0),i,l))||!b.length)return;sheet_insert_comments(p,b,!1)}a[n][r].Type==RELS.TCMNT&&(i=resolve_path(a[n][r].Target,t),v=v.concat(parse_tcmnt_xml(getzipdata(e,i,!0),l)))})),v&&v.length&&sheet_insert_comments(p,v,!0,l.people||[]),parse_sheet_legacy_drawing(p,o,e,t,i,l,c,b)}catch(e){if(l.WTF)throw e}}function strip_front_slash(e){return"/"==e.charAt(0)?e.slice(1):e}function parse_zip(e,t){if(make_ssf(),fix_read_opts(t=t||{}),safegetzipfile(e,"META-INF/manifest.xml"))return parse_ods(e,t);if(safegetzipfile(e,"objectdata.xml"))return parse_ods(e,t);if(safegetzipfile(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(void 0!==parse_numbers_iwa){if(e.FileIndex)return parse_numbers_iwa(e,t);var r=CFB.utils.cfb_new();return zipentries(e).forEach((function(t){zip_add_file(r,t,getzipbin(e,t))})),parse_numbers_iwa(r,t)}throw new Error("Unsupported NUMBERS file")}if(!safegetzipfile(e,"[Content_Types].xml")){if(safegetzipfile(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(safegetzipfile(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");var n=CFB.find(e,"Index.zip");if(n)return delete(t=dup(t)).type,"string"==typeof n.content&&(t.type="binary"),"undefined"!=typeof Bun&&Buffer.isBuffer(n.content)?readSync(new Uint8Array(n.content),t):readSync(n.content,t);throw new Error("Unsupported ZIP file")}var i,a,s=zipentries(e),o=parse_ct(getzipstr(e,"[Content_Types].xml")),l=!1;if(0===o.workbooks.length&&getzipdata(e,a="xl/workbook.xml",!0)&&o.workbooks.push(a),0===o.workbooks.length){if(!getzipdata(e,a="xl/workbook.bin",!0))throw new Error("Could not find workbook");o.workbooks.push(a),l=!0}"bin"==o.workbooks[0].slice(-3)&&(l=!0);var c={},d={};if(!t.bookSheets&&!t.bookProps){if(strs=[],o.sst)try{strs=parse_sst(getzipdata(e,strip_front_slash(o.sst)),o.sst,t)}catch(e){if(t.WTF)throw e}t.cellStyles&&o.themes.length&&(c=parse_theme_xml(getzipstr(e,o.themes[0].replace(/^\//,""),!0)||"",t)),o.style&&(d=parse_sty(getzipdata(e,strip_front_slash(o.style)),o.style,c,t))}o.links.map((function(r){try{var n=parse_rels(getzipstr(e,get_rels_path(strip_front_slash(r))),r);return parse_xlink(getzipdata(e,strip_front_slash(r)),n,r,t)}catch(e){}}));var u=parse_wb(getzipdata(e,strip_front_slash(o.workbooks[0])),o.workbooks[0],t),p={},h="";o.coreprops.length&&((h=getzipdata(e,strip_front_slash(o.coreprops[0]),!0))&&(p=parse_core_props(h)),0!==o.extprops.length&&(h=getzipdata(e,strip_front_slash(o.extprops[0]),!0))&&parse_ext_props(h,p,t));var f={};t.bookSheets&&!t.bookProps||0!==o.custprops.length&&(h=getzipstr(e,strip_front_slash(o.custprops[0]),!0))&&(f=parse_cust_props(h,t));var m={};if((t.bookSheets||t.bookProps)&&(u.Sheets?i=u.Sheets.map((function(e){return e.name})):p.Worksheets&&p.SheetNames.length>0&&(i=p.SheetNames),t.bookProps&&(m.Props=p,m.Custprops=f),t.bookSheets&&void 0!==i&&(m.SheetNames=i),t.bookSheets?m.SheetNames:t.bookProps))return m;i={};var g={};t.bookDeps&&o.calcchain&&(g=parse_cc(getzipdata(e,strip_front_slash(o.calcchain)),o.calcchain,t));var _,b,v=0,y={},w=u.Sheets;p.Worksheets=w.length,p.SheetNames=[];for(var E=0;E!=w.length;++E)p.SheetNames[E]=w[E].name;var S=l?"bin":"xml",T=o.workbooks[0].lastIndexOf("/"),C=(o.workbooks[0].slice(0,T+1)+"_rels/"+o.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");safegetzipfile(e,C)||(C="xl/_rels/workbook."+S+".rels");var x=parse_rels(getzipstr(e,C,!0),C.replace(/_rels.*/,"s5s"));(o.metadata||[]).length>=1&&(t.xlmeta=parse_xlmeta(getzipdata(e,strip_front_slash(o.metadata[0])),o.metadata[0],t)),(o.people||[]).length>=1&&(t.people=parse_people_xml(getzipdata(e,strip_front_slash(o.people[0])),t)),x&&(x=safe_parse_wbrels(x,u.Sheets));var A=getzipdata(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=p.Worksheets;++v){var I="sheet";if(x&&x[v]?(_="xl/"+x[v][1].replace(/[\/]?xl\//,""),safegetzipfile(e,_)||(_=x[v][1]),safegetzipfile(e,_)||(_=C.replace(/_rels\/[\S\s]*$/,"")+x[v][1]),I=x[v][2]):_=(_="xl/worksheets/sheet"+(v+1-A)+"."+S).replace(/sheet0\./,"sheet."),b=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(p.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var D=!1,k=0;k!=t.sheets.length;++k)"number"==typeof t.sheets[k]&&t.sheets[k]==v&&(D=1),"string"==typeof t.sheets[k]&&t.sheets[k].toLowerCase()==p.SheetNames[v].toLowerCase()&&(D=1);if(!D)continue e}}safe_parse_sheet(e,_,b,p.SheetNames[v],v,y,i,I,t,u,c,d)}return m={Directory:o,Workbook:u,Props:p,Custprops:f,Deps:g,Sheets:i,SheetNames:p.SheetNames,Strings:strs,Styles:d,Themes:c,SSF:dup(table_fmt)},t&&t.bookFiles&&(e.files?(m.keys=s,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach((function(t,r){t=t.replace(/^Root Entry[\/]/,""),m.keys.push(t),m.files[t]=e.FileIndex[r]})))),t&&t.bookVBA&&(o.vba.length>0?m.vbaraw=getzipdata(e,strip_front_slash(o.vba[0]),!0):o.defaults&&o.defaults.bin===CT_VBA&&(m.vbaraw=getzipdata(e,"xl/vbaProject.bin",!0))),m.bookType=l?"xlsb":"xlsx",m}function parse_xlsxcfb(e,t){var r=t||{},n="Workbook",i=CFB.find(e,n);try{if(n="/!DataSpaces/Version",!(i=CFB.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(parse_DataSpaceVersionInfo(i.content),n="/!DataSpaces/DataSpaceMap",!(i=CFB.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=parse_DataSpaceMap(i.content);if(1!==a.length||1!==a[0].comps.length||0!==a[0].comps[0].t||"StrongEncryptionDataSpace"!==a[0].name||"EncryptedPackage"!==a[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(i=CFB.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=parse_DataSpaceDefinition(i.content);if(1!=s.length||"StrongEncryptionTransform"!=s[0])throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(i=CFB.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);parse_Primary(i.content)}catch(e){}if(n="/EncryptionInfo",!(i=CFB.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=parse_EncryptionInfo(i.content);if(n="/EncryptedPackage",!(i=CFB.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(4==o[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(o[1],i.content,r.password||"",r);if(2==o[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function write_zip_xlsb(e,t){e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),t.revssf=evert_num(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,browser_has_Map?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="bin",n=new_ct();fix_write_opts(t=t||{});var i=zip_new(),a="",s=0;if(t.cellXfs=[],get_cell_style(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),zip_add_file(i,a="docProps/core.xml",write_core_props(e.Props,t)),n.coreprops.push(a),add_rels(t.rels,2,a,RELS.CORE_PROPS),a="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var o=[],l=0;l<e.SheetNames.length;++l)2!=(e.Workbook.Sheets[l]||{}).Hidden&&o.push(e.SheetNames[l]);e.Props.SheetNames=o}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,zip_add_file(i,a,write_ext_props(e.Props,t)),n.extprops.push(a),add_rels(t.rels,3,a,RELS.EXT_PROPS),e.Custprops!==e.Props&&keys(e.Custprops||{}).length>0&&(zip_add_file(i,a="docProps/custom.xml",write_cust_props(e.Custprops,t)),n.custprops.push(a),add_rels(t.rels,4,a,RELS.CUST_PROPS));var c=["SheetJ5"];for(t.tcid=0,s=1;s<=e.SheetNames.length;++s){var d={"!id":{}},u=e.Sheets[e.SheetNames[s-1]];if((u||{})["!type"],zip_add_file(i,a="xl/worksheets/sheet"+s+"."+r,write_ws_bin(s-1,t,e,d)),n.sheets.push(a),add_rels(t.wbrels,-1,"worksheets/sheet"+s+"."+r,RELS.WS[0]),u){var p=u["!comments"],h=!1,f="";if(p&&p.length>0){var m=!1;p.forEach((function(e){e[1].forEach((function(e){1==e.T&&(m=!0)}))})),m&&(zip_add_file(i,f="xl/threadedComments/threadedComment"+s+".xml",write_tcmnt_xml(p,c,t)),n.threadedcomments.push(f),add_rels(d,-1,"../threadedComments/threadedComment"+s+".xml",RELS.TCMNT)),zip_add_file(i,f="xl/comments"+s+"."+r,write_comments_bin(p,t)),n.comments.push(f),add_rels(d,-1,"../comments"+s+"."+r,RELS.CMNT),h=!0}u["!legacy"]&&h&&zip_add_file(i,"xl/drawings/vmlDrawing"+s+".vml",write_vml(s,u["!comments"])),delete u["!comments"],delete u["!legacy"]}d["!id"].rId1&&zip_add_file(i,get_rels_path(a),write_rels(d))}return null!=t.Strings&&t.Strings.length>0&&(zip_add_file(i,a="xl/sharedStrings."+r,write_sst_bin(t.Strings,t)),n.strs.push(a),add_rels(t.wbrels,-1,"sharedStrings."+r,RELS.SST)),zip_add_file(i,a="xl/workbook."+r,write_wb_bin(e,t)),n.workbooks.push(a),add_rels(t.rels,1,a,RELS.WB),zip_add_file(i,a="xl/theme/theme1.xml",write_theme(e.Themes,t)),n.themes.push(a),add_rels(t.wbrels,-1,"theme/theme1.xml",RELS.THEME),zip_add_file(i,a="xl/styles."+r,write_sty_bin(e,t)),n.styles.push(a),add_rels(t.wbrels,-1,"styles."+r,RELS.STY),e.vbaraw&&(zip_add_file(i,a="xl/vbaProject.bin",e.vbaraw),n.vba.push(a),add_rels(t.wbrels,-1,"vbaProject.bin",RELS.VBA)),zip_add_file(i,a="xl/metadata."+r,write_xlmeta_bin()),n.metadata.push(a),add_rels(t.wbrels,-1,"metadata."+r,RELS.XLMETA),c.length>1&&(zip_add_file(i,a="xl/persons/person.xml",write_people_xml(c,t)),n.people.push(a),add_rels(t.wbrels,-1,"persons/person.xml",RELS.PEOPLE)),zip_add_file(i,"[Content_Types].xml",write_ct(n,t)),zip_add_file(i,"_rels/.rels",write_rels(t.rels)),zip_add_file(i,"xl/_rels/workbook.bin.rels",write_rels(t.wbrels)),delete t.revssf,delete t.ssf,i}function write_zip_xlsx(e,t){e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),t.revssf=evert_num(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,browser_has_Map?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=VBAFMTS.indexOf(t.bookType)>-1,i=new_ct();fix_write_opts(t=t||{});var a=zip_new(),s="",o=0;if(t.cellXfs=[],get_cell_style(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),zip_add_file(a,s="docProps/core.xml",write_core_props(e.Props,t)),i.coreprops.push(s),add_rels(t.rels,2,s,RELS.CORE_PROPS),s="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,zip_add_file(a,s,write_ext_props(e.Props,t)),i.extprops.push(s),add_rels(t.rels,3,s,RELS.EXT_PROPS),e.Custprops!==e.Props&&keys(e.Custprops||{}).length>0&&(zip_add_file(a,s="docProps/custom.xml",write_cust_props(e.Custprops,t)),i.custprops.push(s),add_rels(t.rels,4,s,RELS.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},p=e.Sheets[e.SheetNames[o-1]];if((p||{})["!type"],zip_add_file(a,s="xl/worksheets/sheet"+o+"."+r,write_ws_xml(o-1,t,e,u)),i.sheets.push(s),add_rels(t.wbrels,-1,"worksheets/sheet"+o+"."+r,RELS.WS[0]),p){var h=p["!comments"],f=!1,m="";if(h&&h.length>0){var g=!1;h.forEach((function(e){e[1].forEach((function(e){1==e.T&&(g=!0)}))})),g&&(zip_add_file(a,m="xl/threadedComments/threadedComment"+o+".xml",write_tcmnt_xml(h,d,t)),i.threadedcomments.push(m),add_rels(u,-1,"../threadedComments/threadedComment"+o+".xml",RELS.TCMNT)),zip_add_file(a,m="xl/comments"+o+"."+r,write_comments_xml(h,t)),i.comments.push(m),add_rels(u,-1,"../comments"+o+"."+r,RELS.CMNT),f=!0}p["!legacy"]&&f&&zip_add_file(a,"xl/drawings/vmlDrawing"+o+".vml",write_vml(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}u["!id"].rId1&&zip_add_file(a,get_rels_path(s),write_rels(u))}return null!=t.Strings&&t.Strings.length>0&&(zip_add_file(a,s="xl/sharedStrings."+r,write_sst_xml(t.Strings,t)),i.strs.push(s),add_rels(t.wbrels,-1,"sharedStrings."+r,RELS.SST)),zip_add_file(a,s="xl/workbook."+r,write_wb_xml(e,t)),i.workbooks.push(s),add_rels(t.rels,1,s,RELS.WB),zip_add_file(a,s="xl/theme/theme1.xml",write_theme(e.Themes,t)),i.themes.push(s),add_rels(t.wbrels,-1,"theme/theme1.xml",RELS.THEME),zip_add_file(a,s="xl/styles."+r,write_sty_xml(e,t)),i.styles.push(s),add_rels(t.wbrels,-1,"styles."+r,RELS.STY),e.vbaraw&&n&&(zip_add_file(a,s="xl/vbaProject.bin",e.vbaraw),i.vba.push(s),add_rels(t.wbrels,-1,"vbaProject.bin",RELS.VBA)),zip_add_file(a,s="xl/metadata."+r,write_xlmeta_xml()),i.metadata.push(s),add_rels(t.wbrels,-1,"metadata."+r,RELS.XLMETA),d.length>1&&(zip_add_file(a,s="xl/persons/person.xml",write_people_xml(d,t)),i.people.push(s),add_rels(t.wbrels,-1,"persons/person.xml",RELS.PEOPLE)),zip_add_file(a,"[Content_Types].xml",write_ct(i,t)),zip_add_file(a,"_rels/.rels",write_rels(t.rels)),zip_add_file(a,"xl/_rels/workbook.xml.rels",write_rels(t.wbrels)),delete t.revssf,delete t.ssf,a}function firstbyte(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Base64_decode(e.slice(0,12));break;case"binary":r=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function read_cfb(e,t){return CFB.find(e,"EncryptedPackage")?parse_xlsxcfb(e,t):parse_xlscfb(e,t)}function read_zip(e,t){var r=e,n=t||{};return n.type||(n.type=has_buf&&Buffer.isBuffer(e)?"buffer":"base64"),parse_zip(zip_read(r,n),n)}function read_plaintext(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return parse_xlml(e.slice(r),t);default:break e}return PRN.to_workbook(e,t)}function read_plaintext_raw(e,t){var r="",n=firstbyte(e,t);switch(t.type){case"base64":r=Base64_decode(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=cc2str(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]&&(r=utf8read(r)),t.type="binary",read_plaintext(r,t)}function read_utf16(e,t){var r=e;return"base64"==t.type&&(r=Base64_decode(r)),"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer&&(r=new Uint8Array(e)),r=void 0!==$cptable?$cptable.utils.decode(1200,r.slice(2),"str"):has_buf&&Buffer.isBuffer(e)?e.slice(2).toString("utf16le"):"undefined"!=typeof Uint8Array&&r instanceof Uint8Array?"undefined"!=typeof TextDecoder?new TextDecoder("utf-16le").decode(r.slice(2)):utf16lereadu(r.slice(2)):utf16leread(r.slice(2)),t.type="binary",read_plaintext(r,t)}function bstrify(e){return e.match(/[^\x00-\x7F]/)?utf8write(e):e}function read_prn(e,t,r,n){return n?(r.type="string",PRN.to_workbook(e,r)):PRN.to_workbook(t,r)}function readSync(e,t){reset_cp();var r=t||{};if(r.codepage&&void 0===$cptable&&console.error("Codepage tables are not loaded.  Non-ASCII characters may not give expected results"),"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return readSync(new Uint8Array(e),((r=dup(r)).type="array",r));if("undefined"!=typeof Int8Array&&e instanceof Int8Array)return readSync(new Uint8Array(e.buffer,e.byteOffset,e.length),r);"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&!r.type&&(r.type="undefined"!=typeof Deno?"buffer":"array");var n,i=e,a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),_ssfopts={},r.dateNF&&(_ssfopts.dateNF=r.dateNF),r.type||(r.type=has_buf&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==r.type&&(r.type=has_buf?"buffer":"binary",i=read_binary(e),"undefined"==typeof Uint8Array||has_buf||(r.type="array")),"string"==r.type&&(a=!0,r.type="binary",r.codepage=65001,i=bstrify(e)),"array"==r.type&&"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return(r=dup(r)).type="array",readSync(ab2a(i),r)}switch((n=firstbyte(i,r))[0]){case 208:if(207===n[1]&&17===n[2]&&224===n[3]&&161===n[4]&&177===n[5]&&26===n[6]&&225===n[7])return read_cfb(CFB.read(i,r),r);break;case 9:if(n[1]<=8)return parse_xlscfb(i,r);break;case 60:return parse_xlml(i,r);case 73:if(73===n[1]&&42===n[2]&&0===n[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===n[1])return read_wb_ID(i,r);break;case 84:if(65===n[1]&&66===n[2]&&76===n[3])return DIF.to_workbook(i,r);break;case 80:return 75===n[1]&&n[2]<9&&n[3]<9?read_zip(i,r):read_prn(e,i,r,a);case 239:return 60===n[3]?parse_xlml(i,r):read_prn(e,i,r,a);case 255:if(254===n[1])return read_utf16(i,r);if(0===n[1]&&2===n[2]&&0===n[3])return WK_.to_workbook(i,r);break;case 0:if(0===n[1]){if(n[2]>=2&&0===n[3])return WK_.to_workbook(i,r);if(0===n[2]&&(8===n[3]||9===n[3]))return WK_.to_workbook(i,r)}break;case 3:case 131:case 139:case 140:return DBF.to_workbook(i,r);case 123:if(92===n[1]&&114===n[2]&&116===n[3])return rtf_to_workbook(i,r);break;case 10:case 13:case 32:return read_plaintext_raw(i,r);case 137:if(80===n[1]&&78===n[2]&&71===n[3])throw new Error("PNG Image File is not a spreadsheet");break;case 8:if(231===n[1])throw new Error("Unsupported Multiplan 1.x file!");break;case 12:if(236===n[1])throw new Error("Unsupported Multiplan 2.x file!");if(237===n[1])throw new Error("Unsupported Multiplan 3.x file!")}return DBF_SUPPORTED_VERSIONS.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?DBF.to_workbook(i,r):read_prn(e,i,r,a)}function readFileSync(e,t){var r=t||{};return r.type="file",readSync(e,r)}function write_cfb_ctr(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return write_dl(t.file,CFB.write(e,{type:has_buf?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return CFB.write(e,t)}function write_zip(e,t){switch(t.bookType){case"ods":return write_ods(e,t);case"numbers":return write_numbers_iwa(e,t);case"xlsb":return write_zip_xlsb(e,t);default:return write_zip_xlsx(e,t)}}function write_zip_type(e,t){var r=dup(t||{});return write_zip_denouement(write_zip(e,r),r)}function write_zip_typeXLSX(e,t){var r=dup(t||{});return write_zip_denouement(write_zip_xlsx(e,r),r)}function write_zip_denouement(e,t){var r={},n=has_buf?"nodebuffer":"undefined"!=typeof Uint8Array?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?CFB.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if("undefined"!=typeof Deno&&"string"==typeof i){if("binary"==t.type||"base64"==t.type)return i;i=new Uint8Array(s2ab(i))}return t.password&&"undefined"!=typeof encrypt_agile?write_cfb_ctr(encrypt_agile(i,t.password),t):"file"===t.type?write_dl(t.file,i):"string"==t.type?utf8read(i):i}function write_cfb_type(e,t){var r=t||{};return write_cfb_ctr(write_xlscfb(e,r),r)}function write_string_type(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Base64_encode(utf8write(n));case"binary":return utf8write(n);case"string":return e;case"file":return write_dl(t.file,n,"utf8");case"buffer":return has_buf?Buffer_from(n,"utf8"):"undefined"!=typeof TextEncoder?(new TextEncoder).encode(n):write_string_type(n,{type:"binary"}).split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+t.type)}function write_stxt_type(e,t){switch(t.type){case"base64":return Base64_encode_pass(e);case"binary":case"string":return e;case"file":return write_dl(t.file,e,"binary");case"buffer":return has_buf?Buffer_from(e,"binary"):e.split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+t.type)}function write_binary_type(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return"base64"==t.type?Base64_encode(r):"string"==t.type?utf8read(r):r;case"file":return write_dl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function writeSyncXLSX(e,t){reset_cp(),check_wb(e);var r=dup(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),"array"==r.type){r.type="binary";var n=writeSyncXLSX(e,r);return r.type="array",s2ab(n)}return write_zip_typeXLSX(e,r)}function writeSync(e,t){reset_cp(),check_wb(e);var r=dup(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),"array"==r.type){r.type="binary";var n=writeSync(e,r);return r.type="array",s2ab(n)}var i=0;if(r.sheet&&(i="number"==typeof r.sheet?r.sheet:e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return write_string_type(write_xlml(e,r),r);case"slk":case"sylk":return write_string_type(SYLK.from_sheet(e.Sheets[e.SheetNames[i]],r,e),r);case"htm":case"html":return write_string_type(sheet_to_html(e.Sheets[e.SheetNames[i]],r),r);case"txt":return write_stxt_type(sheet_to_txt(e.Sheets[e.SheetNames[i]],r),r);case"csv":return write_string_type(sheet_to_csv(e.Sheets[e.SheetNames[i]],r),r,"\ufeff");case"dif":return write_string_type(DIF.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return write_binary_type(DBF.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return write_string_type(PRN.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return write_string_type(sheet_to_rtf(e.Sheets[e.SheetNames[i]],r),r);case"eth":return write_string_type(ETH.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return write_string_type(write_ods(e,r),r);case"wk1":return write_binary_type(WK_.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return write_binary_type(WK_.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),write_binary_type(write_biff_buf(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),write_cfb_type(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return write_zip_type(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function resolve_book_type(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function writeFileSync(e,t,r){var n=r||{};return n.type="file",n.file=t,resolve_book_type(n),writeSync(e,n)}function writeFileSyncXLSX(e,t,r){var n=r||{};return n.type="file",n.file=t,resolve_book_type(n),writeSyncXLSX(e,n)}function writeFileAsync(e,t,r,n){var i=r||{};i.type="file",i.file=e,resolve_book_type(i),i.type="buffer";var a=n;return a instanceof Function||(a=r),_fs.writeFile(e,writeSync(t,i),a)}function make_json_row(e,t,r,n,i,a,s){var o=encode_row(r),l=s.defval,c=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),d=!0,u=null!=e["!data"],p=1===i?[]:{};if(1!==i)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch(e){p.__rowNum__=r}else p.__rowNum__=r;if(!u||e["!data"][r])for(var h=t.s.c;h<=t.e.c;++h){var f=u?(e["!data"][r]||[])[h]:e[n[h]+o];if(null!=f&&void 0!==f.t){var m=f.v;switch(f.t){case"z":if(null==m)break;continue;case"e":m=0==m?null:void 0;break;case"s":case"b":case"n":if(!f.z||!fmt_is_date(f.z))break;if("number"==typeof(m=numdate(m)))break;case"d":s&&(s.UTC||!1===s.raw)||(m=utc_to_local(new Date(m)));break;default:throw new Error("unrecognized type "+f.t)}if(null!=a[h]){if(null==m)if("e"==f.t&&null===m)p[a[h]]=null;else if(void 0!==l)p[a[h]]=l;else{if(!c||null!==m)continue;p[a[h]]=null}else p[a[h]]=("n"===f.t&&"boolean"==typeof s.rawNumbers?s.rawNumbers:c)?m:format_cell(f,m,s);null!=m&&(d=!1)}}else{if(void 0===l)continue;null!=a[h]&&(p[a[h]]=l)}}return{row:p,isempty:d}}function sheet_to_json(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},n=0,i=1,a=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=null!=c.range?c.range:e["!ref"];switch(1===c.header?n=1:"A"===c.header?n=2:Array.isArray(c.header)?n=3:null==c.header&&(n=0),typeof d){case"string":l=safe_decode_range(d);break;case"number":(l=safe_decode_range(e["!ref"])).s.r=d;break;default:l=d}n>0&&(i=0);var u=encode_row(l.s.r),p=[],h=[],f=0,m=0,g=null!=e["!data"],_=l.s.r,b=0,v={};g&&!e["!data"][_]&&(e["!data"][_]=[]);var y=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(y[b]||{}).hidden)switch(p[b]=encode_col(b),r=g?e["!data"][_][b]:e[p[b]+u],n){case 1:a[b]=b-l.s.c;break;case 2:a[b]=p[b];break;case 3:a[b]=c.header[b-l.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),o=s=format_cell(r,null,c),m=v[s]||0){do{o=s+"_"+m++}while(v[o]);v[s]=m,v[o]=1}else v[s]=1;a[b]=o}for(_=l.s.r+i;_<=l.e.r;++_)if(!(w[_]||{}).hidden){var E=make_json_row(e,l,_,p,n,a,c);(!1===E.isempty||(1===n?!1!==c.blankrows:c.blankrows))&&(h[f++]=E.row)}return h.length=f,h}var qreg=/"/g;function make_csv_row(e,t,r,n,i,a,s,o,l){for(var c=!0,d=[],u="",p=encode_row(r),h=null!=e["!data"],f=h&&e["!data"][r]||[],m=t.s.c;m<=t.e.c;++m)if(n[m]){var g=h?f[m]:e[n[m]+p];if(null==g)u="";else if(null!=g.v){c=!1,u=""+(l.rawNumbers&&"n"==g.t?g.v:format_cell(g,null,l));for(var _=0,b=0;_!==u.length;++_)if((b=u.charCodeAt(_))===i||b===a||34===b||l.forceQuotes){u='"'+u.replace(qreg,'""')+'"';break}"ID"==u&&0==o&&0==d.length&&(u='"ID"')}else null==g.f||g.F?u="":(c=!1,(u="="+g.f).indexOf(",")>=0&&(u='"'+u.replace(qreg,'""')+'"'));d.push(u)}if(l.strip)for(;""===d[d.length-1];)--d.length;return!1===l.blankrows&&c?null:d.join(s)}function sheet_to_csv(e,t){var r=[],n=null==t?{}:t;if(null==e||null==e["!ref"])return"";for(var i=safe_decode_range(e["!ref"]),a=void 0!==n.FS?n.FS:",",s=a.charCodeAt(0),o=void 0!==n.RS?n.RS:"\n",l=o.charCodeAt(0),c="",d=[],u=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],h=i.s.c;h<=i.e.c;++h)(u[h]||{}).hidden||(d[h]=encode_col(h));for(var f=0,m=i.s.r;m<=i.e.r;++m)(p[m]||{}).hidden||null!=(c=make_csv_row(e,i,m,d,s,l,a,f,n))&&(c||!1!==n.blankrows)&&r.push((f++?o:"")+c);return r.join("")}function sheet_to_txt(e,t){t||(t={}),t.FS="\t",t.RS="\n";var r=sheet_to_csv(e,t);if(void 0===$cptable||"string"==t.type)return r;var n=$cptable.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+n}function sheet_to_formulae(e,t){var r,n="",i="";if(null==e||null==e["!ref"])return[];var a,s=safe_decode_range(e["!ref"]),o="",l=[],c=[],d=null!=e["!data"];for(a=s.s.c;a<=s.e.c;++a)l[a]=encode_col(a);for(var u=s.s.r;u<=s.e.r;++u)for(o=encode_row(u),a=s.s.c;a<=s.e.c;++a)if(n=l[a]+o,i="",void 0!==(r=d?(e["!data"][u]||[])[a]:e[n])){if(null!=r.F){if(n=r.F,!r.f)continue;i=r.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=r.f)i=r.f;else{if(t&&!1===t.values)continue;if("z"==r.t)continue;if("n"==r.t&&null!=r.v)i=""+r.v;else if("b"==r.t)i=r.v?"TRUE":"FALSE";else if(void 0!==r.w)i="'"+r.w;else{if(void 0===r.v)continue;i="s"==r.t?"'"+r.v:""+r.v}}c[c.length]=n+"="+i}return c}function sheet_add_json(e,t,r){var n=r||{},i=e?null!=e["!data"]:n.dense;null!=DENSE&&null==i&&(i=DENSE);var a=+!n.skipHeader,s=e||{};!e&&i&&(s["!data"]=[]);var o=0,l=0;if(s&&null!=n.origin)if("number"==typeof n.origin)o=n.origin;else{var c="string"==typeof n.origin?decode_cell(n.origin):n.origin;o=c.r,l=c.c}var d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+a}};if(s["!ref"]){var u=safe_decode_range(s["!ref"]);d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),-1==o&&(o=u.e.r+1,d.e.r=o+t.length-1+a)}else-1==o&&(o=0,d.e.r=t.length-1+a);var p=n.header||[],h=0,f=[];t.forEach((function(e,t){i&&!s["!data"][o+t+a]&&(s["!data"][o+t+a]=[]),i&&(f=s["!data"][o+t+a]),keys(e).forEach((function(r){-1==(h=p.indexOf(r))&&(p[h=p.length]=r);var c=e[r],d="z",u="",m=i?"":encode_col(l+h)+encode_row(o+t+a),g=i?f[l+h]:s[m];!c||"object"!=typeof c||c instanceof Date?("number"==typeof c?d="n":"boolean"==typeof c?d="b":"string"==typeof c?d="s":c instanceof Date?(d="d",n.UTC||(c=local_to_utc(c)),n.cellDates||(d="n",c=datenum(c)),u=null!=g&&g.z&&fmt_is_date(g.z)?g.z:n.dateNF||table_fmt[14]):null===c&&n.nullError&&(d="e",c=0),g?(g.t=d,g.v=c,delete g.w,delete g.R,u&&(g.z=u)):i?f[l+h]=g={t:d,v:c}:s[m]=g={t:d,v:c},u&&(g.z=u)):i?f[l+h]=c:s[m]=c}))})),d.e.c=Math.max(d.e.c,l+p.length-1);var m=encode_row(o);if(i&&!s["!data"][o]&&(s["!data"][o]=[]),a)for(h=0;h<p.length;++h)i?s["!data"][o][h+l]={t:"s",v:p[h]}:s[encode_col(h+l)+m]={t:"s",v:p[h]};return s["!ref"]=encode_range(d),s}function json_to_sheet(e,t){return sheet_add_json(null,e,t)}function ws_get_cell_stub(e,t,r){if("string"==typeof t){if(null!=e["!data"]){var n=decode_cell(t);return e["!data"][n.r]||(e["!data"][n.r]=[]),e["!data"][n.r][n.c]||(e["!data"][n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return ws_get_cell_stub(e,"number"!=typeof t?encode_cell(t):encode_col(r||0)+encode_row(t))}function wb_sheet_idx(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}function book_new(e,t){var r={SheetNames:[],Sheets:{}};return e&&book_append_sheet(r,e,t||"Sheet1"),r}function book_append_sheet(e,t,r,n){var i=1;if(!r)for(;i<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+i);++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0&&r.length<32){var a=r.match(/\d+$/);i=a&&+a[0]||0;var s=a&&r.slice(0,a.index)||r;for(++i;i<=65535&&-1!=e.SheetNames.indexOf(r=s+i);++i);}if(check_ws_name(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function book_set_sheet_visibility(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=wb_sheet_idx(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function cell_set_number_format(e,t){return e.z=t,e}function cell_set_hyperlink(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function cell_set_internal_link(e,t,r){return cell_set_hyperlink(e,"#"+t,r)}function cell_add_comment(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function sheet_set_array_formula(e,t,r,n){for(var i="string"!=typeof t?t:safe_decode_range(t),a="string"==typeof t?t:encode_range(t),s=i.s.r;s<=i.e.r;++s)for(var o=i.s.c;o<=i.e.c;++o){var l=ws_get_cell_stub(e,s,o);l.t="n",l.F=a,delete l.v,s==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}var c=decode_range(e["!ref"]);return c.s.r>i.s.r&&(c.s.r=i.s.r),c.s.c>i.s.c&&(c.s.c=i.s.c),c.e.r<i.e.r&&(c.e.r=i.e.r),c.e.c<i.e.c&&(c.e.c=i.e.c),e["!ref"]=encode_range(c),e}var utils={encode_col,encode_row,encode_cell,encode_range,decode_col,decode_row,split_cell,decode_cell,decode_range,format_cell,sheet_new,sheet_add_aoa,sheet_add_json,sheet_add_dom,aoa_to_sheet,json_to_sheet,table_to_sheet:parse_dom_table,table_to_book,sheet_to_csv,sheet_to_txt,sheet_to_json,sheet_to_html,sheet_to_formulae,sheet_to_row_object_array:sheet_to_json,sheet_get_cell:ws_get_cell_stub,book_new,book_append_sheet,book_set_sheet_visibility,cell_set_number_format,cell_set_hyperlink,cell_set_internal_link,cell_add_comment,sheet_set_array_formula,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},_Readable;function set_readable(e){_Readable=e}function write_csv_stream(e,t){var r=_Readable(),n=null==t?{}:t;if(null==e||null==e["!ref"])return r.push(null),r;for(var i=safe_decode_range(e["!ref"]),a=void 0!==n.FS?n.FS:",",s=a.charCodeAt(0),o=void 0!==n.RS?n.RS:"\n",l=o.charCodeAt(0),c="",d=[],u=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],h=i.s.c;h<=i.e.c;++h)(u[h]||{}).hidden||(d[h]=encode_col(h));var f=i.s.r,m=!1,g=0;return r._read=function(){if(!m)return m=!0,r.push("\ufeff");for(;f<=i.e.r;)if(++f,!(p[f-1]||{}).hidden&&null!=(c=make_csv_row(e,i,f-1,d,s,l,a,g,n))&&(c||!1!==n.blankrows))return r.push((g++?o:"")+c);return r.push(null)},r}function write_html_stream(e,t){var r=_Readable(),n=t||{},i=null!=n.header?n.header:HTML_BEGIN,a=null!=n.footer?n.footer:HTML_END;r.push(i);var s=decode_range(e["!ref"]);r.push(make_html_preamble(e,s,n));var o=s.s.r,l=!1;return r._read=function(){if(o>s.e.r)return l||(l=!0,r.push("</table>"+a)),r.push(null);for(;o<=s.e.r;){r.push(make_html_row(e,s,o,n)),++o;break}},r}function write_json_stream(e,t){var r=_Readable({objectMode:!0});if(null==e||null==e["!ref"])return r.push(null),r;var n={t:"n",v:0},i=0,a=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},u=null!=d.range?d.range:e["!ref"];switch(1===d.header?i=1:"A"===d.header?i=2:Array.isArray(d.header)&&(i=3),typeof u){case"string":c=safe_decode_range(u);break;case"number":(c=safe_decode_range(e["!ref"])).s.r=u;break;default:c=u}i>0&&(a=0);var p=encode_row(c.s.r),h=[],f=0,m=null!=e["!data"],g=c.s.r,_=0,b={};m&&!e["!data"][g]&&(e["!data"][g]=[]);var v=d.skipHidden&&e["!cols"]||[],y=d.skipHidden&&e["!rows"]||[];for(_=c.s.c;_<=c.e.c;++_)if(!(v[_]||{}).hidden)switch(h[_]=encode_col(_),n=m?e["!data"][g][_]:e[h[_]+p],i){case 1:s[_]=_-c.s.c;break;case 2:s[_]=h[_];break;case 3:s[_]=d.header[_-c.s.c];break;default:if(null==n&&(n={w:"__EMPTY",t:"s"}),l=o=format_cell(n,null,d),f=b[o]||0){do{l=o+"_"+f++}while(b[l]);b[o]=f,b[l]=1}else b[o]=1;s[_]=l}return g=c.s.r+a,r._read=function(){for(;g<=c.e.r;)if(!(y[g-1]||{}).hidden){var t=make_json_row(e,c,g,h,i,s,d);if(++g,!1===t.isempty||(1===i?!1!==d.blankrows:d.blankrows))return void r.push(t.row)}return r.push(null)},r}function write_xlml_stream(e,t){var r=_Readable(),n=null==t?{}:t,i=+n.stride||10;e.SSF||(e.SSF=dup(table_fmt)),e.SSF&&(make_ssf(),SSF_load_table(e.SSF),n.revssf=evert_num(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF,n.cellXfs=[],get_cell_style(n.cellXfs,{},{revssf:{General:0}})),e.SheetNames.forEach((function(t){var r=e.Sheets[t];if(r&&r["!ref"])for(var i=decode_range(r["!ref"]),a=null!=r["!data"],s=a?r["!data"]:[],o={r:0,c:0},l=i.s.r;l<=i.e.r;++l)if(o.r=l,!a||s[l])for(var c=i.s.c;c<=i.e.c;++c){o.c=c;var d=a?s[l][c]:r[encode_col(c)+encode_row(l)];d&&("d"==d.t&&null==d.z&&((d=dup(d)).z=table_fmt[14]),get_cell_style(n.cellXfs,d,n))}}));var a=write_sty_xlml(e,n),s=0,o=0,l=e.Sheets[e.SheetNames[o]],c=safe_decode_range(l),d=-1,u=!1,p=[],h=0,f=!1,m=[],g={r:0,c:0};return r._read=function(){switch(s){case 0:s=1,r.push(XML_HEADER),r.push("<Workbook"+wxt_helper({xmlns:XLMLNS.ss,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:ss":XLMLNS.ss,"xmlns:dt":XLMLNS.dt,"xmlns:html":XLMLNS.html})+">");break;case 1:s=2,r.push(write_props_xlml(e,n)),r.push(write_wb_xlml(e,n));break;case 2:s=3,r.push(a),r.push(write_names_xlml(e,n));break;case 3:if(u=!1,o>=e.SheetNames.length){s=-1,r.push("");break}if(r.push("<Worksheet"+wxt_helper({"ss:Name":escapexml(e.SheetNames[o])})+">"),!(l=e.Sheets[e.SheetNames[o]]))return r.push("</Worksheet>"),void++o;var t=write_ws_xlml_names(l,n,o,e);if(t.length&&r.push("<Names>"+t+"</Names>"),!l["!ref"])return s=5;c=safe_decode_range(l["!ref"]),d=c.s.r,s=4;break;case 4:if(d<0||d>c.e.r)return u&&r.push("</Table>"),void(s=5);d<=c.s.r&&(l["!cols"]&&l["!cols"].forEach((function(e,t){process_col(e);var n=!!e.width,i=col_obj_w(t,e),a={"ss:Index":t+1};n&&(a["ss:Width"]=width2px(i.width)),e.hidden&&(a["ss:Hidden"]="1"),u||(u=!0,r.push("<Table>")),r.push(writextag("Column",null,a))})),(f=null!=l["!data"])&&(m=l["!data"]),g.r=g.c=0);for(var _=0;d<=c.e.r&&_<i;++d,++_){var b=[write_ws_xlml_row(d,(l["!rows"]||[])[d])];if(g.r=d,!f||m[d])for(var v=c.s.c;v<=c.e.c;++v){g.c=v;var y=!1;for(h=0;h!=p.length;++h)if(!(p[h].s.c>v||p[h].s.r>d||p[h].e.c<v||p[h].e.r<d)){p[h].s.c==v&&p[h].s.r==d||(y=!0);break}if(!y){var w=encode_col(v)+encode_row(d),E=f?m[d][v]:l[w];b.push(write_ws_xlml_cell(E,w,l,n,o,e,g))}}b.push("</Row>"),u||(u=!0,r.push("<Table>")),r.push(b.join(""))}break;case 5:return r.push(write_ws_xlml_wsopts(l,n,o,e)),l&&l["!autofilter"]&&r.push('<AutoFilter x:Range="'+a1_to_rc(fix_range(l["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),r.push("</Worksheet>"),o++,d=-1,void(s=3);case-1:s=-2,r.push("</Workbook>");break;case-2:r.push(null)}},r}var __stream={to_json:write_json_stream,to_html:write_html_stream,to_csv:write_csv_stream,to_xlml:write_xlml_stream,set_readable};const xlsx_version=XLSX.version,xlsx={parse_xlscfb,parse_zip,read:readSync,readFile:readFileSync,readFileSync,write:writeSync,writeFile:writeFileSync,writeFileSync,writeFileAsync,writeXLSX:writeSyncXLSX,writeFileXLSX:writeFileSyncXLSX,utils,set_fs,set_cptable,stream:__stream,SSF,CFB};function dynamicContent_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function dynamicContent_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?dynamicContent_ownKeys(Object(r),!0).forEach((function(t){dynamicContent_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dynamicContent_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function dynamicContent_defineProperty(e,t,r){return(t=dynamicContent_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dynamicContent_toPropertyKey(e){var t=dynamicContent_toPrimitive(e,"string");return"symbol"==dynamicContent_typeof(t)?t:t+""}function dynamicContent_toPrimitive(e,t){if("object"!=dynamicContent_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=dynamicContent_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function dynamicContent_typeof(e){return dynamicContent_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dynamicContent_typeof(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||dynamicContent_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,s,o=[],l=!0,c=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function dynamicContent_createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=dynamicContent_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw a}}}}function dynamicContent_unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return dynamicContent_arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dynamicContent_arrayLikeToArray(e,t):void 0}}function dynamicContent_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var dynamicContent_state={activeObservers:new Set,currentData:[],dataTable:null,defaultData:[["var_1","var_2","var_3"],["sample1","sample2","sample3"],["","",""],["","",""]],elements:{},logPrefix:"LT Dynamic Content: ",options:{labels:{btnContinue:"Confirm",csvUploadHelp:"Add dynamic data to your item by typing directly into the table below. Or, import a file\n            (csv, xls, xlsx, ods, and txt are supported).",headerValidationHelp:"The header row must contain only lowercase letters, numbers, and underscores.\n            Supports a maximum of 20 columns and 50 rows."}},renderedCss:!1,useElementCache:!1};function dynamicContent_run(e){dynamicContent_state.options=dynamicContent_validateOptions(e),dynamicContent_state.renderedCss||dynamicContent_injectCSS(),document.querySelector(".lrn-author").classList.add("lt__dynamicContent"),window.XLSX=xlsx_namespaceObject,core_app.appInstance().on("navigate",(function(){setTimeout((function(){["items/:reference/settings/:tab",void 0].includes(core_app.appInstance().getLocation().route)&&"data-table"===core_app.appInstance().getLocation().location.split("/").pop()&&(setObserver(".lrn-author-datatable-editor",dynamicContent_setup,{dispatchEvent:!1,root:getElement('[data-tab-content="data-table"]'),state:dynamicContent_state}),setObserver(".lrn-author-datatable-preview",actionContinue,{dispatchEvent:!1,root:getElement('[data-tab-content="data-table"]'),state:dynamicContent_state}))}),150),core_app.appInstance().on("render:item",(function(){dynamicContent_state.currentData=[],dynamicContent_state.dataTable=null,dynamicContent_state.elements={}}))}))}function dynamicContent_setup(){var e=getElement(".lrn-author-datatable-source"),t=getElement(".lrn-author-datatable-header"),r=getElement('[data-authorapi-selector="datatable-source-continue"]');if(setObserver("#dynamic-content-table",(function(){}),{dispatchEvent:!0,name:"lt:datatable:editor",root:getElement('[data-tab-content="data-table"]'),state:dynamicContent_state}),e){if(!getElement("#dynamic-content-table")){var n=document.querySelector(".CodeMirror").CodeMirror.getDoc().getValue(),i=getTableTemplate();if(r.textContent=dynamicContent_state.options.labels.btnContinue,t.insertAdjacentHTML("afterend",i),dynamicContent_state.options.labels.csvUploadHelp.length){var a=document.createElement("p");a.className="lt-dynamic-content-help-text",a.textContent=dynamicContent_state.options.labels.csvUploadHelp,t.appendChild(a)}if(dynamicContent_state.options.labels.headerValidationHelp.length){var s=document.createElement("p");s.className="lrn-author-message lrn-author-message-small lrn-author-message-info",s.textContent=dynamicContent_state.options.labels.headerValidationHelp,t.appendChild(s)}n.length&&(dynamicContent_state.currentData=papaparse_min_default().parse(n.trim()).data)}var o=getElement("#dynamic-content-table");if(o){var l=dynamicContent_state.currentData.length?dynamicContent_state.currentData:dynamicContent_state.defaultData,c=lodash_es_debounce(updateAPIDataTable,200),d=lodash_es_debounce(checkHeader,200);dynamicContent_state.dataTable=o,dynamicContent_state.dataTable.updateData(l),dynamicContent_state.dataTable.onDataUpdate=function(e){c(e),d(e)},r.addEventListener("click",actionContinue)}else utils_logger.A.error("".concat(dynamicContent_state.logPrefix,"Dynamic table element not found"))}else utils_logger.A.error("".concat(dynamicContent_state.logPrefix,"Data element not found"))}function updateAPIDataTable(e){var t=papaparse_min_default().unparse(e,{delimiter:",",escapeChar:'"',header:!0,newline:"\r\n",quotes:!0,quoteChar:'"',skipEmptyLines:"greedy"});document.querySelector(".CodeMirror").CodeMirror.getDoc().setValue(t),dynamicContent_state.currentData=e}function checkHeader(e){if(Array.isArray(e)&&e.length){var t,r=dynamicContent_createForOfIteratorHelper(e[0].entries());try{for(r.s();!(t=r.n()).done;){var n=_slicedToArray(t.value,2),i=n[0],a=n[1];if(!/^[a-z0-9 _]+$/.test(a))try{dynamicContent_state.dataTable.updateCell({newText:a.replace(/-/g,"_").replace(/[^a-zA-Z0-9 _]/g,"").toLowerCase(),rowIndex:0,columnIndex:i})}catch(e){"Cannot read properties of undefined (reading 'settings')"!==e.message&&utils_logger.A.error("".concat(dynamicContent_state.logPrefix,"Error updating header cell: ").concat(e))}}}catch(e){r.e(e)}finally{r.f()}}}function actionContinue(){var e=getElement(".lrn-author-datatable-header");e.querySelector(".lrn-author-form-label-name").textContent=dynamicContent_state.options.labels.headerLabel,setTimeout((function(){var t=getElement('[data-authorapi-selector="datatable-preview-edit"]');t?t.addEventListener("click",(function(){setTimeout((function(){e.classList.add("hidden"),dynamicContent_setup()}),300)})):utils_logger.A.error("".concat(dynamicContent_state.logPrefix,"Edit button not found"));var r=getElement('[data-authorapi-selector="datatable-preview-reset"]');r.addEventListener("click",(function(){r.classList.contains("lrn-author-btn-confirm-active")&&setTimeout((function(){dynamicContent_state.currentData=[],dynamicContent_setup()}),200)}))}),300)}function getElement(e){if(dynamicContent_state.useElementCache&&dynamicContent_state.elements[e])return dynamicContent_state.elements[e];var t=document.querySelector(e);return t&&(dynamicContent_state.elements[e]=t),t}function getTableTemplate(){var e=document.querySelector(".lrn-author-item-settings-container").offsetHeight-230||300;return'<active-table\n        id=\'dynamic-content-table\'\n        allowduplicateheaders=\'false\'\n        availableDefaultColumnTypes=\'[]\'\n        customColumnTypes=\'[\n            {\n                "name": "api-column",\n                "customTextProcessing": {\n                    "changeTextFunc": "(cellText) => cellText.replace(/^\\"(.*)\\"$/, \\"$1\\")"\n                }\n            }\n        ]\'\n        defaultColumnTypeName="api-column"\n        displayHeaderIcons=\'true\'\n        dragcolumns=\'true\'\n        dragrows=\'true\'\n        draganddrop=\'true\'\n        enterkeymovedown=\'true\'\n        maxcolumns=\'20\'\n        maxrows=\'51\'\n        preserveNarrowColumns=\'true\'\n        spellcheck=\'false\'\n        stickyHeader=\'true\'\n        files=\'{\n            "buttons": [\n                {\n                    "position": "top-left",\n                    "order": 0,\n                    "text": "Import",\n                    "import": {\n                        "formats": ["csv", "xls", "xlsx", "ods", "txt"]\n                    },\n                    "styles": {\n                        "default":{\n                            "backgroundColor":"#eaeaea",\n                            "color":"#333"\n                        },\n                        "hover":{\n                            "backgroundColor":"#d9d9d9",\n                            "color":"#333"\n                        }\n                    }\n                },\n                {\n                    "position": "top-left",\n                    "order": 1,\n                    "text": "Export",\n                    "export": {\n                        "formats": ["csv", "xlsx", "ods"]\n                    },\n                    "styles": {\n                        "default":{\n                            "backgroundColor":"#eaeaea"\n                        },\n                        "hover":{\n                            "backgroundColor":"#d9d9d9"\n                        }\n                    }\n                }\n            ]\n        }\'\n        tableStyle=\'{\n            "borderRadius":"4px"\n        }\'\n        overflow=\'{\n            "maxHeight":"'.concat(e,'px",\n            "maxWidth":"481px"\n        }\'\n        framecomponentsstyles=\'{\n            "styles":{\n                "default": {"backgroundColor": "#f5f5f5"},\n                "hoverColors": {"backgroundColor": "#dedede"}\n            },\n            "inheritHeaderColors":false\n        }\'\n        rowhoverstyles=\'{\n            "style":{\n                "backgroundColor":"#d6d6d630",\n                "transitionDuration":"0.05s"\n            }\n        }\'\n    ></active-table>')}function dynamicContent_validateOptions(e){return e&&"object"===dynamicContent_typeof(e)?dynamicContent_objectSpread(dynamicContent_objectSpread({},dynamicContent_state.options),e):dynamicContent_objectSpread({},dynamicContent_state.options)}function dynamicContent_injectCSS(){var e=document.createElement("style");e.textContent="\n/* Learnosity dynamic content styles */\n.lt__dynamicContent.lrn-author.lrn-author  {\n    .lt-dynamic-content-help-text {\n        font-size: 15.4px;\n        line-height: 1.4em;\n    }\n\n    .lrn-author-datatable-footer {\n        justify-content: space-between;\n    }\n\n    .lrn-author-api-react-container .lrn-author-item-settings .lrn-author-datatable-footer button:nth-child(2),\n    .lrn-author-api-react-container .lrn-author-activity-labels .lrn-author-datatable-footer button:nth-child(2) {\n        margin: 0 2px;\n    }\n\n    .lrn-author-api-react-container .lrn-author-item-settings,\n    .lrn-author-api-react-container .lrn-author-activity-labels {\n        .lrn-author-datatable-editor {\n            .lrn-author-datatable-header {\n                height: auto;\n                padding-bottom: 0;\n            }\n\n            .lrn-author-datatable-source-wrapper {\n                display: none;\n            }\n        }\n\n        .lrn-author-datatable-header {\n            label {\n                display: none;\n            }\n        }\n    }\n}\n",document.head.append(e),dynamicContent_state.renderedCss=!0}var widgets=__webpack_require__(2530),essayMaxLength_state={renderedCss:!1,validTypes:["longtextV2","plaintext"]};function essayMaxLength_run(){essayMaxLength_state.renderedCss||essayMaxLength_injectCSS(),essayMaxLength_setupListeners()}function essayMaxLength_setupListeners(){core_app.appInstance().on("widgetedit:widget:ready",(function(){setTimeout((function(){var e=widgets.type();if(essayMaxLength_state.validTypes.includes(e)){var t=document.querySelector('[data-lrn-qe-input-path="max_length"] input.lrn-qe-input');t&&t.addEventListener("input",(function(){validateInput(t)}))}}),500)}))}function validateInput(e){var t="lt__input-invalid";e.value=e.value.replace(/^0+/,""),/^\d+$/.test(e.value)||(e.value=e.value.replace(/[^0-9]/g,"")),e.value.length&&!/^(0|[1-9]\d*)$/.test(e.value)?e.classList.add(t):e.classList.remove(t)}function essayMaxLength_injectCSS(){var e=document.createElement("style");e.textContent="\n/* Learnosity essay validate max length styles */\n.lrn-qe-ui .lrn-qe-form-group .lrn-qe-form-control.lt__input-invalid,\n.lrn-qe-ui .lrn-qe-form-group .lrn-qe-form-control.lt__input-invalid:active:not(:disabled):not([readonly]),\n.lrn-qe-ui .lrn-qe-form-group .lrn-qe-form-control.lt__input-invalid:focus:not(:disabled):not([readonly]) {\n    border-color: #ff0000;\n    outline: 0.0714285714em solid #dd002f;\n}\n",document.head.append(e),essayMaxLength_state.renderedCss=!0}var core_diagnostics=__webpack_require__(2147);function checkAppVersion(e){var t;return null===e&&null!==(t=(0,core_diagnostics.diagnostics)())&&void 0!==t&&null!==(t=t.versions)&&void 0!==t&&t.concrete&&(e=parseFloat((0,core_diagnostics.diagnostics)().versions.concrete.replace(/^v/,"").split(".").slice(0,2).join(""))>=2227?"author-":""),e}function _classPrivateFieldLooseBase(e,t){if(!{}.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var id=0;function _classPrivateFieldLooseKey(e){return"__private_"+id+++"_"+e}function insertReplacement(e,t,r){const n=[];return e.forEach((e=>"string"!=typeof e?n.push(e):t[Symbol.split](e).forEach(((e,t,i)=>{""!==e&&n.push(e),t<i.length-1&&n.push(r)})))),n}function interpolate(e,t){const r=/\$/g;let n=[e];if(null==t)return n;for(const e of Object.keys(t))if("_"!==e){let i=t[e];"string"==typeof i&&(i=r[Symbol.replace](i,"$$$$")),n=insertReplacement(n,new RegExp(`%\\{${e}\\}`,"g"),i)}return n}const defaultOnMissingKey=e=>{throw new Error(`missing string: ${e}`)};var _onMissingKey=_classPrivateFieldLooseKey("onMissingKey"),_apply=_classPrivateFieldLooseKey("apply");class Translator{constructor(e,t){let{onMissingKey:r=defaultOnMissingKey}=void 0===t?{}:t;Object.defineProperty(this,_apply,{value:_apply2}),Object.defineProperty(this,_onMissingKey,{writable:!0,value:void 0}),this.locale={strings:{},pluralize:e=>1===e?0:1},Array.isArray(e)?e.forEach(_classPrivateFieldLooseBase(this,_apply)[_apply],this):_classPrivateFieldLooseBase(this,_apply)[_apply](e),_classPrivateFieldLooseBase(this,_onMissingKey)[_onMissingKey]=r}translate(e,t){return this.translateArray(e,t).join("")}translateArray(e,t){let r=this.locale.strings[e];if(null==r&&(_classPrivateFieldLooseBase(this,_onMissingKey)[_onMissingKey](e),r=e),"object"==typeof r){if(t&&void 0!==t.smart_count)return interpolate(r[this.locale.pluralize(t.smart_count)],t);throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}if("string"!=typeof r)throw new Error("string was not a string");return interpolate(r,t)}}function _apply2(e){if(null==e||!e.strings)return;const t=this.locale;Object.assign(this.locale,{strings:{...t.strings,...e.strings},pluralize:e.pluralize||t.pluralize})}var namespace_emitter=__webpack_require__(3835);let urlAlphabet="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",customAlphabet=(e,t=21)=>(r=t)=>{let n="",i=0|r;for(;i--;)n+=e[Math.random()*e.length|0];return n},nanoid=(e=21)=>{let t="",r=0|e;for(;r--;)t+=urlAlphabet[64*Math.random()|0];return t};var throttle=__webpack_require__(7350);function lib_classPrivateFieldLooseBase(e,t){if(!{}.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var lib_id=0;function lib_classPrivateFieldLooseKey(e){return"__private_"+lib_id+++"_"+e}const packageJson={version:"4.2.0"};var _callbacks=lib_classPrivateFieldLooseKey("callbacks"),_publish=lib_classPrivateFieldLooseKey("publish");class DefaultStore{constructor(){Object.defineProperty(this,_publish,{value:_publish2}),this.state={},Object.defineProperty(this,_callbacks,{writable:!0,value:new Set})}getState(){return this.state}setState(e){const t={...this.state},r={...this.state,...e};this.state=r,lib_classPrivateFieldLooseBase(this,_publish)[_publish](t,r,e)}subscribe(e){return lib_classPrivateFieldLooseBase(this,_callbacks)[_callbacks].add(e),()=>{lib_classPrivateFieldLooseBase(this,_callbacks)[_callbacks].delete(e)}}}function _publish2(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];lib_classPrivateFieldLooseBase(this,_callbacks)[_callbacks].forEach((e=>{e(...t)}))}DefaultStore.VERSION=packageJson.version;const lib=DefaultStore;function getFileNameAndExtension(e){const t=e.lastIndexOf(".");return-1===t||t===e.length-1?{name:e,extension:void 0}:{name:e.slice(0,t),extension:e.slice(t+1)}}const lib_mimeTypes={__proto__:null,md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function getFileType(e){var t;if(e.type)return e.type;const r=e.name?null==(t=getFileNameAndExtension(e.name).extension)?void 0:t.toLowerCase():null;return r&&r in lib_mimeTypes?lib_mimeTypes[r]:"application/octet-stream"}function encodeCharacter(e){return e.charCodeAt(0).toString(32)}function encodeFilename(e){let t="";return e.replace(/[^A-Z0-9]/gi,(e=>(t+=`-${encodeCharacter(e)}`,"/")))+t}function generateFileID(e,t){let r=t||"uppy";return"string"==typeof e.name&&(r+=`-${encodeFilename(e.name.toLowerCase())}`),void 0!==e.type&&(r+=`-${e.type}`),e.meta&&"string"==typeof e.meta.relativePath&&(r+=`-${encodeFilename(e.meta.relativePath.toLowerCase())}`),void 0!==e.data.size&&(r+=`-${e.data.size}`),void 0!==e.data.lastModified&&(r+=`-${e.data.lastModified}`),r}function hasFileStableId(e){return!(!e.isRemote||!e.remote)&&new Set(["box","dropbox","drive","facebook","unsplash"]).has(e.remote.provider)}function getSafeFileId(e,t){if(hasFileStableId(e))return e.id;const r=getFileType(e);return generateFileID({...e,type:r},t)}function supportsUploadProgress(e){if(null==e&&"undefined"!=typeof navigator&&(e=navigator.userAgent),!e)return!0;const t=/Edge\/(\d+\.\d+)/.exec(e);if(!t)return!0;const r=t[1].split(".",2),n=parseInt(r[0],10),i=parseInt(r[1],10);return n<15||15===n&&i<15063||n>18||18===n&&i>=18218}function getFileName(e,t){return t.name?t.name:"image"===e.split("/")[0]?`${e.split("/")[0]}.${e.split("/")[1]}`:"noname"}function pad(e){return e<10?`0${e}`:e.toString()}function getTimeStamp(){const e=new Date;return`${pad(e.getHours())}:${pad(e.getMinutes())}:${pad(e.getSeconds())}`}const justErrorsLogger={debug:()=>{},warn:()=>{},error:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return console.error(`[Uppy] [${getTimeStamp()}]`,...t)}},debugLogger={debug:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return console.debug(`[Uppy] [${getTimeStamp()}]`,...t)},warn:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return console.warn(`[Uppy] [${getTimeStamp()}]`,...t)},error:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return console.error(`[Uppy] [${getTimeStamp()}]`,...t)}};var prettierBytes=__webpack_require__(8505),mime_match=__webpack_require__(7057);const Restricter_defaultOptions={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]};class RestrictionError extends Error{constructor(e,t){var r;super(e),this.isRestriction=!0,this.isUserFacing=null==(r=null==t?void 0:t.isUserFacing)||r,null!=t&&t.file&&(this.file=t.file)}}class Restricter{constructor(e,t){this.getI18n=t,this.getOpts=()=>{var t;const r=e();if(null!=(null==(t=r.restrictions)?void 0:t.allowedFileTypes)&&!Array.isArray(r.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return r}}validateAggregateRestrictions(e,t){const{maxTotalFileSize:r,maxNumberOfFiles:n}=this.getOpts().restrictions;if(n){const r=e.filter((e=>!e.isGhost));if(r.length+t.length>n)throw new RestrictionError(`${this.getI18n()("youCanOnlyUploadX",{smart_count:n})}`)}if(r){const n=[...e,...t].reduce(((e,t)=>{var r;return e+(null!=(r=t.size)?r:0)}),0);if(n>r)throw new RestrictionError(this.getI18n()("aggregateExceedsSize",{sizeAllowed:prettierBytes(r),size:prettierBytes(n)}))}}validateSingleFile(e){const{maxFileSize:t,minFileSize:r,allowedFileTypes:n}=this.getOpts().restrictions;if(n&&!n.some((t=>t.includes("/")?!!e.type&&mime_match(e.type.replace(/;.*?$/,""),t):!("."!==t[0]||!e.extension)&&e.extension.toLowerCase()===t.slice(1).toLowerCase()))){const t=n.join(", ");throw new RestrictionError(this.getI18n()("youCanOnlyUploadFileTypes",{types:t}),{file:e})}var i;if(t&&null!=e.size&&e.size>t)throw new RestrictionError(this.getI18n()("exceedsSize",{size:prettierBytes(t),file:null!=(i=e.name)?i:this.getI18n()("unnamed")}),{file:e});if(r&&null!=e.size&&e.size<r)throw new RestrictionError(this.getI18n()("inferiorSize",{size:prettierBytes(r)}),{file:e})}validate(e,t){t.forEach((e=>{this.validateSingleFile(e)})),this.validateAggregateRestrictions(e,t)}validateMinNumberOfFiles(e){const{minNumberOfFiles:t}=this.getOpts().restrictions;if(t&&Object.keys(e).length<t)throw new RestrictionError(this.getI18n()("youHaveToAtLeastSelectX",{smart_count:t}))}getMissingRequiredMetaFields(e){var t;const r=new RestrictionError(this.getI18n()("missingRequiredMetaFieldOnFile",{fileName:null!=(t=e.name)?t:this.getI18n()("unnamed")})),{requiredMetaFields:n}=this.getOpts().restrictions,i=[];for(const t of n)Object.hasOwn(e.meta,t)&&""!==e.meta[t]||i.push(t);return{missingFields:i,error:r}}}const locale={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},aggregateExceedsSize:"You selected %{size} of files, but maximum allowed size is %{sizeAllowed}",exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",noSearchResults:"Unfortunately, there are no results for this search",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",logIn:"Log in",pickFiles:"Pick files",pickPhotos:"Pick photos",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",loadedXFiles:"Loaded %{numFiles} files",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",resetSearch:"Reset search",emptyFolderAdded:"No files were added from empty folder",addedNumFiles:"Added %{numFiles} file(s)",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"},additionalRestrictionsFailed:"%{count} additional restrictions were not fulfilled",unnamed:"Unnamed",pleaseWait:"Please wait"}};function Uppy_classPrivateFieldLooseBase(e,t){if(!{}.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var Uppy_id=0;function Uppy_classPrivateFieldLooseKey(e){return"__private_"+Uppy_id+++"_"+e}const Uppy_packageJson={version:"4.4.3"},defaultUploadState={totalProgress:0,allowNewUpload:!0,error:null,recoveredState:null};var _plugins=Uppy_classPrivateFieldLooseKey("plugins"),_restricter=Uppy_classPrivateFieldLooseKey("restricter"),_storeUnsubscribe=Uppy_classPrivateFieldLooseKey("storeUnsubscribe"),_emitter=Uppy_classPrivateFieldLooseKey("emitter"),_preProcessors=Uppy_classPrivateFieldLooseKey("preProcessors"),_uploaders=Uppy_classPrivateFieldLooseKey("uploaders"),_postProcessors=Uppy_classPrivateFieldLooseKey("postProcessors"),_informAndEmit=Uppy_classPrivateFieldLooseKey("informAndEmit"),_checkRequiredMetaFieldsOnFile=Uppy_classPrivateFieldLooseKey("checkRequiredMetaFieldsOnFile"),_checkRequiredMetaFields=Uppy_classPrivateFieldLooseKey("checkRequiredMetaFields"),_assertNewUploadAllowed=Uppy_classPrivateFieldLooseKey("assertNewUploadAllowed"),_transformFile=Uppy_classPrivateFieldLooseKey("transformFile"),_startIfAutoProceed=Uppy_classPrivateFieldLooseKey("startIfAutoProceed"),_checkAndUpdateFileState=Uppy_classPrivateFieldLooseKey("checkAndUpdateFileState"),_handleUploadProgress=Uppy_classPrivateFieldLooseKey("handleUploadProgress"),_updateTotalProgress=Uppy_classPrivateFieldLooseKey("updateTotalProgress"),_updateTotalProgressThrottled=Uppy_classPrivateFieldLooseKey("updateTotalProgressThrottled"),_calculateTotalProgress=Uppy_classPrivateFieldLooseKey("calculateTotalProgress"),_addListeners=Uppy_classPrivateFieldLooseKey("addListeners"),_updateOnlineStatus=Uppy_classPrivateFieldLooseKey("updateOnlineStatus"),_requestClientById=Uppy_classPrivateFieldLooseKey("requestClientById"),_createUpload=Uppy_classPrivateFieldLooseKey("createUpload"),_getUpload=Uppy_classPrivateFieldLooseKey("getUpload"),_removeUpload=Uppy_classPrivateFieldLooseKey("removeUpload"),_runUpload=Uppy_classPrivateFieldLooseKey("runUpload");class Uppy{constructor(e){Object.defineProperty(this,_runUpload,{value:_runUpload2}),Object.defineProperty(this,_removeUpload,{value:_removeUpload2}),Object.defineProperty(this,_getUpload,{value:_getUpload2}),Object.defineProperty(this,_createUpload,{value:_createUpload2}),Object.defineProperty(this,_addListeners,{value:_addListeners2}),Object.defineProperty(this,_calculateTotalProgress,{value:_calculateTotalProgress2}),Object.defineProperty(this,_updateTotalProgress,{value:_updateTotalProgress2}),Object.defineProperty(this,_checkAndUpdateFileState,{value:_checkAndUpdateFileState2}),Object.defineProperty(this,_startIfAutoProceed,{value:_startIfAutoProceed2}),Object.defineProperty(this,_transformFile,{value:_transformFile2}),Object.defineProperty(this,_assertNewUploadAllowed,{value:_assertNewUploadAllowed2}),Object.defineProperty(this,_checkRequiredMetaFields,{value:_checkRequiredMetaFields2}),Object.defineProperty(this,_checkRequiredMetaFieldsOnFile,{value:_checkRequiredMetaFieldsOnFile2}),Object.defineProperty(this,_informAndEmit,{value:_informAndEmit2}),Object.defineProperty(this,_plugins,{writable:!0,value:Object.create(null)}),Object.defineProperty(this,_restricter,{writable:!0,value:void 0}),Object.defineProperty(this,_storeUnsubscribe,{writable:!0,value:void 0}),Object.defineProperty(this,_emitter,{writable:!0,value:namespace_emitter()}),Object.defineProperty(this,_preProcessors,{writable:!0,value:new Set}),Object.defineProperty(this,_uploaders,{writable:!0,value:new Set}),Object.defineProperty(this,_postProcessors,{writable:!0,value:new Set}),this.scheduledAutoProceed=null,this.wasOffline=!1,Object.defineProperty(this,_handleUploadProgress,{writable:!0,value:(e,t)=>{const r=e?this.getFile(e.id):void 0;if(null==e||!r)return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);if(100===r.progress.percentage)return void this.log(`Not setting progress for a file that has been already uploaded: ${e.id}`);const n={bytesTotal:t.bytesTotal,percentage:null!=t.bytesTotal&&Number.isFinite(t.bytesTotal)&&t.bytesTotal>0?Math.round(t.bytesUploaded/t.bytesTotal*100):void 0};null!=r.progress.uploadStarted?this.setFileState(e.id,{progress:{...r.progress,...n,bytesUploaded:t.bytesUploaded}}):this.setFileState(e.id,{progress:{...r.progress,...n}}),Uppy_classPrivateFieldLooseBase(this,_updateTotalProgressThrottled)[_updateTotalProgressThrottled]()}}),Object.defineProperty(this,_updateTotalProgressThrottled,{writable:!0,value:throttle((()=>Uppy_classPrivateFieldLooseBase(this,_updateTotalProgress)[_updateTotalProgress]()),500,{leading:!0,trailing:!0})}),Object.defineProperty(this,_updateOnlineStatus,{writable:!0,value:this.updateOnlineStatus.bind(this)}),Object.defineProperty(this,_requestClientById,{writable:!0,value:new Map}),this.defaultLocale=locale;const t={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:Restricter_defaultOptions,meta:{},onBeforeFileAdded:(e,t)=>!Object.hasOwn(t,e.id),onBeforeUpload:e=>e,store:new lib,logger:justErrorsLogger,infoTimeout:5e3},r={...t,...e};this.opts={...r,restrictions:{...t.restrictions,...e&&e.restrictions}},e&&e.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e&&e.debug&&(this.opts.logger=debugLogger),this.log(`Using Core v${Uppy.VERSION}`),this.i18nInit(),this.store=this.opts.store,this.setState({...defaultUploadState,plugins:{},files:{},currentUploads:{},capabilities:{uploadProgress:supportsUploadProgress(),individualCancellation:!0,resumableUploads:!1},meta:{...this.opts.meta},info:[]}),Uppy_classPrivateFieldLooseBase(this,_restricter)[_restricter]=new Restricter((()=>this.opts),(()=>this.i18n)),Uppy_classPrivateFieldLooseBase(this,_storeUnsubscribe)[_storeUnsubscribe]=this.store.subscribe(((e,t,r)=>{this.emit("state-update",e,t,r),this.updateAll(t)})),this.opts.debug&&"undefined"!=typeof window&&(window[this.opts.id]=this),Uppy_classPrivateFieldLooseBase(this,_addListeners)[_addListeners]()}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];Uppy_classPrivateFieldLooseBase(this,_emitter)[_emitter].emit(e,...r)}on(e,t){return Uppy_classPrivateFieldLooseBase(this,_emitter)[_emitter].on(e,t),this}once(e,t){return Uppy_classPrivateFieldLooseBase(this,_emitter)[_emitter].once(e,t),this}off(e,t){return Uppy_classPrivateFieldLooseBase(this,_emitter)[_emitter].off(e,t),this}updateAll(e){this.iteratePlugins((t=>{t.update(e)}))}setState(e){this.store.setState(e)}getState(){return this.store.getState()}patchFilesState(e){const t=this.getState().files;this.setState({files:{...t,...Object.fromEntries(Object.entries(e).map((e=>{let[r,n]=e;return[r,{...t[r],...n}]})))}})}setFileState(e,t){if(!this.getState().files[e])throw new Error(`Canâ€™t set state for ${e} (the file could have been removed)`);this.patchFilesState({[e]:t})}i18nInit(){const e=new Translator([this.defaultLocale,this.opts.locale],{onMissingKey:e=>this.log(`Missing i18n string: ${e}`,"error")});this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.locale=e.locale}setOptions(e){this.opts={...this.opts,...e,restrictions:{...this.opts.restrictions,...null==e?void 0:e.restrictions}},e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins((t=>{t.setOptions(e)})),this.setState(void 0)}resetProgress(){const e={percentage:0,bytesUploaded:!1,uploadComplete:!1,uploadStarted:null},t={...this.getState().files},r=Object.create(null);Object.keys(t).forEach((n=>{r[n]={...t[n],progress:{...t[n].progress,...e},tus:void 0,transloadit:void 0}})),this.setState({files:r,...defaultUploadState})}clear(){const{capabilities:e,currentUploads:t}=this.getState();if(Object.keys(t).length>0&&!e.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");this.setState({...defaultUploadState,files:{}})}addPreProcessor(e){Uppy_classPrivateFieldLooseBase(this,_preProcessors)[_preProcessors].add(e)}removePreProcessor(e){return Uppy_classPrivateFieldLooseBase(this,_preProcessors)[_preProcessors].delete(e)}addPostProcessor(e){Uppy_classPrivateFieldLooseBase(this,_postProcessors)[_postProcessors].add(e)}removePostProcessor(e){return Uppy_classPrivateFieldLooseBase(this,_postProcessors)[_postProcessors].delete(e)}addUploader(e){Uppy_classPrivateFieldLooseBase(this,_uploaders)[_uploaders].add(e)}removeUploader(e){return Uppy_classPrivateFieldLooseBase(this,_uploaders)[_uploaders].delete(e)}setMeta(e){const t={...this.getState().meta,...e},r={...this.getState().files};Object.keys(r).forEach((t=>{r[t]={...r[t],meta:{...r[t].meta,...e}}})),this.log("Adding metadata:"),this.log(e),this.setState({meta:t,files:r})}setFileMeta(e,t){const r={...this.getState().files};if(!r[e])return void this.log(`Was trying to set metadata for a file that has been removed: ${e}`);const n={...r[e].meta,...t};r[e]={...r[e],meta:n},this.setState({files:r})}getFile(e){return this.getState().files[e]}getFiles(){const{files:e}=this.getState();return Object.values(e)}getFilesByIds(e){return e.map((e=>this.getFile(e)))}getObjectOfFilesPerState(){const{files:e,totalProgress:t,error:r}=this.getState(),n=Object.values(e),i=[],a=[],s=[],o=[],l=[],c=[],d=[],u=[],p=[];for(const e of n){const{progress:t}=e;!t.uploadComplete&&t.uploadStarted&&(i.push(e),e.isPaused||u.push(e)),t.uploadStarted||a.push(e),(t.uploadStarted||t.preprocess||t.postprocess)&&s.push(e),t.uploadStarted&&o.push(e),e.isPaused&&l.push(e),t.uploadComplete&&c.push(e),e.error&&d.push(e),(t.preprocess||t.postprocess)&&p.push(e)}return{newFiles:a,startedFiles:s,uploadStartedFiles:o,pausedFiles:l,completeFiles:c,erroredFiles:d,inProgressFiles:i,inProgressNotPausedFiles:u,processingFiles:p,isUploadStarted:o.length>0,isAllComplete:100===t&&c.length===n.length&&0===p.length,isAllErrored:!!r&&d.length===n.length,isAllPaused:0!==i.length&&l.length===i.length,isUploadInProgress:i.length>0,isSomeGhost:n.some((e=>e.isGhost))}}validateRestrictions(e,t){void 0===t&&(t=this.getFiles());try{Uppy_classPrivateFieldLooseBase(this,_restricter)[_restricter].validate(t,[e])}catch(e){return e}return null}validateSingleFile(e){try{Uppy_classPrivateFieldLooseBase(this,_restricter)[_restricter].validateSingleFile(e)}catch(e){return e.message}return null}validateAggregateRestrictions(e){const t=this.getFiles();try{Uppy_classPrivateFieldLooseBase(this,_restricter)[_restricter].validateAggregateRestrictions(t,e)}catch(e){return e.message}return null}checkIfFileAlreadyExists(e){const{files:t}=this.getState();return!(!t[e]||t[e].isGhost)}addFile(e){Uppy_classPrivateFieldLooseBase(this,_assertNewUploadAllowed)[_assertNewUploadAllowed](e);const{nextFilesState:t,validFilesToAdd:r,errors:n}=Uppy_classPrivateFieldLooseBase(this,_checkAndUpdateFileState)[_checkAndUpdateFileState]([e]),i=n.filter((e=>e.isRestriction));if(Uppy_classPrivateFieldLooseBase(this,_informAndEmit)[_informAndEmit](i),n.length>0)throw n[0];this.setState({files:t});const[a]=r;return this.emit("file-added",a),this.emit("files-added",r),this.log(`Added file: ${a.name}, ${a.id}, mime type: ${a.type}`),Uppy_classPrivateFieldLooseBase(this,_startIfAutoProceed)[_startIfAutoProceed](),a.id}addFiles(e){Uppy_classPrivateFieldLooseBase(this,_assertNewUploadAllowed)[_assertNewUploadAllowed]();const{nextFilesState:t,validFilesToAdd:r,errors:n}=Uppy_classPrivateFieldLooseBase(this,_checkAndUpdateFileState)[_checkAndUpdateFileState](e),i=n.filter((e=>e.isRestriction));Uppy_classPrivateFieldLooseBase(this,_informAndEmit)[_informAndEmit](i);const a=n.filter((e=>!e.isRestriction));if(a.length>0){let e="Multiple errors occurred while adding files:\n";if(a.forEach((t=>{e+=`\n * ${t.message}`})),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:a.length}),details:e},"error",this.opts.infoTimeout),"function"==typeof AggregateError)throw new AggregateError(a,e);{const t=new Error(e);throw t.errors=a,t}}this.setState({files:t}),r.forEach((e=>{this.emit("file-added",e)})),this.emit("files-added",r),r.length>5?this.log(`Added batch of ${r.length} files`):Object.values(r).forEach((e=>{this.log(`Added file: ${e.name}\n id: ${e.id}\n type: ${e.type}`)})),r.length>0&&Uppy_classPrivateFieldLooseBase(this,_startIfAutoProceed)[_startIfAutoProceed]()}removeFiles(e){const{files:t,currentUploads:r}=this.getState(),n={...t},i={...r},a=Object.create(null);function s(e){return void 0===a[e]}e.forEach((e=>{t[e]&&(a[e]=t[e],delete n[e])})),Object.keys(i).forEach((e=>{const t=r[e].fileIDs.filter(s);if(0===t.length)return void delete i[e];const{capabilities:n}=this.getState();if(t.length!==r[e].fileIDs.length&&!n.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");i[e]={...r[e],fileIDs:t}}));const o={currentUploads:i,files:n};0===Object.keys(n).length&&(o.allowNewUpload=!0,o.error=null,o.recoveredState=null),this.setState(o),Uppy_classPrivateFieldLooseBase(this,_updateTotalProgressThrottled)[_updateTotalProgressThrottled]();const l=Object.keys(a);l.forEach((e=>{this.emit("file-removed",a[e])})),l.length>5?this.log(`Removed ${l.length} files`):this.log(`Removed files: ${l.join(", ")}`)}removeFile(e){this.removeFiles([e])}pauseResume(e){if(!this.getState().capabilities.resumableUploads||this.getFile(e).progress.uploadComplete)return;const t=this.getFile(e),r=!t.isPaused;return this.setFileState(e,{isPaused:r}),this.emit("upload-pause",t,r),r}pauseAll(){const e={...this.getState().files};Object.keys(e).filter((t=>!e[t].progress.uploadComplete&&e[t].progress.uploadStarted)).forEach((t=>{const r={...e[t],isPaused:!0};e[t]=r})),this.setState({files:e}),this.emit("pause-all")}resumeAll(){const e={...this.getState().files};Object.keys(e).filter((t=>!e[t].progress.uploadComplete&&e[t].progress.uploadStarted)).forEach((t=>{const r={...e[t],isPaused:!1,error:null};e[t]=r})),this.setState({files:e}),this.emit("resume-all")}retryAll(){const e={...this.getState().files},t=Object.keys(e).filter((t=>e[t].error));if(t.forEach((t=>{const r={...e[t],isPaused:!1,error:null};e[t]=r})),this.setState({files:e,error:null}),this.emit("retry-all",Object.values(e)),0===t.length)return Promise.resolve({successful:[],failed:[]});const r=Uppy_classPrivateFieldLooseBase(this,_createUpload)[_createUpload](t,{forceAllowNewUpload:!0});return Uppy_classPrivateFieldLooseBase(this,_runUpload)[_runUpload](r)}cancelAll(){this.emit("cancel-all");const{files:e}=this.getState(),t=Object.keys(e);t.length&&this.removeFiles(t),this.setState(defaultUploadState)}retryUpload(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",this.getFile(e));const t=Uppy_classPrivateFieldLooseBase(this,_createUpload)[_createUpload]([e],{forceAllowNewUpload:!0});return Uppy_classPrivateFieldLooseBase(this,_runUpload)[_runUpload](t)}logout(){this.iteratePlugins((e=>{var t;null==(t=e.provider)||null==t.logout||t.logout()}))}[Symbol.for("uppy test: updateTotalProgress")](){return Uppy_classPrivateFieldLooseBase(this,_updateTotalProgress)[_updateTotalProgress]()}updateOnlineStatus(){var e;null==(e=window.navigator.onLine)||e?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}getID(){return this.opts.id}use(e){if("function"!=typeof e)throw new TypeError(`Expected a plugin class, but got ${null===e?"null":typeof e}. Please verify that the plugin was imported and spelled correctly.`);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const i=new e(this,...r),a=i.id;if(!a)throw new Error("Your plugin must have an id");if(!i.type)throw new Error("Your plugin must have a type");const s=this.getPlugin(a);if(s){const e=`Already found a plugin named '${s.id}'. Tried to use: '${a}'.\nUppy plugins must have unique \`id\` options.`;throw new Error(e)}return e.VERSION&&this.log(`Using ${a} v${e.VERSION}`),i.type in Uppy_classPrivateFieldLooseBase(this,_plugins)[_plugins]?Uppy_classPrivateFieldLooseBase(this,_plugins)[_plugins][i.type].push(i):Uppy_classPrivateFieldLooseBase(this,_plugins)[_plugins][i.type]=[i],i.install(),this.emit("plugin-added",i),this}getPlugin(e){for(const t of Object.values(Uppy_classPrivateFieldLooseBase(this,_plugins)[_plugins])){const r=t.find((t=>t.id===e));if(null!=r)return r}}[Symbol.for("uppy test: getPlugins")](e){return Uppy_classPrivateFieldLooseBase(this,_plugins)[_plugins][e]}iteratePlugins(e){Object.values(Uppy_classPrivateFieldLooseBase(this,_plugins)[_plugins]).flat(1).forEach(e)}removePlugin(e){this.log(`Removing plugin ${e.id}`),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();const t=Uppy_classPrivateFieldLooseBase(this,_plugins)[_plugins][e.type],r=t.findIndex((t=>t.id===e.id));-1!==r&&t.splice(r,1);const n={plugins:{...this.getState().plugins,[e.id]:void 0}};this.setState(n)}destroy(){this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll(),Uppy_classPrivateFieldLooseBase(this,_storeUnsubscribe)[_storeUnsubscribe](),this.iteratePlugins((e=>{this.removePlugin(e)})),"undefined"!=typeof window&&window.removeEventListener&&(window.removeEventListener("online",Uppy_classPrivateFieldLooseBase(this,_updateOnlineStatus)[_updateOnlineStatus]),window.removeEventListener("offline",Uppy_classPrivateFieldLooseBase(this,_updateOnlineStatus)[_updateOnlineStatus]))}hideInfo(){const{info:e}=this.getState();this.setState({info:e.slice(1)}),this.emit("info-hidden")}info(e,t,r){void 0===t&&(t="info"),void 0===r&&(r=3e3);const n="object"==typeof e;this.setState({info:[...this.getState().info,{type:t,message:n?e.message:e,details:n?e.details:null}]}),setTimeout((()=>this.hideInfo()),r),this.emit("info-visible")}log(e,t){const{logger:r}=this.opts;switch(t){case"error":r.error(e);break;case"warning":r.warn(e);break;default:r.debug(e)}}registerRequestClient(e,t){Uppy_classPrivateFieldLooseBase(this,_requestClientById)[_requestClientById].set(e,t)}getRequestClientForFile(e){if(!e.remote)throw new Error(`Tried to get RequestClient for a non-remote file ${e.id}`);const t=Uppy_classPrivateFieldLooseBase(this,_requestClientById)[_requestClientById].get(e.remote.requestClientId);if(null==t)throw new Error(`requestClientId "${e.remote.requestClientId}" not registered for file "${e.id}"`);return t}restore(e){return this.log(`Core: attempting to restore upload "${e}"`),this.getState().currentUploads[e]?Uppy_classPrivateFieldLooseBase(this,_runUpload)[_runUpload](e):(Uppy_classPrivateFieldLooseBase(this,_removeUpload)[_removeUpload](e),Promise.reject(new Error("Nonexistent upload")))}[Symbol.for("uppy test: createUpload")](){return Uppy_classPrivateFieldLooseBase(this,_createUpload)[_createUpload](...arguments)}addResultData(e,t){if(!Uppy_classPrivateFieldLooseBase(this,_getUpload)[_getUpload](e))return void this.log(`Not setting result for an upload that has been removed: ${e}`);const{currentUploads:r}=this.getState(),n={...r[e],result:{...r[e].result,...t}};this.setState({currentUploads:{...r,[e]:n}})}async upload(){var e;null!=(e=Uppy_classPrivateFieldLooseBase(this,_plugins)[_plugins].uploader)&&e.length||this.log("No uploader type plugins are used","warning");let{files:t}=this.getState();const r=Object.keys(t).filter((e=>t[e].error));if(r.length>0){const e={...t};r.forEach((t=>{e[t]={...e[t],isPaused:!1,error:null}})),this.setState({files:e,error:null}),this.emit("retry-all",Object.values(e));const n=Uppy_classPrivateFieldLooseBase(this,_createUpload)[_createUpload](r,{forceAllowNewUpload:!0}),i=await Uppy_classPrivateFieldLooseBase(this,_runUpload)[_runUpload](n);if(!this.getFiles().filter((e=>null==e.progress.uploadStarted)))return i;t=this.getState().files}const n=this.opts.onBeforeUpload(t);return!1===n?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(n&&"object"==typeof n&&(t=n,this.setState({files:t})),Promise.resolve().then((()=>Uppy_classPrivateFieldLooseBase(this,_restricter)[_restricter].validateMinNumberOfFiles(t))).catch((e=>{throw Uppy_classPrivateFieldLooseBase(this,_informAndEmit)[_informAndEmit]([e]),e})).then((()=>{if(!Uppy_classPrivateFieldLooseBase(this,_checkRequiredMetaFields)[_checkRequiredMetaFields](t))throw new RestrictionError(this.i18n("missingRequiredMetaField"))})).catch((e=>{throw e})).then((()=>{const{currentUploads:e}=this.getState(),r=Object.values(e).flatMap((e=>e.fileIDs)),n=[];Object.keys(t).forEach((e=>{const t=this.getFile(e);t.progress.uploadStarted||-1!==r.indexOf(e)||n.push(t.id)}));const i=Uppy_classPrivateFieldLooseBase(this,_createUpload)[_createUpload](n);return Uppy_classPrivateFieldLooseBase(this,_runUpload)[_runUpload](i)})).catch((e=>{throw this.emit("error",e),this.log(e,"error"),e})))}}function _informAndEmit2(e){for(const t of e)t.isRestriction?this.emit("restriction-failed",t.file,t):this.emit("error",t,t.file),this.log(t,"warning");const t=e.filter((e=>e.isUserFacing)),r=t.slice(0,4),n=t.slice(4);r.forEach((e=>{let{message:t,details:r=""}=e;this.info({message:t,details:r},"error",this.opts.infoTimeout)})),n.length>0&&this.info({message:this.i18n("additionalRestrictionsFailed",{count:n.length})})}function _checkRequiredMetaFieldsOnFile2(e){const{missingFields:t,error:r}=Uppy_classPrivateFieldLooseBase(this,_restricter)[_restricter].getMissingRequiredMetaFields(e);return!(t.length>0&&(this.setFileState(e.id,{missingRequiredMetaFields:t}),this.log(r.message),this.emit("restriction-failed",e,r),1))}function _checkRequiredMetaFields2(e){let t=!0;for(const r of Object.values(e))Uppy_classPrivateFieldLooseBase(this,_checkRequiredMetaFieldsOnFile)[_checkRequiredMetaFieldsOnFile](r)||(t=!1);return t}function _assertNewUploadAllowed2(e){const{allowNewUpload:t}=this.getState();if(!1===t){const t=new RestrictionError(this.i18n("noMoreFilesAllowed"),{file:e});throw Uppy_classPrivateFieldLooseBase(this,_informAndEmit)[_informAndEmit]([t]),t}}function _transformFile2(e){const t=e instanceof File?{name:e.name,type:e.type,size:e.size,data:e}:e,r=getFileType(t),n=getFileName(r,t),i=getFileNameAndExtension(n).extension,a=getSafeFileId(t,this.getID()),s=t.meta||{};s.name=n,s.type=r;const o=Number.isFinite(t.data.size)?t.data.size:null;return{source:t.source||"",id:a,name:n,extension:i||"",meta:{...this.getState().meta,...s},type:r,data:t.data,progress:{percentage:0,bytesUploaded:!1,bytesTotal:o,uploadComplete:!1,uploadStarted:null},size:o,isGhost:!1,isRemote:t.isRemote||!1,remote:t.remote,preview:t.preview}}function _startIfAutoProceed2(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout((()=>{this.scheduledAutoProceed=null,this.upload().catch((e=>{e.isRestriction||this.log(e.stack||e.message||e)}))}),4))}function _checkAndUpdateFileState2(e){const{files:t}=this.getState(),r={...t},n=[],i=[];for(const o of e)try{var a;let e=Uppy_classPrivateFieldLooseBase(this,_transformFile)[_transformFile](o);const i=null==(a=t[e.id])?void 0:a.isGhost;i&&(e={...t[e.id],isGhost:!1,data:o.data},this.log(`Replaced the blob in the restored ghost file: ${e.name}, ${e.id}`));const l=this.opts.onBeforeFileAdded(e,r);var s;if(!l&&this.checkIfFileAlreadyExists(e.id))throw new RestrictionError(this.i18n("noDuplicates",{fileName:null!=(s=e.name)?s:this.i18n("unnamed")}),{file:o});if(!1===l&&!i)throw new RestrictionError("Cannot add the file because onBeforeFileAdded returned false.",{isUserFacing:!1,file:o});"object"==typeof l&&null!==l&&(e=l),Uppy_classPrivateFieldLooseBase(this,_restricter)[_restricter].validateSingleFile(e),r[e.id]=e,n.push(e)}catch(e){i.push(e)}try{Uppy_classPrivateFieldLooseBase(this,_restricter)[_restricter].validateAggregateRestrictions(Object.values(t),n)}catch(e){return i.push(e),{nextFilesState:t,validFilesToAdd:[],errors:i}}return{nextFilesState:r,validFilesToAdd:n,errors:i}}function _updateTotalProgress2(){var e,t;const r=Uppy_classPrivateFieldLooseBase(this,_calculateTotalProgress)[_calculateTotalProgress]();let n=null;null!=r&&(n=Math.round(100*r),n>100?n=100:n<0&&(n=0)),this.emit("progress",null!=(e=n)?e:0),this.setState({totalProgress:null!=(t=n)?t:0})}function _calculateTotalProgress2(){const e=this.getFiles().filter((e=>e.progress.uploadStarted||e.progress.preprocess||e.progress.postprocess));if(0===e.length)return 0;if(e.every((e=>e.progress.uploadComplete)))return 1;const t=e=>null!=e.progress.bytesTotal&&0!==e.progress.bytesTotal,r=e.filter(t),n=e.filter((e=>!t(e)));if(r.every((e=>e.progress.uploadComplete))&&n.length>0&&!n.every((e=>e.progress.uploadComplete)))return null;const i=r.reduce(((e,t)=>{var r;return e+(null!=(r=t.progress.bytesTotal)?r:0)}),0),a=r.reduce(((e,t)=>e+(t.progress.bytesUploaded||0)),0);return 0===i?0:a/i}function _addListeners2(){const e=(e,t,r)=>{let n=e.message||"Unknown error";e.details&&(n+=` ${e.details}`),this.setState({error:n}),null!=t&&t.id in this.getState().files&&this.setFileState(t.id,{error:n,response:r})};this.on("error",e),this.on("upload-error",((t,r,n)=>{if(e(r,t,n),"object"==typeof r&&r.message){var i;this.log(r.message,"error");const e=new Error(this.i18n("failedToUpload",{file:null!=(i=null==t?void 0:t.name)?i:""}));e.isUserFacing=!0,e.details=r.message,r.details&&(e.details+=` ${r.details}`),Uppy_classPrivateFieldLooseBase(this,_informAndEmit)[_informAndEmit]([e])}else Uppy_classPrivateFieldLooseBase(this,_informAndEmit)[_informAndEmit]([r])}));let t=null;this.on("upload-stalled",((e,r)=>{const{message:n}=e,i=r.map((e=>e.meta.name)).join(", ");t||(this.info({message:n,details:i},"warning",this.opts.infoTimeout),t=setTimeout((()=>{t=null}),this.opts.infoTimeout)),this.log(`${n} ${i}`.trim(),"warning")})),this.on("upload",(()=>{this.setState({error:null})})),this.on("upload-start",(e=>{const t=e.filter((e=>{const t=null!=e&&this.getFile(e.id);return t||this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`),t})),r=Object.fromEntries(t.map((e=>[e.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,bytesUploaded:0,bytesTotal:e.size}}])));this.patchFilesState(r)})),this.on("upload-progress",Uppy_classPrivateFieldLooseBase(this,_handleUploadProgress)[_handleUploadProgress]),this.on("upload-success",((e,t)=>{if(null==e||!this.getFile(e.id))return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);const r=this.getFile(e.id).progress;this.setFileState(e.id,{progress:{...r,postprocess:Uppy_classPrivateFieldLooseBase(this,_postProcessors)[_postProcessors].size>0?{mode:"indeterminate"}:void 0,uploadComplete:!0,percentage:100,bytesUploaded:r.bytesTotal},response:t,uploadURL:t.uploadURL,isPaused:!1}),null==e.size&&this.setFileState(e.id,{size:t.bytesUploaded||r.bytesTotal}),Uppy_classPrivateFieldLooseBase(this,_updateTotalProgressThrottled)[_updateTotalProgressThrottled]()})),this.on("preprocess-progress",((e,t)=>{null!=e&&this.getFile(e.id)?this.setFileState(e.id,{progress:{...this.getFile(e.id).progress,preprocess:t}}):this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`)})),this.on("preprocess-complete",(e=>{if(null==e||!this.getFile(e.id))return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);const t={...this.getState().files};t[e.id]={...t[e.id],progress:{...t[e.id].progress}},delete t[e.id].progress.preprocess,this.setState({files:t})})),this.on("postprocess-progress",((e,t)=>{null!=e&&this.getFile(e.id)?this.setFileState(e.id,{progress:{...this.getState().files[e.id].progress,postprocess:t}}):this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`)})),this.on("postprocess-complete",(e=>{if(null==e||!this.getFile(e.id))return void this.log(`Not setting progress for a file that has been removed: ${null==e?void 0:e.id}`);const t={...this.getState().files};t[e.id]={...t[e.id],progress:{...t[e.id].progress}},delete t[e.id].progress.postprocess,this.setState({files:t})})),this.on("restored",(()=>{Uppy_classPrivateFieldLooseBase(this,_updateTotalProgressThrottled)[_updateTotalProgressThrottled]()})),this.on("dashboard:file-edit-complete",(e=>{e&&Uppy_classPrivateFieldLooseBase(this,_checkRequiredMetaFieldsOnFile)[_checkRequiredMetaFieldsOnFile](e)})),"undefined"!=typeof window&&window.addEventListener&&(window.addEventListener("online",Uppy_classPrivateFieldLooseBase(this,_updateOnlineStatus)[_updateOnlineStatus]),window.addEventListener("offline",Uppy_classPrivateFieldLooseBase(this,_updateOnlineStatus)[_updateOnlineStatus]),setTimeout(Uppy_classPrivateFieldLooseBase(this,_updateOnlineStatus)[_updateOnlineStatus],3e3))}function _createUpload2(e,t){void 0===t&&(t={});const{forceAllowNewUpload:r=!1}=t,{allowNewUpload:n,currentUploads:i}=this.getState();if(!n&&!r)throw new Error("Cannot create a new upload: already uploading.");const a=nanoid();return this.emit("upload",a,this.getFilesByIds(e)),this.setState({allowNewUpload:!1!==this.opts.allowMultipleUploadBatches&&!1!==this.opts.allowMultipleUploads,currentUploads:{...i,[a]:{fileIDs:e,step:0,result:{}}}}),a}function _getUpload2(e){const{currentUploads:t}=this.getState();return t[e]}function _removeUpload2(e){const t={...this.getState().currentUploads};delete t[e],this.setState({currentUploads:t})}async function _runUpload2(e){const t=()=>{const{currentUploads:t}=this.getState();return t[e]};let r=t();const n=[...Uppy_classPrivateFieldLooseBase(this,_preProcessors)[_preProcessors],...Uppy_classPrivateFieldLooseBase(this,_uploaders)[_uploaders],...Uppy_classPrivateFieldLooseBase(this,_postProcessors)[_postProcessors]];try{for(let i=r.step||0;i<n.length&&r;i++){const a=n[i];this.setState({currentUploads:{...this.getState().currentUploads,[e]:{...r,step:i}}});const{fileIDs:s}=r;await a(s,e),r=t()}}catch(t){throw Uppy_classPrivateFieldLooseBase(this,_removeUpload)[_removeUpload](e),t}if(r){r.fileIDs.forEach((e=>{const t=this.getFile(e);t&&t.progress.postprocess&&this.emit("postprocess-complete",t)}));const n=r.fileIDs.map((e=>this.getFile(e))),i=n.filter((e=>!e.error)),a=n.filter((e=>e.error));this.addResultData(e,{successful:i,failed:a,uploadID:e}),r=t()}let i;return r&&(i=r.result,this.emit("complete",i),Uppy_classPrivateFieldLooseBase(this,_removeUpload)[_removeUpload](e)),null==i&&this.log(`Not setting result for an upload that has been removed: ${e}`),i}Uppy.VERSION=Uppy_packageJson.version;const lib_Uppy=Uppy;var n,l,t,u,i,r,o,e,f,c,s,a,preact_module_h,p={},v=[],y=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,d=Array.isArray;function w(e,t){for(var r in t)e[r]=t[r];return e}function g(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function _(e,t,r){var i,a,s,o={};for(s in t)"key"==s?i=t[s]:"ref"==s?a=t[s]:o[s]=t[s];if(arguments.length>2&&(o.children=arguments.length>3?n.call(arguments,2):r),"function"==typeof e&&null!=e.defaultProps)for(s in e.defaultProps)void 0===o[s]&&(o[s]=e.defaultProps[s]);return m(e,o,i,a,null)}function m(e,r,n,i,a){var s={type:e,props:r,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==a?++t:a,__i:-1,__u:0};return null==a&&null!=l.vnode&&l.vnode(s),s}function b(){return{current:null}}function k(e){return e.children}function x(e,t){this.props=e,this.context=t}function S(e,t){if(null==t)return e.__?S(e.__,e.__i+1):null;for(var r;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e)return r.__e;return"function"==typeof e.type?S(e):null}function C(e){var t,r;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e){e.__e=e.__c.base=r.__e;break}return C(e)}}function M(e){(!e.__d&&(e.__d=!0)&&i.push(e)&&!preact_module_$.__r++||r!==l.debounceRendering)&&((r=l.debounceRendering)||o)(preact_module_$)}function preact_module_$(){for(var t,r,n,a,s,o,c,d=1;i.length;)i.length>d&&i.sort(e),t=i.shift(),d=i.length,t.__d&&(n=void 0,s=(a=(r=t).__v).__e,o=[],c=[],r.__P&&((n=w({},a)).__v=a.__v+1,l.vnode&&l.vnode(n),O(r.__P,n,a,r.__n,r.__P.namespaceURI,32&a.__u?[s]:null,o,null==s?S(a):s,!!(32&a.__u),c),n.__v=a.__v,n.__.__k[n.__i]=n,z(o,n,c),n.__e!=s&&C(n)));preact_module_$.__r=0}function I(e,t,r,n,i,a,s,o,l,c,d){var u,h,f,m,g,_,b=n&&n.__k||v,y=t.length;for(l=P(r,t,b,l,y),u=0;u<y;u++)null!=(f=r.__k[u])&&(h=-1===f.__i?p:b[f.__i]||p,f.__i=u,_=O(e,f,h,i,a,s,o,l,c,d),m=f.__e,f.ref&&h.ref!=f.ref&&(h.ref&&q(h.ref,null,f),d.push(f.ref,f.__c||m,f)),null==g&&null!=m&&(g=m),4&f.__u||h.__k===f.__k?l=A(f,l,e):"function"==typeof f.type&&void 0!==_?l=_:m&&(l=m.nextSibling),f.__u&=-7);return r.__e=g,l}function P(e,t,r,n,i){var a,s,o,l,c,u=r.length,p=u,h=0;for(e.__k=new Array(i),a=0;a<i;a++)null!=(s=t[a])&&"boolean"!=typeof s&&"function"!=typeof s?(l=a+h,(s=e.__k[a]="string"==typeof s||"number"==typeof s||"bigint"==typeof s||s.constructor==String?m(null,s,null,null,null):d(s)?m(k,{children:s},null,null,null):void 0===s.constructor&&s.__b>0?m(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):s).__=e,s.__b=e.__b+1,o=null,-1!==(c=s.__i=L(s,r,l,p))&&(p--,(o=r[c])&&(o.__u|=2)),null==o||null===o.__v?(-1==c&&(i>u?h--:i<u&&h++),"function"!=typeof s.type&&(s.__u|=4)):c!=l&&(c==l-1?h--:c==l+1?h++:(c>l?h--:h++,s.__u|=4))):e.__k[a]=null;if(p)for(a=0;a<u;a++)null!=(o=r[a])&&!(2&o.__u)&&(o.__e==n&&(n=S(o)),B(o,o));return n}function A(e,t,r){var n,i;if("function"==typeof e.type){for(n=e.__k,i=0;n&&i<n.length;i++)n[i]&&(n[i].__=e,t=A(n[i],t,r));return t}e.__e!=t&&(t&&e.type&&!r.contains(t)&&(t=S(e)),r.insertBefore(e.__e,t||null),t=e.__e);do{t=t&&t.nextSibling}while(null!=t&&8==t.nodeType);return t}function H(e,t){return t=t||[],null==e||"boolean"==typeof e||(d(e)?e.some((function(e){H(e,t)})):t.push(e)),t}function L(e,t,r,n){var i,a,s=e.key,o=e.type,l=t[r];if(null===l&&null==e.key||l&&s==l.key&&o===l.type&&!(2&l.__u))return r;if(n>(null==l||2&l.__u?0:1))for(i=r-1,a=r+1;i>=0||a<t.length;){if(i>=0){if((l=t[i])&&!(2&l.__u)&&s==l.key&&o===l.type)return i;i--}if(a<t.length){if((l=t[a])&&!(2&l.__u)&&s==l.key&&o===l.type)return a;a++}}return-1}function T(e,t,r){"-"==t[0]?e.setProperty(t,null==r?"":r):e[t]=null==r?"":"number"!=typeof r||y.test(t)?r:r+"px"}function j(e,t,r,n,i){var o;e:if("style"==t)if("string"==typeof r)e.style.cssText=r;else{if("string"==typeof n&&(e.style.cssText=n=""),n)for(t in n)r&&t in r||T(e.style,t,"");if(r)for(t in r)n&&r[t]===n[t]||T(e.style,t,r[t])}else if("o"==t[0]&&"n"==t[1])o=t!=(t=t.replace(f,"$1")),t=t.toLowerCase()in e||"onFocusOut"==t||"onFocusIn"==t?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=r,r?n?r.t=n.t:(r.t=c,e.addEventListener(t,o?a:s,o)):e.removeEventListener(t,o?a:s,o);else{if("http://www.w3.org/2000/svg"==i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&"popover"!=t&&t in e)try{e[t]=null==r?"":r;break e}catch(e){}"function"==typeof r||(null==r||!1===r&&"-"!=t[4]?e.removeAttribute(t):e.setAttribute(t,"popover"==t&&1==r?"":r))}}function F(e){return function(t){if(this.l){var r=this.l[t.type+e];if(null==t.u)t.u=c++;else if(t.u<r.t)return;return r(l.event?l.event(t):t)}}}function O(e,t,r,n,i,a,s,o,c,u){var p,h,f,m,_,b,v,y,E,S,T,C,A,L,P,O,R,B=t.type;if(void 0!==t.constructor)return null;128&r.__u&&(c=!!(32&r.__u),a=[o=t.__e=r.__e]),(p=l.__b)&&p(t);e:if("function"==typeof B)try{if(y=t.props,E="prototype"in B&&B.prototype.render,S=(p=B.contextType)&&n[p.__c],T=p?S?S.props.value:p.__:n,r.__c?v=(h=t.__c=r.__c).__=h.__E:(E?t.__c=h=new B(y,T):(t.__c=h=new x(y,T),h.constructor=B,h.render=D),S&&S.sub(h),h.props=y,h.state||(h.state={}),h.context=T,h.__n=n,f=h.__d=!0,h.__h=[],h._sb=[]),E&&null==h.__s&&(h.__s=h.state),E&&null!=B.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=w({},h.__s)),w(h.__s,B.getDerivedStateFromProps(y,h.__s))),m=h.props,_=h.state,h.__v=t,f)E&&null==B.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),E&&null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(E&&null==B.getDerivedStateFromProps&&y!==m&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(y,T),!h.__e&&(null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(y,h.__s,T)||t.__v==r.__v)){for(t.__v!=r.__v&&(h.props=y,h.state=h.__s,h.__d=!1),t.__e=r.__e,t.__k=r.__k,t.__k.some((function(e){e&&(e.__=t)})),C=0;C<h._sb.length;C++)h.__h.push(h._sb[C]);h._sb=[],h.__h.length&&s.push(h);break e}null!=h.componentWillUpdate&&h.componentWillUpdate(y,h.__s,T),E&&null!=h.componentDidUpdate&&h.__h.push((function(){h.componentDidUpdate(m,_,b)}))}if(h.context=T,h.props=y,h.__P=e,h.__e=!1,A=l.__r,L=0,E){for(h.state=h.__s,h.__d=!1,A&&A(t),p=h.render(h.props,h.state,h.context),P=0;P<h._sb.length;P++)h.__h.push(h._sb[P]);h._sb=[]}else do{h.__d=!1,A&&A(t),p=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++L<25);h.state=h.__s,null!=h.getChildContext&&(n=w(w({},n),h.getChildContext())),E&&!f&&null!=h.getSnapshotBeforeUpdate&&(b=h.getSnapshotBeforeUpdate(m,_)),O=p,null!=p&&p.type===k&&null==p.key&&(O=N(p.props.children)),o=I(e,d(O)?O:[O],t,r,n,i,a,s,o,c,u),h.base=t.__e,t.__u&=-161,h.__h.length&&s.push(h),v&&(h.__E=h.__=null)}catch(e){if(t.__v=null,c||null!=a)if(e.then){for(t.__u|=c?160:128;o&&8==o.nodeType&&o.nextSibling;)o=o.nextSibling;a[a.indexOf(o)]=null,t.__e=o}else for(R=a.length;R--;)g(a[R]);else t.__e=r.__e,t.__k=r.__k;l.__e(e,t,r)}else null==a&&t.__v==r.__v?(t.__k=r.__k,t.__e=r.__e):o=t.__e=V(r.__e,t,r,n,i,a,s,c,u);return(p=l.diffed)&&p(t),128&t.__u?void 0:o}function z(e,t,r){for(var n=0;n<r.length;n++)q(r[n],r[++n],r[++n]);l.__c&&l.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){l.__e(e,t.__v)}}))}function N(e){return"object"!=typeof e||null==e?e:d(e)?e.map(N):w({},e)}function V(e,t,r,i,a,s,o,c,u){var h,f,m,_,b,v,y,w=r.props,E=t.props,T=t.type;if("svg"==T?a="http://www.w3.org/2000/svg":"math"==T?a="http://www.w3.org/1998/Math/MathML":a||(a="http://www.w3.org/1999/xhtml"),null!=s)for(h=0;h<s.length;h++)if((b=s[h])&&"setAttribute"in b==!!T&&(T?b.localName==T:3==b.nodeType)){e=b,s[h]=null;break}if(null==e){if(null==T)return document.createTextNode(E);e=document.createElementNS(a,T,E.is&&E),c&&(l.__m&&l.__m(t,s),c=!1),s=null}if(null===T)w===E||c&&e.data===E||(e.data=E);else{if(s=s&&n.call(e.childNodes),w=r.props||p,!c&&null!=s)for(w={},h=0;h<e.attributes.length;h++)w[(b=e.attributes[h]).name]=b.value;for(h in w)if(b=w[h],"children"==h);else if("dangerouslySetInnerHTML"==h)m=b;else if(!(h in E)){if("value"==h&&"defaultValue"in E||"checked"==h&&"defaultChecked"in E)continue;j(e,h,null,b,a)}for(h in E)b=E[h],"children"==h?_=b:"dangerouslySetInnerHTML"==h?f=b:"value"==h?v=b:"checked"==h?y=b:c&&"function"!=typeof b||w[h]===b||j(e,h,b,w[h],a);if(f)c||m&&(f.__html===m.__html||f.__html===e.innerHTML)||(e.innerHTML=f.__html),t.__k=[];else if(m&&(e.innerHTML=""),I("template"===t.type?e.content:e,d(_)?_:[_],t,r,i,"foreignObject"==T?"http://www.w3.org/1999/xhtml":a,s,o,s?s[0]:r.__k&&S(r,0),c,u),null!=s)for(h=s.length;h--;)g(s[h]);c||(h="value","progress"==T&&null==v?e.removeAttribute("value"):void 0!==v&&(v!==e[h]||"progress"==T&&!v||"option"==T&&v!==w[h])&&j(e,h,v,w[h],a),h="checked",void 0!==y&&y!==e[h]&&j(e,h,y,w[h],a))}return e}function q(e,t,r){try{if("function"==typeof e){var n="function"==typeof e.__u;n&&e.__u(),n&&null==t||(e.__u=e(t))}else e.current=t}catch(e){l.__e(e,r)}}function B(e,t,r){var n,i;if(l.unmount&&l.unmount(e),(n=e.ref)&&(n.current&&n.current!==e.__e||q(n,null,t)),null!=(n=e.__c)){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(e){l.__e(e,t)}n.base=n.__P=null}if(n=e.__k)for(i=0;i<n.length;i++)n[i]&&B(n[i],t,r||"function"!=typeof e.type);r||g(e.__e),e.__c=e.__=e.__e=void 0}function D(e,t,r){return this.constructor(e,r)}function E(e,t,r){var i,a,s,o;t==document&&(t=document.documentElement),l.__&&l.__(e,t),a=(i="function"==typeof r)?null:r&&r.__k||t.__k,s=[],o=[],O(t,e=(!i&&r||t).__k=_(k,null,[e]),a||p,p,t.namespaceURI,!i&&r?[r]:a?null:t.firstChild?n.call(t.childNodes):null,s,!i&&r?r:a?a.__e:t.firstChild,i,o),z(s,e,o)}function G(e,t){E(e,t,G)}function J(e,t,r){var i,a,s,o,l=w({},e.props);for(s in e.type&&e.type.defaultProps&&(o=e.type.defaultProps),t)"key"==s?i=t[s]:"ref"==s?a=t[s]:l[s]=void 0===t[s]&&void 0!==o?o[s]:t[s];return arguments.length>2&&(l.children=arguments.length>3?n.call(arguments,2):r),m(e.type,l,i||e.key,a||e.ref,null)}function K(e){function t(e){var r,n;return this.getChildContext||(r=new Set,(n={})[t.__c]=this,this.getChildContext=function(){return n},this.componentWillUnmount=function(){r=null},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&r.forEach((function(e){e.__e=!0,M(e)}))},this.sub=function(e){r.add(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){r&&r.delete(e),t&&t.call(e)}}),e.children}return t.__c="__cC"+preact_module_h++,t.__=e,t.Provider=t.__l=(t.Consumer=function(e,t){return e.children(t)}).contextType=t,t}function isDOMElement(e){return"object"==typeof e&&null!==e&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE}function findDOMElement(e,t){return void 0===t&&(t=document),"string"==typeof e?t.querySelector(e):isDOMElement(e)?e:null}n=v.slice,l={__e:function(e,t,r,n){for(var i,a,s;t=t.__;)if((i=t.__c)&&!i.__)try{if((a=i.constructor)&&null!=a.getDerivedStateFromError&&(i.setState(a.getDerivedStateFromError(e)),s=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e,n||{}),s=i.__d),s)return i.__E=i}catch(t){e=t}throw e}},t=0,u=function(e){return null!=e&&null==e.constructor},x.prototype.setState=function(e,t){var r;r=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=w({},this.state),"function"==typeof e&&(e=e(w({},r),this.props)),e&&w(r,e),null!=e&&this.__v&&(t&&this._sb.push(t),M(this))},x.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),M(this))},x.prototype.render=k,i=[],o="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,e=function(e,t){return e.__v.__b-t.__v.__b},preact_module_$.__r=0,f=/(PointerCapture)$|Capture$/i,c=0,s=F(!1),a=F(!0),preact_module_h=0;const lib_findDOMElement=findDOMElement;function getTextDirection(e){for(var t;e&&!e.dir;)e=e.parentNode;return null==(t=e)?void 0:t.dir}const lib_getTextDirection=getTextDirection;class BasePlugin{constructor(e,t){this.uppy=e,this.opts=null!=t?t:{}}getPluginState(){const{plugins:e}=this.uppy.getState();return(null==e?void 0:e[this.id])||{}}setPluginState(e){const{plugins:t}=this.uppy.getState();this.uppy.setState({plugins:{...t,[this.id]:{...t[this.id],...e}}})}setOptions(e){this.opts={...this.opts,...e},this.setPluginState(void 0),this.i18nInit()}i18nInit(){const e=new Translator([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState(void 0)}addTarget(e){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}update(e){}afterUpdate(){}}function UIPlugin_classPrivateFieldLooseBase(e,t){if(!{}.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var UIPlugin_id=0;function UIPlugin_classPrivateFieldLooseKey(e){return"__private_"+UIPlugin_id+++"_"+e}function UIPlugin_debounce(e){let t,r=null;return function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=i,r||(r=Promise.resolve().then((()=>(r=null,e(...t))))),r}}var _updateUI=UIPlugin_classPrivateFieldLooseKey("updateUI");class UIPlugin extends BasePlugin{constructor(){super(...arguments),Object.defineProperty(this,_updateUI,{writable:!0,value:void 0})}getTargetPlugin(e){let t;if("function"==typeof(null==e?void 0:e.addTarget))t=e,t instanceof UIPlugin||console.warn(new Error("The provided plugin is not an instance of UIPlugin. This is an indication of a bug with the way Uppy is bundled.",{cause:{targetPlugin:t,UIPlugin}}));else if("function"==typeof e){const r=e;this.uppy.iteratePlugins((e=>{e instanceof r&&(t=e)}))}return t}mount(e,t){const r=t.id,n=lib_findDOMElement(e);if(n){this.isTargetDOMEl=!0;const t=document.createElement("div");return t.classList.add("uppy-Root"),UIPlugin_classPrivateFieldLooseBase(this,_updateUI)[_updateUI]=UIPlugin_debounce((e=>{this.uppy.getPlugin(this.id)&&(E(this.render(e,t),t),this.afterUpdate())})),this.uppy.log(`Installing ${r} to a DOM element '${e}'`),this.opts.replaceTargetContent&&(n.innerHTML=""),E(this.render(this.uppy.getState(),t),t),this.el=t,n.appendChild(t),t.dir=this.opts.direction||lib_getTextDirection(t)||"ltr",this.onMount(),this.el}const i=this.getTargetPlugin(e);if(i)return this.uppy.log(`Installing ${r} to ${i.id}`),this.parent=i,this.el=i.addTarget(t),this.onMount(),this.el;this.uppy.log(`Not installing ${r}`);let a=`Invalid target option given to ${r}.`;throw a+="function"==typeof e?" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":"If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(a)}render(e,t){throw new Error("Extend the render method to add your plugin to a DOM element")}update(e){var t,r;null!=this.el&&(null==(t=(r=UIPlugin_classPrivateFieldLooseBase(this,_updateUI))[_updateUI])||t.call(r,e))}unmount(){var e;this.isTargetDOMEl&&(null==(e=this.el)||e.remove()),this.onUnmount()}onMount(){}onUnmount(){}}const lib_UIPlugin=UIPlugin;function emaFilter(e,t,r,n){return 0===r||e===t?e:0===n?t:e+(t-e)*2**(-n/r)}const StatusBarStates={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete"};var classnames=__webpack_require__(6942);function calculateProcessingProgress(e){const t=[];let r,n="indeterminate";for(const{progress:i}of Object.values(e)){const{preprocess:e,postprocess:a}=i;null==r&&(e||a)&&({mode:n,message:r}=e||a),"determinate"===(null==e?void 0:e.mode)&&t.push(e.value),"determinate"===(null==a?void 0:a.mode)&&t.push(a.value)}return{mode:n,message:r,value:t.reduce(((e,r)=>e+r/t.length),0)}}function secondsToTime(e){return{hours:Math.floor(e/3600)%24,minutes:Math.floor(e/60)%60,seconds:Math.floor(e%60)}}function prettyETA(e){const t=secondsToTime(e);return`${0===t.hours?"":`${t.hours}h`}${0===t.minutes?"":`${0===t.hours?t.minutes:` ${t.minutes.toString(10).padStart(2,"0")}`}m`}${0!==t.hours?"":`${0===t.minutes?t.seconds:` ${t.seconds.toString(10).padStart(2,"0")}`}s`}`}const DOT="Â·",renderDot=()=>` ${DOT} `;function UploadBtn(e){const{newFiles:t,isUploadStarted:r,recoveredState:n,i18n:i,uploadState:a,isSomeGhost:s,startUpload:o}=e,l=classnames("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":a===StatusBarStates.STATE_WAITING},{"uppy-StatusBar-actionBtn--disabled":s}),c=i(t&&r&&!n?"uploadXNewFiles":"uploadXFiles",{smart_count:t});return _("button",{type:"button",className:l,"aria-label":i("uploadXFiles",{smart_count:t}),onClick:o,disabled:s,"data-uppy-super-focusable":!0},c)}function RetryBtn(e){const{i18n:t,uppy:r}=e;return _("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":t("retryUpload"),onClick:()=>r.retryAll().catch((()=>{})),"data-uppy-super-focusable":!0,"data-cy":"retry"},_("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"8",height:"10",viewBox:"0 0 8 10"},_("path",{d:"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z"})),t("retry"))}function CancelBtn(e){const{i18n:t,uppy:r}=e;return _("button",{type:"button",className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:t("cancel"),"aria-label":t("cancel"),onClick:()=>r.cancelAll(),"data-cy":"cancel","data-uppy-super-focusable":!0},_("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},_("g",{fill:"none",fillRule:"evenodd"},_("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),_("path",{fill:"#FFF",d:"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z"}))))}function PauseResumeButton(e){const{isAllPaused:t,i18n:r,isAllComplete:n,resumableUploads:i,uppy:a}=e,s=r(t?"resume":"pause");return _("button",{title:s,"aria-label":s,className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onClick:function(){n||(i?t?a.resumeAll():a.pauseAll():a.cancelAll())},"data-cy":"togglePauseResume","data-uppy-super-focusable":!0},_("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},_("g",{fill:"none",fillRule:"evenodd"},_("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),_("path",{fill:"#FFF",d:t?"M6 4.25L11.5 8 6 11.75z":"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z"}))))}function DoneBtn(e){const{i18n:t,doneButtonHandler:r}=e;return _("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done",onClick:r,"data-uppy-super-focusable":!0},t("done"))}function LoadingSpinner(){return _("svg",{className:"uppy-StatusBar-spinner","aria-hidden":"true",focusable:"false",width:"14",height:"14"},_("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0",fillRule:"evenodd"}))}function ProgressBarProcessing(e){const{progress:t}=e,{value:r,mode:n,message:i}=t;return _("div",{className:"uppy-StatusBar-content"},_(LoadingSpinner,null),"determinate"===n?`${Math.round(100*r)}% Â· `:"",i)}function ProgressDetails(e){const{numUploads:t,complete:r,totalUploadedSize:n,totalSize:i,totalETA:a,i18n:s}=e,o=t>1,l=prettierBytes(n);return _("div",{className:"uppy-StatusBar-statusSecondary"},o&&s("filesUploadedOfTotal",{complete:r,smart_count:t}),_("span",{className:"uppy-StatusBar-additionalInfo"},o&&renderDot(),null!=i?s("dataUploadedOfTotal",{complete:l,total:prettierBytes(i)}):s("dataUploadedOfUnknown",{complete:l}),renderDot(),null!=a&&s("xTimeLeft",{time:prettyETA(a)})))}function FileUploadCount(e){const{i18n:t,complete:r,numUploads:n}=e;return _("div",{className:"uppy-StatusBar-statusSecondary"},t("filesUploadedOfTotal",{complete:r,smart_count:n}))}function UploadNewlyAddedFiles(e){const{i18n:t,newFiles:r,startUpload:n}=e,i=classnames("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--uploadNewlyAdded");return _("div",{className:"uppy-StatusBar-statusSecondary"},_("div",{className:"uppy-StatusBar-statusSecondaryHint"},t("xMoreFilesAdded",{smart_count:r})),_("button",{type:"button",className:i,"aria-label":t("uploadXFiles",{smart_count:r}),onClick:n},t("upload")))}function ProgressBarUploading(e){const{i18n:t,supportsUploadProgress:r,totalProgress:n,showProgressDetails:i,isUploadStarted:a,isAllComplete:s,isAllPaused:o,newFiles:l,numUploads:c,complete:d,totalUploadedSize:u,totalSize:p,totalETA:h,startUpload:f}=e,m=l&&a;if(!a||s)return null;const g=t(o?"paused":"uploading");return _("div",{className:"uppy-StatusBar-content","aria-label":g,title:g},o?null:_(LoadingSpinner,null),_("div",{className:"uppy-StatusBar-status"},_("div",{className:"uppy-StatusBar-statusPrimary"},r&&0!==n?`${g}: ${n}%`:g),o||m||!i?null:r?_(ProgressDetails,{numUploads:c,complete:d,totalUploadedSize:u,totalSize:p,totalETA:h,i18n:t}):_(FileUploadCount,{i18n:t,complete:d,numUploads:c}),m?_(UploadNewlyAddedFiles,{i18n:t,newFiles:l,startUpload:f}):null))}function ProgressBarComplete(e){const{i18n:t}=e;return _("div",{className:"uppy-StatusBar-content",role:"status",title:t("complete")},_("div",{className:"uppy-StatusBar-status"},_("div",{className:"uppy-StatusBar-statusPrimary"},_("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"15",height:"11",viewBox:"0 0 15 11"},_("path",{d:"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z"})),t("complete"))))}function ProgressBarError(e){const{error:t,i18n:r,complete:n,numUploads:i}=e;return _("div",{className:"uppy-StatusBar-content",title:r("uploadFailed")},_("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"11",height:"11",viewBox:"0 0 11 11"},_("path",{d:"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z"})),_("div",{className:"uppy-StatusBar-status"},_("div",{className:"uppy-StatusBar-statusPrimary"},r("uploadFailed"),_("button",{className:"uppy-u-reset uppy-StatusBar-details","aria-label":r("showErrorDetails"),"data-microtip-position":"top-right","data-microtip-size":"medium",onClick:function(){const e=`${r("uploadFailed")} \n\n ${t}`;alert(e)},type:"button"},"?")),_(FileUploadCount,{i18n:r,complete:n,numUploads:i})))}const{STATE_ERROR,STATE_WAITING,STATE_PREPROCESSING,STATE_UPLOADING,STATE_POSTPROCESSING,STATE_COMPLETE}=StatusBarStates;function StatusBarUI(e){let{newFiles:t,allowNewUpload:r,isUploadInProgress:n,isAllPaused:i,resumableUploads:a,error:s,hideUploadButton:o,hidePauseResumeButton:l=!1,hideCancelButton:c=!1,hideRetryButton:d=!1,recoveredState:u,uploadState:p,totalProgress:h,files:f,supportsUploadProgress:m,hideAfterFinish:g=!1,isSomeGhost:b,doneButtonHandler:v,isUploadStarted:y,i18n:w,startUpload:E,uppy:S,isAllComplete:T,showProgressDetails:C,numUploads:x,complete:A,totalSize:I,totalETA:D,totalUploadedSize:k}=e;const L=function(){switch(p){case STATE_POSTPROCESSING:case STATE_PREPROCESSING:{const e=calculateProcessingProgress(f);return"determinate"===e.mode?100*e.value:h}case STATE_ERROR:return null;case STATE_UPLOADING:return m?h:null;default:return h}}(),P=null!=L?L:100,O=!s&&t&&(!n&&!i||u)&&r&&!o,R=!c&&p!==STATE_WAITING&&p!==STATE_COMPLETE,N=a&&!l&&p===STATE_UPLOADING,B=s&&!T&&!d,F=v&&p===STATE_COMPLETE,U=classnames("uppy-StatusBar-progress",{"is-indeterminate":function(){switch(p){case STATE_POSTPROCESSING:case STATE_PREPROCESSING:{const{mode:e}=calculateProcessingProgress(f);return"indeterminate"===e}case STATE_UPLOADING:return!m;default:return!1}}()}),M=classnames("uppy-StatusBar",`is-${p}`,{"has-ghosts":b}),q=(()=>{switch(p){case STATE_PREPROCESSING:case STATE_POSTPROCESSING:return _(ProgressBarProcessing,{progress:calculateProcessingProgress(f)});case STATE_COMPLETE:return _(ProgressBarComplete,{i18n:w});case STATE_ERROR:return _(ProgressBarError,{error:s,i18n:w,numUploads:x,complete:A});case STATE_UPLOADING:return _(ProgressBarUploading,{i18n:w,supportsUploadProgress:m,totalProgress:h,showProgressDetails:C,isUploadStarted:y,isAllComplete:T,isAllPaused:i,newFiles:t,numUploads:x,complete:A,totalUploadedSize:k,totalSize:I,totalETA:D,startUpload:E});default:return null}})();return!(O||B||N||R||F)&&!q||p===STATE_COMPLETE&&g?null:_("div",{className:M},_("div",{className:U,style:{width:`${P}%`},role:"progressbar","aria-label":`${P}%`,"aria-valuetext":`${P}%`,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":L}),q,_("div",{className:"uppy-StatusBar-actions"},O?_(UploadBtn,{newFiles:t,isUploadStarted:y,recoveredState:u,i18n:w,isSomeGhost:b,startUpload:E,uploadState:p}):null,B?_(RetryBtn,{i18n:w,uppy:S}):null,N?_(PauseResumeButton,{isAllPaused:i,i18n:w,isAllComplete:T,resumableUploads:a,uppy:S}):null,R?_(CancelBtn,{i18n:w,uppy:S}):null,F?_(DoneBtn,{i18n:w,doneButtonHandler:v}):null))}const lib_locale={strings:{uploading:"Uploading",complete:"Complete",uploadFailed:"Upload failed",paused:"Paused",retry:"Retry",cancel:"Cancel",pause:"Pause",resume:"Resume",done:"Done",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",dataUploadedOfUnknown:"%{complete} of unknown",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},upload:"Upload",retryUpload:"Retry upload",xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"},showErrorDetails:"Show error details"}};function StatusBar_classPrivateFieldLooseBase(e,t){if(!{}.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var StatusBar_id=0;function StatusBar_classPrivateFieldLooseKey(e){return"__private_"+StatusBar_id+++"_"+e}const StatusBar_packageJson={version:"4.1.2"},speedFilterHalfLife=2e3,ETAFilterHalfLife=2e3;function getUploadingState(e,t,r,n){if(e)return StatusBarStates.STATE_ERROR;if(t)return StatusBarStates.STATE_COMPLETE;if(r)return StatusBarStates.STATE_WAITING;let i=StatusBarStates.STATE_WAITING;const a=Object.keys(n);for(let e=0;e<a.length;e++){const{progress:t}=n[a[e]];if(t.uploadStarted&&!t.uploadComplete)return StatusBarStates.STATE_UPLOADING;t.preprocess&&(i=StatusBarStates.STATE_PREPROCESSING),t.postprocess&&i!==StatusBarStates.STATE_PREPROCESSING&&(i=StatusBarStates.STATE_POSTPROCESSING)}return i}const defaultOptions={hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showProgressDetails:!1,hideAfterFinish:!0,doneButtonHandler:null};var _lastUpdateTime=StatusBar_classPrivateFieldLooseKey("lastUpdateTime"),_previousUploadedBytes=StatusBar_classPrivateFieldLooseKey("previousUploadedBytes"),_previousSpeed=StatusBar_classPrivateFieldLooseKey("previousSpeed"),_previousETA=StatusBar_classPrivateFieldLooseKey("previousETA"),_computeSmoothETA=StatusBar_classPrivateFieldLooseKey("computeSmoothETA"),_onUploadStart=StatusBar_classPrivateFieldLooseKey("onUploadStart");class StatusBar extends lib_UIPlugin{constructor(e,t){super(e,{...defaultOptions,...t}),Object.defineProperty(this,_computeSmoothETA,{value:_computeSmoothETA2}),Object.defineProperty(this,_lastUpdateTime,{writable:!0,value:void 0}),Object.defineProperty(this,_previousUploadedBytes,{writable:!0,value:void 0}),Object.defineProperty(this,_previousSpeed,{writable:!0,value:void 0}),Object.defineProperty(this,_previousETA,{writable:!0,value:void 0}),this.startUpload=()=>this.uppy.upload().catch((()=>{})),Object.defineProperty(this,_onUploadStart,{writable:!0,value:()=>{const{recoveredState:e}=this.uppy.getState();if(StatusBar_classPrivateFieldLooseBase(this,_previousSpeed)[_previousSpeed]=null,StatusBar_classPrivateFieldLooseBase(this,_previousETA)[_previousETA]=null,e)return StatusBar_classPrivateFieldLooseBase(this,_previousUploadedBytes)[_previousUploadedBytes]=Object.values(e.files).reduce(((e,t)=>{let{progress:r}=t;return e+r.bytesUploaded}),0),void this.uppy.emit("restore-confirmed");StatusBar_classPrivateFieldLooseBase(this,_lastUpdateTime)[_lastUpdateTime]=performance.now(),StatusBar_classPrivateFieldLooseBase(this,_previousUploadedBytes)[_previousUploadedBytes]=0}}),this.id=this.opts.id||"StatusBar",this.title="StatusBar",this.type="progressindicator",this.defaultLocale=lib_locale,this.i18nInit(),this.render=this.render.bind(this),this.install=this.install.bind(this)}render(e){const{capabilities:t,files:r,allowNewUpload:n,totalProgress:i,error:a,recoveredState:s}=e,{newFiles:o,startedFiles:l,completeFiles:c,isUploadStarted:d,isAllComplete:u,isAllPaused:p,isUploadInProgress:h,isSomeGhost:f}=this.uppy.getObjectOfFilesPerState(),m=s?Object.values(r):o,g=!!t.resumableUploads,_=!1!==t.uploadProgress;let b=null,v=0;l.every((e=>null!=e.progress.bytesTotal&&0!==e.progress.bytesTotal))?(b=0,l.forEach((e=>{b+=e.progress.bytesTotal||0,v+=e.progress.bytesUploaded||0}))):l.forEach((e=>{v+=e.progress.bytesUploaded||0}));const y=StatusBar_classPrivateFieldLooseBase(this,_computeSmoothETA)[_computeSmoothETA]({uploaded:v,total:b});return StatusBarUI({error:a,uploadState:getUploadingState(a,u,s,e.files||{}),allowNewUpload:n,totalProgress:i,totalSize:b,totalUploadedSize:v,isAllComplete:!1,isAllPaused:p,isUploadStarted:d,isUploadInProgress:h,isSomeGhost:f,recoveredState:s,complete:c.length,newFiles:m.length,numUploads:l.length,totalETA:y,files:r,i18n:this.i18n,uppy:this.uppy,startUpload:this.startUpload,doneButtonHandler:this.opts.doneButtonHandler,resumableUploads:g,supportsUploadProgress:_,showProgressDetails:this.opts.showProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideAfterFinish:this.opts.hideAfterFinish})}onMount(){const e=this.el;lib_getTextDirection(e)||(e.dir="ltr")}install(){const{target:e}=this.opts;e&&this.mount(e,this),this.uppy.on("upload",StatusBar_classPrivateFieldLooseBase(this,_onUploadStart)[_onUploadStart]),StatusBar_classPrivateFieldLooseBase(this,_lastUpdateTime)[_lastUpdateTime]=performance.now(),StatusBar_classPrivateFieldLooseBase(this,_previousUploadedBytes)[_previousUploadedBytes]=this.uppy.getFiles().reduce(((e,t)=>e+t.progress.bytesUploaded),0)}uninstall(){this.unmount(),this.uppy.off("upload",StatusBar_classPrivateFieldLooseBase(this,_onUploadStart)[_onUploadStart])}}function _computeSmoothETA2(e){var t;if(null==e.total||0===e.total)return null;const r=e.total-e.uploaded;if(r<=0)return null;null!=(t=StatusBar_classPrivateFieldLooseBase(this,_lastUpdateTime))[_lastUpdateTime]||(t[_lastUpdateTime]=performance.now());const n=performance.now()-StatusBar_classPrivateFieldLooseBase(this,_lastUpdateTime)[_lastUpdateTime];var i;if(0===n)return Math.round((null!=(i=StatusBar_classPrivateFieldLooseBase(this,_previousETA)[_previousETA])?i:0)/100)/10;const a=e.uploaded-StatusBar_classPrivateFieldLooseBase(this,_previousUploadedBytes)[_previousUploadedBytes];var s;if(StatusBar_classPrivateFieldLooseBase(this,_previousUploadedBytes)[_previousUploadedBytes]=e.uploaded,a<=0)return Math.round((null!=(s=StatusBar_classPrivateFieldLooseBase(this,_previousETA)[_previousETA])?s:0)/100)/10;const o=a/n,l=null==StatusBar_classPrivateFieldLooseBase(this,_previousSpeed)[_previousSpeed]?o:emaFilter(o,StatusBar_classPrivateFieldLooseBase(this,_previousSpeed)[_previousSpeed],speedFilterHalfLife,n);StatusBar_classPrivateFieldLooseBase(this,_previousSpeed)[_previousSpeed]=l;const c=r/l,d=Math.max(StatusBar_classPrivateFieldLooseBase(this,_previousETA)[_previousETA]-n,0),u=null==StatusBar_classPrivateFieldLooseBase(this,_previousETA)[_previousETA]?c:emaFilter(c,d,ETAFilterHalfLife,n);return StatusBar_classPrivateFieldLooseBase(this,_previousETA)[_previousETA]=u,StatusBar_classPrivateFieldLooseBase(this,_lastUpdateTime)[_lastUpdateTime]=performance.now(),Math.round(u/100)/10}StatusBar.VERSION=StatusBar_packageJson.version;const TRANSITION_MS=300;class FadeIn extends x{constructor(){super(...arguments),this.ref=b()}componentWillEnter(e){this.ref.current.style.opacity="1",this.ref.current.style.transform="none",setTimeout(e,TRANSITION_MS)}componentWillLeave(e){this.ref.current.style.opacity="0",this.ref.current.style.transform="translateY(350%)",setTimeout(e,TRANSITION_MS)}render(){const{children:e}=this.props;return _("div",{className:"uppy-Informer-animated",ref:this.ref},e)}}function TransitionGroup_assign(e,t){return Object.assign(e,t)}function getKey(e,t){var r;return null!=(r=null==e?void 0:e.key)?r:t}function linkRef(e,t){const r=e._ptgLinkedRefs||(e._ptgLinkedRefs={});return r[t]||(r[t]=r=>{e.refs[t]=r})}function getChildMapping(e){const t={};for(let r=0;r<e.length;r++)null!=e[r]&&(t[getKey(e[r],r.toString(36))]=e[r]);return t}function mergeChildMappings(e,t){e=e||{},t=t||{};const r=r=>t.hasOwnProperty(r)?t[r]:e[r],n={};let i=[];for(const r in e)t.hasOwnProperty(r)?i.length&&(n[r]=i,i=[]):i.push(r);const a={};for(const e in t){if(n.hasOwnProperty(e))for(let t=0;t<n[e].length;t++){const i=n[e][t];a[n[e][t]]=r(i)}a[e]=r(e)}for(let e=0;e<i.length;e++)a[i[e]]=r(i[e]);return a}const identity=e=>e;class TransitionGroup extends x{constructor(e,t){super(e,t),this.refs={},this.state={children:getChildMapping(H(H(this.props.children))||[])},this.performAppear=this.performAppear.bind(this),this.performEnter=this.performEnter.bind(this),this.performLeave=this.performLeave.bind(this)}componentWillMount(){this.currentlyTransitioningKeys={},this.keysToAbortLeave=[],this.keysToEnter=[],this.keysToLeave=[]}componentDidMount(){const e=this.state.children;for(const t in e)e[t]&&this.performAppear(t)}componentWillReceiveProps(e){const t=getChildMapping(H(e.children)||[]),r=this.state.children;let n;for(n in this.setState((e=>({children:mergeChildMappings(e.children,t)}))),t)if(t.hasOwnProperty(n)){const e=r&&r.hasOwnProperty(n);t[n]&&e&&this.currentlyTransitioningKeys[n]?(this.keysToEnter.push(n),this.keysToAbortLeave.push(n)):!t[n]||e||this.currentlyTransitioningKeys[n]||this.keysToEnter.push(n)}for(n in r)if(r.hasOwnProperty(n)){const e=t&&t.hasOwnProperty(n);!r[n]||e||this.currentlyTransitioningKeys[n]||this.keysToLeave.push(n)}}componentDidUpdate(){const{keysToEnter:e}=this;this.keysToEnter=[],e.forEach(this.performEnter);const{keysToLeave:t}=this;this.keysToLeave=[],t.forEach(this.performLeave)}_finishAbort(e){const t=this.keysToAbortLeave.indexOf(e);-1!==t&&this.keysToAbortLeave.splice(t,1)}performAppear(e){this.currentlyTransitioningKeys[e]=!0;const t=this.refs[e];null!=t&&t.componentWillAppear?t.componentWillAppear(this._handleDoneAppearing.bind(this,e)):this._handleDoneAppearing(e)}_handleDoneAppearing(e){const t=this.refs[e];null!=t&&t.componentDidAppear&&t.componentDidAppear(),delete this.currentlyTransitioningKeys[e],this._finishAbort(e);const r=getChildMapping(H(this.props.children)||[]);r&&r.hasOwnProperty(e)||this.performLeave(e)}performEnter(e){this.currentlyTransitioningKeys[e]=!0;const t=this.refs[e];null!=t&&t.componentWillEnter?t.componentWillEnter(this._handleDoneEntering.bind(this,e)):this._handleDoneEntering(e)}_handleDoneEntering(e){const t=this.refs[e];null!=t&&t.componentDidEnter&&t.componentDidEnter(),delete this.currentlyTransitioningKeys[e],this._finishAbort(e);const r=getChildMapping(H(this.props.children)||[]);r&&r.hasOwnProperty(e)||this.performLeave(e)}performLeave(e){if(-1!==this.keysToAbortLeave.indexOf(e))return;this.currentlyTransitioningKeys[e]=!0;const t=this.refs[e];null!=t&&t.componentWillLeave?t.componentWillLeave(this._handleDoneLeaving.bind(this,e)):this._handleDoneLeaving(e)}_handleDoneLeaving(e){if(-1!==this.keysToAbortLeave.indexOf(e))return;const t=this.refs[e];null!=t&&t.componentDidLeave&&t.componentDidLeave(),delete this.currentlyTransitioningKeys[e];const r=getChildMapping(H(this.props.children)||[]);if(r&&r.hasOwnProperty(e))this.performEnter(e);else{const t=TransitionGroup_assign({},this.state.children);delete t[e],this.setState({children:t})}}render(e,t){let{childFactory:r,transitionLeave:n,transitionName:i,transitionAppear:a,transitionEnter:s,transitionLeaveTimeout:o,transitionEnterTimeout:l,transitionAppearTimeout:c,component:d,...u}=e,{children:p}=t;return _(d,u,Object.entries(p).map((e=>{let[t,n]=e;if(!n)return;const i=linkRef(this,t);return J(r(n),{ref:i,key:t})})).filter(Boolean))}}TransitionGroup.defaultProps={component:"span",childFactory:identity};const lib_TransitionGroup=TransitionGroup,Informer_packageJson={version:"4.2.1"};class Informer extends lib_UIPlugin{constructor(e,t){super(e,t),this.render=e=>_("div",{className:"uppy uppy-Informer"},_(lib_TransitionGroup,null,e.info.map((e=>_(FadeIn,{key:e.message},_("p",{role:"alert"},e.message," ",e.details&&_("span",{"aria-label":e.details,"data-microtip-position":"top-left","data-microtip-size":"medium",role:"tooltip",onClick:()=>alert(`${e.message} \n\n ${e.details}`)},"?"))))))),this.type="progressindicator",this.id=this.opts.id||"Informer",this.title="Informer"}install(){const{target:e}=this.opts;e&&this.mount(e,this)}}Informer.VERSION=Informer_packageJson.version;const DATA_URL_PATTERN=/^data:([^/]+\/[^,;]+(?:[^,]*?))(;base64)?,([\s\S]*)$/;function dataURItoBlob(e,t,r){var n,i;const a=DATA_URL_PATTERN.exec(e),s=null!=(n=null!=(i=t.mimeType)?i:null==a?void 0:a[1])?n:"plain/text";let o;if(null!=(null==a?void 0:a[2])){const e=atob(decodeURIComponent(a[3])),t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);o=[t]}else null!=(null==a?void 0:a[3])&&(o=[decodeURIComponent(a[3])]);return r?new File(o,t.name||"",{type:s}):new Blob(o,{type:s})}const lib_dataURItoBlob=dataURItoBlob;function isObjectURL(e){return e.startsWith("blob:")}function isPreviewSupported(e){return!!e&&/^[^/]+\/(jpe?g|gif|png|svg|svg\+xml|bmp|webp|avif)$/.test(e)}function mini_esm_e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var mini_esm_t="undefined"!=typeof self?self:global;const mini_esm_s="undefined"!=typeof navigator,mini_esm_i=mini_esm_s&&"undefined"==typeof HTMLImageElement,mini_esm_n=!("undefined"==typeof global||"undefined"==typeof process||!process.versions||!process.versions.node),mini_esm_r=mini_esm_t.Buffer,mini_esm_a=!!mini_esm_r,mini_esm_h=e=>void 0!==e;function mini_esm_f(e){return void 0===e||(e instanceof Map?0===e.size:0===Object.values(e).filter(mini_esm_h).length)}function mini_esm_l(e){let t=new Error(e);throw delete t.stack,t}function mini_esm_o(e){let t=function(e){let t=0;return e.ifd0.enabled&&(t+=1024),e.exif.enabled&&(t+=2048),e.makerNote&&(t+=2048),e.userComment&&(t+=1024),e.gps.enabled&&(t+=512),e.interop.enabled&&(t+=100),e.ifd1.enabled&&(t+=1024),t+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}const mini_esm_u=e=>String.fromCharCode.apply(null,e),mini_esm_d="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):void 0;class mini_esm_c{static from(e,t){return e instanceof this&&e.le===t?e:new mini_esm_c(e,void 0,void 0,t)}constructor(e,t=0,r,n){if("boolean"==typeof n&&(this.le=n),Array.isArray(e)&&(e=new Uint8Array(e)),0===e)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){void 0===r&&(r=e.byteLength-t);let n=new DataView(e,t,r);this._swapDataView(n)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof mini_esm_c){void 0===r&&(r=e.byteLength-t),(t+=e.byteOffset)+r>e.byteOffset+e.byteLength&&mini_esm_l("Creating view outside of available memory in ArrayBuffer");let n=new DataView(e.buffer,t,r);this._swapDataView(n)}else if("number"==typeof e){let t=new DataView(new ArrayBuffer(e));this._swapDataView(t)}else mini_esm_l("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,r=mini_esm_c){return e instanceof DataView||e instanceof mini_esm_c?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||mini_esm_l("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new r(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new mini_esm_c(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return r=this.getUint8Array(e,t),mini_esm_d?mini_esm_d.decode(r):mini_esm_a?Buffer.from(r).toString("utf8"):decodeURIComponent(escape(mini_esm_u(r)));var r}getLatin1String(e=0,t=this.byteLength){let r=this.getUint8Array(e,t);return mini_esm_u(r)}getUnicodeString(e=0,t=this.byteLength){const r=[];for(let n=0;n<t&&e+n<this.byteLength;n+=2)r.push(this.getUint16(e+n));return mini_esm_u(r)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,r){switch(t){case 1:return this.getUint8(e,r);case 2:return this.getUint16(e,r);case 4:return this.getUint32(e,r);case 8:return this.getUint64&&this.getUint64(e,r)}}getUint(e,t,r){switch(t){case 8:return this.getUint8(e,r);case 16:return this.getUint16(e,r);case 32:return this.getUint32(e,r);case 64:return this.getUint64&&this.getUint64(e,r)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function mini_esm_p(e,t){mini_esm_l(`${e} '${t}' was not loaded, try using full build of exifr.`)}class mini_esm_g extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||mini_esm_p(this.kind,e),t&&(e in t||function(e,t){mini_esm_l(`Unknown ${e} '${t}'.`)}(this.kind,e),t[e].enabled||mini_esm_p(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var mini_esm_m=new mini_esm_g("file parser"),mini_esm_y=new mini_esm_g("segment parser"),mini_esm_b=new mini_esm_g("file reader");let mini_esm_w=mini_esm_t.fetch;function mini_esm_k(e,t){return(r=e).startsWith("data:")||r.length>1e4?mini_esm_v(e,t,"base64"):mini_esm_n&&e.includes("://")?mini_esm_O(e,t,"url",mini_esm_S):mini_esm_n?mini_esm_v(e,t,"fs"):mini_esm_s?mini_esm_O(e,t,"url",mini_esm_S):void mini_esm_l("Invalid input argument");var r}async function mini_esm_O(e,t,r,n){return mini_esm_b.has(r)?mini_esm_v(e,t,r):n?async function(e,t){let r=await t(e);return new mini_esm_c(r)}(e,n):void mini_esm_l(`Parser ${r} is not loaded`)}async function mini_esm_v(e,t,r){let n=new(mini_esm_b.get(r))(e,t);return await n.read(),n}const mini_esm_S=e=>mini_esm_w(e).then((e=>e.arrayBuffer())),mini_esm_A=e=>new Promise(((t,r)=>{let n=new FileReader;n.onloadend=()=>t(n.result||new ArrayBuffer),n.onerror=r,n.readAsArrayBuffer(e)}));class U extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function mini_esm_x(e,t,r){let n=new U;for(let[e,t]of r)n.set(e,t);if(Array.isArray(t))for(let r of t)e.set(r,n);else e.set(t,n);return n}function mini_esm_C(e,t,r){let n,i=e.get(t);for(n of r)i.set(n[0],n[1])}const mini_esm_B=new Map,mini_esm_V=new Map,mini_esm_I=new Map,mini_esm_L=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],mini_esm_T=["jfif","xmp","icc","iptc","ihdr"],mini_esm_z=["tiff",...mini_esm_T],mini_esm_P=["ifd0","ifd1","exif","gps","interop"],mini_esm_F=[...mini_esm_z,...mini_esm_P],mini_esm_j=["makerNote","userComment"],mini_esm_E=["translateKeys","translateValues","reviveValues","multiSegment"],mini_esm_M=[...mini_esm_E,"sanitize","mergeOutput","silentErrors"];class mini_esm_{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class mini_esm_D extends mini_esm_{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,r,n){if(super(),mini_esm_e(this,"enabled",!1),mini_esm_e(this,"skip",new Set),mini_esm_e(this,"pick",new Set),mini_esm_e(this,"deps",new Set),mini_esm_e(this,"translateKeys",!1),mini_esm_e(this,"translateValues",!1),mini_esm_e(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(n),this.canBeFiltered=mini_esm_P.includes(e),this.canBeFiltered&&(this.dict=mini_esm_B.get(e)),void 0!==r)if(Array.isArray(r))this.parse=this.enabled=!0,this.canBeFiltered&&r.length>0&&this.translateTagSet(r,this.pick);else if("object"==typeof r){if(this.enabled=!0,this.parse=!1!==r.parse,this.canBeFiltered){let{pick:e,skip:t}=r;e&&e.length>0&&this.translateTagSet(e,this.pick),t&&t.length>0&&this.translateTagSet(t,this.skip)}this.applyInheritables(r)}else!0===r||!1===r?this.parse=this.enabled=r:mini_esm_l(`Invalid options argument: ${r}`)}applyInheritables(e){let t,r;for(t of mini_esm_E)r=e[t],void 0!==r&&(this[t]=r)}translateTagSet(e,t){if(this.dict){let r,n,{tagKeys:i,tagValues:a}=this.dict;for(r of e)"string"==typeof r?(n=a.indexOf(r),-1===n&&(n=i.indexOf(Number(r))),-1!==n&&t.add(Number(i[n]))):t.add(r)}else for(let r of e)t.add(r)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,X(this.pick,this.deps)):this.enabled&&this.pick.size>0&&X(this.pick,this.deps)}}var mini_esm_N={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},mini_esm_$=new Map;class R extends mini_esm_{static useCached(e){let t=mini_esm_$.get(e);return void 0!==t||(t=new this(e),mini_esm_$.set(e,t)),t}constructor(e){super(),!0===e?this.setupFromTrue():void 0===e?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):"object"==typeof e?this.setupFromObject(e):mini_esm_l(`Invalid options argument ${e}`),void 0===this.firstChunkSize&&(this.firstChunkSize=mini_esm_s?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of mini_esm_L)this[e]=mini_esm_N[e];for(e of mini_esm_M)this[e]=mini_esm_N[e];for(e of mini_esm_j)this[e]=mini_esm_N[e];for(e of mini_esm_F)this[e]=new mini_esm_D(e,mini_esm_N[e],void 0,this)}setupFromTrue(){let e;for(e of mini_esm_L)this[e]=mini_esm_N[e];for(e of mini_esm_M)this[e]=mini_esm_N[e];for(e of mini_esm_j)this[e]=!0;for(e of mini_esm_F)this[e]=new mini_esm_D(e,!0,void 0,this)}setupFromArray(e){let t;for(t of mini_esm_L)this[t]=mini_esm_N[t];for(t of mini_esm_M)this[t]=mini_esm_N[t];for(t of mini_esm_j)this[t]=mini_esm_N[t];for(t of mini_esm_F)this[t]=new mini_esm_D(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,mini_esm_P)}setupFromObject(e){let t;for(t of(mini_esm_P.ifd0=mini_esm_P.ifd0||mini_esm_P.image,mini_esm_P.ifd1=mini_esm_P.ifd1||mini_esm_P.thumbnail,Object.assign(this,e),mini_esm_L))this[t]=W(e[t],mini_esm_N[t]);for(t of mini_esm_M)this[t]=W(e[t],mini_esm_N[t]);for(t of mini_esm_j)this[t]=W(e[t],mini_esm_N[t]);for(t of mini_esm_z)this[t]=new mini_esm_D(t,mini_esm_N[t],e[t],this);for(t of mini_esm_P)this[t]=new mini_esm_D(t,mini_esm_N[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,mini_esm_P,mini_esm_F),!0===e.tiff?this.batchEnableWithBool(mini_esm_P,!0):!1===e.tiff?this.batchEnableWithUserValue(mini_esm_P,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,mini_esm_P):"object"==typeof e.tiff&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,mini_esm_P)}batchEnableWithBool(e,t){for(let r of e)this[r].enabled=t}batchEnableWithUserValue(e,t){for(let r of e){let e=t[r];this[r].enabled=!1!==e&&void 0!==e}}setupGlobalFilters(e,t,r,n=r){if(e&&e.length){for(let e of n)this[e].enabled=!1;let t=mini_esm_K(e,r);for(let[e,r]of t)X(this[e].pick,r),this[e].enabled=!0}else if(t&&t.length){let e=mini_esm_K(t,r);for(let[t,r]of e)X(this[t].skip,r)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:r,iptc:n,icc:i}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),r.enabled||e.skip.add(700),n.enabled||e.skip.add(33723),i.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:r,interop:n}=this;n.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),r.needed&&e.deps.add(34853),this.tiff.enabled=mini_esm_P.some((e=>!0===this[e].enabled))||this.makerNote||this.userComment;for(let e of mini_esm_P)this[e].finalizeFilters()}get onlyTiff(){return!mini_esm_T.map((e=>this[e].enabled)).some((e=>!0===e))&&this.tiff.enabled}checkLoadedPlugins(){for(let e of mini_esm_z)this[e].enabled&&!mini_esm_y.has(e)&&mini_esm_p("segment parser",e)}}function mini_esm_K(e,t){let r,n,i,a,s=[];for(i of t){for(a of(r=mini_esm_B.get(i),n=[],r))(e.includes(a[0])||e.includes(a[1]))&&n.push(a[0]);n.length&&s.push([i,n])}return s}function W(e,t){return void 0!==e?e:void 0!==t?t:void 0}function X(e,t){for(let r of t)e.add(r)}mini_esm_e(R,"default",mini_esm_N);class mini_esm_H{constructor(e){mini_esm_e(this,"parsers",{}),mini_esm_e(this,"output",{}),mini_esm_e(this,"errors",[]),mini_esm_e(this,"pushToErrors",(e=>this.errors.push(e))),this.options=R.useCached(e)}async read(e){this.file=await function(e,t){return"string"==typeof e?mini_esm_k(e,t):mini_esm_s&&!mini_esm_i&&e instanceof HTMLImageElement?mini_esm_k(e.src,t):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new mini_esm_c(e):mini_esm_s&&e instanceof Blob?mini_esm_O(e,t,"blob",mini_esm_A):void mini_esm_l("Invalid input argument")}(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[r,n]of mini_esm_m)if(n.canHandle(e,t))return this.fileParser=new n(this.options,this.file,this.parsers),e[r]=!0;this.file.close&&this.file.close(),mini_esm_l("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),mini_esm_f(r=e)?void 0:r;var r}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map((async t=>{let r=await t.parse();t.assignToOutput(e,r)}));this.options.silentErrors&&(t=t.map((e=>e.catch(this.pushToErrors)))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,r=mini_esm_y.get("tiff",e);var n;if(t.tiff?n={start:0,type:"tiff"}:t.jpeg&&(n=await this.fileParser.getOrFindSegment("tiff")),void 0===n)return;let i=await this.fileParser.ensureSegmentChunk(n),a=this.parsers.tiff=new r(i,e,t),s=await a.extractThumbnail();return t.close&&t.close(),s}}async function Y(e,t){let r=new mini_esm_H(t);return await r.read(e),r.parse()}var mini_esm_G=Object.freeze({__proto__:null,parse:Y,Exifr:mini_esm_H,fileParsers:mini_esm_m,segmentParsers:mini_esm_y,fileReaders:mini_esm_b,tagKeys:mini_esm_B,tagValues:mini_esm_V,tagRevivers:mini_esm_I,createDictionary:mini_esm_x,extendDictionary:mini_esm_C,fetchUrlAsArrayBuffer:mini_esm_S,readBlobAsArrayBuffer:mini_esm_A,chunkedProps:mini_esm_L,otherSegments:mini_esm_T,segments:mini_esm_z,tiffBlocks:mini_esm_P,segmentsAndBlocks:mini_esm_F,tiffExtractables:mini_esm_j,inheritables:mini_esm_E,allFormatters:mini_esm_M,Options:R});class mini_esm_J{static findPosition(e,t){let r=e.getUint16(t+2)+2,n="function"==typeof this.headerLength?this.headerLength(e,t,r):this.headerLength,i=t+n,a=r-n;return{offset:t,length:r,headerLength:n,start:i,size:a,end:i+a}}static parse(e,t={}){return new this(e,new R({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof mini_esm_c?e:new mini_esm_c(e)}constructor(e,t={},r){mini_esm_e(this,"errors",[]),mini_esm_e(this,"raw",new Map),mini_esm_e(this,"handleError",(e=>{if(!this.options.silentErrors)throw e;this.errors.push(e.message)})),this.chunk=this.normalizeInput(e),this.file=r,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let r=mini_esm_I.get(t),n=mini_esm_V.get(t),i=mini_esm_B.get(t),a=this.options[t],s=a.reviveValues&&!!r,o=a.translateValues&&!!n,l=a.translateKeys&&!!i,c={};for(let[t,a]of e)s&&r.has(t)?a=r.get(t)(a):o&&n.has(t)&&(a=this.translateValue(a,n.get(t))),l&&i.has(t)&&(t=i.get(t)||t),c[t]=a;return c}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,r){if(this.globalOptions.mergeOutput)return Object.assign(e,r);e[t]?Object.assign(e[t],r):e[t]=r}}function mini_esm_q(e){return 192===e||194===e||196===e||219===e||221===e||218===e||254===e}function Q(e){return e>=224&&e<=239}function Z(e,t,r){for(let[n,i]of mini_esm_y)if(i.canHandle(e,t,r))return n}mini_esm_e(mini_esm_J,"headerLength",4),mini_esm_e(mini_esm_J,"type",void 0),mini_esm_e(mini_esm_J,"multiSegment",!1),mini_esm_e(mini_esm_J,"canHandle",(()=>!1));class ee extends class{constructor(e,t,r){mini_esm_e(this,"errors",[]),mini_esm_e(this,"ensureSegmentChunk",(async e=>{let t=e.start,r=e.size||65536;if(this.file.chunked)if(this.file.available(t,r))e.chunk=this.file.subarray(t,r);else try{e.chunk=await this.file.readChunk(t,r)}catch(t){mini_esm_l(`Couldn't read segment: ${JSON.stringify(e)}. ${t.message}`)}else this.file.byteLength>t+r?e.chunk=this.file.subarray(t,r):void 0===e.size?e.chunk=this.file.subarray(t):mini_esm_l("Segment unreachable: "+JSON.stringify(e));return e.chunk})),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=r}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let r=new(mini_esm_y.get(e))(t,this.options,this.file);return this.parsers[e]=r}createParsers(e){for(let t of e){let{type:e,chunk:r}=t,n=this.options[e];if(n&&n.enabled){let t=this.parsers[e];t&&t.append||t||this.createParser(e,r)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}{constructor(...e){super(...e),mini_esm_e(this,"appSegments",[]),mini_esm_e(this,"jpegSegments",[]),mini_esm_e(this,"unknownSegments",[])}static canHandle(e,t){return 65496===t}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){!0===e?(this.findAll=!0,this.wanted=new Set(mini_esm_y.keyList())):(e=void 0===e?mini_esm_y.keyList().filter((e=>this.options[e].enabled)):e.filter((e=>this.options[e].enabled&&mini_esm_y.has(e))),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:r,findAll:n,wanted:i,remaining:a}=this;if(!n&&this.file.chunked&&(n=Array.from(i).some((e=>{let t=mini_esm_y.get(e),r=this.options[e];return t.multiSegment&&r.multiSegment})),n&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,r.byteLength),!this.options.onlyTiff&&r.chunked){let t=!1;for(;a.size>0&&!t&&(r.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:n}=r,i=this.appSegments.some((e=>!this.file.available(e.offset||e.start,e.length||e.size)));if(t=e>n&&!i?!await r.readNextChunk(e):!await r.readNextChunk(n),void 0===(e=this.findAppSegmentsInRange(e,r.byteLength)))return}}}findAppSegmentsInRange(e,t){t-=2;let r,n,i,a,s,o,{file:l,findAll:c,wanted:d,remaining:u,options:p}=this;for(;e<t;e++)if(255===l.getUint8(e))if(r=l.getUint8(e+1),Q(r)){if(n=l.getUint16(e+2),i=Z(l,e,n),i&&d.has(i)&&(a=mini_esm_y.get(i),s=a.findPosition(l,e),o=p[i],s.type=i,this.appSegments.push(s),!c&&(a.multiSegment&&o.multiSegment?(this.unfinishedMultiSegment=s.chunkNumber<s.chunkCount,this.unfinishedMultiSegment||u.delete(i)):u.delete(i),0===u.size)))break;p.recordUnknownSegments&&(s=mini_esm_J.findPosition(l,e),s.marker=r,this.unknownSegments.push(s)),e+=n+1}else if(mini_esm_q(r)){if(n=l.getUint16(e+2),218===r&&!1!==p.stopAfterSos)return;p.recordJpegSegments&&this.jpegSegments.push({offset:e,length:n,marker:r}),e+=n+1}return e}mergeMultiSegments(){if(!this.appSegments.some((e=>e.multiSegment)))return;let e=function(e){let t,r,n,i=new Map;for(let a=0;a<e.length;a++)t=e[a],r=t.type,i.has(r)?n=i.get(r):i.set(r,n=[]),n.push(t);return Array.from(i)}(this.appSegments);this.mergedAppSegments=e.map((([e,t])=>{let r=mini_esm_y.get(e,this.options);return r.handleMultiSegments?{type:e,chunk:r.handleMultiSegments(t)}:t[0]}))}getSegment(e){return this.appSegments.find((t=>t.type===e))}async getOrFindSegment(e){let t=this.getSegment(e);return void 0===t&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}mini_esm_e(ee,"type","jpeg"),mini_esm_m.set("jpeg",ee);const te=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class se extends mini_esm_J{parseHeader(){var e=this.chunk.getUint16();18761===e?this.le=!0:19789===e&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,r=new Map){let{pick:n,skip:i}=this.options[t];n=new Set(n);let a=n.size>0,s=0===i.size,o=this.chunk.getUint16(e);e+=2;for(let l=0;l<o;l++){let o=this.chunk.getUint16(e);if(a){if(n.has(o)&&(r.set(o,this.parseTag(e,o,t)),n.delete(o),0===n.size))break}else!s&&i.has(o)||r.set(o,this.parseTag(e,o,t));e+=12}return r}parseTag(e,t,r){let{chunk:n}=this,i=n.getUint16(e+2),a=n.getUint32(e+4),s=te[i];if(s*a<=4?e+=8:e=n.getUint32(e+8),(i<1||i>13)&&mini_esm_l(`Invalid TIFF value type. block: ${r.toUpperCase()}, tag: ${t.toString(16)}, type: ${i}, offset ${e}`),e>n.byteLength&&mini_esm_l(`Invalid TIFF value offset. block: ${r.toUpperCase()}, tag: ${t.toString(16)}, type: ${i}, offset ${e} is outside of chunk size ${n.byteLength}`),1===i)return n.getUint8Array(e,a);if(2===i)return""===(o=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(o=n.getString(e,a)).trim())?void 0:o;var o;if(7===i)return n.getUint8Array(e,a);if(1===a)return this.parseTagValue(i,e);{let t=new(function(e){switch(e){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:case 10:default:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 11:return Float32Array;case 12:return Float64Array}}(i))(a),r=s;for(let n=0;n<a;n++)t[n]=this.parseTagValue(i,e),e+=r;return t}}parseTagValue(e,t){let{chunk:r}=this;switch(e){case 1:return r.getUint8(t);case 3:return r.getUint16(t);case 4:case 13:return r.getUint32(t);case 5:return r.getUint32(t)/r.getUint32(t+4);case 6:return r.getInt8(t);case 8:return r.getInt16(t);case 9:return r.getInt32(t);case 10:return r.getInt32(t)/r.getInt32(t+4);case 11:return r.getFloat(t);case 12:return r.getDouble(t);default:mini_esm_l(`Invalid tiff type ${e}`)}}}class ie extends se{static canHandle(e,t){return 225===e.getUint8(t+1)&&1165519206===e.getUint32(t+4)&&0===e.getUint16(t+8)}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return void 0!==t.catch&&(t=t.catch(this.handleError)),t}findIfd0Offset(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(void 0===this.ifd1Offset){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let r=new Map;return this[t]=r,this.parseTags(e,t,r),r}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&mini_esm_l("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&mini_esm_l(`IFD0 offset points to outside of file.\nthis.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,mini_esm_o(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return 0!==t.size?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.exifOffset)return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,mini_esm_o(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let r=e.get(t);r&&1===r.length&&e.set(t,r[0])}async parseGpsBlock(){if(this.gps)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.gpsOffset)return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",ne(...e.get(2),e.get(1))),e.set("longitude",ne(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),void 0!==this.interopOffset||this.exif||await this.parseExifBlock(),void 0!==this.interopOffset))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),void 0===this.ifd1)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,r,n={};for(t of mini_esm_P)if(e=this[t],!mini_esm_f(e))if(r=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if("ifd1"===t)continue;Object.assign(n,r)}else n[t]=r;return this.makerNote&&(n.makerNote=this.makerNote),this.userComment&&(n.userComment=this.userComment),n}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[r,n]of Object.entries(t))this.assignObjectToOutput(e,r,n)}}function ne(e,t,r,n){var i=e+t/60+r/3600;return"S"!==n&&"W"!==n||(i*=-1),i}mini_esm_e(ie,"type","tiff"),mini_esm_e(ie,"headerLength",10),mini_esm_y.set("tiff",ie);var re=Object.freeze({__proto__:null,default:mini_esm_G,Exifr:mini_esm_H,fileParsers:mini_esm_m,segmentParsers:mini_esm_y,fileReaders:mini_esm_b,tagKeys:mini_esm_B,tagValues:mini_esm_V,tagRevivers:mini_esm_I,createDictionary:mini_esm_x,extendDictionary:mini_esm_C,fetchUrlAsArrayBuffer:mini_esm_S,readBlobAsArrayBuffer:mini_esm_A,chunkedProps:mini_esm_L,otherSegments:mini_esm_T,segments:mini_esm_z,tiffBlocks:mini_esm_P,segmentsAndBlocks:mini_esm_F,tiffExtractables:mini_esm_j,inheritables:mini_esm_E,allFormatters:mini_esm_M,Options:R,parse:Y});const ae={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},he=Object.assign({},ae,{firstChunkSize:4e4,gps:[1,2,3,4]});async function fe(e){let t=new mini_esm_H(he);await t.read(e);let r=await t.parse();if(r&&r.gps){let{latitude:e,longitude:t}=r.gps;return{latitude:e,longitude:t}}}const le=Object.assign({},ae,{tiff:!1,ifd1:!0,mergeOutput:!1});async function oe(e){let t=new mini_esm_H(le);await t.read(e);let r=await t.extractThumbnail();return r&&mini_esm_a?mini_esm_r.from(r):r}async function ue(e){let t=await this.thumbnail(e);if(void 0!==t){let e=new Blob([t]);return URL.createObjectURL(e)}}const de=Object.assign({},ae,{firstChunkSize:4e4,ifd0:[274]});async function ce(e){let t=new mini_esm_H(de);await t.read(e);let r=await t.parse();if(r&&r.ifd0)return r.ifd0[274]}const pe=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});let ge=!0,me=!0;if("object"==typeof navigator){let e=navigator.userAgent;if(e.includes("iPad")||e.includes("iPhone")){let t=e.match(/OS (\d+)_(\d+)/);if(t){let[,e,r]=t,n=Number(e)+.1*Number(r);ge=n<13.4,me=!1}}else if(e.includes("OS X 10")){let[,t]=e.match(/OS X 10[_.](\d+)/);ge=me=Number(t)<15}if(e.includes("Chrome/")){let[,t]=e.match(/Chrome\/(\d+)/);ge=me=Number(t)<81}else if(e.includes("Firefox/")){let[,t]=e.match(/Firefox\/(\d+)/);ge=me=Number(t)<77}}async function ye(e){let t=await ce(e);return Object.assign({canvas:ge,css:me},pe[t])}class be extends mini_esm_c{constructor(...e){super(...e),mini_esm_e(this,"ranges",new we),0!==this.byteLength&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,r){if(0===e&&0===this.byteLength&&r){let e=new DataView(r.buffer||r,r.byteOffset,r.byteLength);this._swapDataView(e)}else{let r=e+t;if(r>this.byteLength){let{dataView:e}=this._extend(r);this._swapDataView(e)}}}_extend(e){let t;t=mini_esm_a?mini_esm_r.allocUnsafe(e):new Uint8Array(e);let r=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:r}}subarray(e,t,r=!1){return t=t||this._lengthToEnd(e),r&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,r=!1){r&&this._tryExtend(t,e.byteLength,e);let n=super.set(e,t);return this.ranges.add(t,n.byteLength),n}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class we{constructor(){mini_esm_e(this,"list",[])}get length(){return this.list.length}add(e,t,r=0){let n=e+t,i=this.list.filter((t=>ke(e,t.offset,n)||ke(e,t.end,n)));if(i.length>0){e=Math.min(e,...i.map((e=>e.offset))),n=Math.max(n,...i.map((e=>e.end))),t=n-e;let r=i.shift();r.offset=e,r.length=t,r.end=n,this.list=this.list.filter((e=>!i.includes(e)))}else this.list.push({offset:e,length:t,end:n})}available(e,t){let r=e+t;return this.list.some((t=>t.offset<=e&&r<=t.end))}}function ke(e,t,r){return e<=t&&t<=r}class Oe extends be{constructor(e,t){super(0),mini_esm_e(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,r=await this.readChunk(e,t);return!!r&&r.byteLength===t}async readChunk(e,t){if(this.chunksRead++,0!==(t=this.safeWrapAddress(e,t)))return this._readChunk(e,t)}safeWrapAddress(e,t){return void 0!==this.size&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return void 0!==this.size&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}mini_esm_b.set("blob",class extends Oe{async readWhole(){this.chunked=!1;let e=await mini_esm_A(this.input);this._swapArrayBuffer(e)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(e,t){let r=t?e+t:void 0,n=this.input.slice(e,r),i=await mini_esm_A(n);return this.set(i,e,!0)}});const mini_esm=null,thumbnail_generator_lib_locale={strings:{generatingThumbnails:"Generating thumbnails..."}},lib_packageJson={version:"4.1.1"};function canvasToBlob(e,t,r){try{e.getContext("2d").getImageData(0,0,1,1)}catch(e){if(18===e.code)return Promise.reject(new Error("cannot read image, probably an svg with external resources"))}return e.toBlob?new Promise((n=>{e.toBlob(n,t,r)})).then((e=>{if(null===e)throw new Error("cannot read image, probably an svg with external resources");return e})):Promise.resolve().then((()=>lib_dataURItoBlob(e.toDataURL(t,r),{}))).then((e=>{if(null===e)throw new Error("could not extract blob, probably an old browser");return e}))}function rotateImage(e,t){let r=e.width,n=e.height;90!==t.deg&&270!==t.deg||(r=e.height,n=e.width);const i=document.createElement("canvas");i.width=r,i.height=n;const a=i.getContext("2d");return a.translate(r/2,n/2),t.canvas&&(a.rotate(t.rad),a.scale(t.scaleX,t.scaleY)),a.drawImage(e,-e.width/2,-e.height/2,e.width,e.height),i}function protect(e){const t=e.width/e.height,r=5e6,n=4096;let i=Math.floor(Math.sqrt(r*t)),a=Math.floor(r/Math.sqrt(r*t));if(i>n&&(i=n,a=Math.round(i/t)),a>n&&(a=n,i=Math.round(t*a)),e.width>i){const t=document.createElement("canvas");return t.width=i,t.height=a,t.getContext("2d").drawImage(e,0,0,i,a),t}return e}const lib_defaultOptions={thumbnailWidth:null,thumbnailHeight:null,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,lazy:!1};class ThumbnailGenerator extends lib_UIPlugin{constructor(e,t){if(super(e,{...lib_defaultOptions,...t}),this.onFileAdded=e=>{!e.preview&&e.data&&isPreviewSupported(e.type)&&!e.isRemote&&this.addToQueue(e.id)},this.onCancelRequest=e=>{const t=this.queue.indexOf(e.id);-1!==t&&this.queue.splice(t,1)},this.onFileRemoved=e=>{const t=this.queue.indexOf(e.id);-1!==t&&this.queue.splice(t,1),e.preview&&isObjectURL(e.preview)&&URL.revokeObjectURL(e.preview)},this.onRestored=()=>{this.uppy.getFiles().filter((e=>e.isRestored)).forEach((e=>{e.preview&&!isObjectURL(e.preview)||this.addToQueue(e.id)}))},this.onAllFilesRemoved=()=>{this.queue=[]},this.waitUntilAllProcessed=e=>{e.forEach((e=>{const t=this.uppy.getFile(e);this.uppy.emit("preprocess-progress",t,{mode:"indeterminate",message:this.i18n("generatingThumbnails")})}));const t=()=>{e.forEach((e=>{const t=this.uppy.getFile(e);this.uppy.emit("preprocess-complete",t)}))};return new Promise((e=>{this.queueProcessing?this.uppy.once("thumbnail:all-generated",(()=>{t(),e()})):(t(),e())}))},this.type="modifier",this.id=this.opts.id||"ThumbnailGenerator",this.title="Thumbnail Generator",this.queue=[],this.queueProcessing=!1,this.defaultThumbnailDimension=200,this.thumbnailType=this.opts.thumbnailType,this.defaultLocale=thumbnail_generator_lib_locale,this.i18nInit(),this.opts.lazy&&this.opts.waitForThumbnailsBeforeUpload)throw new Error("ThumbnailGenerator: The `lazy` and `waitForThumbnailsBeforeUpload` options are mutually exclusive. Please ensure at most one of them is set to `true`.")}createThumbnail(e,t,r){const n=URL.createObjectURL(e.data),i=new Promise(((e,t)=>{const r=new Image;r.src=n,r.addEventListener("load",(()=>{URL.revokeObjectURL(n),e(r)})),r.addEventListener("error",(e=>{URL.revokeObjectURL(n),t(e.error||new Error("Could not create thumbnail"))}))})),a=ye(e.data).catch((()=>1));return Promise.all([i,a]).then((e=>{let[n,i]=e;const a=this.getProportionalDimensions(n,t,r,i.deg),s=rotateImage(n,i);return canvasToBlob(this.resizeImage(s,a.width,a.height),this.thumbnailType,80)})).then((e=>URL.createObjectURL(e)))}getProportionalDimensions(e,t,r,n){let i=e.width/e.height;return 90!==n&&270!==n||(i=e.height/e.width),null!=t?{width:t,height:Math.round(t/i)}:null!=r?{width:Math.round(r*i),height:r}:{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/i)}}resizeImage(e,t,r){let n=protect(e),i=Math.ceil(Math.log2(n.width/t));i<1&&(i=1);let a=t*2**(i-1),s=r*2**(i-1);for(;i--;){const e=document.createElement("canvas");e.width=a,e.height=s,e.getContext("2d").drawImage(n,0,0,a,s),n=e,a=Math.round(a/2),s=Math.round(s/2)}return n}setPreviewURL(e,t){this.uppy.setFileState(e,{preview:t})}addToQueue(e){this.queue.push(e),!1===this.queueProcessing&&this.processQueue()}processQueue(){if(this.queueProcessing=!0,this.queue.length>0){const e=this.uppy.getFile(this.queue.shift());return e?this.requestThumbnail(e).catch((()=>{})).then((()=>this.processQueue())):(this.uppy.log("[ThumbnailGenerator] file was removed before a thumbnail could be generated, but not removed from the queue. This is probably a bug","error"),Promise.resolve())}return this.queueProcessing=!1,this.uppy.log("[ThumbnailGenerator] Emptied thumbnail queue"),this.uppy.emit("thumbnail:all-generated"),Promise.resolve()}requestThumbnail(e){return isPreviewSupported(e.type)&&!e.isRemote?this.createThumbnail(e,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then((t=>{this.setPreviewURL(e.id,t),this.uppy.log(`[ThumbnailGenerator] Generated thumbnail for ${e.id}`),this.uppy.emit("thumbnail:generated",this.uppy.getFile(e.id),t)})).catch((t=>{this.uppy.log(`[ThumbnailGenerator] Failed thumbnail for ${e.id}:`,"warning"),this.uppy.log(t,"warning"),this.uppy.emit("thumbnail:error",this.uppy.getFile(e.id),t)})):Promise.resolve()}install(){this.uppy.on("file-removed",this.onFileRemoved),this.uppy.on("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("thumbnail:cancel",this.onCancelRequest)):(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("file-added",this.onFileAdded),this.uppy.on("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.addPreProcessor(this.waitUntilAllProcessed)}uninstall(){this.uppy.off("file-removed",this.onFileRemoved),this.uppy.off("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("thumbnail:cancel",this.onCancelRequest)):(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("file-added",this.onFileAdded),this.uppy.off("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.removePreProcessor(this.waitUntilAllProcessed)}}function findAllDOMElements(e){if("string"==typeof e){const t=document.querySelectorAll(e);return 0===t.length?null:Array.from(t)}return"object"==typeof e&&isDOMElement(e)?[e]:null}ThumbnailGenerator.VERSION=lib_packageJson.version;const lib_findAllDOMElements=findAllDOMElements,toArray=Array.from;function getFilesAndDirectoriesFromDirectory(e,t,r,n){let{onSuccess:i}=n;e.readEntries((n=>{const a=[...t,...n];n.length?queueMicrotask((()=>{getFilesAndDirectoriesFromDirectory(e,a,r,{onSuccess:i})})):i(a)}),(e=>{r(e),i(t)}))}function getAsFileSystemHandleFromEntry(e,t){return null==e?e:{kind:e.isFile?"file":e.isDirectory?"directory":void 0,name:e.name,getFile:()=>new Promise(((t,r)=>e.file(t,r))),async*values(){const r=e.createReader(),n=await new Promise((e=>{getFilesAndDirectoriesFromDirectory(r,[],t,{onSuccess:r=>e(r.map((e=>getAsFileSystemHandleFromEntry(e,t))))})}));yield*n},isSameEntry:void 0}}function createPromiseToAddFileOrParseDirectory(e,t,r){try{return void 0===r&&(r=void 0),async function*(){const n=()=>`${t}/${e.name}`;if("file"===e.kind){const i=await e.getFile();null!=i?(i.relativePath=t?n():null,yield i):null!=r&&(yield r)}else if("directory"===e.kind)for await(const r of e.values())yield*createPromiseToAddFileOrParseDirectory(r,t?n():e.name);else null!=r&&(yield r)}()}catch(e){return Promise.reject(e)}}async function*getFilesFromDataTransfer(e,t){const r=await Promise.all(Array.from(e.items,(async e=>{let r;return null!=r||(r=getAsFileSystemHandleFromEntry("function"==typeof e.getAsEntry?e.getAsEntry():e.webkitGetAsEntry(),t)),{fileSystemHandle:r,lastResortFile:e.getAsFile()}})));for(const{lastResortFile:e,fileSystemHandle:n}of r)if(null!=n)try{yield*createPromiseToAddFileOrParseDirectory(n,"",e)}catch(r){null!=e?yield e:t(r)}else null!=e&&(yield e)}function fallbackApi(e){const t=toArray(e.files);return Promise.resolve(t)}async function getDroppedFiles(e,t){var r;const n=null!=(r=null==t?void 0:t.logDropError)?r:Function.prototype;try{const t=[];for await(const r of getFilesFromDataTransfer(e,n))t.push(r);return t}catch{return fallbackApi(e)}}function remoteFileObjToLocal(e){return{...e,type:e.mimeType,extension:e.name?getFileNameAndExtension(e.name).extension:null}}var hooks_module_t,hooks_module_r,hooks_module_u,hooks_module_i,hooks_module_o=0,hooks_module_f=[],hooks_module_c=l,hooks_module_e=hooks_module_c.__b,hooks_module_a=hooks_module_c.__r,hooks_module_v=hooks_module_c.diffed,hooks_module_l=hooks_module_c.__c,hooks_module_m=hooks_module_c.unmount,hooks_module_s=hooks_module_c.__;function hooks_module_p(e,t){hooks_module_c.__h&&hooks_module_c.__h(hooks_module_r,e,hooks_module_o||t),hooks_module_o=0;var r=hooks_module_r.__H||(hooks_module_r.__H={__:[],__h:[]});return e>=r.__.length&&r.__.push({}),r.__[e]}function hooks_module_d(e){return hooks_module_o=1,hooks_module_h(hooks_module_D,e)}function hooks_module_h(e,t,r){var n=hooks_module_p(hooks_module_t++,2);if(n.t=e,!n.__c&&(n.__=[r?r(t):hooks_module_D(void 0,t),function(e){var t=n.__N?n.__N[0]:n.__[0],r=n.t(t,e);t!==r&&(n.__N=[r,n.__[1]],n.__c.setState({}))}],n.__c=hooks_module_r,!hooks_module_r.__f)){var i=function(e,t,r){if(!n.__c.__H)return!0;var i=n.__c.__H.__.filter((function(e){return!!e.__c}));if(i.every((function(e){return!e.__N})))return!a||a.call(this,e,t,r);var s=n.__c.props!==e;return i.forEach((function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(s=!0)}})),a&&a.call(this,e,t,r)||s};hooks_module_r.__f=!0;var a=hooks_module_r.shouldComponentUpdate,s=hooks_module_r.componentWillUpdate;hooks_module_r.componentWillUpdate=function(e,t,r){if(this.__e){var n=a;a=void 0,i(e,t,r),a=n}s&&s.call(this,e,t,r)},hooks_module_r.shouldComponentUpdate=i}return n.__N||n.__}function hooks_module_y(e,t){var r=hooks_module_p(hooks_module_t++,3);!hooks_module_c.__s&&hooks_module_C(r.__H,t)&&(r.__=e,r.u=t,hooks_module_r.__H.__h.push(r))}function hooks_module_(e,t){var r=hooks_module_p(hooks_module_t++,4);!hooks_module_c.__s&&hooks_module_C(r.__H,t)&&(r.__=e,r.u=t,hooks_module_r.__h.push(r))}function hooks_module_A(e){return hooks_module_o=5,hooks_module_T((function(){return{current:e}}),[])}function hooks_module_F(e,t,r){hooks_module_o=6,hooks_module_((function(){if("function"==typeof e){var r=e(t());return function(){e(null),r&&"function"==typeof r&&r()}}if(e)return e.current=t(),function(){return e.current=null}}),null==r?r:r.concat(e))}function hooks_module_T(e,t){var r=hooks_module_p(hooks_module_t++,7);return hooks_module_C(r.__H,t)&&(r.__=e(),r.__H=t,r.__h=e),r.__}function hooks_module_q(e,t){return hooks_module_o=8,hooks_module_T((function(){return e}),t)}function hooks_module_x(e){var t=hooks_module_r.context[e.__c],r=hooks_module_p(hooks_module_t++,9);return r.c=e,t?(null==r.__&&(r.__=!0,t.sub(hooks_module_r)),t.props.value):e.__}function hooks_module_P(e,t){hooks_module_c.useDebugValue&&hooks_module_c.useDebugValue(t?t(e):e)}function hooks_module_b(e){var t=hooks_module_p(hooks_module_t++,10),r=hooks_module_d();return t.__=e,hooks_module_r.componentDidCatch||(hooks_module_r.componentDidCatch=function(e,n){t.__&&t.__(e,n),r[1](e)}),[r[0],function(){r[1](void 0)}]}function hooks_module_g(){var e=hooks_module_p(hooks_module_t++,11);if(!e.__){for(var t=hooks_module_r.__v;null!==t&&!t.__m&&null!==t.__;)t=t.__;var r=t.__m||(t.__m=[0,0]);e.__="P"+r[0]+"-"+r[1]++}return e.__}function hooks_module_j(){for(var e;e=hooks_module_f.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(hooks_module_z),e.__H.__h.forEach(hooks_module_B),e.__H.__h=[]}catch(t){e.__H.__h=[],hooks_module_c.__e(t,e.__v)}}hooks_module_c.__b=function(e){hooks_module_r=null,hooks_module_e&&hooks_module_e(e)},hooks_module_c.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),hooks_module_s&&hooks_module_s(e,t)},hooks_module_c.__r=function(e){hooks_module_a&&hooks_module_a(e),hooks_module_t=0;var t=(hooks_module_r=e.__c).__H;t&&(hooks_module_u===hooks_module_r?(t.__h=[],hooks_module_r.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.u=e.__N=void 0}))):(t.__h.forEach(hooks_module_z),t.__h.forEach(hooks_module_B),t.__h=[],hooks_module_t=0)),hooks_module_u=hooks_module_r},hooks_module_c.diffed=function(e){hooks_module_v&&hooks_module_v(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==hooks_module_f.push(t)&&hooks_module_i===hooks_module_c.requestAnimationFrame||((hooks_module_i=hooks_module_c.requestAnimationFrame)||hooks_module_w)(hooks_module_j)),t.__H.__.forEach((function(e){e.u&&(e.__H=e.u),e.u=void 0}))),hooks_module_u=hooks_module_r=null},hooks_module_c.__c=function(e,t){t.some((function(e){try{e.__h.forEach(hooks_module_z),e.__h=e.__h.filter((function(e){return!e.__||hooks_module_B(e)}))}catch(r){t.some((function(e){e.__h&&(e.__h=[])})),t=[],hooks_module_c.__e(r,e.__v)}})),hooks_module_l&&hooks_module_l(e,t)},hooks_module_c.unmount=function(e){hooks_module_m&&hooks_module_m(e);var t,r=e.__c;r&&r.__H&&(r.__H.__.forEach((function(e){try{hooks_module_z(e)}catch(e){t=e}})),r.__H=void 0,t&&hooks_module_c.__e(t,r.__v))};var hooks_module_k="function"==typeof requestAnimationFrame;function hooks_module_w(e){var t,r=function(){clearTimeout(n),hooks_module_k&&cancelAnimationFrame(t),setTimeout(e)},n=setTimeout(r,100);hooks_module_k&&(t=requestAnimationFrame(r))}function hooks_module_z(e){var t=hooks_module_r,r=e.__c;"function"==typeof r&&(e.__c=void 0,r()),hooks_module_r=t}function hooks_module_B(e){var t=hooks_module_r;e.__c=e.__(),hooks_module_r=t}function hooks_module_C(e,t){return!e||e.length!==t.length||t.some((function(t,r){return t!==e[r]}))}function hooks_module_D(e,t){return"function"==typeof t?t(e):t}function GoogleIcon(){return _("svg",{width:"26",height:"26",viewBox:"0 0 26 26",xmlns:"http://www.w3.org/2000/svg"},_("g",{fill:"none","fill-rule":"evenodd"},_("circle",{fill:"#FFF",cx:"13",cy:"13",r:"13"}),_("path",{d:"M21.64 13.205c0-.639-.057-1.252-.164-1.841H13v3.481h4.844a4.14 4.14 0 01-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z",fill:"#4285F4","fill-rule":"nonzero"}),_("path",{d:"M13 22c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H4.957v2.332A8.997 8.997 0 0013 22z",fill:"#34A853","fill-rule":"nonzero"}),_("path",{d:"M7.964 14.71A5.41 5.41 0 017.682 13c0-.593.102-1.17.282-1.71V8.958H4.957A8.996 8.996 0 004 13c0 1.452.348 2.827.957 4.042l3.007-2.332z",fill:"#FBBC05","fill-rule":"nonzero"}),_("path",{d:"M13 7.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C17.463 4.891 15.426 4 13 4a8.997 8.997 0 00-8.043 4.958l3.007 2.332C8.672 9.163 10.656 7.58 13 7.58z",fill:"#EA4335","fill-rule":"nonzero"}),_("path",{d:"M4 4h18v18H4z"})))}function DefaultForm(e){let{pluginName:t,i18n:r,onAuth:n}=e;const i="Google Drive"===t,a=hooks_module_q((e=>{e.preventDefault(),n()}),[n]);return _("form",{onSubmit:a},i?_("button",{type:"submit",className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn uppy-Provider-btn-google","data-uppy-super-focusable":!0},_(GoogleIcon,null),r("signInWithGoogle")):_("button",{type:"submit",className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn","data-uppy-super-focusable":!0},r("authenticateWith",{pluginName:t})))}const defaultRenderForm=e=>{let{pluginName:t,i18n:r,onAuth:n}=e;return _(DefaultForm,{pluginName:t,i18n:r,onAuth:n})};function AuthView_AuthView(e){let{loading:t,pluginName:r,pluginIcon:n,i18n:i,handleAuth:a,renderForm:s=defaultRenderForm}=e;return _("div",{className:"uppy-Provider-auth"},_("div",{className:"uppy-Provider-authIcon"},n()),_("div",{className:"uppy-Provider-authTitle"},i("authenticateWithTitle",{pluginName:r})),s({pluginName:r,i18n:i,loading:t,onAuth:a}))}function User(e){let{i18n:t,logout:r,username:n}=e;return _(k,null,n&&_("span",{className:"uppy-ProviderBrowser-user",key:"username"},n),_("button",{type:"button",onClick:r,className:"uppy-u-reset uppy-c-btn uppy-ProviderBrowser-userLogout",key:"logout"},t("logOut")))}function Breadcrumbs(e){const{openFolder:t,title:r,breadcrumbsIcon:n,breadcrumbs:i,i18n:a}=e;return _("div",{className:"uppy-Provider-breadcrumbs"},_("div",{className:"uppy-Provider-breadcrumbsIcon"},n),i.map(((e,n)=>{var s;return _(k,null,_("button",{key:e.id,type:"button",className:"uppy-u-reset uppy-c-btn",onClick:()=>t(e.id)},"root"===e.type?r:null!=(s=e.data.name)?s:a("unnamed")),i.length===n+1?"":" / ")})))}function Header(e){return _("div",{className:"uppy-ProviderBrowser-header"},_("div",{className:classnames("uppy-ProviderBrowser-headerBar",!e.showBreadcrumbs&&"uppy-ProviderBrowser-headerBar--simple")},e.showBreadcrumbs&&_(Breadcrumbs,{openFolder:e.openFolder,breadcrumbs:e.breadcrumbs,breadcrumbsIcon:e.pluginIcon&&e.pluginIcon(),title:e.title,i18n:e.i18n}),_(User,{logout:e.logout,username:e.username,i18n:e.i18n})))}function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_extends.apply(null,arguments)}const STYLE_INNER={position:"relative",width:"100%",minHeight:"100%"},STYLE_CONTENT={position:"absolute",top:0,left:0,width:"100%",overflow:"visible"};class VirtualList extends x{constructor(e){super(e),this.handleScroll=()=>{this.setState({offset:this.base.scrollTop})},this.handleResize=()=>{this.resize()},this.focusElement=null,this.state={offset:0,height:0}}componentDidMount(){this.resize(),window.addEventListener("resize",this.handleResize)}componentWillUpdate(){this.base.contains(document.activeElement)&&(this.focusElement=document.activeElement)}componentDidUpdate(){this.focusElement&&this.focusElement.parentNode&&document.activeElement!==this.focusElement&&this.focusElement.focus(),this.focusElement=null,this.resize()}componentWillUnmount(){window.removeEventListener("resize",this.handleResize)}resize(){const{height:e}=this.state;e!==this.base.offsetHeight&&this.setState({height:this.base.offsetHeight})}render(e){let{data:t,rowHeight:r,renderRow:n,overscanCount:i=10,...a}=e;const{offset:s,height:o}=this.state;let l=Math.floor(s/r),c=Math.floor(o/r);i&&(l=Math.max(0,l-l%i),c+=i);const d=l+c+4,u=t.slice(l,d),p={...STYLE_INNER,height:t.length*r},h={...STYLE_CONTENT,top:l*r};return _("div",_extends({onScroll:this.handleScroll},a),_("div",{role:"presentation",style:p},_("div",{role:"presentation",style:h},u.map(n))))}}const lib_VirtualList=VirtualList;function FileIcon(){return _("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:11,height:14.5,viewBox:"0 0 44 58"},_("path",{d:"M27.437.517a1 1 0 0 0-.094.03H4.25C2.037.548.217 2.368.217 4.58v48.405c0 2.212 1.82 4.03 4.03 4.03H39.03c2.21 0 4.03-1.818 4.03-4.03V15.61a1 1 0 0 0-.03-.28 1 1 0 0 0 0-.093 1 1 0 0 0-.03-.032 1 1 0 0 0 0-.03 1 1 0 0 0-.032-.063 1 1 0 0 0-.03-.063 1 1 0 0 0-.032 0 1 1 0 0 0-.03-.063 1 1 0 0 0-.032-.03 1 1 0 0 0-.03-.063 1 1 0 0 0-.063-.062l-14.593-14a1 1 0 0 0-.062-.062A1 1 0 0 0 28 .708a1 1 0 0 0-.374-.157 1 1 0 0 0-.156 0 1 1 0 0 0-.03-.03l-.003-.003zM4.25 2.547h22.218v9.97c0 2.21 1.82 4.03 4.03 4.03h10.564v36.438a2.02 2.02 0 0 1-2.032 2.032H4.25c-1.13 0-2.032-.9-2.032-2.032V4.58c0-1.13.902-2.032 2.03-2.032zm24.218 1.345l10.375 9.937.75.718H30.5c-1.13 0-2.032-.9-2.032-2.03V3.89z"}))}function FolderIcon(){return _("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",style:{minWidth:16,marginRight:3},viewBox:"0 0 276.157 276.157"},_("path",{d:"M273.08 101.378c-3.3-4.65-8.86-7.32-15.254-7.32h-24.34V67.59c0-10.2-8.3-18.5-18.5-18.5h-85.322c-3.63 0-9.295-2.875-11.436-5.805l-6.386-8.735c-4.982-6.814-15.104-11.954-23.546-11.954H58.73c-9.292 0-18.638 6.608-21.737 15.372l-2.033 5.752c-.958 2.71-4.72 5.37-7.596 5.37H18.5C8.3 49.09 0 57.39 0 67.59v167.07c0 .886.16 1.73.443 2.52.152 3.306 1.18 6.424 3.053 9.064 3.3 4.652 8.86 7.32 15.255 7.32h188.487c11.395 0 23.27-8.425 27.035-19.18l40.677-116.188c2.11-6.035 1.43-12.164-1.87-16.816zM18.5 64.088h8.864c9.295 0 18.64-6.607 21.738-15.37l2.032-5.75c.96-2.712 4.722-5.373 7.597-5.373h29.565c3.63 0 9.295 2.876 11.437 5.806l6.386 8.735c4.982 6.815 15.104 11.954 23.546 11.954h85.322c1.898 0 3.5 1.602 3.5 3.5v26.47H69.34c-11.395 0-23.27 8.423-27.035 19.178L15 191.23V67.59c0-1.898 1.603-3.5 3.5-3.5zm242.29 49.15l-40.676 116.188c-1.674 4.78-7.812 9.135-12.877 9.135H18.75c-1.447 0-2.576-.372-3.02-.997-.442-.625-.422-1.814.057-3.18l40.677-116.19c1.674-4.78 7.812-9.134 12.877-9.134h188.487c1.448 0 2.577.372 3.02.997.443.625.423 1.814-.056 3.18z"}))}function VideoIcon(){return _("svg",{"aria-hidden":"true",focusable:"false",style:{width:16,marginRight:4},viewBox:"0 0 58 58"},_("path",{d:"M36.537 28.156l-11-7a1.005 1.005 0 0 0-1.02-.033C24.2 21.3 24 21.635 24 22v14a1 1 0 0 0 1.537.844l11-7a1.002 1.002 0 0 0 0-1.688zM26 34.18V23.82L34.137 29 26 34.18z"}),_("path",{d:"M57 6H1a1 1 0 0 0-1 1v44a1 1 0 0 0 1 1h56a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1zM10 28H2v-9h8v9zm-8 2h8v9H2v-9zm10 10V8h34v42H12V40zm44-12h-8v-9h8v9zm-8 2h8v9h-8v-9zm8-22v9h-8V8h8zM2 8h8v9H2V8zm0 42v-9h8v9H2zm54 0h-8v-9h8v9z"}))}function ItemIcon(e){let{itemIconString:t,alt:r}=e;if(null===t)return null;switch(t){case"file":return _(FileIcon,null);case"folder":return _(FolderIcon,null);case"video":return _(VideoIcon,null);default:return _("img",{src:t,alt:r,referrerPolicy:"no-referrer",loading:"lazy",width:16,height:16})}}function GridItem(e){var t,r;let{file:n,toggleCheckbox:i,className:a,isDisabled:s,restrictionError:o,showTitles:l,children:c=null,i18n:d}=e;return _("li",{className:a,title:s&&o?o:void 0},_("input",{type:"checkbox",className:"uppy-u-reset uppy-ProviderBrowserItem-checkbox uppy-ProviderBrowserItem-checkbox--grid",onChange:i,name:"listitem",id:n.id,checked:"checked"===n.status,disabled:s,"data-uppy-super-focusable":!0}),_("label",{htmlFor:n.id,"aria-label":null!=(t=n.data.name)?t:d("unnamed"),className:"uppy-u-reset uppy-ProviderBrowserItem-inner"},_(ItemIcon,{itemIconString:n.data.thumbnail||n.data.icon}),l&&(null!=(r=n.data.name)?r:d("unnamed")),c))}const components_GridItem=GridItem;function ListItem(e){var t,r,n;let{file:i,openFolder:a,className:s,isDisabled:o,restrictionError:l,toggleCheckbox:c,showTitles:d,i18n:u}=e;return _("li",{className:s,title:"checked"!==i.status&&l?l:void 0},_("input",{type:"checkbox",className:"uppy-u-reset uppy-ProviderBrowserItem-checkbox",onChange:c,name:"listitem",id:i.id,checked:"checked"===i.status,"aria-label":i.data.isFolder?u("allFilesFromFolderNamed",{name:null!=(t=i.data.name)?t:u("unnamed")}):null,disabled:o,"data-uppy-super-focusable":!0}),i.data.isFolder?_("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-ProviderBrowserItem-inner",onClick:()=>a(i.id),"aria-label":u("openFolderNamed",{name:null!=(r=i.data.name)?r:u("unnamed")})},_("div",{className:"uppy-ProviderBrowserItem-iconWrap"},_(ItemIcon,{itemIconString:i.data.icon})),d&&i.data.name?_("span",null,i.data.name):u("unnamed")):_("label",{htmlFor:i.id,className:"uppy-u-reset uppy-ProviderBrowserItem-inner"},_("div",{className:"uppy-ProviderBrowserItem-iconWrap"},_(ItemIcon,{itemIconString:i.data.icon})),d&&(null!=(n=i.data.name)?n:u("unnamed"))))}function Item(e){const{viewType:t,toggleCheckbox:r,showTitles:n,i18n:i,openFolder:a,file:s,utmSource:o}=e,l="folder"===s.type?null:s.restrictionError,c=!!l&&"checked"!==s.status,d={file:s,openFolder:a,toggleCheckbox:r,utmSource:o,i18n:i,viewType:t,showTitles:n,className:classnames("uppy-ProviderBrowserItem",{"uppy-ProviderBrowserItem--disabled":c},{"uppy-ProviderBrowserItem--noPreview":"video"===s.data.icon},{"uppy-ProviderBrowserItem--is-checked":"checked"===s.status},{"uppy-ProviderBrowserItem--is-partial":"partial"===s.status}),isDisabled:c,restrictionError:l};switch(t){case"grid":return _(components_GridItem,d);case"list":return _(ListItem,d);case"unsplash":return _(components_GridItem,d,_("a",{href:`${s.data.author.url}?utm_source=${o}&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",className:"uppy-ProviderBrowserItem-author",tabIndex:-1},s.data.author.name));default:throw new Error(`There is no such type ${t}`)}}function Browser(e){const{displayedPartialTree:t,viewType:r,toggleCheckbox:n,handleScroll:i,showTitles:a,i18n:s,isLoading:o,openFolder:l,noResultsLabel:c,virtualList:d,utmSource:u}=e,[p,h]=hooks_module_d(!1);if(hooks_module_y((()=>{const e=e=>{"Shift"===e.key&&h(!1)},t=e=>{"Shift"===e.key&&h(!0)};return document.addEventListener("keyup",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("keyup",e),document.removeEventListener("keydown",t)}}),[]),o)return _("div",{className:"uppy-Provider-loading"},"string"==typeof o?o:s("loading"));if(0===t.length)return _("div",{className:"uppy-Provider-empty"},c);const f=e=>_(Item,{viewType:r,toggleCheckbox:t=>{var r;t.stopPropagation(),t.preventDefault(),null==(r=document.getSelection())||r.removeAllRanges(),n(e,p)},showTitles:a,i18n:s,openFolder:l,file:e,utmSource:u});return _("div",{className:"uppy-ProviderBrowser-body"},d?_("ul",{className:"uppy-ProviderBrowser-list"},_(lib_VirtualList,{data:t,renderRow:f,rowHeight:31})):_("ul",{className:"uppy-ProviderBrowser-list",onScroll:i,role:"listbox",tabIndex:-1},t.map(f)))}const lib_Browser=Browser,afterOpenFolder=(e,t,r,n,i)=>{const a=t.filter((e=>!0===e.isFolder)),s=t.filter((e=>!1===e.isFolder)),o="folder"===r.type&&"checked"===r.status,l=a.map((e=>({type:"folder",id:e.requestPath,cached:!1,nextPagePath:null,status:o?"checked":"unchecked",parentId:r.id,data:e}))),c=s.map((e=>{const t=i(e);return{type:"file",id:e.requestPath,restrictionError:t,status:o&&!t?"checked":"unchecked",parentId:r.id,data:e}})),d={...r,cached:!0,nextPagePath:n};return[...e.map((e=>e.id===d.id?d:e)),...l,...c]},PartialTreeUtils_afterOpenFolder=afterOpenFolder,afterScrollFolder=(e,t,r,n,i)=>{const a=e.find((e=>e.id===t)),s=r.filter((e=>!0===e.isFolder)),o=r.filter((e=>!1===e.isFolder)),l={...a,nextPagePath:n},c=e.map((e=>e.id===l.id?l:e)),d="folder"===l.type&&"checked"===l.status;return[...c,...s.map((e=>({type:"folder",id:e.requestPath,cached:!1,nextPagePath:null,status:d?"checked":"unchecked",parentId:l.id,data:e}))),...o.map((e=>{const t=i(e);return{type:"file",id:e.requestPath,restrictionError:t,status:d&&!t?"checked":"unchecked",parentId:l.id,data:e}}))]},PartialTreeUtils_afterScrollFolder=afterScrollFolder,shallowClone=e=>e.map((e=>({...e}))),PartialTreeUtils_shallowClone=shallowClone,percolateDown=(e,t,r)=>{const n=e.filter((e=>"root"!==e.type&&e.parentId===t));n.forEach((t=>{t.status=!r||"file"===t.type&&t.restrictionError?"unchecked":"checked",percolateDown(e,t.id,r)}))},percolateUp=(e,t)=>{const r=e.find((e=>e.id===t));if("root"===r.type)return;const n=e.filter((e=>"root"!==e.type&&e.parentId===r.id&&!("file"===e.type&&e.restrictionError))),i=n.every((e=>"checked"===e.status)),a=n.every((e=>"unchecked"===e.status));r.status=i?"checked":a?"unchecked":"partial",percolateUp(e,r.parentId)},afterToggleCheckbox=(e,t)=>{const r=PartialTreeUtils_shallowClone(e);if(t.length>=2){const e=r.filter((e=>"root"!==e.type&&t.includes(e.id)));e.forEach((e=>{"file"===e.type?e.status=e.restrictionError?"unchecked":"checked":e.status="checked"})),e.forEach((e=>{percolateDown(r,e.id,!0)})),percolateUp(r,e[0].parentId)}else{const e=r.find((e=>e.id===t[0]));e.status="checked"===e.status?"unchecked":"checked",percolateDown(r,e.id,"checked"===e.status),percolateUp(r,e.parentId)}return r},PartialTreeUtils_afterToggleCheckbox=afterToggleCheckbox;var eventemitter3=__webpack_require__(228);const node_modules_eventemitter3=null;class TimeoutError extends Error{constructor(e){super(e),this.name="TimeoutError"}}class AbortError extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const getDOMException=e=>void 0===globalThis.DOMException?new AbortError(e):new DOMException(e),getAbortedReason=e=>{const t=void 0===e.reason?getDOMException("This operation was aborted."):e.reason;return t instanceof Error?t:getDOMException(t)};function pTimeout(e,t){const{milliseconds:r,fallback:n,message:i,customTimers:a={setTimeout,clearTimeout}}=t;let s,o;const l=new Promise(((l,c)=>{if("number"!=typeof r||1!==Math.sign(r))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${r}\``);if(t.signal){const{signal:e}=t;e.aborted&&c(getAbortedReason(e)),o=()=>{c(getAbortedReason(e))},e.addEventListener("abort",o,{once:!0})}if(r===Number.POSITIVE_INFINITY)return void e.then(l,c);const d=new TimeoutError;s=a.setTimeout.call(void 0,(()=>{if(n)try{l(n())}catch(e){c(e)}else"function"==typeof e.cancel&&e.cancel(),!1===i?l():i instanceof Error?c(i):(d.message=i??`Promise timed out after ${r} milliseconds`,c(d))}),r),(async()=>{try{l(await e)}catch(e){c(e)}})()})).finally((()=>{l.clear(),o&&t.signal&&t.signal.removeEventListener("abort",o)}));return l.clear=()=>{a.clearTimeout.call(void 0,s),s=void 0},l}function lowerBound(e,t,r){let n=0,i=e.length;for(;i>0;){const a=Math.trunc(i/2);let s=n+a;r(e[s],t)<=0?(n=++s,i-=a+1):i=a}return n}class PriorityQueue{#e=[];enqueue(e,t){const r={priority:(t={priority:0,...t}).priority,id:t.id,run:e};if(0===this.size||this.#e[this.size-1].priority>=t.priority)return void this.#e.push(r);const n=lowerBound(this.#e,r,((e,t)=>t.priority-e.priority));this.#e.splice(n,0,r)}setPriority(e,t){const r=this.#e.findIndex((t=>t.id===e));if(-1===r)throw new ReferenceError(`No promise function with the id "${e}" exists in the queue.`);const[n]=this.#e.splice(r,1);this.enqueue(n.run,{priority:t,id:e})}dequeue(){const e=this.#e.shift();return e?.run}filter(e){return this.#e.filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return this.#e.length}}class PQueue extends eventemitter3{#t;#r;#n=0;#i;#a;#s=0;#o;#l;#e;#c;#d=0;#u;#p;#h;#f=1n;timeout;constructor(e){if(super(),!("number"==typeof(e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:PriorityQueue,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${e.intervalCap?.toString()??""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${e.interval?.toString()??""}\` (${typeof e.interval})`);this.#t=e.carryoverConcurrencyCount,this.#r=e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,this.#i=e.intervalCap,this.#a=e.interval,this.#e=new e.queueClass,this.#c=e.queueClass,this.concurrency=e.concurrency,this.timeout=e.timeout,this.#h=!0===e.throwOnTimeout,this.#p=!1===e.autoStart}get#m(){return this.#r||this.#n<this.#i}get#g(){return this.#d<this.#u}#_(){this.#d--,this.#b(),this.emit("next")}#v(){this.#y(),this.#w(),this.#l=void 0}get#E(){const e=Date.now();if(void 0===this.#o){const t=this.#s-e;if(!(t<0))return void 0===this.#l&&(this.#l=setTimeout((()=>{this.#v()}),t)),!0;this.#n=this.#t?this.#d:0}return!1}#b(){if(0===this.#e.size)return this.#o&&clearInterval(this.#o),this.#o=void 0,this.emit("empty"),0===this.#d&&this.emit("idle"),!1;if(!this.#p){const e=!this.#E;if(this.#m&&this.#g){const t=this.#e.dequeue();return!!t&&(this.emit("active"),t(),e&&this.#w(),!0)}}return!1}#w(){this.#r||void 0!==this.#o||(this.#o=setInterval((()=>{this.#y()}),this.#a),this.#s=Date.now()+this.#a)}#y(){0===this.#n&&0===this.#d&&this.#o&&(clearInterval(this.#o),this.#o=void 0),this.#n=this.#t?this.#d:0,this.#S()}#S(){for(;this.#b(););}get concurrency(){return this.#u}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this.#u=e,this.#S()}async#T(e){return new Promise(((t,r)=>{e.addEventListener("abort",(()=>{r(e.reason)}),{once:!0})}))}setPriority(e,t){this.#e.setPriority(e,t)}async add(e,t={}){return t.id??=(this.#f++).toString(),t={timeout:this.timeout,throwOnTimeout:this.#h,...t},new Promise(((r,n)=>{this.#e.enqueue((async()=>{this.#d++,this.#n++;try{t.signal?.throwIfAborted();let n=e({signal:t.signal});t.timeout&&(n=pTimeout(Promise.resolve(n),{milliseconds:t.timeout})),t.signal&&(n=Promise.race([n,this.#T(t.signal)]));const i=await n;r(i),this.emit("completed",i)}catch(e){if(e instanceof TimeoutError&&!t.throwOnTimeout)return void r();n(e),this.emit("error",e)}finally{this.#_()}}),t),this.emit("add"),this.#b()}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return this.#p?(this.#p=!1,this.#S(),this):this}pause(){this.#p=!0}clear(){this.#e=new this.#c}async onEmpty(){0!==this.#e.size&&await this.#C("empty")}async onSizeLessThan(e){this.#e.size<e||await this.#C("next",(()=>this.#e.size<e))}async onIdle(){0===this.#d&&0===this.#e.size||await this.#C("idle")}async#C(e,t){return new Promise((r=>{const n=()=>{t&&!t()||(this.off(e,n),r())};this.on(e,n)}))}get size(){return this.#e.size}sizeBy(e){return this.#e.filter(e).length}get pending(){return this.#d}get isPaused(){return this.#p}}const recursivelyFetch=async(e,t,r,n,i)=>{let a=[],s=r.cached?r.nextPagePath:r.id;for(;s;){const e=await n(s);a=a.concat(e.items),s=e.nextPagePath}const o=a.filter((e=>!0===e.isFolder)),l=a.filter((e=>!1===e.isFolder)),c=o.map((e=>({type:"folder",id:e.requestPath,cached:!1,nextPagePath:null,status:"checked",parentId:r.id,data:e}))),d=l.map((e=>{const t=i(e);return{type:"file",id:e.requestPath,restrictionError:t,status:t?"unchecked":"checked",parentId:r.id,data:e}}));r.cached=!0,r.nextPagePath=null,t.push(...d,...c),c.forEach((async r=>{e.add((()=>recursivelyFetch(e,t,r,n,i)))}))},afterFill=async(e,t,r,n)=>{const i=new PQueue({concurrency:6}),a=PartialTreeUtils_shallowClone(e),s=a.filter((e=>"folder"===e.type&&"checked"===e.status&&(!1===e.cached||e.nextPagePath)));return s.forEach((e=>{i.add((()=>recursivelyFetch(i,a,e,t,r)))})),i.on("completed",(()=>{const e=a.filter((e=>"file"===e.type&&"checked"===e.status)).length;n(e)})),await i.onIdle(),a},PartialTreeUtils_afterFill=afterFill,PartialTreeUtils={afterOpenFolder:PartialTreeUtils_afterOpenFolder,afterScrollFolder:PartialTreeUtils_afterScrollFolder,afterToggleCheckbox:PartialTreeUtils_afterToggleCheckbox,afterFill:PartialTreeUtils_afterFill},shouldHandleScroll=e=>{const{scrollHeight:t,scrollTop:r,offsetHeight:n}=e.target;return t-(r+n)<50},utils_shouldHandleScroll=shouldHandleScroll,handleError=e=>t=>{t.isAuthError||("AbortError"!==t.name?(e.log(t,"error"),"UserFacingApiError"===t.name&&e.info({message:e.i18n("companionError"),details:e.i18n(t.message)},"warning",5e3)):e.log("Aborting request","warning"))},utils_handleError=handleError,getClickedRange=(e,t,r,n)=>{const i=t.findIndex((e=>e.id===n));if(-1!==i&&r){const r=t.findIndex((t=>t.id===e));return t.slice(Math.min(i,r),Math.max(i,r)+1).map((e=>e.id))}return[e]},utils_getClickedRange=getClickedRange;function SearchInput(e){let{searchString:t,setSearchString:r,submitSearchString:n,wrapperClassName:i,inputClassName:a,inputLabel:s,clearSearchLabel:o="",showButton:l=!1,buttonLabel:c="",buttonCSSClassName:d=""}=e;const u=hooks_module_q((e=>{e.preventDefault(),n()}),[n]),[p]=hooks_module_d((()=>{const e=document.createElement("form");return e.setAttribute("tabindex","-1"),e.id=nanoid(),e}));return hooks_module_y((()=>(document.body.appendChild(p),p.addEventListener("submit",u),()=>{p.removeEventListener("submit",u),document.body.removeChild(p)})),[p,u]),_("section",{className:i},_("input",{className:`uppy-u-reset ${a}`,type:"search","aria-label":s,placeholder:s,value:t,onInput:e=>{r(e.target.value)},form:p.id,"data-uppy-super-focusable":!0}),!l&&_("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-ProviderBrowser-searchFilterIcon",width:"12",height:"12",viewBox:"0 0 12 12"},_("path",{d:"M8.638 7.99l3.172 3.172a.492.492 0 1 1-.697.697L7.91 8.656a4.977 4.977 0 0 1-2.983.983C2.206 9.639 0 7.481 0 4.819 0 2.158 2.206 0 4.927 0c2.721 0 4.927 2.158 4.927 4.82a4.74 4.74 0 0 1-1.216 3.17zm-3.71.685c2.176 0 3.94-1.726 3.94-3.856 0-2.129-1.764-3.855-3.94-3.855C2.75.964.984 2.69.984 4.819c0 2.13 1.765 3.856 3.942 3.856z"})),!l&&t&&_("button",{className:"uppy-u-reset uppy-ProviderBrowser-searchFilterReset",type:"button","aria-label":o,title:o,onClick:()=>r("")},_("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",viewBox:"0 0 19 19"},_("path",{d:"M17.318 17.232L9.94 9.854 9.586 9.5l-.354.354-7.378 7.378h.707l-.62-.62v.706L9.318 9.94l.354-.354-.354-.354L1.94 1.854v.707l.62-.62h-.706l7.378 7.378.354.354.354-.354 7.378-7.378h-.707l.622.62v-.706L9.854 9.232l-.354.354.354.354 7.378 7.378.708-.707-7.38-7.378v.708l7.38-7.38.353-.353-.353-.353-.622-.622-.353-.353-.354.352-7.378 7.38h.708L2.56 1.23 2.208.88l-.353.353-.622.62-.353.355.352.353 7.38 7.38v-.708l-7.38 7.38-.353.353.352.353.622.622.353.353.354-.353 7.38-7.38h-.708l7.38 7.38z"}))),l&&_("button",{className:`uppy-u-reset uppy-c-btn uppy-c-btn-primary ${d}`,type:"submit",form:p.id},c))}const lib_SearchInput=SearchInput,getNumberOfSelectedFiles=e=>{const t=e.filter((t=>{if("file"===t.type&&"checked"===t.status)return!0;if("folder"===t.type&&"checked"===t.status){const r=e.some((e=>"root"!==e.type&&e.parentId===t.id));return!r}return!1}));return t.length},PartialTreeUtils_getNumberOfSelectedFiles=getNumberOfSelectedFiles;function FooterActions(e){let{cancelSelection:t,donePicking:r,i18n:n,partialTree:i,validateAggregateRestrictions:a}=e;const s=hooks_module_T((()=>a(i)),[i,a]),o=hooks_module_T((()=>PartialTreeUtils_getNumberOfSelectedFiles(i)),[i]);return 0===o?null:_("div",{className:"uppy-ProviderBrowser-footer"},_("div",{className:"uppy-ProviderBrowser-footer-buttons"},_("button",{className:classnames("uppy-u-reset uppy-c-btn uppy-c-btn-primary",{"uppy-c-btn--disabled":s}),disabled:!!s,onClick:r,type:"button"},n("selectX",{smart_count:o})),_("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-link",onClick:t,type:"button"},n("cancel"))),s&&_("div",{className:"uppy-ProviderBrowser-footer-error"},s))}const getTagFile=(e,t,r)=>{var n,i;return{id:e.id,source:t.id,name:e.name||e.id,type:e.mimeType,isRemote:!0,data:e,preview:e.thumbnail||void 0,meta:{authorName:null==(n=e.author)?void 0:n.name,authorUrl:null==(i=e.author)?void 0:i.url,relativePath:e.relDirPath||null,absolutePath:e.absDirPath},body:{fileId:e.id},remote:{companionUrl:t.opts.companionUrl,url:`${r.fileUrl(e.requestPath)}`,body:{fileId:e.id},providerName:r.name,provider:r.provider,requestClientId:r.provider}}},utils_getTagFile=getTagFile,addFiles=(e,t,r)=>{const n=e.map((e=>utils_getTagFile(e,t,r))),i=[],a=[];n.forEach((e=>{t.uppy.checkIfFileAlreadyExists(getSafeFileId(e,t.uppy.getID()))?a.push(e):i.push(e)})),i.length>0&&t.uppy.info(t.uppy.i18n("addedNumFiles",{numFiles:i.length})),a.length>0&&t.uppy.info(`Not adding ${a.length} files because they already exist`),t.uppy.addFiles(i)},utils_addFiles=addFiles,getPath=(e,t,r)=>{const n=null===t?"null":t;if(r[n])return r[n];const i=e.find((e=>e.id===t));if("root"===i.type)return[];const a=[...getPath(e,i.parentId,r),i];return r[n]=a,a},getCheckedFilesWithPaths=e=>{const t=Object.create(null),r=e.filter((e=>"file"===e.type&&"checked"===e.status)),n=r.map((r=>{const n=getPath(e,r.id,t),i=n.findIndex((e=>"folder"===e.type&&"checked"===e.status)),a=n.slice(i),s=`/${n.map((e=>e.data.name)).join("/")}`,o=1===a.length?void 0:a.map((e=>e.data.name)).join("/");return{...r.data,absDirPath:s,relDirPath:o}}));return n},PartialTreeUtils_getCheckedFilesWithPaths=getCheckedFilesWithPaths,getBreadcrumbs=(e,t)=>{let r=e.find((e=>e.id===t)),n=[];for(;n=[r,...n],"root"!==r.type;){const t=r.parentId;r=e.find((e=>e.id===t))}return n},PartialTreeUtils_getBreadcrumbs=getBreadcrumbs;function ProviderView_classPrivateFieldLooseBase(e,t){if(!{}.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var ProviderView_id=0;function ProviderView_classPrivateFieldLooseKey(e){return"__private_"+ProviderView_id+++"_"+e}const ProviderView_packageJson={version:"4.4.2"};function defaultPickerIcon(){return _("svg",{"aria-hidden":"true",focusable:"false",width:"30",height:"30",viewBox:"0 0 30 30"},_("path",{d:"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z"}))}const getDefaultState=e=>({authenticated:void 0,partialTree:[{type:"root",id:e,cached:!1,nextPagePath:null}],currentFolderId:e,searchString:"",didFirstRender:!1,username:null,loading:!1});var _abortController=ProviderView_classPrivateFieldLooseKey("abortController"),_withAbort=ProviderView_classPrivateFieldLooseKey("withAbort");class ProviderView{constructor(e,t){Object.defineProperty(this,_withAbort,{value:_withAbort2}),this.isHandlingScroll=!1,this.lastCheckbox=null,Object.defineProperty(this,_abortController,{writable:!0,value:void 0}),this.validateSingleFile=e=>{const t=remoteFileObjToLocal(e);return this.plugin.uppy.validateSingleFile(t)},this.getDisplayedPartialTree=()=>{const{partialTree:e,currentFolderId:t,searchString:r}=this.plugin.getPluginState(),n=e.filter((e=>"root"!==e.type&&e.parentId===t)),i=""===r?n:n.filter((e=>{var t;return-1!==(null!=(t=e.data.name)?t:this.plugin.uppy.i18n("unnamed")).toLowerCase().indexOf(r.toLowerCase())}));return i},this.validateAggregateRestrictions=e=>{const t=e.filter((e=>"file"===e.type&&"checked"===e.status)),r=t.map((e=>e.data));return this.plugin.uppy.validateAggregateRestrictions(r)},this.plugin=e,this.provider=t.provider,this.opts={viewType:"list",showTitles:!0,showFilter:!0,showBreadcrumbs:!0,loadAllFiles:!1,virtualList:!1,...t},this.openFolder=this.openFolder.bind(this),this.logout=this.logout.bind(this),this.handleAuth=this.handleAuth.bind(this),this.handleScroll=this.handleScroll.bind(this),this.resetPluginState=this.resetPluginState.bind(this),this.donePicking=this.donePicking.bind(this),this.render=this.render.bind(this),this.cancelSelection=this.cancelSelection.bind(this),this.toggleCheckbox=this.toggleCheckbox.bind(this),this.resetPluginState(),this.plugin.uppy.on("dashboard:close-panel",this.resetPluginState),this.plugin.uppy.registerRequestClient(this.provider.provider,this.provider)}resetPluginState(){this.plugin.setPluginState(getDefaultState(this.plugin.rootFolderId))}tearDown(){}setLoading(e){this.plugin.setPluginState({loading:e})}cancelSelection(){const{partialTree:e}=this.plugin.getPluginState(),t=e.map((e=>"root"===e.type?e:{...e,status:"unchecked"}));this.plugin.setPluginState({partialTree:t})}async openFolder(e){this.lastCheckbox=null;const{partialTree:t}=this.plugin.getPluginState(),r=t.find((t=>t.id===e));r.cached?this.plugin.setPluginState({currentFolderId:e,searchString:""}):(this.setLoading(!0),await ProviderView_classPrivateFieldLooseBase(this,_withAbort)[_withAbort]((async n=>{let i=e,a=[];do{const{username:e,nextPagePath:t,items:r}=await this.provider.list(i,{signal:n});this.plugin.setPluginState({username:e}),i=t,a=a.concat(r),this.setLoading(this.plugin.uppy.i18n("loadedXFiles",{numFiles:a.length}))}while(this.opts.loadAllFiles&&i);const s=PartialTreeUtils.afterOpenFolder(t,a,r,i,this.validateSingleFile);this.plugin.setPluginState({partialTree:s,currentFolderId:e,searchString:""})})).catch(utils_handleError(this.plugin.uppy)),this.setLoading(!1))}async logout(){await ProviderView_classPrivateFieldLooseBase(this,_withAbort)[_withAbort]((async e=>{const t=await this.provider.logout({signal:e});if(t.ok){if(!t.revoked){const e=this.plugin.uppy.i18n("companionUnauthorizeHint",{provider:this.plugin.title,url:t.manual_revoke_url});this.plugin.uppy.info(e,"info",7e3)}this.plugin.setPluginState({...getDefaultState(this.plugin.rootFolderId),authenticated:!1})}})).catch(utils_handleError(this.plugin.uppy))}async handleAuth(e){await ProviderView_classPrivateFieldLooseBase(this,_withAbort)[_withAbort]((async t=>{this.setLoading(!0),await this.provider.login({authFormData:e,signal:t}),this.plugin.setPluginState({authenticated:!0}),await Promise.all([this.provider.fetchPreAuthToken(),this.openFolder(this.plugin.rootFolderId)])})).catch(utils_handleError(this.plugin.uppy)),this.setLoading(!1)}async handleScroll(e){const{partialTree:t,currentFolderId:r}=this.plugin.getPluginState(),n=t.find((e=>e.id===r));utils_shouldHandleScroll(e)&&!this.isHandlingScroll&&n.nextPagePath&&(this.isHandlingScroll=!0,await ProviderView_classPrivateFieldLooseBase(this,_withAbort)[_withAbort]((async e=>{const{nextPagePath:i,items:a}=await this.provider.list(n.nextPagePath,{signal:e}),s=PartialTreeUtils.afterScrollFolder(t,r,a,i,this.validateSingleFile);this.plugin.setPluginState({partialTree:s})})).catch(utils_handleError(this.plugin.uppy)),this.isHandlingScroll=!1)}async donePicking(){const{partialTree:e}=this.plugin.getPluginState();this.setLoading(!0),await ProviderView_classPrivateFieldLooseBase(this,_withAbort)[_withAbort]((async t=>{const r=await PartialTreeUtils.afterFill(e,(e=>this.provider.list(e,{signal:t})),this.validateSingleFile,(e=>{this.setLoading(this.plugin.uppy.i18n("addedNumFiles",{numFiles:e}))}));if(this.validateAggregateRestrictions(r))return void this.plugin.setPluginState({partialTree:r});const n=PartialTreeUtils_getCheckedFilesWithPaths(r);utils_addFiles(n,this.plugin,this.provider),this.resetPluginState()})).catch(utils_handleError(this.plugin.uppy)),this.setLoading(!1)}toggleCheckbox(e,t){const{partialTree:r}=this.plugin.getPluginState(),n=utils_getClickedRange(e.id,this.getDisplayedPartialTree(),t,this.lastCheckbox),i=PartialTreeUtils.afterToggleCheckbox(r,n);this.plugin.setPluginState({partialTree:i}),this.lastCheckbox=e.id}render(e,t){void 0===t&&(t={});const{didFirstRender:r}=this.plugin.getPluginState(),{i18n:n}=this.plugin.uppy;r||(this.plugin.setPluginState({didFirstRender:!0}),this.provider.fetchPreAuthToken(),this.openFolder(this.plugin.rootFolderId));const i={...this.opts,...t},{authenticated:a,loading:s}=this.plugin.getPluginState(),o=this.plugin.icon||defaultPickerIcon;if(!1===a)return _(AuthView_AuthView,{pluginName:this.plugin.title,pluginIcon:o,handleAuth:this.handleAuth,i18n:this.plugin.uppy.i18n,renderForm:i.renderAuthForm,loading:s});const{partialTree:l,currentFolderId:c,username:d,searchString:u}=this.plugin.getPluginState(),p=PartialTreeUtils_getBreadcrumbs(l,c);return _("div",{className:classnames("uppy-ProviderBrowser",`uppy-ProviderBrowser-viewType--${i.viewType}`)},_(Header,{showBreadcrumbs:i.showBreadcrumbs,openFolder:this.openFolder,breadcrumbs:p,pluginIcon:o,title:this.plugin.title,logout:this.logout,username:d,i18n:n}),i.showFilter&&_(lib_SearchInput,{searchString:u,setSearchString:e=>{this.plugin.setPluginState({searchString:e})},submitSearchString:()=>{},inputLabel:n("filter"),clearSearchLabel:n("resetFilter"),wrapperClassName:"uppy-ProviderBrowser-searchFilter",inputClassName:"uppy-ProviderBrowser-searchFilterInput"}),_(lib_Browser,{toggleCheckbox:this.toggleCheckbox,displayedPartialTree:this.getDisplayedPartialTree(),openFolder:this.openFolder,virtualList:i.virtualList,noResultsLabel:n("noFilesFound"),handleScroll:this.handleScroll,viewType:i.viewType,showTitles:i.showTitles,i18n:this.plugin.uppy.i18n,isLoading:s,utmSource:"Companion"}),_(FooterActions,{partialTree:l,donePicking:this.donePicking,cancelSelection:this.cancelSelection,i18n:n,validateAggregateRestrictions:this.validateAggregateRestrictions}))}}async function _withAbort2(e){var t;null==(t=ProviderView_classPrivateFieldLooseBase(this,_abortController)[_abortController])||t.abort();const r=new AbortController;ProviderView_classPrivateFieldLooseBase(this,_abortController)[_abortController]=r;const n=()=>{r.abort()};try{this.plugin.uppy.on("dashboard:close-panel",n),this.plugin.uppy.on("cancel-all",n),await e(r.signal)}finally{this.plugin.uppy.off("dashboard:close-panel",n),this.plugin.uppy.off("cancel-all",n),ProviderView_classPrivateFieldLooseBase(this,_abortController)[_abortController]=void 0}}ProviderView.VERSION=ProviderView_packageJson.version;const SearchProviderView_packageJson={version:"4.4.2"},defaultState={loading:!1,searchString:"",partialTree:[{type:"root",id:null,cached:!1,nextPagePath:null}],currentFolderId:null,isInputMode:!0},SearchProviderView_defaultOptions={viewType:"grid",showTitles:!0,showFilter:!0,utmSource:"Companion"};class SearchProviderView{constructor(e,t){this.isHandlingScroll=!1,this.lastCheckbox=null,this.validateSingleFile=e=>{const t=remoteFileObjToLocal(e);return this.plugin.uppy.validateSingleFile(t)},this.getDisplayedPartialTree=()=>{const{partialTree:e}=this.plugin.getPluginState();return e.filter((e=>"root"!==e.type))},this.setSearchString=e=>{this.plugin.setPluginState({searchString:e}),""===e&&this.plugin.setPluginState({partialTree:[]})},this.validateAggregateRestrictions=e=>{const t=e.filter((e=>"file"===e.type&&"checked"===e.status)),r=t.map((e=>e.data));return this.plugin.uppy.validateAggregateRestrictions(r)},this.plugin=e,this.provider=t.provider,this.opts={...SearchProviderView_defaultOptions,...t},this.setSearchString=this.setSearchString.bind(this),this.search=this.search.bind(this),this.resetPluginState=this.resetPluginState.bind(this),this.handleScroll=this.handleScroll.bind(this),this.donePicking=this.donePicking.bind(this),this.cancelSelection=this.cancelSelection.bind(this),this.toggleCheckbox=this.toggleCheckbox.bind(this),this.render=this.render.bind(this),this.resetPluginState(),this.plugin.uppy.on("dashboard:close-panel",this.resetPluginState),this.plugin.uppy.registerRequestClient(this.provider.provider,this.provider)}tearDown(){}setLoading(e){this.plugin.setPluginState({loading:e})}resetPluginState(){this.plugin.setPluginState(defaultState)}cancelSelection(){const{partialTree:e}=this.plugin.getPluginState(),t=e.map((e=>"root"===e.type?e:{...e,status:"unchecked"}));this.plugin.setPluginState({partialTree:t})}async search(){const{searchString:e}=this.plugin.getPluginState();if(""!==e){this.setLoading(!0);try{const t=await this.provider.search(e),r=[{type:"root",id:null,cached:!1,nextPagePath:t.nextPageQuery},...t.items.map((e=>({type:"file",id:e.requestPath,status:"unchecked",parentId:null,data:e})))];this.plugin.setPluginState({partialTree:r,isInputMode:!1})}catch(e){utils_handleError(this.plugin.uppy)(e)}this.setLoading(!1)}}async handleScroll(e){const{partialTree:t,searchString:r}=this.plugin.getPluginState(),n=t.find((e=>"root"===e.type));if(utils_shouldHandleScroll(e)&&!this.isHandlingScroll&&n.nextPagePath){this.isHandlingScroll=!0;try{const e=await this.provider.search(r,n.nextPagePath),i={...n,nextPagePath:e.nextPageQuery},a=t.filter((e=>"root"!==e.type)),s=[i,...a,...e.items.map((e=>({type:"file",id:e.requestPath,status:"unchecked",parentId:null,data:e})))];this.plugin.setPluginState({partialTree:s})}catch(e){utils_handleError(this.plugin.uppy)(e)}this.isHandlingScroll=!1}}async donePicking(){const{partialTree:e}=this.plugin.getPluginState(),t=PartialTreeUtils_getCheckedFilesWithPaths(e);utils_addFiles(t,this.plugin,this.provider),this.resetPluginState()}toggleCheckbox(e,t){const{partialTree:r}=this.plugin.getPluginState(),n=utils_getClickedRange(e.id,this.getDisplayedPartialTree(),t,this.lastCheckbox),i=PartialTreeUtils.afterToggleCheckbox(r,n);this.plugin.setPluginState({partialTree:i}),this.lastCheckbox=e.id}render(e,t){void 0===t&&(t={});const{isInputMode:r,searchString:n,loading:i,partialTree:a}=this.plugin.getPluginState(),{i18n:s}=this.plugin.uppy,o={...this.opts,...t};return r?_(lib_SearchInput,{searchString:n,setSearchString:this.setSearchString,submitSearchString:this.search,inputLabel:s("enterTextToSearch"),buttonLabel:s("searchImages"),wrapperClassName:"uppy-SearchProvider",inputClassName:"uppy-c-textInput uppy-SearchProvider-input",showButton:!0,buttonCSSClassName:"uppy-SearchProvider-searchButton"}):_("div",{className:classnames("uppy-ProviderBrowser",`uppy-ProviderBrowser-viewType--${o.viewType}`)},o.showFilter&&_(lib_SearchInput,{searchString:n,setSearchString:this.setSearchString,submitSearchString:this.search,inputLabel:s("search"),clearSearchLabel:s("resetSearch"),wrapperClassName:"uppy-ProviderBrowser-searchFilter",inputClassName:"uppy-ProviderBrowser-searchFilterInput"}),_(lib_Browser,{toggleCheckbox:this.toggleCheckbox,displayedPartialTree:this.getDisplayedPartialTree(),handleScroll:this.handleScroll,openFolder:async()=>{},noResultsLabel:s("noSearchResults"),viewType:o.viewType,showTitles:o.showTitles,isLoading:i,i18n:s,virtualList:!1,utmSource:this.opts.utmSource}),_(FooterActions,{partialTree:a,donePicking:this.donePicking,cancelSelection:this.cancelSelection,i18n:s,validateAggregateRestrictions:this.validateAggregateRestrictions}))}}SearchProviderView.VERSION=SearchProviderView_packageJson.version;const getAuthHeader=e=>({authorization:`Bearer ${e}`}),injectedScripts=new Set;let driveApiLoaded=!1;async function injectScript(e){injectedScripts.has(e)||(await new Promise(((t,r)=>{const n=document.createElement("script");n.src=e,n.addEventListener("load",(()=>t())),n.addEventListener("error",(e=>r(e.error))),document.head.appendChild(n)})),injectedScripts.add(e))}async function googlePicker_ensureScriptsInjected(e){await Promise.all([injectScript("https://accounts.google.com/gsi/client"),(async()=>{await injectScript("https://apis.google.com/js/api.js"),"drive"!==e||driveApiLoaded||(await new Promise((e=>gapi.load("client:picker",(()=>e())))),await gapi.client.load("https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"),driveApiLoaded=!0)})()])}async function isTokenValid(e,t){return!!(await fetch(`https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=${encodeURIComponent(e)}`,{signal:t})).ok}async function googlePicker_authorize(e){let{pickerType:t,clientId:r,accessToken:n}=e;const i=await new Promise(((e,i)=>{const a="drive"===t?["https://www.googleapis.com/auth/drive.file"]:["https://www.googleapis.com/auth/photospicker.mediaitems.readonly"],s=google.accounts.oauth2.initTokenClient({client_id:r,scope:a.join(" "),callback:e,error_callback:i});null===n?s.requestAccessToken({prompt:"consent"}):s.requestAccessToken({prompt:""})}));if(i.error)throw new Error(`OAuth2 error: ${i.error}`);return i.access_token}async function googlePicker_logout(e){await new Promise((t=>google.accounts.oauth2.revoke(e,t)))}class googlePicker_InvalidTokenError extends Error{constructor(){super("Invalid or expired token"),this.name="InvalidTokenError"}}async function googlePicker_showDrivePicker(e){let{token:t,apiKey:r,appId:n,onFilesPicked:i,signal:a}=e;if(!await isTokenValid(t,a))throw new googlePicker_InvalidTokenError;const s=(new google.picker.PickerBuilder).enableFeature(google.picker.Feature.NAV_HIDDEN).enableFeature(google.picker.Feature.MULTISELECT_ENABLED).setDeveloperKey(r).setAppId(n).setOAuthToken(t).addView(new google.picker.DocsView(google.picker.ViewId.DOCS).setIncludeFolders(!0).setSelectFolderEnabled(!1).setMode(google.picker.DocsViewMode.LIST)).setCallback((e=>{e.action===google.picker.Action.PICKED&&i(e.docs.map((e=>({platform:"drive",id:e.id,name:e.name,mimeType:e.mimeType}))),t)})).build();s.setVisible(!0),null==a||a.addEventListener("abort",(()=>s.dispose()))}async function googlePicker_showPhotosPicker(e){let{token:t,pickingSession:r,onPickingSessionChange:n,signal:i}=e;const a=getAuthHeader(t);let s=r;if(null==s){const e=await fetch("https://photospicker.googleapis.com/v1/sessions",{method:"post",headers:a,signal:i});var o;if(401===e.status)if("UNAUTHENTICATED"===(null==(o=(await e.json()).error)?void 0:o.status))throw new googlePicker_InvalidTokenError;if(!e.ok)throw new Error("Failed to create a session");s=await e.json(),n(s)}const l=window.open(s.pickerUri);null==i||i.addEventListener("abort",(()=>null==l?void 0:l.close()))}async function resolvePickedPhotos(e){let{accessToken:t,pickingSession:r,signal:n}=e;const i=getAuthHeader(t);let a,s=[];do{const e=100,t=await fetch(`https://photospicker.googleapis.com/v1/mediaItems?${new URLSearchParams({sessionId:r.id,pageSize:String(e)}).toString()}`,{headers:i,signal:n});if(!t.ok)throw new Error("Failed to get a media items");const{mediaItems:o,nextPageToken:l}=await t.json();a=l,s.push(...o)}while(a);return s=s.flatMap((e=>"PHOTO"===e.type||"VIDEO"===e.type&&"READY"===e.mediaFile.mediaFileMetadata.videoMetadata.processingStatus?[e]:[])),s.map((e=>{let{id:t,type:r,mediaFile:{mimeType:n,filename:i,baseUrl:a}}=e;return{platform:"photos",id:t,mimeType:n,url:"VIDEO"===r?`${a}=dv`:a,name:i}}))}async function googlePicker_pollPickingSession(e){let{pickingSessionRef:t,accessTokenRef:r,signal:n,onFilesPicked:i,onError:a}=e;for(let e=1;;)try{e=null!=t.current?parseFloat(t.current.pollingConfig.pollInterval):1,await Promise.race([new Promise((t=>setTimeout(t,1e3*e))),new Promise(((e,t)=>{n.addEventListener("abort",t)}))]),n.throwIfAborted();const a=r.current,s=t.current;if(null!=s&&null!=a){const e=getAuthHeader(a),r=await fetch(`https://photospicker.googleapis.com/v1/sessions/${encodeURIComponent(s.id)}`,{headers:e,signal:n});if(!r.ok)throw new Error("Failed to get session");if((await r.json()).mediaItemsSet){const e=await resolvePickedPhotos({accessToken:a,pickingSession:s,signal:n});t.current=void 0,i(e,a)}"0s"===s.pollingConfig.timeoutIn&&(t.current=void 0)}}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;a(e)}}const icons_GooglePhotosIcon=()=>h("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"-7 -7 73 73"},h("g",{fill:"none","fill-rule":"evenodd"},h("path",{d:"M-3-3h64v64H-3z"}),h("g",{"fill-rule":"nonzero"},h("path",{fill:"#FBBC04",d:"M14.8 13.4c8.1 0 14.7 6.6 14.7 14.8v1.3H1.3c-.7 0-1.3-.6-1.3-1.3C0 20 6.6 13.4 14.8 13.4z"}),h("path",{fill:"#EA4335",d:"M45.6 14.8c0 8.1-6.6 14.7-14.8 14.7h-1.3V1.3c0-.7.6-1.3 1.3-1.3C39 0 45.6 6.6 45.6 14.8z"}),h("path",{fill:"#4285F4",d:"M44.3 45.6c-8.2 0-14.8-6.6-14.8-14.8v-1.3h28.2c.7 0 1.3.6 1.3 1.3 0 8.2-6.6 14.8-14.8 14.8z"}),h("path",{fill:"#34A853",d:"M13.4 44.3c0-8.2 6.6-14.8 14.8-14.8h1.3v28.2c0 .7-.6 1.3-1.3 1.3-8.2 0-14.8-6.6-14.8-14.8z"})))),icons_GoogleDriveIcon=()=>h("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},h("g",{fillRule:"nonzero",fill:"none"},h("path",{d:"M6.663 22.284l.97 1.62c.202.34.492.609.832.804l3.465-5.798H5c0 .378.1.755.302 1.096l1.361 2.278z",fill:"#0066DA"}),h("path",{d:"M16 12.09l-3.465-5.798c-.34.195-.63.463-.832.804l-6.4 10.718A2.15 2.15 0 005 18.91h6.93L16 12.09z",fill:"#00AC47"}),h("path",{d:"M23.535 24.708c.34-.195.63-.463.832-.804l.403-.67 1.928-3.228c.201-.34.302-.718.302-1.096h-6.93l1.474 2.802 1.991 2.996z",fill:"#EA4335"}),h("path",{d:"M16 12.09l3.465-5.798A2.274 2.274 0 0018.331 6h-4.662c-.403 0-.794.11-1.134.292L16 12.09z",fill:"#00832D"}),h("path",{d:"M20.07 18.91h-8.14l-3.465 5.798c.34.195.73.292 1.134.292h12.802c.403 0 .794-.11 1.134-.292L20.07 18.91z",fill:"#2684FC"}),h("path",{d:"M23.497 12.455l-3.2-5.359a2.252 2.252 0 00-.832-.804L16 12.09l4.07 6.82h6.917c0-.377-.1-.755-.302-1.096l-3.188-5.359z",fill:"#FFBA00"})));function useStore(e,t){const[r,n]=useState();useEffect((()=>{(async()=>{n(await e.getItem(t))})()}),[t,e]);const i=useCallback((async r=>(n(r),null==r?e.removeItem(t):e.setItem(t,r))),[t,e]);return[r,i]}function GooglePickerView(e){let{uppy:t,i18n:r,clientId:n,onFilesPicked:i,pickerType:a,apiKey:s,appId:o,storage:l}=e;const[c,d]=useState(!1),[u,p]=useStore(l,`uppy:google-${a}-picker:accessToken`),f=useRef(),m=useRef(u),g=useRef(!1),_=useCallback((e=>{t.log("Access token updated"),p(e),m.current=e}),[p,t]);useEffect((()=>{m.current=u}),[u]);const b=useCallback((async e=>{let r=u;const l=async t=>{if("drive"===a)await showDrivePicker({token:t,apiKey:s,appId:o,onFilesPicked:i,signal:e});else{const r=e=>{f.current=e};await showPhotosPicker({token:t,pickingSession:f.current,onPickingSessionChange:r,signal:e})}};d(!0);try{try{if(await ensureScriptsInjected(a),null==r&&(r=await authorize({clientId:n,pickerType:a})),null==r)throw new Error;await l(r),g.current=!0,_(r)}catch(e){if(!(e instanceof InvalidTokenError))throw e;t.log("Token is invalid or expired, reauthenticating"),r=await authorize({pickerType:a,accessToken:r,clientId:n}),await l(r),g.current=!0,_(r)}}catch(e){e instanceof Error&&"type"in e&&"popup_closed"===e.type||(_(null),t.log(e))}finally{d(!1)}}),[u,s,o,n,i,a,_,t]);useEffect((()=>{const e=new AbortController;return pollPickingSession({pickingSessionRef:f,accessTokenRef:m,signal:e.signal,onFilesPicked:i,onError:e=>t.log(e)}),()=>e.abort()}),[i,t]),useEffect((()=>{if(void 0===u||g.current)return;const e=new AbortController;return b(e.signal),()=>{g.current||e.abort()}}),[u,b]);const v=useCallback((async()=>{u&&(await logout(u),_(null),f.current=void 0)}),[u,_]);return c?h("div",null,r("pleaseWait"),"..."):null==u?h(AuthView,{pluginName:r("drive"===a?"pluginNameGoogleDrivePicker":"pluginNameGooglePhotosPicker"),pluginIcon:"drive"===a?GoogleDriveIcon:GooglePhotosIcon,handleAuth:b,i18n:r,loading:c}):h("div",{style:{textAlign:"center"}},h("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary",style:{display:"block",marginBottom:"1em"},disabled:c,onClick:()=>b()},r("drive"===a?"pickFiles":"pickPhotos")),h("button",{type:"button",className:"uppy-u-reset uppy-c-btn",disabled:c,onClick:v},r("logOut")))}var safeIsNaN=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function isEqual(e,t){return e===t||!(!safeIsNaN(e)||!safeIsNaN(t))}function areInputsEqual(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!isEqual(e[r],t[r]))return!1;return!0}function memoizeOne(e,t){void 0===t&&(t=areInputsEqual);var r=null;function n(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(r&&r.lastThis===this&&t(n,r.lastArgs))return r.lastResult;var a=e.apply(this,n);return r={lastResult:a,lastArgs:n,lastThis:this},a}return n.clear=function(){r=null},n}const FOCUSABLE_ELEMENTS=['a[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','area[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])',"input:not([disabled]):not([inert]):not([aria-hidden])","select:not([disabled]):not([inert]):not([aria-hidden])","textarea:not([disabled]):not([inert]):not([aria-hidden])","button:not([disabled]):not([inert]):not([aria-hidden])",'iframe:not([tabindex^="-"]):not([inert]):not([aria-hidden])','object:not([tabindex^="-"]):not([inert]):not([aria-hidden])','embed:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[contenteditable]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[tabindex]:not([tabindex^="-"]):not([inert]):not([aria-hidden])'];function getActiveOverlayEl(e,t){if(t){const r=e.querySelector(`[data-uppy-paneltype="${t}"]`);if(r)return r}return e}function focusOnFirstNode(e,t){const r=t[0];r&&(r.focus(),e.preventDefault())}function focusOnLastNode(e,t){const r=t[t.length-1];r&&(r.focus(),e.preventDefault())}function isFocusInOverlay(e){return e.contains(document.activeElement)}function trapFocus(e,t,r){const n=getActiveOverlayEl(r,t),i=toArray(n.querySelectorAll(FOCUSABLE_ELEMENTS)),a=i.indexOf(document.activeElement);isFocusInOverlay(n)?e.shiftKey&&0===a?focusOnLastNode(e,i):e.shiftKey||a!==i.length-1||focusOnFirstNode(e,i):focusOnFirstNode(e,i)}function forInline(e,t,r){null===t||trapFocus(e,t,r)}var lodash_debounce=__webpack_require__(8221);function createSuperFocus(){let e=!1;return lodash_debounce(((t,r)=>{const n=getActiveOverlayEl(t,r),i=n.contains(document.activeElement);if(i&&e)return;const a=n.querySelector("[data-uppy-super-focusable]");if(!i||a)if(a)a.focus({preventScroll:!0}),e=!0;else{const t=n.querySelector(FOCUSABLE_ELEMENTS);null==t||t.focus({preventScroll:!0}),e=!1}}),260)}function isDragDropSupported(){const e=document.body;return"draggable"in e&&"ondragstart"in e&&"ondrop"in e&&"FormData"in window&&"FileReader"in window}function shallowEqualArrays(e,t){if(e===t)return!0;if(!e||!t)return!1;const r=e.length;if(t.length!==r)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}function shallowEqualObjects(e,t){if(e===t)return!0;if(!e||!t)return!1;const r=Object.keys(e),n=Object.keys(t),i=r.length;if(n.length!==i)return!1;for(let n=0;n<i;n++){const i=r[n];if(e[i]!==t[i]||!Object.prototype.hasOwnProperty.call(t,i))return!1}return!0}function shallowEqual(e,t){const r=Array.isArray(e),n=Array.isArray(t);return r===n&&(r&&n?shallowEqualArrays(e,t):shallowEqualObjects(e,t))}function iconImage(){return _("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25"},_("g",{fill:"#686DE0",fillRule:"evenodd"},_("path",{d:"M5 7v10h15V7H5zm0-1h15a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z",fillRule:"nonzero"}),_("path",{d:"M6.35 17.172l4.994-5.026a.5.5 0 0 1 .707 0l2.16 2.16 3.505-3.505a.5.5 0 0 1 .707 0l2.336 2.31-.707.72-1.983-1.97-3.505 3.505a.5.5 0 0 1-.707 0l-2.16-2.159-3.938 3.939-1.409.026z",fillRule:"nonzero"}),_("circle",{cx:"7.5",cy:"9.5",r:"1.5"})))}function iconAudio(){return _("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},_("path",{d:"M9.5 18.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V7.25a.5.5 0 0 1 .379-.485l9-2.25A.5.5 0 0 1 18.5 5v11.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V8.67l-8 2v7.97zm8-11v-2l-8 2v2l8-2zM7 19.64c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1zm9-2c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1z",fill:"#049BCF",fillRule:"nonzero"}))}function iconVideo(){return _("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},_("path",{d:"M16 11.834l4.486-2.691A1 1 0 0 1 22 10v6a1 1 0 0 1-1.514.857L16 14.167V17a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2.834zM15 9H5v8h10V9zm1 4l5 3v-6l-5 3z",fill:"#19AF67",fillRule:"nonzero"}))}function iconPDF(){return _("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},_("path",{d:"M9.766 8.295c-.691-1.843-.539-3.401.747-3.726 1.643-.414 2.505.938 2.39 3.299-.039.79-.194 1.662-.537 3.148.324.49.66.967 1.055 1.51.17.231.382.488.629.757 1.866-.128 3.653.114 4.918.655 1.487.635 2.192 1.685 1.614 2.84-.566 1.133-1.839 1.084-3.416.249-1.141-.604-2.457-1.634-3.51-2.707a13.467 13.467 0 0 0-2.238.426c-1.392 4.051-4.534 6.453-5.707 4.572-.986-1.58 1.38-4.206 4.914-5.375.097-.322.185-.656.264-1.001.08-.353.306-1.31.407-1.737-.678-1.059-1.2-2.031-1.53-2.91zm2.098 4.87c-.033.144-.068.287-.104.427l.033-.01-.012.038a14.065 14.065 0 0 1 1.02-.197l-.032-.033.052-.004a7.902 7.902 0 0 1-.208-.271c-.197-.27-.38-.526-.555-.775l-.006.028-.002-.003c-.076.323-.148.632-.186.8zm5.77 2.978c1.143.605 1.832.632 2.054.187.26-.519-.087-1.034-1.113-1.473-.911-.39-2.175-.608-3.55-.608.845.766 1.787 1.459 2.609 1.894zM6.559 18.789c.14.223.693.16 1.425-.413.827-.648 1.61-1.747 2.208-3.206-2.563 1.064-4.102 2.867-3.633 3.62zm5.345-10.97c.088-1.793-.351-2.48-1.146-2.28-.473.119-.564 1.05-.056 2.405.213.566.52 1.188.908 1.859.18-.858.268-1.453.294-1.984z",fill:"#E2514A",fillRule:"nonzero"}))}function iconArchive(){return _("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25"},_("path",{d:"M10.45 2.05h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V2.55a.5.5 0 0 1 .5-.5zm2.05 1.024h1.05a.5.5 0 0 1 .5.5V3.6a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5v-.001zM10.45 0h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V.5a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 3.074h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 1.024h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm-2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-1.656 3.074l-.82 5.946c.52.302 1.174.458 1.976.458.803 0 1.455-.156 1.975-.458l-.82-5.946h-2.311zm0-1.025h2.312c.512 0 .946.378 1.015.885l.82 5.946c.056.412-.142.817-.501 1.026-.686.398-1.515.597-2.49.597-.974 0-1.804-.199-2.49-.597a1.025 1.025 0 0 1-.5-1.026l.819-5.946c.07-.507.503-.885 1.015-.885zm.545 6.6a.5.5 0 0 1-.397-.561l.143-.999a.5.5 0 0 1 .495-.429h.74a.5.5 0 0 1 .495.43l.143.998a.5.5 0 0 1-.397.561c-.404.08-.819.08-1.222 0z",fill:"#00C469",fillRule:"nonzero"}))}function iconFile(){return _("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},_("g",{fill:"#A7AFB7",fillRule:"nonzero"},_("path",{d:"M5.5 22a.5.5 0 0 1-.5-.5v-18a.5.5 0 0 1 .5-.5h10.719a.5.5 0 0 1 .367.16l3.281 3.556a.5.5 0 0 1 .133.339V21.5a.5.5 0 0 1-.5.5h-14zm.5-1h13V7.25L16 4H6v17z"}),_("path",{d:"M15 4v3a1 1 0 0 0 1 1h3V7h-3V4h-1z"})))}function iconText(){return _("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},_("path",{d:"M4.5 7h13a.5.5 0 1 1 0 1h-13a.5.5 0 0 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h10a.5.5 0 1 1 0 1h-10a.5.5 0 1 1 0-1z",fill:"#5A5E69",fillRule:"nonzero"}))}function getIconByMime(e){const t={color:"#838999",icon:iconFile()};if(!e)return t;const r=e.split("/")[0],n=e.split("/")[1];return"text"===r?{color:"#5a5e69",icon:iconText()}:"image"===r?{color:"#686de0",icon:iconImage()}:"audio"===r?{color:"#068dbb",icon:iconAudio()}:"video"===r?{color:"#19af67",icon:iconVideo()}:"application"===r&&"pdf"===n?{color:"#e25149",icon:iconPDF()}:"application"===r&&-1!==["zip","x-7z-compressed","x-zip-compressed","x-rar-compressed","x-tar","x-gzip","x-apple-diskimage"].indexOf(n)?{color:"#00C469",icon:iconArchive()}:t}function FilePreview(e){const{file:t}=e;if(t.preview)return _("img",{draggable:!1,className:"uppy-Dashboard-Item-previewImg",alt:t.name,src:t.preview});const{color:r,icon:n}=getIconByMime(t.type);return _("div",{className:"uppy-Dashboard-Item-previewIconWrap"},_("span",{className:"uppy-Dashboard-Item-previewIcon",style:{color:r}},n),_("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-Dashboard-Item-previewIconBg",width:"58",height:"76",viewBox:"0 0 58 76"},_("rect",{fill:"#FFF",width:"58",height:"76",rx:"3",fillRule:"evenodd"})))}const metaFieldIdToName=(e,t)=>{const r=("function"==typeof t?t():t).filter((t=>t.id===e));return r[0].name};function MetaErrorMessage(e){const{file:t,toggleFileCard:r,i18n:n,metaFields:i}=e,{missingRequiredMetaFields:a}=t;if(null==a||!a.length)return null;const s=a.map((e=>metaFieldIdToName(e,i))).join(", ");return _("div",{className:"uppy-Dashboard-Item-errorMessage"},n("missingRequiredMetaFields",{smart_count:a.length,fields:s})," ",_("button",{type:"button",class:"uppy-u-reset uppy-Dashboard-Item-errorMessageBtn",onClick:()=>r(!0,t.id)},n("editFile")))}function FilePreviewAndLink(e){const{file:t,i18n:r,toggleFileCard:n,metaFields:i,showLinkToFileUploadResult:a}=e;return _("div",{className:"uppy-Dashboard-Item-previewInnerWrap",style:{backgroundColor:t.preview?"rgba(255, 255, 255, 0.5)":getIconByMime(t.type).color}},a&&t.uploadURL&&_("a",{className:"uppy-Dashboard-Item-previewLink",href:t.uploadURL,rel:"noreferrer noopener",target:"_blank","aria-label":t.meta.name},_("span",{hidden:!0},t.meta.name)),_(FilePreview,{file:t}),_(MetaErrorMessage,{file:t,i18n:r,toggleFileCard:n,metaFields:i}))}function onPauseResumeCancelRetry(e){e.isUploaded||(!e.error||e.hideRetryButton?e.resumableUploads&&!e.hidePauseResumeButton?e.uppy.pauseResume(e.file.id):e.individualCancellation&&!e.hideCancelButton&&e.uppy.removeFile(e.file.id):e.uppy.retryUpload(e.file.id))}function progressIndicatorTitle(e){return e.isUploaded?e.i18n("uploadComplete"):e.error?e.i18n("retryUpload"):e.resumableUploads?e.file.isPaused?e.i18n("resumeUpload"):e.i18n("pauseUpload"):e.individualCancellation?e.i18n("cancelUpload"):""}function ProgressIndicatorButton(e){return _("div",{className:"uppy-Dashboard-Item-progress"},_("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-progressIndicator",type:"button","aria-label":progressIndicatorTitle(e),title:progressIndicatorTitle(e),onClick:()=>onPauseResumeCancelRetry(e)},e.children))}function ProgressCircleContainer(e){let{children:t}=e;return _("svg",{"aria-hidden":"true",focusable:"false",width:"70",height:"70",viewBox:"0 0 36 36",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--circle"},t)}function ProgressCircle(e){let{progress:t}=e;const r=2*Math.PI*15;return _("g",null,_("circle",{className:"uppy-Dashboard-Item-progressIcon--bg",r:"15",cx:"18",cy:"18","stroke-width":"2",fill:"none"}),_("circle",{className:"uppy-Dashboard-Item-progressIcon--progress",r:"15",cx:"18",cy:"18",transform:"rotate(-90, 18, 18)",fill:"none","stroke-width":"2","stroke-dasharray":r,"stroke-dashoffset":r-r/100*t}))}function FileProgress(e){return e.file.progress.uploadStarted?void 0===e.file.progress.percentage?null:e.isUploaded?_("div",{className:"uppy-Dashboard-Item-progress"},_("div",{className:"uppy-Dashboard-Item-progressIndicator"},_(ProgressCircleContainer,null,_("circle",{r:"15",cx:"18",cy:"18",fill:"#1bb240"}),_("polygon",{className:"uppy-Dashboard-Item-progressIcon--check",transform:"translate(2, 3)",points:"14 22.5 7 15.2457065 8.99985857 13.1732815 14 18.3547104 22.9729883 9 25 11.1005634"})))):e.recoveredState?null:e.error&&!e.hideRetryButton?_(ProgressIndicatorButton,e,_("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--retry",width:"28",height:"31",viewBox:"0 0 16 19"},_("path",{d:"M16 11a8 8 0 1 1-8-8v2a6 6 0 1 0 6 6h2z"}),_("path",{d:"M7.9 3H10v2H7.9z"}),_("path",{d:"M8.536.5l3.535 3.536-1.414 1.414L7.12 1.914z"}),_("path",{d:"M10.657 2.621l1.414 1.415L8.536 7.57 7.12 6.157z"}))):e.resumableUploads&&!e.hidePauseResumeButton?_(ProgressIndicatorButton,e,_(ProgressCircleContainer,null,_(ProgressCircle,{progress:e.file.progress.percentage}),e.file.isPaused?_("polygon",{className:"uppy-Dashboard-Item-progressIcon--play",transform:"translate(3, 3)",points:"12 20 12 10 20 15"}):_("g",{className:"uppy-Dashboard-Item-progressIcon--pause",transform:"translate(14.5, 13)"},_("rect",{x:"0",y:"0",width:"2",height:"10",rx:"0"}),_("rect",{x:"5",y:"0",width:"2",height:"10",rx:"0"})))):e.resumableUploads||!e.individualCancellation||e.hideCancelButton?_("div",{className:"uppy-Dashboard-Item-progress"},_("div",{className:"uppy-Dashboard-Item-progressIndicator"},_(ProgressCircleContainer,null,_(ProgressCircle,{progress:e.file.progress.percentage})))):_(ProgressIndicatorButton,e,_(ProgressCircleContainer,null,_(ProgressCircle,{progress:e.file.progress.percentage}),_("polygon",{className:"cancel",transform:"translate(2, 2)",points:"19.8856516 11.0625 16 14.9481516 12.1019737 11.0625 11.0625 12.1143484 14.9481516 16 11.0625 19.8980263 12.1019737 20.9375 16 17.0518484 19.8856516 20.9375 20.9375 19.8980263 17.0518484 16 20.9375 12"}))):null}const separator="...";function truncateString(e,t){if(0===t)return"";if(e.length<=t)return e;if(t<=separator.length+1)return`${e.slice(0,t-1)}â€¦`;const r=t-separator.length,n=Math.ceil(r/2),i=Math.floor(r/2);return e.slice(0,n)+separator+e.slice(-i)}const renderFileName=e=>{const{author:t,name:r}=e.file.meta;return _("div",{className:"uppy-Dashboard-Item-name",title:r},truncateString(r,e.isSingleFile&&e.containerHeight>=350?90:e.containerWidth<=352?35:e.containerWidth<=576?60:t?20:30))},renderAuthor=e=>{var t;const{author:r}=e.file.meta,n=null==(t=e.file.remote)?void 0:t.providerName;return r?_("div",{className:"uppy-Dashboard-Item-author"},_("a",{href:`${r.url}?utm_source=Companion&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer"},truncateString(r.name,13)),n?_(Fragment,null," Â· ",n," Â· "):null):null},renderFileSize=e=>e.file.size&&_("div",{className:"uppy-Dashboard-Item-statusSize"},prettierBytes(e.file.size)),ReSelectButton=e=>e.file.isGhost&&_("span",null," â€¢ ",_("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-reSelect",type:"button",onClick:()=>e.toggleAddFilesPanel(!0)},e.i18n("reSelect"))),ErrorButton=e=>{let{file:t,onClick:r}=e;return t.error?_("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-errorDetails","aria-label":t.error,"data-microtip-position":"bottom","data-microtip-size":"medium",onClick:r,type:"button"},"?"):null};function FileInfo(e){const{file:t,i18n:r,toggleFileCard:n,metaFields:i,toggleAddFilesPanel:a,isSingleFile:s,containerHeight:o,containerWidth:l}=e;return _("div",{className:"uppy-Dashboard-Item-fileInfo","data-uppy-file-source":t.source},_("div",{className:"uppy-Dashboard-Item-fileName"},renderFileName({file:t,isSingleFile:s,containerHeight:o,containerWidth:l}),_(ErrorButton,{file:t,onClick:()=>alert(t.error)})),_("div",{className:"uppy-Dashboard-Item-status"},renderAuthor({file:t}),renderFileSize({file:t}),ReSelectButton({file:t,toggleAddFilesPanel:a,i18n:r})),_(MetaErrorMessage,{file:t,i18n:r,toggleFileCard:n,metaFields:i}))}function copyToClipboard(e,t){return void 0===t&&(t="Copy the URL below"),new Promise((r=>{const n=document.createElement("textarea");n.setAttribute("style",{position:"fixed",top:0,left:0,width:"2em",height:"2em",padding:0,border:"none",outline:"none",boxShadow:"none",background:"transparent"}),n.value=e,document.body.appendChild(n),n.select();const i=()=>{document.body.removeChild(n),window.prompt(t,e),r()};try{return document.execCommand("copy")?(document.body.removeChild(n),r()):i()}catch(e){return document.body.removeChild(n),i()}}))}function EditButton(e){let{file:t,uploadInProgressOrComplete:r,metaFields:n,canEditFile:i,i18n:a,onClick:s}=e;return!r&&n&&n.length>0||!r&&i(t)?_("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-action uppy-Dashboard-Item-action--edit",type:"button","aria-label":a("editFileWithFilename",{file:t.meta.name}),title:a("editFileWithFilename",{file:t.meta.name}),onClick:()=>s()},_("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 14"},_("g",{fillRule:"evenodd"},_("path",{d:"M1.5 10.793h2.793A1 1 0 0 0 5 10.5L11.5 4a1 1 0 0 0 0-1.414L9.707.793a1 1 0 0 0-1.414 0l-6.5 6.5A1 1 0 0 0 1.5 8v2.793zm1-1V8L9 1.5l1.793 1.793-6.5 6.5H2.5z",fillRule:"nonzero"}),_("rect",{x:"1",y:"12.293",width:"11",height:"1",rx:".5"}),_("path",{fillRule:"nonzero",d:"M6.793 2.5L9.5 5.207l.707-.707L7.5 1.793z"})))):null}function RemoveButton(e){let{i18n:t,onClick:r,file:n}=e;return _("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--remove",type:"button","aria-label":t("removeFile",{file:n.meta.name}),title:t("removeFile",{file:n.meta.name}),onClick:()=>r()},_("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"18",height:"18",viewBox:"0 0 18 18"},_("path",{d:"M9 0C4.034 0 0 4.034 0 9s4.034 9 9 9 9-4.034 9-9-4.034-9-9-9z"}),_("path",{fill:"#FFF",d:"M13 12.222l-.778.778L9 9.778 5.778 13 5 12.222 8.222 9 5 5.778 5.778 5 9 8.222 12.222 5l.778.778L9.778 9z"})))}function CopyLinkButton(e){let{file:t,uppy:r,i18n:n}=e;return _("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--copyLink",type:"button","aria-label":n("copyLink"),title:n("copyLink"),onClick:e=>(e=>{copyToClipboard(t.uploadURL,n("copyLinkToClipboardFallback")).then((()=>{r.log("Link copied to clipboard."),r.info(n("copyLinkToClipboardSuccess"),"info",3e3)})).catch(r.log).then((()=>e.target.focus({preventScroll:!0})))})(e)},_("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 12"},_("path",{d:"M7.94 7.703a2.613 2.613 0 0 1-.626 2.681l-.852.851a2.597 2.597 0 0 1-1.849.766A2.616 2.616 0 0 1 2.764 7.54l.852-.852a2.596 2.596 0 0 1 2.69-.625L5.267 7.099a1.44 1.44 0 0 0-.833.407l-.852.851a1.458 1.458 0 0 0 1.03 2.486c.39 0 .755-.152 1.03-.426l.852-.852c.231-.231.363-.522.406-.824l1.04-1.038zm4.295-5.937A2.596 2.596 0 0 0 10.387 1c-.698 0-1.355.272-1.849.766l-.852.851a2.614 2.614 0 0 0-.624 2.688l1.036-1.036c.041-.304.173-.6.407-.833l.852-.852c.275-.275.64-.426 1.03-.426a1.458 1.458 0 0 1 1.03 2.486l-.852.851a1.442 1.442 0 0 1-.824.406l-1.04 1.04a2.596 2.596 0 0 0 2.683-.628l.851-.85a2.616 2.616 0 0 0 0-3.697zm-6.88 6.883a.577.577 0 0 0 .82 0l3.474-3.474a.579.579 0 1 0-.819-.82L5.355 7.83a.579.579 0 0 0 0 .819z"})))}function Buttons(e){const{uppy:t,file:r,uploadInProgressOrComplete:n,canEditFile:i,metaFields:a,showLinkToFileUploadResult:s,showRemoveButton:o,i18n:l,toggleFileCard:c,openFileEditor:d}=e;return _("div",{className:"uppy-Dashboard-Item-actionWrapper"},_(EditButton,{i18n:l,file:r,uploadInProgressOrComplete:n,canEditFile:i,metaFields:a,onClick:()=>{a&&a.length>0?c(!0,r.id):d(r)}}),s&&r.uploadURL?_(CopyLinkButton,{file:r,uppy:t,i18n:l}):null,o?_(RemoveButton,{i18n:l,file:r,onClick:()=>t.removeFile(r.id)}):null)}class FileItem extends x{componentDidMount(){const{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}shouldComponentUpdate(e){return!shallowEqualObjects(this.props,e)}componentDidUpdate(){const{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}componentWillUnmount(){const{file:e}=this.props;e.preview||this.props.handleCancelThumbnail(e)}render(){const{file:e}=this.props,t=e.progress.preprocess||e.progress.postprocess,r=!!e.progress.uploadComplete&&!t&&!e.error,n=!!e.progress.uploadStarted||!!t,i=e.progress.uploadStarted&&!e.progress.uploadComplete||t,a=e.error||!1,{isGhost:s}=e;let o=(this.props.individualCancellation||!i)&&!r;return r&&this.props.showRemoveButtonAfterComplete&&(o=!0),_("div",{className:classnames({"uppy-Dashboard-Item":!0,"is-inprogress":i&&!this.props.recoveredState,"is-processing":t,"is-complete":r,"is-error":!!a,"is-resumable":this.props.resumableUploads,"is-noIndividualCancellation":!this.props.individualCancellation,"is-ghost":s}),id:`uppy_${e.id}`,role:this.props.role},_("div",{className:"uppy-Dashboard-Item-preview"},_(FilePreviewAndLink,{file:e,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,i18n:this.props.i18n,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields}),_(FileProgress,{uppy:this.props.uppy,file:e,error:a,isUploaded:r,hideRetryButton:this.props.hideRetryButton,hideCancelButton:this.props.hideCancelButton,hidePauseResumeButton:this.props.hidePauseResumeButton,recoveredState:this.props.recoveredState,resumableUploads:this.props.resumableUploads,individualCancellation:this.props.individualCancellation,i18n:this.props.i18n})),_("div",{className:"uppy-Dashboard-Item-fileInfoAndButtons"},_(FileInfo,{file:e,containerWidth:this.props.containerWidth,containerHeight:this.props.containerHeight,i18n:this.props.i18n,toggleAddFilesPanel:this.props.toggleAddFilesPanel,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields,isSingleFile:this.props.isSingleFile}),_(Buttons,{file:e,metaFields:this.props.metaFields,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,showRemoveButton:o,canEditFile:this.props.canEditFile,uploadInProgressOrComplete:n,toggleFileCard:this.props.toggleFileCard,openFileEditor:this.props.openFileEditor,uppy:this.props.uppy,i18n:this.props.i18n})))}}function chunks(e,t){const r=[];let n=[];return e.forEach((e=>{n.length<t?n.push(e):(r.push(n),n=[e])})),n.length&&r.push(n),r}function FileList(e){let{id:t,i18n:r,uppy:n,files:i,resumableUploads:a,hideRetryButton:s,hidePauseResumeButton:o,hideCancelButton:l,showLinkToFileUploadResult:c,showRemoveButtonAfterComplete:d,metaFields:u,isSingleFile:p,toggleFileCard:h,handleRequestThumbnail:f,handleCancelThumbnail:m,recoveredState:g,individualCancellation:b,itemsPerRow:v,openFileEditor:y,canEditFile:w,toggleAddFilesPanel:E,containerWidth:S,containerHeight:T}=e;const C=1===v?71:200,x=hooks_module_T((()=>{const e=Object.keys(i);return g&&e.sort(((e,t)=>Number(i[t].isGhost)-Number(i[e].isGhost))),chunks(e,v)}),[i,v,g]),A=e=>_("div",{class:"uppy-Dashboard-filesInner",role:"presentation",key:e[0]},e.map((e=>_(FileItem,{key:e,uppy:n,id:t,i18n:r,resumableUploads:a,individualCancellation:b,hideRetryButton:s,hidePauseResumeButton:o,hideCancelButton:l,showLinkToFileUploadResult:c,showRemoveButtonAfterComplete:d,metaFields:u,recoveredState:g,isSingleFile:p,containerWidth:S,containerHeight:T,toggleFileCard:h,handleRequestThumbnail:f,handleCancelThumbnail:m,role:"listitem",openFileEditor:y,canEditFile:w,toggleAddFilesPanel:E,file:i[e]}))));return p?_("div",{class:"uppy-Dashboard-files"},A(x[0])):_(lib_VirtualList,{class:"uppy-Dashboard-files",role:"list",data:x,renderRow:A,rowHeight:C})}class AddFiles extends x{constructor(){super(...arguments),this.fileInput=null,this.folderInput=null,this.mobilePhotoFileInput=null,this.mobileVideoFileInput=null,this.triggerFileInputClick=()=>{var e;null==(e=this.fileInput)||e.click()},this.triggerFolderInputClick=()=>{var e;null==(e=this.folderInput)||e.click()},this.triggerVideoCameraInputClick=()=>{var e;null==(e=this.mobileVideoFileInput)||e.click()},this.triggerPhotoCameraInputClick=()=>{var e;null==(e=this.mobilePhotoFileInput)||e.click()},this.onFileInputChange=e=>{this.props.handleInputChange(e),e.currentTarget.value=""},this.renderHiddenInput=(e,t)=>{var r;return _("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,webkitdirectory:e,type:"file",name:"files[]",multiple:1!==this.props.maxNumberOfFiles,onChange:this.onFileInputChange,accept:null==(r=this.props.allowedFileTypes)?void 0:r.join(", "),ref:t})},this.renderHiddenCameraInput=(e,t,r)=>{const n={photo:"image/*",video:"video/*"}[e];return _("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,type:"file",name:`camera-${e}`,onChange:this.onFileInputChange,capture:t,accept:n,ref:r})},this.renderMyDeviceAcquirer=()=>_("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MyDevice"},_("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerFileInputClick},_("div",{className:"uppy-DashboardTab-inner"},_("svg",{className:"uppy-DashboardTab-iconMyDevice","aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},_("path",{d:"M8.45 22.087l-1.305-6.674h17.678l-1.572 6.674H8.45zm4.975-12.412l1.083 1.765a.823.823 0 00.715.386h7.951V13.5H8.587V9.675h4.838zM26.043 13.5h-1.195v-2.598c0-.463-.336-.75-.798-.75h-8.356l-1.082-1.766A.823.823 0 0013.897 8H7.728c-.462 0-.815.256-.815.718V13.5h-.956a.97.97 0 00-.746.37.972.972 0 00-.19.81l1.724 8.565c.095.44.484.755.933.755H24c.44 0 .824-.3.929-.727l2.043-8.568a.972.972 0 00-.176-.825.967.967 0 00-.753-.38z",fill:"currentcolor","fill-rule":"evenodd"}))),_("div",{className:"uppy-DashboardTab-name"},this.props.i18n("myDevice")))),this.renderPhotoCamera=()=>_("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobilePhotoCamera"},_("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerPhotoCameraInputClick},_("div",{className:"uppy-DashboardTab-inner"},_("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},_("path",{d:"M23.5 9.5c1.417 0 2.5 1.083 2.5 2.5v9.167c0 1.416-1.083 2.5-2.5 2.5h-15c-1.417 0-2.5-1.084-2.5-2.5V12c0-1.417 1.083-2.5 2.5-2.5h2.917l1.416-2.167C13 7.167 13.25 7 13.5 7h5c.25 0 .5.167.667.333L20.583 9.5H23.5zM16 11.417a4.706 4.706 0 00-4.75 4.75 4.704 4.704 0 004.75 4.75 4.703 4.703 0 004.75-4.75c0-2.663-2.09-4.75-4.75-4.75zm0 7.825c-1.744 0-3.076-1.332-3.076-3.074 0-1.745 1.333-3.077 3.076-3.077 1.744 0 3.074 1.333 3.074 3.076s-1.33 3.075-3.074 3.075z",fill:"#02B383","fill-rule":"nonzero"}))),_("div",{className:"uppy-DashboardTab-name"},this.props.i18n("takePictureBtn")))),this.renderVideoCamera=()=>_("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobileVideoCamera"},_("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerVideoCameraInputClick},_("div",{className:"uppy-DashboardTab-inner"},_("svg",{"aria-hidden":"true",width:"32",height:"32",viewBox:"0 0 32 32"},_("path",{fill:"#FF675E",fillRule:"nonzero",d:"m21.254 14.277 2.941-2.588c.797-.313 1.243.818 1.09 1.554-.01 2.094.02 4.189-.017 6.282-.126.915-1.145 1.08-1.58.34l-2.434-2.142c-.192.287-.504 1.305-.738.468-.104-1.293-.028-2.596-.05-3.894.047-.312.381.823.426 1.069.063-.384.206-.744.362-1.09zm-12.939-3.73c3.858.013 7.717-.025 11.574.02.912.129 1.492 1.237 1.351 2.217-.019 2.412.04 4.83-.03 7.239-.17 1.025-1.166 1.59-2.029 1.429-3.705-.012-7.41.025-11.114-.019-.913-.129-1.492-1.237-1.352-2.217.018-2.404-.036-4.813.029-7.214.136-.82.83-1.473 1.571-1.454z "}))),_("div",{className:"uppy-DashboardTab-name"},this.props.i18n("recordVideoBtn")))),this.renderBrowseButton=(e,t)=>_("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-browse",onClick:t,"data-uppy-super-focusable":0===this.props.acquirers.length},e),this.renderDropPasteBrowseTagline=e=>{const t=this.renderBrowseButton(this.props.i18n("browseFiles"),this.triggerFileInputClick),r=this.renderBrowseButton(this.props.i18n("browseFolders"),this.triggerFolderInputClick),n=this.props.fileManagerSelectionType,i=n.charAt(0).toUpperCase()+n.slice(1);return _("div",{class:"uppy-Dashboard-AddFiles-title"},this.props.disableLocalFiles?this.props.i18n("importFiles"):e>0?this.props.i18nArray(`dropPasteImport${i}`,{browseFiles:t,browseFolders:r,browse:t}):this.props.i18nArray(`dropPaste${i}`,{browseFiles:t,browseFolders:r,browse:t}))},this.renderAcquirer=e=>{var t;return _("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":e.id},_("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-cy":e.id,"aria-controls":`uppy-DashboardContent-panel--${e.id}`,"aria-selected":(null==(t=this.props.activePickerPanel)?void 0:t.id)===e.id,"data-uppy-super-focusable":!0,onClick:()=>this.props.showPanel(e.id)},_("div",{className:"uppy-DashboardTab-inner"},e.icon()),_("div",{className:"uppy-DashboardTab-name"},e.name)))},this.renderAcquirers=e=>{const t=[...e],r=t.splice(e.length-2,e.length);return _(k,null,t.map((e=>this.renderAcquirer(e))),_("span",{role:"presentation",style:{"white-space":"nowrap"}},r.map((e=>this.renderAcquirer(e)))))},this.renderSourcesList=(e,t)=>{const{showNativePhotoCameraButton:r,showNativeVideoCameraButton:n}=this.props;let i=[];const a="myDevice";t||i.push({key:a,elements:this.renderMyDeviceAcquirer()}),r&&i.push({key:"nativePhotoCameraButton",elements:this.renderPhotoCamera()}),n&&i.push({key:"nativePhotoCameraButton",elements:this.renderVideoCamera()}),i.push(...e.map((e=>({key:e.id,elements:this.renderAcquirer(e)})))),1===i.length&&i[0].key===a&&(i=[]);const s=[...i],o=s.splice(i.length-2,i.length);return _(k,null,this.renderDropPasteBrowseTagline(i.length),_("div",{className:"uppy-Dashboard-AddFiles-list",role:"tablist"},s.map((e=>{let{key:t,elements:r}=e;return _(k,{key:t},r)})),_("span",{role:"presentation",style:{"white-space":"nowrap"}},o.map((e=>{let{key:t,elements:r}=e;return _(k,{key:t},r)})))))}}[Symbol.for("uppy test: disable unused locale key warning")](){this.props.i18nArray("dropPasteBoth"),this.props.i18nArray("dropPasteFiles"),this.props.i18nArray("dropPasteFolders"),this.props.i18nArray("dropPasteImportBoth"),this.props.i18nArray("dropPasteImportFiles"),this.props.i18nArray("dropPasteImportFolders")}renderPoweredByUppy(){const{i18nArray:e}=this.props,t=_("span",null,_("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-poweredByIcon",width:"11",height:"11",viewBox:"0 0 11 11"},_("path",{d:"M7.365 10.5l-.01-4.045h2.612L5.5.806l-4.467 5.65h2.604l.01 4.044h3.718z",fillRule:"evenodd"})),_("span",{className:"uppy-Dashboard-poweredByUppy"},"Uppy"));return _("a",{tabIndex:-1,href:"https://uppy.io",rel:"noreferrer noopener",target:"_blank",className:"uppy-Dashboard-poweredBy"},e("poweredBy",{uppy:t}))}render(){const{showNativePhotoCameraButton:e,showNativeVideoCameraButton:t,nativeCameraFacingMode:r}=this.props;return _("div",{className:"uppy-Dashboard-AddFiles"},this.renderHiddenInput(!1,(e=>{this.fileInput=e})),this.renderHiddenInput(!0,(e=>{this.folderInput=e})),e&&this.renderHiddenCameraInput("photo",r,(e=>{this.mobilePhotoFileInput=e})),t&&this.renderHiddenCameraInput("video",r,(e=>{this.mobileVideoFileInput=e})),this.renderSourcesList(this.props.acquirers,this.props.disableLocalFiles),_("div",{className:"uppy-Dashboard-AddFiles-info"},this.props.note&&_("div",{className:"uppy-Dashboard-note"},this.props.note),this.props.proudlyDisplayPoweredByUppy&&this.renderPoweredByUppy()))}}const components_AddFiles=AddFiles,AddFilesPanel=e=>_("div",{className:classnames("uppy-Dashboard-AddFilesPanel",e.className),"data-uppy-panelType":"AddFiles","aria-hidden":!e.showAddFilesPanel},_("div",{className:"uppy-DashboardContent-bar"},_("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},e.i18n("addingMoreFiles")),_("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>e.toggleAddFilesPanel(!1)},e.i18n("back"))),_(components_AddFiles,e)),components_AddFilesPanel=AddFilesPanel;function ignoreEvent(e){const{tagName:t}=e.target;"INPUT"!==t&&"TEXTAREA"!==t?(e.preventDefault(),e.stopPropagation()):e.stopPropagation()}const utils_ignoreEvent=ignoreEvent;function PickerPanelContent(e){let{activePickerPanel:t,className:r,hideAllPanels:n,i18n:i,state:a,uppy:s}=e;const o=hooks_module_A(null);return _("div",{className:classnames("uppy-DashboardContent-panel",r),role:"tabpanel","data-uppy-panelType":"PickerPanel",id:`uppy-DashboardContent-panel--${t.id}`,onDragOver:utils_ignoreEvent,onDragLeave:utils_ignoreEvent,onDrop:utils_ignoreEvent,onPaste:utils_ignoreEvent},_("div",{className:"uppy-DashboardContent-bar"},_("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},i("importFrom",{name:t.name})),_("button",{className:"uppy-DashboardContent-back",type:"button",onClick:n},i("cancel"))),_("div",{ref:o,className:"uppy-DashboardContent-panelBody"},s.getPlugin(t.id).render(a,o.current)))}const components_PickerPanelContent=PickerPanelContent;function EditorPanel(e){const t=e.files[e.fileCardFor];return _("div",{className:classnames("uppy-DashboardContent-panel",e.className),role:"tabpanel","data-uppy-panelType":"FileEditor",id:"uppy-DashboardContent-panel--editor"},_("div",{className:"uppy-DashboardContent-bar"},_("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},e.i18nArray("editing",{file:_("span",{className:"uppy-DashboardContent-titleFile"},t.meta?t.meta.name:t.name)})),_("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>{e.uppy.emit("file-editor:cancel",t),e.closeFileEditor()}},e.i18n("cancel")),_("button",{className:"uppy-DashboardContent-save",type:"button",onClick:e.saveFileEditor},e.i18n("save"))),_("div",{className:"uppy-DashboardContent-panelBody"},e.editors.map((t=>e.uppy.getPlugin(t.id).render(e.state)))))}const components_EditorPanel=EditorPanel,uploadStates={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete",STATE_PAUSED:"paused"};function PickerPanelTopBar_getUploadingState(e,t,r,n){if(void 0===n&&(n={}),e)return uploadStates.STATE_ERROR;if(t)return uploadStates.STATE_COMPLETE;if(r)return uploadStates.STATE_PAUSED;let i=uploadStates.STATE_WAITING;const a=Object.keys(n);for(let e=0;e<a.length;e++){const{progress:t}=n[a[e]];if(t.uploadStarted&&!t.uploadComplete)return uploadStates.STATE_UPLOADING;t.preprocess&&i!==uploadStates.STATE_UPLOADING&&(i=uploadStates.STATE_PREPROCESSING),t.postprocess&&i!==uploadStates.STATE_UPLOADING&&i!==uploadStates.STATE_PREPROCESSING&&(i=uploadStates.STATE_POSTPROCESSING)}return i}function UploadStatus(e){let{files:t,i18n:r,isAllComplete:n,isAllErrored:i,isAllPaused:a,inProgressNotPausedFiles:s,newFiles:o,processingFiles:l}=e;switch(PickerPanelTopBar_getUploadingState(i,n,a,t)){case"uploading":return r("uploadingXFiles",{smart_count:s.length});case"preprocessing":case"postprocessing":return r("processingXFiles",{smart_count:l.length});case"paused":return r("uploadPaused");case"waiting":return r("xFilesSelected",{smart_count:o.length});case"complete":return r("uploadComplete");case"error":return r("error")}}function PanelTopBar(e){const{i18n:t,isAllComplete:r,hideCancelButton:n,maxNumberOfFiles:i,toggleAddFilesPanel:a,uppy:s}=e;let{allowNewUpload:o}=e;return o&&i&&(o=e.totalFileCount<e.maxNumberOfFiles),_("div",{className:"uppy-DashboardContent-bar"},r||n?_("div",null):_("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>s.cancelAll()},t("cancel")),_("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},_(UploadStatus,e)),o?_("button",{className:"uppy-DashboardContent-addMore",type:"button","aria-label":t("addMoreFiles"),title:t("addMoreFiles"),onClick:()=>a(!0)},_("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"15",height:"15",viewBox:"0 0 15 15"},_("path",{d:"M8 6.5h6a.5.5 0 0 1 .5.5v.5a.5.5 0 0 1-.5.5H8v6a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5V8h-6a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h6v-6A.5.5 0 0 1 7 0h.5a.5.5 0 0 1 .5.5v6z"})),_("span",{className:"uppy-DashboardContent-addMoreCaption"},t("addMore"))):_("div",null))}const PickerPanelTopBar=PanelTopBar;function RenderMetaFields(e){const{computedMetaFields:t,requiredMetaFields:r,updateMeta:n,form:i,formState:a}=e,s={text:"uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input"};return t.map((e=>{const t=`uppy-Dashboard-FileCard-input-${e.id}`,o=r.includes(e.id);return _("fieldset",{key:e.id,className:"uppy-Dashboard-FileCard-fieldset"},_("label",{className:"uppy-Dashboard-FileCard-label",htmlFor:t},e.name),void 0!==e.render?e.render({value:a[e.id],onChange:t=>n(t,e.id),fieldCSSClasses:s,required:o,form:i.id},_):_("input",{className:s.text,id:t,form:i.id,type:e.type||"text",required:o,value:a[e.id],placeholder:e.placeholder,onInput:t=>n(t.target.value,e.id),"data-uppy-super-focusable":!0}))}))}function FileCard(e){var t;const{files:r,fileCardFor:n,toggleFileCard:i,saveFileCard:a,metaFields:s,requiredMetaFields:o,openFileEditor:l,i18n:c,i18nArray:d,className:u,canEditFile:p}=e,h=r[n],f=null!=(t="function"==typeof s?s(r[n]):s)?t:[],m=p(h),g={};f.forEach((e=>{var t;g[e.id]=null!=(t=h.meta[e.id])?t:""}));const[b,v]=hooks_module_d(g),y=hooks_module_q((e=>{e.preventDefault(),a(b,n)}),[a,b,n]),w=()=>{i(!1)},[E]=hooks_module_d((()=>{const e=document.createElement("form");return e.setAttribute("tabindex","-1"),e.id=nanoid(),e}));return hooks_module_y((()=>(document.body.appendChild(E),E.addEventListener("submit",y),()=>{E.removeEventListener("submit",y),document.body.removeChild(E)})),[E,y]),_("div",{className:classnames("uppy-Dashboard-FileCard",u),"data-uppy-panelType":"FileCard",onDragOver:utils_ignoreEvent,onDragLeave:utils_ignoreEvent,onDrop:utils_ignoreEvent,onPaste:utils_ignoreEvent},_("div",{className:"uppy-DashboardContent-bar"},_("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},d("editing",{file:_("span",{className:"uppy-DashboardContent-titleFile"},h.meta?h.meta.name:h.name)})),_("button",{className:"uppy-DashboardContent-back",type:"button",form:E.id,title:c("finishEditingFile"),onClick:w},c("cancel"))),_("div",{className:"uppy-Dashboard-FileCard-inner"},_("div",{className:"uppy-Dashboard-FileCard-preview",style:{backgroundColor:getIconByMime(h.type).color}},_(FilePreview,{file:h}),m&&_("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-FileCard-edit",onClick:e=>{y(e),l(h)}},c("editImage"))),_("div",{className:"uppy-Dashboard-FileCard-info"},_(RenderMetaFields,{computedMetaFields:f,requiredMetaFields:o,updateMeta:(e,t)=>{v({...b,[t]:e})},form:E,formState:b})),_("div",{className:"uppy-Dashboard-FileCard-actions"},_("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-FileCard-actionsBtn",type:"submit",form:E.id},c("saveChanges")),_("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-FileCard-actionsBtn",type:"button",onClick:w,form:E.id},c("cancel")))))}const transitionName="uppy-transition-slideDownUp",duration=250;function Slide(e){let{children:t}=e;const[r,n]=hooks_module_d(null),[i,a]=hooks_module_d(""),s=hooks_module_A(),o=hooks_module_A(),l=hooks_module_A();return hooks_module_y((()=>{const e=H(t)[0];r!==e&&(e&&!r?(a(`${transitionName}-enter`),cancelAnimationFrame(l.current),clearTimeout(o.current),o.current=void 0,l.current=requestAnimationFrame((()=>{a(`${transitionName}-enter ${transitionName}-enter-active`),s.current=setTimeout((()=>{a("")}),duration)}))):!r||e||o.current||(a(`${transitionName}-leave`),cancelAnimationFrame(l.current),clearTimeout(s.current),s.current=void 0,l.current=requestAnimationFrame((()=>{a(`${transitionName}-leave ${transitionName}-leave-active`),o.current=setTimeout((()=>{n(null),a("")}),duration)}))),n(e))}),[t,r]),hooks_module_y((()=>()=>{clearTimeout(s.current),clearTimeout(o.current),cancelAnimationFrame(l.current)}),[]),r?J(r,{className:classnames(i,r.props.className)}):null}const components_Slide=Slide;function Dashboard_extends(){return Dashboard_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dashboard_extends.apply(null,arguments)}const WIDTH_XL=900,WIDTH_LG=700,WIDTH_MD=576,HEIGHT_MD=330;function Dashboard_Dashboard(e){const t=0===e.totalFileCount,r=1===e.totalFileCount,n=e.containerWidth>WIDTH_MD,i=e.containerHeight>HEIGHT_MD,a=classnames({"uppy-Dashboard":!0,"uppy-Dashboard--isDisabled":e.disabled,"uppy-Dashboard--animateOpenClose":e.animateOpenClose,"uppy-Dashboard--isClosing":e.isClosing,"uppy-Dashboard--isDraggingOver":e.isDraggingOver,"uppy-Dashboard--modal":!e.inline,"uppy-size--md":e.containerWidth>WIDTH_MD,"uppy-size--lg":e.containerWidth>WIDTH_LG,"uppy-size--xl":e.containerWidth>WIDTH_XL,"uppy-size--height-md":e.containerHeight>HEIGHT_MD,"uppy-Dashboard--isAddFilesPanelVisible":e.showAddFilesPanel,"uppy-Dashboard--isInnerWrapVisible":e.areInsidesReadyToBeVisible,"uppy-Dashboard--singleFile":e.singleFileFullScreen&&r&&i});let s=1;e.containerWidth>WIDTH_XL?s=5:e.containerWidth>WIDTH_LG?s=4:e.containerWidth>WIDTH_MD&&(s=3);const o=e.showSelectedFiles&&!t,l=e.recoveredState?Object.keys(e.recoveredState.files).length:null,c=e.files?Object.keys(e.files).filter((t=>e.files[t].isGhost)).length:0;return _("div",{className:a,"data-uppy-theme":e.theme,"data-uppy-num-acquirers":e.acquirers.length,"data-uppy-drag-drop-supported":!e.disableLocalFiles&&isDragDropSupported(),"aria-hidden":e.inline?"false":e.isHidden,"aria-disabled":e.disabled,"aria-label":e.inline?e.i18n("dashboardTitle"):e.i18n("dashboardWindowTitle"),onPaste:e.handlePaste,onDragOver:e.handleDragOver,onDragLeave:e.handleDragLeave,onDrop:e.handleDrop},_("div",{"aria-hidden":"true",className:"uppy-Dashboard-overlay",tabIndex:-1,onClick:e.handleClickOutside}),_("div",{className:"uppy-Dashboard-inner","aria-modal":!e.inline&&"true",role:e.inline?void 0:"dialog",style:{width:e.inline&&e.width?e.width:"",height:e.inline&&e.height?e.height:""}},e.inline?null:_("button",{className:"uppy-u-reset uppy-Dashboard-close",type:"button","aria-label":e.i18n("closeModal"),title:e.i18n("closeModal"),onClick:e.closeModal},_("span",{"aria-hidden":"true"},"Ã—")),_("div",{className:"uppy-Dashboard-innerWrap"},_("div",{className:"uppy-Dashboard-dropFilesHereHint"},e.i18n("dropHint")),o&&_(PickerPanelTopBar,e),l&&_("div",{className:"uppy-Dashboard-serviceMsg"},_("svg",{className:"uppy-Dashboard-serviceMsg-icon","aria-hidden":"true",focusable:"false",width:"21",height:"16",viewBox:"0 0 24 19"},_("g",{transform:"translate(0 -1)",fill:"none",fillRule:"evenodd"},_("path",{d:"M12.857 1.43l10.234 17.056A1 1 0 0122.234 20H1.766a1 1 0 01-.857-1.514L11.143 1.429a1 1 0 011.714 0z",fill:"#FFD300"}),_("path",{fill:"#000",d:"M11 6h2l-.3 8h-1.4z"}),_("circle",{fill:"#000",cx:"12",cy:"17",r:"1"}))),_("strong",{className:"uppy-Dashboard-serviceMsg-title"},e.i18n("sessionRestored")),_("div",{className:"uppy-Dashboard-serviceMsg-text"},c>0?e.i18n("recoveredXFiles",{smart_count:c}):e.i18n("recoveredAllFiles"))),o?_(FileList,{id:e.id,i18n:e.i18n,uppy:e.uppy,files:e.files,resumableUploads:e.resumableUploads,hideRetryButton:e.hideRetryButton,hidePauseResumeButton:e.hidePauseResumeButton,hideCancelButton:e.hideCancelButton,showLinkToFileUploadResult:e.showLinkToFileUploadResult,showRemoveButtonAfterComplete:e.showRemoveButtonAfterComplete,metaFields:e.metaFields,toggleFileCard:e.toggleFileCard,handleRequestThumbnail:e.handleRequestThumbnail,handleCancelThumbnail:e.handleCancelThumbnail,recoveredState:e.recoveredState,individualCancellation:e.individualCancellation,openFileEditor:e.openFileEditor,canEditFile:e.canEditFile,toggleAddFilesPanel:e.toggleAddFilesPanel,isSingleFile:r,itemsPerRow:s,containerWidth:e.containerWidth,containerHeight:e.containerHeight}):_(components_AddFiles,{i18n:e.i18n,i18nArray:e.i18nArray,acquirers:e.acquirers,handleInputChange:e.handleInputChange,maxNumberOfFiles:e.maxNumberOfFiles,allowedFileTypes:e.allowedFileTypes,showNativePhotoCameraButton:e.showNativePhotoCameraButton,showNativeVideoCameraButton:e.showNativeVideoCameraButton,nativeCameraFacingMode:e.nativeCameraFacingMode,showPanel:e.showPanel,activePickerPanel:e.activePickerPanel,disableLocalFiles:e.disableLocalFiles,fileManagerSelectionType:e.fileManagerSelectionType,note:e.note,proudlyDisplayPoweredByUppy:e.proudlyDisplayPoweredByUppy}),_(components_Slide,null,e.showAddFilesPanel?_(components_AddFilesPanel,Dashboard_extends({key:"AddFiles"},e,{isSizeMD:n})):null),_(components_Slide,null,e.fileCardFor?_(FileCard,Dashboard_extends({key:"FileCard"},e)):null),_(components_Slide,null,e.activePickerPanel?_(components_PickerPanelContent,Dashboard_extends({key:"Picker"},e)):null),_(components_Slide,null,e.showFileEditor?_(components_EditorPanel,Dashboard_extends({key:"Editor"},e)):null),_("div",{className:"uppy-Dashboard-progressindicators"},e.progressindicators.map((t=>e.uppy.getPlugin(t.id).render(e.state)))))))}const dashboard_lib_locale={strings:{closeModal:"Close Modal",addMoreFiles:"Add more files",addingMoreFiles:"Adding more files",importFrom:"Import from %{name}",dashboardWindowTitle:"Uppy Dashboard Window (Press escape to close)",dashboardTitle:"Uppy Dashboard",copyLinkToClipboardSuccess:"Link copied to clipboard.",copyLinkToClipboardFallback:"Copy the URL below",copyLink:"Copy link",back:"Back",removeFile:"Remove file",editFile:"Edit file",editImage:"Edit image",editing:"Editing %{file}",error:"Error",finishEditingFile:"Finish editing file",saveChanges:"Save changes",myDevice:"My Device",dropHint:"Drop your files here",uploadComplete:"Upload complete",uploadPaused:"Upload paused",resumeUpload:"Resume upload",pauseUpload:"Pause upload",retryUpload:"Retry upload",cancelUpload:"Cancel upload",xFilesSelected:{0:"%{smart_count} file selected",1:"%{smart_count} files selected"},uploadingXFiles:{0:"Uploading %{smart_count} file",1:"Uploading %{smart_count} files"},processingXFiles:{0:"Processing %{smart_count} file",1:"Processing %{smart_count} files"},poweredBy:"Powered by %{uppy}",addMore:"Add more",editFileWithFilename:"Edit file %{file}",save:"Save",cancel:"Cancel",dropPasteFiles:"Drop files here or %{browseFiles}",dropPasteFolders:"Drop files here or %{browseFolders}",dropPasteBoth:"Drop files here, %{browseFiles} or %{browseFolders}",dropPasteImportFiles:"Drop files here, %{browseFiles} or import from:",dropPasteImportFolders:"Drop files here, %{browseFolders} or import from:",dropPasteImportBoth:"Drop files here, %{browseFiles}, %{browseFolders} or import from:",importFiles:"Import files from:",browseFiles:"browse files",browseFolders:"browse folders",recoveredXFiles:{0:"We could not fully recover 1 file. Please re-select it and resume the upload.",1:"We could not fully recover %{smart_count} files. Please re-select them and resume the upload."},recoveredAllFiles:"We restored all files. You can now resume the upload.",sessionRestored:"Session restored",reSelect:"Re-select",missingRequiredMetaFields:{0:"Missing required meta field: %{fields}.",1:"Missing required meta fields: %{fields}."},takePictureBtn:"Take Picture",recordVideoBtn:"Record Video"}};function Dashboard_classPrivateFieldLooseBase(e,t){if(!{}.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var Dashboard_id=0;function Dashboard_classPrivateFieldLooseKey(e){return"__private_"+Dashboard_id+++"_"+e}const Dashboard_packageJson={version:"4.3.2"},memoize=memoizeOne.default||memoizeOne,TAB_KEY=9,ESC_KEY=27;function createPromise(){const e={};return e.promise=new Promise(((t,r)=>{e.resolve=t,e.reject=r})),e}const Dashboard_defaultOptions={target:"body",metaFields:[],thumbnailWidth:280,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,defaultPickerIcon,showLinkToFileUploadResult:!1,showProgressDetails:!1,hideUploadButton:!1,hideCancelButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideProgressAfterFinish:!1,note:null,singleFileFullScreen:!0,disableStatusBar:!1,disableInformer:!1,disableThumbnailGenerator:!1,fileManagerSelectionType:"files",proudlyDisplayPoweredByUppy:!0,showSelectedFiles:!0,showRemoveButtonAfterComplete:!1,showNativePhotoCameraButton:!1,showNativeVideoCameraButton:!1,theme:"light",autoOpen:null,disabled:!1,disableLocalFiles:!1,nativeCameraFacingMode:"",onDragLeave:()=>{},onDragOver:()=>{},onDrop:()=>{},plugins:[],doneButtonHandler:void 0,onRequestCloseModal:null,inline:!1,animateOpenClose:!0,browserBackButtonClose:!1,closeAfterFinish:!1,closeModalOnClickOutside:!1,disablePageScrollWhenModalOpen:!0,trigger:null,width:750,height:550};var _disabledNodes=Dashboard_classPrivateFieldLooseKey("disabledNodes"),_generateLargeThumbnailIfSingleFile=Dashboard_classPrivateFieldLooseKey("generateLargeThumbnailIfSingleFile"),_openFileEditorWhenFilesAdded=Dashboard_classPrivateFieldLooseKey("openFileEditorWhenFilesAdded"),_attachRenderFunctionToTarget=Dashboard_classPrivateFieldLooseKey("attachRenderFunctionToTarget"),_isTargetSupported=Dashboard_classPrivateFieldLooseKey("isTargetSupported"),_getAcquirers=Dashboard_classPrivateFieldLooseKey("getAcquirers"),_getProgressIndicators=Dashboard_classPrivateFieldLooseKey("getProgressIndicators"),_getEditors=Dashboard_classPrivateFieldLooseKey("getEditors"),_addSpecifiedPluginsFromOptions=Dashboard_classPrivateFieldLooseKey("addSpecifiedPluginsFromOptions"),_autoDiscoverPlugins=Dashboard_classPrivateFieldLooseKey("autoDiscoverPlugins"),_addSupportedPluginIfNoTarget=Dashboard_classPrivateFieldLooseKey("addSupportedPluginIfNoTarget"),_getStatusBarOpts=Dashboard_classPrivateFieldLooseKey("getStatusBarOpts"),_getThumbnailGeneratorOpts=Dashboard_classPrivateFieldLooseKey("getThumbnailGeneratorOpts"),_getInformerOpts=Dashboard_classPrivateFieldLooseKey("getInformerOpts"),_getStatusBarId=Dashboard_classPrivateFieldLooseKey("getStatusBarId"),_getThumbnailGeneratorId=Dashboard_classPrivateFieldLooseKey("getThumbnailGeneratorId"),_getInformerId=Dashboard_classPrivateFieldLooseKey("getInformerId");class Dashboard extends lib_UIPlugin{constructor(e,t){var r,n;const i=null!=(r=null==t?void 0:t.autoOpen)?r:null;super(e,{...Dashboard_defaultOptions,...t,autoOpen:i}),Object.defineProperty(this,_getInformerId,{value:_getInformerId2}),Object.defineProperty(this,_getThumbnailGeneratorId,{value:_getThumbnailGeneratorId2}),Object.defineProperty(this,_getStatusBarId,{value:_getStatusBarId2}),Object.defineProperty(this,_getInformerOpts,{value:_getInformerOpts2}),Object.defineProperty(this,_getThumbnailGeneratorOpts,{value:_getThumbnailGeneratorOpts2}),Object.defineProperty(this,_getStatusBarOpts,{value:_getStatusBarOpts2}),Object.defineProperty(this,_disabledNodes,{writable:!0,value:void 0}),this.modalName=`uppy-Dashboard-${nanoid()}`,this.superFocus=createSuperFocus(),this.ifFocusedOnUppyRecently=!1,this.removeTarget=e=>{const t=this.getPluginState().targets.filter((t=>t.id!==e.id));this.setPluginState({targets:t})},this.addTarget=e=>{const t=e.id||e.constructor.name,r=e.title||t,n=e.type;if("acquirer"!==n&&"progressindicator"!==n&&"editor"!==n){const e="Dashboard: can only be targeted by plugins of types: acquirer, progressindicator, editor";return this.uppy.log(e,"error"),null}const i={id:t,name:r,type:n},a=this.getPluginState().targets.slice();return a.push(i),this.setPluginState({targets:a}),this.el},this.hideAllPanels=()=>{var e;const t=this.getPluginState(),r={activePickerPanel:void 0,showAddFilesPanel:!1,activeOverlayType:null,fileCardFor:null,showFileEditor:!1};t.activePickerPanel===r.activePickerPanel&&t.showAddFilesPanel===r.showAddFilesPanel&&t.showFileEditor===r.showFileEditor&&t.activeOverlayType===r.activeOverlayType||(this.setPluginState(r),this.uppy.emit("dashboard:close-panel",null==(e=t.activePickerPanel)?void 0:e.id))},this.showPanel=e=>{const{targets:t}=this.getPluginState(),r=t.find((t=>"acquirer"===t.type&&t.id===e));this.setPluginState({activePickerPanel:r,activeOverlayType:"PickerPanel"}),this.uppy.emit("dashboard:show-panel",e)},this.canEditFile=e=>{const{targets:t}=this.getPluginState();return Dashboard_classPrivateFieldLooseBase(this,_getEditors)[_getEditors](t).some((t=>this.uppy.getPlugin(t.id).canEditFile(e)))},this.openFileEditor=e=>{const{targets:t}=this.getPluginState(),r=Dashboard_classPrivateFieldLooseBase(this,_getEditors)[_getEditors](t);this.setPluginState({showFileEditor:!0,fileCardFor:e.id||null,activeOverlayType:"FileEditor"}),r.forEach((t=>{this.uppy.getPlugin(t.id).selectFile(e)}))},this.closeFileEditor=()=>{const{metaFields:e}=this.getPluginState();e&&e.length>0?this.setPluginState({showFileEditor:!1,activeOverlayType:"FileCard"}):this.setPluginState({showFileEditor:!1,fileCardFor:null,activeOverlayType:"AddFiles"})},this.saveFileEditor=()=>{const{targets:e}=this.getPluginState();Dashboard_classPrivateFieldLooseBase(this,_getEditors)[_getEditors](e).forEach((e=>{this.uppy.getPlugin(e.id).save()})),this.closeFileEditor()},this.openModal=()=>{const{promise:e,resolve:t}=createPromise();if(this.savedScrollPosition=window.pageYOffset,this.savedActiveElement=document.activeElement,this.opts.disablePageScrollWhenModalOpen&&document.body.classList.add("uppy-Dashboard-isFixed"),this.opts.animateOpenClose&&this.getPluginState().isClosing){const e=()=>{this.setPluginState({isHidden:!1}),this.el.removeEventListener("animationend",e,!1),t()};this.el.addEventListener("animationend",e,!1)}else this.setPluginState({isHidden:!1}),t();return this.opts.browserBackButtonClose&&this.updateBrowserHistory(),document.addEventListener("keydown",this.handleKeyDownInModal),this.uppy.emit("dashboard:modal-open"),e},this.closeModal=e=>{var t;const r=null==(t=null==e?void 0:e.manualClose)||t,{isHidden:n,isClosing:i}=this.getPluginState();if(n||i)return;const{promise:a,resolve:s}=createPromise();if(this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.opts.animateOpenClose){this.setPluginState({isClosing:!0});const e=()=>{this.setPluginState({isHidden:!0,isClosing:!1}),this.superFocus.cancel(),this.savedActiveElement.focus(),this.el.removeEventListener("animationend",e,!1),s()};this.el.addEventListener("animationend",e,!1)}else this.setPluginState({isHidden:!0}),this.superFocus.cancel(),this.savedActiveElement.focus(),s();var o;return document.removeEventListener("keydown",this.handleKeyDownInModal),r&&this.opts.browserBackButtonClose&&null!=(o=history.state)&&o[this.modalName]&&history.back(),this.uppy.emit("dashboard:modal-closed"),a},this.isModalOpen=()=>!this.getPluginState().isHidden||!1,this.requestCloseModal=()=>this.opts.onRequestCloseModal?this.opts.onRequestCloseModal():this.closeModal(),this.setDarkModeCapability=e=>{const{capabilities:t}=this.uppy.getState();this.uppy.setState({capabilities:{...t,darkMode:e}})},this.handleSystemDarkModeChange=e=>{const t=e.matches;this.uppy.log("[Dashboard] Dark mode is "+(t?"on":"off")),this.setDarkModeCapability(t)},this.toggleFileCard=(e,t)=>{const r=this.uppy.getFile(t);e?this.uppy.emit("dashboard:file-edit-start",r):this.uppy.emit("dashboard:file-edit-complete",r),this.setPluginState({fileCardFor:e?t:null,activeOverlayType:e?"FileCard":null})},this.toggleAddFilesPanel=e=>{this.setPluginState({showAddFilesPanel:e,activeOverlayType:e?"AddFiles":null})},this.addFiles=e=>{const t=e.map((e=>({source:this.id,name:e.name,type:e.type,data:e,meta:{relativePath:e.relativePath||e.webkitRelativePath||null}})));try{this.uppy.addFiles(t)}catch(e){this.uppy.log(e)}},this.startListeningToResize=()=>{this.resizeObserver=new ResizeObserver((e=>{const t=e[0],{width:r,height:n}=t.contentRect;this.setPluginState({containerWidth:r,containerHeight:n,areInsidesReadyToBeVisible:!0})})),this.resizeObserver.observe(this.el.querySelector(".uppy-Dashboard-inner")),this.makeDashboardInsidesVisibleAnywayTimeout=setTimeout((()=>{const e=this.getPluginState(),t=!this.opts.inline&&e.isHidden;e.areInsidesReadyToBeVisible||t||(this.uppy.log("[Dashboard] resize event didnâ€™t fire on time: defaulted to mobile layout","warning"),this.setPluginState({areInsidesReadyToBeVisible:!0}))}),1e3)},this.stopListeningToResize=()=>{this.resizeObserver.disconnect(),clearTimeout(this.makeDashboardInsidesVisibleAnywayTimeout)},this.recordIfFocusedOnUppyRecently=e=>{this.el.contains(e.target)?this.ifFocusedOnUppyRecently=!0:(this.ifFocusedOnUppyRecently=!1,this.superFocus.cancel())},this.disableInteractiveElements=e=>{var t;const r=null!=(t=Dashboard_classPrivateFieldLooseBase(this,_disabledNodes)[_disabledNodes])?t:toArray(this.el.querySelectorAll(["a[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])",'[role="button"]:not([disabled])'])).filter((e=>!e.classList.contains("uppy-Dashboard-close")));for(const t of r)"A"===t.tagName?t.setAttribute("aria-disabled",e):t.disabled=e;Dashboard_classPrivateFieldLooseBase(this,_disabledNodes)[_disabledNodes]=e?r:null,this.dashboardIsDisabled=e},this.updateBrowserHistory=()=>{var e;null!=(e=history.state)&&e[this.modalName]||history.pushState({...history.state,[this.modalName]:!0},""),window.addEventListener("popstate",this.handlePopState,!1)},this.handlePopState=e=>{var t;!this.isModalOpen()||e.state&&e.state[this.modalName]||this.closeModal({manualClose:!1}),!this.isModalOpen()&&null!=(t=e.state)&&t[this.modalName]&&history.back()},this.handleKeyDownInModal=e=>{e.keyCode===ESC_KEY&&this.requestCloseModal(),e.keyCode===TAB_KEY&&trapFocus(e,this.getPluginState().activeOverlayType,this.el)},this.handleClickOutside=()=>{this.opts.closeModalOnClickOutside&&this.requestCloseModal()},this.handlePaste=e=>{this.uppy.iteratePlugins((t=>{"acquirer"===t.type&&(null==t.handleRootPaste||t.handleRootPaste(e))}));const t=toArray(e.clipboardData.files);t.length>0&&(this.uppy.log("[Dashboard] Files pasted"),this.addFiles(t))},this.handleInputChange=e=>{e.preventDefault();const t=toArray(e.currentTarget.files||[]);t.length>0&&(this.uppy.log("[Dashboard] Files selected through input"),this.addFiles(t))},this.handleDragOver=e=>{e.preventDefault(),e.stopPropagation();const t=(()=>{let t=!0;return this.uppy.iteratePlugins((r=>{null!=r.canHandleRootDrop&&r.canHandleRootDrop(e)&&(t=!0)})),t})(),r=(()=>{const{types:t}=e.dataTransfer;return t.some((e=>"Files"===e))})();!t&&!r||this.opts.disabled||this.opts.disableLocalFiles&&(r||!t)||!this.uppy.getState().allowNewUpload?e.dataTransfer.dropEffect="none":(e.dataTransfer.dropEffect="copy",this.setPluginState({isDraggingOver:!0}),this.opts.onDragOver(e))},this.handleDragLeave=e=>{e.preventDefault(),e.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.opts.onDragLeave(e)},this.handleDrop=async e=>{e.preventDefault(),e.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.uppy.iteratePlugins((t=>{"acquirer"===t.type&&(null==t.handleRootDrop||t.handleRootDrop(e))}));let t=!1;this.uppy.log("[Dashboard] Processing dropped files");const r=await getDroppedFiles(e.dataTransfer,{logDropError:e=>{this.uppy.log(e,"error"),t||(this.uppy.info(e.message,"error"),t=!0)}});r.length>0&&(this.uppy.log("[Dashboard] Files dropped"),this.addFiles(r)),this.opts.onDrop(e)},this.handleRequestThumbnail=e=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:request",e)},this.handleCancelThumbnail=e=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:cancel",e)},this.handleKeyDownInInline=e=>{e.keyCode===TAB_KEY&&forInline(e,this.getPluginState().activeOverlayType,this.el)},this.handlePasteOnBody=e=>{this.el.contains(document.activeElement)&&this.handlePaste(e)},this.handleComplete=e=>{let{failed:t}=e;!this.opts.closeAfterFinish||null!=t&&t.length||this.requestCloseModal()},this.handleCancelRestore=()=>{this.uppy.emit("restore-canceled")},Object.defineProperty(this,_generateLargeThumbnailIfSingleFile,{writable:!0,value:()=>{if(this.opts.disableThumbnailGenerator)return;const e=this.uppy.getFiles();if(1===e.length){const t=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);null==t||t.setOptions({thumbnailWidth:600});const r={...e[0],preview:void 0};null==t||t.requestThumbnail(r).then((()=>{null==t||t.setOptions({thumbnailWidth:this.opts.thumbnailWidth})}))}}}),Object.defineProperty(this,_openFileEditorWhenFilesAdded,{writable:!0,value:e=>{const t=e[0],{metaFields:r}=this.getPluginState(),n=r&&r.length>0,i=this.canEditFile(t);n&&"metaEditor"===this.opts.autoOpen?this.toggleFileCard(!0,t.id):i&&"imageEditor"===this.opts.autoOpen&&this.openFileEditor(t)}}),this.initEvents=()=>{if(this.opts.trigger&&!this.opts.inline){const e=lib_findAllDOMElements(this.opts.trigger);e?e.forEach((e=>e.addEventListener("click",this.openModal))):this.uppy.log("Dashboard modal trigger not found. Make sure `trigger` is set in Dashboard options, unless you are planning to call `dashboard.openModal()` method yourself","warning")}this.startListeningToResize(),document.addEventListener("paste",this.handlePasteOnBody),this.uppy.on("plugin-added",Dashboard_classPrivateFieldLooseBase(this,_addSupportedPluginIfNoTarget)[_addSupportedPluginIfNoTarget]),this.uppy.on("plugin-remove",this.removeTarget),this.uppy.on("file-added",this.hideAllPanels),this.uppy.on("dashboard:modal-closed",this.hideAllPanels),this.uppy.on("complete",this.handleComplete),this.uppy.on("files-added",Dashboard_classPrivateFieldLooseBase(this,_generateLargeThumbnailIfSingleFile)[_generateLargeThumbnailIfSingleFile]),this.uppy.on("file-removed",Dashboard_classPrivateFieldLooseBase(this,_generateLargeThumbnailIfSingleFile)[_generateLargeThumbnailIfSingleFile]),document.addEventListener("focus",this.recordIfFocusedOnUppyRecently,!0),document.addEventListener("click",this.recordIfFocusedOnUppyRecently,!0),this.opts.inline&&this.el.addEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.on("files-added",Dashboard_classPrivateFieldLooseBase(this,_openFileEditorWhenFilesAdded)[_openFileEditorWhenFilesAdded])},this.removeEvents=()=>{const e=lib_findAllDOMElements(this.opts.trigger);!this.opts.inline&&e&&e.forEach((e=>e.removeEventListener("click",this.openModal))),this.stopListeningToResize(),document.removeEventListener("paste",this.handlePasteOnBody),window.removeEventListener("popstate",this.handlePopState,!1),this.uppy.off("plugin-added",Dashboard_classPrivateFieldLooseBase(this,_addSupportedPluginIfNoTarget)[_addSupportedPluginIfNoTarget]),this.uppy.off("plugin-remove",this.removeTarget),this.uppy.off("file-added",this.hideAllPanels),this.uppy.off("dashboard:modal-closed",this.hideAllPanels),this.uppy.off("complete",this.handleComplete),this.uppy.off("files-added",Dashboard_classPrivateFieldLooseBase(this,_generateLargeThumbnailIfSingleFile)[_generateLargeThumbnailIfSingleFile]),this.uppy.off("file-removed",Dashboard_classPrivateFieldLooseBase(this,_generateLargeThumbnailIfSingleFile)[_generateLargeThumbnailIfSingleFile]),document.removeEventListener("focus",this.recordIfFocusedOnUppyRecently),document.removeEventListener("click",this.recordIfFocusedOnUppyRecently),this.opts.inline&&this.el.removeEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.off("files-added",Dashboard_classPrivateFieldLooseBase(this,_openFileEditorWhenFilesAdded)[_openFileEditorWhenFilesAdded])},this.superFocusOnEachUpdate=()=>{const e=this.el.contains(document.activeElement),t=document.activeElement===document.body||null===document.activeElement,r=0===this.uppy.getState().info.length,n=!this.opts.inline;r&&(n||e||t&&this.ifFocusedOnUppyRecently)?this.superFocus(this.el,this.getPluginState().activeOverlayType):this.superFocus.cancel()},this.afterUpdate=()=>{!this.opts.disabled||this.dashboardIsDisabled?(!this.opts.disabled&&this.dashboardIsDisabled&&this.disableInteractiveElements(!1),this.superFocusOnEachUpdate()):this.disableInteractiveElements(!0)},this.saveFileCard=(e,t)=>{this.uppy.setFileMeta(t,e),this.toggleFileCard(!1,t)},Object.defineProperty(this,_attachRenderFunctionToTarget,{writable:!0,value:e=>{const t=this.uppy.getPlugin(e.id);return{...e,icon:t.icon||this.opts.defaultPickerIcon,render:t.render}}}),Object.defineProperty(this,_isTargetSupported,{writable:!0,value:e=>{const t=this.uppy.getPlugin(e.id);return"function"!=typeof t.isSupported||t.isSupported()}}),Object.defineProperty(this,_getAcquirers,{writable:!0,value:memoize((e=>e.filter((e=>"acquirer"===e.type&&Dashboard_classPrivateFieldLooseBase(this,_isTargetSupported)[_isTargetSupported](e))).map(Dashboard_classPrivateFieldLooseBase(this,_attachRenderFunctionToTarget)[_attachRenderFunctionToTarget])))}),Object.defineProperty(this,_getProgressIndicators,{writable:!0,value:memoize((e=>e.filter((e=>"progressindicator"===e.type)).map(Dashboard_classPrivateFieldLooseBase(this,_attachRenderFunctionToTarget)[_attachRenderFunctionToTarget])))}),Object.defineProperty(this,_getEditors,{writable:!0,value:memoize((e=>e.filter((e=>"editor"===e.type)).map(Dashboard_classPrivateFieldLooseBase(this,_attachRenderFunctionToTarget)[_attachRenderFunctionToTarget])))}),this.render=e=>{const t=this.getPluginState(),{files:r,capabilities:n,allowNewUpload:i}=e,{newFiles:a,uploadStartedFiles:s,completeFiles:o,erroredFiles:l,inProgressFiles:c,inProgressNotPausedFiles:d,processingFiles:u,isUploadStarted:p,isAllComplete:h,isAllPaused:f}=this.uppy.getObjectOfFilesPerState(),m=Dashboard_classPrivateFieldLooseBase(this,_getAcquirers)[_getAcquirers](t.targets),g=Dashboard_classPrivateFieldLooseBase(this,_getProgressIndicators)[_getProgressIndicators](t.targets),_=Dashboard_classPrivateFieldLooseBase(this,_getEditors)[_getEditors](t.targets);let b;return b="auto"===this.opts.theme?n.darkMode?"dark":"light":this.opts.theme,["files","folders","both"].indexOf(this.opts.fileManagerSelectionType)<0&&(this.opts.fileManagerSelectionType="files",console.warn(`Unsupported option for "fileManagerSelectionType". Using default of "${this.opts.fileManagerSelectionType}".`)),Dashboard_Dashboard({state:e,isHidden:t.isHidden,files:r,newFiles:a,uploadStartedFiles:s,completeFiles:o,erroredFiles:l,inProgressFiles:c,inProgressNotPausedFiles:d,processingFiles:u,isUploadStarted:p,isAllComplete:h,isAllPaused:f,totalFileCount:Object.keys(r).length,totalProgress:e.totalProgress,allowNewUpload:i,acquirers:m,theme:b,disabled:this.opts.disabled,disableLocalFiles:this.opts.disableLocalFiles,direction:this.opts.direction,activePickerPanel:t.activePickerPanel,showFileEditor:t.showFileEditor,saveFileEditor:this.saveFileEditor,closeFileEditor:this.closeFileEditor,disableInteractiveElements:this.disableInteractiveElements,animateOpenClose:this.opts.animateOpenClose,isClosing:t.isClosing,progressindicators:g,editors:_,autoProceed:this.uppy.opts.autoProceed,id:this.id,closeModal:this.requestCloseModal,handleClickOutside:this.handleClickOutside,handleInputChange:this.handleInputChange,handlePaste:this.handlePaste,inline:this.opts.inline,showPanel:this.showPanel,hideAllPanels:this.hideAllPanels,i18n:this.i18n,i18nArray:this.i18nArray,uppy:this.uppy,note:this.opts.note,recoveredState:e.recoveredState,metaFields:t.metaFields,resumableUploads:n.resumableUploads||!1,individualCancellation:n.individualCancellation,isMobileDevice:n.isMobileDevice,fileCardFor:t.fileCardFor,toggleFileCard:this.toggleFileCard,toggleAddFilesPanel:this.toggleAddFilesPanel,showAddFilesPanel:t.showAddFilesPanel,saveFileCard:this.saveFileCard,openFileEditor:this.openFileEditor,canEditFile:this.canEditFile,width:this.opts.width,height:this.opts.height,showLinkToFileUploadResult:this.opts.showLinkToFileUploadResult,fileManagerSelectionType:this.opts.fileManagerSelectionType,proudlyDisplayPoweredByUppy:this.opts.proudlyDisplayPoweredByUppy,hideCancelButton:this.opts.hideCancelButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,showRemoveButtonAfterComplete:this.opts.showRemoveButtonAfterComplete,containerWidth:t.containerWidth,containerHeight:t.containerHeight,areInsidesReadyToBeVisible:t.areInsidesReadyToBeVisible,parentElement:this.el,allowedFileTypes:this.uppy.opts.restrictions.allowedFileTypes,maxNumberOfFiles:this.uppy.opts.restrictions.maxNumberOfFiles,requiredMetaFields:this.uppy.opts.restrictions.requiredMetaFields,showSelectedFiles:this.opts.showSelectedFiles,showNativePhotoCameraButton:this.opts.showNativePhotoCameraButton,showNativeVideoCameraButton:this.opts.showNativeVideoCameraButton,nativeCameraFacingMode:this.opts.nativeCameraFacingMode,singleFileFullScreen:this.opts.singleFileFullScreen,handleCancelRestore:this.handleCancelRestore,handleRequestThumbnail:this.handleRequestThumbnail,handleCancelThumbnail:this.handleCancelThumbnail,isDraggingOver:t.isDraggingOver,handleDragOver:this.handleDragOver,handleDragLeave:this.handleDragLeave,handleDrop:this.handleDrop})},Object.defineProperty(this,_addSpecifiedPluginsFromOptions,{writable:!0,value:()=>{const{plugins:e}=this.opts;e.forEach((e=>{const t=this.uppy.getPlugin(e);t?t.mount(this,t):this.uppy.log(`[Uppy] Dashboard could not find plugin '${e}', make sure to uppy.use() the plugins you are specifying`,"warning")}))}}),Object.defineProperty(this,_autoDiscoverPlugins,{writable:!0,value:()=>{this.uppy.iteratePlugins(Dashboard_classPrivateFieldLooseBase(this,_addSupportedPluginIfNoTarget)[_addSupportedPluginIfNoTarget])}}),Object.defineProperty(this,_addSupportedPluginIfNoTarget,{writable:!0,value:e=>{var t;!e||null!=(t=e.opts)&&t.target||!["acquirer","editor"].includes(e.type)||this.getPluginState().targets.some((t=>e.id===t.id))||e.mount(this,e)}}),this.install=()=>{this.setPluginState({isHidden:!0,fileCardFor:null,activeOverlayType:null,showAddFilesPanel:!1,activePickerPanel:void 0,showFileEditor:!1,metaFields:this.opts.metaFields,targets:[],areInsidesReadyToBeVisible:!1,isDraggingOver:!1});const{inline:e,closeAfterFinish:t}=this.opts;if(e&&t)throw new Error("[Dashboard] `closeAfterFinish: true` cannot be used on an inline Dashboard, because an inline Dashboard cannot be closed at all. Either set `inline: false`, or disable the `closeAfterFinish` option.");const{allowMultipleUploads:r,allowMultipleUploadBatches:n}=this.uppy.opts;(r||n)&&t&&this.uppy.log("[Dashboard] When using `closeAfterFinish`, we recommended setting the `allowMultipleUploadBatches` option to `false` in the Uppy constructor. See https://uppy.io/docs/uppy/#allowMultipleUploads-true","warning");const{target:i}=this.opts;i&&this.mount(i,this),this.opts.disableStatusBar||this.uppy.use(StatusBar,{id:Dashboard_classPrivateFieldLooseBase(this,_getStatusBarId)[_getStatusBarId](),target:this,...Dashboard_classPrivateFieldLooseBase(this,_getStatusBarOpts)[_getStatusBarOpts]()}),this.opts.disableInformer||this.uppy.use(Informer,{id:Dashboard_classPrivateFieldLooseBase(this,_getInformerId)[_getInformerId](),target:this,...Dashboard_classPrivateFieldLooseBase(this,_getInformerOpts)[_getInformerOpts]()}),this.opts.disableThumbnailGenerator||this.uppy.use(ThumbnailGenerator,{id:Dashboard_classPrivateFieldLooseBase(this,_getThumbnailGeneratorId)[_getThumbnailGeneratorId](),...Dashboard_classPrivateFieldLooseBase(this,_getThumbnailGeneratorOpts)[_getThumbnailGeneratorOpts]()}),this.darkModeMediaQuery="undefined"!=typeof window&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null;const a=!!this.darkModeMediaQuery&&this.darkModeMediaQuery.matches;var s;this.uppy.log("[Dashboard] Dark mode is "+(a?"on":"off")),this.setDarkModeCapability(a),"auto"===this.opts.theme&&(null==(s=this.darkModeMediaQuery)||s.addListener(this.handleSystemDarkModeChange)),Dashboard_classPrivateFieldLooseBase(this,_addSpecifiedPluginsFromOptions)[_addSpecifiedPluginsFromOptions](),Dashboard_classPrivateFieldLooseBase(this,_autoDiscoverPlugins)[_autoDiscoverPlugins](),this.initEvents()},this.uninstall=()=>{if(!this.opts.disableInformer){const e=this.uppy.getPlugin(`${this.id}:Informer`);e&&this.uppy.removePlugin(e)}if(!this.opts.disableStatusBar){const e=this.uppy.getPlugin(`${this.id}:StatusBar`);e&&this.uppy.removePlugin(e)}if(!this.opts.disableThumbnailGenerator){const e=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);e&&this.uppy.removePlugin(e)}const{plugins:e}=this.opts;var t;e.forEach((e=>{const t=this.uppy.getPlugin(e);t&&t.unmount()})),"auto"===this.opts.theme&&(null==(t=this.darkModeMediaQuery)||t.removeListener(this.handleSystemDarkModeChange)),this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.unmount(),this.removeEvents()},this.id=this.opts.id||"Dashboard",this.title="Dashboard",this.type="orchestrator",this.defaultLocale=dashboard_lib_locale,void 0===this.opts.doneButtonHandler&&(this.opts.doneButtonHandler=()=>{this.uppy.clear(),this.requestCloseModal()}),null!=(n=this.opts).onRequestCloseModal||(n.onRequestCloseModal=()=>this.closeModal()),this.i18nInit()}setOptions(e){var t,r;super.setOptions(e),null==(t=this.uppy.getPlugin(Dashboard_classPrivateFieldLooseBase(this,_getStatusBarId)[_getStatusBarId]()))||t.setOptions(Dashboard_classPrivateFieldLooseBase(this,_getStatusBarOpts)[_getStatusBarOpts]()),null==(r=this.uppy.getPlugin(Dashboard_classPrivateFieldLooseBase(this,_getThumbnailGeneratorId)[_getThumbnailGeneratorId]()))||r.setOptions(Dashboard_classPrivateFieldLooseBase(this,_getThumbnailGeneratorOpts)[_getThumbnailGeneratorOpts]())}}function _getStatusBarOpts2(){const{hideUploadButton:e,hideRetryButton:t,hidePauseResumeButton:r,hideCancelButton:n,showProgressDetails:i,hideProgressAfterFinish:a,locale:s,doneButtonHandler:o}=this.opts;return{hideUploadButton:e,hideRetryButton:t,hidePauseResumeButton:r,hideCancelButton:n,showProgressDetails:i,hideAfterFinish:a,locale:s,doneButtonHandler:o}}function _getThumbnailGeneratorOpts2(){const{thumbnailWidth:e,thumbnailHeight:t,thumbnailType:r,waitForThumbnailsBeforeUpload:n}=this.opts;return{thumbnailWidth:e,thumbnailHeight:t,thumbnailType:r,waitForThumbnailsBeforeUpload:n,lazy:!n}}function _getInformerOpts2(){return{}}function _getStatusBarId2(){return`${this.id}:StatusBar`}function _getThumbnailGeneratorId2(){return`${this.id}:ThumbnailGenerator`}function _getInformerId2(){return`${this.id}:Informer`}function RateLimitedQueue_classPrivateFieldLooseBase(e,t){if(!{}.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}Dashboard.VERSION=Dashboard_packageJson.version;var RateLimitedQueue_id=0;function RateLimitedQueue_classPrivateFieldLooseKey(e){return"__private_"+RateLimitedQueue_id+++"_"+e}function createCancelError(e){return new Error("Cancelled",{cause:e})}function abortOn(e){if(null!=e){var t;const r=()=>this.abort(e.reason);e.addEventListener("abort",r,{once:!0});const n=()=>{e.removeEventListener("abort",r)};null==(t=this.then)||t.call(this,n,n)}return this}var _activeRequests=RateLimitedQueue_classPrivateFieldLooseKey("activeRequests"),_queuedHandlers=RateLimitedQueue_classPrivateFieldLooseKey("queuedHandlers"),_paused=RateLimitedQueue_classPrivateFieldLooseKey("paused"),_pauseTimer=RateLimitedQueue_classPrivateFieldLooseKey("pauseTimer"),_downLimit=RateLimitedQueue_classPrivateFieldLooseKey("downLimit"),_upperLimit=RateLimitedQueue_classPrivateFieldLooseKey("upperLimit"),_rateLimitingTimer=RateLimitedQueue_classPrivateFieldLooseKey("rateLimitingTimer"),_call=RateLimitedQueue_classPrivateFieldLooseKey("call"),_queueNext=RateLimitedQueue_classPrivateFieldLooseKey("queueNext"),_next=RateLimitedQueue_classPrivateFieldLooseKey("next"),_queue=RateLimitedQueue_classPrivateFieldLooseKey("queue"),_dequeue=RateLimitedQueue_classPrivateFieldLooseKey("dequeue"),_resume=RateLimitedQueue_classPrivateFieldLooseKey("resume"),_increaseLimit=RateLimitedQueue_classPrivateFieldLooseKey("increaseLimit");class RateLimitedQueue{constructor(e){Object.defineProperty(this,_dequeue,{value:_dequeue2}),Object.defineProperty(this,_queue,{value:_queue2}),Object.defineProperty(this,_next,{value:_next2}),Object.defineProperty(this,_queueNext,{value:_queueNext2}),Object.defineProperty(this,_call,{value:_call2}),Object.defineProperty(this,_activeRequests,{writable:!0,value:0}),Object.defineProperty(this,_queuedHandlers,{writable:!0,value:[]}),Object.defineProperty(this,_paused,{writable:!0,value:!1}),Object.defineProperty(this,_pauseTimer,{writable:!0,value:void 0}),Object.defineProperty(this,_downLimit,{writable:!0,value:1}),Object.defineProperty(this,_upperLimit,{writable:!0,value:void 0}),Object.defineProperty(this,_rateLimitingTimer,{writable:!0,value:void 0}),Object.defineProperty(this,_resume,{writable:!0,value:()=>this.resume()}),Object.defineProperty(this,_increaseLimit,{writable:!0,value:()=>{if(RateLimitedQueue_classPrivateFieldLooseBase(this,_paused)[_paused])RateLimitedQueue_classPrivateFieldLooseBase(this,_rateLimitingTimer)[_rateLimitingTimer]=setTimeout(RateLimitedQueue_classPrivateFieldLooseBase(this,_increaseLimit)[_increaseLimit],0);else{RateLimitedQueue_classPrivateFieldLooseBase(this,_downLimit)[_downLimit]=this.limit,this.limit=Math.ceil((RateLimitedQueue_classPrivateFieldLooseBase(this,_upperLimit)[_upperLimit]+RateLimitedQueue_classPrivateFieldLooseBase(this,_downLimit)[_downLimit])/2);for(let e=RateLimitedQueue_classPrivateFieldLooseBase(this,_downLimit)[_downLimit];e<=this.limit;e++)RateLimitedQueue_classPrivateFieldLooseBase(this,_queueNext)[_queueNext]();RateLimitedQueue_classPrivateFieldLooseBase(this,_upperLimit)[_upperLimit]-RateLimitedQueue_classPrivateFieldLooseBase(this,_downLimit)[_downLimit]>3?RateLimitedQueue_classPrivateFieldLooseBase(this,_rateLimitingTimer)[_rateLimitingTimer]=setTimeout(RateLimitedQueue_classPrivateFieldLooseBase(this,_increaseLimit)[_increaseLimit],2e3):RateLimitedQueue_classPrivateFieldLooseBase(this,_downLimit)[_downLimit]=Math.floor(RateLimitedQueue_classPrivateFieldLooseBase(this,_downLimit)[_downLimit]/2)}}}),this.limit="number"!=typeof e||0===e?1/0:e}run(e,t){return!RateLimitedQueue_classPrivateFieldLooseBase(this,_paused)[_paused]&&RateLimitedQueue_classPrivateFieldLooseBase(this,_activeRequests)[_activeRequests]<this.limit?RateLimitedQueue_classPrivateFieldLooseBase(this,_call)[_call](e):RateLimitedQueue_classPrivateFieldLooseBase(this,_queue)[_queue](e,t)}wrapSyncFunction(e,t){var r=this;return function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];const s=r.run((()=>(e(...i),queueMicrotask((()=>s.done())),()=>{})),t);return{abortOn,abort(){s.abort()}}}}wrapPromiseFunction(e,t){var r=this;return function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];let s;const o=new Promise(((n,a)=>{s=r.run((()=>{let t,r;try{r=Promise.resolve(e(...i))}catch(e){r=Promise.reject(e)}return r.then((e=>{t?a(t):(s.done(),n(e))}),(e=>{t?a(t):(s.done(),a(e))})),e=>{t=createCancelError(e)}}),t)}));return o.abort=e=>{s.abort(e)},o.abortOn=abortOn,o}}resume(){RateLimitedQueue_classPrivateFieldLooseBase(this,_paused)[_paused]=!1,clearTimeout(RateLimitedQueue_classPrivateFieldLooseBase(this,_pauseTimer)[_pauseTimer]);for(let e=0;e<this.limit;e++)RateLimitedQueue_classPrivateFieldLooseBase(this,_queueNext)[_queueNext]()}pause(e){void 0===e&&(e=null),RateLimitedQueue_classPrivateFieldLooseBase(this,_paused)[_paused]=!0,clearTimeout(RateLimitedQueue_classPrivateFieldLooseBase(this,_pauseTimer)[_pauseTimer]),null!=e&&(RateLimitedQueue_classPrivateFieldLooseBase(this,_pauseTimer)[_pauseTimer]=setTimeout(RateLimitedQueue_classPrivateFieldLooseBase(this,_resume)[_resume],e))}rateLimit(e){clearTimeout(RateLimitedQueue_classPrivateFieldLooseBase(this,_rateLimitingTimer)[_rateLimitingTimer]),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(RateLimitedQueue_classPrivateFieldLooseBase(this,_upperLimit)[_upperLimit]=this.limit-1,this.limit=RateLimitedQueue_classPrivateFieldLooseBase(this,_downLimit)[_downLimit],RateLimitedQueue_classPrivateFieldLooseBase(this,_rateLimitingTimer)[_rateLimitingTimer]=setTimeout(RateLimitedQueue_classPrivateFieldLooseBase(this,_increaseLimit)[_increaseLimit],e))}get isPaused(){return RateLimitedQueue_classPrivateFieldLooseBase(this,_paused)[_paused]}}function _call2(e){RateLimitedQueue_classPrivateFieldLooseBase(this,_activeRequests)[_activeRequests]+=1;let t,r=!1;try{t=e()}catch(e){throw RateLimitedQueue_classPrivateFieldLooseBase(this,_activeRequests)[_activeRequests]-=1,e}return{abort:e=>{r||(r=!0,RateLimitedQueue_classPrivateFieldLooseBase(this,_activeRequests)[_activeRequests]-=1,null==t||t(e),RateLimitedQueue_classPrivateFieldLooseBase(this,_queueNext)[_queueNext]())},done:()=>{r||(r=!0,RateLimitedQueue_classPrivateFieldLooseBase(this,_activeRequests)[_activeRequests]-=1,RateLimitedQueue_classPrivateFieldLooseBase(this,_queueNext)[_queueNext]())}}}function _queueNext2(){queueMicrotask((()=>RateLimitedQueue_classPrivateFieldLooseBase(this,_next)[_next]()))}function _next2(){if(RateLimitedQueue_classPrivateFieldLooseBase(this,_paused)[_paused]||RateLimitedQueue_classPrivateFieldLooseBase(this,_activeRequests)[_activeRequests]>=this.limit)return;if(0===RateLimitedQueue_classPrivateFieldLooseBase(this,_queuedHandlers)[_queuedHandlers].length)return;const e=RateLimitedQueue_classPrivateFieldLooseBase(this,_queuedHandlers)[_queuedHandlers].shift();if(null==e)throw new Error("Invariant violation: next is null");const t=RateLimitedQueue_classPrivateFieldLooseBase(this,_call)[_call](e.fn);e.abort=t.abort,e.done=t.done}function _queue2(e,t){const r={fn:e,priority:(null==t?void 0:t.priority)||0,abort:()=>{RateLimitedQueue_classPrivateFieldLooseBase(this,_dequeue)[_dequeue](r)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},n=RateLimitedQueue_classPrivateFieldLooseBase(this,_queuedHandlers)[_queuedHandlers].findIndex((e=>r.priority>e.priority));return-1===n?RateLimitedQueue_classPrivateFieldLooseBase(this,_queuedHandlers)[_queuedHandlers].push(r):RateLimitedQueue_classPrivateFieldLooseBase(this,_queuedHandlers)[_queuedHandlers].splice(n,0,r),r}function _dequeue2(e){const t=RateLimitedQueue_classPrivateFieldLooseBase(this,_queuedHandlers)[_queuedHandlers].indexOf(e);-1!==t&&RateLimitedQueue_classPrivateFieldLooseBase(this,_queuedHandlers)[_queuedHandlers].splice(t,1)}const internalRateLimitedQueue=Symbol("__queue");var compressor=__webpack_require__(3807);const compressor_lib_locale={strings:{compressingImages:"Compressing images...",compressedX:"Saved %{size} by compressing images"}};function compressor_lib_classPrivateFieldLooseBase(e,t){if(!{}.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var compressor_lib_id=0;function compressor_lib_classPrivateFieldLooseKey(e){return"__private_"+compressor_lib_id+++"_"+e}const compressor_lib_defaultOptions={quality:.6,limit:10};var _RateLimitedQueue=compressor_lib_classPrivateFieldLooseKey("RateLimitedQueue");class Compressor extends BasePlugin{constructor(e,t){super(e,{...compressor_lib_defaultOptions,...t}),Object.defineProperty(this,_RateLimitedQueue,{writable:!0,value:void 0}),this.id=this.opts.id||"Compressor",this.type="modifier",this.defaultLocale=compressor_lib_locale,compressor_lib_classPrivateFieldLooseBase(this,_RateLimitedQueue)[_RateLimitedQueue]=new RateLimitedQueue(this.opts.limit),this.i18nInit(),this.prepareUpload=this.prepareUpload.bind(this),this.compress=this.compress.bind(this)}compress(e){return new Promise(((t,r)=>{new compressor(e,{...this.opts,success:t,error:r})}))}async prepareUpload(e){let t=0;const r=[],n=compressor_lib_classPrivateFieldLooseBase(this,_RateLimitedQueue)[_RateLimitedQueue].wrapPromiseFunction((async e=>{try{const n=await this.compress(e.data),i=e.data.size-n.size;this.uppy.log(`[Image Compressor] Image ${e.id} compressed by ${prettierBytes(i)}`),t+=i;const{name:a,type:s,size:o}=n,l=getFileNameAndExtension(a),c=`${getFileNameAndExtension(e.meta.name).name}.${l.extension}`;this.uppy.setFileState(e.id,{...a&&{name:a},...l.extension&&{extension:l.extension},...s&&{type:s},...o&&{size:o},data:n,meta:{...e.meta,type:s,name:c}}),r.push(e)}catch(t){this.uppy.log(`[Image Compressor] Failed to compress ${e.id}:`,"warning"),this.uppy.log(t,"warning")}})),i=e.map((e=>{var t;const r=this.uppy.getFile(e);return this.uppy.emit("preprocess-progress",r,{mode:"indeterminate",message:this.i18n("compressingImages")}),r.isRemote?Promise.resolve():(r.data.type||(r.data=r.data.slice(0,r.data.size,r.type)),null!=(t=r.type)&&t.startsWith("image/")?n(r):Promise.resolve())}));await Promise.all(i),this.uppy.emit("compressor:complete",r),t>1024&&this.uppy.info(this.i18n("compressedX",{size:prettierBytes(t)}),"info");for(const t of e){const e=this.uppy.getFile(t);this.uppy.emit("preprocess-complete",e)}}install(){this.uppy.addPreProcessor(this.prepareUpload)}uninstall(){this.uppy.removePreProcessor(this.prepareUpload)}}var cropper=__webpack_require__(5643);function getCanvasDataThatFitsPerfectlyIntoContainer(e,t){const r=e.width/t.width,n=e.height/t.height,i=Math.min(r,n),a=t.width*i,s=t.height*i;return{width:a,height:s,left:(e.width-a)/2,top:(e.height-s)/2}}const utils_getCanvasDataThatFitsPerfectlyIntoContainer=getCanvasDataThatFitsPerfectlyIntoContainer;function toRadians(e){return e*(Math.PI/180)}function getScaleFactorThatRemovesDarkCorners(e,t,r){const n=Math.abs(toRadians(r));return Math.max((Math.sin(n)*e+Math.cos(n)*t)/t,(Math.sin(n)*t+Math.cos(n)*e)/e)}const utils_getScaleFactorThatRemovesDarkCorners=getScaleFactorThatRemovesDarkCorners;function limitCropboxMovementOnMove(e,t,r){return t.left<e.left?{left:e.left,width:r.width}:t.top<e.top?{top:e.top,height:r.height}:t.left+t.width>e.left+e.width?{left:e.left+e.width-r.width,width:r.width}:t.top+t.height>e.top+e.height?{top:e.top+e.height-r.height,height:r.height}:null}const utils_limitCropboxMovementOnMove=limitCropboxMovementOnMove;function limitCropboxMovementOnResize(e,t,r){return t.left<e.left?{left:e.left,width:r.left+r.width-e.left}:t.top<e.top?{top:e.top,height:r.top+r.height-e.top}:t.left+t.width>e.left+e.width?{left:r.left,width:e.left+e.width-r.left}:t.top+t.height>e.top+e.height?{top:r.top,height:e.top+e.height-r.top}:null}const utils_limitCropboxMovementOnResize=limitCropboxMovementOnResize;class Editor extends x{constructor(e){super(e),this.onRotate90Deg=()=>{const{angle90Deg:e}=this.state,t=e-90;this.setState({angle90Deg:t,angleGranular:0}),this.cropper.scale(1),this.cropper.rotateTo(t);const r=this.cropper.getCanvasData(),n=this.cropper.getContainerData(),i=utils_getCanvasDataThatFitsPerfectlyIntoContainer(n,r);this.cropper.setCanvasData(i),this.cropper.setCropBoxData(i)},this.onRotateGranular=e=>{const t=Number(e.target.value);this.setState({angleGranular:t});const{angle90Deg:r}=this.state,n=r+t;this.cropper.rotateTo(n);const i=this.cropper.getImageData(),a=utils_getScaleFactorThatRemovesDarkCorners(i.naturalWidth,i.naturalHeight,t),s=this.cropper.getImageData().scaleX<0?-a:a;this.cropper.scale(s,a)},this.state={angle90Deg:0,angleGranular:0,prevCropboxData:null},this.storePrevCropboxData=this.storePrevCropboxData.bind(this),this.limitCropboxMovement=this.limitCropboxMovement.bind(this)}componentDidMount(){const{opts:e,storeCropperInstance:t}=this.props;this.cropper=new cropper(this.imgElement,e.cropperOptions),this.imgElement.addEventListener("cropstart",this.storePrevCropboxData),this.imgElement.addEventListener("cropend",this.limitCropboxMovement),t(this.cropper)}componentWillUnmount(){this.cropper.destroy(),this.imgElement.removeEventListener("cropstart",this.storePrevCropboxData),this.imgElement.removeEventListener("cropend",this.limitCropboxMovement)}storePrevCropboxData(){this.setState({prevCropboxData:this.cropper.getCropBoxData()})}limitCropboxMovement(e){const t=this.cropper.getCanvasData(),r=this.cropper.getCropBoxData(),{prevCropboxData:n}=this.state;if("all"===e.detail.action){const e=utils_limitCropboxMovementOnMove(t,r,n);e&&this.cropper.setCropBoxData(e)}else{const e=utils_limitCropboxMovementOnResize(t,r,n);e&&this.cropper.setCropBoxData(e)}}renderGranularRotate(){const{i18n:e}=this.props,{angleGranular:t}=this.state;return _("label",{role:"tooltip","aria-label":`${t}Âº`,"data-microtip-position":"top",className:"uppy-ImageCropper-rangeWrapper"},_("input",{className:"uppy-ImageCropper-range uppy-u-reset",type:"range",onInput:this.onRotateGranular,onChange:this.onRotateGranular,value:t,min:"-45",max:"45","aria-label":e("rotate")}))}renderRevert(){const{i18n:e,opts:t}=this.props;return _("button",{role:"button tooltip","data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":e("revert"),onClick:()=>{this.cropper.reset(),this.cropper.setAspectRatio(t.cropperOptions.initialAspectRatio),this.setState({angle90Deg:0,angleGranular:0})}},_("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24"},_("path",{d:"M0 0h24v24H0z",fill:"none"}),_("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"})))}renderRotate(){const{i18n:e}=this.props;return _("button",{role:"button tooltip","data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":e("rotate"),onClick:this.onRotate90Deg},_("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24"},_("path",{d:"M0 0h24v24H0V0zm0 0h24v24H0V0z",fill:"none"}),_("path",{d:"M14 10a2 2 0 012 2v7a2 2 0 01-2 2H6a2 2 0 01-2-2v-7a2 2 0 012-2h8zm0 1.75H6a.25.25 0 00-.243.193L5.75 12v7a.25.25 0 00.193.243L6 19.25h8a.25.25 0 00.243-.193L14.25 19v-7a.25.25 0 00-.193-.243L14 11.75zM12 .76V4c2.3 0 4.61.88 6.36 2.64a8.95 8.95 0 012.634 6.025L21 13a1 1 0 01-1.993.117L19 13h-.003a6.979 6.979 0 00-2.047-4.95 6.97 6.97 0 00-4.652-2.044L12 6v3.24L7.76 5 12 .76z"})))}renderFlip(){const{i18n:e}=this.props;return _("button",{role:"button tooltip","data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":e("flipHorizontal"),onClick:()=>this.cropper.scaleX(-this.cropper.getData().scaleX||-1)},_("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24"},_("path",{d:"M0 0h24v24H0z",fill:"none"}),_("path",{d:"M15 21h2v-2h-2v2zm4-12h2V7h-2v2zM3 5v14c0 1.1.9 2 2 2h4v-2H5V5h4V3H5c-1.1 0-2 .9-2 2zm16-2v2h2c0-1.1-.9-2-2-2zm-8 20h2V1h-2v22zm8-6h2v-2h-2v2zM15 5h2V3h-2v2zm4 8h2v-2h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2z"})))}renderZoomIn(){const{i18n:e}=this.props;return _("button",{role:"button tooltip","data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":e("zoomIn"),onClick:()=>this.cropper.zoom(.1)},_("svg",{"aria-hidden":"true",className:"uppy-c-icon",height:"24",viewBox:"0 0 24 24",width:"24"},_("path",{d:"M0 0h24v24H0V0z",fill:"none"}),_("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),_("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"})))}renderZoomOut(){const{i18n:e}=this.props;return _("button",{role:"button tooltip","data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":e("zoomOut"),onClick:()=>this.cropper.zoom(-.1)},_("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24"},_("path",{d:"M0 0h24v24H0V0z",fill:"none"}),_("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z"})))}renderCropSquare(){const{i18n:e}=this.props;return _("button",{role:"button tooltip","data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":e("aspectRatioSquare"),onClick:()=>this.cropper.setAspectRatio(1)},_("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24"},_("path",{d:"M0 0h24v24H0z",fill:"none"}),_("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})))}renderCropWidescreen(){const{i18n:e}=this.props;return _("button",{role:"button tooltip","data-microtip-position":"top",type:"button",className:"uppy-u-reset uppy-c-btn","aria-label":e("aspectRatioLandscape"),onClick:()=>this.cropper.setAspectRatio(16/9)},_("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24"},_("path",{d:"M 19,4.9999992 V 17.000001 H 4.9999998 V 6.9999992 H 19 m 0,-2 H 4.9999998 c -1.0999999,0 -1.9999999,0.9000001 -1.9999999,2 V 17.000001 c 0,1.1 0.9,2 1.9999999,2 H 19 c 1.1,0 2,-0.9 2,-2 V 6.9999992 c 0,-1.0999999 -0.9,-2 -2,-2 z"}),_("path",{fill:"none",d:"M0 0h24v24H0z"})))}renderCropWidescreenVertical(){const{i18n:e}=this.props;return _("button",{role:"button tooltip","data-microtip-position":"top",type:"button","aria-label":e("aspectRatioPortrait"),className:"uppy-u-reset uppy-c-btn",onClick:()=>this.cropper.setAspectRatio(9/16)},_("svg",{"aria-hidden":"true",className:"uppy-c-icon",width:"24",height:"24",viewBox:"0 0 24 24"},_("path",{d:"M 19.000001,19 H 6.999999 V 5 h 10.000002 v 14 m 2,0 V 5 c 0,-1.0999999 -0.9,-1.9999999 -2,-1.9999999 H 6.999999 c -1.1,0 -2,0.9 -2,1.9999999 v 14 c 0,1.1 0.9,2 2,2 h 10.000002 c 1.1,0 2,-0.9 2,-2 z"}),_("path",{d:"M0 0h24v24H0z",fill:"none"})))}render(){const{currentImage:e,opts:t}=this.props,{actions:r}=t,n=URL.createObjectURL(e.data);return _("div",{className:"uppy-ImageCropper"},_("div",{className:"uppy-ImageCropper-container"},_("img",{className:"uppy-ImageCropper-image",alt:e.name,src:n,ref:e=>{this.imgElement=e}})),_("div",{className:"uppy-ImageCropper-controls"},r.revert&&this.renderRevert(),r.rotate&&this.renderRotate(),r.granularRotate&&this.renderGranularRotate(),r.flip&&this.renderFlip(),r.zoomIn&&this.renderZoomIn(),r.zoomOut&&this.renderZoomOut(),r.cropSquare&&this.renderCropSquare(),r.cropWidescreen&&this.renderCropWidescreen(),r.cropWidescreenVertical&&this.renderCropWidescreenVertical()))}}const image_editor_lib_locale={strings:{revert:"Reset",rotate:"Rotate 90Â°",zoomIn:"Zoom in",zoomOut:"Zoom out",flipHorizontal:"Flip horizontally",aspectRatioSquare:"Crop square",aspectRatioLandscape:"Crop landscape (16:9)",aspectRatioPortrait:"Crop portrait (9:16)"}},ImageEditor_packageJson={version:"3.3.1"},defaultCropperOptions={viewMode:0,background:!1,autoCropArea:1,responsive:!0,minCropBoxWidth:70,minCropBoxHeight:70,croppedCanvasOptions:{},initialAspectRatio:0},defaultActions={revert:!0,rotate:!0,granularRotate:!0,flip:!0,zoomIn:!0,zoomOut:!0,cropSquare:!0,cropWidescreen:!0,cropWidescreenVertical:!0},ImageEditor_defaultOptions={quality:.8,actions:defaultActions,cropperOptions:defaultCropperOptions};class ImageEditor extends lib_UIPlugin{constructor(e,t){super(e,{...ImageEditor_defaultOptions,...t,actions:{...defaultActions,...null==t?void 0:t.actions},cropperOptions:{...defaultCropperOptions,...null==t?void 0:t.cropperOptions}}),this.save=()=>{const{currentImage:e}=this.getPluginState(),t=this.cropper.getCroppedCanvas({});t.width%2!=0&&this.cropper.setData({width:t.width-1}),t.height%2!=0&&this.cropper.setData({height:t.height-1}),this.cropper.getCroppedCanvas(this.opts.cropperOptions.croppedCanvasOptions).toBlob((e=>{var t;const{currentImage:r}=this.getPluginState();this.uppy.setFileState(r.id,{data:new File([e],null!=(t=r.name)?t:this.i18n("unnamed"),{type:e.type}),size:e.size,preview:void 0});const n=this.uppy.getFile(r.id);this.uppy.emit("thumbnail:request",n),this.setPluginState({currentImage:n}),this.uppy.emit("file-editor:complete",n)}),e.type,this.opts.quality)},this.storeCropperInstance=e=>{this.cropper=e},this.selectFile=e=>{this.uppy.emit("file-editor:start",e),this.setPluginState({currentImage:e})},this.id=this.opts.id||"ImageEditor",this.title="Image Editor",this.type="editor",this.defaultLocale=image_editor_lib_locale,this.i18nInit()}canEditFile(e){if(!e.type||e.isRemote)return!1;const t=e.type.split("/")[1];return!!/^(jpe?g|gif|png|bmp|webp)$/.test(t)}install(){this.setPluginState({currentImage:null});const{target:e}=this.opts;e&&this.mount(e,this)}uninstall(){const{currentImage:e}=this.getPluginState();if(e){const t=this.uppy.getFile(e.id);this.uppy.emit("file-editor:cancel",t)}this.unmount()}render(){const{currentImage:e}=this.getPluginState();return null===e||e.isRemote?null:_(Editor,{currentImage:e,storeCropperInstance:this.storeCropperInstance,save:this.save,opts:this.opts,i18n:this.i18n})}}ImageEditor.VERSION=ImageEditor_packageJson.version;var injectStylesIntoStyleTag=__webpack_require__(5072),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),styleDomAPI=__webpack_require__(7825),styleDomAPI_default=__webpack_require__.n(styleDomAPI),insertBySelector=__webpack_require__(7659),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithoutAttributes=__webpack_require__(5056),setAttributesWithoutAttributes_default=__webpack_require__.n(setAttributesWithoutAttributes),insertStyleElement=__webpack_require__(540),insertStyleElement_default=__webpack_require__.n(insertStyleElement),styleTagTransform=__webpack_require__(1113),styleTagTransform_default=__webpack_require__.n(styleTagTransform),style_min=__webpack_require__(5522),options={};options.styleTagTransform=styleTagTransform_default(),options.setAttributes=setAttributesWithoutAttributes_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=styleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();var update=injectStylesIntoStyleTag_default()(style_min.A,options);const dist_style_min=style_min.A&&style_min.A.locals?style_min.A.locals:void 0;var dashboard_dist_style_min=__webpack_require__(6867),style_min_options={};style_min_options.styleTagTransform=styleTagTransform_default(),style_min_options.setAttributes=setAttributesWithoutAttributes_default(),style_min_options.insert=insertBySelector_default().bind(null,"head"),style_min_options.domAPI=styleDomAPI_default(),style_min_options.insertStyleElement=insertStyleElement_default();var style_min_update=injectStylesIntoStyleTag_default()(dashboard_dist_style_min.A,style_min_options);const _uppy_dashboard_dist_style_min=dashboard_dist_style_min.A&&dashboard_dist_style_min.A.locals?dashboard_dist_style_min.A.locals:void 0;var image_editor_dist_style_min=__webpack_require__(7204),dist_style_min_options={};dist_style_min_options.styleTagTransform=styleTagTransform_default(),dist_style_min_options.setAttributes=setAttributesWithoutAttributes_default(),dist_style_min_options.insert=insertBySelector_default().bind(null,"head"),dist_style_min_options.domAPI=styleDomAPI_default(),dist_style_min_options.insertStyleElement=insertStyleElement_default();var dist_style_min_update=injectStylesIntoStyleTag_default()(image_editor_dist_style_min.A,dist_style_min_options);const _uppy_image_editor_dist_style_min=image_editor_dist_style_min.A&&image_editor_dist_style_min.A.locals?image_editor_dist_style_min.A.locals:void 0;function imageUploader_typeof(e){return imageUploader_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},imageUploader_typeof(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var a=t&&t.prototype instanceof _?t:_,s=Object.create(a.prototype),o=new k(n||[]);return i(s,"_invoke",{value:x(e,r,o)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p="suspendedStart",h="suspendedYield",f="executing",m="completed",g={};function _(){}function b(){}function v(){}var y={};c(y,s,(function(){return this}));var w=Object.getPrototypeOf,E=w&&w(w(L([])));E&&E!==r&&n.call(E,s)&&(y=E);var S=v.prototype=_.prototype=Object.create(y);function T(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(i,a,s,o){var l=u(e[i],e,a);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==imageUploader_typeof(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,s,o)}),(function(e){r("throw",e,s,o)})):t.resolve(d).then((function(e){c.value=e,s(c)}),(function(e){return r("throw",e,s,o)}))}o(l.arg)}var a;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return a=a?a.then(i,i):i()}})}function x(t,r,n){var i=p;return function(a,s){if(i===f)throw Error("Generator is already running");if(i===m){if("throw"===a)throw s;return{value:e,done:!0}}for(n.method=a,n.arg=s;;){var o=n.delegate;if(o){var l=A(o,n);if(l){if(l===g)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===p)throw i=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=f;var c=u(t,r,n);if("normal"===c.type){if(i=n.done?m:h,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=m,n.method="throw",n.arg=c.arg)}}}function A(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var a=u(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,g;var s=a.arg;return s?s.done?(r[t.resultName]=s.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(imageUploader_typeof(t)+" is not iterable")}return b.prototype=v,i(S,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:b,configurable:!0}),b.displayName=c(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,c(e,l,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},T(C.prototype),c(C.prototype,o,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,i,a){void 0===a&&(a=Promise);var s=new C(d(e,r,n,i),a);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},T(S),c(S,l,"Generator"),c(S,s,(function(){return this})),c(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(D),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return o.type="throw",o.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),D(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;D(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function asyncGeneratorStep(e,t,r,n,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,i)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function s(e){asyncGeneratorStep(a,n,i,s,o,"next",e)}function o(e){asyncGeneratorStep(a,n,i,s,o,"throw",e)}s(void 0)}))}}function imageUploader_createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=imageUploader_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw a}}}}function imageUploader_unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return imageUploader_arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?imageUploader_arrayLikeToArray(e,t):void 0}}function imageUploader_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var imageUploader_state={classNamePrefix:null,logPrefix:"LT Image Uploader: ",observer:null,observedElements:new Map,renderedCss:!1,options:{quality:.7,maxWidth:1500,maxHeight:1500},upload:{request:null,security:null,uriUploadForm:checkUploadFormUri("https://authorapi.learnosity.com/latest-lts/assets/uploadform")},uppy:null};function imageUploader_run(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};imageUploader_state.renderedCss||imageUploader_injectCSS(),imageUploader_state.upload.security=e,imageUploader_state.upload.request=t,overrideOptions(r),validateRunParams()&&core_app.appInstance().on("widgetedit:widget:ready",setupModalObserver)}function setupModalObserver(){utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"setupModalObserver()")),imageUploader_state.classNamePrefix=checkAppVersion(imageUploader_state.classNamePrefix),clearObserver(),imageUploader_state.observedElements.size?utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"Observed elements full")):(imageUploader_state.observer=new MutationObserver((function(e){var t,r=imageUploader_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;)if("childList"===t.value.type){var n=document.querySelector('[data-authorapi-selector="asset-uploader-iframe-outlet"]:not(.lrn-author-slide-pane [data-authorapi-selector="asset-uploader-iframe-outlet"]):not(.lrn-qe-slide-pane [data-authorapi-selector="asset-uploader-iframe-outlet"])'),i=document.querySelector('[data-authorapi-selector="asset-display-name"]');if(n&&!i){utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"Disconnecting observer")),clearObserver(),setupUploderUI();break}}}catch(e){r.e(e)}finally{r.f()}})),activateObserver())}function activateObserver(){utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"Looking to activate observer"));var e=document.querySelector(".lrn-author-item");imageUploader_state.observedElements.has(e)||(utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"Activated observer")),imageUploader_state.observer.observe(e,{childList:!0,subtree:!0}),imageUploader_state.observedElements.set(e,imageUploader_state.observer))}function clearObserver(){var e;null===(e=imageUploader_state.observer)||void 0===e||e.disconnect(),imageUploader_state.observedElements.clear()}function setupUploderUI(){var e=document.querySelector('[data-authorapi-selector="asset-uploader-alignment"]'),t=document.querySelector(".lrn-".concat(imageUploader_state.classNamePrefix,"image-uploader-preview"));setTimeout((function(){var e=document.querySelector('[data-authorapi-selector="asset-uploader-iframe-outlet"]'),t=e.querySelector("iframe"),r=document.querySelector(".lrn-".concat(imageUploader_state.classNamePrefix,"adv-options")),n=document.createElement("div");n.setAttribute("id","uppy-dashboard"),t.setAttribute("hidden",""),e.insertAdjacentElement("afterbegin",n),listenForSelfHostedImages(),prepareModalButtons(),r.removeAttribute("hidden"),setupUploadLibrary()}),e||t?500:0)}function setupUploadLibrary(){imageUploader_state.uppy=new lib_Uppy({debug:!1,autoProceed:!1,restrictions:{maxNumberOfFiles:1,minNumberOfFiles:1,allowedFileTypes:["image/gif","image/jpeg","image/png","image/svg+xml"]}}).use(Dashboard,{inline:!0,width:790,height:350,autoOpen:null,disableStatusBar:!0,target:"#uppy-dashboard",showProgressDetails:!1,proudlyDisplayPoweredByUppy:!1}).use(Compressor,{quality:imageUploader_state.options.quality,convertSize:5e5,convertTypes:["image/png"],maxHeight:imageUploader_state.options.maxHeight,maxWidth:imageUploader_state.options.maxWidth}).use(ImageEditor,{target:Dashboard}),imageUploader_state.uppy.on("file-added",(function(e){utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"file-added: ").concat(e.source)),document.querySelector(".lrn-".concat(imageUploader_state.classNamePrefix,"adv-options")).setAttribute("hidden",""),"Dashboard"===e.source&&compressImage(e)})),imageUploader_state.uppy.on("file-removed",(function(){utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"file-removed")),toggleElement("lt__image-uploader-upload-btn","remove")})),imageUploader_state.uppy.on("file-editor:start",(function(){utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"file-editor:start")),toggleElement("lt__image-uploader-upload-btn","disable")})),imageUploader_state.uppy.on("file-editor:complete",(function(e){utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"file-editor:complete")),compressImage(e),toggleElement("lt__image-uploader-upload-btn","enable")})),imageUploader_state.uppy.on("file-editor:cancel",(function(){utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"file-editor:cancel")),toggleElement("lt__image-uploader-upload-btn","enable")})),imageUploader_state.uppy.on("error",(function(e){utils_logger.A.error(e.stack)}))}function compressImage(e){var t=e.name,r=e.meta,n=e.type;"image/svg+xml"!==n?(utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"Compressing image")),imageUploader_state.uppy.getPlugin("Compressor").compress(e.data).then((function(i){setTimeout((function(){imageUploader_state.uppy.removeFile(e.id),imageUploader_state.uppy.addFile({name:t,type:n,meta:r,data:i,source:"Local"});var a,s=imageUploader_state.uppy.store.state.files;for(var o in s)a=o;addUploadButton(a)}),50)}))):addUploadButton(e.id)}function addUploadButton(e){var t=document.querySelector(".lrn-".concat(imageUploader_state.classNamePrefix,"modal-footer"));removeUploadButton();var r=document.createElement("button"),n=imageUploader_state.classNamePrefix?"-old":"";r.setAttribute("class","lrn-".concat(imageUploader_state.classNamePrefix,"btn").concat(n," lrn-").concat(imageUploader_state.classNamePrefix,"btn").concat(n,"-legacy lt__image-uploader-upload-btn")),r.textContent="Upload",t.insertAdjacentElement("afterbegin",r),r.addEventListener("click",(function(){return uploadImage(e)}))}function removeUploadButton(){var e=document.querySelector(".lt__image-uploader-upload-btn");e&&(utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"Removing existing upload button")),e.remove())}function uploadImage(e){document.querySelector(".lt__image-uploader-upload-btn").removeEventListener("click",(function(){return uploadImage(e)}));var t=document.querySelector(".uppy-Dashboard-Item-action--edit");null==t||t.setAttribute("disabled","");var r=imageUploader_state.uppy.getFile(e),n=document.querySelector(".lt__image-uploader-upload-btn");n.setAttribute("style","width:105px;"),n.innerHTML='<span class="lt__upload-spinner"><svg width="14" height="14" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><style>.spinner_6kVp{transform-origin:center;animation:spinner_irSm .75s infinite linear}@keyframes spinner_irSm{100%{transform:rotate(360deg)};fill:#ffffff;}</style><path d="M10.72,19.9a8,8,0,0,1-6.5-9.79A7.77,7.77,0,0,1,10.4,4.16a8,8,0,0,1,9.49,6.52A1.54,1.54,0,0,0,21.38,12h.13a1.37,1.37,0,0,0,1.38-1.54,11,11,0,1,0-12.7,12.39A1.54,1.54,0,0,0,12,21.34h0A1.47,1.47,0,0,0,10.72,19.9Z" class="spinner_6kVp" style="fill: white"/></svg></span>',n.setAttribute("disabled","");var i=new FormData,a={usrequest:{assetName:r.name,mimeType:r.type,fileType:"image"},action:"get",security:imageUploader_state.upload.security,request:imageUploader_state.upload.request};function s(){return s=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(imageUploader_state.upload.uriUploadForm,{method:"POST",body:i});case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}}),e)}))),s.apply(this,arguments)}i.append("usrequest",JSON.stringify(a.usrequest)),i.append("action",a.action),i.append("security",JSON.stringify(a.security)),i.append("request",JSON.stringify(a.request)),function(){return s.apply(this,arguments)}().then((function(e){var t=new FormData;function n(){return(n=_asyncToGenerator(_regeneratorRuntime().mark((function r(){var n;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fetch(e.data.formAttributes.action,{method:"POST",body:t});case 2:return n=r.sent,r.abrupt("return",n);case 4:case"end":return r.stop()}}),r)})))).apply(this,arguments)}t.append("key",e.data.formInputs.key),t.append("Content-Type",e.data.formInputs["Content-Type"]),t.append("X-Amz-Security-Token",e.data.formInputs["X-Amz-Security-Token"]),t.append("X-Amz-Credential",e.data.formInputs["X-Amz-Credential"]),t.append("X-Amz-Algorithm",e.data.formInputs["X-Amz-Algorithm"]),t.append("X-Amz-Date",e.data.formInputs["X-Amz-Date"]),t.append("Policy",e.data.formInputs.Policy),t.append("X-Amz-Signature",e.data.formInputs["X-Amz-Signature"]),t.append("file",r.data),function(){return n.apply(this,arguments)}().then((function(){var t=e.data.assetUrl,r=document.querySelector('[data-authorapi-selector="asset-uploader-source"]');r.value=t.trim(),r.dispatchEvent(new Event("input",{bubbles:!0})),utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"Added image path to URI")),setTimeout((function(){removeUploadButton();var e=document.querySelector(".lrn-author-item .lrn-".concat(imageUploader_state.classNamePrefix,'delete-btn-wrapper [data-authorapi-action="asset-uploader-delete"]')),t=document.querySelector(".lrn-author-item .lrn-".concat(imageUploader_state.classNamePrefix,'image-uploader [data-authorapi-selector="asset-uploader-alignment"]'));if(e&&!t){var r=document.querySelector('[data-authorapi-selector="asset-uploader-okay"]');r&&(r.click(),utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"Clicked OK button for background images")))}prepareModalButtons()}),1500)})).catch((function(e){return console.error("Error in uploading image:",e)}))})).catch((function(e){return console.error("Error in fetching tokens:",e)}))}function listenForSelfHostedImages(){utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"listenForSelfHostedImages()")),setTimeout((function(){var e=document.querySelector('[data-authorapi-selector="asset-uploader-source"]');e&&e.addEventListener("input",handleSelfHostedImage)}),500)}function handleSelfHostedImage(){utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"handleSelfHostedImage()")),setTimeout((function(){prepareModalButtons()}),1500)}function prepareModalButtons(){utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"prepareModalButtons()"));var e=["lrn-".concat(imageUploader_state.classNamePrefix,"modal-button-close"),"lrn-".concat(imageUploader_state.classNamePrefix,"btn-default"),"lrn-".concat(imageUploader_state.classNamePrefix,"btn-primary-legacy"),"lrn-".concat(imageUploader_state.classNamePrefix,"btn-sec")],t=document.querySelector(".lrn-".concat(imageUploader_state.classNamePrefix,"modal"));function r(){utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"clickHandler()")),n(),setTimeout((function(){activateObserver()}),1e3)}function n(){var n,i=imageUploader_createForOfIteratorHelper(e);try{for(i.s();!(n=i.n()).done;){var a=n.value,s=t.querySelector(".lrn-".concat(imageUploader_state.classNamePrefix,"modal-dialog button.").concat(a));s&&(utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"Removed clickHandler")),s.removeEventListener("click",r))}}catch(e){i.e(e)}finally{i.f()}var o=document.querySelector('[data-authorapi-selector="asset-uploader-source"]');o&&o.removeEventListener("input",handleSelfHostedImage)}n(),setTimeout((function(){!function(e,t,r){var n=new MutationObserver((function(e,n){var i,a=imageUploader_createForOfIteratorHelper(e);try{for(a.s();!(i=a.n()).done;)if("childList"===i.value.type){var s=document.querySelector(t);s&&(r(),n.disconnect())}}catch(e){a.e(e)}finally{a.f()}}));n.observe(e,{childList:!0,subtree:!0});var i=document.querySelector(t);i&&(r(),n.disconnect())}(t,".lrn-".concat(imageUploader_state.classNamePrefix,"modal-footer .lrn-").concat(imageUploader_state.classNamePrefix,"delete-btn-wrapper"),(function(){utils_logger.A.debug("".concat(imageUploader_state.logPrefix,"waitForElement() observed"));for(var n=0,i=e;n<i.length;n++){var a=i[n],s=t.querySelector(".lrn-".concat(imageUploader_state.classNamePrefix,"modal-dialog button.").concat(a));s&&(s.addEventListener("click",r),utils_logger.A.debug("Adding clickHanders for: ".concat(a)),utils_logger.A.debug(s))}}))}),100)}function checkUploadFormUri(e){var t=new URLSearchParams(window.location.search),r=window.location.hostname,n=t.get("env");return r.includes("learnosity.com")&&"staging"===n?e.replace("authorapi.","authorapi.staging."):e}function overrideOptions(e){["quality","maxWidth","maxHeight"].forEach((function(t){"number"==typeof(null==e?void 0:e[t])&&(imageUploader_state.options[t]=e[t])}))}function validateRunParams(){return!(!imageUploader_state.upload.security||!imageUploader_state.upload.request||"object"!==imageUploader_typeof(imageUploader_state.upload.security)||"object"!==imageUploader_typeof(imageUploader_state.upload.request))||(utils_logger.A.error("".concat(imageUploader_state.logPrefix,"imageUploader extension failed to run - Missing/invalid security or request parameters")),!1)}function toggleElement(e,t){var r=document.querySelector(".".concat(e));r&&("disable"===t?r.setAttribute("disabled",""):"enable"===t?r.removeAttribute("disabled"):"remove"===t&&r.remove())}function imageUploader_injectCSS(){var e=document.createElement("style");e.textContent="\n/* Learnosity custom image uploader (DAM) */\n/* Used to style content tabs added by via rich-text editor */\n.lrn .lrn-author-ui-no-preview .uppy-c-btn,\n.lrn .lrn-author-ui-no-preview button.uppy-c-btn {\n    color: #fff;\n}\n.lrn .lrn-author-ui-no-preview button.uppy-Dashboard-browse {\n    color: #1269cf;\n}\n.lrn .uppy-Dashboard-inner {\n    margin-bottom: 15px;\n}\n.lrn .lrn-author-ui-no-preview .uppy-Dashboard-Item-actionWrapper button {\n    color: inherit;\n}\n.lrn .uppy-StatusBar.is-waiting .uppy-StatusBar-actionBtn--upload,\n.lrn .uppy-StatusBar.is-waiting .uppy-StatusBar-actionBtn--upload:hover {\n    background-color: #1877b1;\n}\n.lrn .lrn-author-ui-no-preview button.lt__image-uploader-upload-btn {\n    color: #fff;\n    background: #1877b1;\n}\n.lrn .lrn-author-ui-no-preview button.lt__image-uploader-upload-btn[disabled],\n.lrn .lrn-author-ui-no-preview button.lt__image-uploader-upload-btn[disabled]:hover,\n.lrn .lrn-author-ui-no-preview button.lt__image-uploader-upload-btn[disabled]:focus {\n    color: #d9d9d9;\n    border-color: #96b7cb;\n    background: #96b7cb;\n}\n\n.lrn .uppy-Dashboard-input[type=file] {\n    display: none;\n}\n",document.head.append(e),imageUploader_state.renderedCss=!0}var languageTextDirection_state={renderedCss:!1};function languageTextDirection_run(){languageTextDirection_state.renderedCss||languageTextDirection_injectCSS()}function addLanguageAttribute(e,t){var r=getLanguageCodes(),n=LRNCKEDITOR.currentInstance.getSelectedHtml().getHtml(),i=LRNCKEDITOR.currentInstance.getData(),a=getModalTemplate(n);document.querySelector(".learnosity-question-editor").insertAdjacentHTML("beforeend",a);for(var s=document.getElementById("lrn__ltd_language"),o=document.getElementById("lrn__ltd_notranslate"),l=0;l<r.length;l++){var c=void 0;0===l&&((c=document.createElement("option")).value="",c.text="--",s.add(c)),(c=document.createElement("option")).value=r[l].code,c.text=r[l].language,c.setAttribute("data-dir",r[l].direction),s.add(c)}var d=[];d.push(document.querySelector("#ltLanguageModal .lrn-qe-btn-default")),d.push(document.querySelector("#ltLanguageModal .lrn-qe-modal-btn-close"));for(var u=0;u<d.length;u++)d[u].addEventListener("click",(function(){t(n),document.getElementById("ltLanguageModal").remove()}));document.querySelector("#ltLanguageModal .lrn-qe-btn-primary").addEventListener("click",(function(){var e=getLinebreakType(n),r={};document.getElementById("ltLanguageModal").remove(),s.selectedIndex>0&&(r.direction=s.options[s.selectedIndex].getAttribute("data-dir"),r.code=s.options[s.selectedIndex].value),o.checked&&(r.noTranslate=!0);var a=getReturnTemplate(r,e,n,i);return t(a)}))}function getModalTemplate(){return'\n    <div class="lrn-qe lrn-qe-modal lt__languageModal" style="display: block;" id="ltLanguageModal">\n        <div class="lrn-qe-ui">\n            <div class="lrn-qe-modal-dialog">\n                <div class="lrn-qe-modal-dialog-inner">\n                    <div class="lrn-qe-modal-header">\n                        <div class="lrn-qe-form-label lrn-qe-h4 lrn-qe-section-header">\n                            <h4 class="lrn-qe-heading">Language support</h4>\n                        </div>\n                        <button type="button" class="lrn-qe-btn lrn-qe-modal-btn-close" aria-label="Close" tabindex="0">\n                            <span class="lrn-qe-sr-only">Close</span>\n                            <span aria-role="presentation" class="lrn-qe-i-cross"></span>\n                        </button>\n                    </div>\n                    <div data-lrn-qe-selector="modal-outlet">\n                        <div class="lrn-qe-modal-content" data-lrn-qe-modal-section="content">\n                            <div class="lrn-qe-form-group-wrapper">\n                                <div class="lrn-qe-form-group">\n                                    <p><label class="lrn-qe-label lrn-qe-form-label" for="lrn__ltd_language">Choose language</label></p>\n                                    <p>Specify the language for different parts of your content to enable accurate reading by screen\n                                    readers and other accessibility tools.</p>\n                                    <div class="lrn-qe-custom-select">\n                                        <select name="lrn__ltd_language" id="lrn__ltd_language" class="lrn__combobox lrn-qe-select lrn-qe-form-control"></select>\n                                    </div>\n                                </div>\n                                <div class="lrn-qe-form-group lrn-qe-padding-sm lt__border lrn-qe-margin-top-md">\n                                    <p><input id="lrn__ltd_notranslate" type="checkbox" class="lrn-qe-input">\n                                    <label class="lrn-qe-label lrn-qe-form-label lrn-qe-padding-left-xs" for="lrn__ltd_notranslate">Disable translation</label></p>\n                                    <p>Adding this flag will turn off translation, preventing Google Translate and\n                                    Author Aide from translating selected text.</p>\n                                </div>\n                            </div>\n                            <p class="lrn-qe-padding-top-sm"><label class="lrn-qe-label lrn-qe-form-label">Removing these settings</label></p>\n                            <ul>\n                                <li>For words or sentences, highlight the text and use the clear formatting button in the toolbar.</li>\n                                <li>For entire paragraph(s), right click anywhere in the text and choose "Remove Style" from the menu.</li>\n                            </ul>\n                        </div>\n                        <div class="lrn-qe-modal-footer">\n                            <ul class="lrn-qe-ul">\n                                <li class="lrn-qe-li lrn-qe-modal-footer-item lrn-qe-float-left">\n                                    <button type="button" class="lrn-qe-btn lrn-qe-btn-default"><span>Cancel</span></button>\n                                </li>&nbsp;\n                                <li class="lrn-qe-li lrn-qe-modal-footer-item">\n                                    <button type="button" class="lrn-qe-btn lrn-qe-btn-primary" data-lrn-qe-modal-action="confirm"><span>Apply</span></button>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    '}function getReturnTemplate(e,t,r,n){var i="",a="";if(null!=e&&e.code&&(i+=' lang="'.concat(e.code,'" dir="').concat(e.direction,'"')),null!=e&&e.noTranslate&&(i+=' translate="no"'),"block"===t)switch(numParagraphsInString(r)){case 0:a="<p".concat(i,">").concat(r,"</p><p>&nbsp;</p>");break;case 1:a=r.replace("<p","<p".concat(i));break;default:a="<div".concat(i,">").concat(r,"</div>")}else n.replace(/&nbsp;/g,"").includes("<p>".concat(r.replace(/&nbsp;/g,""),"</p>"))?a="<div".concat(i,"><p>").concat(r,"</p></div>"):r.length&&(a="<span".concat(i,">").concat(r,"</span>"));return a}function getLanguageCodes(){return[{language:"Afrikaans",code:"af",direction:"ltr"},{language:"Albanian",code:"sq",direction:"ltr"},{language:"Amharic",code:"am",direction:"ltr"},{language:"Arabic",code:"ar",direction:"rtl"},{language:"Armenian",code:"hy",direction:"ltr"},{language:"Azerbaijani",code:"az",direction:"ltr"},{language:"Basque",code:"eu",direction:"ltr"},{language:"Belarusian",code:"be",direction:"ltr"},{language:"Bengali",code:"bn",direction:"ltr"},{language:"Bosnian",code:"bs",direction:"ltr"},{language:"Bulgarian",code:"bg",direction:"ltr"},{language:"Catalan",code:"ca",direction:"ltr"},{language:"Cebuano",code:"ceb",direction:"ltr"},{language:"Chichewa",code:"ny",direction:"ltr"},{language:"Chinese (Simplified)",code:"zh-Hans",direction:"ltr"},{language:"Chinese (Traditional)",code:"zh-Hant",direction:"ltr"},{language:"Corsican",code:"co",direction:"ltr"},{language:"Haitian Creole",code:"ht",direction:"ltr"},{language:"Croatian",code:"hr",direction:"ltr"},{language:"Czech",code:"cs",direction:"ltr"},{language:"Danish",code:"da",direction:"ltr"},{language:"Dutch",code:"nl",direction:"ltr"},{language:"English",code:"en",direction:"ltr"},{language:"Esperanto",code:"eo",direction:"ltr"},{language:"Estonian",code:"et",direction:"ltr"},{language:"Finnish",code:"fi",direction:"ltr"},{language:"French",code:"fr",direction:"ltr"},{language:"Frisian",code:"fy",direction:"ltr"},{language:"Galician",code:"gl",direction:"ltr"},{language:"Georgian",code:"ka",direction:"ltr"},{language:"German",code:"de",direction:"ltr"},{language:"Greek",code:"el",direction:"ltr"},{language:"Gujarati",code:"gu",direction:"ltr"},{language:"Hausa",code:"ha",direction:"ltr"},{language:"Hawaiian",code:"haw",direction:"ltr"},{language:"Hebrew",code:"he",direction:"rtl"},{language:"Hindi",code:"hi",direction:"ltr"},{language:"Hmong",code:"hmn",direction:"ltr"},{language:"Hungarian",code:"hu",direction:"ltr"},{language:"Icelandic",code:"is",direction:"ltr"},{language:"Igbo",code:"ig",direction:"ltr"},{language:"Indonesian",code:"id",direction:"ltr"},{language:"Irish",code:"ga",direction:"ltr"},{language:"Italian",code:"it",direction:"ltr"},{language:"Japanese",code:"ja",direction:"ltr"},{language:"Javanese",code:"jv",direction:"ltr"},{language:"Kannada",code:"kn",direction:"ltr"},{language:"Kazakh",code:"kk",direction:"ltr"},{language:"Khmer",code:"km",direction:"ltr"},{language:"Kinyarwanda",code:"rw",direction:"ltr"},{language:"Korean",code:"ko",direction:"ltr"},{language:"Kurdish (Kurmanji)",code:"ku",direction:"ltr"},{language:"Kyrgyz",code:"ky",direction:"ltr"},{language:"Lao",code:"lo",direction:"ltr"},{language:"Latin",code:"la",direction:"ltr"},{language:"Latvian",code:"lv",direction:"ltr"},{language:"Lithuanian",code:"lt",direction:"ltr"},{language:"Luxembourgish",code:"lb",direction:"ltr"},{language:"Macedonian",code:"mk",direction:"ltr"},{language:"Malagasy",code:"mg",direction:"ltr"},{language:"Malay",code:"ms",direction:"ltr"},{language:"Malayalam",code:"ml",direction:"ltr"},{language:"Maltese",code:"mt",direction:"ltr"},{language:"Maori",code:"mi",direction:"ltr"},{language:"Marathi",code:"mr",direction:"ltr"},{language:"Mongolian",code:"mn",direction:"ltr"},{language:"Myanmar (Burmese)",code:"my",direction:"ltr"},{language:"Nepali",code:"ne",direction:"ltr"},{language:"Norwegian",code:"no",direction:"ltr"},{language:"Odia",code:"or",direction:"ltr"},{language:"Pashto",code:"ps",direction:"rtl"},{language:"Persian",code:"fa",direction:"rtl"},{language:"Polish",code:"pl",direction:"ltr"},{language:"Portuguese",code:"pt",direction:"ltr"},{language:"Punjabi",code:"pa",direction:"ltr"},{language:"Romanian",code:"ro",direction:"ltr"},{language:"Russian",code:"ru",direction:"ltr"},{language:"Samoan",code:"sm",direction:"ltr"},{language:"Scots Gaelic",code:"gd",direction:"ltr"},{language:"Serbian Cyrilic",code:"sr-Cyrl",direction:"ltr"},{language:"Sesotho",code:"st",direction:"ltr"},{language:"Shona",code:"sn",direction:"ltr"},{language:"Sindhi",code:"sd",direction:"rtl"},{language:"Sinhala",code:"si",direction:"ltr"},{language:"Slovak",code:"sk",direction:"ltr"},{language:"Slovenian",code:"sl",direction:"ltr"},{language:"Somali",code:"so",direction:"ltr"},{language:"Spanish",code:"es",direction:"ltr"},{language:"Sundanese",code:"su",direction:"ltr"},{language:"Swahili",code:"sw",direction:"ltr"},{language:"Swedish",code:"sv",direction:"ltr"},{language:"Filipino (Tagalog)",code:"tl",direction:"ltr"},{language:"Tajik",code:"tg",direction:"ltr"},{language:"Tamil",code:"ta",direction:"ltr"},{language:"Tatar",code:"tt",direction:"ltr"},{language:"Telugu",code:"te",direction:"ltr"},{language:"Thai",code:"th",direction:"ltr"},{language:"Turkish",code:"tr",direction:"ltr"},{language:"Turkmen",code:"tk",direction:"ltr"},{language:"Ukrainian",code:"uk",direction:"ltr"},{language:"Urdu",code:"ur",direction:"rtl"},{language:"Uyghur",code:"ug",direction:"rtl"},{language:"Uzbek",code:"uz",direction:"ltr"},{language:"Vietnamese",code:"vi",direction:"ltr"},{language:"Welsh",code:"cy",direction:"ltr"},{language:"Xhosa",code:"xh",direction:"ltr"},{language:"Yiddish",code:"yi",direction:"rtl"},{language:"Yoruba",code:"yo",direction:"ltr"},{language:"Zulu",code:"zu",direction:"ltr"}]}function numParagraphsInString(e){var t=e.match(/<p>[^]*?<\/p>/g);return t?t.length:0}function getLinebreakType(e){return numParagraphsInString(e)<=1?"inline":"block"}function languageTextDirection_injectCSS(){var e=document.createElement("style");e.textContent='\n/* Learnosity language and no translation styles */\n/* Used to see elements inside the rich-text editor that have language or translate styles applied */\n.lrn.lrn-author .lt__languageModal {\n    h4 {\n        font-size: 1.43em;\n    }\n\n    label {\n        font-weight: bold;\n    }\n\n    input[type="checkbox"] {\n        height: 16px;\n        width: 16px;\n        vertical-align: text-bottom;\n        margin: 0;\n    }\n\n    .lt__border {\n        border: 1px solid #eaeaea;\n    }\n}\n\n.lrn-qe-form-group-wrapper {\n    .lrn-qe-form-control-ckeditor *[translate],\n    .lrn-qe-form-control-ckeditor *[lang] {\n        border: 2px dashed #696969;\n        padding: 5px;\n        position: relative;\n    }\n\n    .lrn-qe .lrn-qe-ui div[translate],\n    .lrn-qe .lrn-qe-ui div[lang] {\n        margin-bottom: 1em;\n\n        p:last-child {\n            margin-bottom: 0;\n        }\n    }\n\n    .lrn-qe-form-control-ckeditor *[translate]::after,\n    .lrn-qe-form-control-ckeditor *[lang]::after {\n        content: "No translate";\n        position: absolute;\n        left: 100px;\n        top: 0;\n        transform: translateX(-50%);\n        background-color: #333;\n        color: #fff;\n        padding: 5px;\n        border-radius: 4px;\n        white-space: nowrap;\n        opacity: 0;\n        visibility: hidden;\n        transition: opacity 0.3s;\n        z-index: 10000000;\n    }\n\n    .lrn-qe-form-control-ckeditor *[lang]::after {\n        content: "Language";\n    }\n\n    .lrn-qe-form-control-ckeditor *[translate][lang]::after {\n        content: "No translate and Language";\n    }\n\n    /* Show tooltip on hover */\n    .lrn-qe-form-control-ckeditor *[translate]:hover::after,\n    .lrn-qe-form-control-ckeditor *[lang]:hover::after {\n        opacity: 1;\n        visibility: visible;\n    }\n\n    /* Force the icon to be the right size */\n    .lrn-qe-ckeditor-toolbar .cke_button__addlanguageattribute .cke_button__addlanguageattribute_icon {\n        background-position: -3px !important;\n        background-size: 22px !important;\n    }\n\n    /* Size the "content" textarea and make is resizable */\n    .lrn-qe .lrn-qe-modal-content .lrn-qe-form-group-wrapper textarea#lrn__ltd_content {\n        resize: vertical;\n        min-height: 4em;\n    }\n}\n',document.head.append(e),languageTextDirection_state.renderedCss=!0}var nativeTabs_state={columns:{numTabsLeft:2,numTabsRight:2},logPrefix:"LT Dynamic Content: ",renderedCss:!1};function nativeTabs_run(){nativeTabs_state.renderedCss||nativeTabs_injectCSS(),core_app.appInstance().on("navigate",(function(){setTimeout((function(){if(["items/:reference/settings/:tab","items/:reference/settings",void 0].includes(core_app.appInstance().getLocation().route)){var e=core_app.appInstance().getLocation().location.split("/").pop();["layout","settings"].includes(e)&&nativeTabs_setup()}}),2050)})),core_app.appInstance().on("itemsettings:applied",saveTabsToItem)}function nativeTabs_setup(){var e=document.querySelector('[data-authorapi-selector="lrn-author-tabs-col1"]'),t=document.querySelector('[data-authorapi-selector="lrn-author-tabs-col2"]'),r=document.getElementById("lt__nativeTabs-1"),n=document.getElementById("lt__nativeTabs-2"),i=document.querySelector('[data-authorapi-selector="lrn-author-apply-settings"]');function a(e){return'\n            <label class="lrn-author-checkbox-label" for="lt__nativeTabs-'.concat(e,'">Number of tabs</label>\n            <div class="lrn-form-group">\n                <input id="lt__nativeTabs-').concat(e,'" type="number" min="2" max="5" value="2" class="lrn-form-control lt__width-sm">\n            </div>\n        ')}i?(!r&&e&&e.querySelector(".lrn-author-layout-content").insertAdjacentHTML("beforeend",a(1)),!n&&t&&t.querySelector(".lrn-author-layout-content").insertAdjacentHTML("beforeend",a(2)),setNumColumnsState(),i.addEventListener("click",saveTabsToItem)):utils_logger.A.warn("".concat(nativeTabs_state.logPrefix,"Settings apply button not found"))}function saveTabsToItem(){var e=core_app.appInstance().getItem();nativeTabs_state.columns.numTabsLeft>2&&setTimeout((function(){e.item.definition={regions:{regions:{regions:[{label:"Tab 1",type:"tab"},{label:"Tab 2",type:"tab"},{label:"Tab 3",type:"tab"}]}}}}),500)}function setNumColumnsState(){var e=document.getElementById("lt__nativeTabs-1"),t=document.getElementById("lt__nativeTabs-2");e.addEventListener("change",(function(){nativeTabs_state.columns.numTabsLeft=e.value})),t.addEventListener("change",(function(){nativeTabs_state.columns.numTabsRight=t.value}))}function nativeTabs_injectCSS(){var e=document.createElement("style");e.textContent="\n/* Learnosity native tab styles */\n.lrn .lrn-author-ui,\n.lrn.lrn-author {\n    .lrn-author-api-react-container .lrn-author-item-settings .lrn-author-layout-settings .lrn-author-layout-tab .lrn-author-layout-content,\n    .lrn-author-api-react-container .lrn-author-activity-labels .lrn-author-layout-settings .lrn-author-layout-tab .lrn-author-layout-content {\n        padding: 9px;\n    }\n\n    .lrn-form-control.lt__width-sm {\n        width: 100px;\n    }\n\n    .lrn-author-checkbox-label {\n        padding-bottom: .5714285714em;\n    }\n}\n",document.head.append(e),nativeTabs_state.renderedCss=!0}var renderPDF_state={renderedCss:!1};function renderPDF_run(){renderPDF_state.renderedCss||renderPDF_injectCSS(),core_app.appInstance().on("widgetedit:widget:ready",(function(){document.querySelectorAll(".cke_button__lrnresource").forEach((function(e){utils_logger.A.debug("Found resource button in editor"),e.addEventListener("click",(function(){addRenderOption()}))}))}))}function addRenderOption(){var e=document.querySelector(".lrn-adv-options-group"),t=renderPDF_generateRandomString(),r='<div class="lrn-row">\n        <div class="lrn-col-xs-12">\n            <label for="lt__renderPDF-Id_'.concat(t,'" class="lrn-author-asset-upload lrn-form-label-name">\n                <span class="lrn-author-asset-upload lrn-form-label-name">Render PDF inline?</span>\n            </label>\n            <div class="lrn-form-control-wrapper">\n                <input id="lt__renderPDF-Id_').concat(t,'" name="renderPDF" value="true" type="checkbox" class="lrn-form-control lt__renderPDFOption">\n            </div>\n        </div>\n    </div>');e&&e.insertAdjacentHTML("beforeend",r)}function renderPDF_generateRandomString(){return Math.floor(Math.random()*Date.now()).toString(36)}function renderPDF_injectCSS(){var e=document.createElement("style");e.textContent="\n/* Learnosity language text direction styles */\n/* Used to style render PDF options added to the resource upload panel */\n.lrn .lrn-author-ui .lrn-form-control.lt__renderPDFOption {\n    width: auto;\n}\n",document.head.append(e),renderPDF_state.renderedCss=!0}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||singleQuestion_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function singleQuestion_unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return singleQuestion_arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?singleQuestion_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return singleQuestion_arrayLikeToArray(e)}function singleQuestion_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var singleQuestion_state={classNamePrefix:null,elements:{}};function singleQuestion_run(){cacheElements(),core_app.appInstance().on("render:item",checkQuestions),core_app.appInstance().on("render:widgets",checkQuestions),core_app.appInstance().on("itemedit:changed",checkQuestions)}function checkQuestions(){singleQuestion_state.classNamePrefix=checkAppVersion(singleQuestion_state.classNamePrefix),core_app.appInstance().getItem().questions.length?hideAddButton():showAddButton()}function hideAddButton(){var e=singleQuestion_state.elements.apiWrapper.querySelectorAll('[data-authorapi-selector="add-button"]'),t=singleQuestion_state.elements.apiWrapper.querySelectorAll(".lrn-author-ui-add-extras"),r=[].concat(_toConsumableArray(e),_toConsumableArray(t));r&&r.forEach((function(e){e.classList.add("lrn-".concat(singleQuestion_state.classNamePrefix,"hide"))}))}function showAddButton(){var e=singleQuestion_state.elements.apiWrapper.querySelectorAll('[data-authorapi-selector="add-button"]'),t=singleQuestion_state.elements.apiWrapper.querySelectorAll(".lrn-author-ui-add-extras"),r=[].concat(_toConsumableArray(e),_toConsumableArray(t));r&&r.forEach((function(e){e.classList.remove("lrn-".concat(singleQuestion_state.classNamePrefix,"hide"))}))}function cacheElements(){singleQuestion_state.elements.apiWrapper=document.querySelector(".lrn-author")}function listCacheClear(){this.__data__=[],this.size=0}const _listCacheClear=listCacheClear;function eq(e,t){return e===t||e!=e&&t!=t}const lodash_es_eq=eq;function assocIndexOf(e,t){for(var r=e.length;r--;)if(lodash_es_eq(e[r][0],t))return r;return-1}const _assocIndexOf=assocIndexOf;var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(e){var t=this.__data__,r=_assocIndexOf(t,e);return!(r<0||(r==t.length-1?t.pop():splice.call(t,r,1),--this.size,0))}const _listCacheDelete=listCacheDelete;function listCacheGet(e){var t=this.__data__,r=_assocIndexOf(t,e);return r<0?void 0:t[r][1]}const _listCacheGet=listCacheGet;function listCacheHas(e){return _assocIndexOf(this.__data__,e)>-1}const _listCacheHas=listCacheHas;function listCacheSet(e,t){var r=this.__data__,n=_assocIndexOf(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}const _listCacheSet=listCacheSet;function ListCache(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ListCache.prototype.clear=_listCacheClear,ListCache.prototype.delete=_listCacheDelete,ListCache.prototype.get=_listCacheGet,ListCache.prototype.has=_listCacheHas,ListCache.prototype.set=_listCacheSet;const _ListCache=ListCache;function stackClear(){this.__data__=new _ListCache,this.size=0}const _stackClear=stackClear;function stackDelete(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}const _stackDelete=stackDelete;function stackGet(e){return this.__data__.get(e)}const _stackGet=stackGet;function stackHas(e){return this.__data__.has(e)}const _stackHas=stackHas;var asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(e){if(!lodash_es_isObject(e))return!1;var t=_baseGetTag(e);return t==funcTag||t==genTag||t==asyncTag||t==proxyTag}const lodash_es_isFunction=isFunction;var coreJsData=_root["__core-js_shared__"];const _coreJsData=coreJsData;var maskSrcKey=(uid=/[^.]+$/.exec(_coreJsData&&_coreJsData.keys&&_coreJsData.keys.IE_PROTO||""),uid?"Symbol(src)_1."+uid:""),uid;function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}const _isMasked=isMasked;var funcProto=Function.prototype,funcToString=funcProto.toString;function toSource(e){if(null!=e){try{return funcToString.call(e)}catch(e){}try{return e+""}catch(e){}}return""}const _toSource=toSource;var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,_baseIsNative_funcProto=Function.prototype,_baseIsNative_objectProto=Object.prototype,_baseIsNative_funcToString=_baseIsNative_funcProto.toString,_baseIsNative_hasOwnProperty=_baseIsNative_objectProto.hasOwnProperty,reIsNative=RegExp("^"+_baseIsNative_funcToString.call(_baseIsNative_hasOwnProperty).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){return!(!lodash_es_isObject(e)||_isMasked(e))&&(lodash_es_isFunction(e)?reIsNative:reIsHostCtor).test(_toSource(e))}const _baseIsNative=baseIsNative;function getValue(e,t){return null==e?void 0:e[t]}const _getValue=getValue;function getNative(e,t){var r=_getValue(e,t);return _baseIsNative(r)?r:void 0}const _getNative=getNative;var _Map_Map=_getNative(_root,"Map");const _Map=_Map_Map;var nativeCreate=_getNative(Object,"create");const _nativeCreate=nativeCreate;function hashClear(){this.__data__=_nativeCreate?_nativeCreate(null):{},this.size=0}const _hashClear=hashClear;function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}const _hashDelete=hashDelete;var HASH_UNDEFINED="__lodash_hash_undefined__",_hashGet_objectProto=Object.prototype,_hashGet_hasOwnProperty=_hashGet_objectProto.hasOwnProperty;function hashGet(e){var t=this.__data__;if(_nativeCreate){var r=t[e];return r===HASH_UNDEFINED?void 0:r}return _hashGet_hasOwnProperty.call(t,e)?t[e]:void 0}const _hashGet=hashGet;var _hashHas_objectProto=Object.prototype,_hashHas_hasOwnProperty=_hashHas_objectProto.hasOwnProperty;function hashHas(e){var t=this.__data__;return _nativeCreate?void 0!==t[e]:_hashHas_hasOwnProperty.call(t,e)}const _hashHas=hashHas;var _hashSet_HASH_UNDEFINED="__lodash_hash_undefined__";function hashSet(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=_nativeCreate&&void 0===t?_hashSet_HASH_UNDEFINED:t,this}const _hashSet=hashSet;function Hash(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Hash.prototype.clear=_hashClear,Hash.prototype.delete=_hashDelete,Hash.prototype.get=_hashGet,Hash.prototype.has=_hashHas,Hash.prototype.set=_hashSet;const _Hash=Hash;function mapCacheClear(){this.size=0,this.__data__={hash:new _Hash,map:new(_Map||_ListCache),string:new _Hash}}const _mapCacheClear=mapCacheClear;function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}const _isKeyable=isKeyable;function getMapData(e,t){var r=e.__data__;return _isKeyable(t)?r["string"==typeof t?"string":"hash"]:r.map}const _getMapData=getMapData;function mapCacheDelete(e){var t=_getMapData(this,e).delete(e);return this.size-=t?1:0,t}const _mapCacheDelete=mapCacheDelete;function mapCacheGet(e){return _getMapData(this,e).get(e)}const _mapCacheGet=mapCacheGet;function mapCacheHas(e){return _getMapData(this,e).has(e)}const _mapCacheHas=mapCacheHas;function mapCacheSet(e,t){var r=_getMapData(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}const _mapCacheSet=mapCacheSet;function MapCache(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}MapCache.prototype.clear=_mapCacheClear,MapCache.prototype.delete=_mapCacheDelete,MapCache.prototype.get=_mapCacheGet,MapCache.prototype.has=_mapCacheHas,MapCache.prototype.set=_mapCacheSet;const _MapCache=MapCache;var LARGE_ARRAY_SIZE=200;function stackSet(e,t){var r=this.__data__;if(r instanceof _ListCache){var n=r.__data__;if(!_Map||n.length<LARGE_ARRAY_SIZE-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new _MapCache(n)}return r.set(e,t),this.size=r.size,this}const _stackSet=stackSet;function Stack(e){var t=this.__data__=new _ListCache(e);this.size=t.size}Stack.prototype.clear=_stackClear,Stack.prototype.delete=_stackDelete,Stack.prototype.get=_stackGet,Stack.prototype.has=_stackHas,Stack.prototype.set=_stackSet;const _Stack=Stack;var defineProperty=function(){try{var e=_getNative(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();const lodash_es_defineProperty=defineProperty;function baseAssignValue(e,t,r){"__proto__"==t&&lodash_es_defineProperty?lodash_es_defineProperty(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}const _baseAssignValue=baseAssignValue;function assignMergeValue(e,t,r){(void 0!==r&&!lodash_es_eq(e[t],r)||void 0===r&&!(t in e))&&_baseAssignValue(e,t,r)}const _assignMergeValue=assignMergeValue;function createBaseFor(e){return function(t,r,n){for(var i=-1,a=Object(t),s=n(t),o=s.length;o--;){var l=s[e?o:++i];if(!1===r(a[l],l,a))break}return t}}const _createBaseFor=createBaseFor;var baseFor=_createBaseFor();const _baseFor=baseFor;var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,_cloneBuffer_Buffer=moduleExports?_root.Buffer:void 0,allocUnsafe=_cloneBuffer_Buffer?_cloneBuffer_Buffer.allocUnsafe:void 0;function cloneBuffer(e,t){if(t)return e.slice();var r=e.length,n=allocUnsafe?allocUnsafe(r):new e.constructor(r);return e.copy(n),n}const _cloneBuffer=cloneBuffer;var _Uint8Array_Uint8Array=_root.Uint8Array;const _Uint8Array=_Uint8Array_Uint8Array;function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);return new _Uint8Array(t).set(new _Uint8Array(e)),t}const _cloneArrayBuffer=cloneArrayBuffer;function cloneTypedArray(e,t){var r=t?_cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}const _cloneTypedArray=cloneTypedArray;function copyArray(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}const _copyArray=copyArray;var objectCreate=Object.create,baseCreate=function(){function e(){}return function(t){if(!lodash_es_isObject(t))return{};if(objectCreate)return objectCreate(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();const _baseCreate=baseCreate;function overArg(e,t){return function(r){return e(t(r))}}const _overArg=overArg;var getPrototype=_overArg(Object.getPrototypeOf,Object);const _getPrototype=getPrototype;var _isPrototype_objectProto=Object.prototype;function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||_isPrototype_objectProto)}const _isPrototype=isPrototype;function initCloneObject(e){return"function"!=typeof e.constructor||_isPrototype(e)?{}:_baseCreate(_getPrototype(e))}const _initCloneObject=initCloneObject;var argsTag="[object Arguments]";function baseIsArguments(e){return lodash_es_isObjectLike(e)&&_baseGetTag(e)==argsTag}const _baseIsArguments=baseIsArguments;var isArguments_objectProto=Object.prototype,isArguments_hasOwnProperty=isArguments_objectProto.hasOwnProperty,propertyIsEnumerable=isArguments_objectProto.propertyIsEnumerable,isArguments=_baseIsArguments(function(){return arguments}())?_baseIsArguments:function(e){return lodash_es_isObjectLike(e)&&isArguments_hasOwnProperty.call(e,"callee")&&!propertyIsEnumerable.call(e,"callee")};const lodash_es_isArguments=isArguments;var isArray=Array.isArray;const lodash_es_isArray=isArray;var MAX_SAFE_INTEGER=9007199254740991;function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=MAX_SAFE_INTEGER}const lodash_es_isLength=isLength;function isArrayLike(e){return null!=e&&lodash_es_isLength(e.length)&&!lodash_es_isFunction(e)}const lodash_es_isArrayLike=isArrayLike;function isArrayLikeObject(e){return lodash_es_isObjectLike(e)&&lodash_es_isArrayLike(e)}const lodash_es_isArrayLikeObject=isArrayLikeObject;function stubFalse(){return!1}const lodash_es_stubFalse=stubFalse;var isBuffer_freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,isBuffer_freeModule=isBuffer_freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,isBuffer_moduleExports=isBuffer_freeModule&&isBuffer_freeModule.exports===isBuffer_freeExports,isBuffer_Buffer=isBuffer_moduleExports?_root.Buffer:void 0,nativeIsBuffer=isBuffer_Buffer?isBuffer_Buffer.isBuffer:void 0,isBuffer=nativeIsBuffer||lodash_es_stubFalse;const lodash_es_isBuffer=isBuffer;var objectTag="[object Object]",isPlainObject_funcProto=Function.prototype,isPlainObject_objectProto=Object.prototype,isPlainObject_funcToString=isPlainObject_funcProto.toString,isPlainObject_hasOwnProperty=isPlainObject_objectProto.hasOwnProperty,objectCtorString=isPlainObject_funcToString.call(Object);function isPlainObject(e){if(!lodash_es_isObjectLike(e)||_baseGetTag(e)!=objectTag)return!1;var t=_getPrototype(e);if(null===t)return!0;var r=isPlainObject_hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&isPlainObject_funcToString.call(r)==objectCtorString}const lodash_es_isPlainObject=isPlainObject;var _baseIsTypedArray_argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",_baseIsTypedArray_funcTag="[object Function]",mapTag="[object Map]",numberTag="[object Number]",_baseIsTypedArray_objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray(e){return lodash_es_isObjectLike(e)&&lodash_es_isLength(e.length)&&!!typedArrayTags[_baseGetTag(e)]}typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[_baseIsTypedArray_argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[_baseIsTypedArray_funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[_baseIsTypedArray_objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;const _baseIsTypedArray=baseIsTypedArray;function baseUnary(e){return function(t){return e(t)}}const _baseUnary=baseUnary;var _nodeUtil_freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,_nodeUtil_freeModule=_nodeUtil_freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,_nodeUtil_moduleExports=_nodeUtil_freeModule&&_nodeUtil_freeModule.exports===_nodeUtil_freeExports,freeProcess=_nodeUtil_moduleExports&&_freeGlobal.process,nodeUtil=function(){try{return _nodeUtil_freeModule&&_nodeUtil_freeModule.require&&_nodeUtil_freeModule.require("util").types||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}();const _nodeUtil=nodeUtil;var nodeIsTypedArray=_nodeUtil&&_nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?_baseUnary(nodeIsTypedArray):_baseIsTypedArray;const lodash_es_isTypedArray=isTypedArray;function safeGet(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}const _safeGet=safeGet;var _assignValue_objectProto=Object.prototype,_assignValue_hasOwnProperty=_assignValue_objectProto.hasOwnProperty;function assignValue(e,t,r){var n=e[t];_assignValue_hasOwnProperty.call(e,t)&&lodash_es_eq(n,r)&&(void 0!==r||t in e)||_baseAssignValue(e,t,r)}const _assignValue=assignValue;function copyObject(e,t,r,n){var i=!r;r||(r={});for(var a=-1,s=t.length;++a<s;){var o=t[a],l=n?n(r[o],e[o],o,r,e):void 0;void 0===l&&(l=e[o]),i?_baseAssignValue(r,o,l):_assignValue(r,o,l)}return r}const _copyObject=copyObject;function baseTimes(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}const _baseTimes=baseTimes;var _isIndex_MAX_SAFE_INTEGER=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var r=typeof e;return!!(t=null==t?_isIndex_MAX_SAFE_INTEGER:t)&&("number"==r||"symbol"!=r&&reIsUint.test(e))&&e>-1&&e%1==0&&e<t}const _isIndex=isIndex;var _arrayLikeKeys_objectProto=Object.prototype,_arrayLikeKeys_hasOwnProperty=_arrayLikeKeys_objectProto.hasOwnProperty;function arrayLikeKeys(e,t){var r=lodash_es_isArray(e),n=!r&&lodash_es_isArguments(e),i=!r&&!n&&lodash_es_isBuffer(e),a=!r&&!n&&!i&&lodash_es_isTypedArray(e),s=r||n||i||a,o=s?_baseTimes(e.length,String):[],l=o.length;for(var c in e)!t&&!_arrayLikeKeys_hasOwnProperty.call(e,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||_isIndex(c,l))||o.push(c);return o}const _arrayLikeKeys=arrayLikeKeys;function nativeKeysIn(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}const _nativeKeysIn=nativeKeysIn;var _baseKeysIn_objectProto=Object.prototype,_baseKeysIn_hasOwnProperty=_baseKeysIn_objectProto.hasOwnProperty;function baseKeysIn(e){if(!lodash_es_isObject(e))return _nativeKeysIn(e);var t=_isPrototype(e),r=[];for(var n in e)("constructor"!=n||!t&&_baseKeysIn_hasOwnProperty.call(e,n))&&r.push(n);return r}const _baseKeysIn=baseKeysIn;function keysIn(e){return lodash_es_isArrayLike(e)?_arrayLikeKeys(e,!0):_baseKeysIn(e)}const lodash_es_keysIn=keysIn;function toPlainObject(e){return _copyObject(e,lodash_es_keysIn(e))}const lodash_es_toPlainObject=toPlainObject;function baseMergeDeep(e,t,r,n,i,a,s){var o=_safeGet(e,r),l=_safeGet(t,r),c=s.get(l);if(c)_assignMergeValue(e,r,c);else{var d=a?a(o,l,r+"",e,t,s):void 0,u=void 0===d;if(u){var p=lodash_es_isArray(l),h=!p&&lodash_es_isBuffer(l),f=!p&&!h&&lodash_es_isTypedArray(l);d=l,p||h||f?lodash_es_isArray(o)?d=o:lodash_es_isArrayLikeObject(o)?d=_copyArray(o):h?(u=!1,d=_cloneBuffer(l,!0)):f?(u=!1,d=_cloneTypedArray(l,!0)):d=[]:lodash_es_isPlainObject(l)||lodash_es_isArguments(l)?(d=o,lodash_es_isArguments(o)?d=lodash_es_toPlainObject(o):lodash_es_isObject(o)&&!lodash_es_isFunction(o)||(d=_initCloneObject(l))):u=!1}u&&(s.set(l,d),i(d,l,n,a,s),s.delete(l)),_assignMergeValue(e,r,d)}}const _baseMergeDeep=baseMergeDeep;function baseMerge(e,t,r,n,i){e!==t&&_baseFor(t,(function(a,s){if(i||(i=new _Stack),lodash_es_isObject(a))_baseMergeDeep(e,t,s,r,baseMerge,n,i);else{var o=n?n(_safeGet(e,s),a,s+"",e,t,i):void 0;void 0===o&&(o=a),_assignMergeValue(e,s,o)}}),lodash_es_keysIn)}const _baseMerge=baseMerge;function identity_identity(e){return e}const lodash_es_identity=identity_identity;function apply(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}const lodash_es_apply=apply;var _overRest_nativeMax=Math.max;function overRest(e,t,r){return t=_overRest_nativeMax(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,a=_overRest_nativeMax(n.length-t,0),s=Array(a);++i<a;)s[i]=n[t+i];i=-1;for(var o=Array(t+1);++i<t;)o[i]=n[i];return o[t]=r(s),lodash_es_apply(e,this,o)}}const _overRest=overRest;function constant(e){return function(){return e}}const lodash_es_constant=constant;var baseSetToString=lodash_es_defineProperty?function(e,t){return lodash_es_defineProperty(e,"toString",{configurable:!0,enumerable:!1,value:lodash_es_constant(t),writable:!0})}:lodash_es_identity;const _baseSetToString=baseSetToString;var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(e){var t=0,r=0;return function(){var n=nativeNow(),i=HOT_SPAN-(n-r);if(r=n,i>0){if(++t>=HOT_COUNT)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}const _shortOut=shortOut;var setToString=_shortOut(_baseSetToString);const _setToString=setToString;function baseRest(e,t){return _setToString(_overRest(e,t,lodash_es_identity),e+"")}const _baseRest=baseRest;function isIterateeCall(e,t,r){if(!lodash_es_isObject(r))return!1;var n=typeof t;return!!("number"==n?lodash_es_isArrayLike(r)&&_isIndex(t,r.length):"string"==n&&t in r)&&lodash_es_eq(r[t],e)}const _isIterateeCall=isIterateeCall;function createAssigner(e){return _baseRest((function(t,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,s&&_isIterateeCall(r[0],r[1],s)&&(a=i<3?void 0:a,i=1),t=Object(t);++n<i;){var o=r[n];o&&e(t,o,n,a)}return t}))}const _createAssigner=createAssigner;var merge=_createAssigner((function(e,t,r){_baseMerge(e,t,r)}));const lodash_es_merge=merge;var Scope=(e=>(e[e.TYPE=3]="TYPE",e[e.LEVEL=12]="LEVEL",e[e.ATTRIBUTE=13]="ATTRIBUTE",e[e.BLOT=14]="BLOT",e[e.INLINE=7]="INLINE",e[e.BLOCK=11]="BLOCK",e[e.BLOCK_BLOT=10]="BLOCK_BLOT",e[e.INLINE_BLOT=6]="INLINE_BLOT",e[e.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",e[e.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",e[e.ANY=15]="ANY",e))(Scope||{});class Attributor{constructor(e,t,r={}){this.attrName=e,this.keyName=t;const n=Scope.TYPE&Scope.ATTRIBUTE;this.scope=null!=r.scope?r.scope&Scope.LEVEL|n:Scope.ATTRIBUTE,null!=r.whitelist&&(this.whitelist=r.whitelist)}static keys(e){return Array.from(e.attributes).map((e=>e.name))}add(e,t){return!!this.canAdd(e,t)&&(e.setAttribute(this.keyName,t),!0)}canAdd(e,t){return null==this.whitelist||("string"==typeof t?this.whitelist.indexOf(t.replace(/["']/g,""))>-1:this.whitelist.indexOf(t)>-1)}remove(e){e.removeAttribute(this.keyName)}value(e){const t=e.getAttribute(this.keyName);return this.canAdd(e,t)&&t?t:""}}class ParchmentError extends Error{constructor(e){super(e="[Parchment] "+e),this.message=e,this.name=this.constructor.name}}const _Registry=class e{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(e,t=!1){if(null==e)return null;if(this.blots.has(e))return this.blots.get(e)||null;if(t){let r=null;try{r=e.parentNode}catch{return null}return this.find(r,t)}return null}create(t,r,n){const i=this.query(r);if(null==i)throw new ParchmentError(`Unable to create ${r} blot`);const a=i,s=r instanceof Node||r.nodeType===Node.TEXT_NODE?r:a.create(n),o=new a(t,s,n);return e.blots.set(o.domNode,o),o}find(t,r=!1){return e.find(t,r)}query(e,t=Scope.ANY){let r;return"string"==typeof e?r=this.types[e]||this.attributes[e]:e instanceof Text||e.nodeType===Node.TEXT_NODE?r=this.types.text:"number"==typeof e?e&Scope.LEVEL&Scope.BLOCK?r=this.types.block:e&Scope.LEVEL&Scope.INLINE&&(r=this.types.inline):e instanceof Element&&((e.getAttribute("class")||"").split(/\s+/).some((e=>(r=this.classes[e],!!r))),r=r||this.tags[e.tagName]),null==r?null:"scope"in r&&t&Scope.LEVEL&r.scope&&t&Scope.TYPE&r.scope?r:null}register(...e){return e.map((e=>{const t="blotName"in e,r="attrName"in e;if(!t&&!r)throw new ParchmentError("Invalid definition");if(t&&"abstract"===e.blotName)throw new ParchmentError("Cannot register abstract class");const n=t?e.blotName:r?e.attrName:void 0;return this.types[n]=e,r?"string"==typeof e.keyName&&(this.attributes[e.keyName]=e):t&&(e.className&&(this.classes[e.className]=e),e.tagName&&(Array.isArray(e.tagName)?e.tagName=e.tagName.map((e=>e.toUpperCase())):e.tagName=e.tagName.toUpperCase(),(Array.isArray(e.tagName)?e.tagName:[e.tagName]).forEach((t=>{(null==this.tags[t]||null==e.className)&&(this.tags[t]=e)})))),e}))}};_Registry.blots=new WeakMap;let Registry=_Registry;function match(e,t){return(e.getAttribute("class")||"").split(/\s+/).filter((e=>0===e.indexOf(`${t}-`)))}class ClassAttributor extends Attributor{static keys(e){return(e.getAttribute("class")||"").split(/\s+/).map((e=>e.split("-").slice(0,-1).join("-")))}add(e,t){return!!this.canAdd(e,t)&&(this.remove(e),e.classList.add(`${this.keyName}-${t}`),!0)}remove(e){match(e,this.keyName).forEach((t=>{e.classList.remove(t)})),0===e.classList.length&&e.removeAttribute("class")}value(e){const t=(match(e,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(e,t)?t:""}}const ClassAttributor$1=ClassAttributor;function camelize(e){const t=e.split("-"),r=t.slice(1).map((e=>e[0].toUpperCase()+e.slice(1))).join("");return t[0]+r}class StyleAttributor extends Attributor{static keys(e){return(e.getAttribute("style")||"").split(";").map((e=>e.split(":")[0].trim()))}add(e,t){return!!this.canAdd(e,t)&&(e.style[camelize(this.keyName)]=t,!0)}remove(e){e.style[camelize(this.keyName)]="",e.getAttribute("style")||e.removeAttribute("style")}value(e){const t=e.style[camelize(this.keyName)];return this.canAdd(e,t)?t:""}}const StyleAttributor$1=StyleAttributor;class AttributorStore{constructor(e){this.attributes={},this.domNode=e,this.build()}attribute(e,t){t?e.add(this.domNode,t)&&(null!=e.value(this.domNode)?this.attributes[e.attrName]=e:delete this.attributes[e.attrName]):(e.remove(this.domNode),delete this.attributes[e.attrName])}build(){this.attributes={};const e=Registry.find(this.domNode);if(null==e)return;const t=Attributor.keys(this.domNode),r=ClassAttributor$1.keys(this.domNode),n=StyleAttributor$1.keys(this.domNode);t.concat(r).concat(n).forEach((t=>{const r=e.scroll.query(t,Scope.ATTRIBUTE);r instanceof Attributor&&(this.attributes[r.attrName]=r)}))}copy(e){Object.keys(this.attributes).forEach((t=>{const r=this.attributes[t].value(this.domNode);e.format(t,r)}))}move(e){this.copy(e),Object.keys(this.attributes).forEach((e=>{this.attributes[e].remove(this.domNode)})),this.attributes={}}values(){return Object.keys(this.attributes).reduce(((e,t)=>(e[t]=this.attributes[t].value(this.domNode),e)),{})}}const AttributorStore$1=AttributorStore,_ShadowBlot=class{constructor(e,t){this.scroll=e,this.domNode=t,Registry.blots.set(t,this),this.prev=null,this.next=null}static create(e){if(null==this.tagName)throw new ParchmentError("Blot definition missing tagName");let t,r;return Array.isArray(this.tagName)?("string"==typeof e?(r=e.toUpperCase(),parseInt(r,10).toString()===r&&(r=parseInt(r,10))):"number"==typeof e&&(r=e),t="number"==typeof r?document.createElement(this.tagName[r-1]):r&&this.tagName.indexOf(r)>-1?document.createElement(r):document.createElement(this.tagName[0])):t=document.createElement(this.tagName),this.className&&t.classList.add(this.className),t}get statics(){return this.constructor}attach(){}clone(){const e=this.domNode.cloneNode(!1);return this.scroll.create(e)}detach(){null!=this.parent&&this.parent.removeChild(this),Registry.blots.delete(this.domNode)}deleteAt(e,t){this.isolate(e,t).remove()}formatAt(e,t,r,n){const i=this.isolate(e,t);if(null!=this.scroll.query(r,Scope.BLOT)&&n)i.wrap(r,n);else if(null!=this.scroll.query(r,Scope.ATTRIBUTE)){const e=this.scroll.create(this.statics.scope);i.wrap(e),e.format(r,n)}}insertAt(e,t,r){const n=null==r?this.scroll.create("text",t):this.scroll.create(t,r),i=this.split(e);this.parent.insertBefore(n,i||void 0)}isolate(e,t){const r=this.split(e);if(null==r)throw new Error("Attempt to isolate at end");return r.split(t),r}length(){return 1}offset(e=this.parent){return null==this.parent||this===e?0:this.parent.children.offset(this)+this.parent.offset(e)}optimize(e){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){null!=this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(e,t){const r="string"==typeof e?this.scroll.create(e,t):e;return null!=this.parent&&(this.parent.insertBefore(r,this.next||void 0),this.remove()),r}split(e,t){return 0===e?this:this.next}update(e,t){}wrap(e,t){const r="string"==typeof e?this.scroll.create(e,t):e;if(null!=this.parent&&this.parent.insertBefore(r,this.next||void 0),"function"!=typeof r.appendChild)throw new ParchmentError(`Cannot wrap ${e}`);return r.appendChild(this),r}};_ShadowBlot.blotName="abstract";let ShadowBlot=_ShadowBlot;const _LeafBlot=class extends ShadowBlot{static value(e){return!0}index(e,t){return this.domNode===e||this.domNode.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(t,1):-1}position(e,t){let r=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return e>0&&(r+=1),[this.parent.domNode,r]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};_LeafBlot.scope=Scope.INLINE_BLOT;let LeafBlot=_LeafBlot;const LeafBlot$1=LeafBlot;class LinkedList{constructor(){this.head=null,this.tail=null,this.length=0}append(...e){if(this.insertBefore(e[0],null),e.length>1){const t=e.slice(1);this.append(...t)}}at(e){const t=this.iterator();let r=t();for(;r&&e>0;)e-=1,r=t();return r}contains(e){const t=this.iterator();let r=t();for(;r;){if(r===e)return!0;r=t()}return!1}indexOf(e){const t=this.iterator();let r=t(),n=0;for(;r;){if(r===e)return n;n+=1,r=t()}return-1}insertBefore(e,t){null!=e&&(this.remove(e),e.next=t,null!=t?(e.prev=t.prev,null!=t.prev&&(t.prev.next=e),t.prev=e,t===this.head&&(this.head=e)):null!=this.tail?(this.tail.next=e,e.prev=this.tail,this.tail=e):(e.prev=null,this.head=this.tail=e),this.length+=1)}offset(e){let t=0,r=this.head;for(;null!=r;){if(r===e)return t;t+=r.length(),r=r.next}return-1}remove(e){this.contains(e)&&(null!=e.prev&&(e.prev.next=e.next),null!=e.next&&(e.next.prev=e.prev),e===this.head&&(this.head=e.next),e===this.tail&&(this.tail=e.prev),this.length-=1)}iterator(e=this.head){return()=>{const t=e;return null!=e&&(e=e.next),t}}find(e,t=!1){const r=this.iterator();let n=r();for(;n;){const i=n.length();if(e<i||t&&e===i&&(null==n.next||0!==n.next.length()))return[n,e];e-=i,n=r()}return[null,0]}forEach(e){const t=this.iterator();let r=t();for(;r;)e(r),r=t()}forEachAt(e,t,r){if(t<=0)return;const[n,i]=this.find(e);let a=e-i;const s=this.iterator(n);let o=s();for(;o&&a<e+t;){const n=o.length();e>a?r(o,e-a,Math.min(t,a+n-e)):r(o,0,Math.min(n,e+t-a)),a+=n,o=s()}}map(e){return this.reduce(((t,r)=>(t.push(e(r)),t)),[])}reduce(e,t){const r=this.iterator();let n=r();for(;n;)t=e(t,n),n=r();return t}}function makeAttachedBlot(e,t){const r=t.find(e);if(r)return r;try{return t.create(e)}catch{const r=t.create(Scope.INLINE);return Array.from(e.childNodes).forEach((e=>{r.domNode.appendChild(e)})),e.parentNode&&e.parentNode.replaceChild(r.domNode,e),r.attach(),r}}const _ParentBlot=class e extends ShadowBlot{constructor(e,t){super(e,t),this.uiNode=null,this.build()}appendChild(e){this.insertBefore(e)}attach(){super.attach(),this.children.forEach((e=>{e.attach()}))}attachUI(t){null!=this.uiNode&&this.uiNode.remove(),this.uiNode=t,e.uiClass&&this.uiNode.classList.add(e.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new LinkedList,Array.from(this.domNode.childNodes).filter((e=>e!==this.uiNode)).reverse().forEach((e=>{try{const t=makeAttachedBlot(e,this.scroll);this.insertBefore(t,this.children.head||void 0)}catch(e){if(e instanceof ParchmentError)return;throw e}}))}deleteAt(e,t){if(0===e&&t===this.length())return this.remove();this.children.forEachAt(e,t,((e,t,r)=>{e.deleteAt(t,r)}))}descendant(t,r=0){const[n,i]=this.children.find(r);return null==t.blotName&&t(n)||null!=t.blotName&&n instanceof t?[n,i]:n instanceof e?n.descendant(t,i):[null,-1]}descendants(t,r=0,n=Number.MAX_VALUE){let i=[],a=n;return this.children.forEachAt(r,n,((r,n,s)=>{(null==t.blotName&&t(r)||null!=t.blotName&&r instanceof t)&&i.push(r),r instanceof e&&(i=i.concat(r.descendants(t,n,a))),a-=s})),i}detach(){this.children.forEach((e=>{e.detach()})),super.detach()}enforceAllowedChildren(){let t=!1;this.children.forEach((r=>{t||this.statics.allowedChildren.some((e=>r instanceof e))||(r.statics.scope===Scope.BLOCK_BLOT?(null!=r.next&&this.splitAfter(r),null!=r.prev&&this.splitAfter(r.prev),r.parent.unwrap(),t=!0):r instanceof e?r.unwrap():r.remove())}))}formatAt(e,t,r,n){this.children.forEachAt(e,t,((e,t,i)=>{e.formatAt(t,i,r,n)}))}insertAt(e,t,r){const[n,i]=this.children.find(e);if(n)n.insertAt(i,t,r);else{const e=null==r?this.scroll.create("text",t):this.scroll.create(t,r);this.appendChild(e)}}insertBefore(e,t){null!=e.parent&&e.parent.children.remove(e);let r=null;this.children.insertBefore(e,t||null),e.parent=this,null!=t&&(r=t.domNode),(this.domNode.parentNode!==e.domNode||this.domNode.nextSibling!==r)&&this.domNode.insertBefore(e.domNode,r),e.attach()}length(){return this.children.reduce(((e,t)=>e+t.length()),0)}moveChildren(e,t){this.children.forEach((r=>{e.insertBefore(r,t)}))}optimize(e){if(super.optimize(e),this.enforceAllowedChildren(),null!=this.uiNode&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),0===this.children.length)if(null!=this.statics.defaultChild){const e=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(e)}else this.remove()}path(t,r=!1){const[n,i]=this.children.find(t,r),a=[[this,t]];return n instanceof e?a.concat(n.path(i,r)):(null!=n&&a.push([n,i]),a)}removeChild(e){this.children.remove(e)}replaceWith(t,r){const n="string"==typeof t?this.scroll.create(t,r):t;return n instanceof e&&this.moveChildren(n),super.replaceWith(n)}split(e,t=!1){if(!t){if(0===e)return this;if(e===this.length())return this.next}const r=this.clone();return this.parent&&this.parent.insertBefore(r,this.next||void 0),this.children.forEachAt(e,this.length(),((e,n,i)=>{const a=e.split(n,t);null!=a&&r.appendChild(a)})),r}splitAfter(e){const t=this.clone();for(;null!=e.next;)t.appendChild(e.next);return this.parent&&this.parent.insertBefore(t,this.next||void 0),t}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(e,t){const r=[],n=[];e.forEach((e=>{e.target===this.domNode&&"childList"===e.type&&(r.push(...e.addedNodes),n.push(...e.removedNodes))})),n.forEach((e=>{if(null!=e.parentNode&&"IFRAME"!==e.tagName&&document.body.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;const t=this.scroll.find(e);null!=t&&(null==t.domNode.parentNode||t.domNode.parentNode===this.domNode)&&t.detach()})),r.filter((e=>e.parentNode===this.domNode&&e!==this.uiNode)).sort(((e,t)=>e===t?0:e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1)).forEach((e=>{let t=null;null!=e.nextSibling&&(t=this.scroll.find(e.nextSibling));const r=makeAttachedBlot(e,this.scroll);(r.next!==t||null==r.next)&&(null!=r.parent&&r.parent.removeChild(this),this.insertBefore(r,t||void 0))})),this.enforceAllowedChildren()}};_ParentBlot.uiClass="";let ParentBlot=_ParentBlot;const ParentBlot$1=ParentBlot;function parchment_isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}const _InlineBlot=class e extends ParentBlot$1{static create(e){return super.create(e)}static formats(t,r){const n=r.query(e.blotName);if(null==n||t.tagName!==n.tagName){if("string"==typeof this.tagName)return!0;if(Array.isArray(this.tagName))return t.tagName.toLowerCase()}}constructor(e,t){super(e,t),this.attributes=new AttributorStore$1(this.domNode)}format(t,r){if(t!==this.statics.blotName||r){const e=this.scroll.query(t,Scope.INLINE);if(null==e)return;e instanceof Attributor?this.attributes.attribute(e,r):r&&(t!==this.statics.blotName||this.formats()[t]!==r)&&this.replaceWith(t,r)}else this.children.forEach((t=>{t instanceof e||(t=t.wrap(e.blotName,!0)),this.attributes.copy(t)})),this.unwrap()}formats(){const e=this.attributes.values(),t=this.statics.formats(this.domNode,this.scroll);return null!=t&&(e[this.statics.blotName]=t),e}formatAt(e,t,r,n){null!=this.formats()[r]||this.scroll.query(r,Scope.ATTRIBUTE)?this.isolate(e,t).format(r,n):super.formatAt(e,t,r,n)}optimize(t){super.optimize(t);const r=this.formats();if(0===Object.keys(r).length)return this.unwrap();const n=this.next;n instanceof e&&n.prev===this&&parchment_isEqual(r,n.formats())&&(n.moveChildren(this),n.remove())}replaceWith(e,t){const r=super.replaceWith(e,t);return this.attributes.copy(r),r}update(e,t){super.update(e,t),e.some((e=>e.target===this.domNode&&"attributes"===e.type))&&this.attributes.build()}wrap(t,r){const n=super.wrap(t,r);return n instanceof e&&this.attributes.move(n),n}};_InlineBlot.allowedChildren=[_InlineBlot,LeafBlot$1],_InlineBlot.blotName="inline",_InlineBlot.scope=Scope.INLINE_BLOT,_InlineBlot.tagName="SPAN";let InlineBlot=_InlineBlot;const InlineBlot$1=InlineBlot,_BlockBlot=class e extends ParentBlot$1{static create(e){return super.create(e)}static formats(t,r){const n=r.query(e.blotName);if(null==n||t.tagName!==n.tagName){if("string"==typeof this.tagName)return!0;if(Array.isArray(this.tagName))return t.tagName.toLowerCase()}}constructor(e,t){super(e,t),this.attributes=new AttributorStore$1(this.domNode)}format(t,r){const n=this.scroll.query(t,Scope.BLOCK);null!=n&&(n instanceof Attributor?this.attributes.attribute(n,r):t!==this.statics.blotName||r?r&&(t!==this.statics.blotName||this.formats()[t]!==r)&&this.replaceWith(t,r):this.replaceWith(e.blotName))}formats(){const e=this.attributes.values(),t=this.statics.formats(this.domNode,this.scroll);return null!=t&&(e[this.statics.blotName]=t),e}formatAt(e,t,r,n){null!=this.scroll.query(r,Scope.BLOCK)?this.format(r,n):super.formatAt(e,t,r,n)}insertAt(e,t,r){if(null==r||null!=this.scroll.query(t,Scope.INLINE))super.insertAt(e,t,r);else{const n=this.split(e);if(null==n)throw new Error("Attempt to insertAt after block boundaries");{const e=this.scroll.create(t,r);n.parent.insertBefore(e,n)}}}replaceWith(e,t){const r=super.replaceWith(e,t);return this.attributes.copy(r),r}update(e,t){super.update(e,t),e.some((e=>e.target===this.domNode&&"attributes"===e.type))&&this.attributes.build()}};_BlockBlot.blotName="block",_BlockBlot.scope=Scope.BLOCK_BLOT,_BlockBlot.tagName="P",_BlockBlot.allowedChildren=[InlineBlot$1,_BlockBlot,LeafBlot$1];let BlockBlot=_BlockBlot;const BlockBlot$1=BlockBlot,_ContainerBlot=class extends ParentBlot$1{checkMerge(){return null!==this.next&&this.next.statics.blotName===this.statics.blotName}deleteAt(e,t){super.deleteAt(e,t),this.enforceAllowedChildren()}formatAt(e,t,r,n){super.formatAt(e,t,r,n),this.enforceAllowedChildren()}insertAt(e,t,r){super.insertAt(e,t,r),this.enforceAllowedChildren()}optimize(e){super.optimize(e),this.children.length>0&&null!=this.next&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};_ContainerBlot.blotName="container",_ContainerBlot.scope=Scope.BLOCK_BLOT;let ContainerBlot=_ContainerBlot;const ContainerBlot$1=ContainerBlot;class EmbedBlot extends LeafBlot$1{static formats(e,t){}format(e,t){super.formatAt(0,this.length(),e,t)}formatAt(e,t,r,n){0===e&&t===this.length()?this.format(r,n):super.formatAt(e,t,r,n)}formats(){return this.statics.formats(this.domNode,this.scroll)}}const EmbedBlot$1=EmbedBlot,OBSERVER_CONFIG={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},MAX_OPTIMIZE_ITERATIONS=100,_ScrollBlot=class extends ParentBlot$1{constructor(e,t){super(null,t),this.registry=e,this.scroll=this,this.build(),this.observer=new MutationObserver((e=>{this.update(e)})),this.observer.observe(this.domNode,OBSERVER_CONFIG),this.attach()}create(e,t){return this.registry.create(this,e,t)}find(e,t=!1){const r=this.registry.find(e,t);return r?r.scroll===this?r:t?this.find(r.scroll.domNode.parentNode,!0):null:null}query(e,t=Scope.ANY){return this.registry.query(e,t)}register(...e){return this.registry.register(...e)}build(){null!=this.scroll&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(e,t){this.update(),0===e&&t===this.length()?this.children.forEach((e=>{e.remove()})):super.deleteAt(e,t)}formatAt(e,t,r,n){this.update(),super.formatAt(e,t,r,n)}insertAt(e,t,r){this.update(),super.insertAt(e,t,r)}optimize(e=[],t={}){super.optimize(t);const r=t.mutationsMap||new WeakMap;let n=Array.from(this.observer.takeRecords());for(;n.length>0;)e.push(n.pop());const i=(e,t=!0)=>{null==e||e===this||null!=e.domNode.parentNode&&(r.has(e.domNode)||r.set(e.domNode,[]),t&&i(e.parent))},a=e=>{r.has(e.domNode)&&(e instanceof ParentBlot$1&&e.children.forEach(a),r.delete(e.domNode),e.optimize(t))};let s=e;for(let t=0;s.length>0;t+=1){if(t>=MAX_OPTIMIZE_ITERATIONS)throw new Error("[Parchment] Maximum optimize iterations reached");for(s.forEach((e=>{const t=this.find(e.target,!0);null!=t&&(t.domNode===e.target&&("childList"===e.type?(i(this.find(e.previousSibling,!1)),Array.from(e.addedNodes).forEach((e=>{const t=this.find(e,!1);i(t,!1),t instanceof ParentBlot$1&&t.children.forEach((e=>{i(e,!1)}))}))):"attributes"===e.type&&i(t.prev)),i(t))})),this.children.forEach(a),s=Array.from(this.observer.takeRecords()),n=s.slice();n.length>0;)e.push(n.pop())}}update(e,t={}){e=e||this.observer.takeRecords();const r=new WeakMap;e.map((e=>{const t=this.find(e.target,!0);return null==t?null:r.has(t.domNode)?(r.get(t.domNode).push(e),null):(r.set(t.domNode,[e]),t)})).forEach((e=>{null!=e&&e!==this&&r.has(e.domNode)&&e.update(r.get(e.domNode)||[],t)})),t.mutationsMap=r,r.has(this.domNode)&&super.update(r.get(this.domNode),t),this.optimize(e,t)}};_ScrollBlot.blotName="scroll",_ScrollBlot.defaultChild=BlockBlot$1,_ScrollBlot.allowedChildren=[BlockBlot$1,ContainerBlot$1],_ScrollBlot.scope=Scope.BLOCK_BLOT,_ScrollBlot.tagName="DIV";let ScrollBlot=_ScrollBlot;const ScrollBlot$1=ScrollBlot,_TextBlot=class e extends LeafBlot$1{static create(e){return document.createTextNode(e)}static value(e){return e.data}constructor(e,t){super(e,t),this.text=this.statics.value(this.domNode)}deleteAt(e,t){this.domNode.data=this.text=this.text.slice(0,e)+this.text.slice(e+t)}index(e,t){return this.domNode===e?t:-1}insertAt(e,t,r){null==r?(this.text=this.text.slice(0,e)+t+this.text.slice(e),this.domNode.data=this.text):super.insertAt(e,t,r)}length(){return this.text.length}optimize(t){super.optimize(t),this.text=this.statics.value(this.domNode),0===this.text.length?this.remove():this.next instanceof e&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(e,t=!1){return[this.domNode,e]}split(e,t=!1){if(!t){if(0===e)return this;if(e===this.length())return this.next}const r=this.scroll.create(this.domNode.splitText(e));return this.parent.insertBefore(r,this.next||void 0),this.text=this.statics.value(this.domNode),r}update(e,t){e.some((e=>"characterData"===e.type&&e.target===this.domNode))&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};_TextBlot.blotName="text",_TextBlot.scope=Scope.INLINE_BLOT;let TextBlot=_TextBlot;const TextBlot$1=TextBlot;var Delta=__webpack_require__(2660);function arrayEach(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}const _arrayEach=arrayEach;var nativeKeys=_overArg(Object.keys,Object);const _nativeKeys=nativeKeys;var _baseKeys_objectProto=Object.prototype,_baseKeys_hasOwnProperty=_baseKeys_objectProto.hasOwnProperty;function baseKeys(e){if(!_isPrototype(e))return _nativeKeys(e);var t=[];for(var r in Object(e))_baseKeys_hasOwnProperty.call(e,r)&&"constructor"!=r&&t.push(r);return t}const _baseKeys=baseKeys;function keys_keys(e){return lodash_es_isArrayLike(e)?_arrayLikeKeys(e):_baseKeys(e)}const lodash_es_keys=keys_keys;function baseAssign(e,t){return e&&_copyObject(t,lodash_es_keys(t),e)}const _baseAssign=baseAssign;function baseAssignIn(e,t){return e&&_copyObject(t,lodash_es_keysIn(t),e)}const _baseAssignIn=baseAssignIn;function arrayFilter(e,t){for(var r=-1,n=null==e?0:e.length,i=0,a=[];++r<n;){var s=e[r];t(s,r,e)&&(a[i++]=s)}return a}const _arrayFilter=arrayFilter;function stubArray(){return[]}const lodash_es_stubArray=stubArray;var _getSymbols_objectProto=Object.prototype,_getSymbols_propertyIsEnumerable=_getSymbols_objectProto.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols?function(e){return null==e?[]:(e=Object(e),_arrayFilter(nativeGetSymbols(e),(function(t){return _getSymbols_propertyIsEnumerable.call(e,t)})))}:lodash_es_stubArray;const _getSymbols=getSymbols;function copySymbols(e,t){return _copyObject(e,_getSymbols(e),t)}const _copySymbols=copySymbols;function arrayPush(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}const _arrayPush=arrayPush;var _getSymbolsIn_nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=_getSymbolsIn_nativeGetSymbols?function(e){for(var t=[];e;)_arrayPush(t,_getSymbols(e)),e=_getPrototype(e);return t}:lodash_es_stubArray;const _getSymbolsIn=getSymbolsIn;function copySymbolsIn(e,t){return _copyObject(e,_getSymbolsIn(e),t)}const _copySymbolsIn=copySymbolsIn;function baseGetAllKeys(e,t,r){var n=t(e);return lodash_es_isArray(e)?n:_arrayPush(n,r(e))}const _baseGetAllKeys=baseGetAllKeys;function getAllKeys(e){return _baseGetAllKeys(e,lodash_es_keys,_getSymbols)}const _getAllKeys=getAllKeys;function getAllKeysIn(e){return _baseGetAllKeys(e,lodash_es_keysIn,_getSymbolsIn)}const _getAllKeysIn=getAllKeysIn;var _DataView_DataView=_getNative(_root,"DataView");const _DataView=_DataView_DataView;var _Promise_Promise=_getNative(_root,"Promise");const _Promise=_Promise_Promise;var _Set_Set=_getNative(_root,"Set");const _Set=_Set_Set;var _WeakMap_WeakMap=_getNative(_root,"WeakMap");const _WeakMap=_WeakMap_WeakMap;var _getTag_mapTag="[object Map]",_getTag_objectTag="[object Object]",promiseTag="[object Promise]",_getTag_setTag="[object Set]",_getTag_weakMapTag="[object WeakMap]",_getTag_dataViewTag="[object DataView]",dataViewCtorString=_toSource(_DataView),mapCtorString=_toSource(_Map),promiseCtorString=_toSource(_Promise),setCtorString=_toSource(_Set),weakMapCtorString=_toSource(_WeakMap),getTag=_baseGetTag;(_DataView&&getTag(new _DataView(new ArrayBuffer(1)))!=_getTag_dataViewTag||_Map&&getTag(new _Map)!=_getTag_mapTag||_Promise&&getTag(_Promise.resolve())!=promiseTag||_Set&&getTag(new _Set)!=_getTag_setTag||_WeakMap&&getTag(new _WeakMap)!=_getTag_weakMapTag)&&(getTag=function(e){var t=_baseGetTag(e),r=t==_getTag_objectTag?e.constructor:void 0,n=r?_toSource(r):"";if(n)switch(n){case dataViewCtorString:return _getTag_dataViewTag;case mapCtorString:return _getTag_mapTag;case promiseCtorString:return promiseTag;case setCtorString:return _getTag_setTag;case weakMapCtorString:return _getTag_weakMapTag}return t});const _getTag=getTag;var _initCloneArray_objectProto=Object.prototype,_initCloneArray_hasOwnProperty=_initCloneArray_objectProto.hasOwnProperty;function initCloneArray(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&_initCloneArray_hasOwnProperty.call(e,"index")&&(r.index=e.index,r.input=e.input),r}const _initCloneArray=initCloneArray;function cloneDataView(e,t){var r=t?_cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}const _cloneDataView=cloneDataView;var reFlags=/\w*$/;function cloneRegExp(e){var t=new e.constructor(e.source,reFlags.exec(e));return t.lastIndex=e.lastIndex,t}const _cloneRegExp=cloneRegExp;var symbolProto=_Symbol?_Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function cloneSymbol(e){return symbolValueOf?Object(symbolValueOf.call(e)):{}}const _cloneSymbol=cloneSymbol;var _initCloneByTag_boolTag="[object Boolean]",_initCloneByTag_dateTag="[object Date]",_initCloneByTag_mapTag="[object Map]",_initCloneByTag_numberTag="[object Number]",_initCloneByTag_regexpTag="[object RegExp]",_initCloneByTag_setTag="[object Set]",_initCloneByTag_stringTag="[object String]",_initCloneByTag_symbolTag="[object Symbol]",_initCloneByTag_arrayBufferTag="[object ArrayBuffer]",_initCloneByTag_dataViewTag="[object DataView]",_initCloneByTag_float32Tag="[object Float32Array]",_initCloneByTag_float64Tag="[object Float64Array]",_initCloneByTag_int8Tag="[object Int8Array]",_initCloneByTag_int16Tag="[object Int16Array]",_initCloneByTag_int32Tag="[object Int32Array]",_initCloneByTag_uint8Tag="[object Uint8Array]",_initCloneByTag_uint8ClampedTag="[object Uint8ClampedArray]",_initCloneByTag_uint16Tag="[object Uint16Array]",_initCloneByTag_uint32Tag="[object Uint32Array]";function initCloneByTag(e,t,r){var n=e.constructor;switch(t){case _initCloneByTag_arrayBufferTag:return _cloneArrayBuffer(e);case _initCloneByTag_boolTag:case _initCloneByTag_dateTag:return new n(+e);case _initCloneByTag_dataViewTag:return _cloneDataView(e,r);case _initCloneByTag_float32Tag:case _initCloneByTag_float64Tag:case _initCloneByTag_int8Tag:case _initCloneByTag_int16Tag:case _initCloneByTag_int32Tag:case _initCloneByTag_uint8Tag:case _initCloneByTag_uint8ClampedTag:case _initCloneByTag_uint16Tag:case _initCloneByTag_uint32Tag:return _cloneTypedArray(e,r);case _initCloneByTag_mapTag:return new n;case _initCloneByTag_numberTag:case _initCloneByTag_stringTag:return new n(e);case _initCloneByTag_regexpTag:return _cloneRegExp(e);case _initCloneByTag_setTag:return new n;case _initCloneByTag_symbolTag:return _cloneSymbol(e)}}const _initCloneByTag=initCloneByTag;var _baseIsMap_mapTag="[object Map]";function baseIsMap(e){return lodash_es_isObjectLike(e)&&_getTag(e)==_baseIsMap_mapTag}const _baseIsMap=baseIsMap;var nodeIsMap=_nodeUtil&&_nodeUtil.isMap,isMap=nodeIsMap?_baseUnary(nodeIsMap):_baseIsMap;const lodash_es_isMap=isMap;var _baseIsSet_setTag="[object Set]";function baseIsSet(e){return lodash_es_isObjectLike(e)&&_getTag(e)==_baseIsSet_setTag}const _baseIsSet=baseIsSet;var nodeIsSet=_nodeUtil&&_nodeUtil.isSet,isSet=nodeIsSet?_baseUnary(nodeIsSet):_baseIsSet;const lodash_es_isSet=isSet;var CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4,_baseClone_argsTag="[object Arguments]",_baseClone_arrayTag="[object Array]",_baseClone_boolTag="[object Boolean]",_baseClone_dateTag="[object Date]",_baseClone_errorTag="[object Error]",_baseClone_funcTag="[object Function]",_baseClone_genTag="[object GeneratorFunction]",_baseClone_mapTag="[object Map]",_baseClone_numberTag="[object Number]",_baseClone_objectTag="[object Object]",_baseClone_regexpTag="[object RegExp]",_baseClone_setTag="[object Set]",_baseClone_stringTag="[object String]",_baseClone_symbolTag="[object Symbol]",_baseClone_weakMapTag="[object WeakMap]",_baseClone_arrayBufferTag="[object ArrayBuffer]",_baseClone_dataViewTag="[object DataView]",_baseClone_float32Tag="[object Float32Array]",_baseClone_float64Tag="[object Float64Array]",_baseClone_int8Tag="[object Int8Array]",_baseClone_int16Tag="[object Int16Array]",_baseClone_int32Tag="[object Int32Array]",_baseClone_uint8Tag="[object Uint8Array]",_baseClone_uint8ClampedTag="[object Uint8ClampedArray]",_baseClone_uint16Tag="[object Uint16Array]",_baseClone_uint32Tag="[object Uint32Array]",cloneableTags={};function baseClone(e,t,r,n,i,a){var s,o=t&CLONE_DEEP_FLAG,l=t&CLONE_FLAT_FLAG,c=t&CLONE_SYMBOLS_FLAG;if(r&&(s=i?r(e,n,i,a):r(e)),void 0!==s)return s;if(!lodash_es_isObject(e))return e;var d=lodash_es_isArray(e);if(d){if(s=_initCloneArray(e),!o)return _copyArray(e,s)}else{var u=_getTag(e),p=u==_baseClone_funcTag||u==_baseClone_genTag;if(lodash_es_isBuffer(e))return _cloneBuffer(e,o);if(u==_baseClone_objectTag||u==_baseClone_argsTag||p&&!i){if(s=l||p?{}:_initCloneObject(e),!o)return l?_copySymbolsIn(e,_baseAssignIn(s,e)):_copySymbols(e,_baseAssign(s,e))}else{if(!cloneableTags[u])return i?e:{};s=_initCloneByTag(e,u,o)}}a||(a=new _Stack);var h=a.get(e);if(h)return h;a.set(e,s),lodash_es_isSet(e)?e.forEach((function(n){s.add(baseClone(n,t,r,n,e,a))})):lodash_es_isMap(e)&&e.forEach((function(n,i){s.set(i,baseClone(n,t,r,i,e,a))}));var f=d?void 0:(c?l?_getAllKeysIn:_getAllKeys:l?lodash_es_keysIn:lodash_es_keys)(e);return _arrayEach(f||e,(function(n,i){f&&(n=e[i=n]),_assignValue(s,i,baseClone(n,t,r,i,e,a))})),s}cloneableTags[_baseClone_argsTag]=cloneableTags[_baseClone_arrayTag]=cloneableTags[_baseClone_arrayBufferTag]=cloneableTags[_baseClone_dataViewTag]=cloneableTags[_baseClone_boolTag]=cloneableTags[_baseClone_dateTag]=cloneableTags[_baseClone_float32Tag]=cloneableTags[_baseClone_float64Tag]=cloneableTags[_baseClone_int8Tag]=cloneableTags[_baseClone_int16Tag]=cloneableTags[_baseClone_int32Tag]=cloneableTags[_baseClone_mapTag]=cloneableTags[_baseClone_numberTag]=cloneableTags[_baseClone_objectTag]=cloneableTags[_baseClone_regexpTag]=cloneableTags[_baseClone_setTag]=cloneableTags[_baseClone_stringTag]=cloneableTags[_baseClone_symbolTag]=cloneableTags[_baseClone_uint8Tag]=cloneableTags[_baseClone_uint8ClampedTag]=cloneableTags[_baseClone_uint16Tag]=cloneableTags[_baseClone_uint32Tag]=!0,cloneableTags[_baseClone_errorTag]=cloneableTags[_baseClone_funcTag]=cloneableTags[_baseClone_weakMapTag]=!1;const _baseClone=baseClone;var cloneDeep_CLONE_DEEP_FLAG=1,cloneDeep_CLONE_SYMBOLS_FLAG=4;function cloneDeep(e){return _baseClone(e,cloneDeep_CLONE_DEEP_FLAG|cloneDeep_CLONE_SYMBOLS_FLAG)}const lodash_es_cloneDeep=cloneDeep;var _setCacheAdd_HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(e){return this.__data__.set(e,_setCacheAdd_HASH_UNDEFINED),this}const _setCacheAdd=setCacheAdd;function setCacheHas(e){return this.__data__.has(e)}const _setCacheHas=setCacheHas;function SetCache(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new _MapCache;++t<r;)this.add(e[t])}SetCache.prototype.add=SetCache.prototype.push=_setCacheAdd,SetCache.prototype.has=_setCacheHas;const _SetCache=SetCache;function arraySome(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}const _arraySome=arraySome;function cacheHas(e,t){return e.has(t)}const _cacheHas=cacheHas;var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function equalArrays(e,t,r,n,i,a){var s=r&COMPARE_PARTIAL_FLAG,o=e.length,l=t.length;if(o!=l&&!(s&&l>o))return!1;var c=a.get(e),d=a.get(t);if(c&&d)return c==t&&d==e;var u=-1,p=!0,h=r&COMPARE_UNORDERED_FLAG?new _SetCache:void 0;for(a.set(e,t),a.set(t,e);++u<o;){var f=e[u],m=t[u];if(n)var g=s?n(m,f,u,t,e,a):n(f,m,u,e,t,a);if(void 0!==g){if(g)continue;p=!1;break}if(h){if(!_arraySome(t,(function(e,t){if(!_cacheHas(h,t)&&(f===e||i(f,e,r,n,a)))return h.push(t)}))){p=!1;break}}else if(f!==m&&!i(f,m,r,n,a)){p=!1;break}}return a.delete(e),a.delete(t),p}const _equalArrays=equalArrays;function mapToArray(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}const _mapToArray=mapToArray;function setToArray(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}const _setToArray=setToArray;var _equalByTag_COMPARE_PARTIAL_FLAG=1,_equalByTag_COMPARE_UNORDERED_FLAG=2,_equalByTag_boolTag="[object Boolean]",_equalByTag_dateTag="[object Date]",_equalByTag_errorTag="[object Error]",_equalByTag_mapTag="[object Map]",_equalByTag_numberTag="[object Number]",_equalByTag_regexpTag="[object RegExp]",_equalByTag_setTag="[object Set]",_equalByTag_stringTag="[object String]",_equalByTag_symbolTag="[object Symbol]",_equalByTag_arrayBufferTag="[object ArrayBuffer]",_equalByTag_dataViewTag="[object DataView]",_equalByTag_symbolProto=_Symbol?_Symbol.prototype:void 0,_equalByTag_symbolValueOf=_equalByTag_symbolProto?_equalByTag_symbolProto.valueOf:void 0;function equalByTag(e,t,r,n,i,a,s){switch(r){case _equalByTag_dataViewTag:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case _equalByTag_arrayBufferTag:return!(e.byteLength!=t.byteLength||!a(new _Uint8Array(e),new _Uint8Array(t)));case _equalByTag_boolTag:case _equalByTag_dateTag:case _equalByTag_numberTag:return lodash_es_eq(+e,+t);case _equalByTag_errorTag:return e.name==t.name&&e.message==t.message;case _equalByTag_regexpTag:case _equalByTag_stringTag:return e==t+"";case _equalByTag_mapTag:var o=_mapToArray;case _equalByTag_setTag:var l=n&_equalByTag_COMPARE_PARTIAL_FLAG;if(o||(o=_setToArray),e.size!=t.size&&!l)return!1;var c=s.get(e);if(c)return c==t;n|=_equalByTag_COMPARE_UNORDERED_FLAG,s.set(e,t);var d=_equalArrays(o(e),o(t),n,i,a,s);return s.delete(e),d;case _equalByTag_symbolTag:if(_equalByTag_symbolValueOf)return _equalByTag_symbolValueOf.call(e)==_equalByTag_symbolValueOf.call(t)}return!1}const _equalByTag=equalByTag;var _equalObjects_COMPARE_PARTIAL_FLAG=1,_equalObjects_objectProto=Object.prototype,_equalObjects_hasOwnProperty=_equalObjects_objectProto.hasOwnProperty;function equalObjects(e,t,r,n,i,a){var s=r&_equalObjects_COMPARE_PARTIAL_FLAG,o=_getAllKeys(e),l=o.length;if(l!=_getAllKeys(t).length&&!s)return!1;for(var c=l;c--;){var d=o[c];if(!(s?d in t:_equalObjects_hasOwnProperty.call(t,d)))return!1}var u=a.get(e),p=a.get(t);if(u&&p)return u==t&&p==e;var h=!0;a.set(e,t),a.set(t,e);for(var f=s;++c<l;){var m=e[d=o[c]],g=t[d];if(n)var _=s?n(g,m,d,t,e,a):n(m,g,d,e,t,a);if(!(void 0===_?m===g||i(m,g,r,n,a):_)){h=!1;break}f||(f="constructor"==d)}if(h&&!f){var b=e.constructor,v=t.constructor;b==v||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof v&&v instanceof v||(h=!1)}return a.delete(e),a.delete(t),h}const _equalObjects=equalObjects;var _baseIsEqualDeep_COMPARE_PARTIAL_FLAG=1,_baseIsEqualDeep_argsTag="[object Arguments]",_baseIsEqualDeep_arrayTag="[object Array]",_baseIsEqualDeep_objectTag="[object Object]",_baseIsEqualDeep_objectProto=Object.prototype,_baseIsEqualDeep_hasOwnProperty=_baseIsEqualDeep_objectProto.hasOwnProperty;function baseIsEqualDeep(e,t,r,n,i,a){var s=lodash_es_isArray(e),o=lodash_es_isArray(t),l=s?_baseIsEqualDeep_arrayTag:_getTag(e),c=o?_baseIsEqualDeep_arrayTag:_getTag(t),d=(l=l==_baseIsEqualDeep_argsTag?_baseIsEqualDeep_objectTag:l)==_baseIsEqualDeep_objectTag,u=(c=c==_baseIsEqualDeep_argsTag?_baseIsEqualDeep_objectTag:c)==_baseIsEqualDeep_objectTag,p=l==c;if(p&&lodash_es_isBuffer(e)){if(!lodash_es_isBuffer(t))return!1;s=!0,d=!1}if(p&&!d)return a||(a=new _Stack),s||lodash_es_isTypedArray(e)?_equalArrays(e,t,r,n,i,a):_equalByTag(e,t,l,r,n,i,a);if(!(r&_baseIsEqualDeep_COMPARE_PARTIAL_FLAG)){var h=d&&_baseIsEqualDeep_hasOwnProperty.call(e,"__wrapped__"),f=u&&_baseIsEqualDeep_hasOwnProperty.call(t,"__wrapped__");if(h||f){var m=h?e.value():e,g=f?t.value():t;return a||(a=new _Stack),i(m,g,r,n,a)}}return!!p&&(a||(a=new _Stack),_equalObjects(e,t,r,n,i,a))}const _baseIsEqualDeep=baseIsEqualDeep;function baseIsEqual(e,t,r,n,i){return e===t||(null==e||null==t||!lodash_es_isObjectLike(e)&&!lodash_es_isObjectLike(t)?e!=e&&t!=t:_baseIsEqualDeep(e,t,r,n,baseIsEqual,i))}const _baseIsEqual=baseIsEqual;function isEqual_isEqual(e,t){return _baseIsEqual(e,t)}const lodash_es_isEqual=isEqual_isEqual;class Break extends EmbedBlot$1{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}}Break.blotName="break",Break.tagName="BR";const blots_break=Break;class text_Text extends TextBlot$1{}const entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function escapeText(e){return e.replace(/[&<>"']/g,(e=>entityMap[e]))}class Inline extends InlineBlot$1{static allowedChildren=[Inline,blots_break,EmbedBlot$1,text_Text];static order=["cursor","inline","link","underline","strike","italic","bold","script","code"];static compare(e,t){const r=Inline.order.indexOf(e),n=Inline.order.indexOf(t);return r>=0||n>=0?r-n:e===t?0:e<t?-1:1}formatAt(e,t,r,n){if(Inline.compare(this.statics.blotName,r)<0&&this.scroll.query(r,Scope.BLOT)){const i=this.isolate(e,t);n&&i.wrap(r,n)}else super.formatAt(e,t,r,n)}optimize(e){if(super.optimize(e),this.parent instanceof Inline&&Inline.compare(this.statics.blotName,this.parent.statics.blotName)>0){const e=this.parent.isolate(this.offset(),this.length());this.moveChildren(e),e.wrap(this)}}}const inline=Inline,NEWLINE_LENGTH=1;class Block extends BlockBlot$1{cache={};delta(){return null==this.cache.delta&&(this.cache.delta=blockDelta(this)),this.cache.delta}deleteAt(e,t){super.deleteAt(e,t),this.cache={}}formatAt(e,t,r,n){t<=0||(this.scroll.query(r,Scope.BLOCK)?e+t===this.length()&&this.format(r,n):super.formatAt(e,Math.min(t,this.length()-e-1),r,n),this.cache={})}insertAt(e,t,r){if(null!=r)return super.insertAt(e,t,r),void(this.cache={});if(0===t.length)return;const n=t.split("\n"),i=n.shift();i.length>0&&(e<this.length()-1||null==this.children.tail?super.insertAt(Math.min(e,this.length()-1),i):this.children.tail.insertAt(this.children.tail.length(),i),this.cache={});let a=this;n.reduce(((e,t)=>(a=a.split(e,!0),a.insertAt(0,t),t.length)),e+i.length)}insertBefore(e,t){const{head:r}=this.children;super.insertBefore(e,t),r instanceof blots_break&&r.remove(),this.cache={}}length(){return null==this.cache.length&&(this.cache.length=super.length()+NEWLINE_LENGTH),this.cache.length}moveChildren(e,t){super.moveChildren(e,t),this.cache={}}optimize(e){super.optimize(e),this.cache={}}path(e){return super.path(e,!0)}removeChild(e){super.removeChild(e),this.cache={}}split(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t&&(0===e||e>=this.length()-NEWLINE_LENGTH)){const t=this.clone();return 0===e?(this.parent.insertBefore(t,this),this):(this.parent.insertBefore(t,this.next),t)}const r=super.split(e,t);return this.cache={},r}}Block.blotName="block",Block.tagName="P",Block.defaultChild=blots_break,Block.allowedChildren=[blots_break,inline,EmbedBlot$1,text_Text];class BlockEmbed extends EmbedBlot$1{attach(){super.attach(),this.attributes=new AttributorStore$1(this.domNode)}delta(){return(new Delta).insert(this.value(),{...this.formats(),...this.attributes.values()})}format(e,t){const r=this.scroll.query(e,Scope.BLOCK_ATTRIBUTE);null!=r&&this.attributes.attribute(r,t)}formatAt(e,t,r,n){this.format(r,n)}insertAt(e,t,r){if(null!=r)return void super.insertAt(e,t,r);const n=t.split("\n"),i=n.pop(),a=n.map((e=>{const t=this.scroll.create(Block.blotName);return t.insertAt(0,e),t})),s=this.split(e);a.forEach((e=>{this.parent.insertBefore(e,s)})),i&&this.parent.insertBefore(this.scroll.create("text",i),s)}}function blockDelta(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.descendants(LeafBlot$1).reduce(((e,r)=>0===r.length()?e:e.insert(r.value(),bubbleFormats(r,{},t))),new Delta).insert("\n",bubbleFormats(e))}function bubbleFormats(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return null==e?t:("formats"in e&&"function"==typeof e.formats&&(t={...t,...e.formats()},r&&delete t["code-token"]),null==e.parent||"scroll"===e.parent.statics.blotName||e.parent.statics.scope!==e.statics.scope?t:bubbleFormats(e.parent,t,r))}BlockEmbed.scope=Scope.BLOCK_BLOT;class Cursor extends EmbedBlot$1{static blotName="cursor";static className="ql-cursor";static tagName="span";static CONTENTS="\ufeff";static value(){}constructor(e,t,r){super(e,t),this.selection=r,this.textNode=document.createTextNode(Cursor.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){null!=this.parent&&this.parent.removeChild(this)}format(e,t){if(0!==this.savedLength)return void super.format(e,t);let r=this,n=0;for(;null!=r&&r.statics.scope!==Scope.BLOCK_BLOT;)n+=r.offset(r.parent),r=r.parent;null!=r&&(this.savedLength=Cursor.CONTENTS.length,r.optimize(),r.formatAt(n,Cursor.CONTENTS.length,e,t),this.savedLength=0)}index(e,t){return e===this.textNode?0:super.index(e,t)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||null==this.parent)return null;const e=this.selection.getNativeRange();for(;null!=this.domNode.lastChild&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);const t=this.prev instanceof text_Text?this.prev:null,r=t?t.length():0,n=this.next instanceof text_Text?this.next:null,i=n?n.text:"",{textNode:a}=this,s=a.data.split(Cursor.CONTENTS).join("");let o;if(a.data=Cursor.CONTENTS,t)o=t,(s||n)&&(t.insertAt(t.length(),s+i),n&&n.remove());else if(n)o=n,n.insertAt(0,s);else{const e=document.createTextNode(s);o=this.scroll.create(e),this.parent.insertBefore(o,this)}if(this.remove(),e){const i=(e,i)=>t&&e===t.domNode?i:e===a?r+i-1:n&&e===n.domNode?r+s.length+i:null,l=i(e.start.node,e.start.offset),c=i(e.end.node,e.end.offset);if(null!==l&&null!==c)return{startNode:o.domNode,startOffset:l,endNode:o.domNode,endOffset:c}}return null}update(e,t){if(e.some((e=>"characterData"===e.type&&e.target===this.textNode))){const e=this.restore();e&&(t.range=e)}}optimize(e){super.optimize(e);let{parent:t}=this;for(;t;){if("A"===t.domNode.tagName){this.savedLength=Cursor.CONTENTS.length,t.isolate(this.offset(t),this.length()).unwrap(),this.savedLength=0;break}t=t.parent}}value(){return""}}const cursor=Cursor,instances=new WeakMap,levels=["error","warn","log","info"];let level="warn";function debug(e){if(level&&levels.indexOf(e)<=levels.indexOf(level)){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];console[e](...r)}}function namespace(e){return levels.reduce(((t,r)=>(t[r]=debug.bind(console,r,e),t)),{})}namespace.level=e=>{level=e},debug.level=namespace.level;const core_logger=namespace,emitter_debug=core_logger("quill:events"),EVENTS=["selectionchange","mousedown","mouseup","click"];EVENTS.forEach((e=>{document.addEventListener(e,(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];Array.from(document.querySelectorAll(".ql-container")).forEach((e=>{const r=instances.get(e);r&&r.emitter&&r.emitter.handleDOM(...t)}))}))}));class Emitter extends eventemitter3{static events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"};static sources={API:"api",SILENT:"silent",USER:"user"};constructor(){super(),this.domListeners={},this.on("error",emitter_debug.error)}emit(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return emitter_debug.log.call(emitter_debug,...t),super.emit(...t)}handleDOM(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];(this.domListeners[e.type]||[]).forEach((t=>{let{node:n,handler:i}=t;(e.target===n||n.contains(e.target))&&i(e,...r)}))}listenDOM(e,t,r){this.domListeners[e]||(this.domListeners[e]=[]),this.domListeners[e].push({node:t,handler:r})}}const core_emitter=Emitter,selection_debug=core_logger("quill:selection");class Range{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.index=e,this.length=t}}class Selection{constructor(e,t){this.emitter=t,this.scroll=e,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new Range(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,(()=>{this.mouseDown||this.composing||setTimeout(this.update.bind(this,core_emitter.sources.USER),1)})),this.emitter.on(core_emitter.events.SCROLL_BEFORE_UPDATE,(()=>{if(!this.hasFocus())return;const e=this.getNativeRange();null!=e&&e.start.node!==this.cursor.textNode&&this.emitter.once(core_emitter.events.SCROLL_UPDATE,((t,r)=>{try{this.root.contains(e.start.node)&&this.root.contains(e.end.node)&&this.setNativeRange(e.start.node,e.start.offset,e.end.node,e.end.offset);const n=r.some((e=>"characterData"===e.type||"childList"===e.type||"attributes"===e.type&&e.target===this.root));this.update(n?core_emitter.sources.SILENT:t)}catch(e){}}))})),this.emitter.on(core_emitter.events.SCROLL_OPTIMIZE,((e,t)=>{if(t.range){const{startNode:e,startOffset:r,endNode:n,endOffset:i}=t.range;this.setNativeRange(e,r,n,i),this.update(core_emitter.sources.SILENT)}})),this.update(core_emitter.sources.SILENT)}handleComposition(){this.emitter.on(core_emitter.events.COMPOSITION_BEFORE_START,(()=>{this.composing=!0})),this.emitter.on(core_emitter.events.COMPOSITION_END,(()=>{if(this.composing=!1,this.cursor.parent){const e=this.cursor.restore();if(!e)return;setTimeout((()=>{this.setNativeRange(e.startNode,e.startOffset,e.endNode,e.endOffset)}),1)}}))}handleDragging(){this.emitter.listenDOM("mousedown",document.body,(()=>{this.mouseDown=!0})),this.emitter.listenDOM("mouseup",document.body,(()=>{this.mouseDown=!1,this.update(core_emitter.sources.USER)}))}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(e,t){this.scroll.update();const r=this.getNativeRange();if(null!=r&&r.native.collapsed&&!this.scroll.query(e,Scope.BLOCK)){if(r.start.node!==this.cursor.textNode){const e=this.scroll.find(r.start.node,!1);if(null==e)return;if(e instanceof LeafBlot$1){const t=e.split(r.start.offset);e.parent.insertBefore(this.cursor,t)}else e.insertBefore(this.cursor,r.start.node);this.cursor.attach()}this.cursor.format(e,t),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=this.scroll.length();let n;e=Math.min(e,r-1),t=Math.min(e+t,r-1)-e;let[i,a]=this.scroll.leaf(e);if(null==i)return null;if(t>0&&a===i.length()){const[t]=this.scroll.leaf(e+1);if(t){const[r]=this.scroll.line(e),[n]=this.scroll.line(e+1);r===n&&(i=t,a=0)}}[n,a]=i.position(a,!0);const s=document.createRange();if(t>0)return s.setStart(n,a),[i,a]=this.scroll.leaf(e+t),null==i?null:([n,a]=i.position(a,!0),s.setEnd(n,a),s.getBoundingClientRect());let o,l="left";if(n instanceof Text){if(!n.data.length)return null;a<n.data.length?(s.setStart(n,a),s.setEnd(n,a+1)):(s.setStart(n,a-1),s.setEnd(n,a),l="right"),o=s.getBoundingClientRect()}else{if(!(i.domNode instanceof Element))return null;o=i.domNode.getBoundingClientRect(),a>0&&(l="right")}return{bottom:o.top+o.height,height:o.height,left:o[l],right:o[l],top:o.top,width:0}}getNativeRange(){const e=document.getSelection();if(null==e||e.rangeCount<=0)return null;const t=e.getRangeAt(0);if(null==t)return null;const r=this.normalizeNative(t);return selection_debug.info("getNativeRange",r),r}getRange(){const e=this.scroll.domNode;if("isConnected"in e&&!e.isConnected)return[null,null];const t=this.getNativeRange();return null==t?[null,null]:[this.normalizedToRange(t),t]}hasFocus(){return document.activeElement===this.root||null!=document.activeElement&&contains(this.root,document.activeElement)}normalizedToRange(e){const t=[[e.start.node,e.start.offset]];e.native.collapsed||t.push([e.end.node,e.end.offset]);const r=t.map((e=>{const[t,r]=e,n=this.scroll.find(t,!0),i=n.offset(this.scroll);return 0===r?i:n instanceof LeafBlot$1?i+n.index(t,r):i+n.length()})),n=Math.min(Math.max(...r),this.scroll.length()-1),i=Math.min(n,...r);return new Range(i,n-i)}normalizeNative(e){if(!contains(this.root,e.startContainer)||!e.collapsed&&!contains(this.root,e.endContainer))return null;const t={start:{node:e.startContainer,offset:e.startOffset},end:{node:e.endContainer,offset:e.endOffset},native:e};return[t.start,t.end].forEach((e=>{let{node:t,offset:r}=e;for(;!(t instanceof Text)&&t.childNodes.length>0;)if(t.childNodes.length>r)t=t.childNodes[r],r=0;else{if(t.childNodes.length!==r)break;t=t.lastChild,r=t instanceof Text?t.data.length:t.childNodes.length>0?t.childNodes.length:t.childNodes.length+1}e.node=t,e.offset=r})),t}rangeToNative(e){const t=this.scroll.length(),r=(e,r)=>{e=Math.min(t-1,e);const[n,i]=this.scroll.leaf(e);return n?n.position(i,r):[null,-1]};return[...r(e.index,!1),...r(e.index+e.length,!0)]}setNativeRange(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(selection_debug.info("setNativeRange",e,t,r,n),null!=e&&(null==this.root.parentNode||null==e.parentNode||null==r.parentNode))return;const a=document.getSelection();if(null!=a)if(null!=e){this.hasFocus()||this.root.focus({preventScroll:!0});const{native:s}=this.getNativeRange()||{};if(null==s||i||e!==s.startContainer||t!==s.startOffset||r!==s.endContainer||n!==s.endOffset){e instanceof Element&&"BR"===e.tagName&&(t=Array.from(e.parentNode.childNodes).indexOf(e),e=e.parentNode),r instanceof Element&&"BR"===r.tagName&&(n=Array.from(r.parentNode.childNodes).indexOf(r),r=r.parentNode);const i=document.createRange();i.setStart(e,t),i.setEnd(r,n),a.removeAllRanges(),a.addRange(i)}}else a.removeAllRanges(),this.root.blur()}setRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:core_emitter.sources.API;if("string"==typeof t&&(r=t,t=!1),selection_debug.info("setRange",e),null!=e){const r=this.rangeToNative(e);this.setNativeRange(...r,t)}else this.setNativeRange(null);this.update(r)}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:core_emitter.sources.USER;const t=this.lastRange,[r,n]=this.getRange();if(this.lastRange=r,this.lastNative=n,null!=this.lastRange&&(this.savedRange=this.lastRange),!lodash_es_isEqual(t,this.lastRange)){if(!this.composing&&null!=n&&n.native.collapsed&&n.start.node!==this.cursor.textNode){const e=this.cursor.restore();e&&this.setNativeRange(e.startNode,e.startOffset,e.endNode,e.endOffset)}const r=[core_emitter.events.SELECTION_CHANGE,lodash_es_cloneDeep(this.lastRange),lodash_es_cloneDeep(t),e];this.emitter.emit(core_emitter.events.EDITOR_CHANGE,...r),e!==core_emitter.sources.SILENT&&this.emitter.emit(...r)}}}function contains(e,t){try{t.parentNode}catch(e){return!1}return e.contains(t)}const selection=Selection,ASCII=/^[ -~]*$/;class editor_Editor{constructor(e){this.scroll=e,this.delta=this.getDelta()}applyDelta(e){this.scroll.update();let t=this.scroll.length();this.scroll.batchStart();const r=normalizeDelta(e),n=new Delta;return splitOpLines(r.ops.slice()).reduce(((e,r)=>{const i=Delta.Op.length(r);let a=r.attributes||{},s=!1,o=!1;if(null!=r.insert){if(n.retain(i),"string"==typeof r.insert){const n=r.insert;o=!n.endsWith("\n")&&(t<=e||!!this.scroll.descendant(BlockEmbed,e)[0]),this.scroll.insertAt(e,n);const[i,s]=this.scroll.line(e);let l=lodash_es_merge({},bubbleFormats(i));if(i instanceof Block){const[e]=i.descendant(LeafBlot$1,s);e&&(l=lodash_es_merge(l,bubbleFormats(e)))}a=Delta.AttributeMap.diff(l,a)||{}}else if("object"==typeof r.insert){const n=Object.keys(r.insert)[0];if(null==n)return e;const i=null!=this.scroll.query(n,Scope.INLINE);if(i)(t<=e||this.scroll.descendant(BlockEmbed,e)[0])&&(o=!0);else if(e>0){const[t,r]=this.scroll.descendant(LeafBlot$1,e-1);t instanceof text_Text?"\n"!==t.value()[r]&&(s=!0):t instanceof EmbedBlot$1&&t.statics.scope===Scope.INLINE_BLOT&&(s=!0)}if(this.scroll.insertAt(e,n,r.insert[n]),i){const[t]=this.scroll.descendant(LeafBlot$1,e);if(t){const e=lodash_es_merge({},bubbleFormats(t));a=Delta.AttributeMap.diff(e,a)||{}}}}t+=i}else if(n.push(r),null!==r.retain&&"object"==typeof r.retain){const t=Object.keys(r.retain)[0];if(null==t)return e;this.scroll.updateEmbedAt(e,t,r.retain[t])}Object.keys(a).forEach((t=>{this.scroll.formatAt(e,i,t,a[t])}));const l=s?1:0,c=o?1:0;return t+=l+c,n.retain(l),n.delete(c),e+i+l+c}),0),n.reduce(((e,t)=>"number"==typeof t.delete?(this.scroll.deleteAt(e,t.delete),e):e+Delta.Op.length(t)),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(r)}deleteText(e,t){return this.scroll.deleteAt(e,t),this.update((new Delta).retain(e).delete(t))}formatLine(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.scroll.update(),Object.keys(r).forEach((n=>{this.scroll.lines(e,Math.max(t,1)).forEach((e=>{e.format(n,r[n])}))})),this.scroll.optimize();const n=(new Delta).retain(e).retain(t,lodash_es_cloneDeep(r));return this.update(n)}formatText(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.keys(r).forEach((n=>{this.scroll.formatAt(e,t,n,r[n])}));const n=(new Delta).retain(e).retain(t,lodash_es_cloneDeep(r));return this.update(n)}getContents(e,t){return this.delta.slice(e,e+t)}getDelta(){return this.scroll.lines().reduce(((e,t)=>e.concat(t.delta())),new Delta)}getFormat(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[],n=[];0===t?this.scroll.path(e).forEach((e=>{const[t]=e;t instanceof Block?r.push(t):t instanceof LeafBlot$1&&n.push(t)})):(r=this.scroll.lines(e,t),n=this.scroll.descendants(LeafBlot$1,e,t));const[i,a]=[r,n].map((e=>{const t=e.shift();if(null==t)return{};let r=bubbleFormats(t);for(;Object.keys(r).length>0;){const t=e.shift();if(null==t)return r;r=combineFormats(bubbleFormats(t),r)}return r}));return{...i,...a}}getHTML(e,t){const[r,n]=this.scroll.line(e);if(r){const i=r.length();return r.length()>=n+t&&(0!==n||t!==i)?convertHTML(r,n,t,!0):convertHTML(this.scroll,e,t,!0)}return""}getText(e,t){return this.getContents(e,t).filter((e=>"string"==typeof e.insert)).map((e=>e.insert)).join("")}insertContents(e,t){const r=normalizeDelta(t),n=(new Delta).retain(e).concat(r);return this.scroll.insertContents(e,r),this.update(n)}insertEmbed(e,t,r){return this.scroll.insertAt(e,t,r),this.update((new Delta).retain(e).insert({[t]:r}))}insertText(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t=t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),this.scroll.insertAt(e,t),Object.keys(r).forEach((n=>{this.scroll.formatAt(e,t.length,n,r[n])})),this.update((new Delta).retain(e).insert(t,lodash_es_cloneDeep(r)))}isBlank(){if(0===this.scroll.children.length)return!0;if(this.scroll.children.length>1)return!1;const e=this.scroll.children.head;if(e?.statics.blotName!==Block.blotName)return!1;const t=e;return!(t.children.length>1)&&t.children.head instanceof blots_break}removeFormat(e,t){const r=this.getText(e,t),[n,i]=this.scroll.line(e+t);let a=0,s=new Delta;null!=n&&(a=n.length()-i,s=n.delta().slice(i,i+a-1).insert("\n"));const o=this.getContents(e,t+a).diff((new Delta).insert(r).concat(s)),l=(new Delta).retain(e).concat(o);return this.applyDelta(l)}update(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;const n=this.delta;if(1===t.length&&"characterData"===t[0].type&&t[0].target.data.match(ASCII)&&this.scroll.find(t[0].target)){const i=this.scroll.find(t[0].target),a=bubbleFormats(i),s=i.offset(this.scroll),o=t[0].oldValue.replace(cursor.CONTENTS,""),l=(new Delta).insert(o),c=(new Delta).insert(i.value()),d=r&&{oldRange:shiftRange(r.oldRange,-s),newRange:shiftRange(r.newRange,-s)};e=(new Delta).retain(s).concat(l.diff(c,d)).reduce(((e,t)=>t.insert?e.insert(t.insert,a):e.push(t)),new Delta),this.delta=n.compose(e)}else this.delta=this.getDelta(),e&&lodash_es_isEqual(n.compose(e),this.delta)||(e=n.diff(this.delta,r));return e}}function convertListHTML(e,t,r){if(0===e.length){const[e]=getListType(r.pop());return t<=0?`</li></${e}>`:`</li></${e}>${convertListHTML([],t-1,r)}`}const[{child:n,offset:i,length:a,indent:s,type:o},...l]=e,[c,d]=getListType(o);if(s>t)return r.push(o),s===t+1?`<${c}><li${d}>${convertHTML(n,i,a)}${convertListHTML(l,s,r)}`:`<${c}><li>${convertListHTML(e,t+1,r)}`;const u=r[r.length-1];if(s===t&&o===u)return`</li><li${d}>${convertHTML(n,i,a)}${convertListHTML(l,s,r)}`;const[p]=getListType(r.pop());return`</li></${p}>${convertListHTML(e,t-1,r)}`}function convertHTML(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if("html"in e&&"function"==typeof e.html)return e.html(t,r);if(e instanceof text_Text)return escapeText(e.value().slice(t,t+r)).replaceAll(" ","&nbsp;");if(e instanceof ParentBlot$1){if("list-container"===e.statics.blotName){const n=[];return e.children.forEachAt(t,r,((e,t,r)=>{const i="formats"in e&&"function"==typeof e.formats?e.formats():{};n.push({child:e,offset:t,length:r,indent:i.indent||0,type:i.list})})),convertListHTML(n,-1,[])}const i=[];if(e.children.forEachAt(t,r,((e,t,r)=>{i.push(convertHTML(e,t,r))})),n||"list"===e.statics.blotName)return i.join("");const{outerHTML:a,innerHTML:s}=e.domNode,[o,l]=a.split(`>${s}<`);return"<table"===o?`<table style="border: 1px solid #000;">${i.join("")}<${l}`:`${o}>${i.join("")}<${l}`}return e.domNode instanceof Element?e.domNode.outerHTML:""}function combineFormats(e,t){return Object.keys(t).reduce(((r,n)=>{if(null==e[n])return r;const i=t[n];return i===e[n]?r[n]=i:Array.isArray(i)?i.indexOf(e[n])<0?r[n]=i.concat([e[n]]):r[n]=i:r[n]=[i,e[n]],r}),{})}function getListType(e){const t="ordered"===e?"ol":"ul";switch(e){case"checked":return[t,' data-list="checked"'];case"unchecked":return[t,' data-list="unchecked"'];default:return[t,""]}}function normalizeDelta(e){return e.reduce(((e,t)=>{if("string"==typeof t.insert){const r=t.insert.replace(/\r\n/g,"\n").replace(/\r/g,"\n");return e.insert(r,t.attributes)}return e.push(t)}),new Delta)}function shiftRange(e,t){let{index:r,length:n}=e;return new Range(r+t,n)}function splitOpLines(e){const t=[];return e.forEach((e=>{"string"==typeof e.insert?e.insert.split("\n").forEach(((r,n)=>{n&&t.push({insert:"\n",attributes:e.attributes}),r&&t.push({insert:r,attributes:e.attributes})})):t.push(e)})),t}const editor=editor_Editor;class Module{static DEFAULTS={};constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.quill=e,this.options=t}}const core_module=Module,GUARD_TEXT="\ufeff";class Embed extends EmbedBlot$1{constructor(e,t){super(e,t),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach((e=>{this.contentNode.appendChild(e)})),this.leftGuard=document.createTextNode(GUARD_TEXT),this.rightGuard=document.createTextNode(GUARD_TEXT),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(e,t){return e===this.leftGuard?0:e===this.rightGuard?1:super.index(e,t)}restore(e){let t,r=null;const n=e.data.split(GUARD_TEXT).join("");if(e===this.leftGuard)if(this.prev instanceof text_Text){const e=this.prev.length();this.prev.insertAt(e,n),r={startNode:this.prev.domNode,startOffset:e+n.length}}else t=document.createTextNode(n),this.parent.insertBefore(this.scroll.create(t),this),r={startNode:t,startOffset:n.length};else e===this.rightGuard&&(this.next instanceof text_Text?(this.next.insertAt(0,n),r={startNode:this.next.domNode,startOffset:n.length}):(t=document.createTextNode(n),this.parent.insertBefore(this.scroll.create(t),this.next),r={startNode:t,startOffset:n.length}));return e.data=GUARD_TEXT,r}update(e,t){e.forEach((e=>{if("characterData"===e.type&&(e.target===this.leftGuard||e.target===this.rightGuard)){const r=this.restore(e.target);r&&(t.range=r)}}))}}const blots_embed=Embed;class Composition{isComposing=!1;constructor(e,t){this.scroll=e,this.emitter=t,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",(e=>{this.isComposing||this.handleCompositionStart(e)})),this.scroll.domNode.addEventListener("compositionend",(e=>{this.isComposing&&queueMicrotask((()=>{this.handleCompositionEnd(e)}))}))}handleCompositionStart(e){const t=e.target instanceof Node?this.scroll.find(e.target,!0):null;!t||t instanceof blots_embed||(this.emitter.emit(core_emitter.events.COMPOSITION_BEFORE_START,e),this.scroll.batchStart(),this.emitter.emit(core_emitter.events.COMPOSITION_START,e),this.isComposing=!0)}handleCompositionEnd(e){this.emitter.emit(core_emitter.events.COMPOSITION_BEFORE_END,e),this.scroll.batchEnd(),this.emitter.emit(core_emitter.events.COMPOSITION_END,e),this.isComposing=!1}}const composition=Composition;class Theme{static DEFAULTS={modules:{}};static themes={default:Theme};modules={};constructor(e,t){this.quill=e,this.options=t}init(){Object.keys(this.options.modules).forEach((e=>{null==this.modules[e]&&this.addModule(e)}))}addModule(e){const t=this.quill.constructor.import(`modules/${e}`);return this.modules[e]=new t(this.quill,this.options.modules[e]||{}),this.modules[e]}}const core_theme=Theme,getParentElement=e=>e.parentElement||e.getRootNode().host||null,getElementRect=e=>{const t=e.getBoundingClientRect(),r="offsetWidth"in e&&Math.abs(t.width)/e.offsetWidth||1,n="offsetHeight"in e&&Math.abs(t.height)/e.offsetHeight||1;return{top:t.top,right:t.left+e.clientWidth*r,bottom:t.top+e.clientHeight*n,left:t.left}},paddingValueToInt=e=>{const t=parseInt(e,10);return Number.isNaN(t)?0:t},getScrollDistance=(e,t,r,n,i,a)=>e<r&&t>n?0:e<r?-(r-e+i):t>n?t-e>n-r?e+i-r:t-n+a:0,scrollRectIntoView=(e,t)=>{const r=e.ownerDocument;let n=t,i=e;for(;i;){const e=i===r.body,t=e?{top:0,right:window.visualViewport?.width??r.documentElement.clientWidth,bottom:window.visualViewport?.height??r.documentElement.clientHeight,left:0}:getElementRect(i),a=getComputedStyle(i),s=getScrollDistance(n.left,n.right,t.left,t.right,paddingValueToInt(a.scrollPaddingLeft),paddingValueToInt(a.scrollPaddingRight)),o=getScrollDistance(n.top,n.bottom,t.top,t.bottom,paddingValueToInt(a.scrollPaddingTop),paddingValueToInt(a.scrollPaddingBottom));if(s||o)if(e)r.defaultView?.scrollBy(s,o);else{const{scrollLeft:e,scrollTop:t}=i;o&&(i.scrollTop+=o),s&&(i.scrollLeft+=s);const r=i.scrollLeft-e,a=i.scrollTop-t;n={left:n.left-r,top:n.top-a,right:n.right-r,bottom:n.bottom-a}}i=e||"fixed"===a.position?null:getParentElement(i)}},utils_scrollRectIntoView=scrollRectIntoView,MAX_REGISTER_ITERATIONS=100,CORE_FORMATS=["block","break","cursor","inline","scroll","text"],createRegistryWithFormats=(e,t,r)=>{const n=new Registry;return CORE_FORMATS.forEach((e=>{const r=t.query(e);r&&n.register(r)})),e.forEach((e=>{let i=t.query(e);i||r.error(`Cannot register "${e}" specified in "formats" config. Are you sure it was registered?`);let a=0;for(;i;)if(n.register(i),i="blotName"in i?i.requiredContainer??null:null,a+=1,a>MAX_REGISTER_ITERATIONS){r.error(`Cycle detected in registering blot requiredContainer: "${e}"`);break}})),n},utils_createRegistryWithFormats=createRegistryWithFormats,quill_debug=core_logger("quill"),globalRegistry=new Registry;ParentBlot$1.uiClass="ql-ui";class Quill{static DEFAULTS={bounds:null,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0},placeholder:"",readOnly:!1,registry:globalRegistry,theme:"default"};static events=core_emitter.events;static sources=core_emitter.sources;static version="2.0.3";static imports={delta:Delta,parchment:parchment_namespaceObject,"core/module":core_module,"core/theme":core_theme};static debug(e){!0===e&&(e="log"),core_logger.level(e)}static find(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return instances.get(e)||globalRegistry.find(e,t)}static import(e){return null==this.imports[e]&&quill_debug.error(`Cannot import ${e}. Are you sure it was registered?`),this.imports[e]}static register(){if("string"!=typeof(arguments.length<=0?void 0:arguments[0])){const e=arguments.length<=0?void 0:arguments[0],t=!!(arguments.length<=1?void 0:arguments[1]),r="attrName"in e?e.attrName:e.blotName;"string"==typeof r?this.register(`formats/${r}`,e,t):Object.keys(e).forEach((r=>{this.register(r,e[r],t)}))}else{const e=arguments.length<=0?void 0:arguments[0],t=arguments.length<=1?void 0:arguments[1],r=!!(arguments.length<=2?void 0:arguments[2]);null==this.imports[e]||r||quill_debug.warn(`Overwriting ${e} with`,t),this.imports[e]=t,(e.startsWith("blots/")||e.startsWith("formats/"))&&t&&"boolean"!=typeof t&&"abstract"!==t.blotName&&globalRegistry.register(t),"function"==typeof t.register&&t.register(globalRegistry)}}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.options=expandConfig(e,t),this.container=this.options.container,null==this.container)return void quill_debug.error("Invalid Quill container",e);this.options.debug&&Quill.debug(this.options.debug);const r=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",instances.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new core_emitter;const n=ScrollBlot$1.blotName,i=this.options.registry.query(n);if(!i||!("blotName"in i))throw new Error(`Cannot initialize Quill without "${n}" blot`);if(this.scroll=new i(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new editor(this.scroll),this.selection=new selection(this.scroll,this.emitter),this.composition=new composition(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on(core_emitter.events.EDITOR_CHANGE,(e=>{e===core_emitter.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())})),this.emitter.on(core_emitter.events.SCROLL_UPDATE,((e,t)=>{const r=this.selection.lastRange,[n]=this.selection.getRange(),i=r&&n?{oldRange:r,newRange:n}:void 0;modify.call(this,(()=>this.editor.update(null,t,i)),e)})),this.emitter.on(core_emitter.events.SCROLL_EMBED_UPDATE,((e,t)=>{const r=this.selection.lastRange,[n]=this.selection.getRange(),i=r&&n?{oldRange:r,newRange:n}:void 0;modify.call(this,(()=>{const r=(new Delta).retain(e.offset(this)).retain({[e.statics.blotName]:t});return this.editor.update(r,[],i)}),Quill.sources.USER)})),r){const e=this.clipboard.convert({html:`${r}<p><br></p>`,text:"\n"});this.setContents(e)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof e){const t=e;(e=document.createElement("div")).classList.add(t)}return this.container.insertBefore(e,t),e}blur(){this.selection.setRange(null)}deleteText(e,t,r){return[e,t,,r]=overload(e,t,r),modify.call(this,(()=>this.editor.deleteText(e,t)),r,e,-1*t)}disable(){this.enable(!1)}editReadOnly(e){this.allowReadOnlyEdits=!0;const t=e();return this.allowReadOnlyEdits=!1,t}enable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.scroll.enable(e),this.container.classList.toggle("ql-disabled",!e)}focus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.selection.focus(),e.preventScroll||this.scrollSelectionIntoView()}format(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:core_emitter.sources.API;return modify.call(this,(()=>{const r=this.getSelection(!0);let n=new Delta;if(null==r)return n;if(this.scroll.query(e,Scope.BLOCK))n=this.editor.formatLine(r.index,r.length,{[e]:t});else{if(0===r.length)return this.selection.format(e,t),n;n=this.editor.formatText(r.index,r.length,{[e]:t})}return this.setSelection(r,core_emitter.sources.SILENT),n}),r)}formatLine(e,t,r,n,i){let a;return[e,t,a,i]=overload(e,t,r,n,i),modify.call(this,(()=>this.editor.formatLine(e,t,a)),i,e,0)}formatText(e,t,r,n,i){let a;return[e,t,a,i]=overload(e,t,r,n,i),modify.call(this,(()=>this.editor.formatText(e,t,a)),i,e,0)}getBounds(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=null;if(r="number"==typeof e?this.selection.getBounds(e,t):this.selection.getBounds(e.index,e.length),!r)return null;const n=this.container.getBoundingClientRect();return{bottom:r.bottom-n.top,height:r.height,left:r.left-n.left,right:r.right-n.left,top:r.top-n.top,width:r.width}}getContents(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLength()-e;return[e,t]=overload(e,t),this.editor.getContents(e,t)}getFormat(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSelection(!0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"number"==typeof e?this.editor.getFormat(e,t):this.editor.getFormat(e.index,e.length)}getIndex(e){return e.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(e){return this.scroll.leaf(e)}getLine(e){return this.scroll.line(e)}getLines(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;return"number"!=typeof e?this.scroll.lines(e.index,e.length):this.scroll.lines(e,t)}getModule(e){return this.theme.modules[e]}getSelection(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return"number"==typeof e&&(t=t??this.getLength()-e),[e,t]=overload(e,t),this.editor.getHTML(e,t)}getText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return"number"==typeof e&&(t=t??this.getLength()-e),[e,t]=overload(e,t),this.editor.getText(e,t)}hasFocus(){return this.selection.hasFocus()}insertEmbed(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Quill.sources.API;return modify.call(this,(()=>this.editor.insertEmbed(e,t,r)),n,e)}insertText(e,t,r,n,i){let a;return[e,,a,i]=overload(e,0,r,n,i),modify.call(this,(()=>this.editor.insertText(e,t,a)),i,e,t.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(e,t,r){return[e,t,,r]=overload(e,t,r),modify.call(this,(()=>this.editor.removeFormat(e,t)),r,e)}scrollRectIntoView(e){utils_scrollRectIntoView(this.root,e)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){const e=this.selection.lastRange,t=e&&this.selection.getBounds(e.index,e.length);t&&this.scrollRectIntoView(t)}setContents(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:core_emitter.sources.API;return modify.call(this,(()=>{e=new Delta(e);const t=this.getLength(),r=this.editor.deleteText(0,t),n=this.editor.insertContents(0,e),i=this.editor.deleteText(this.getLength()-1,1);return r.compose(n).compose(i)}),t)}setSelection(e,t,r){null==e?this.selection.setRange(null,t||Quill.sources.API):([e,t,,r]=overload(e,t,r),this.selection.setRange(new Range(Math.max(0,e),t),r),r!==core_emitter.sources.SILENT&&this.scrollSelectionIntoView())}setText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:core_emitter.sources.API;const r=(new Delta).insert(e);return this.setContents(r,t)}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:core_emitter.sources.USER;const t=this.scroll.update(e);return this.selection.update(e),t}updateContents(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:core_emitter.sources.API;return modify.call(this,(()=>(e=new Delta(e),this.editor.applyDelta(e))),t,!0)}}function resolveSelector(e){return"string"==typeof e?document.querySelector(e):e}function expandModuleConfig(e){return Object.entries(e??{}).reduce(((e,t)=>{let[r,n]=t;return{...e,[r]:!0===n?{}:n}}),{})}function omitUndefinedValuesFromOptions(e){return Object.fromEntries(Object.entries(e).filter((e=>void 0!==e[1])))}function expandConfig(e,t){const r=resolveSelector(e);if(!r)throw new Error("Invalid Quill container");const n=t.theme&&t.theme!==Quill.DEFAULTS.theme?Quill.import(`themes/${t.theme}`):core_theme;if(!n)throw new Error(`Invalid theme ${t.theme}. Did you register it?`);const{modules:i,...a}=Quill.DEFAULTS,{modules:s,...o}=n.DEFAULTS;let l=expandModuleConfig(t.modules);null!=l&&l.toolbar&&l.toolbar.constructor!==Object&&(l={...l,toolbar:{container:l.toolbar}});const c=lodash_es_merge({},expandModuleConfig(i),expandModuleConfig(s),l),d={...a,...omitUndefinedValuesFromOptions(o),...omitUndefinedValuesFromOptions(t)};let u=t.registry;return u?t.formats&&quill_debug.warn('Ignoring "formats" option because "registry" is specified'):u=t.formats?utils_createRegistryWithFormats(t.formats,d.registry,quill_debug):d.registry,{...d,registry:u,container:r,theme:n,modules:Object.entries(c).reduce(((e,t)=>{let[r,n]=t;if(!n)return e;const i=Quill.import(`modules/${r}`);return null==i?(quill_debug.error(`Cannot load ${r} module. Are you sure you registered it?`),e):{...e,[r]:lodash_es_merge({},i.DEFAULTS||{},n)}}),{}),bounds:resolveSelector(d.bounds)}}function modify(e,t,r,n){if(!this.isEnabled()&&t===core_emitter.sources.USER&&!this.allowReadOnlyEdits)return new Delta;let i=null==r?null:this.getSelection();const a=this.editor.delta,s=e();if(null!=i&&(!0===r&&(r=i.index),null==n?i=quill_shiftRange(i,s,t):0!==n&&(i=quill_shiftRange(i,r,n,t)),this.setSelection(i,core_emitter.sources.SILENT)),s.length()>0){const e=[core_emitter.events.TEXT_CHANGE,s,a,t];this.emitter.emit(core_emitter.events.EDITOR_CHANGE,...e),t!==core_emitter.sources.SILENT&&this.emitter.emit(...e)}return s}function overload(e,t,r,n,i){let a={};return"number"==typeof e.index&&"number"==typeof e.length?"number"!=typeof t?(i=n,n=r,r=t,t=e.length,e=e.index):(t=e.length,e=e.index):"number"!=typeof t&&(i=n,n=r,r=t,t=0),"object"==typeof r?(a=r,i=n):"string"==typeof r&&(null!=n?a[r]=n:i=r),[e,t,a,i=i||core_emitter.sources.API]}function quill_shiftRange(e,t,r,n){const i="number"==typeof r?r:0;if(null==e)return null;let a,s;return t&&"function"==typeof t.transformPosition?[a,s]=[e.index,e.index+e.length].map((e=>t.transformPosition(e,n!==core_emitter.sources.USER))):[a,s]=[e.index,e.index+e.length].map((e=>e<t||e===t&&n===core_emitter.sources.USER?e:i>=0?e+i:Math.max(t,e+i))),new Range(a,s-a)}class Container extends ContainerBlot$1{}const container=Container;function isLine(e){return e instanceof Block||e instanceof BlockEmbed}function isUpdatable(e){return"function"==typeof e.updateContent}class Scroll extends ScrollBlot$1{static blotName="scroll";static className="ql-editor";static tagName="DIV";static defaultChild=Block;static allowedChildren=[Block,BlockEmbed,container];constructor(e,t,r){let{emitter:n}=r;super(e,t),this.emitter=n,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",(e=>this.handleDragStart(e)))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;const e=this.batch;this.batch=!1,this.update(e)}emitMount(e){this.emitter.emit(core_emitter.events.SCROLL_BLOT_MOUNT,e)}emitUnmount(e){this.emitter.emit(core_emitter.events.SCROLL_BLOT_UNMOUNT,e)}emitEmbedUpdate(e,t){this.emitter.emit(core_emitter.events.SCROLL_EMBED_UPDATE,e,t)}deleteAt(e,t){const[r,n]=this.line(e),[i]=this.line(e+t);if(super.deleteAt(e,t),null!=i&&r!==i&&n>0){if(r instanceof BlockEmbed||i instanceof BlockEmbed)return void this.optimize();const e=i.children.head instanceof blots_break?null:i.children.head;r.moveChildren(i,e),r.remove()}this.optimize()}enable(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.domNode.setAttribute("contenteditable",e?"true":"false")}formatAt(e,t,r,n){super.formatAt(e,t,r,n),this.optimize()}insertAt(e,t,r){if(e>=this.length())if(null==r||null==this.scroll.query(t,Scope.BLOCK)){const e=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(e),null==r&&t.endsWith("\n")?e.insertAt(0,t.slice(0,-1),r):e.insertAt(0,t,r)}else{const e=this.scroll.create(t,r);this.appendChild(e)}else super.insertAt(e,t,r);this.optimize()}insertBefore(e,t){if(e.statics.scope===Scope.INLINE_BLOT){const r=this.scroll.create(this.statics.defaultChild.blotName);r.appendChild(e),super.insertBefore(r,t)}else super.insertBefore(e,t)}insertContents(e,t){const r=this.deltaToRenderBlocks(t.concat((new Delta).insert("\n"))),n=r.pop();if(null==n)return;this.batchStart();const i=r.shift();if(i){const t="block"===i.type&&(0===i.delta.length()||!this.descendant(BlockEmbed,e)[0]&&e<this.length()),r="block"===i.type?i.delta:(new Delta).insert({[i.key]:i.value});insertInlineContents(this,e,r);const n="block"===i.type?1:0,a=e+r.length()+n;t&&this.insertAt(a-1,"\n");const s=bubbleFormats(this.line(e)[0]),o=Delta.AttributeMap.diff(s,i.attributes)||{};Object.keys(o).forEach((e=>{this.formatAt(a-1,1,e,o[e])})),e=a}let[a,s]=this.children.find(e);r.length&&(a&&(a=a.split(s),s=0),r.forEach((e=>{if("block"===e.type)insertInlineContents(this.createBlock(e.attributes,a||void 0),0,e.delta);else{const t=this.create(e.key,e.value);this.insertBefore(t,a||void 0),Object.keys(e.attributes).forEach((r=>{t.format(r,e.attributes[r])}))}}))),"block"===n.type&&n.delta.length()&&insertInlineContents(this,a?a.offset(a.scroll)+s:this.length(),n.delta),this.batchEnd(),this.optimize()}isEnabled(){return"true"===this.domNode.getAttribute("contenteditable")}leaf(e){const t=this.path(e).pop();if(!t)return[null,-1];const[r,n]=t;return r instanceof LeafBlot$1?[r,n]:[null,-1]}line(e){return e===this.length()?this.line(e-1):this.descendant(isLine,e)}lines(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;const r=(e,t,n)=>{let i=[],a=n;return e.children.forEachAt(t,n,((e,t,n)=>{isLine(e)?i.push(e):e instanceof ContainerBlot$1&&(i=i.concat(r(e,t,a))),a-=n})),i};return r(this,e,t)}optimize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.batch||(super.optimize(e,t),e.length>0&&this.emitter.emit(core_emitter.events.SCROLL_OPTIMIZE,e,t))}path(e){return super.path(e).slice(1)}remove(){}update(e){if(this.batch)return void(Array.isArray(e)&&(this.batch=this.batch.concat(e)));let t=core_emitter.sources.USER;"string"==typeof e&&(t=e),Array.isArray(e)||(e=this.observer.takeRecords()),(e=e.filter((e=>{let{target:t}=e;const r=this.find(t,!0);return r&&!isUpdatable(r)}))).length>0&&this.emitter.emit(core_emitter.events.SCROLL_BEFORE_UPDATE,t,e),super.update(e.concat([])),e.length>0&&this.emitter.emit(core_emitter.events.SCROLL_UPDATE,t,e)}updateEmbedAt(e,t,r){const[n]=this.descendant((e=>e instanceof BlockEmbed),e);n&&n.statics.blotName===t&&isUpdatable(n)&&n.updateContent(r)}handleDragStart(e){e.preventDefault()}deltaToRenderBlocks(e){const t=[];let r=new Delta;return e.forEach((e=>{const n=e?.insert;if(n)if("string"==typeof n){const i=n.split("\n");i.slice(0,-1).forEach((n=>{r.insert(n,e.attributes),t.push({type:"block",delta:r,attributes:e.attributes??{}}),r=new Delta}));const a=i[i.length-1];a&&r.insert(a,e.attributes)}else{const i=Object.keys(n)[0];if(!i)return;this.query(i,Scope.INLINE)?r.push(e):(r.length()&&t.push({type:"block",delta:r,attributes:{}}),r=new Delta,t.push({type:"blockEmbed",key:i,value:n[i],attributes:e.attributes??{}}))}})),r.length()&&t.push({type:"block",delta:r,attributes:{}}),t}createBlock(e,t){let r;const n={};Object.entries(e).forEach((e=>{let[t,i]=e;null!=this.query(t,Scope.BLOCK&Scope.BLOT)?r=t:n[t]=i}));const i=this.create(r||this.statics.defaultChild.blotName,r?e[r]:void 0);this.insertBefore(i,t||void 0);const a=i.length();return Object.entries(n).forEach((e=>{let[t,r]=e;i.formatAt(0,a,t,r)})),i}}function insertInlineContents(e,t,r){r.reduce(((t,r)=>{const n=Delta.Op.length(r);let i=r.attributes||{};if(null!=r.insert)if("string"==typeof r.insert){const n=r.insert;e.insertAt(t,n);const[a]=e.descendant(LeafBlot$1,t),s=bubbleFormats(a);i=Delta.AttributeMap.diff(s,i)||{}}else if("object"==typeof r.insert){const n=Object.keys(r.insert)[0];if(null==n)return t;if(e.insertAt(t,n,r.insert[n]),null!=e.scroll.query(n,Scope.INLINE)){const[r]=e.descendant(LeafBlot$1,t),n=bubbleFormats(r);i=Delta.AttributeMap.diff(n,i)||{}}}return Object.keys(i).forEach((r=>{e.formatAt(t,n,r,i[r])})),t+n}),t)}const blots_scroll=Scroll,config={scope:Scope.BLOCK,whitelist:["right","center","justify"]},AlignAttribute=new Attributor("align","align",config),AlignClass=new ClassAttributor$1("align","ql-align",config),AlignStyle=new StyleAttributor$1("align","text-align",config);class ColorAttributor extends StyleAttributor$1{value(e){let t=super.value(e);return t.startsWith("rgb(")?(t=t.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),`#${t.split(",").map((e=>`00${parseInt(e,10).toString(16)}`.slice(-2))).join("")}`):t}}const ColorClass=new ClassAttributor$1("color","ql-color",{scope:Scope.INLINE}),ColorStyle=new ColorAttributor("color","color",{scope:Scope.INLINE}),BackgroundClass=new ClassAttributor$1("background","ql-bg",{scope:Scope.INLINE}),BackgroundStyle=new ColorAttributor("background","background-color",{scope:Scope.INLINE});class CodeBlockContainer extends container{static create(e){const t=super.create(e);return t.setAttribute("spellcheck","false"),t}code(e,t){return this.children.map((e=>e.length()<=1?"":e.domNode.innerText)).join("\n").slice(e,e+t)}html(e,t){return`<pre>\n${escapeText(this.code(e,t))}\n</pre>`}}class CodeBlock extends Block{static TAB="  ";static register(){Quill.register(CodeBlockContainer)}}class Code extends inline{}Code.blotName="code",Code.tagName="CODE",CodeBlock.blotName="code-block",CodeBlock.className="ql-code-block",CodeBlock.tagName="DIV",CodeBlockContainer.blotName="code-block-container",CodeBlockContainer.className="ql-code-block-container",CodeBlockContainer.tagName="DIV",CodeBlockContainer.allowedChildren=[CodeBlock],CodeBlock.allowedChildren=[text_Text,blots_break,cursor],CodeBlock.requiredContainer=CodeBlockContainer;const direction_config={scope:Scope.BLOCK,whitelist:["rtl"]},DirectionAttribute=new Attributor("direction","dir",direction_config),DirectionClass=new ClassAttributor$1("direction","ql-direction",direction_config),DirectionStyle=new StyleAttributor$1("direction","direction",direction_config),font_config={scope:Scope.INLINE,whitelist:["serif","monospace"]},FontClass=new ClassAttributor$1("font","ql-font",font_config);class FontStyleAttributor extends StyleAttributor$1{value(e){return super.value(e).replace(/["']/g,"")}}const FontStyle=new FontStyleAttributor("font","font-family",font_config),SizeClass=new ClassAttributor$1("size","ql-size",{scope:Scope.INLINE,whitelist:["small","large","huge"]}),SizeStyle=new StyleAttributor$1("size","font-size",{scope:Scope.INLINE,whitelist:["10px","18px","32px"]}),keyboard_debug=core_logger("quill:keyboard"),SHORTKEY=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey";class Keyboard extends core_module{static match(e,t){return!["altKey","ctrlKey","metaKey","shiftKey"].some((r=>!!t[r]!==e[r]&&null!==t[r]))&&(t.key===e.key||t.key===e.which)}constructor(e,t){super(e,t),this.bindings={},Object.keys(this.options.bindings).forEach((e=>{this.options.bindings[e]&&this.addBinding(this.options.bindings[e])})),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},(()=>{})),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=normalize(e);null!=n?("function"==typeof t&&(t={handler:t}),"function"==typeof r&&(r={handler:r}),(Array.isArray(n.key)?n.key:[n.key]).forEach((e=>{const i={...n,key:e,...t,...r};this.bindings[i.key]=this.bindings[i.key]||[],this.bindings[i.key].push(i)}))):keyboard_debug.warn("Attempted to add invalid keyboard binding",n)}listen(){this.quill.root.addEventListener("keydown",(e=>{if(e.defaultPrevented||e.isComposing)return;if(229===e.keyCode&&("Enter"===e.key||"Backspace"===e.key))return;const t=(this.bindings[e.key]||[]).concat(this.bindings[e.which]||[]).filter((t=>Keyboard.match(e,t)));if(0===t.length)return;const r=Quill.find(e.target,!0);if(r&&r.scroll!==this.quill.scroll)return;const n=this.quill.getSelection();if(null==n||!this.quill.hasFocus())return;const[i,a]=this.quill.getLine(n.index),[s,o]=this.quill.getLeaf(n.index),[l,c]=0===n.length?[s,o]:this.quill.getLeaf(n.index+n.length),d=s instanceof TextBlot$1?s.value().slice(0,o):"",u=l instanceof TextBlot$1?l.value().slice(c):"",p={collapsed:0===n.length,empty:0===n.length&&i.length()<=1,format:this.quill.getFormat(n),line:i,offset:a,prefix:d,suffix:u,event:e};t.some((e=>{if(null!=e.collapsed&&e.collapsed!==p.collapsed)return!1;if(null!=e.empty&&e.empty!==p.empty)return!1;if(null!=e.offset&&e.offset!==p.offset)return!1;if(Array.isArray(e.format)){if(e.format.every((e=>null==p.format[e])))return!1}else if("object"==typeof e.format&&!Object.keys(e.format).every((t=>!0===e.format[t]?null!=p.format[t]:!1===e.format[t]?null==p.format[t]:lodash_es_isEqual(e.format[t],p.format[t]))))return!1;return!(null!=e.prefix&&!e.prefix.test(p.prefix)||null!=e.suffix&&!e.suffix.test(p.suffix)||!0===e.handler.call(this,n,p,e))}))&&e.preventDefault()}))}handleBackspace(e,t){const r=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(t.prefix)?2:1;if(0===e.index||this.quill.getLength()<=1)return;let n={};const[i]=this.quill.getLine(e.index);let a=(new Delta).retain(e.index-r).delete(r);if(0===t.offset){const[t]=this.quill.getLine(e.index-1);if(t&&!("block"===t.statics.blotName&&t.length()<=1)){const t=i.formats(),r=this.quill.getFormat(e.index-1,1);if(n=Delta.AttributeMap.diff(t,r)||{},Object.keys(n).length>0){const t=(new Delta).retain(e.index+i.length()-2).retain(1,n);a=a.compose(t)}}}this.quill.updateContents(a,Quill.sources.USER),this.quill.focus()}handleDelete(e,t){const r=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(t.suffix)?2:1;if(e.index>=this.quill.getLength()-r)return;let n={};const[i]=this.quill.getLine(e.index);let a=(new Delta).retain(e.index).delete(r);if(t.offset>=i.length()-1){const[t]=this.quill.getLine(e.index+1);if(t){const r=i.formats(),s=this.quill.getFormat(e.index,1);n=Delta.AttributeMap.diff(r,s)||{},Object.keys(n).length>0&&(a=a.retain(t.length()-1).retain(1,n))}}this.quill.updateContents(a,Quill.sources.USER),this.quill.focus()}handleDeleteRange(e){deleteRange({range:e,quill:this.quill}),this.quill.focus()}handleEnter(e,t){const r=Object.keys(t.format).reduce(((e,r)=>(this.quill.scroll.query(r,Scope.BLOCK)&&!Array.isArray(t.format[r])&&(e[r]=t.format[r]),e)),{}),n=(new Delta).retain(e.index).delete(e.length).insert("\n",r);this.quill.updateContents(n,Quill.sources.USER),this.quill.setSelection(e.index+1,Quill.sources.SILENT),this.quill.focus()}}const keyboard_defaultOptions={bindings:{bold:makeFormatHandler("bold"),italic:makeFormatHandler("italic"),underline:makeFormatHandler("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(e,t){return!(!t.collapsed||0===t.offset)||(this.quill.format("indent","+1",Quill.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(e,t){return!(!t.collapsed||0===t.offset)||(this.quill.format("indent","-1",Quill.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(e,t){null!=t.format.indent?this.quill.format("indent","-1",Quill.sources.USER):null!=t.format.list&&this.quill.format("list",!1,Quill.sources.USER)}},"indent code-block":makeCodeBlockHandler(!0),"outdent code-block":makeCodeBlockHandler(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(e){this.quill.deleteText(e.index-1,1,Quill.sources.USER)}},tab:{key:"Tab",handler(e,t){if(t.format.table)return!0;this.quill.history.cutoff();const r=(new Delta).retain(e.index).delete(e.length).insert("\t");return this.quill.updateContents(r,Quill.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(e.index+1,Quill.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,Quill.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(e,t){const r={list:!1};t.format.indent&&(r.indent=!1),this.quill.formatLine(e.index,e.length,r,Quill.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(e){const[t,r]=this.quill.getLine(e.index),n={...t.formats(),list:"checked"},i=(new Delta).retain(e.index).insert("\n",n).retain(t.length()-r-1).retain(1,{list:"unchecked"});this.quill.updateContents(i,Quill.sources.USER),this.quill.setSelection(e.index+1,Quill.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(e,t){const[r,n]=this.quill.getLine(e.index),i=(new Delta).retain(e.index).insert("\n",t.format).retain(r.length()-n-1).retain(1,{header:null});this.quill.updateContents(i,Quill.sources.USER),this.quill.setSelection(e.index+1,Quill.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(e){const t=this.quill.getModule("table");if(t){const[r,n,i,a]=t.getTable(e),s=tableSide(r,n,i,a);if(null==s)return;let o=r.offset();if(s<0){const t=(new Delta).retain(o).insert("\n");this.quill.updateContents(t,Quill.sources.USER),this.quill.setSelection(e.index+1,e.length,Quill.sources.SILENT)}else if(s>0){o+=r.length();const e=(new Delta).retain(o).insert("\n");this.quill.updateContents(e,Quill.sources.USER),this.quill.setSelection(o,Quill.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(e,t){const{event:r,line:n}=t,i=n.offset(this.quill.scroll);r.shiftKey?this.quill.setSelection(i-1,Quill.sources.USER):this.quill.setSelection(i+n.length(),Quill.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(e,t){if(null==this.quill.scroll.query("list"))return!0;const{length:r}=t.prefix,[n,i]=this.quill.getLine(e.index);if(i>r)return!0;let a;switch(t.prefix.trim()){case"[]":case"[ ]":a="unchecked";break;case"[x]":a="checked";break;case"-":case"*":a="bullet";break;default:a="ordered"}this.quill.insertText(e.index," ",Quill.sources.USER),this.quill.history.cutoff();const s=(new Delta).retain(e.index-i).delete(r+1).retain(n.length()-2-i).retain(1,{list:a});return this.quill.updateContents(s,Quill.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(e.index-r,Quill.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(e){const[t,r]=this.quill.getLine(e.index);let n=2,i=t;for(;null!=i&&i.length()<=1&&i.formats()["code-block"];)if(i=i.prev,n-=1,n<=0){const n=(new Delta).retain(e.index+t.length()-r-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(n,Quill.sources.USER),this.quill.setSelection(e.index-1,Quill.sources.SILENT),!1}return!0}},"embed left":makeEmbedArrowHandler("ArrowLeft",!1),"embed left shift":makeEmbedArrowHandler("ArrowLeft",!0),"embed right":makeEmbedArrowHandler("ArrowRight",!1),"embed right shift":makeEmbedArrowHandler("ArrowRight",!0),"table down":makeTableArrowHandler(!1),"table up":makeTableArrowHandler(!0)}};function makeCodeBlockHandler(e){return{key:"Tab",shiftKey:!e,format:{"code-block":!0},handler(t,r){let{event:n}=r;const i=this.quill.scroll.query("code-block"),{TAB:a}=i;if(0===t.length&&!n.shiftKey)return this.quill.insertText(t.index,a,Quill.sources.USER),void this.quill.setSelection(t.index+a.length,Quill.sources.SILENT);const s=0===t.length?this.quill.getLines(t.index,1):this.quill.getLines(t);let{index:o,length:l}=t;s.forEach(((t,r)=>{e?(t.insertAt(0,a),0===r?o+=a.length:l+=a.length):t.domNode.textContent.startsWith(a)&&(t.deleteAt(0,a.length),0===r?o-=a.length:l-=a.length)})),this.quill.update(Quill.sources.USER),this.quill.setSelection(o,l,Quill.sources.SILENT)}}}function makeEmbedArrowHandler(e,t){const r="ArrowLeft"===e?"prefix":"suffix";return{key:e,shiftKey:t,altKey:null,[r]:/^$/,handler(r){let{index:n}=r;"ArrowRight"===e&&(n+=r.length+1);const[i]=this.quill.getLeaf(n);return!(i instanceof EmbedBlot$1&&("ArrowLeft"===e?t?this.quill.setSelection(r.index-1,r.length+1,Quill.sources.USER):this.quill.setSelection(r.index-1,Quill.sources.USER):t?this.quill.setSelection(r.index,r.length+1,Quill.sources.USER):this.quill.setSelection(r.index+r.length+1,Quill.sources.USER),1))}}}function makeFormatHandler(e){return{key:e[0],shortKey:!0,handler(t,r){this.quill.format(e,!r.format[e],Quill.sources.USER)}}}function makeTableArrowHandler(e){return{key:e?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(t,r){const n=e?"prev":"next",i=r.line,a=i.parent[n];if(null!=a){if("table-row"===a.statics.blotName){let e=a.children.head,t=i;for(;null!=t.prev;)t=t.prev,e=e.next;const n=e.offset(this.quill.scroll)+Math.min(r.offset,e.length()-1);this.quill.setSelection(n,0,Quill.sources.USER)}}else{const t=i.table()[n];null!=t&&(e?this.quill.setSelection(t.offset(this.quill.scroll)+t.length()-1,0,Quill.sources.USER):this.quill.setSelection(t.offset(this.quill.scroll),0,Quill.sources.USER))}return!1}}}function normalize(e){if("string"==typeof e||"number"==typeof e)e={key:e};else{if("object"!=typeof e)return null;e=lodash_es_cloneDeep(e)}return e.shortKey&&(e[SHORTKEY]=e.shortKey,delete e.shortKey),e}function deleteRange(e){let{quill:t,range:r}=e;const n=t.getLines(r);let i={};if(n.length>1){const e=n[0].formats(),t=n[n.length-1].formats();i=Delta.AttributeMap.diff(t,e)||{}}t.deleteText(r,Quill.sources.USER),Object.keys(i).length>0&&t.formatLine(r.index,1,i,Quill.sources.USER),t.setSelection(r.index,Quill.sources.SILENT)}function tableSide(e,t,r,n){return null==t.prev&&null==t.next?null==r.prev&&null==r.next?0===n?-1:1:null==r.prev?-1:1:null==t.prev?-1:null==t.next?1:null}Keyboard.DEFAULTS=keyboard_defaultOptions;const normalWeightRegexp=/font-weight:\s*normal/,blockTagNames=["P","OL","UL"],isBlockElement=e=>e&&blockTagNames.includes(e.tagName),normalizeEmptyLines=e=>{Array.from(e.querySelectorAll("br")).filter((e=>isBlockElement(e.previousElementSibling)&&isBlockElement(e.nextElementSibling))).forEach((e=>{e.parentNode?.removeChild(e)}))},normalizeFontWeight=e=>{Array.from(e.querySelectorAll('b[style*="font-weight"]')).filter((e=>e.getAttribute("style")?.match(normalWeightRegexp))).forEach((t=>{const r=e.createDocumentFragment();r.append(...t.childNodes),t.parentNode?.replaceChild(r,t)}))};function googleDocs_normalize(e){e.querySelector('[id^="docs-internal-guid-"]')&&(normalizeFontWeight(e),normalizeEmptyLines(e))}const ignoreRegexp=/\bmso-list:[^;]*ignore/i,idRegexp=/\bmso-list:[^;]*\bl(\d+)/i,indentRegexp=/\bmso-list:[^;]*\blevel(\d+)/i,parseListItem=(e,t)=>{const r=e.getAttribute("style"),n=r?.match(idRegexp);if(!n)return null;const i=Number(n[1]),a=r?.match(indentRegexp),s=a?Number(a[1]):1,o=new RegExp(`@list l${i}:level${s}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),l=t.match(o);return{id:i,indent:s,type:l&&"bullet"===l[1]?"bullet":"ordered",element:e}},normalizeListItem=e=>{const t=Array.from(e.querySelectorAll("[style*=mso-list]")),r=[],n=[];t.forEach((e=>{(e.getAttribute("style")||"").match(ignoreRegexp)?r.push(e):n.push(e)})),r.forEach((e=>e.parentNode?.removeChild(e)));const i=e.documentElement.innerHTML,a=n.map((e=>parseListItem(e,i))).filter((e=>e));for(;a.length;){const e=[];let t=a.shift();for(;t;)e.push(t),t=a.length&&a[0]?.element===t.element.nextElementSibling&&a[0].id===t.id?a.shift():null;const r=document.createElement("ul");e.forEach((e=>{const t=document.createElement("li");t.setAttribute("data-list",e.type),e.indent>1&&t.setAttribute("class","ql-indent-"+(e.indent-1)),t.innerHTML=e.element.innerHTML,r.appendChild(t)}));const n=e[0]?.element,{parentNode:i}=n??{};n&&i?.replaceChild(r,n),e.slice(1).forEach((e=>{let{element:t}=e;i?.removeChild(t)}))}};function msWord_normalize(e){"urn:schemas-microsoft-com:office:word"===e.documentElement.getAttribute("xmlns:w")&&normalizeListItem(e)}const NORMALIZERS=[msWord_normalize,googleDocs_normalize],normalizeExternalHTML=e=>{e.documentElement&&NORMALIZERS.forEach((t=>{t(e)}))},modules_normalizeExternalHTML=normalizeExternalHTML,clipboard_debug=core_logger("quill:clipboard"),CLIPBOARD_CONFIG=[[Node.TEXT_NODE,matchText],[Node.TEXT_NODE,matchNewline],["br",matchBreak],[Node.ELEMENT_NODE,matchNewline],[Node.ELEMENT_NODE,matchBlot],[Node.ELEMENT_NODE,matchAttributor],[Node.ELEMENT_NODE,matchStyles],["li",matchIndent],["ol, ul",matchList],["pre",matchCodeBlock],["tr",matchTable],["b",createMatchAlias("bold")],["i",createMatchAlias("italic")],["strike",createMatchAlias("strike")],["style",matchIgnore]],ATTRIBUTE_ATTRIBUTORS=[AlignAttribute,DirectionAttribute].reduce(((e,t)=>(e[t.keyName]=t,e)),{}),STYLE_ATTRIBUTORS=[AlignStyle,BackgroundStyle,ColorStyle,DirectionStyle,FontStyle,SizeStyle].reduce(((e,t)=>(e[t.keyName]=t,e)),{});class Clipboard extends core_module{static DEFAULTS={matchers:[]};constructor(e,t){super(e,t),this.quill.root.addEventListener("copy",(e=>this.onCaptureCopy(e,!1))),this.quill.root.addEventListener("cut",(e=>this.onCaptureCopy(e,!0))),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],CLIPBOARD_CONFIG.concat(this.options.matchers??[]).forEach((e=>{let[t,r]=e;this.addMatcher(t,r)}))}addMatcher(e,t){this.matchers.push([e,t])}convert(e){let{html:t,text:r}=e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n[CodeBlock.blotName])return(new Delta).insert(r||"",{[CodeBlock.blotName]:n[CodeBlock.blotName]});if(!t)return(new Delta).insert(r||"",n);const i=this.convertHTML(t);return deltaEndsWith(i,"\n")&&(null==i.ops[i.ops.length-1].attributes||n.table)?i.compose((new Delta).retain(i.length()-1).delete(1)):i}normalizeHTML(e){modules_normalizeExternalHTML(e)}convertHTML(e){const t=(new DOMParser).parseFromString(e,"text/html");this.normalizeHTML(t);const r=t.body,n=new WeakMap,[i,a]=this.prepareMatching(r,n);return traverse(this.quill.scroll,r,i,a,n)}dangerouslyPasteHTML(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Quill.sources.API;if("string"==typeof e){const r=this.convert({html:e,text:""});this.quill.setContents(r,t),this.quill.setSelection(0,Quill.sources.SILENT)}else{const n=this.convert({html:t,text:""});this.quill.updateContents((new Delta).retain(e).concat(n),r),this.quill.setSelection(e+n.length(),Quill.sources.SILENT)}}onCaptureCopy(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.defaultPrevented)return;e.preventDefault();const[r]=this.quill.selection.getRange();if(null==r)return;const{html:n,text:i}=this.onCopy(r,t);e.clipboardData?.setData("text/plain",i),e.clipboardData?.setData("text/html",n),t&&deleteRange({range:r,quill:this.quill})}normalizeURIList(e){return e.split(/\r?\n/).filter((e=>"#"!==e[0])).join("\n")}onCapturePaste(e){if(e.defaultPrevented||!this.quill.isEnabled())return;e.preventDefault();const t=this.quill.getSelection(!0);if(null==t)return;const r=e.clipboardData?.getData("text/html");let n=e.clipboardData?.getData("text/plain");if(!r&&!n){const t=e.clipboardData?.getData("text/uri-list");t&&(n=this.normalizeURIList(t))}const i=Array.from(e.clipboardData?.files||[]);if(!r&&i.length>0)this.quill.uploader.upload(t,i);else{if(r&&i.length>0){const e=(new DOMParser).parseFromString(r,"text/html");if(1===e.body.childElementCount&&"IMG"===e.body.firstElementChild?.tagName)return void this.quill.uploader.upload(t,i)}this.onPaste(t,{html:r,text:n})}}onCopy(e){const t=this.quill.getText(e);return{html:this.quill.getSemanticHTML(e),text:t}}onPaste(e,t){let{text:r,html:n}=t;const i=this.quill.getFormat(e.index),a=this.convert({text:r,html:n},i);clipboard_debug.log("onPaste",a,{text:r,html:n});const s=(new Delta).retain(e.index).delete(e.length).concat(a);this.quill.updateContents(s,Quill.sources.USER),this.quill.setSelection(s.length()-e.length,Quill.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(e,t){const r=[],n=[];return this.matchers.forEach((i=>{const[a,s]=i;switch(a){case Node.TEXT_NODE:n.push(s);break;case Node.ELEMENT_NODE:r.push(s);break;default:Array.from(e.querySelectorAll(a)).forEach((e=>{if(t.has(e)){const r=t.get(e);r?.push(s)}else t.set(e,[s])}))}})),[r,n]}}function applyFormat(e,t,r,n){return n.query(t)?e.reduce(((e,n)=>{if(!n.insert)return e;if(n.attributes&&n.attributes[t])return e.push(n);const i=r?{[t]:r}:{};return e.insert(n.insert,{...i,...n.attributes})}),new Delta):e}function deltaEndsWith(e,t){let r="";for(let n=e.ops.length-1;n>=0&&r.length<t.length;--n){const t=e.ops[n];if("string"!=typeof t.insert)break;r=t.insert+r}return r.slice(-1*t.length)===t}function clipboard_isLine(e,t){if(!(e instanceof Element))return!1;const r=t.query(e);return!(r&&r.prototype instanceof EmbedBlot$1)&&["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(e.tagName.toLowerCase())}function isBetweenInlineElements(e,t){return e.previousElementSibling&&e.nextElementSibling&&!clipboard_isLine(e.previousElementSibling,t)&&!clipboard_isLine(e.nextElementSibling,t)}const preNodes=new WeakMap;function isPre(e){return null!=e&&(preNodes.has(e)||("PRE"===e.tagName?preNodes.set(e,!0):preNodes.set(e,isPre(e.parentNode))),preNodes.get(e))}function traverse(e,t,r,n,i){return t.nodeType===t.TEXT_NODE?n.reduce(((r,n)=>n(t,r,e)),new Delta):t.nodeType===t.ELEMENT_NODE?Array.from(t.childNodes||[]).reduce(((a,s)=>{let o=traverse(e,s,r,n,i);return s.nodeType===t.ELEMENT_NODE&&(o=r.reduce(((t,r)=>r(s,t,e)),o),o=(i.get(s)||[]).reduce(((t,r)=>r(s,t,e)),o)),a.concat(o)}),new Delta):new Delta}function createMatchAlias(e){return(t,r,n)=>applyFormat(r,e,!0,n)}function matchAttributor(e,t,r){const n=Attributor.keys(e),i=ClassAttributor$1.keys(e),a=StyleAttributor$1.keys(e),s={};return n.concat(i).concat(a).forEach((t=>{let n=r.query(t,Scope.ATTRIBUTE);null!=n&&(s[n.attrName]=n.value(e),s[n.attrName])||(n=ATTRIBUTE_ATTRIBUTORS[t],null==n||n.attrName!==t&&n.keyName!==t||(s[n.attrName]=n.value(e)||void 0),n=STYLE_ATTRIBUTORS[t],null==n||n.attrName!==t&&n.keyName!==t||(n=STYLE_ATTRIBUTORS[t],s[n.attrName]=n.value(e)||void 0))})),Object.entries(s).reduce(((e,t)=>{let[n,i]=t;return applyFormat(e,n,i,r)}),t)}function matchBlot(e,t,r){const n=r.query(e);if(null==n)return t;if(n.prototype instanceof EmbedBlot$1){const t={},i=n.value(e);if(null!=i)return t[n.blotName]=i,(new Delta).insert(t,n.formats(e,r))}else if(n.prototype instanceof BlockBlot$1&&!deltaEndsWith(t,"\n")&&t.insert("\n"),"blotName"in n&&"formats"in n&&"function"==typeof n.formats)return applyFormat(t,n.blotName,n.formats(e,r),r);return t}function matchBreak(e,t){return deltaEndsWith(t,"\n")||t.insert("\n"),t}function matchCodeBlock(e,t,r){const n=r.query("code-block");return applyFormat(t,"code-block",!n||!("formats"in n)||"function"!=typeof n.formats||n.formats(e,r),r)}function matchIgnore(){return new Delta}function matchIndent(e,t,r){const n=r.query(e);if(null==n||"list"!==n.blotName||!deltaEndsWith(t,"\n"))return t;let i=-1,a=e.parentNode;for(;null!=a;)["OL","UL"].includes(a.tagName)&&(i+=1),a=a.parentNode;return i<=0?t:t.reduce(((e,t)=>t.insert?t.attributes&&"number"==typeof t.attributes.indent?e.push(t):e.insert(t.insert,{indent:i,...t.attributes||{}}):e),new Delta)}function matchList(e,t,r){const n=e;let i="OL"===n.tagName?"ordered":"bullet";const a=n.getAttribute("data-checked");return a&&(i="true"===a?"checked":"unchecked"),applyFormat(t,"list",i,r)}function matchNewline(e,t,r){if(!deltaEndsWith(t,"\n")){if(clipboard_isLine(e,r)&&(e.childNodes.length>0||e instanceof HTMLParagraphElement))return t.insert("\n");if(t.length()>0&&e.nextSibling){let n=e.nextSibling;for(;null!=n;){if(clipboard_isLine(n,r))return t.insert("\n");const e=r.query(n);if(e&&e.prototype instanceof BlockEmbed)return t.insert("\n");n=n.firstChild}}}return t}function matchStyles(e,t,r){const n={},i=e.style||{};return"italic"===i.fontStyle&&(n.italic=!0),"underline"===i.textDecoration&&(n.underline=!0),"line-through"===i.textDecoration&&(n.strike=!0),(i.fontWeight?.startsWith("bold")||parseInt(i.fontWeight,10)>=700)&&(n.bold=!0),t=Object.entries(n).reduce(((e,t)=>{let[n,i]=t;return applyFormat(e,n,i,r)}),t),parseFloat(i.textIndent||0)>0?(new Delta).insert("\t").concat(t):t}function matchTable(e,t,r){const n="TABLE"===e.parentElement?.tagName?e.parentElement:e.parentElement?.parentElement;return null!=n?applyFormat(t,"table",Array.from(n.querySelectorAll("tr")).indexOf(e)+1,r):t}function matchText(e,t,r){let n=e.data;if("O:P"===e.parentElement?.tagName)return t.insert(n.trim());if(!isPre(e)){if(0===n.trim().length&&n.includes("\n")&&!isBetweenInlineElements(e,r))return t;n=n.replace(/[^\S\u00a0]/g," "),n=n.replace(/ {2,}/g," "),(null==e.previousSibling&&null!=e.parentElement&&clipboard_isLine(e.parentElement,r)||e.previousSibling instanceof Element&&clipboard_isLine(e.previousSibling,r))&&(n=n.replace(/^ /,"")),(null==e.nextSibling&&null!=e.parentElement&&clipboard_isLine(e.parentElement,r)||e.nextSibling instanceof Element&&clipboard_isLine(e.nextSibling,r))&&(n=n.replace(/ $/,"")),n=n.replaceAll("Â "," ")}return t.insert(n)}class History extends core_module{static DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};lastRecorded=0;ignoreChange=!1;stack={undo:[],redo:[]};currentRange=null;constructor(e,t){super(e,t),this.quill.on(Quill.events.EDITOR_CHANGE,((e,t,r,n)=>{e===Quill.events.SELECTION_CHANGE?t&&n!==Quill.sources.SILENT&&(this.currentRange=t):e===Quill.events.TEXT_CHANGE&&(this.ignoreChange||(this.options.userOnly&&n!==Quill.sources.USER?this.transform(t):this.record(t,r)),this.currentRange=transformRange(this.currentRange,t))})),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",(e=>{"historyUndo"===e.inputType?(this.undo(),e.preventDefault()):"historyRedo"===e.inputType&&(this.redo(),e.preventDefault())}))}change(e,t){if(0===this.stack[e].length)return;const r=this.stack[e].pop();if(!r)return;const n=this.quill.getContents(),i=r.delta.invert(n);this.stack[t].push({delta:i,range:transformRange(r.range,i)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(r.delta,Quill.sources.USER),this.ignoreChange=!1,this.restoreSelection(r)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(e,t){if(0===e.ops.length)return;this.stack.redo=[];let r=e.invert(t),n=this.currentRange;const i=Date.now();if(this.lastRecorded+this.options.delay>i&&this.stack.undo.length>0){const e=this.stack.undo.pop();e&&(r=r.compose(e.delta),n=e.range)}else this.lastRecorded=i;0!==r.length()&&(this.stack.undo.push({delta:r,range:n}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(e){transformStack(this.stack.undo,e),transformStack(this.stack.redo,e)}undo(){this.change("undo","redo")}restoreSelection(e){if(e.range)this.quill.setSelection(e.range,Quill.sources.USER);else{const t=getLastChangeIndex(this.quill.scroll,e.delta);this.quill.setSelection(t,Quill.sources.USER)}}}function transformStack(e,t){let r=t;for(let t=e.length-1;t>=0;t-=1){const n=e[t];e[t]={delta:r.transform(n.delta,!0),range:n.range&&transformRange(n.range,r)},r=n.delta.transform(r),0===e[t].delta.length()&&e.splice(t,1)}}function endsWithNewlineChange(e,t){const r=t.ops[t.ops.length-1];return null!=r&&(null!=r.insert?"string"==typeof r.insert&&r.insert.endsWith("\n"):null!=r.attributes&&Object.keys(r.attributes).some((t=>null!=e.query(t,Scope.BLOCK))))}function getLastChangeIndex(e,t){const r=t.reduce(((e,t)=>e+(t.delete||0)),0);let n=t.length()-r;return endsWithNewlineChange(e,t)&&(n-=1),n}function transformRange(e,t){if(!e)return e;const r=t.transformPosition(e.index);return{index:r,length:t.transformPosition(e.index+e.length)-r}}class Uploader extends core_module{constructor(e,t){super(e,t),e.root.addEventListener("drop",(t=>{t.preventDefault();let r=null;if(document.caretRangeFromPoint)r=document.caretRangeFromPoint(t.clientX,t.clientY);else if(document.caretPositionFromPoint){const e=document.caretPositionFromPoint(t.clientX,t.clientY);r=document.createRange(),r.setStart(e.offsetNode,e.offset),r.setEnd(e.offsetNode,e.offset)}const n=r&&e.selection.normalizeNative(r);if(n){const r=e.selection.normalizedToRange(n);t.dataTransfer?.files&&this.upload(r,t.dataTransfer.files)}}))}upload(e,t){const r=[];Array.from(t).forEach((e=>{e&&this.options.mimetypes?.includes(e.type)&&r.push(e)})),r.length>0&&this.options.handler.call(this,e,r)}}Uploader.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(e,t){if(!this.quill.scroll.query("image"))return;const r=t.map((e=>new Promise((t=>{const r=new FileReader;r.onload=()=>{t(r.result)},r.readAsDataURL(e)}))));Promise.all(r).then((t=>{const r=t.reduce(((e,t)=>e.insert({image:t})),(new Delta).retain(e.index).delete(e.length));this.quill.updateContents(r,core_emitter.sources.USER),this.quill.setSelection(e.index+t.length,core_emitter.sources.SILENT)}))}};const uploader=Uploader,INSERT_TYPES=["insertText","insertReplacementText"];class Input extends core_module{constructor(e,t){super(e,t),e.root.addEventListener("beforeinput",(e=>{this.handleBeforeInput(e)})),/Android/i.test(navigator.userAgent)||e.on(Quill.events.COMPOSITION_BEFORE_START,(()=>{this.handleCompositionStart()}))}deleteRange(e){deleteRange({range:e,quill:this.quill})}replaceText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(0===e.length)return!1;if(t){const r=this.quill.getFormat(e.index,1);this.deleteRange(e),this.quill.updateContents((new Delta).retain(e.index).insert(t,r),Quill.sources.USER)}else this.deleteRange(e);return this.quill.setSelection(e.index+t.length,0,Quill.sources.SILENT),!0}handleBeforeInput(e){if(this.quill.composition.isComposing||e.defaultPrevented||!INSERT_TYPES.includes(e.inputType))return;const t=e.getTargetRanges?e.getTargetRanges()[0]:null;if(!t||!0===t.collapsed)return;const r=getPlainTextFromInputEvent(e);if(null==r)return;const n=this.quill.selection.normalizeNative(t),i=n?this.quill.selection.normalizedToRange(n):null;i&&this.replaceText(i,r)&&e.preventDefault()}handleCompositionStart(){const e=this.quill.getSelection();e&&this.replaceText(e)}}function getPlainTextFromInputEvent(e){return"string"==typeof e.data?e.data:e.dataTransfer?.types.includes("text/plain")?e.dataTransfer.getData("text/plain"):null}const input=Input,isMac=/Mac/i.test(navigator.platform),TTL_FOR_VALID_SELECTION_CHANGE=100,canMoveCaretBeforeUINode=e=>"ArrowLeft"===e.key||"ArrowRight"===e.key||"ArrowUp"===e.key||"ArrowDown"===e.key||"Home"===e.key||!(!isMac||"a"!==e.key||!0!==e.ctrlKey);class UINode extends core_module{isListening=!1;selectionChangeDeadline=0;constructor(e,t){super(e,t),this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(e,t){let{line:r,event:n}=t;if(!(r instanceof ParentBlot$1&&r.uiNode))return!0;const i="rtl"===getComputedStyle(r.domNode).direction;return!!(i&&"ArrowRight"!==n.key||!i&&"ArrowLeft"!==n.key)||(this.quill.setSelection(e.index-1,e.length+(n.shiftKey?1:0),Quill.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",(e=>{!e.defaultPrevented&&canMoveCaretBeforeUINode(e)&&this.ensureListeningToSelectionChange()}))}ensureListeningToSelectionChange(){this.selectionChangeDeadline=Date.now()+TTL_FOR_VALID_SELECTION_CHANGE,this.isListening||(this.isListening=!0,document.addEventListener("selectionchange",(()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()}),{once:!0}))}handleSelectionChange(){const e=document.getSelection();if(!e)return;const t=e.getRangeAt(0);if(!0!==t.collapsed||0!==t.startOffset)return;const r=this.quill.scroll.find(t.startContainer);if(!(r instanceof ParentBlot$1&&r.uiNode))return;const n=document.createRange();n.setStartAfter(r.uiNode),n.setEndAfter(r.uiNode),e.removeAllRanges(),e.addRange(n)}}const uiNode=UINode;Quill.register({"blots/block":Block,"blots/block/embed":BlockEmbed,"blots/break":blots_break,"blots/container":container,"blots/cursor":cursor,"blots/embed":blots_embed,"blots/inline":inline,"blots/scroll":blots_scroll,"blots/text":text_Text,"modules/clipboard":Clipboard,"modules/history":History,"modules/keyboard":Keyboard,"modules/uploader":uploader,"modules/input":input,"modules/uiNode":uiNode});const quill_core=Quill;class IndentAttributor extends ClassAttributor$1{add(e,t){let r=0;if("+1"===t||"-1"===t){const n=this.value(e)||0;r="+1"===t?n+1:n-1}else"number"==typeof t&&(r=t);return 0===r?(this.remove(e),!0):super.add(e,r.toString())}canAdd(e,t){return super.canAdd(e,t)||super.canAdd(e,parseInt(t,10))}value(e){return parseInt(super.value(e),10)||void 0}}const IndentClass=new IndentAttributor("indent","ql-indent",{scope:Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]}),indent=IndentClass;class Blockquote extends Block{static blotName="blockquote";static tagName="blockquote"}const blockquote=Blockquote;class header_Header extends Block{static blotName="header";static tagName=["H1","H2","H3","H4","H5","H6"];static formats(e){return this.tagName.indexOf(e.tagName)+1}}const header=header_Header;class ListContainer extends container{}ListContainer.blotName="list-container",ListContainer.tagName="OL";class list_ListItem extends Block{static create(e){const t=super.create();return t.setAttribute("data-list",e),t}static formats(e){return e.getAttribute("data-list")||void 0}static register(){Quill.register(ListContainer)}constructor(e,t){super(e,t);const r=t.ownerDocument.createElement("span"),n=r=>{if(!e.isEnabled())return;const n=this.statics.formats(t,e);"checked"===n?(this.format("list","unchecked"),r.preventDefault()):"unchecked"===n&&(this.format("list","checked"),r.preventDefault())};r.addEventListener("mousedown",n),r.addEventListener("touchstart",n),this.attachUI(r)}format(e,t){e===this.statics.blotName&&t?this.domNode.setAttribute("data-list",t):super.format(e,t)}}list_ListItem.blotName="list",list_ListItem.tagName="LI",ListContainer.allowedChildren=[list_ListItem],list_ListItem.requiredContainer=ListContainer;class Bold extends inline{static blotName="bold";static tagName=["STRONG","B"];static create(){return super.create()}static formats(){return!0}optimize(e){super.optimize(e),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}const bold=Bold;class Italic extends bold{static blotName="italic";static tagName=["EM","I"]}const italic=Italic;class Link extends inline{static blotName="link";static tagName="A";static SANITIZED_URL="about:blank";static PROTOCOL_WHITELIST=["http","https","mailto","tel","sms"];static create(e){const t=super.create(e);return t.setAttribute("href",this.sanitize(e)),t.setAttribute("rel","noopener noreferrer"),t.setAttribute("target","_blank"),t}static formats(e){return e.getAttribute("href")}static sanitize(e){return sanitize(e,this.PROTOCOL_WHITELIST)?e:this.SANITIZED_URL}format(e,t){e===this.statics.blotName&&t?this.domNode.setAttribute("href",this.constructor.sanitize(t)):super.format(e,t)}}function sanitize(e,t){const r=document.createElement("a");r.href=e;const n=r.href.slice(0,r.href.indexOf(":"));return t.indexOf(n)>-1}class Script extends inline{static blotName="script";static tagName=["SUB","SUP"];static create(e){return"super"===e?document.createElement("sup"):"sub"===e?document.createElement("sub"):super.create(e)}static formats(e){return"SUB"===e.tagName?"sub":"SUP"===e.tagName?"super":void 0}}const script=Script;class Strike extends bold{static blotName="strike";static tagName=["S","STRIKE"]}const strike=Strike;class Underline extends inline{static blotName="underline";static tagName="U"}const underline=Underline;class Formula extends blots_embed{static blotName="formula";static className="ql-formula";static tagName="SPAN";static create(e){if(null==window.katex)throw new Error("Formula module requires KaTeX.");const t=super.create(e);return"string"==typeof e&&(window.katex.render(e,t,{throwOnError:!1,errorColor:"#f00"}),t.setAttribute("data-value",e)),t}static value(e){return e.getAttribute("data-value")}html(){const{formula:e}=this.value();return`<span>${e}</span>`}}const formula=Formula,ATTRIBUTES=["alt","height","width"];class image_Image extends EmbedBlot$1{static blotName="image";static tagName="IMG";static create(e){const t=super.create(e);return"string"==typeof e&&t.setAttribute("src",this.sanitize(e)),t}static formats(e){return ATTRIBUTES.reduce(((t,r)=>(e.hasAttribute(r)&&(t[r]=e.getAttribute(r)),t)),{})}static match(e){return/\.(jpe?g|gif|png)$/.test(e)||/^data:image\/.+;base64/.test(e)}static sanitize(e){return sanitize(e,["http","https","data"])?e:"//:0"}static value(e){return e.getAttribute("src")}format(e,t){ATTRIBUTES.indexOf(e)>-1?t?this.domNode.setAttribute(e,t):this.domNode.removeAttribute(e):super.format(e,t)}}const formats_image=image_Image,video_ATTRIBUTES=["height","width"];class Video extends BlockEmbed{static blotName="video";static className="ql-video";static tagName="IFRAME";static create(e){const t=super.create(e);return t.setAttribute("frameborder","0"),t.setAttribute("allowfullscreen","true"),t.setAttribute("src",this.sanitize(e)),t}static formats(e){return video_ATTRIBUTES.reduce(((t,r)=>(e.hasAttribute(r)&&(t[r]=e.getAttribute(r)),t)),{})}static sanitize(e){return Link.sanitize(e)}static value(e){return e.getAttribute("src")}format(e,t){video_ATTRIBUTES.indexOf(e)>-1?t?this.domNode.setAttribute(e,t):this.domNode.removeAttribute(e):super.format(e,t)}html(){const{video:e}=this.value();return`<a href="${e}">${e}</a>`}}const video=Video,TokenAttributor=new ClassAttributor$1("code-token","hljs",{scope:Scope.INLINE});class CodeToken extends inline{static formats(e,t){for(;null!=e&&e!==t.domNode;){if(e.classList&&e.classList.contains(CodeBlock.className))return super.formats(e,t);e=e.parentNode}}constructor(e,t,r){super(e,t,r),TokenAttributor.add(this.domNode,r)}format(e,t){e!==CodeToken.blotName?super.format(e,t):t?TokenAttributor.add(this.domNode,t):(TokenAttributor.remove(this.domNode),this.domNode.classList.remove(this.statics.className))}optimize(){super.optimize(...arguments),TokenAttributor.value(this.domNode)||this.unwrap()}}CodeToken.blotName="code-token",CodeToken.className="ql-token";class SyntaxCodeBlock extends CodeBlock{static create(e){const t=super.create(e);return"string"==typeof e&&t.setAttribute("data-language",e),t}static formats(e){return e.getAttribute("data-language")||"plain"}static register(){}format(e,t){e===this.statics.blotName&&t?this.domNode.setAttribute("data-language",t):super.format(e,t)}replaceWith(e,t){return this.formatAt(0,this.length(),CodeToken.blotName,!1),super.replaceWith(e,t)}}class SyntaxCodeBlockContainer extends CodeBlockContainer{attach(){super.attach(),this.forceNext=!1,this.scroll.emitMount(this)}format(e,t){e===SyntaxCodeBlock.blotName&&(this.forceNext=!0,this.children.forEach((r=>{r.format(e,t)})))}formatAt(e,t,r,n){r===SyntaxCodeBlock.blotName&&(this.forceNext=!0),super.formatAt(e,t,r,n)}highlight(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null==this.children.head)return;const r=`${Array.from(this.domNode.childNodes).filter((e=>e!==this.uiNode)).map((e=>e.textContent)).join("\n")}\n`,n=SyntaxCodeBlock.formats(this.children.head.domNode);if(t||this.forceNext||this.cachedText!==r){if(r.trim().length>0||null==this.cachedText){const t=this.children.reduce(((e,t)=>e.concat(blockDelta(t,!1))),new Delta),i=e(r,n);t.diff(i).reduce(((e,t)=>{let{retain:r,attributes:n}=t;return r?(n&&Object.keys(n).forEach((t=>{[SyntaxCodeBlock.blotName,CodeToken.blotName].includes(t)&&this.formatAt(e,r,t,n[t])})),e+r):e}),0)}this.cachedText=r,this.forceNext=!1}}html(e,t){const[r]=this.children.find(e);return`<pre data-language="${r?SyntaxCodeBlock.formats(r.domNode):"plain"}">\n${escapeText(this.code(e,t))}\n</pre>`}optimize(e){if(super.optimize(e),null!=this.parent&&null!=this.children.head&&null!=this.uiNode){const e=SyntaxCodeBlock.formats(this.children.head.domNode);e!==this.uiNode.value&&(this.uiNode.value=e)}}}SyntaxCodeBlockContainer.allowedChildren=[SyntaxCodeBlock],SyntaxCodeBlock.requiredContainer=SyntaxCodeBlockContainer,SyntaxCodeBlock.allowedChildren=[CodeToken,cursor,text_Text,blots_break];const highlight=(e,t,r)=>{if("string"==typeof e.versionString){const n=e.versionString.split(".")[0];if(parseInt(n,10)>=11)return e.highlight(r,{language:t}).value}return e.highlight(t,r).value};class Syntax extends core_module{static register(){Quill.register(CodeToken,!0),Quill.register(SyntaxCodeBlock,!0),Quill.register(SyntaxCodeBlockContainer,!0)}constructor(e,t){if(super(e,t),null==this.options.hljs)throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");this.languages=this.options.languages.reduce(((e,t)=>{let{key:r}=t;return e[r]=!0,e}),{}),this.highlightBlot=this.highlightBlot.bind(this),this.initListener(),this.initTimer()}initListener(){this.quill.on(Quill.events.SCROLL_BLOT_MOUNT,(e=>{if(!(e instanceof SyntaxCodeBlockContainer))return;const t=this.quill.root.ownerDocument.createElement("select");this.options.languages.forEach((e=>{let{key:r,label:n}=e;const i=t.ownerDocument.createElement("option");i.textContent=n,i.setAttribute("value",r),t.appendChild(i)})),t.addEventListener("change",(()=>{e.format(SyntaxCodeBlock.blotName,t.value),this.quill.root.focus(),this.highlight(e,!0)})),null==e.uiNode&&(e.attachUI(t),e.children.head&&(t.value=SyntaxCodeBlock.formats(e.children.head.domNode)))}))}initTimer(){let e=null;this.quill.on(Quill.events.SCROLL_OPTIMIZE,(()=>{e&&clearTimeout(e),e=setTimeout((()=>{this.highlight(),e=null}),this.options.interval)}))}highlight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.quill.selection.composing)return;this.quill.update(Quill.sources.USER);const r=this.quill.getSelection();(null==e?this.quill.scroll.descendants(SyntaxCodeBlockContainer):[e]).forEach((e=>{e.highlight(this.highlightBlot,t)})),this.quill.update(Quill.sources.SILENT),null!=r&&this.quill.setSelection(r,Quill.sources.SILENT)}highlightBlot(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"plain";if(t=this.languages[t]?t:"plain","plain"===t)return escapeText(e).split("\n").reduce(((e,r,n)=>(0!==n&&e.insert("\n",{[CodeBlock.blotName]:t}),e.insert(r))),new Delta);const r=this.quill.root.ownerDocument.createElement("div");return r.classList.add(CodeBlock.className),r.innerHTML=highlight(this.options.hljs,t,e),traverse(this.quill.scroll,r,[(e,t)=>{const r=TokenAttributor.value(e);return r?t.compose((new Delta).retain(t.length(),{[CodeToken.blotName]:r})):t}],[(e,r)=>e.data.split("\n").reduce(((e,r,n)=>(0!==n&&e.insert("\n",{[CodeBlock.blotName]:t}),e.insert(r))),r)],new WeakMap)}}Syntax.DEFAULTS={hljs:window.hljs,interval:1e3,languages:[{key:"plain",label:"Plain"},{key:"bash",label:"Bash"},{key:"cpp",label:"C++"},{key:"cs",label:"C#"},{key:"css",label:"CSS"},{key:"diff",label:"Diff"},{key:"xml",label:"HTML/XML"},{key:"java",label:"Java"},{key:"javascript",label:"JavaScript"},{key:"markdown",label:"Markdown"},{key:"php",label:"PHP"},{key:"python",label:"Python"},{key:"ruby",label:"Ruby"},{key:"sql",label:"SQL"}]};class TableCell extends Block{static blotName="table";static tagName="TD";static create(e){const t=super.create();return e?t.setAttribute("data-row",e):t.setAttribute("data-row",tableId()),t}static formats(e){if(e.hasAttribute("data-row"))return e.getAttribute("data-row")}cellOffset(){return this.parent?this.parent.children.indexOf(this):-1}format(e,t){e===TableCell.blotName&&t?this.domNode.setAttribute("data-row",t):super.format(e,t)}row(){return this.parent}rowOffset(){return this.row()?this.row().rowOffset():-1}table(){return this.row()&&this.row().table()}}class TableRow extends container{static blotName="table-row";static tagName="TR";checkMerge(){if(super.checkMerge()&&null!=this.next.children.head){const e=this.children.head.formats(),t=this.children.tail.formats(),r=this.next.children.head.formats(),n=this.next.children.tail.formats();return e.table===t.table&&e.table===r.table&&e.table===n.table}return!1}optimize(e){super.optimize(e),this.children.forEach((e=>{if(null==e.next)return;const t=e.formats(),r=e.next.formats();if(t.table!==r.table){const t=this.splitAfter(e);t&&t.optimize(),this.prev&&this.prev.optimize()}}))}rowOffset(){return this.parent?this.parent.children.indexOf(this):-1}table(){return this.parent&&this.parent.parent}}class TableBody extends container{static blotName="table-body";static tagName="TBODY"}class TableContainer extends container{static blotName="table-container";static tagName="TABLE";balanceCells(){const e=this.descendants(TableRow),t=e.reduce(((e,t)=>Math.max(t.children.length,e)),0);e.forEach((e=>{new Array(t-e.children.length).fill(0).forEach((()=>{let t;null!=e.children.head&&(t=TableCell.formats(e.children.head.domNode));const r=this.scroll.create(TableCell.blotName,t);e.appendChild(r),r.optimize()}))}))}cells(e){return this.rows().map((t=>t.children.at(e)))}deleteColumn(e){const[t]=this.descendant(TableBody);null!=t&&null!=t.children.head&&t.children.forEach((t=>{const r=t.children.at(e);null!=r&&r.remove()}))}insertColumn(e){const[t]=this.descendant(TableBody);null!=t&&null!=t.children.head&&t.children.forEach((t=>{const r=t.children.at(e),n=TableCell.formats(t.children.head.domNode),i=this.scroll.create(TableCell.blotName,n);t.insertBefore(i,r)}))}insertRow(e){const[t]=this.descendant(TableBody);if(null==t||null==t.children.head)return;const r=tableId(),n=this.scroll.create(TableRow.blotName);t.children.head.children.forEach((()=>{const e=this.scroll.create(TableCell.blotName,r);n.appendChild(e)}));const i=t.children.at(e);t.insertBefore(n,i)}rows(){const e=this.children.head;return null==e?[]:e.children.map((e=>e))}}function tableId(){return`row-${Math.random().toString(36).slice(2,6)}`}TableContainer.allowedChildren=[TableBody],TableBody.requiredContainer=TableContainer,TableBody.allowedChildren=[TableRow],TableRow.requiredContainer=TableBody,TableRow.allowedChildren=[TableCell],TableCell.requiredContainer=TableRow;class Table extends core_module{static register(){Quill.register(TableCell),Quill.register(TableRow),Quill.register(TableBody),Quill.register(TableContainer)}constructor(){super(...arguments),this.listenBalanceCells()}balanceTables(){this.quill.scroll.descendants(TableContainer).forEach((e=>{e.balanceCells()}))}deleteColumn(){const[e,,t]=this.getTable();null!=t&&(e.deleteColumn(t.cellOffset()),this.quill.update(Quill.sources.USER))}deleteRow(){const[,e]=this.getTable();null!=e&&(e.remove(),this.quill.update(Quill.sources.USER))}deleteTable(){const[e]=this.getTable();if(null==e)return;const t=e.offset();e.remove(),this.quill.update(Quill.sources.USER),this.quill.setSelection(t,Quill.sources.SILENT)}getTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.quill.getSelection();if(null==e)return[null,null,null,-1];const[t,r]=this.quill.getLine(e.index);if(null==t||t.statics.blotName!==TableCell.blotName)return[null,null,null,-1];const n=t.parent;return[n.parent.parent,n,t,r]}insertColumn(e){const t=this.quill.getSelection();if(!t)return;const[r,n,i]=this.getTable(t);if(null==i)return;const a=i.cellOffset();r.insertColumn(a+e),this.quill.update(Quill.sources.USER);let s=n.rowOffset();0===e&&(s+=1),this.quill.setSelection(t.index+s,t.length,Quill.sources.SILENT)}insertColumnLeft(){this.insertColumn(0)}insertColumnRight(){this.insertColumn(1)}insertRow(e){const t=this.quill.getSelection();if(!t)return;const[r,n,i]=this.getTable(t);if(null==i)return;const a=n.rowOffset();r.insertRow(a+e),this.quill.update(Quill.sources.USER),e>0?this.quill.setSelection(t,Quill.sources.SILENT):this.quill.setSelection(t.index+n.children.length,t.length,Quill.sources.SILENT)}insertRowAbove(){this.insertRow(0)}insertRowBelow(){this.insertRow(1)}insertTable(e,t){const r=this.quill.getSelection();if(null==r)return;const n=new Array(e).fill(0).reduce((e=>{const r=new Array(t).fill("\n").join("");return e.insert(r,{table:tableId()})}),(new Delta).retain(r.index));this.quill.updateContents(n,Quill.sources.USER),this.quill.setSelection(r.index,Quill.sources.SILENT),this.balanceTables()}listenBalanceCells(){this.quill.on(Quill.events.SCROLL_OPTIMIZE,(e=>{e.some((e=>!!["TD","TR","TBODY","TABLE"].includes(e.target.tagName)&&(this.quill.once(Quill.events.TEXT_CHANGE,((e,t,r)=>{r===Quill.sources.USER&&this.balanceTables()})),!0)))}))}}const table=Table,toolbar_debug=core_logger("quill:toolbar");class Toolbar extends core_module{constructor(e,t){if(super(e,t),Array.isArray(this.options.container)){const t=document.createElement("div");t.setAttribute("role","toolbar"),addControls(t,this.options.container),e.container?.parentNode?.insertBefore(t,e.container),this.container=t}else"string"==typeof this.options.container?this.container=document.querySelector(this.options.container):this.container=this.options.container;this.container instanceof HTMLElement?(this.container.classList.add("ql-toolbar"),this.controls=[],this.handlers={},this.options.handlers&&Object.keys(this.options.handlers).forEach((e=>{const t=this.options.handlers?.[e];t&&this.addHandler(e,t)})),Array.from(this.container.querySelectorAll("button, select")).forEach((e=>{this.attach(e)})),this.quill.on(Quill.events.EDITOR_CHANGE,(()=>{const[e]=this.quill.selection.getRange();this.update(e)}))):toolbar_debug.error("Container required for toolbar",this.options)}addHandler(e,t){this.handlers[e]=t}attach(e){let t=Array.from(e.classList).find((e=>0===e.indexOf("ql-")));if(!t)return;if(t=t.slice(3),"BUTTON"===e.tagName&&e.setAttribute("type","button"),null==this.handlers[t]&&null==this.quill.scroll.query(t))return void toolbar_debug.warn("ignoring attaching to nonexistent format",t,e);const r="SELECT"===e.tagName?"change":"click";e.addEventListener(r,(r=>{let n;if("SELECT"===e.tagName){if(e.selectedIndex<0)return;const t=e.options[e.selectedIndex];n=!t.hasAttribute("selected")&&(t.value||!1)}else n=!e.classList.contains("ql-active")&&(e.value||!e.hasAttribute("value")),r.preventDefault();this.quill.focus();const[i]=this.quill.selection.getRange();if(null!=this.handlers[t])this.handlers[t].call(this,n);else if(this.quill.scroll.query(t).prototype instanceof EmbedBlot$1){if(n=prompt(`Enter ${t}`),!n)return;this.quill.updateContents((new Delta).retain(i.index).delete(i.length).insert({[t]:n}),Quill.sources.USER)}else this.quill.format(t,n,Quill.sources.USER);this.update(i)})),this.controls.push([t,e])}update(e){const t=null==e?{}:this.quill.getFormat(e);this.controls.forEach((r=>{const[n,i]=r;if("SELECT"===i.tagName){let r=null;if(null==e)r=null;else if(null==t[n])r=i.querySelector("option[selected]");else if(!Array.isArray(t[n])){let e=t[n];"string"==typeof e&&(e=e.replace(/"/g,'\\"')),r=i.querySelector(`option[value="${e}"]`)}null==r?(i.value="",i.selectedIndex=-1):r.selected=!0}else if(null==e)i.classList.remove("ql-active"),i.setAttribute("aria-pressed","false");else if(i.hasAttribute("value")){const e=t[n],r=e===i.getAttribute("value")||null!=e&&e.toString()===i.getAttribute("value")||null==e&&!i.getAttribute("value");i.classList.toggle("ql-active",r),i.setAttribute("aria-pressed",r.toString())}else{const e=null!=t[n];i.classList.toggle("ql-active",e),i.setAttribute("aria-pressed",e.toString())}}))}}function addButton(e,t,r){const n=document.createElement("button");n.setAttribute("type","button"),n.classList.add(`ql-${t}`),n.setAttribute("aria-pressed","false"),null!=r?(n.value=r,n.setAttribute("aria-label",`${t}: ${r}`)):n.setAttribute("aria-label",t),e.appendChild(n)}function addControls(e,t){Array.isArray(t[0])||(t=[t]),t.forEach((t=>{const r=document.createElement("span");r.classList.add("ql-formats"),t.forEach((e=>{if("string"==typeof e)addButton(r,e);else{const t=Object.keys(e)[0],n=e[t];Array.isArray(n)?addSelect(r,t,n):addButton(r,t,n)}})),e.appendChild(r)}))}function addSelect(e,t,r){const n=document.createElement("select");n.classList.add(`ql-${t}`),r.forEach((e=>{const t=document.createElement("option");!1!==e?t.setAttribute("value",String(e)):t.setAttribute("selected","selected"),n.appendChild(t)})),e.appendChild(n)}Toolbar.DEFAULTS={},Toolbar.DEFAULTS={container:null,handlers:{clean(){const e=this.quill.getSelection();if(null!=e)if(0===e.length){const e=this.quill.getFormat();Object.keys(e).forEach((e=>{null!=this.quill.scroll.query(e,Scope.INLINE)&&this.quill.format(e,!1,Quill.sources.USER)}))}else this.quill.removeFormat(e.index,e.length,Quill.sources.USER)},direction(e){const{align:t}=this.quill.getFormat();"rtl"===e&&null==t?this.quill.format("align","right",Quill.sources.USER):e||"right"!==t||this.quill.format("align",!1,Quill.sources.USER),this.quill.format("direction",e,Quill.sources.USER)},indent(e){const t=this.quill.getSelection(),r=this.quill.getFormat(t),n=parseInt(r.indent||0,10);if("+1"===e||"-1"===e){let t="+1"===e?1:-1;"rtl"===r.direction&&(t*=-1),this.quill.format("indent",n+t,Quill.sources.USER)}},link(e){!0===e&&(e=prompt("Enter link URL:")),this.quill.format("link",e,Quill.sources.USER)},list(e){const t=this.quill.getSelection(),r=this.quill.getFormat(t);"check"===e?"checked"===r.list||"unchecked"===r.list?this.quill.format("list",!1,Quill.sources.USER):this.quill.format("list","unchecked",Quill.sources.USER):this.quill.format("list",e,Quill.sources.USER)}}};const alignLeftIcon='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"/></svg>',alignCenterIcon='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"/><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"/></svg>',alignRightIcon='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"/></svg>',alignJustifyIcon='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="3" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="3" y1="4" y2="4"/></svg>',backgroundIcon='<svg viewbox="0 0 18 18"><g class="ql-fill ql-color-label"><polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"/><rect height="1" width="1" x="4" y="4"/><polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"/><rect height="1" width="1" x="2" y="6"/><rect height="1" width="1" x="3" y="5"/><rect height="1" width="1" x="4" y="7"/><polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"/><rect height="1" width="1" x="2" y="12"/><rect height="1" width="1" x="2" y="9"/><rect height="1" width="1" x="2" y="15"/><polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"/><rect height="1" width="1" x="3" y="8"/><path d="M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z"/><path d="M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z"/><path d="M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z"/><rect height="1" width="1" x="12" y="2"/><rect height="1" width="1" x="11" y="3"/><path d="M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z"/><rect height="1" width="1" x="2" y="3"/><rect height="1" width="1" x="6" y="2"/><rect height="1" width="1" x="3" y="2"/><rect height="1" width="1" x="5" y="3"/><rect height="1" width="1" x="9" y="2"/><rect height="1" width="1" x="15" y="14"/><polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"/><rect height="1" width="1" x="13" y="7"/><rect height="1" width="1" x="15" y="5"/><rect height="1" width="1" x="14" y="6"/><rect height="1" width="1" x="15" y="8"/><rect height="1" width="1" x="14" y="9"/><path d="M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z"/><rect height="1" width="1" x="14" y="3"/><polygon points="12 6.868 12 6 11.62 6 12 6.868"/><rect height="1" width="1" x="15" y="2"/><rect height="1" width="1" x="12" y="5"/><rect height="1" width="1" x="13" y="4"/><polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"/><rect height="1" width="1" x="9" y="14"/><rect height="1" width="1" x="8" y="15"/><path d="M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z"/><rect height="1" width="1" x="5" y="15"/><path d="M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z"/><rect height="1" width="1" x="11" y="15"/><path d="M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z"/><rect height="1" width="1" x="14" y="15"/><rect height="1" width="1" x="15" y="11"/></g><polyline class="ql-stroke" points="5.5 13 9 5 12.5 13"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="11" y2="11"/></svg>',blockquoteIcon='<svg viewbox="0 0 18 18"><rect class="ql-fill ql-stroke" height="3" width="3" x="4" y="5"/><rect class="ql-fill ql-stroke" height="3" width="3" x="11" y="5"/><path class="ql-even ql-fill ql-stroke" d="M7,8c0,4.031-3,5-3,5"/><path class="ql-even ql-fill ql-stroke" d="M14,8c0,4.031-3,5-3,5"/></svg>',boldIcon='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"/><path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"/></svg>',cleanIcon='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"/><line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"/><line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"/><line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"/></svg>',codeIcon='<svg viewbox="0 0 18 18"><polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"/><polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"/><line class="ql-stroke" x1="10" x2="8" y1="5" y2="13"/></svg>',colorIcon='<svg viewbox="0 0 18 18"><line class="ql-color-label ql-stroke ql-transparent" x1="3" x2="15" y1="15" y2="15"/><polyline class="ql-stroke" points="5.5 11 9 3 12.5 11"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="9" y2="9"/></svg>',directionLeftToRightIcon='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"/><line class="ql-stroke ql-fill" x1="15" x2="11" y1="4" y2="4"/><path class="ql-fill" d="M11,3a3,3,0,0,0,0,6h1V3H11Z"/><rect class="ql-fill" height="11" width="1" x="11" y="4"/><rect class="ql-fill" height="11" width="1" x="13" y="4"/></svg>',directionRightToLeftIcon='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"/><line class="ql-stroke ql-fill" x1="9" x2="5" y1="4" y2="4"/><path class="ql-fill" d="M5,3A3,3,0,0,0,5,9H6V3H5Z"/><rect class="ql-fill" height="11" width="1" x="5" y="4"/><rect class="ql-fill" height="11" width="1" x="7" y="4"/></svg>',formulaIcon='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"/><rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"/><path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"/></svg>',headerIcon='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"/></svg>',header2Icon='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',header3Icon='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.65186,12.30664a2.6742,2.6742,0,0,1-2.915,2.68457,3.96592,3.96592,0,0,1-2.25537-.6709.56007.56007,0,0,1-.13232-.83594L11.64648,13c.209-.34082.48389-.36328.82471-.1543a2.32654,2.32654,0,0,0,1.12256.33008c.71484,0,1.12207-.35156,1.12207-.78125,0-.61523-.61621-.86816-1.46338-.86816H13.2085a.65159.65159,0,0,1-.68213-.41895l-.05518-.10937a.67114.67114,0,0,1,.14307-.78125l.71533-.86914a8.55289,8.55289,0,0,1,.68213-.7373V8.58887a3.93913,3.93913,0,0,1-.748.05469H11.9873a.54085.54085,0,0,1-.605-.60547V7.59863a.54085.54085,0,0,1,.605-.60547h3.75146a.53773.53773,0,0,1,.60547.59375v.17676a1.03723,1.03723,0,0,1-.27539.748L14.74854,10.0293A2.31132,2.31132,0,0,1,16.65186,12.30664ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',header4Icon='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm7.05371,7.96582v.38477c0,.39648-.165.60547-.46191.60547h-.47314v1.29785a.54085.54085,0,0,1-.605.60547h-.69336a.54085.54085,0,0,1-.605-.60547V12.95605H11.333a.5412.5412,0,0,1-.60547-.60547v-.15332a1.199,1.199,0,0,1,.22021-.748l2.56348-4.05957a.7819.7819,0,0,1,.72607-.39648h1.27637a.54085.54085,0,0,1,.605.60547v3.7627h.33008A.54055.54055,0,0,1,17.05371,11.96582ZM14.28125,8.7207h-.022a4.18969,4.18969,0,0,1-.38525.81348l-1.188,1.80469v.02246h1.5293V9.60059A7.04058,7.04058,0,0,1,14.28125,8.7207Z"/></svg>',header5Icon='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.74023,12.18555a2.75131,2.75131,0,0,1-2.91553,2.80566,3.908,3.908,0,0,1-2.25537-.68164.54809.54809,0,0,1-.13184-.8252L11.73438,13c.209-.34082.48389-.36328.8252-.1543a2.23757,2.23757,0,0,0,1.1001.33008,1.01827,1.01827,0,0,0,1.1001-.96777c0-.61621-.53906-.97949-1.25439-.97949a2.15554,2.15554,0,0,0-.64893.09961,1.15209,1.15209,0,0,1-.814.01074l-.12109-.04395a.64116.64116,0,0,1-.45117-.71484l.231-3.00391a.56666.56666,0,0,1,.62744-.583H15.541a.54085.54085,0,0,1,.605.60547v.43945a.54085.54085,0,0,1-.605.60547H13.41748l-.04395.72559a1.29306,1.29306,0,0,1-.04395.30859h.022a2.39776,2.39776,0,0,1,.57227-.07715A2.53266,2.53266,0,0,1,16.74023,12.18555ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',header6Icon='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M14.51758,9.64453a1.85627,1.85627,0,0,0-1.24316.38477H13.252a1.73532,1.73532,0,0,1,1.72754-1.4082,2.66491,2.66491,0,0,1,.5498.06641c.35254.05469.57227.01074.70508-.40723l.16406-.5166a.53393.53393,0,0,0-.373-.75977,4.83723,4.83723,0,0,0-1.17773-.14258c-2.43164,0-3.7627,2.17773-3.7627,4.43359,0,2.47559,1.60645,3.69629,3.19043,3.69629A2.70585,2.70585,0,0,0,16.96,12.19727,2.43861,2.43861,0,0,0,14.51758,9.64453Zm-.23047,3.58691c-.67187,0-1.22168-.81445-1.22168-1.45215,0-.47363.30762-.583.72559-.583.96875,0,1.27734.59375,1.27734,1.12207A.82182.82182,0,0,1,14.28711,13.23145ZM10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Z"/></svg>',italicIcon='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"/><line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"/><line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"/></svg>',imageIcon='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="10" width="12" x="3" y="4"/><circle class="ql-fill" cx="6" cy="7" r="1"/><polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"/></svg>',indentIcon='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"/></svg>',outdentIcon='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="5 7 5 11 3 9 5 7"/></svg>',linkIcon='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"/><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>',listBulletIcon='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"/><line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"/></svg>',listCheckIcon='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="9" x2="15" y1="4" y2="4"/><polyline class="ql-stroke" points="3 4 4 5 6 3"/><line class="ql-stroke" x1="9" x2="15" y1="14" y2="14"/><polyline class="ql-stroke" points="3 14 4 15 6 13"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="3 9 4 10 6 8"/></svg>',listOrderedIcon='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"/><line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"/><path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"/><path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"/><path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"/></svg>',subscriptIcon='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z"/><path class="ql-fill" d="M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z"/></svg>',superscriptIcon='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z"/><path class="ql-fill" d="M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z"/></svg>',strikeIcon='<svg viewbox="0 0 18 18"><line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"/><path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"/><path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"/></svg>',tableIcon='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="2" width="3" x="5" y="5"/><rect class="ql-fill" height="2" width="4" x="9" y="5"/><g class="ql-fill ql-transparent"><rect height="2" width="3" x="5" y="8"/><rect height="2" width="4" x="9" y="8"/><rect height="2" width="3" x="5" y="11"/><rect height="2" width="4" x="9" y="11"/></g></svg>',underlineIcon='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"/></svg>',videoIcon='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="12" width="1" x="5" y="3"/><rect class="ql-fill" height="12" width="1" x="12" y="3"/><rect class="ql-fill" height="2" width="8" x="5" y="8"/><rect class="ql-fill" height="1" width="3" x="3" y="5"/><rect class="ql-fill" height="1" width="3" x="3" y="7"/><rect class="ql-fill" height="1" width="3" x="3" y="10"/><rect class="ql-fill" height="1" width="3" x="3" y="12"/><rect class="ql-fill" height="1" width="3" x="12" y="5"/><rect class="ql-fill" height="1" width="3" x="12" y="7"/><rect class="ql-fill" height="1" width="3" x="12" y="10"/><rect class="ql-fill" height="1" width="3" x="12" y="12"/></svg>',icons={align:{"":alignLeftIcon,center:alignCenterIcon,right:alignRightIcon,justify:alignJustifyIcon},background:backgroundIcon,blockquote:blockquoteIcon,bold:boldIcon,clean:cleanIcon,code:codeIcon,"code-block":codeIcon,color:colorIcon,direction:{"":directionLeftToRightIcon,rtl:directionRightToLeftIcon},formula:formulaIcon,header:{1:headerIcon,2:header2Icon,3:header3Icon,4:header4Icon,5:header5Icon,6:header6Icon},italic:italicIcon,image:imageIcon,indent:{"+1":indentIcon,"-1":outdentIcon},link:linkIcon,list:{bullet:listBulletIcon,check:listCheckIcon,ordered:listOrderedIcon},script:{sub:subscriptIcon,super:superscriptIcon},strike:strikeIcon,table:tableIcon,underline:underlineIcon,video:videoIcon},DropdownIcon='<svg viewbox="0 0 18 18"><polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"/><polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"/></svg>';let optionsCounter=0;function toggleAriaAttribute(e,t){e.setAttribute(t,`${!("true"===e.getAttribute(t))}`)}class Picker{constructor(e){this.select=e,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",(()=>{this.togglePicker()})),this.label.addEventListener("keydown",(e=>{switch(e.key){case"Enter":this.togglePicker();break;case"Escape":this.escape(),e.preventDefault()}})),this.select.addEventListener("change",this.update.bind(this))}togglePicker(){this.container.classList.toggle("ql-expanded"),toggleAriaAttribute(this.label,"aria-expanded"),toggleAriaAttribute(this.options,"aria-hidden")}buildItem(e){const t=document.createElement("span");t.tabIndex="0",t.setAttribute("role","button"),t.classList.add("ql-picker-item");const r=e.getAttribute("value");return r&&t.setAttribute("data-value",r),e.textContent&&t.setAttribute("data-label",e.textContent),t.addEventListener("click",(()=>{this.selectItem(t,!0)})),t.addEventListener("keydown",(e=>{switch(e.key){case"Enter":this.selectItem(t,!0),e.preventDefault();break;case"Escape":this.escape(),e.preventDefault()}})),t}buildLabel(){const e=document.createElement("span");return e.classList.add("ql-picker-label"),e.innerHTML=DropdownIcon,e.tabIndex="0",e.setAttribute("role","button"),e.setAttribute("aria-expanded","false"),this.container.appendChild(e),e}buildOptions(){const e=document.createElement("span");e.classList.add("ql-picker-options"),e.setAttribute("aria-hidden","true"),e.tabIndex="-1",e.id=`ql-picker-options-${optionsCounter}`,optionsCounter+=1,this.label.setAttribute("aria-controls",e.id),this.options=e,Array.from(this.select.options).forEach((t=>{const r=this.buildItem(t);e.appendChild(r),!0===t.selected&&this.selectItem(r)})),this.container.appendChild(e)}buildPicker(){Array.from(this.select.attributes).forEach((e=>{this.container.setAttribute(e.name,e.value)})),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}escape(){this.close(),setTimeout((()=>this.label.focus()),1)}close(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}selectItem(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=this.container.querySelector(".ql-selected");e!==r&&(null!=r&&r.classList.remove("ql-selected"),null!=e&&(e.classList.add("ql-selected"),this.select.selectedIndex=Array.from(e.parentNode.children).indexOf(e),e.hasAttribute("data-value")?this.label.setAttribute("data-value",e.getAttribute("data-value")):this.label.removeAttribute("data-value"),e.hasAttribute("data-label")?this.label.setAttribute("data-label",e.getAttribute("data-label")):this.label.removeAttribute("data-label"),t&&(this.select.dispatchEvent(new Event("change")),this.close())))}update(){let e;if(this.select.selectedIndex>-1){const t=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];e=this.select.options[this.select.selectedIndex],this.selectItem(t)}else this.selectItem(null);const t=null!=e&&e!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",t)}}const picker=Picker;class ColorPicker extends picker{constructor(e,t){super(e),this.label.innerHTML=t,this.container.classList.add("ql-color-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).slice(0,7).forEach((e=>{e.classList.add("ql-primary")}))}buildItem(e){const t=super.buildItem(e);return t.style.backgroundColor=e.getAttribute("value")||"",t}selectItem(e,t){super.selectItem(e,t);const r=this.label.querySelector(".ql-color-label"),n=e&&e.getAttribute("data-value")||"";r&&("line"===r.tagName?r.style.stroke=n:r.style.fill=n)}}const color_picker=ColorPicker;class IconPicker extends picker{constructor(e,t){super(e),this.container.classList.add("ql-icon-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).forEach((e=>{e.innerHTML=t[e.getAttribute("data-value")||""]})),this.defaultItem=this.container.querySelector(".ql-selected"),this.selectItem(this.defaultItem)}selectItem(e,t){super.selectItem(e,t);const r=e||this.defaultItem;if(null!=r){if(this.label.innerHTML===r.innerHTML)return;this.label.innerHTML=r.innerHTML}}}const icon_picker=IconPicker,isScrollable=e=>{const{overflowY:t}=getComputedStyle(e,null);return"visible"!==t&&"clip"!==t};class Tooltip{constructor(e,t){this.quill=e,this.boundsContainer=t||document.body,this.root=e.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,isScrollable(this.quill.root)&&this.quill.root.addEventListener("scroll",(()=>{this.root.style.marginTop=-1*this.quill.root.scrollTop+"px"})),this.hide()}hide(){this.root.classList.add("ql-hidden")}position(e){const t=e.left+e.width/2-this.root.offsetWidth/2,r=e.bottom+this.quill.root.scrollTop;this.root.style.left=`${t}px`,this.root.style.top=`${r}px`,this.root.classList.remove("ql-flip");const n=this.boundsContainer.getBoundingClientRect(),i=this.root.getBoundingClientRect();let a=0;if(i.right>n.right&&(a=n.right-i.right,this.root.style.left=`${t+a}px`),i.left<n.left&&(a=n.left-i.left,this.root.style.left=`${t+a}px`),i.bottom>n.bottom){const t=i.bottom-i.top,n=e.bottom-e.top+t;this.root.style.top=r-n+"px",this.root.classList.add("ql-flip")}return a}show(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}const tooltip=Tooltip,ALIGNS=[!1,"center","right","justify"],COLORS=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],FONTS=[!1,"serif","monospace"],HEADERS=["1","2","3",!1],SIZES=["small",!1,"large","huge"];class BaseTheme extends core_theme{constructor(e,t){super(e,t);const r=t=>{document.body.contains(e.root)?(null==this.tooltip||this.tooltip.root.contains(t.target)||document.activeElement===this.tooltip.textbox||this.quill.hasFocus()||this.tooltip.hide(),null!=this.pickers&&this.pickers.forEach((e=>{e.container.contains(t.target)||e.close()}))):document.body.removeEventListener("click",r)};e.emitter.listenDOM("click",document.body,r)}addModule(e){const t=super.addModule(e);return"toolbar"===e&&this.extendToolbar(t),t}buildButtons(e,t){Array.from(e).forEach((e=>{(e.getAttribute("class")||"").split(/\s+/).forEach((r=>{if(r.startsWith("ql-")&&(r=r.slice(3),null!=t[r]))if("direction"===r)e.innerHTML=t[r][""]+t[r].rtl;else if("string"==typeof t[r])e.innerHTML=t[r];else{const n=e.value||"";null!=n&&t[r][n]&&(e.innerHTML=t[r][n])}}))}))}buildPickers(e,t){this.pickers=Array.from(e).map((e=>{if(e.classList.contains("ql-align")&&(null==e.querySelector("option")&&fillSelect(e,ALIGNS),"object"==typeof t.align))return new icon_picker(e,t.align);if(e.classList.contains("ql-background")||e.classList.contains("ql-color")){const r=e.classList.contains("ql-background")?"background":"color";return null==e.querySelector("option")&&fillSelect(e,COLORS,"background"===r?"#ffffff":"#000000"),new color_picker(e,t[r])}return null==e.querySelector("option")&&(e.classList.contains("ql-font")?fillSelect(e,FONTS):e.classList.contains("ql-header")?fillSelect(e,HEADERS):e.classList.contains("ql-size")&&fillSelect(e,SIZES)),new picker(e)})),this.quill.on(core_emitter.events.EDITOR_CHANGE,(()=>{this.pickers.forEach((e=>{e.update()}))}))}}BaseTheme.DEFAULTS=lodash_es_merge({},core_theme.DEFAULTS,{modules:{toolbar:{handlers:{formula(){this.quill.theme.tooltip.edit("formula")},image(){let e=this.container.querySelector("input.ql-image[type=file]");null==e&&(e=document.createElement("input"),e.setAttribute("type","file"),e.setAttribute("accept",this.quill.uploader.options.mimetypes.join(", ")),e.classList.add("ql-image"),e.addEventListener("change",(()=>{const t=this.quill.getSelection(!0);this.quill.uploader.upload(t,e.files),e.value=""})),this.container.appendChild(e)),e.click()},video(){this.quill.theme.tooltip.edit("video")}}}}});class BaseTooltip extends tooltip{constructor(e,t){super(e,t),this.textbox=this.root.querySelector('input[type="text"]'),this.listen()}listen(){this.textbox.addEventListener("keydown",(e=>{"Enter"===e.key?(this.save(),e.preventDefault()):"Escape"===e.key&&(this.cancel(),e.preventDefault())}))}cancel(){this.hide(),this.restoreFocus()}edit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"link",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),null==this.textbox)return;null!=t?this.textbox.value=t:e!==this.root.getAttribute("data-mode")&&(this.textbox.value="");const r=this.quill.getBounds(this.quill.selection.savedRange);null!=r&&this.position(r),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute(`data-${e}`)||""),this.root.setAttribute("data-mode",e)}restoreFocus(){this.quill.focus({preventScroll:!0})}save(){let{value:e}=this.textbox;switch(this.root.getAttribute("data-mode")){case"link":{const{scrollTop:t}=this.quill.root;this.linkRange?(this.quill.formatText(this.linkRange,"link",e,core_emitter.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",e,core_emitter.sources.USER)),this.quill.root.scrollTop=t;break}case"video":e=extractVideoUrl(e);case"formula":{if(!e)break;const t=this.quill.getSelection(!0);if(null!=t){const r=t.index+t.length;this.quill.insertEmbed(r,this.root.getAttribute("data-mode"),e,core_emitter.sources.USER),"formula"===this.root.getAttribute("data-mode")&&this.quill.insertText(r+1," ",core_emitter.sources.USER),this.quill.setSelection(r+2,core_emitter.sources.USER)}break}}this.textbox.value="",this.hide()}}function extractVideoUrl(e){let t=e.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||e.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return t?`${t[1]||"https"}://www.youtube.com/embed/${t[2]}?showinfo=0`:(t=e.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?`${t[1]||"https"}://player.vimeo.com/video/${t[2]}/`:e}function fillSelect(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.forEach((t=>{const n=document.createElement("option");t===r?n.setAttribute("selected","selected"):n.setAttribute("value",String(t)),e.appendChild(n)}))}const TOOLBAR_CONFIG=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]];class BubbleTooltip extends BaseTooltip{static TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join("");constructor(e,t){super(e,t),this.quill.on(core_emitter.events.EDITOR_CHANGE,((e,t,r,n)=>{if(e===core_emitter.events.SELECTION_CHANGE)if(null!=t&&t.length>0&&n===core_emitter.sources.USER){this.show(),this.root.style.left="0px",this.root.style.width="",this.root.style.width=`${this.root.offsetWidth}px`;const e=this.quill.getLines(t.index,t.length);if(1===e.length){const e=this.quill.getBounds(t);null!=e&&this.position(e)}else{const r=e[e.length-1],n=this.quill.getIndex(r),i=Math.min(r.length()-1,t.index+t.length-n),a=this.quill.getBounds(new Range(n,i));null!=a&&this.position(a)}}else document.activeElement!==this.textbox&&this.quill.hasFocus()&&this.hide()}))}listen(){super.listen(),this.root.querySelector(".ql-close").addEventListener("click",(()=>{this.root.classList.remove("ql-editing")})),this.quill.on(core_emitter.events.SCROLL_OPTIMIZE,(()=>{setTimeout((()=>{if(this.root.classList.contains("ql-hidden"))return;const e=this.quill.getSelection();if(null!=e){const t=this.quill.getBounds(e);null!=t&&this.position(t)}}),1)}))}cancel(){this.show()}position(e){const t=super.position(e),r=this.root.querySelector(".ql-tooltip-arrow");return r.style.marginLeft="",0!==t&&(r.style.marginLeft=-1*t-r.offsetWidth/2+"px"),t}}class BubbleTheme extends BaseTheme{constructor(e,t){null!=t.modules.toolbar&&null==t.modules.toolbar.container&&(t.modules.toolbar.container=TOOLBAR_CONFIG),super(e,t),this.quill.container.classList.add("ql-bubble")}extendToolbar(e){this.tooltip=new BubbleTooltip(this.quill,this.options.bounds),null!=e.container&&(this.tooltip.root.appendChild(e.container),this.buildButtons(e.container.querySelectorAll("button"),icons),this.buildPickers(e.container.querySelectorAll("select"),icons))}}BubbleTheme.DEFAULTS=lodash_es_merge({},BaseTheme.DEFAULTS,{modules:{toolbar:{handlers:{link(e){e?this.quill.theme.tooltip.edit():this.quill.format("link",!1,Quill.sources.USER)}}}}});const snow_TOOLBAR_CONFIG=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]];class SnowTooltip extends BaseTooltip{static TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join("");preview=this.root.querySelector("a.ql-preview");listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",(e=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),e.preventDefault()})),this.root.querySelector("a.ql-remove").addEventListener("click",(e=>{if(null!=this.linkRange){const e=this.linkRange;this.restoreFocus(),this.quill.formatText(e,"link",!1,core_emitter.sources.USER),delete this.linkRange}e.preventDefault(),this.hide()})),this.quill.on(core_emitter.events.SELECTION_CHANGE,((e,t,r)=>{if(null!=e){if(0===e.length&&r===core_emitter.sources.USER){const[t,r]=this.quill.scroll.descendant(Link,e.index);if(null!=t){this.linkRange=new Range(e.index-r,t.length());const n=Link.formats(t.domNode);this.preview.textContent=n,this.preview.setAttribute("href",n),this.show();const i=this.quill.getBounds(this.linkRange);return void(null!=i&&this.position(i))}}else delete this.linkRange;this.hide()}}))}show(){super.show(),this.root.removeAttribute("data-mode")}}class SnowTheme extends BaseTheme{constructor(e,t){null!=t.modules.toolbar&&null==t.modules.toolbar.container&&(t.modules.toolbar.container=snow_TOOLBAR_CONFIG),super(e,t),this.quill.container.classList.add("ql-snow")}extendToolbar(e){null!=e.container&&(e.container.classList.add("ql-snow"),this.buildButtons(e.container.querySelectorAll("button"),icons),this.buildPickers(e.container.querySelectorAll("select"),icons),this.tooltip=new SnowTooltip(this.quill,this.options.bounds),e.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},((t,r)=>{e.handlers.link.call(e,!r.format.link)})))}}SnowTheme.DEFAULTS=lodash_es_merge({},BaseTheme.DEFAULTS,{modules:{toolbar:{handlers:{link(e){if(e){const e=this.quill.getSelection();if(null==e||0===e.length)return;let t=this.quill.getText(e);/^\S+@\S+\.\S+$/.test(t)&&0!==t.indexOf("mailto:")&&(t=`mailto:${t}`);const{tooltip:r}=this.quill.theme;r.edit("link",t)}else this.quill.format("link",!1,Quill.sources.USER)}}}}});const snow=SnowTheme;quill_core.register({"attributors/attribute/direction":DirectionAttribute,"attributors/class/align":AlignClass,"attributors/class/background":BackgroundClass,"attributors/class/color":ColorClass,"attributors/class/direction":DirectionClass,"attributors/class/font":FontClass,"attributors/class/size":SizeClass,"attributors/style/align":AlignStyle,"attributors/style/background":BackgroundStyle,"attributors/style/color":ColorStyle,"attributors/style/direction":DirectionStyle,"attributors/style/font":FontStyle,"attributors/style/size":SizeStyle},!0),quill_core.register({"formats/align":AlignClass,"formats/direction":DirectionClass,"formats/indent":indent,"formats/background":BackgroundStyle,"formats/color":ColorStyle,"formats/font":FontClass,"formats/size":SizeClass,"formats/blockquote":blockquote,"formats/code-block":CodeBlock,"formats/header":header,"formats/list":list_ListItem,"formats/bold":bold,"formats/code":Code,"formats/italic":italic,"formats/link":Link,"formats/script":script,"formats/strike":strike,"formats/underline":underline,"formats/formula":formula,"formats/image":formats_image,"formats/video":video,"modules/syntax":Syntax,"modules/table":table,"modules/toolbar":Toolbar,"themes/bubble":BubbleTheme,"themes/snow":snow,"ui/icons":icons,"ui/picker":picker,"ui/icon-picker":icon_picker,"ui/color-picker":color_picker,"ui/tooltip":tooltip},!0);const quill_quill=quill_core;var dist_quill_core=__webpack_require__(2978),quill_core_options={};quill_core_options.styleTagTransform=styleTagTransform_default(),quill_core_options.setAttributes=setAttributesWithoutAttributes_default(),quill_core_options.insert=insertBySelector_default().bind(null,"head"),quill_core_options.domAPI=styleDomAPI_default(),quill_core_options.insertStyleElement=insertStyleElement_default();var quill_core_update=injectStylesIntoStyleTag_default()(dist_quill_core.A,quill_core_options);const quill_dist_quill_core=dist_quill_core.A&&dist_quill_core.A.locals?dist_quill_core.A.locals:void 0;var quill_snow=__webpack_require__(6878),quill_snow_options={};quill_snow_options.styleTagTransform=styleTagTransform_default(),quill_snow_options.setAttributes=setAttributesWithoutAttributes_default(),quill_snow_options.insert=insertBySelector_default().bind(null,"head"),quill_snow_options.domAPI=styleDomAPI_default(),quill_snow_options.insertStyleElement=insertStyleElement_default();var quill_snow_update=injectStylesIntoStyleTag_default()(quill_snow.A,quill_snow_options);const dist_quill_snow=quill_snow.A&&quill_snow.A.locals?quill_snow.A.locals:void 0;var ssml_check=__webpack_require__(1427);const ssmlToolbar_Module=Quill.import("core/module");class SsmlToolbar extends ssmlToolbar_Module{constructor(e,t){super(e,t),this.controls=[],this.handlers={},this.options=t,this.quill=e,this.loadIcons(),this.registerHandlers()}loadIcons(){const e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"),document.getElementsByTagName("head")[0].appendChild(e)}registerHandlers(){const e=this.quill.getModule("toolbar");document.querySelector(".ql-ssml_phoneme").innerHTML='<span class="material-symbols-outlined" title="Phoneme">menu_book</span>',document.querySelector(".ql-ssml_validate").innerHTML='<span class="material-symbols-outlined" title="Validate SSML">domain_verification</span>',document.querySelector(".ql-ssml_emphasis").innerHTML='<span class="material-symbols-outlined" title="Emphasis">Highlight</span>',document.querySelector(".ql-ssml_substitute").innerHTML='<span class="material-symbols-outlined" title="Substitute">letter_switch</span>',Array.prototype.slice.call(document.querySelectorAll(".ql-ssml_break .ql-picker-item")).forEach((e=>e.textContent=e.dataset.value)),document.querySelector(".ql-ssml_break .ql-picker-label").innerHTML='<span class="material-symbols-outlined" title="Break">auto_read_pause</span>'+document.querySelector(".ql-ssml_break .ql-picker-label").innerHTML,Array.prototype.slice.call(document.querySelectorAll(".ql-ssml_gender .ql-picker-item")).forEach((e=>e.textContent=e.dataset.value)),document.querySelector(".ql-ssml_gender .ql-picker-label").innerHTML='<span class="material-symbols-outlined" title="Gender">Wc</span>'+document.querySelector(".ql-ssml_gender .ql-picker-label").innerHTML,Array.prototype.slice.call(document.querySelectorAll(".ql-ssml_language .ql-picker-item")).forEach((e=>e.textContent=e.dataset.value)),document.querySelector(".ql-ssml_language .ql-picker-label").innerHTML='<span class="material-symbols-outlined" title="Language">Language</span>'+document.querySelector(".ql-ssml_language .ql-picker-label").innerHTML,Array.prototype.slice.call(document.querySelectorAll(".ql-ssml_sayas .ql-picker-item")).forEach((e=>e.textContent=e.dataset.value)),document.querySelector(".ql-ssml_sayas .ql-picker-label").innerHTML='<span class="material-symbols-outlined" title="Say as">translate</span>'+document.querySelector(".ql-ssml_sayas .ql-picker-label").innerHTML,Array.prototype.slice.call(document.querySelectorAll(".ql-ssml_prosody .ql-picker-item")).forEach((e=>e.textContent=e.dataset.value)),document.querySelector(".ql-ssml_prosody .ql-picker-label").innerHTML='<span class="material-symbols-outlined" title="Prosody">speed</span>'+document.querySelector(".ql-ssml_prosody .ql-picker-label").innerHTML,Array.prototype.slice.call(document.querySelectorAll(".ql-ssml_date .ql-picker-item")).forEach((e=>e.textContent=e.dataset.value)),document.querySelector(".ql-ssml_date .ql-picker-label").innerHTML='<span class="material-symbols-outlined" title="Date">calendar_month</span>'+document.querySelector(".ql-ssml_date .ql-picker-label").innerHTML,e.addHandler("ssml_break",function(e){if(e){const t=this.quill.getSelection().index;this.quill.insertText(t,'<break time="'+e+'"/>'),this.quill.setSelection(t+e.length+20)}}.bind(this)),e.addHandler("ssml_emphasis",function(){const e=quill.getSelection();e?e.length>0&&(this.quill.insertText(e.index+e.length,"</emphasis>"),this.quill.insertText(e.index,'<emphasis level="strong">'),this.quill.setSelection(e.index+e.length+36)):this.quill.insertText('<emphasis level="strong"></emphasis>')}.bind(this)),e.addHandler("ssml_gender",function(e){const t=quill.getSelection();this.quill.insertText(t.index+t.length,"</voice>"),this.quill.insertText(t.index,'<voice gender="'+e+'">'),this.quill.setSelection(t.index+t.length+e.length+25)}.bind(this)),e.addHandler("ssml_language",function(e){const t=quill.getSelection();t?t.length>0&&(this.quill.insertText(t.index+t.length,"</lang>"),this.quill.insertText(t.index,'<lang xml:lang="'+e+'">'),this.quill.setSelection(t.index+t.length+e.length+25)):this.quill.insertText('<lang xml:lang=""></lang>')}.bind(this)),e.addHandler("ssml_sayas",function(e){const t=quill.getSelection();t?t.length>0&&(this.quill.insertText(t.index+t.length,"</say-as>"),this.quill.insertText(t.index,'<say-as interpret-as="'+e+'">'),this.quill.setSelection(t.index+t.length+e.length+33)):this.quill.insertText('<say-as interpret-as=""></say-as>')}.bind(this)),e.addHandler("ssml_date",function(e){const t=quill.getSelection();t?t.length>0&&(this.quill.insertText(t.index+t.length,"</say-as>"),this.quill.insertText(t.index,'<say-as interpret-as="date" format="'+e+'">'),this.quill.setSelection(t.index+t.length+e.length+47)):this.quill.insertText('<say-as interpret-as="date" format=""></say-as>')}.bind(this)),e.addHandler("ssml_substitute",function(){const e=quill.getSelection();e&&e.length>0&&(this.quill.insertText(e.index+e.length,"</sub>"),this.quill.insertText(e.index,'<sub alias="Enter Substitute Text Here">'),this.quill.setSelection(e.index+e.length+46))}.bind(this)),e.addHandler("ssml_phoneme",function(){const e=quill.getSelection();e&&e.length>0&&(this.quill.insertText(e.index+e.length,"</phoneme>"),this.quill.insertText(e.index,'<phoneme alphabet="ipa" ph="pÉªËˆkÉ‘Ën">'),this.quill.setSelection(e.index+e.length+46))}.bind(this)),e.addHandler("ssml_prosody",function(e){const t=quill.getSelection();t?t.length>0&&(this.quill.insertText(t.index+t.length,"</prosody>"),this.quill.insertText(t.index,'<prosody rate="'+e+'">'),this.quill.setSelection(t.index+t.length+e.length+25)):this.quill.insertText('<prosody rate=""></prosody>')}.bind(this)),e.addHandler("ssml_validate",function(){ssml_check.check(quill.getText()).then((e=>{const t=document.getElementById("ssmlStatus");t.innerHTML="",t.classList.remove("hidden"),console.log(e),e?ssml_check.verifyAndFix(quill.getText()).then((e=>{if(e.fixedSSML)console.log(e.fixedSSML);else if(e.errors){let r="";t.classList.remove("ssmlStatusValid"),t.classList.add("ssmlStatusInvalid"),"speak"===e.errors[0]?.tag&&(r=". Check body is encased within a &lt;speak&gt;&lt;/speak&gt; element."),t.innerHTML=`<span class="material-symbols-outlined" title="Invalid">error</span> Invalid SSML${r}`,console.log(JSON.stringify(e.errors))}})):(t.classList.remove("ssmlStatusInvalid"),t.classList.add("ssmlStatusValid"),t.innerHTML='<span class="material-symbols-outlined" title="Valid">check_circle</span> Valid SSML')}))}.bind(this))}processBlankLines(e){return(e=e.trim()).split(/\n\n/).map((e=>`<p>${(e=e.trim()).split(/(?<=\.)\s+/).map((e=>`<s>${e}</s>`)).join("")}</p>`)).join("")}processLineBreaks(e){const t=new DOMParser,r=new XMLSerializer,n=t.parseFromString(e,"text/xml"),i=n.querySelector("speak");if(i){const e=i.textContent,r=this.processBlankLines(e);for(;i.firstChild;)i.removeChild(i.firstChild);const a=t.parseFromString(`<speak>${r}</speak>`,"text/xml").documentElement;Array.from(a.childNodes).forEach((e=>{i.appendChild(n.importNode(e,!0))}))}return r.serializeToString(n)}}SsmlToolbar.DEFAULTS={};var buffer=__webpack_require__(8287);const src_state={elements:{editor:null,toolbar:null,wrapper:null},modules:{editor:{id:"ssmlEditor-editor"}},quill:null};function src_run(e,t){const r=t||{debug:"warn",modules:{toolbar:{container:[[{ssml_break:["250ms","500ms","750ms","1s"]}],["ssml_emphasis"],[{ssml_gender:["Female","Male","Neutral"]}],[{ssml_language:["en-US","en-GB","de-DE","es-ES","fr-FR","it-IT","nl-NL","ru-RU","tr-TR"]}],[{ssml_sayas:["spell-out","number","ordinal","digits","fraction","expletive"]}],[{ssml_date:["mdy","dmy","ymd","md","dm","ym","my","d","m","y"]}],["ssml_substitute"],["ssml_phoneme"],[{ssml_prosody:["25%","50%","75%","100%","125%"]}],["ssml_validate"]],handlers:{ssml_break:function(){},ssml_emphasis:function(){},ssml_gender:function(){},ssml_language:function(){},ssml_sayas:function(){},ssml_date:function(){},ssml_substitute:function(){},ssml_phoneme:function(){},ssml_prosody:function(){},ssml_validate:function(){}}},ssmlToolbar:!0},placeholder:"",theme:"snow"};return setupDOMContainers(e),src_state.quill||quill_quill.register({"modules/ssmlToolbar":SsmlToolbar}),src_state.quill=new quill_quill(src_state.elements.editor,r),src_state.quill.setText('<speak version="1.1" xml:lang="en-US">\n\n</speak>'),src_state.quill.setSelection(39,0),src_state.quill}function setupDOMContainers(e){const t=document.createElement("div"),r="string"==typeof e?document.getElementById(e):e;t.setAttribute("id",src_state.modules.editor.id),src_state.elements.editor=t,src_state.elements.wrapper=r,r instanceof HTMLElement?r.appendChild(t):console.error("Trouble finding the editor wrapper. Pass an `id` (no hash) or a DOM element.")}var ssmlEditor_state={renderedCss:!1};function ssmlEditor_run(){ssmlEditor_state.renderedCss||ssmlEditor_injectCSS()}function launchSsmlEditor(e,t){var r=window.getSelection().toString(),n=window.getSelection().getRangeAt(0),i=document.createElement("div");i.appendChild(n.cloneContents());var a=i.innerHTML;document.querySelector(".learnosity-question-editor").insertAdjacentHTML("beforeEnd",'\n        <div class="lrn-qe lrn-qe-modal" style="display: block;" id="lt__ssmlModalWrapper">\n            <div class="lrn-qe-ui">\n                <div class="lrn-qe-modal-dialog">\n                    <div class="lrn-qe-modal-dialog-inner">\n                        <div class="lrn-qe-modal-header">\n                            <div class="lrn-qe-form-label lrn-qe-h4 lrn-qe-section-header">\n                                <h4 class="lrn-qe-heading"><label class="lrn-qe-label lrn-qe-form-label-name">Enter SSML</label></h4>\n                            </div>\n                            <button type="button" class="lrn-qe-btn lrn-qe-modal-btn-close" aria-label="Close" tabindex="0">\n                                <span class="lrn-qe-sr-only">Close</span>\n                                <span aria-role="presentation" class="lrn-qe-i-cross"></span>\n                            </button>\n                        </div>\n                        <div data-lrn-qe-selector="modal-outlet">\n                            <div class="lrn-qe-modal-content" data-lrn-qe-modal-section="content">\n                                <div id="editor"></div>\n                                <div id="ssmlStatus"></div>\n                            </div>\n                            <div class="lrn-qe-modal-footer">\n                                <ul class="lrn-qe-ul">\n                                    <li class="lrn-qe-li lrn-qe-modal-footer-item">\n                                        <button type="button" class="lrn-qe-btn lrn-qe-btn-default"><span>Cancel</span></button>\n                                    </li>&nbsp;\n                                    <li class="lrn-qe-li lrn-qe-modal-footer-item">\n                                        <button type="button" class="lrn-qe-btn lrn-qe-btn-primary lt__ssml-add" data-lrn-qe-modal-action="confirm"><span>Add SSML</span></button>\n                                    </li>&nbsp;\n                                    <li class="lrn-qe-li lrn-qe-modal-footer-item">\n                                        <button type="button" class="lrn-qe-btn lrn-qe-btn-primary lt__ssml-generate-audio"><span>â­ Generate audio</span></button>\n                                    </li>\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        ');var s=[];s.push(document.querySelector("#lt__ssmlModalWrapper .lrn-qe-btn-default")),s.push(document.querySelector("#lt__ssmlModalWrapper .lrn-qe-modal-btn-close"));for(var o=0;o<s.length;o++)s[o].addEventListener("click",(function(){return ssmlEditor_removeElement("lt__ssmlModalWrapper"),delete window.quill,t(a)}));if(document.querySelector("#lt__ssmlModalWrapper .lt__ssml-add").addEventListener("click",(function(){ssmlEditor_removeElement("lt__ssmlModalWrapper");var e=window.quill.getText();return delete window.quill,t("<span>".concat(e,"</span>"))})),!window.hasOwnProperty("quill")){var l=src_run("editor");if(r){var c=l.getSelection();l.insertText(c.index,r)}window.quill=l,window.ssmlEditor=src_namespaceObject}}function ssmlEditor_removeElement(e){document.getElementById(e).remove()}function ssmlEditor_injectCSS(){var e=document.createElement("style");e.textContent="\n/* Learnosity SSML TTS styles */\n#lt__ssmlModalWrapper .lrn-qe-modal-content {\n    height: 23em;\n}\n#lt__ssmlModalWrapper .ql-editor {\n    height: 12rem;\n}\n#lt__ssmlModalWrapper .ql-editor p {\n    margin: 0;\n}\n#lt__ssmlModalWrapper .ql-toolbar.ql-snow .ql-formats {\n    margin-right: 14px;\n}\n.hidden {\n    display: none;\n}\n#lt__ssmlModalWrapper .material-symbols-outlined {\n    font-size: 1.3rem;\n    position: relative;\n    top: -2px;\n}\n#lt__ssmlModalWrapper .ql-picker {\n    padding: 3px 0;\n}\n#lt__ssmlModalWrapper .ql-picker-label {\n    width: 45px;\n    height: 18px;\n}\n#ssmlStatus .material-symbols-outlined {\n    vertical-align: middle;\n}\n.ssmlStatusValid {\n    padding: 1em;\n    background-color: #cbf5d3;\n}\n.ssmlStatusInvalid {\n    padding: 1em;\n    background-color: #ffb9b9;\n}\nspeak s {\n    text-decoration: none;\n}\n",document.head.append(e),ssmlEditor_state.renderedCss=!0}function authoring_typeof(e){return authoring_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},authoring_typeof(e)}function authoring_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function authoring_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?authoring_ownKeys(Object(r),!0).forEach((function(t){authoring_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):authoring_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function authoring_defineProperty(e,t,r){return(t=authoring_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function authoring_toPropertyKey(e){var t=authoring_toPrimitive(e,"string");return"symbol"==authoring_typeof(t)?t:t+""}function authoring_toPrimitive(e,t){if("object"!=authoring_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=authoring_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var extensions={extensions:{contentTabs:authoring_objectSpread({},ui_contentTabs_namespaceObject),createTags:authoring_objectSpread({},createTags_namespaceObject),dynamicContent:authoring_objectSpread({},dynamicContent_namespaceObject),essayMaxLength:authoring_objectSpread({},essayMaxLength_namespaceObject),imageUploader:authoring_objectSpread({},imageUploader_namespaceObject),languageTextDirection:authoring_objectSpread({},languageTextDirection_namespaceObject),nativeTabs:authoring_objectSpread({},nativeTabs_namespaceObject),renderPDF:authoring_objectSpread({},renderPDF_namespaceObject),singleQuestion:authoring_objectSpread({},singleQuestion_namespaceObject),ssmlEditor:authoring_objectSpread({},ssmlEditor_namespaceObject)}},LT=authoring_objectSpread(authoring_objectSpread({},core.LT),extensions),__webpack_exports__LT=__webpack_exports__.LT;export{__webpack_exports__LT as LT};